<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

	 <meta name="description" content="">

    <meta name="author" content="dmey (forked from NREL)" >
    <link rel="icon" href="../favicon.png">

    <title>PlantIceThermalStorage.f90 &ndash; EnergyPlusFortran</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>


    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>


  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">EnergyPlusFortran <small>8.1.0.009</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">

            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
		 aria-expanded="false">Contents <span class="caret"></span></a>
	      <ul class="dropdown-menu">

            <li><a href="../lists/files.html">Source Files</a></li>


            <li><a href="../lists/modules.html">Modules</a></li>


            <li><a href="../lists/procedures.html">Procedures</a></li>


            <li><a href="../lists/types.html">Derived Types</a></li>


            <li><a href="../program/energyplus.html">Program</a></li>

            </ul>
            </li>

<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/energyplus.html">Program</a></li>

          </ul>


        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">


  <div class="row">
    <h1>PlantIceThermalStorage.f90
    <small>Source File</small>

    </h1>

<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">


     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
	  data-placement="bottom" data-html="true"
	  title=" 0.3% of total for source files.">1294 statements</a>
     </li>


    <li><i class="fa fa-code"></i><a href="../src/PlantIceThermalStorage.f90"> Source File</a></li>

  </ul>
  <ol class="breadcrumb in-well text-right">

     <li class="active">PlantIceThermalStorage.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">

<div id="sidebar">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/icethermalstorage.html">IceThermalStorage</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html#src">PlantIceThermalStorage.f90</a>
  </div>
</div>


  <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-0">All Source Files</a></h3></div>
  <div id="allfiles-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


</div>

    </div>
    <div class="col-md-9" id='text'>


    <h3>This File Depends On</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~planticethermalstorage.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefileplanticethermalstoragef90EfferentGraph" width="641pt" height="735pt"
 viewBox="0.00 0.00 641.00 735.34" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph" class="graph" transform="scale(.2828 .2828) rotate(0) translate(4 2595.8036)">
<title>sourcefile~~planticethermalstorage.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-2595.8036 2262.2756,-2595.8036 2262.2756,4 -4,4"/>
<!-- sourcefile~planticethermalstorage.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~planticethermalstorage.f90</title>
<polygon fill="none" stroke="#000000" points="2258.1445,-1471.5578 2115.6694,-1471.5578 2115.6694,-1449.5469 2258.1445,-1449.5469 2258.1445,-1471.5578"/>
<text text-anchor="middle" x="2186.907" y="-1457.4024" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">PlantIceThermalStorage.f90</text>
</g>
<!-- sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~schedulemanager.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~EfferentGraph_node2"><a xlink:href="../sourcefile/schedulemanager.f90.html" xlink:title="ScheduleManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1203.0723,-1508.5578 1088.7424,-1508.5578 1088.7424,-1486.5469 1203.0723,-1486.5469 1203.0723,-1508.5578"/>
<text text-anchor="middle" x="1145.9073" y="-1494.4024" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ScheduleManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~planticethermalstorage.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge182" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~planticethermalstorage.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1162.41,-1508.7335C1180.7779,-1521.0072 1211.5,-1541.0301 1238.9897,-1556.5524 1342.5128,-1615.0073 1608.6987,-1747.9198 1717.626,-1795.5524 1745.2698,-1807.6407 1756.1724,-1836.5099 1781.1273,-1819.5524"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1781.1273,-1819.5524C1803.6205,-1799.4436 1823.6996,-1817.2844 1844.6287,-1795.5524 1916.1704,-1721.2659 1817.2341,-1595.3964 1918.4414,-1575.5524"/>
</g>
<!-- sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~nodeinputmanager.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~EfferentGraph_node15"><a xlink:href="../sourcefile/nodeinputmanager.f90.html" xlink:title="NodeInputManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1681.5438,-1586.5578 1562.8727,-1586.5578 1562.8727,-1564.5469 1681.5438,-1564.5469 1681.5438,-1586.5578"/>
<text text-anchor="middle" x="1622.2083" y="-1572.4024" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">NodeInputManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge147" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#5400ff" stroke-dasharray="5,2" d="M1183.4992,-1508.5842C1256.0776,-1529.5746 1413.284,-1573.4584 1469.339,-1576.5524"/>
<path fill="none" stroke="#5400ff" stroke-dasharray="5,2" d="M1469.339,-1576.5524C1496.5168,-1576.2956 1526.4131,-1576.0843 1552.504,-1575.9231"/>
<polygon fill="#5400ff" stroke="#5400ff" points="1552.6991,-1579.422 1562.6777,-1575.8615 1552.6567,-1572.4222 1552.6991,-1579.422"/>
</g>
<!-- sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_node29" class="node">
<title>sourcefile~outputprocessor.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~EfferentGraph_node29"><a xlink:href="../sourcefile/outputprocessor.f90.html" xlink:title="OutputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1523.0647,-1473.5578 1415.6133,-1473.5578 1415.6133,-1451.5469 1523.0647,-1451.5469 1523.0647,-1473.5578"/>
<text text-anchor="middle" x="1469.339" y="-1459.4024" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge128" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1196.834,-1486.5214C1228.6327,-1479.6327 1270.4221,-1470.5781 1307.4386,-1462.5524"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1307.4386,-1462.5524C1339.1369,-1455.6797 1375.1542,-1455.0029 1405.1562,-1456.3326"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1405.3295,-1459.8466 1415.5005,-1456.8798 1405.6994,-1452.8564 1405.3295,-1459.8466"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_node33" class="node">
<title>sourcefile~sqlitefortranroutines.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~EfferentGraph_node33"><a xlink:href="../sourcefile/sqlitefortranroutines.f90.html" xlink:title="SQLiteFortranRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1375.8363,-1434.5578 1239.0409,-1434.5578 1239.0409,-1412.5469 1375.8363,-1412.5469 1375.8363,-1434.5578"/>
<text text-anchor="middle" x="1307.4386" y="-1420.4024" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SQLiteFortranRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge97" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1173.9586,-1486.4269C1183.3568,-1482.396 1193.7821,-1477.5873 1202.9897,-1472.5524 1219.8616,-1463.3264 1221.8373,-1457.2456 1238.9897,-1448.5524 1246.5329,-1444.7293 1254.8035,-1441.1983 1262.9075,-1438.0674"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1264.135,-1441.3452 1272.2907,-1434.5824 1261.6978,-1434.7832 1264.135,-1441.3452"/>
</g>
<!-- sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~dataloopnode.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~EfferentGraph_node3"><a xlink:href="../sourcefile/dataloopnode.f90.html" xlink:title="DataLoopNode.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="846.1377,-554.5578 745.8318,-554.5578 745.8318,-532.5469 846.1377,-532.5469 846.1377,-554.5578"/>
<text text-anchor="middle" x="795.9847" y="-540.4024" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataLoopNode.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~planticethermalstorage.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge183" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~planticethermalstorage.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M846.242,-547.4934C883.3674,-549.3862 935.0034,-549.88 979.6978,-542.5524"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-542.5524C1048.9199,-531.2034 1494.4976,-316.5706 1562.7905,-300.5524 1717.0311,-264.375 1764.0259,-241.129 1918.4414,-276.5524"/>
</g>
<!-- sourcefile~curvemanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~curvemanager.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~EfferentGraph_node7"><a xlink:href="../sourcefile/curvemanager.f90.html" xlink:title="CurveManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1029.0877,-1126.5578 930.3078,-1126.5578 930.3078,-1104.5469 1029.0877,-1104.5469 1029.0877,-1126.5578"/>
<text text-anchor="middle" x="979.6978" y="-1112.4024" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CurveManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#54ff00" stroke-dasharray="5,2" d="M797.965,-554.9934C811.2901,-631.7435 887.9148,-1069.3003 906.5706,-1090.5524 910.5966,-1095.1387 915.5004,-1098.8844 920.843,-1101.9436"/>
<polygon fill="#54ff00" stroke="#54ff00" points="919.6464,-1105.2532 930.1711,-1106.4708 922.7029,-1098.9557 919.6464,-1105.2532"/>
</g>
<!-- sourcefile~dataplant.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~dataplant.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~EfferentGraph_node8"><a xlink:href="../sourcefile/dataplant.f90.html" xlink:title="DataPlant.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1956.0678,-1471.5578 1880.815,-1471.5578 1880.815,-1449.5469 1956.0678,-1449.5469 1956.0678,-1471.5578"/>
<text text-anchor="middle" x="1918.4414" y="-1457.4024" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPlant.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge66" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M979.6978,-658.5524C1046.8439,-686.7622 1234.6076,-658.7773 1307.4386,-658.5524"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1307.4386,-658.5524C1381.5225,-656.2611 1395.22,-618.7813 1469.339,-618.5524"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M837.7755,-554.5759C848.787,-558.2726 860.4197,-562.9206 870.5706,-568.5524 925.5443,-599.0522 922.0518,-633.4668 979.6978,-658.5524"/>
</g>
<!-- sourcefile~plantutilities.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~plantutilities.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~EfferentGraph_node13"><a xlink:href="../sourcefile/plantutilities.f90.html" xlink:title="PlantUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2079.6809,-1471.5578 1992.1116,-1471.5578 1992.1116,-1449.5469 2079.6809,-1449.5469 2079.6809,-1471.5578"/>
<text text-anchor="middle" x="2035.8962" y="-1457.4024" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge82" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M979.6978,-542.5524C1079.1791,-529.6172 1104.8004,-530.1124 1202.9897,-509.5524 1213.0704,-507.4416 1910.9575,-307.4766 1918.4414,-314.5524"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge148" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#5400ff" stroke-dasharray="5,2" d="M979.6978,-658.5524C1311.987,-795.9316 1395.1425,-919.9511 1526.7905,-1254.5524 1570.1218,-1364.6847 1604.8738,-1502.6359 1617.2923,-1554.5284"/>
<polygon fill="#5400ff" stroke="#5400ff" points="1613.9476,-1555.5932 1619.6598,-1564.5163 1620.7589,-1553.9787 1613.9476,-1555.5932"/>
</g>
<!-- sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~branchnodeconnections.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~EfferentGraph_node17"><a xlink:href="../sourcefile/branchnodeconnections.f90.html" xlink:title="BranchNodeConnections.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1052.9524,-877.5578 906.4431,-877.5578 906.4431,-855.5469 1052.9524,-855.5469 1052.9524,-877.5578"/>
<text text-anchor="middle" x="979.6978" y="-863.4024" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">BranchNodeConnections.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge163" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M802.3086,-554.6708C829.0841,-601.7468 933.3406,-785.0483 968.2418,-846.4108"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="965.4142,-848.5188 973.4005,-855.4807 971.4989,-845.058 965.4142,-848.5188"/>
</g>
<!-- sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_node26" class="node">
<title>sourcefile~branchinputmanager.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~EfferentGraph_node26"><a xlink:href="../sourcefile/branchinputmanager.f90.html" xlink:title="BranchInputManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1844.63,-1471.5578 1717.6246,-1471.5578 1717.6246,-1449.5469 1844.63,-1449.5469 1844.63,-1471.5578"/>
<text text-anchor="middle" x="1781.1273" y="-1457.4024" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">BranchInputManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge51" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1307.4386,-658.5524C1325.9163,-658.4953 1454.1865,-685.9774 1469.339,-696.5524"/>
</g>
<!-- sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~fluidproperties.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~EfferentGraph_node4"><a xlink:href="../sourcefile/fluidproperties.f90.html" xlink:title="FluidProperties.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1029.825,-1814.5578 929.5705,-1814.5578 929.5705,-1792.5469 1029.825,-1792.5469 1029.825,-1814.5578"/>
<text text-anchor="middle" x="979.6978" y="-1800.4024" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">FluidProperties.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~planticethermalstorage.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge184" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~planticethermalstorage.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1622.2083,-2089.5524C1750.5904,-2035.6384 1677.5665,-1912.6321 1781.1273,-1819.5524"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1030.0343,-1810.2134C1037.9785,-1812.4751 1045.8594,-1815.502 1052.825,-1819.5524 1073.5011,-1831.5752 1068.8142,-1846.452 1088.825,-1859.5524 1133.5666,-1888.8433 1153.237,-1877.9454 1202.9897,-1897.5524 1298.3196,-1935.1208 1527.7352,-2129.2262 1622.2083,-2089.5524"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge83" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M1029.7754,-1813.9812C1037.5162,-1815.7454 1045.4019,-1817.631 1052.825,-1819.5524 1120.2743,-1837.0108 1141.6126,-1831.5818 1202.9897,-1864.5524 1221.3374,-1874.4084 1219.4064,-1887.4622 1238.9897,-1894.5524 1296.1991,-1915.265 1315.2998,-1900.1258 1375.8875,-1894.5524 1443.8135,-1888.3039 1460.7492,-1883.6265 1526.7905,-1866.5524 1541.2143,-1862.8233 1769.2354,-1790.5264 1781.1273,-1781.5524"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge150" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#5400ff" stroke-dasharray="5,2" d="M997.7809,-1792.2829C1061.3664,-1752.7742 1272.7032,-1622.4992 1307.4386,-1614.5524"/>
</g>
<!-- sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~datahvacglobals.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~EfferentGraph_node5"><a xlink:href="../sourcefile/datahvacglobals.f90.html" xlink:title="DataHVACGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="658.8752,-1966.5578 543.4891,-1966.5578 543.4891,-1944.5469 658.8752,-1944.5469 658.8752,-1966.5578"/>
<text text-anchor="middle" x="601.1821" y="-1952.4024" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHVACGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~planticethermalstorage.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge185" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~planticethermalstorage.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-2070.5524C1219.6461,-2071.9217 1234.2919,-2099.1266 1307.4386,-2108.5524"/>
</g>
<!-- sourcefile~general.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~general.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~EfferentGraph_node6"><a xlink:href="../sourcefile/general.f90.html" xlink:title="General.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="829.3535,-1774.5578 762.616,-1774.5578 762.616,-1752.5469 829.3535,-1752.5469 829.3535,-1774.5578"/>
<text text-anchor="middle" x="795.9847" y="-1760.4024" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">General.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M618.1711,-1944.4826C635.8122,-1932.6227 663.7996,-1912.7625 685.3989,-1892.5524 723.5228,-1856.8804 761.7909,-1808.8718 781.7806,-1782.6363"/>
<polygon fill="#aaff00" stroke="#aaff00" points="784.5987,-1784.7124 787.8323,-1774.6231 779.0127,-1780.4937 784.5987,-1784.7124"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge53" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-2070.5524C1245.3929,-2098.405 1648.3321,-1687.2743 1681.626,-1635.5524 1709.9265,-1591.5875 1690.2887,-1568.1226 1717.626,-1523.5524 1728.3171,-1506.1217 1744.8096,-1489.9552 1758.3074,-1478.3636"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1760.7916,-1480.85 1766.246,-1471.767 1756.3179,-1475.4661 1760.7916,-1480.85"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M644.2686,-1966.6282C735.9096,-1989.7461 957.2211,-2043.2468 1145.9073,-2070.5524"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~planticethermalstorage.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge186" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~planticethermalstorage.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M829.4188,-1764.0295C843.4768,-1765.8053 859.1771,-1770.055 870.5706,-1779.5524 902.7138,-1806.3464 880.5026,-1833.8175 906.5706,-1866.5524 931.4138,-1897.7493 950.5435,-1891.3408 979.6978,-1918.5524"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1307.4386,-2108.5524C1378.9147,-2116.8465 1398.7004,-2122.2569 1469.339,-2108.5524"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-1918.5524C995.0835,-1932.9129 1286.5326,-2106.1264 1307.4386,-2108.5524"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-1610.5524C1007.5622,-1590.7114 1026.9931,-1608.9757 1052.825,-1586.5524 1077.9024,-1564.7838 1063.8225,-1540.9398 1088.4229,-1515.4978"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1090.935,-1517.9449 1096.0001,-1508.6392 1086.2374,-1512.7552 1090.935,-1517.9449"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ffaa00" stroke-dasharray="5,2" d="M829.6805,-1770.889C854.8084,-1776.3601 889.8006,-1783.979 919.6694,-1790.4823"/>
<polygon fill="#ffaa00" stroke="#ffaa00" points="919.0651,-1793.9327 929.5808,-1792.6404 920.5544,-1787.0929 919.0651,-1793.9327"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#54ff00" stroke-dasharray="5,2" d="M797.9111,-1752.4197C807.1307,-1699.9606 848.7022,-1472.4622 906.5706,-1292.5524 925.2192,-1234.5746 954.6205,-1168.9454 969.8389,-1136.2981"/>
<polygon fill="#54ff00" stroke="#54ff00" points="973.1656,-1137.448 974.2499,-1126.9088 966.8299,-1134.4715 973.1656,-1137.448"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge68" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M979.6978,-1726.5524C1054.5512,-1714.758 1071.3146,-1751.2081 1145.9073,-1764.5524"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1145.9073,-1764.5524C1386.9829,-1807.6796 1490.7595,-1789.0038 1681.626,-1635.5524 1710.1304,-1612.6356 1690.6092,-1586.2054 1717.626,-1561.5524 1739.9129,-1541.2153 1750.96,-1537.0644 1781.1273,-1537.5524"/>
</g>
<!-- sourcefile~psychroutines.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~psychroutines.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~EfferentGraph_node9"><a xlink:href="../sourcefile/psychroutines.f90.html" xlink:title="PsychRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1195.4562,-1928.5578 1096.3585,-1928.5578 1096.3585,-1906.5469 1195.4562,-1906.5469 1195.4562,-1928.5578"/>
<text text-anchor="middle" x="1145.9073" y="-1914.4024" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PsychRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge74" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00ff55" stroke-dasharray="5,2" d="M814.7981,-1774.6838C836.5167,-1787.3153 873.5008,-1808.1579 906.5706,-1823.5524 974.534,-1855.1903 1056.3209,-1885.7696 1104.5503,-1903.0651"/>
<polygon fill="#00ff55" stroke="#00ff55" points="1103.4304,-1906.3815 1114.025,-1906.4466 1105.7833,-1899.7888 1103.4304,-1906.3815"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge84" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M1781.1273,-1781.5524C1868.8863,-1719.7906 1810.7261,-1642.9758 1880.6287,-1561.5524 1914.1356,-1522.523 1966.3909,-1492.8346 2000.8826,-1476.0522"/>
<polygon fill="#0054ff" stroke="#0054ff" points="2002.5821,-1479.1196 2010.1096,-1471.6639 1999.5756,-1472.7981 2002.5821,-1479.1196"/>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M1145.9073,-1764.5524C1173.6252,-1773.3594 1212.0878,-1845.5013 1238.9897,-1856.5524 1295.2696,-1879.6717 1315.4501,-1863.5704 1375.8875,-1856.5524 1460.6567,-1846.7089 1478.9256,-1828.3443 1562.7905,-1812.5524 1610.95,-1803.4838 1741.2211,-1809.9965 1781.1273,-1781.5524"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge151" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#5400ff" stroke-dasharray="5,2" d="M829.3543,-1755.9435C866.0491,-1747.7847 926.8298,-1734.8825 979.6978,-1726.5524"/>
<path fill="none" stroke="#5400ff" stroke-dasharray="5,2" d="M979.6978,-1726.5524C1012.8686,-1721.3258 1024.4454,-1725.503 1052.825,-1707.5524 1073.8895,-1694.2287 1067.6697,-1677.7316 1088.825,-1664.5524 1110.9964,-1650.7401 1120.7101,-1657.4409 1145.9073,-1650.5524"/>
<path fill="none" stroke="#5400ff" stroke-dasharray="5,2" d="M1145.9073,-1650.5524C1216.8568,-1631.1559 1235.9523,-1631.8656 1307.4386,-1614.5524"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge164" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M797.7273,-1752.407C811.6424,-1663.4181 904.2555,-1071.3688 906.5706,-1062.5524 923.8648,-996.6898 955.0519,-922.1677 970.5053,-886.999"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="973.7388,-888.3411 974.5932,-877.7808 967.3398,-885.5033 973.7388,-888.3411"/>
</g>
<!-- sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~dataenvironment.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~EfferentGraph_node19"><a xlink:href="../sourcefile/dataenvironment.f90.html" xlink:title="DataEnvironment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1034.8358,-1698.5578 924.5597,-1698.5578 924.5597,-1676.5469 1034.8358,-1676.5469 1034.8358,-1698.5578"/>
<text text-anchor="middle" x="979.6978" y="-1684.4024" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEnvironment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge178" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#ff0055" stroke-dasharray="5,2" d="M829.5343,-1754.6732C842.6923,-1750.5888 857.6932,-1745.1659 870.5706,-1738.5524 888.1271,-1729.5357 889.0412,-1721.6216 906.5706,-1712.5524 914.1935,-1708.6085 922.5728,-1705.0746 930.8545,-1701.992"/>
<polygon fill="#ff0055" stroke="#ff0055" points="932.2225,-1705.2207 940.4806,-1698.5832 929.8858,-1698.6222 932.2225,-1705.2207"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge52" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-1650.5524C1376.7838,-1587.4344 1485.0794,-1732.1439 1681.626,-1595.5524 1711.0051,-1575.1351 1696.6493,-1552.5347 1717.626,-1523.5524 1729.7659,-1506.7793 1746.485,-1490.389 1759.7207,-1478.5324"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1762.2222,-1480.9942 1767.4395,-1471.773 1757.6105,-1475.728 1762.2222,-1480.9942"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge131" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-1610.5524C1007.5622,-1590.7114 1020.9819,-1599.0469 1052.825,-1586.5524 1121.1982,-1559.724 1137.1014,-1550.0082 1202.9897,-1517.5524 1250.054,-1494.3691 1256.1656,-1473.6691 1307.4386,-1462.5524"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge99" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M979.6978,-1610.5524C1014.4077,-1585.8371 1026.4177,-1581.9931 1052.825,-1548.5524 1074.7515,-1520.7858 1062.0269,-1500.6525 1088.825,-1477.5524 1109.0775,-1460.0945 1119.2188,-1460.1848 1145.9073,-1458.5524"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M802.5054,-1752.4437C817.6211,-1727.6398 857.5345,-1667.3572 906.5706,-1634.5524 935.0016,-1615.5322 951.8333,-1630.3933 979.6978,-1610.5524"/>
</g>
<!-- sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_node36" class="node">
<title>sourcefile~dataheatbalance.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~EfferentGraph_node36"><a xlink:href="../sourcefile/dataheatbalance.f90.html" xlink:title="DataHeatBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1201.7241,-2158.5578 1090.0905,-2158.5578 1090.0905,-2136.5469 1201.7241,-2136.5469 1201.7241,-2158.5578"/>
<text text-anchor="middle" x="1145.9073" y="-2144.4024" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge118" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M979.6978,-1918.5524C1044.2432,-1978.7968 1034.7713,-2014.7404 1088.825,-2084.5524 1100.9811,-2100.2524 1116.1249,-2116.8496 1127.7592,-2129.0652"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1125.3726,-2131.6327 1134.8311,-2136.4065 1130.414,-2126.7763 1125.3726,-2131.6327"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~planticethermalstorage.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge187" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~planticethermalstorage.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1622.2083,-1230.5524C1736.866,-1325.4512 1616.2617,-1442.5684 1717.626,-1551.5524 1738.174,-1573.645 1753.495,-1563.438 1781.1273,-1575.5524"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1781.1273,-1575.5524C1837.0203,-1600.0566 1858.5533,-1587.2948 1918.4414,-1575.5524"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1028.991,-1109.3504C1146.2986,-1097.442 1445.4315,-1084.2394 1622.2083,-1230.5524"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge54" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1016.2494,-1104.4279C1028.0851,-1100.464 1041.1623,-1095.6953 1052.825,-1090.5524 1293.7841,-984.2957 1463.0297,-716.7573 1622.2083,-926.5524"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~planticethermalstorage.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge188" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~planticethermalstorage.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2035.8962,-1575.5524C2097.0883,-1569.5489 2149.2996,-1511.2083 2173.1158,-1480.01"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2176.1763,-1481.7586 2179.3199,-1471.6409 2170.553,-1477.5899 2176.1763,-1481.7586"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1923.0501,-1471.7764C1936.2043,-1501.8078 1976.8206,-1581.3482 2035.8962,-1575.5524"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge85" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M1956.2514,-1460.5524C1964.4455,-1460.5524 1973.2646,-1460.5524 1981.9437,-1460.5524"/>
<polygon fill="#0054ff" stroke="#0054ff" points="1982.0221,-1464.0525 1992.0221,-1460.5524 1982.022,-1457.0525 1982.0221,-1464.0525"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~planticethermalstorage.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge189" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~planticethermalstorage.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1469.339,-2108.5524C1536.7092,-2096.3594 1559.0839,-2116.0614 1622.2083,-2089.5524"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1154.9046,-1928.683C1170.4155,-1947.2868 1203.9161,-1984.9755 1238.9897,-2008.5524 1285.3029,-2039.6845 1414.4268,-2118.4906 1469.339,-2108.5524"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge154" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#5400ff" stroke-dasharray="5,2" d="M1161.4839,-1906.3679C1231.165,-1856.3345 1514.5317,-1652.8677 1598.593,-1592.5089"/>
<polygon fill="#5400ff" stroke="#5400ff" points="1600.669,-1595.3271 1606.7505,-1586.6515 1596.5862,-1589.6411 1600.669,-1595.3271"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~dataprecisionglobals.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~EfferentGraph_node10"><a xlink:href="../sourcefile/dataprecisionglobals.f90.html" xlink:title="DataPrecisionGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="130.719,-2022.5578 -.2403,-2022.5578 -.2403,-2000.5469 130.719,-2000.5469 130.719,-2022.5578"/>
<text text-anchor="middle" x="65.2394" y="-2008.4024" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPrecisionGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~planticethermalstorage.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge190" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~planticethermalstorage.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-2300.5524C1191.4545,-2245.0592 1240.7585,-2327.157 1307.4386,-2300.5524"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9847,-2452.5524C821.6507,-2429.9374 845.2094,-2456.5087 870.5706,-2433.5524 892.5287,-2413.6764 1046.1266,-1961.4028 1052.825,-1932.5524 1086.5917,-1787.1166 1043.1514,-1740.699 1088.825,-1598.5524 1098.612,-1568.0927 1118.2304,-1536.5475 1131.7117,-1516.9908"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1134.6886,-1518.8426 1137.5916,-1508.6532 1128.968,-1514.8083 1134.6886,-1518.8426"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataloopnode.f90</title>
<path fill="none" stroke="#ff5400" stroke-dasharray="5,2" d="M399.0839,-503.5524C523.1552,-481.562 671.3479,-511.0338 746.7053,-529.9257"/>
<polygon fill="#ff5400" stroke="#ff5400" points="746.29,-533.4319 756.8451,-532.5148 748.0219,-526.6495 746.29,-533.4319"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ffaa00" stroke-dasharray="5,2" d="M399.0839,-2566.5524C444.6961,-2571.5309 757.1408,-2476.9739 795.9847,-2452.5524"/>
<path fill="none" stroke="#ffaa00" stroke-dasharray="5,2" d="M223.8406,-2472.5524C289.1871,-2532.0622 312.2226,-2550.2207 399.0839,-2566.5524"/>
<path fill="none" stroke="#ffaa00" stroke-dasharray="5,2" d="M795.9847,-2452.5524C821.6507,-2429.9374 848.6734,-2459.8334 870.5706,-2433.5524 945.9943,-2343.0285 866.4656,-2015.3445 906.5706,-1904.5524 918.3048,-1872.136 943.7381,-1840.966 961.2861,-1822.036"/>
<polygon fill="#ffaa00" stroke="#ffaa00" points="963.9041,-1824.3621 968.261,-1814.7045 958.8325,-1819.5371 963.9041,-1824.3621"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M223.8406,-2259.5524C274.8989,-2287.6008 273.0112,-2205.5102 317.2024,-2167.5524 341.4959,-2146.6856 514.1175,-2019.5292 577.7247,-1972.7785"/>
<polygon fill="#ffff00" stroke="#ffff00" points="579.9637,-1975.4766 585.9497,-1966.7349 575.8188,-1969.8357 579.9637,-1975.4766"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M68.2977,-2022.6583C80.1399,-2063.2532 127.2019,-2204.1086 223.8406,-2259.5524"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M223.8406,-1764.5524C254.1485,-1735.5819 559.2987,-1762.6442 601.1821,-1764.5524"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#54ff00" stroke-dasharray="5,2" d="M399.0839,-503.5524C436.0109,-497.8903 456.2156,-494.5681 480.9653,-522.5524 581.6346,-636.3779 419.1502,-746.2649 516.9653,-862.5524 567.0714,-922.121 612.5101,-883.2348 685.3989,-910.5524 736.2563,-929.6129 747.1798,-938.7229 795.9847,-962.5524"/>
<path fill="none" stroke="#54ff00" stroke-dasharray="5,2" d="M795.9847,-962.5524C834.4666,-981.3415 843.3394,-990.5017 870.5706,-1023.5524 892.0662,-1049.6417 880.7939,-1068.6828 906.5706,-1090.5524 911.0274,-1094.3337 916.085,-1097.552 921.4097,-1100.2895"/>
<polygon fill="#54ff00" stroke="#54ff00" points="920.0128,-1103.4991 930.5643,-1104.4569 922.9131,-1097.1282 920.0128,-1103.4991"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge69" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M979.6978,-10.5524C1032.0659,15.0512 1815.2852,-554.1844 1844.6287,-604.5524 1887.9071,-678.8396 1913.1003,-1313.5994 1917.6813,-1439.0611"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1914.1919,-1439.4223 1918.05,-1449.2897 1921.1874,-1439.1701 1914.1919,-1439.4223"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge75" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00ff55" stroke-dasharray="5,2" d="M399.0839,-2566.5524C572.4466,-2599.148 623.0061,-2601.1284 795.9847,-2566.5524"/>
<path fill="none" stroke="#00ff55" stroke-dasharray="5,2" d="M795.9847,-2566.5524C940.0934,-2529.2153 981.7632,-2482.3636 1052.825,-2351.5524 1115.8753,-2235.4887 1055.4372,-2184.3466 1088.825,-2056.5524 1100.2857,-2012.6854 1122.4943,-1964.3158 1135.5752,-1937.7753"/>
<polygon fill="#00ff55" stroke="#00ff55" points="1138.7577,-1939.2366 1140.1002,-1928.7271 1132.4969,-1936.1055 1138.7577,-1939.2366"/>
</g>
<!-- sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~databranchairloopplant.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~EfferentGraph_node11"><a xlink:href="../sourcefile/databranchairloopplant.f90.html" xlink:title="DataBranchAirLoopPlant.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="868.5702,-362.5578 723.3993,-362.5578 723.3993,-340.5469 868.5702,-340.5469 868.5702,-362.5578"/>
<text text-anchor="middle" x="795.9847" y="-348.4024" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBranchAirLoopPlant.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge80" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-503.5524C436.034,-498.043 451.4958,-507.5135 480.9653,-484.5524 508.5619,-463.0505 489.305,-435.9721 516.9653,-414.5524 572.9187,-371.2228 653.0386,-356.6112 713.0813,-352.1717"/>
<polygon fill="#00ffff" stroke="#00ffff" points="713.5432,-355.649 723.2918,-351.4997 713.0835,-348.6641 713.5432,-355.649"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-656.5524C281.6853,-612.7048 257.0966,-563.2454 317.2024,-522.5524 348.138,-501.6082 362.1568,-509.2145 399.0839,-503.5524"/>
</g>
<!-- sourcefile~dataglobals.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~dataglobals.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~EfferentGraph_node12"><a xlink:href="../sourcefile/dataglobals.f90.html" xlink:title="DataGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="267.6355,-1431.5578 180.0456,-1431.5578 180.0456,-1409.5469 267.6355,-1409.5469 267.6355,-1431.5578"/>
<text text-anchor="middle" x="223.8406" y="-1417.4024" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge81" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M68.1964,-2000.5334C87.2242,-1929.6299 192.4423,-1537.5527 218.1654,-1441.6997"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="221.5642,-1442.5381 220.7758,-1431.9726 214.8035,-1440.7237 221.5642,-1442.5381"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge87" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M65.6131,-2000.247C69.8786,-1874.7529 111.3252,-745.0452 223.8406,-656.5524"/>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M979.6978,-10.5524C1075.7672,22.2276 1105.1369,-31.5583 1202.9897,-58.5524 1392.6242,-110.8657 1429.5752,-160.6724 1622.2083,-200.5524"/>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M1918.4414,-314.5524C1997.9189,-400.6831 2030.3223,-1289.8095 2035.2259,-1439.2808"/>
<polygon fill="#0054ff" stroke="#0054ff" points="2031.7326,-1439.5477 2035.5535,-1449.4296 2038.7289,-1439.3218 2031.7326,-1439.5477"/>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M601.1821,-274.5524C668.0685,-255.6778 658.5111,-204.1355 721.3989,-174.5524 751.9189,-160.1954 765.3944,-174.7587 795.9847,-160.5524"/>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M223.8406,-656.5524C304.7647,-592.9059 252.6865,-524.7851 317.2024,-444.5524 386.1137,-358.8534 418.155,-346.8183 516.9653,-298.5524 551.9361,-281.4702 563.725,-285.1224 601.1821,-274.5524"/>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M1622.2083,-200.5524C1657.0544,-205.9905 1894.5244,-288.6332 1918.4414,-314.5524"/>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M795.9847,-160.5524C891.5879,-116.1536 876.04,-29.6908 979.6978,-10.5524"/>
</g>
<!-- sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~dataipshortcuts.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~EfferentGraph_node14"><a xlink:href="../sourcefile/dataipshortcuts.f90.html" xlink:title="DataIPShortCuts.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="453.3838,-1736.5578 344.7839,-1736.5578 344.7839,-1714.5469 453.3838,-1714.5469 453.3838,-1736.5578"/>
<text text-anchor="middle" x="399.0839" y="-1722.4024" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataIPShortCuts.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge92" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M223.8406,-1764.5524C253.0851,-1736.5984 297.724,-1726.9651 334.629,-1724.2608"/>
<polygon fill="#0000ff" stroke="#0000ff" points="335.0324,-1727.7434 344.8138,-1723.6723 334.6286,-1720.7551 335.0324,-1727.7434"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge155" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#5400ff" stroke-dasharray="5,2" d="M1145.9073,-2300.5524C1165.6084,-2278.8587 1181.5212,-2287.4985 1202.9897,-2267.5524 1390.4367,-2093.3976 1402.6691,-2015.2936 1526.7905,-1791.5524 1565.0467,-1722.5919 1599.6858,-1635.3076 1614.5431,-1596.1745"/>
<polygon fill="#5400ff" stroke="#5400ff" points="1617.8711,-1597.2682 1618.1183,-1586.6763 1611.3198,-1594.8022 1617.8711,-1597.2682"/>
</g>
<!-- sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~datainterfaces.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~EfferentGraph_node16"><a xlink:href="../sourcefile/datainterfaces.f90.html" xlink:title="DataInterfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="447.8836,-859.5578 350.2841,-859.5578 350.2841,-837.5469 447.8836,-837.5469 447.8836,-859.5578"/>
<text text-anchor="middle" x="399.0839" y="-845.4024" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataInterfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge161" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90</title>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M223.8406,-656.5524C278.9417,-612.1368 267.8972,-734.7796 317.2024,-785.5524 334.334,-803.1939 356.6008,-820.0089 373.5889,-831.8229"/>
<polygon fill="#aa00ff" stroke="#aa00ff" points="371.7041,-834.774 381.9362,-837.5228 375.6516,-828.9932 371.7041,-834.774"/>
</g>
<!-- sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~inputprocessor.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~EfferentGraph_node18"><a xlink:href="../sourcefile/inputprocessor.f90.html" xlink:title="InputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="650.7412,-1354.5578 551.623,-1354.5578 551.623,-1332.5469 650.7412,-1332.5469 650.7412,-1354.5578"/>
<text text-anchor="middle" x="601.1821" y="-1340.4024" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">InputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge171" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M223.8406,-656.5524C354.206,-551.4683 238.9046,-873.5413 317.2024,-1021.5524 388.3329,-1156.0147 526.5286,-1280.7291 579.6564,-1325.7841"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="577.5231,-1328.5632 587.4294,-1332.3204 582.0283,-1323.2056 577.5231,-1328.5632"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge181" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#ff0055" stroke-dasharray="5,2" d="M66.7633,-2022.7366C75.0864,-2082.593 116.5107,-2364.9878 166.4788,-2435.5524 184.0109,-2460.3111 201.4103,-2452.1256 223.8406,-2472.5524"/>
<path fill="none" stroke="#ff0055" stroke-dasharray="5,2" d="M601.1821,-2414.5524C636.7217,-2400.0877 656.543,-2420.8432 685.3989,-2395.5524 774.818,-2317.1806 838.2991,-2007.9921 870.5706,-1893.5524 892.8317,-1814.6109 852.5582,-1774.2773 906.5706,-1712.5524 909.5843,-1709.1083 913.0931,-1706.1382 916.9117,-1703.5768"/>
<polygon fill="#ff0055" stroke="#ff0055" points="918.7211,-1706.5744 925.6938,-1698.5974 915.2685,-1700.4851 918.7211,-1706.5744"/>
<path fill="none" stroke="#ff0055" stroke-dasharray="5,2" d="M223.8406,-2472.5524C349.292,-2586.7986 447.8228,-2487.1552 601.1821,-2414.5524"/>
</g>
<!-- sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_node21" class="node">
<title>sourcefile~datasystemvariables.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~EfferentGraph_node21"><a xlink:href="../sourcefile/datasystemvariables.f90.html" xlink:title="DataSystemVariables.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.7837,-1509.5578 334.3841,-1509.5578 334.3841,-1487.5469 463.7837,-1487.5469 463.7837,-1509.5578"/>
<text text-anchor="middle" x="399.0839" y="-1495.4024" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSystemVariables.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M70.046,-2000.4008C86.6035,-1963.0209 144.6376,-1840.2602 223.8406,-1764.5524"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-1764.5524C244.9521,-1744.3725 350.5434,-1576.3805 386.8218,-1518.253"/>
<polygon fill="#00ffff" stroke="#00ffff" points="389.8891,-1519.9487 392.2097,-1509.6111 383.949,-1516.2452 389.8891,-1519.9487"/>
</g>
<!-- sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_node22" class="node">
<title>sourcefile~datasurfaces.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~EfferentGraph_node22"><a xlink:href="../sourcefile/datasurfaces.f90.html" xlink:title="DataSurfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="647.8111,-2386.5578 554.5531,-2386.5578 554.5531,-2364.5469 647.8111,-2364.5469 647.8111,-2386.5578"/>
<text text-anchor="middle" x="601.1821" y="-2372.4024" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSurfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-2337.5524C447.4923,-2350.1726 503.4567,-2360.3622 544.2019,-2367.0009"/>
<polygon fill="#ff0000" stroke="#ff0000" points="543.7902,-2370.4796 554.2191,-2368.6115 544.9015,-2363.5684 543.7902,-2370.4796"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_node23" class="node">
<title>sourcefile~dataruntimelanguage.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~EfferentGraph_node23"><a xlink:href="../sourcefile/dataruntimelanguage.f90.html" xlink:title="DataRuntimeLanguage.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="669.6908,-1736.5578 532.6734,-1736.5578 532.6734,-1714.5469 669.6908,-1714.5469 669.6908,-1736.5578"/>
<text text-anchor="middle" x="601.1821" y="-1722.4024" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRuntimeLanguage.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-2259.5524C273.5371,-2288.0643 440.4605,-2281.0743 480.9653,-2240.5524 558.1526,-2163.3325 448.5006,-1835.6016 516.9653,-1750.5524 519.5281,-1747.3688 522.4772,-1744.5778 525.7035,-1742.132"/>
<polygon fill="#00ffff" stroke="#00ffff" points="527.6524,-1745.0407 534.2323,-1736.7367 523.9102,-1739.1249 527.6524,-1745.0407"/>
</g>
<!-- sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_node24" class="node">
<title>sourcefile~datavectortypes.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~EfferentGraph_node24"><a xlink:href="../sourcefile/datavectortypes.f90.html" xlink:title="DataVectorTypes.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="278.8255,-2426.5578 168.8556,-2426.5578 168.8556,-2404.5469 278.8255,-2404.5469 278.8255,-2426.5578"/>
<text text-anchor="middle" x="223.8406" y="-2412.4024" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataVectorTypes.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M69.4235,-2022.5579C83.1497,-2058.6238 128.128,-2176.5003 166.4788,-2273.5524 183.6343,-2316.9668 204.2387,-2367.622 215.4923,-2395.1662"/>
<polygon fill="#ff0000" stroke="#ff0000" points="212.2959,-2396.5968 219.3208,-2404.5279 218.7751,-2393.9471 212.2959,-2396.5968"/>
</g>
<!-- sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_node25" class="node">
<title>sourcefile~databsdfwindow.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~EfferentGraph_node25"><a xlink:href="../sourcefile/databsdfwindow.f90.html" xlink:title="DataBSDFWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="457.5516,-2387.5578 340.6161,-2387.5578 340.6161,-2365.5469 457.5516,-2365.5469 457.5516,-2387.5578"/>
<text text-anchor="middle" x="399.0839" y="-2373.4024" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBSDFWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-2259.5524C274.8989,-2287.6008 267.1525,-2321.7418 317.2024,-2351.5524 324.1021,-2355.662 331.7368,-2359.1505 339.4889,-2362.097"/>
<polygon fill="#00ffff" stroke="#00ffff" points="338.3667,-2365.4124 348.9615,-2365.4276 340.6886,-2358.8087 338.3667,-2365.4124"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge57" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9847,-160.5524C902.9557,-114.0366 947.4102,-164.61 1052.825,-214.5524 1219.3851,-293.4636 1245.0376,-344.7542 1375.8875,-474.5524 1393.8258,-492.3466 1395.0979,-499.6704 1411.8875,-518.5524 1460.7405,-573.4938 1482.8646,-578.5973 1526.7905,-637.5524 1610.5937,-750.0286 1634.0301,-780.6111 1681.626,-912.5524 1752.6273,-1109.3762 1774.6902,-1365.0024 1779.8176,-1439.3919"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1776.326,-1439.6354 1780.4777,-1449.3829 1783.3108,-1439.1739 1776.326,-1439.6354"/>
</g>
<!-- sourcefile~datasizing.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_node27" class="node">
<title>sourcefile~datasizing.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~EfferentGraph_node27"><a xlink:href="../sourcefile/datasizing.f90.html" xlink:title="DataSizing.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="439.3754,-475.5578 358.7923,-475.5578 358.7923,-453.5469 439.3754,-453.5469 439.3754,-475.5578"/>
<text text-anchor="middle" x="399.0839" y="-461.4024" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSizing.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge65" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-656.5524C290.044,-603.1876 251.0121,-542.9335 317.2024,-489.5524 326.3298,-482.1913 337.6077,-476.993 348.8438,-473.3234"/>
<polygon fill="#00ffff" stroke="#00ffff" points="350.0243,-476.6253 358.6522,-470.4763 348.0729,-469.9028 350.0243,-476.6253"/>
</g>
<!-- sourcefile~dataerrortracking.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_node28" class="node">
<title>sourcefile~dataerrortracking.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~EfferentGraph_node28"><a xlink:href="../sourcefile/dataerrortracking.f90.html" xlink:title="DataErrorTracking.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1526.7421,-668.5578 1411.9359,-668.5578 1411.9359,-646.5469 1526.7421,-646.5469 1526.7421,-668.5578"/>
<text text-anchor="middle" x="1469.339" y="-654.4024" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataErrorTracking.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataerrortracking.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge50" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataerrortracking.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-274.5524C698.7319,-246.5249 960.0817,-301.319 1052.825,-342.5524 1127.2389,-375.6366 1139.0317,-397.1404 1202.9897,-447.5524 1227.3396,-466.745 1385.745,-615.8836 1411.8875,-632.5524 1417.425,-636.0832 1423.546,-639.3391 1429.6674,-642.2533"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1428.6474,-645.6323 1439.2031,-646.5422 1431.5187,-639.2482 1428.6474,-645.6323"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge133" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9847,-2566.5524C917.3768,-2538.762 960.7338,-2538.3828 1052.825,-2454.5524 1111.9666,-2400.7158 1096.4866,-2363.4309 1145.9073,-2300.5524"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-2300.5524C1175.0294,-2268.4848 1184.253,-2260.6082 1202.9897,-2221.5524 1212.4367,-2201.8607 1298.0479,-1862.2709 1307.4386,-1842.5524"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_node30" class="node">
<title>sourcefile~datacontaminantbalance.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~EfferentGraph_node30"><a xlink:href="../sourcefile/datacontaminantbalance.f90.html" xlink:title="DataContaminantBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="870.6565,-2424.5578 721.313,-2424.5578 721.313,-2402.5469 870.6565,-2402.5469 870.6565,-2424.5578"/>
<text text-anchor="middle" x="795.9847" y="-2410.4024" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataContaminantBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge146" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M601.1821,-2414.5524C640.1459,-2398.6941 687.2349,-2398.0101 725.3549,-2401.4985"/>
<polygon fill="#00ffff" stroke="#00ffff" points="725.0417,-2404.9846 735.3473,-2402.5258 725.7577,-2398.0213 725.0417,-2404.9846"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge102" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M223.8406,-656.5524C387.5395,-532.4651 485.1767,-634.6606 685.3989,-680.5524 772.4436,-700.5034 789.1855,-721.7924 870.5706,-758.5524 952.5462,-795.5792 991.6693,-780.5904 1052.825,-846.5524 1072.06,-867.2991 1225.9155,-1295.463 1238.9897,-1320.5524 1254.9794,-1351.2363 1277.9624,-1384.1051 1292.7978,-1404.2488"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1290.0194,-1406.3778 1298.7996,-1412.3072 1295.6334,-1402.1966 1290.0194,-1406.3778"/>
</g>
<!-- sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_node35" class="node">
<title>sourcefile~outputreportpredefined.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~EfferentGraph_node35"><a xlink:href="../sourcefile/outputreportpredefined.f90.html" xlink:title="OutputReportPredefined.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="470.9214,-553.5578 327.2463,-553.5578 327.2463,-531.5469 470.9214,-531.5469 470.9214,-553.5578"/>
<text text-anchor="middle" x="399.0839" y="-539.4024" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputReportPredefined.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge112" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M223.8406,-656.5524C268.4731,-620.5753 267.7084,-596.4791 317.2024,-567.5524 324.2271,-563.4468 331.9917,-559.9539 339.8585,-556.9994"/>
<polygon fill="#0000ff" stroke="#0000ff" points="341.1678,-560.2497 349.4621,-553.6575 338.8672,-553.6385 341.1678,-560.2497"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge120" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M223.8406,-2259.5524C266.428,-2283.9589 271.9118,-2299.6279 317.2024,-2318.5524 351.6729,-2332.9557 362.9335,-2328.1279 399.0839,-2337.5524"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M399.0839,-2337.5524C449.8372,-2350.7839 818.3459,-2355.6988 870.5706,-2360.5524 919.3175,-2365.0828 937.3037,-2400.0378 979.6978,-2375.5524"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M979.6978,-2375.5524C1008.9928,-2357.8919 1030.2327,-2377.2366 1052.825,-2351.5524 1106.8183,-2290.1695 1037.1211,-2230.9913 1087.5882,-2166.5603"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1090.4978,-2168.5442 1094.3548,-2158.6763 1085.186,-2163.9852 1090.4978,-2168.5442"/>
</g>
<!-- sourcefile~dataroomair.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_node37" class="node">
<title>sourcefile~dataroomair.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~EfferentGraph_node37"><a xlink:href="../sourcefile/dataroomair.f90.html" xlink:title="DataRoomAir.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="445.0438,-1012.5578 353.1239,-1012.5578 353.1239,-990.5469 445.0438,-990.5469 445.0438,-1012.5578"/>
<text text-anchor="middle" x="399.0839" y="-998.4024" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRoomAir.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataroomair.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge96" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataroomair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-656.5524C303.9964,-591.9409 269.3556,-777.3917 317.2024,-868.5524 339.0877,-910.2497 368.9635,-956.5828 385.9157,-982.0712"/>
<polygon fill="#ff0000" stroke="#ff0000" points="383.0671,-984.1077 391.5379,-990.4714 388.8844,-980.2142 383.0671,-984.1077"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_node38" class="node">
<title>sourcefile~datacomplexfenestration.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~EfferentGraph_node38"><a xlink:href="../sourcefile/datacomplexfenestration.f90.html" xlink:title="DataComplexFenestration.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="475.0737,-2231.5578 323.0941,-2231.5578 323.0941,-2209.5469 475.0737,-2209.5469 475.0737,-2231.5578"/>
<text text-anchor="middle" x="399.0839" y="-2217.4024" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataComplexFenestration.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge114" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-2259.5524C235.0304,-2265.6994 303.6814,-2248.0024 351.657,-2234.4649"/>
<polygon fill="#ff0000" stroke="#ff0000" points="352.8922,-2237.7524 361.5526,-2231.6493 350.9765,-2231.0197 352.8922,-2237.7524"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_node39" class="node">
<title>sourcefile~dataequivalentlayerwindow.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~EfferentGraph_node39"><a xlink:href="../sourcefile/dataequivalentlayerwindow.f90.html" xlink:title="DataEquivalentLayerWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="480.847,-2309.5578 317.3208,-2309.5578 317.3208,-2287.5469 480.847,-2287.5469 480.847,-2309.5578"/>
<text text-anchor="middle" x="399.0839" y="-2295.4024" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEquivalentLayerWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge116" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-2259.5524C249.1438,-2273.4525 279.0781,-2282.3996 306.9797,-2288.1581"/>
<polygon fill="#00ffff" stroke="#00ffff" points="306.6705,-2291.6635 317.155,-2290.1387 308.0079,-2284.7925 306.6705,-2291.6635"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~planticethermalstorage.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge191" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~planticethermalstorage.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M805.9058,-340.4867C821.4678,-322.6596 851.7766,-285.9844 870.5706,-250.5524 893.0973,-208.0829 868.1735,-177.4794 906.5706,-148.5524 1049.1261,-41.1561 1129.9318,-105.9146 1307.4386,-124.5524"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#54ff00" stroke-dasharray="5,2" d="M802.4863,-362.7507C817.639,-389.4956 855.1797,-459.6326 870.5706,-523.5524 885.3481,-584.9252 868.2468,-1040.3897 906.5706,-1090.5524 910.4727,-1095.66 915.4753,-1099.7314 921.0297,-1102.9757"/>
<polygon fill="#54ff00" stroke="#54ff00" points="919.6121,-1106.1784 930.1336,-1107.423 922.6846,-1099.8888 919.6121,-1106.1784"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge86" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M1307.4386,-314.5524C1446.4037,-330.6779 1483.3474,-297.5521 1622.2083,-314.5524"/>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M844.0988,-340.5431C901.8504,-327.9414 1001.8069,-308.0731 1088.825,-300.5524 1139.3764,-296.1833 1152.3624,-297.1745 1202.9897,-300.5524 1249.7227,-303.6704 1260.8975,-309.2973 1307.4386,-314.5524"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge56" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M798.3411,-362.7558C806.377,-397.9466 836.2074,-506.8728 906.5706,-556.5524 980.2072,-608.5431 1228.4522,-575.1181 1307.4386,-618.5524"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~planticethermalstorage.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge192" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~planticethermalstorage.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1916.5524C444.8574,-1953.1213 461.5781,-1956.4537 516.9653,-1975.5524 761.5674,-2059.8962 832.4871,-2049.4103 1088.825,-2084.5524 1185.6645,-2097.8284 1210.4948,-2096.06 1307.4386,-2108.5524"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1648.5524C446.393,-1671.9074 464.2975,-1637.6689 516.9653,-1634.5524 591.694,-1630.1304 610.6879,-1629.842 685.3989,-1634.5524 734.8423,-1637.6697 746.9538,-1655.6471 795.9847,-1648.5524"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M228.4375,-1431.671C244.8802,-1469.8471 304.8582,-1596.1081 399.0839,-1648.5524"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9847,-1648.5524C848.9817,-1636.674 856.0996,-1616.6135 906.5706,-1596.5524 970.1457,-1571.2826 994.2952,-1583.9732 1052.825,-1548.5524 1071.9165,-1536.9986 1069.4848,-1524.6849 1088.825,-1513.5524 1089.126,-1513.3791 1089.429,-1513.2076 1089.7339,-1513.0379"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1091.5008,-1516.0725 1099.0085,-1508.5969 1088.4776,-1509.7589 1091.5008,-1516.0725"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataloopnode.f90</title>
<path fill="none" stroke="#ff5400" stroke-dasharray="5,2" d="M601.1821,-542.5524C645.6902,-533.9739 696.9877,-534.6517 735.7669,-537.2451"/>
<polygon fill="#ff5400" stroke="#ff5400" points="735.621,-540.7437 745.8493,-537.981 736.1307,-533.7622 735.621,-540.7437"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ffaa00" stroke-dasharray="5,2" d="M399.0839,-1916.5524C409.5839,-1924.3852 772.4039,-1847.9007 919.0801,-1816.5676"/>
<polygon fill="#ffaa00" stroke="#ffaa00" points="920.2121,-1819.9048 929.2594,-1814.3914 918.7486,-1813.0594 920.2121,-1819.9048"/>
<path fill="none" stroke="#ffaa00" stroke-dasharray="5,2" d="M226.1552,-1431.9543C240.1987,-1499.966 316.1508,-1851.3689 399.0839,-1916.5524"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M399.0839,-1916.5524C437.3193,-1945.0753 490.6326,-1954.456 532.9019,-1956.9023"/>
<polygon fill="#ffff00" stroke="#ffff00" points="532.9671,-1960.409 543.1176,-1957.3729 533.2893,-1953.4164 532.9671,-1960.409"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M601.1821,-1648.5524C645.2103,-1658.764 649.9299,-1677.5398 685.3989,-1705.5524 702.4324,-1719.005 702.7011,-1727.5295 721.3989,-1738.5524 731.0368,-1744.2342 742.1443,-1748.8396 752.7938,-1752.4758"/>
<polygon fill="#aaff00" stroke="#aaff00" points="751.7989,-1755.8322 762.3899,-1755.5457 753.9319,-1749.1651 751.7989,-1755.8322"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#54ff00" stroke-dasharray="5,2" d="M224.4372,-1409.2667C228.0162,-1346.3015 248.8419,-1039.1849 317.2024,-981.5524 357.9069,-947.2357 747.8965,-939.7049 795.9847,-962.5524"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge70" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M399.0839,-581.5524C406.1544,-572.5656 589.954,-544.7165 601.1821,-542.5524"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M601.1821,-542.5524C639.3987,-535.1865 648.359,-530.5023 685.3989,-518.5524 701.5885,-513.3293 704.6444,-508.4964 721.3989,-505.5524 1048.8011,-448.0234 1143.9642,-436.4858 1469.339,-504.5524"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge76" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00ff55" stroke-dasharray="5,2" d="M399.0839,-1916.5524C421.2613,-1933.9833 878.3663,-1932.1079 906.5706,-1932.5524 971.5644,-1933.5767 988.0303,-1937.7397 1052.825,-1932.5524 1063.6932,-1931.6823 1075.2075,-1930.2495 1086.2958,-1928.6057"/>
<polygon fill="#00ff55" stroke="#00ff55" points="1086.9845,-1932.0408 1096.3285,-1927.0468 1085.9097,-1925.1238 1086.9845,-1932.0408"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge79" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M224.1867,-1409.3583C226.4339,-1344.7935 241.3486,-1013.9174 317.2024,-757.5524 341.6801,-674.8244 345.738,-649.3558 399.0839,-581.5524"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-581.5524C422.184,-552.1917 451.6267,-585.6806 480.9653,-562.5524 509.0619,-540.4033 493.9193,-517.9181 516.9653,-490.5524 546.905,-455.0009 558.7724,-447.5709 601.1821,-428.5524"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M601.1821,-428.5524C636.6946,-412.6269 650.6874,-422.1555 685.3989,-404.5524 703.477,-395.3845 703.5355,-386.1317 721.3989,-376.5524 728.8384,-372.5629 737.0337,-369.0424 745.1861,-365.9971"/>
<polygon fill="#00ffff" stroke="#00ffff" points="746.4252,-369.2715 754.6887,-362.6408 744.0939,-362.6711 746.4252,-369.2715"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge88" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M601.1821,-428.5524C673.7116,-396.0267 1227.9686,-312.8312 1307.4386,-314.5524"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge91" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M225.8978,-1431.7221C233.0376,-1468.1119 259.5283,-1585.3474 317.2024,-1662.5524 331.4624,-1681.6414 352.9717,-1697.8836 370.3668,-1709.0932"/>
<polygon fill="#0000ff" stroke="#0000ff" points="368.6889,-1712.1715 379.0281,-1714.4849 372.3882,-1706.2288 368.6889,-1712.1715"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge156" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#5400ff" stroke-dasharray="5,2" d="M601.1821,-810.5524C723.0725,-816.2491 757.3149,-818.1336 870.5706,-863.5524 888.193,-870.6195 889.5161,-878.2073 906.5706,-886.5524 968.538,-916.8741 991.3417,-907.2604 1052.825,-938.5524 1207.8648,-1017.4601 1246.3699,-1043.4103 1375.8875,-1159.5524 1423.3956,-1202.1542 1433.9537,-1215.4504 1469.339,-1268.5524"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge166" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M601.1821,-810.5524C689.2968,-814.6705 709.0854,-757.3983 795.9847,-772.5524"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M399.0839,-771.5524C462.464,-705.588 509.8033,-806.2816 601.1821,-810.5524"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge172" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M237.009,-1409.4044C254.1892,-1395.5974 285.7781,-1372.6652 317.2024,-1362.5524 391.748,-1338.5625 482.8322,-1336.9939 541.4073,-1339.2799"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="541.4514,-1342.7852 551.5959,-1339.7294 541.7599,-1335.792 541.4514,-1342.7852"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge179" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#ff0055" stroke-dasharray="5,2" d="M601.1821,-1648.5524C709.0501,-1673.5706 837.934,-1682.5467 914.0705,-1685.7625"/>
<polygon fill="#ff0055" stroke="#ff0055" points="914.3236,-1689.2754 924.4559,-1686.1791 914.6043,-1682.281 914.3236,-1689.2754"/>
<path fill="none" stroke="#ff0055" stroke-dasharray="5,2" d="M399.0839,-1648.5524C479.6255,-1688.3133 512.7465,-1632.8353 601.1821,-1648.5524"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M225.9731,-1431.6302C233.956,-1473.329 262.5693,-1624.8667 281.2024,-1750.5524 300.4429,-1880.3354 251.7287,-1929.8553 317.2024,-2043.5524 362.7612,-2122.6666 422.0264,-2097.8324 480.9653,-2167.5524 503.2961,-2193.9679 499.9947,-2206.412 516.9653,-2236.5524 541.2539,-2279.6898 571.8081,-2328.9891 588.6305,-2355.7414"/>
<polygon fill="#ff0000" stroke="#ff0000" points="585.8748,-2357.9331 594.1699,-2364.5242 591.7956,-2354.1988 585.8748,-2357.9331"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-1648.5524C451.6036,-1674.4797 515.1584,-1697.4002 556.7987,-1711.3512"/>
<polygon fill="#00ffff" stroke="#00ffff" points="555.7805,-1714.7009 566.374,-1714.5304 557.9864,-1708.0575 555.7805,-1714.7009"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M226.2261,-1431.5967C235.1078,-1473.1766 266.5008,-1624.3464 281.2024,-1750.5524 288.9429,-1817.0005 275.8097,-2298.9984 317.2024,-2351.5524 321.1857,-2356.6098 326.165,-2360.6714 331.6893,-2363.9296"/>
<polygon fill="#00ffff" stroke="#00ffff" points="330.239,-2367.117 340.754,-2368.4158 333.344,-2360.8433 330.239,-2367.117"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge58" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-771.5524C444.9405,-723.8259 456.3566,-707.1463 516.9653,-680.5524 661.5822,-617.0973 720.7489,-595.6118 870.5706,-645.5524 889.5442,-651.8769 888.8335,-663.3113 906.5706,-672.5524 936.9067,-688.3577 946.1315,-689.9646 979.6978,-696.5524"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1307.4386,-696.5524C1343.2794,-693.4148 1439.8357,-675.962 1469.339,-696.5524"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-696.5524C1124.052,-716.0315 1162.331,-709.2554 1307.4386,-696.5524"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.4333,-1409.0939C228.4071,-1335.6736 252.9989,-931.062 317.2024,-828.5524 340.7387,-790.9734 366.6772,-801.817 399.0839,-771.5524"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge64" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M224.6137,-1409.2774C231.7397,-1305.9918 286.4161,-527.0669 317.2024,-489.5524 325.2377,-479.761 336.9968,-473.7181 349.1102,-470.0131"/>
<polygon fill="#00ffff" stroke="#00ffff" points="350.0209,-473.3929 358.8364,-467.516 348.2802,-466.6128 350.0209,-473.3929"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge134" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-1458.5524C688.7887,-1468.8592 708.7319,-1509.5174 795.9847,-1496.5524"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9847,-1496.5524C803.4803,-1495.4386 1300.3629,-1303.8397 1307.4386,-1306.5524"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M267.7564,-1424.4938C338.1805,-1430.9225 480.6991,-1444.3777 601.1821,-1458.5524"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge144" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-2029.5524C419.8804,-2060.0578 453.2287,-2019.1852 480.9653,-2043.5524 521.8386,-2079.4603 490.1815,-2113.196 516.9653,-2160.5524 533.716,-2190.1692 692.9682,-2369.8592 721.3989,-2388.5524 727.4398,-2392.5242 734.1717,-2395.9225 741.0505,-2398.8145"/>
<polygon fill="#00ffff" stroke="#00ffff" points="739.8811,-2402.1147 750.4706,-2402.4506 742.4019,-2395.5843 739.8811,-2402.1147"/>
</g>
<!-- sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_node31" class="node">
<title>sourcefile~sortandstringutilities.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~EfferentGraph_node31"><a xlink:href="../sourcefile/sortandstringutilities.f90.html" xlink:title="SortAndStringUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.3044,-1393.5578 334.8633,-1393.5578 334.8633,-1371.5469 463.3044,-1371.5469 463.3044,-1393.5578"/>
<text text-anchor="middle" x="399.0839" y="-1379.4024" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SortAndStringUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge93" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M267.6098,-1411.0614C288.988,-1406.4257 315.0587,-1400.7725 338.33,-1395.7263"/>
<polygon fill="#ff0000" stroke="#ff0000" points="339.0791,-1399.1453 348.1102,-1393.6056 337.5956,-1392.3043 339.0791,-1399.1453"/>
</g>
<!-- sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_node32" class="node">
<title>sourcefile~dataoutputs.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~EfferentGraph_node32"><a xlink:href="../sourcefile/dataoutputs.f90.html" xlink:title="DataOutputs.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="443.5485,-1315.5578 354.6193,-1315.5578 354.6193,-1293.5469 443.5485,-1293.5469 443.5485,-1315.5578"/>
<text text-anchor="middle" x="399.0839" y="-1301.4024" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataOutputs.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge94" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M232.3519,-1409.2894C247.3982,-1390.1443 280.5839,-1351.2277 317.2024,-1329.5524 325.7401,-1324.4987 335.3924,-1320.3808 344.9975,-1317.0542"/>
<polygon fill="#ffff00" stroke="#ffff00" points="346.0945,-1320.3781 354.5439,-1313.9861 343.9526,-1313.7138 346.0945,-1320.3781"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge104" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M601.1821,-1458.5524C639.4485,-1465.6547 650.6874,-1464.9493 685.3989,-1482.5524 703.477,-1491.7202 702.2263,-1503.9741 721.3989,-1510.5524 784.1089,-1532.0686 804.5606,-1516.7311 870.5706,-1510.5524 994.5637,-1498.9463 1021.9087,-1470.0994 1145.9073,-1458.5524"/>
</g>
<!-- sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_node34" class="node">
<title>sourcefile~dataglobalconstants.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~EfferentGraph_node34"><a xlink:href="../sourcefile/dataglobalconstants.f90.html" xlink:title="DataGlobalConstants.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="860.8052,-1278.5578 731.1643,-1278.5578 731.1643,-1256.5469 860.8052,-1256.5469 860.8052,-1278.5578"/>
<text text-anchor="middle" x="795.9847" y="-1264.4024" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobalConstants.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge109" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataglobalconstants.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M227.4937,-1409.4799C237.1143,-1382.3416 265.9963,-1312.6825 317.2024,-1284.5524 384.5156,-1247.5737 603.8716,-1255.1004 720.8754,-1262.1647"/>
<polygon fill="#00ffff" stroke="#00ffff" points="720.9857,-1265.6781 731.1826,-1262.8018 721.4176,-1258.6914 720.9857,-1265.6781"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge111" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M224.3218,-1409.5066C228.5569,-1314.4161 260.6608,-635.8172 317.2024,-567.5524 319.8467,-564.3598 322.8867,-561.5661 326.2049,-559.1223"/>
<polygon fill="#0000ff" stroke="#0000ff" points="328.273,-561.9595 334.9587,-553.7405 324.6068,-555.9963 328.273,-561.9595"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge121" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M225.8319,-1431.8749C238.8681,-1505.9413 311.666,-1918.6708 317.2024,-1930.5524 341.319,-1982.309 368.0958,-1981.593 399.0839,-2029.5524"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M399.0839,-2029.5524C409.1021,-2045.0573 463.0495,-2039.1034 480.9653,-2043.5524 590.1297,-2070.6605 611.2756,-2099.6491 721.3989,-2122.5524 834.2775,-2146.0286 865.7437,-2129.0262 979.6978,-2146.5524"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataroomair.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge95" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataroomair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M228.5279,-1409.3451C252.2854,-1352.5419 359.4846,-1096.2328 390.5952,-1021.8484"/>
<polygon fill="#ff0000" stroke="#ff0000" points="393.8338,-1023.1757 394.4635,-1012.5996 387.3759,-1020.4747 393.8338,-1023.1757"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge113" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M226.1413,-1431.607C234.7218,-1473.2236 265.1831,-1624.5069 281.2024,-1750.5524 287.4566,-1799.7625 286.1034,-2156.9052 317.2024,-2195.5524 319.8013,-2198.782 322.8058,-2201.6047 326.0967,-2204.0708"/>
<polygon fill="#ff0000" stroke="#ff0000" points="324.461,-2207.1755 334.7989,-2209.4947 328.1637,-2201.2349 324.461,-2207.1755"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge115" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M226.1713,-1431.6033C234.8582,-1473.2065 265.6487,-1624.4486 281.2024,-1750.5524 294.5677,-1858.9136 263.5293,-2145.4735 317.2024,-2240.5524 327.6074,-2258.9842 346.5799,-2272.985 363.6437,-2282.6088"/>
<polygon fill="#00ffff" stroke="#00ffff" points="362.3875,-2285.9047 372.8607,-2287.5055 365.6717,-2279.7229 362.3875,-2285.9047"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_node40" class="node">
<title>sourcefile~databranchnodeconnections.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~EfferentGraph_node40"><a xlink:href="../sourcefile/databranchnodeconnections.f90.html" xlink:title="DataBranchNodeConnections.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="685.6163,-744.5578 516.748,-744.5578 516.748,-722.5469 685.6163,-722.5469 685.6163,-744.5578"/>
<text text-anchor="middle" x="601.1821" y="-730.4024" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBranchNodeConnections.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchnodeconnections.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge162" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchnodeconnections.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-771.5524C426.5585,-742.9575 468.2375,-732.0227 506.6226,-728.8061"/>
<polygon fill="#ff0000" stroke="#ff0000" points="507.0785,-732.2835 516.8217,-728.1217 506.6098,-725.2992 507.0785,-732.2835"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~planticethermalstorage.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge193" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~planticethermalstorage.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2079.5748,-1460.5524C2087.7391,-1460.5524 2096.5111,-1460.5524 2105.3947,-1460.5524"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2105.4456,-1464.0525 2115.4456,-1460.5524 2105.4455,-1457.0525 2105.4456,-1464.0525"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~planticethermalstorage.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge194" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~planticethermalstorage.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1307.4386,-2300.5524C1415.149,-2271.263 1359.7605,-2129.8116 1469.339,-2108.5524"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M404.2199,-1736.7079C426.2988,-1784.6304 512.2426,-1970.8168 516.9653,-1975.5524 584.0241,-2042.793 1215.802,-2325.4708 1307.4386,-2300.5524"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M448.3442,-1714.5418C523.1353,-1698.1553 669.9714,-1667.2769 795.9847,-1648.5524"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M601.1821,-1764.5524C653.1303,-1766.9191 712.9507,-1766.0821 752.4466,-1765.036"/>
<polygon fill="#aaff00" stroke="#aaff00" points="752.6302,-1768.5323 762.5279,-1764.7527 752.4334,-1761.535 752.6302,-1768.5323"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M438.1777,-1736.5967C478.5927,-1747.1836 543.7103,-1761.934 601.1821,-1764.5524"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#54ff00" stroke-dasharray="5,2" d="M413.5967,-1714.4226C429.9778,-1701.8516 457.4152,-1680.7704 480.9653,-1662.5524 496.9979,-1650.1499 500.8022,-1646.7842 516.9653,-1634.5524 591.0897,-1578.4566 613.7126,-1569.732 685.3989,-1510.5524 771.7874,-1439.2356 803.7386,-1429.4553 870.5706,-1339.5524 920.9016,-1271.8467 957.8797,-1177.2993 972.6399,-1136.1001"/>
<polygon fill="#54ff00" stroke="#54ff00" points="975.9626,-1137.2015 975.9835,-1126.6067 969.3602,-1134.876 975.9626,-1137.2015"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge173" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M421.7127,-1714.3903C440.7229,-1703.7694 466.9641,-1685.9457 480.9653,-1662.5524 531.3973,-1578.2904 476.0866,-1533.8406 516.9653,-1444.5524 532.0843,-1411.5293 560.9337,-1380.5465 580.6108,-1361.8203"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="583.2179,-1364.1756 588.1617,-1354.8049 578.4533,-1359.0473 583.2179,-1364.1756"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge136" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M418.8207,-1736.7079C441.6805,-1749.0795 480.8376,-1768.602 516.9653,-1778.5524 747.3837,-1842.0146 816.3549,-1858.2223 1052.825,-1823.5524 1121.7602,-1813.4455 1144.7422,-1816.7812 1202.9897,-1778.5524 1267.1658,-1736.4325 1410.1411,-1543.9543 1455.3517,-1481.8972"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1458.2457,-1483.8685 1461.2917,-1473.7209 1452.5824,-1479.7541 1458.2457,-1483.8685"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~planticethermalstorage.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge195" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~planticethermalstorage.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1681.1545,-1564.5189C1712.1466,-1561.3942 1750.0472,-1561.9264 1781.1273,-1575.5524"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge59" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1637.4461,-1564.5257C1665.2589,-1544.3992 1724.4262,-1501.5835 1757.5013,-1477.6491"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1759.6526,-1480.4126 1765.7021,-1471.7146 1755.5489,-1474.7416 1759.6526,-1480.4126"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~planticethermalstorage.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge196" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~planticethermalstorage.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M422.4852,-837.4081C441.7119,-826.9057 467.8416,-809.2441 480.9653,-785.5524 561.2394,-640.6372 424.3791,-551.9282 516.9653,-414.5524 564.1689,-344.5136 630.2618,-390.5329 685.3989,-326.5524 717.3301,-289.4998 686.435,-256.7578 721.3989,-222.5524 771.1833,-173.848 819.5574,-221.9682 870.5706,-174.5524 901.8239,-145.5029 871.1916,-109.4054 906.5706,-85.5524 963.4189,-47.2243 1266.2283,-118.8908 1307.4386,-124.5524"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1307.4386,-124.5524C1548.7839,-117.4423 1628.0433,-98.8336 1844.6287,-205.5524 1885.4599,-225.6713 1874.3057,-265.4168 1918.4414,-276.5524"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1918.4414,-276.5524C2161.5928,-324.2277 2184.5635,-1283.0351 2186.6931,-1439.1517"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2183.1955,-1439.3806 2186.8169,-1449.3372 2190.195,-1439.2954 2183.1955,-1439.3806"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-1076.5524C997.9613,-1104.7315 1031.0409,-1069.997 1052.825,-1095.5524 1107.4203,-1159.5997 1039.4747,-1404.3815 1088.825,-1472.5524 1091.0831,-1475.6717 1093.8168,-1478.4068 1096.8501,-1480.8044"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1095.1656,-1483.8837 1105.4586,-1486.3944 1098.9779,-1478.0129 1095.1656,-1483.8837"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ffaa00" stroke-dasharray="5,2" d="M406.4144,-859.7502C421.143,-882.399 455.1273,-935.4204 480.9653,-981.5524 498.2543,-1012.4206 492.3856,-1027.1046 516.9653,-1052.5524 641.6495,-1181.6398 774.1365,-1096.1913 870.5706,-1247.5524 934.1204,-1347.2991 834.5681,-1684.7246 906.5706,-1778.5524 910.2858,-1783.3938 914.9894,-1787.3041 920.2127,-1790.4612"/>
<polygon fill="#ffaa00" stroke="#ffaa00" points="918.9057,-1793.7217 929.4112,-1795.0948 922.0549,-1787.4701 918.9057,-1793.7217"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M408.6203,-859.697C426.5709,-881.428 465.0059,-931.7126 480.9653,-981.5524 516.8982,-1093.7671 460.2621,-1407.2661 516.9653,-1510.5524 561.7004,-1592.0382 627.3142,-1561.976 685.3989,-1634.5524 710.2692,-1665.6276 695.4216,-1686.3965 721.3989,-1716.5524 732.4613,-1729.3941 747.9101,-1739.9207 761.8803,-1747.732"/>
<polygon fill="#aaff00" stroke="#aaff00" points="760.3139,-1750.8632 770.7862,-1752.4702 763.6017,-1744.6833 760.3139,-1750.8632"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#54ff00" stroke-dasharray="5,2" d="M601.1821,-924.5524C687.1009,-944.5302 716.3095,-924.6974 795.9847,-962.5524"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge72" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1469.339,-618.5524C1607.9109,-618.1244 1689.6499,-514.4647 1781.1273,-618.5524"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M417.9708,-837.5382C435.9753,-826.2937 462.9412,-807.4212 480.9653,-785.5524 503.72,-757.9439 488.8012,-735.6155 516.9653,-713.5524 547.171,-689.89 569.2233,-715.7873 601.1821,-694.5524"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M601.1821,-694.5524C639.8712,-668.8455 680.1763,-544.9621 721.3989,-523.5524 780.2353,-492.9946 804.2783,-522.6432 870.5706,-523.5524 951.5954,-524.6636 972.3764,-518.8424 1052.825,-528.5524 1099.8312,-534.2259 1422.2431,-623.4264 1469.339,-618.5524"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge78" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00ff55" stroke-dasharray="5,2" d="M601.1821,-1038.5524C635.6157,-1054.4906 649.2477,-1041.029 685.3989,-1052.5524 772.5813,-1080.3421 819.7177,-1066.4798 870.5706,-1142.5524 944.5562,-1253.2302 823.6398,-1636.4085 906.5706,-1740.5524 948.7762,-1793.554 997.8722,-1743.9205 1052.825,-1783.5524 1094.1331,-1813.3438 1123.3327,-1867.3884 1137.0556,-1896.922"/>
<polygon fill="#00ff55" stroke="#00ff55" points="1133.9644,-1898.5821 1141.2586,-1906.2663 1140.3484,-1895.7106 1133.9644,-1898.5821"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge90" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M1622.2083,-314.5524C1687.5376,-322.6525 1873.0055,-266.9172 1918.4414,-314.5524"/>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M421.855,-837.4743C440.9565,-826.9072 467.2516,-809.1153 480.9653,-785.5524 538.9816,-685.8687 445.7688,-619.2925 516.9653,-528.5524 538.0778,-501.6444 1055.2365,-307.0014 1088.825,-300.5524 1214.1197,-276.4957 1248.3216,-298.4396 1375.8875,-300.5524 1442.9831,-301.6636 1459.8213,-301.2885 1526.7905,-305.5524 1569.3006,-308.2589 1579.7464,-311.1727 1622.2083,-314.5524"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge157" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#5400ff" stroke-dasharray="5,2" d="M420.2346,-837.427C443.3948,-825.6753 481.9156,-807.3797 516.9653,-796.5524 605.264,-769.2758 629.3731,-767.0326 721.3989,-758.5524 787.4177,-752.4687 805.204,-747.4749 870.5706,-758.5524 992.2136,-779.1669 1305.334,-887.3387 1375.8875,-988.5524 1416.0826,-1046.2151 1389.1955,-1076.0263 1411.8875,-1142.5524 1431.7568,-1200.8035 1434.7618,-1217.6367 1469.339,-1268.5524"/>
<path fill="none" stroke="#5400ff" stroke-dasharray="5,2" d="M1469.339,-1268.5524C1536.5361,-1369.3938 1593.5084,-1503.9329 1614.042,-1554.853"/>
<polygon fill="#5400ff" stroke="#5400ff" points="1610.8994,-1556.4208 1617.8611,-1564.4074 1617.3993,-1553.8226 1610.8994,-1556.4208"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge167" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M601.1821,-848.5524C639.9216,-844.8092 648.9545,-838.2112 685.3989,-824.5524 736.2563,-805.4918 742.4804,-763.2219 795.9847,-772.5524"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M448.2165,-851.1875C489.2199,-852.7554 549.1456,-853.5803 601.1821,-848.5524"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge177" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M408.3068,-859.8034C425.7217,-881.7164 463.2805,-932.2984 480.9653,-981.5524 520.3876,-1091.3475 470.0487,-1134.7445 516.9653,-1241.5524 531.7387,-1275.1846 560.931,-1306.6111 580.7549,-1325.4572"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="578.6407,-1328.27 588.3531,-1332.5033 583.4006,-1323.1373 578.6407,-1328.27"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge180" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#ff0055" stroke-dasharray="5,2" d="M406.2026,-859.6349C429.2388,-894.3256 505.8206,-1000.7646 601.1821,-1038.5524"/>
<path fill="none" stroke="#ff0055" stroke-dasharray="5,2" d="M601.1821,-1038.5524C712.9309,-1082.8337 786.6388,-976.5054 870.5706,-1062.5524 957.9534,-1152.1374 850.8095,-1512.5169 906.5706,-1624.5524 916.2725,-1644.0456 934.9651,-1659.9809 951.0221,-1670.9482"/>
<polygon fill="#ff0055" stroke="#ff0055" points="949.3055,-1674.0067 959.5977,-1676.521 953.1198,-1668.1372 949.3055,-1674.0067"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M408.6889,-859.6753C426.7568,-881.3693 465.3835,-931.5933 480.9653,-981.5524 526.0872,-1126.2237 445.5545,-1528.8876 516.9653,-1662.5524 528.0062,-1683.2183 549.1383,-1698.9955 567.471,-1709.5926"/>
<polygon fill="#00ffff" stroke="#00ffff" points="566.0095,-1712.7827 576.4611,-1714.5187 569.3733,-1706.6439 566.0095,-1712.7827"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge61" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-694.5524C744.5718,-606.5681 813.366,-671.3416 979.6978,-696.5524"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge143" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-848.5524C664.4799,-842.4363 853.6507,-906.7307 870.5706,-914.5524 872.4901,-915.4397 1374.5244,-1252.9354 1375.8875,-1254.5524 1425.2035,-1313.0557 1453.3219,-1401.7836 1464.1398,-1441.7491"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1460.7616,-1442.6649 1466.6821,-1451.4512 1467.533,-1440.8905 1460.7616,-1442.6649"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge105" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M601.1821,-924.5524C718.2612,-951.7757 770.0358,-882.6632 870.5706,-948.5524 898.5167,-966.8679 885.471,-988.6438 906.5706,-1014.5524 933.4777,-1047.5921 956.5229,-1040.7955 979.6978,-1076.5524"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M979.6978,-1076.5524C998.379,-1104.4564 1030.2413,-1070.7008 1052.825,-1095.5524 1120.9336,-1170.5004 1027.9749,-1239.6001 1088.825,-1320.5524 1125.5753,-1369.4434 1191.3626,-1396.0527 1241.1988,-1409.9029"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1240.3754,-1413.3056 1250.94,-1412.5056 1242.1824,-1406.5428 1240.3754,-1413.3056"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M421.7425,-859.6673C445.201,-870.9072 483.0932,-888.321 516.9653,-900.5524 553.5717,-913.7711 563.3766,-915.3057 601.1821,-924.5524"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge124" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M979.6978,-1076.5524C997.9613,-1104.7315 1031.8018,-1069.3675 1052.825,-1095.5524 1121.6675,-1181.2977 1047.3983,-1982.6927 1088.825,-2084.5524 1096.0318,-2102.2725 1110.5729,-2118.1982 1123.1745,-2129.6044"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1121.22,-2132.5406 1131.0788,-2136.4207 1125.7915,-2127.2395 1121.22,-2132.5406"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~planticethermalstorage.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge197" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~planticethermalstorage.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1036.341,-877.6119C1041.958,-879.1059 1047.5344,-880.7525 1052.825,-882.5524 1171.2591,-922.8433 1207.935,-926.73 1307.4386,-1002.5524"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1307.4386,-1002.5524C1333.1839,-1019.9125 1347.1738,-1004.732 1375.8875,-1016.5524 1526.0375,-1078.3635 1594.8913,-1079.2835 1681.626,-1216.5524 1744.8811,-1316.6618 1647.6472,-1385.0219 1717.626,-1480.5524 1746.7991,-1520.3777 1869.9966,-1585.0511 1918.4414,-1575.5524"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1918.4414,-1575.5524C1969.4408,-1564.4114 1983.9435,-1580.6493 2035.8962,-1575.5524"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge158" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#5400ff" stroke-dasharray="5,2" d="M1307.4386,-1002.5524C1340.0864,-1027.4302 1351.6331,-1031.4387 1375.8875,-1064.5524 1434.8167,-1145.0064 1413.3117,-1186.0511 1469.339,-1268.5524"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge62" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M992.5575,-855.3561C1034.3493,-820.03 1171.5005,-712.3267 1307.4386,-696.5524"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~planticethermalstorage.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge198" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~planticethermalstorage.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-1306.5524C1052.8068,-1295.9705 1072.163,-1310.8745 1145.9073,-1306.5524"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1307.4386,-1268.5524C1446.2258,-1244.166 1514.3463,-1139.875 1622.2083,-1230.5524"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-1306.5524C1219.5325,-1302.2372 1235.1521,-1283.1792 1307.4386,-1268.5524"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M611.8143,-1354.7828C628.6049,-1372.8357 661.7767,-1409.8148 685.3989,-1444.5524 704.1879,-1472.1824 692.6669,-1493.4961 721.3989,-1510.5524 751.2188,-1528.2544 966.4607,-1512.9186 1078.4983,-1503.5423"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1079.0106,-1507.0116 1088.6807,-1502.6827 1078.4217,-1500.0364 1079.0106,-1507.0116"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ffaa00" stroke-dasharray="5,2" d="M614.2025,-1354.8049C633.2202,-1372.0478 668.1969,-1406.9795 685.3989,-1444.5524 726.2777,-1533.8406 664.4604,-1582.5432 721.3989,-1662.5524 765.1414,-1724.0185 809.8068,-1698.8393 870.5706,-1743.5524 888.5442,-1756.7783 887.5504,-1766.8815 906.5706,-1778.5524 912.9389,-1782.46 919.9969,-1785.8506 927.1433,-1788.7641"/>
<polygon fill="#ffaa00" stroke="#ffaa00" points="926.2949,-1792.185 936.8866,-1792.4452 928.7689,-1785.6368 926.2949,-1792.185"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M614.3187,-1354.7526C633.4846,-1371.9286 668.6481,-1406.7761 685.3989,-1444.5524 731.9734,-1549.5866 665.8552,-1599.9727 721.3989,-1700.5524 732.046,-1719.8323 751.1001,-1735.7709 767.2839,-1746.793"/>
<polygon fill="#aaff00" stroke="#aaff00" points="765.6165,-1749.8837 775.908,-1752.4006 769.4324,-1744.0151 765.6165,-1749.8837"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#54ff00" stroke-dasharray="5,2" d="M605.7617,-1332.4969C618.8737,-1302.2871 659.6301,-1217.8553 721.3989,-1176.5524 781.4366,-1136.407 864.7877,-1122.5539 920.396,-1117.8467"/>
<polygon fill="#54ff00" stroke="#54ff00" points="920.7441,-1121.3303 930.4446,-1117.0699 920.2045,-1114.3511 920.7441,-1121.3303"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge73" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M650.7504,-1342.3905C723.6134,-1339.8562 863.5681,-1331.8351 979.6978,-1306.5524"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M979.6978,-1306.5524C1289.1378,-1250.2413 1446.2244,-1007.9614 1681.626,-1216.5524 1731.3847,-1260.6439 1676.6002,-1461.2372 1717.626,-1513.5524 1736.2443,-1537.294 1750.9715,-1536.5872 1781.1273,-1537.5524"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1781.1273,-1537.5524C1829.4167,-1539.7298 1876.5217,-1502.1479 1901.0311,-1478.7033"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1903.5111,-1481.1733 1908.1676,-1471.6566 1898.5927,-1476.1923 1903.5111,-1481.1733"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge159" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#5400ff" stroke-dasharray="5,2" d="M1307.4386,-1268.5524C1342.8736,-1262.3261 1449.1264,-1238.789 1469.339,-1268.5524"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge168" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M604.4262,-1332.3836C622.89,-1268.8812 714.1564,-955.882 721.3989,-948.5524 767.4912,-901.9056 839.9616,-881.7456 896.4232,-873.0582"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="897.0147,-876.5092 906.411,-871.6142 896.0131,-869.5812 897.0147,-876.5092"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge63" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M612.4713,-1332.2393C632.6835,-1312.5431 677.0953,-1271.7482 721.3989,-1247.5524 857.8584,-1173.0267 906.1817,-1187.2342 1052.825,-1135.5524 1053.3215,-1135.3774 1621.9066,-926.1209 1622.2083,-926.5524"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge142" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-1306.5524C1217.576,-1302.3519 1240.893,-1279.6131 1307.4386,-1306.5524"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge103" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M650.2007,-1354.6413C779.3734,-1383.7631 1120.9144,-1460.0811 1145.9073,-1458.5524"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge110" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataglobalconstants.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M625.8199,-1332.4349C649.9611,-1321.7 687.9036,-1305.2488 721.3989,-1292.5524 731.0724,-1288.8856 741.5516,-1285.1999 751.5127,-1281.8276"/>
<polygon fill="#00ffff" stroke="#00ffff" points="752.8776,-1285.0618 761.2521,-1278.5719 750.6583,-1278.4229 752.8776,-1285.0618"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge126" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M614.4842,-1354.6808C633.8613,-1371.7654 669.291,-1406.4976 685.3989,-1444.5524 744.4591,-1584.0814 667.7236,-1641.8647 721.3989,-1783.5524 791.5454,-1968.7194 782.7796,-2125.8012 979.6978,-2146.5524"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M979.6978,-2146.5524C1012.6438,-2149.2365 1049.3846,-2149.7187 1079.9276,-2149.4322"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1080.0776,-2152.9307 1090.0337,-2149.3076 1079.9913,-2145.9312 1080.0776,-2152.9307"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~planticethermalstorage.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge199" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~planticethermalstorage.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1022.8248,-1698.5932C1181.0923,-1738.5837 1723.7348,-1870.8609 1781.1273,-1819.5524"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1033.0431,-1676.4202C1040.4367,-1672.9742 1047.358,-1668.4616 1052.825,-1662.5524 1096.4547,-1615.3926 1047.1987,-1571.4897 1088.825,-1522.5524 1091.6245,-1519.2612 1094.9398,-1516.3884 1098.5418,-1513.8836"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1100.5236,-1516.7782 1107.359,-1508.6833 1096.9675,-1510.7488 1100.5236,-1516.7782"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge77" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00ff55" stroke-dasharray="5,2" d="M1029.9134,-1698.5894C1038.2309,-1702.0567 1046.2677,-1706.601 1052.825,-1712.5524 1067.5519,-1725.9183 1117.695,-1847.6016 1137.6335,-1896.9268"/>
<polygon fill="#00ff55" stroke="#00ff55" points="1134.4221,-1898.3219 1141.4061,-1906.289 1140.9148,-1895.7055 1134.4221,-1898.3219"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge160" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#5400ff" stroke-dasharray="5,2" d="M1145.9073,-1612.5524C1214.1899,-1590.3639 1237.4497,-1630.5646 1307.4386,-1614.5524"/>
<path fill="none" stroke="#5400ff" stroke-dasharray="5,2" d="M1307.4386,-1614.5524C1379.4882,-1598.0687 1395.4311,-1577.2506 1469.339,-1576.5524"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge139" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-1612.5524C1259.1513,-1574.8255 1385.3157,-1508.8194 1440.6738,-1478.5476"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1442.4777,-1481.55 1449.5543,-1473.665 1439.1052,-1475.416 1442.4777,-1481.55"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1018.9149,-1676.5215C1030.1491,-1672.733 1042.2191,-1668.0395 1052.825,-1662.5524 1070.3543,-1653.4831 1071.6168,-1646.2173 1088.825,-1636.5524 1112.8204,-1623.0753 1119.7334,-1621.0576 1145.9073,-1612.5524"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge108" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1028.3588,-1676.4996C1037.1151,-1673.0185 1045.708,-1668.4732 1052.825,-1662.5524 1077.9137,-1641.6803 1066.987,-1622.805 1088.825,-1598.5524 1130.4548,-1552.3193 1162.0932,-1564.4353 1202.9897,-1517.5524 1225.7275,-1491.4863 1212.9861,-1471.3615 1238.9897,-1448.5524 1243.2102,-1444.8504 1248.0242,-1441.6806 1253.0991,-1438.9698"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1254.8874,-1441.9965 1262.444,-1434.5702 1251.9057,-1435.6633 1254.8874,-1441.9965"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge125" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1034.9658,-1698.5102C1041.8262,-1701.9855 1048.0822,-1706.5528 1052.825,-1712.5524 1104.3298,-1777.7062 1055.2389,-2008.5935 1088.825,-2084.5524 1096.6098,-2102.1587 1111.2795,-2118.1781 1123.7978,-2129.6574"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1121.7931,-2132.5546 1131.6194,-2136.5163 1126.4084,-2127.2915 1121.7931,-2132.5546"/>
</g>
<!-- sourcefile~datastringglobals.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~datastringglobals.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~EfferentGraph_node20"><a xlink:href="../sourcefile/datastringglobals.f90.html" xlink:title="DataStringGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="281.0645,-1965.5578 166.6166,-1965.5578 166.6166,-1943.5469 281.0645,-1943.5469 281.0645,-1965.5578"/>
<text text-anchor="middle" x="223.8406" y="-1951.4024" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataStringGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M231.1609,-1965.7777C245.0675,-1985.9387 277.4938,-2027.6581 317.2024,-2043.5524 384.7738,-2070.5994 409.1179,-2055.1881 480.9653,-2043.5524 575.4877,-2028.2444 604.3885,-2026.6026 685.3989,-1975.5524 785.698,-1912.3471 810.2183,-1885.5937 870.5706,-1783.5524 898.051,-1737.0895 868.1154,-1705.4361 906.5706,-1667.5524 954.8365,-1620.0036 1004.258,-1671.7937 1052.825,-1624.5524 1087.678,-1590.6506 1055.9468,-1554.3314 1087.8727,-1516.2431"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1090.7863,-1518.2587 1095.1453,-1508.6021 1085.7157,-1513.4327 1090.7863,-1518.2587"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M281.2353,-1955.5804C334.1654,-1955.0443 414.38,-1950.4414 480.9653,-1930.5524 597.9046,-1895.6226 721.5737,-1815.4396 772.2436,-1780.4269"/>
<polygon fill="#aaff00" stroke="#aaff00" points="774.3608,-1783.2175 780.5638,-1774.6283 770.3584,-1777.4746 774.3608,-1783.2175"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge175" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M228.3903,-1943.2365C239.3109,-1915.5992 267.1407,-1842.258 281.2024,-1778.5524 295.6749,-1712.9857 277.7605,-1532.8919 317.2024,-1478.5524 364.3362,-1413.6156 408.5532,-1437.1193 480.9653,-1402.5524 511.342,-1388.0517 545.8107,-1371.0817 570.027,-1359.0735"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="571.6948,-1362.1531 579.0951,-1354.5711 568.5819,-1355.8833 571.6948,-1362.1531"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M227.7365,-1943.5162C237.4161,-1915.9106 263.0831,-1841.5592 281.2024,-1778.5524 299.4348,-1715.1522 291.9106,-1695.4812 317.2024,-1634.5524 335.5529,-1590.3454 366.6899,-1543.5271 384.819,-1517.9861"/>
<polygon fill="#00ffff" stroke="#00ffff" points="387.8649,-1519.7453 390.8618,-1509.5832 382.1818,-1515.6584 387.8649,-1519.7453"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge129" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-2181.5524C484.9221,-2215.5349 1132.3432,-2030.9838 1202.9897,-1971.5524 1230.0638,-1948.7763 1217.0593,-1928.3158 1238.9897,-1900.5524 1263.706,-1869.2621 1290.2776,-1878.5451 1307.4386,-1842.5524"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1307.4386,-1842.5524C1341.0463,-1771.9832 1349.2365,-1754.0317 1375.8875,-1680.5524 1394.5828,-1629.0072 1390.0921,-1612.8652 1411.8875,-1562.5524 1424.5297,-1533.3688 1443.6021,-1501.9011 1456.2579,-1482.2195"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1459.2098,-1484.1002 1461.7369,-1473.8112 1453.3451,-1480.2786 1459.2098,-1484.1002"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge98" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M227.4819,-1965.7739C241.4815,-2006.6181 296.2691,-2146.7793 399.0839,-2181.5524"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M399.0839,-2181.5524C471.8577,-2206.1653 648.1467,-2079.7027 721.3989,-2056.5524 773.9562,-2039.9424 1167.4379,-1979.6739 1202.9897,-1937.5524 1273.2691,-1854.2862 1173.3044,-1535.4884 1238.9897,-1448.5524 1241.4505,-1445.2955 1244.3784,-1442.4624 1247.6164,-1439.9981"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1249.6061,-1442.8816 1256.215,-1434.6006 1245.8845,-1436.9528 1249.6061,-1442.8816"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-1534.5524C1010.6681,-1522.8963 1020.5005,-1527.6349 1052.825,-1520.5524 1066.0416,-1517.6565 1080.2492,-1514.2809 1093.486,-1511.0222"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1094.5253,-1514.3704 1103.3865,-1508.5628 1092.8377,-1507.5769 1094.5253,-1514.3704"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#54ff00" stroke-dasharray="5,2" d="M422.9784,-1487.5073C446.7666,-1476.5349 484.3384,-1459.2679 516.9653,-1444.5524 595.3387,-1409.2041 805.4614,-1343.7011 870.5706,-1287.5524 921.0267,-1244.04 956.322,-1171.415 971.4436,-1136.0951"/>
<polygon fill="#54ff00" stroke="#54ff00" points="974.7055,-1137.3666 975.3272,-1126.79 968.2456,-1134.6704 974.7055,-1137.3666"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge176" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M413.6546,-1487.4969C430.0878,-1474.9925 457.5716,-1453.9708 480.9653,-1435.5524 497.1081,-1422.8428 500.7368,-1419.1524 516.9653,-1406.5524 537.2301,-1390.8185 560.6199,-1373.3775 577.5996,-1360.8431"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="579.868,-1363.5192 585.844,-1354.7706 575.7167,-1357.883 579.868,-1363.5192"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge135" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-1496.5524C687.1314,-1506.975 710.3461,-1509.2775 795.9847,-1496.5524"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M463.9431,-1493.6297C503.6997,-1491.6723 555.5508,-1491.0189 601.1821,-1496.5524"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge107" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M979.6978,-1534.5524C1055.719,-1505.9408 1065.1738,-1467.4935 1145.9073,-1458.5524"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M601.1821,-1496.5524C638.768,-1501.7487 655.1144,-1487.6931 685.3989,-1510.5524 715.2303,-1533.0696 689.8161,-1566.5658 721.3989,-1586.5524 777.4219,-1622.0054 807.8606,-1608.0686 870.5706,-1586.5524 889.7432,-1579.9741 888.6771,-1568.0754 906.5706,-1558.5524 936.7669,-1542.4816 947.6835,-1546.6013 979.6978,-1534.5524"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M604.7296,-2364.4075C627.9412,-2291.4851 758.1625,-1882.3763 789.2974,-1784.5615"/>
<polygon fill="#aaff00" stroke="#aaff00" points="792.6723,-1785.4981 792.3703,-1774.9076 786.002,-1783.3749 792.6723,-1785.4981"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge145" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M647.8422,-2384.6543C672.1956,-2389.4049 702.4206,-2395.3009 729.206,-2400.5259"/>
<polygon fill="#00ffff" stroke="#00ffff" points="728.7988,-2404.0124 739.284,-2402.4918 730.1391,-2397.1419 728.7988,-2404.0124"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge100" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M795.9847,-2374.5524C909.7359,-2386.1982 962.5214,-2459.6966 1052.825,-2389.5524 1103.903,-2349.8769 1052.2069,-2301.8649 1088.825,-2248.5524 1124.0484,-2197.2703 1173.0606,-2222.094 1202.9897,-2167.5524 1279.9504,-2027.3026 1144.0532,-1577.3157 1238.9897,-1448.5524 1241.3031,-1445.4148 1244.0511,-1442.6703 1247.0958,-1440.2698"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1249.247,-1443.0471 1255.7529,-1434.685 1245.4523,-1437.1649 1249.247,-1443.0471"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge119" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M795.9847,-2374.5524C877.2116,-2382.8684 909.5835,-2417.3967 979.6978,-2375.5524"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M647.7622,-2372.5225C687.3118,-2370.617 745.518,-2369.3856 795.9847,-2374.5524"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M657.7888,-1736.5946C688.0036,-1742.4886 724.6111,-1749.6296 752.5562,-1755.0808"/>
<polygon fill="#aaff00" stroke="#aaff00" points="751.9469,-1758.5278 762.432,-1757.0073 753.2872,-1751.6573 751.9469,-1758.5278"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M278.6687,-2413.0789C330.8317,-2410.353 411.446,-2405.1713 480.9653,-2396.5524 501.8304,-2393.9655 524.5832,-2390.2287 544.6251,-2386.6222"/>
<polygon fill="#ff0000" stroke="#ff0000" points="545.3216,-2390.053 554.529,-2384.8115 544.0626,-2383.1671 545.3216,-2390.053"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M273.5895,-2404.4809C294.1182,-2399.9122 318.0812,-2394.5793 339.534,-2389.805"/>
<polygon fill="#00ffff" stroke="#00ffff" points="340.5132,-2393.1728 349.5141,-2387.584 338.9925,-2386.34 340.5132,-2393.1728"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge122" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M244.8695,-2426.593C301.0471,-2455.0268 459.967,-2528.5524 601.1821,-2528.5524 601.1821,-2528.5524 601.1821,-2528.5524 795.9847,-2528.5524 833.6528,-2528.5524 978.4087,-2477.0614 1052.825,-2389.5524 1084.2398,-2352.6104 1071.608,-2331.8865 1088.825,-2286.5524 1104.933,-2244.1382 1125.4996,-2195.2012 1137.0327,-2168.1789"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1140.3972,-2169.2132 1141.1165,-2158.6428 1133.9624,-2166.4575 1140.3972,-2169.2132"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M457.5391,-2376.2631C484.8289,-2376.1281 517.192,-2375.968 544.2844,-2375.8339"/>
<polygon fill="#ff0000" stroke="#ff0000" points="544.4057,-2379.3334 554.3882,-2375.7839 544.371,-2372.3335 544.4057,-2379.3334"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge117" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M420.2346,-2387.6778C443.3948,-2399.4294 481.9156,-2417.7251 516.9653,-2428.5524 605.264,-2455.829 629.3731,-2458.0721 721.3989,-2466.5524 787.4177,-2472.636 813.6674,-2500.5747 870.5706,-2466.5524 899.5842,-2449.2052 880.6599,-2421.2631 906.5706,-2399.5524 932.7897,-2377.5831 950.3245,-2393.0824 979.6978,-2375.5524"/>
</g>
<!-- sourcefile~branchinputmanager.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge67" class="edge">
<title>sourcefile~branchinputmanager.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1844.9605,-1460.5524C1853.529,-1460.5524 1862.1982,-1460.5524 1870.4308,-1460.5524"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1870.5847,-1464.0525 1880.5847,-1460.5524 1870.5846,-1457.0525 1870.5847,-1464.0525"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge71" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M795.9847,-236.5524C971.1828,-167.0939 1029.2012,-282.639 1202.9897,-355.5524 1328.0687,-408.0295 1337.3031,-473.4858 1469.339,-504.5524"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1781.1273,-618.5524C1887.4909,-750.7533 1913.4557,-1320.7794 1917.7356,-1439.0258"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1914.2475,-1439.4305 1918.0932,-1449.3027 1921.2433,-1439.187 1914.2475,-1439.4305"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1469.339,-504.5524C1614.2235,-532.4443 1688.6375,-503.5954 1781.1273,-618.5524"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge89" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M795.9847,-236.5524C967.223,-169.8266 1441.4415,-167.4124 1622.2083,-200.5524"/>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M406.1533,-453.406C422.5092,-428.5408 465.5208,-368.2402 516.9653,-336.5524 550.1033,-316.1407 565.5276,-328.1573 601.1821,-312.5524"/>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M601.1821,-312.5524C636.8367,-296.9474 648.9545,-302.2112 685.3989,-288.5524 736.2563,-269.4918 743.0629,-248.7608 795.9847,-236.5524"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge174" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M439.5575,-467.3338C454.8785,-470.545 471.0076,-476.9618 480.9653,-489.5524 519.8496,-538.7175 506.1886,-990.8024 516.9653,-1052.5524 535.0811,-1156.3542 576.4225,-1275.9141 593.5409,-1322.9912"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="590.259,-1324.2076 596.9887,-1332.3906 596.8308,-1321.7969 590.259,-1324.2076"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge60" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1307.4386,-618.5524C1335.5044,-635.0242 1348.1865,-627.4741 1375.8875,-644.5524 1394.3634,-655.9432 1393.1675,-666.5672 1411.8875,-677.5524 1435.0828,-691.1638 1447.2847,-681.1607 1469.339,-696.5524"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-312.5524C656.0097,-288.15 813.7153,-312.3426 870.5706,-331.5524 1090.6617,-405.9149 1107.0824,-500.9628 1307.4386,-618.5524"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1469.339,-696.5524C1569.992,-766.7981 1554.8892,-823.9189 1622.2083,-926.5524"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge153" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#5400ff" stroke-dasharray="5,2" d="M1484.109,-668.7264C1497.8674,-680.0894 1517.5972,-699.0471 1526.7905,-720.5524 1572.6706,-827.8758 1548.458,-1128.7168 1562.7905,-1244.5524 1577.3845,-1362.501 1606.3387,-1502.1609 1617.5877,-1554.4255"/>
<polygon fill="#5400ff" stroke="#5400ff" points="1614.227,-1555.4435 1619.7653,-1564.4755 1621.0682,-1553.9611 1614.227,-1555.4435"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge55" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1622.2083,-926.5524C1749.2795,-1094.0304 1775.1327,-1362.0357 1780.0431,-1439.157"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1776.569,-1439.7059 1780.6446,-1449.4855 1783.5572,-1439.2989 1776.569,-1439.7059"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1506.3997,-668.5597C1513.8571,-672.0971 1521.1314,-676.676 1526.7905,-682.5524 1607.5621,-766.4248 1551.8259,-833.7895 1622.2083,-926.5524"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge149" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#5400ff" stroke-dasharray="5,2" d="M1484.2751,-1473.593C1510.9199,-1493.2887 1566.8343,-1534.6203 1598.6842,-1558.1635"/>
<polygon fill="#5400ff" stroke="#5400ff" points="1596.863,-1561.1698 1606.9851,-1564.2995 1601.024,-1555.5407 1596.863,-1561.1698"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge152" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#5400ff" stroke-dasharray="5,2" d="M825.3685,-2424.5929C877.1728,-2441.9768 985.6155,-2468.7837 1052.825,-2417.5524 1100.8454,-2380.9482 1051.771,-2334.2266 1088.825,-2286.5524 1124.6557,-2240.4518 1166.9741,-2267.5087 1202.9897,-2221.5524 1239.1785,-2175.375 1213.1482,-2147.2229 1238.9897,-2094.5524 1252.8954,-2066.2096 1539.6253,-1685.1293 1607.7698,-1594.7014"/>
<polygon fill="#5400ff" stroke="#5400ff" points="1610.608,-1596.7507 1613.8321,-1586.6584 1605.018,-1592.5374 1610.608,-1596.7507"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge169" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M456.1868,-1371.5329C482.7866,-1366.3998 514.4322,-1360.293 541.3624,-1355.0961"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="542.2767,-1358.4843 551.4324,-1353.1528 540.9503,-1351.6111 542.2767,-1358.4843"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge130" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M463.6116,-1380.5547C554.5053,-1377.4478 725.3779,-1370.5345 870.5706,-1358.5524 1018.7708,-1346.322 1055.4189,-1338.8753 1202.9897,-1320.5524 1249.4697,-1314.7813 1264.0243,-1288.9772 1307.4386,-1306.5524"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge170" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M443.4352,-1313.1111C472.2679,-1318.6751 510.2062,-1325.9963 541.6514,-1332.0644"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="541.1309,-1335.5285 551.613,-1333.9867 542.4573,-1328.6553 541.1309,-1335.5285"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge132" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1307.4386,-1306.5524C1376.2225,-1335.2438 1432.4654,-1407.9177 1456.6107,-1443.0047"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1453.8113,-1445.1137 1462.3008,-1451.4523 1459.6171,-1441.203 1453.8113,-1445.1137"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M443.335,-1294.1887C505.1515,-1280.2943 621.0608,-1256.3562 721.3989,-1247.5524 934.6495,-1228.8413 1001.0599,-1184.4873 1202.9897,-1255.5524 1221.8555,-1262.1918 1221.3465,-1273.1334 1238.9897,-1282.5524 1267.4284,-1297.7346 1277.6857,-1294.1417 1307.4386,-1306.5524"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge137" class="edge">
<title>sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1353.3997,-1434.6239C1372.1937,-1439.1511 1394.1034,-1444.4289 1413.7846,-1449.1699"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1413.0018,-1452.5814 1423.5434,-1451.5207 1414.6412,-1445.7761 1413.0018,-1452.5814"/>
</g>
<!-- sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge138" class="edge">
<title>sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M860.9837,-1260.3159C960.9653,-1251.8209 1156.7194,-1245.7547 1307.4386,-1306.5524"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge140" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M471.1053,-550.7381C586.9754,-565.1055 808.1192,-597.8357 870.5706,-644.5524 897.3262,-664.5669 883.8082,-686.0918 906.5706,-710.5524 959.2098,-767.1187 994.2624,-754.1433 1052.825,-804.5524 1147.8607,-886.3566 1154.2435,-924.1305 1238.9897,-1016.5524 1298.4529,-1081.4012 1331.8522,-1083.3807 1375.8875,-1159.5524 1404.3954,-1208.8651 1395.2265,-1228.0835 1411.8875,-1282.5524 1429.5497,-1340.2949 1451.5165,-1408.0646 1462.4653,-1441.586"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1459.1778,-1442.7939 1465.6135,-1451.2101 1465.8309,-1440.6175 1459.1778,-1442.7939"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge141" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1159.2604,-2136.3986C1172.3218,-2124.7704 1191.8296,-2105.3639 1202.9897,-2084.5524 1233.7588,-2027.174 1212.1881,-2001.8877 1238.9897,-1942.5524 1261.1608,-1893.4684 1284.259,-1891.1682 1307.4386,-1842.5524"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge106" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1160.6403,-2136.3813C1174.3532,-2125.0205 1193.987,-2106.0644 1202.9897,-2084.5524 1257.6395,-1953.9671 1154.6125,-1562.2168 1238.9897,-1448.5524 1241.3133,-1445.4223 1244.0691,-1442.6836 1247.1195,-1440.2873"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1249.2714,-1443.0647 1255.7873,-1434.7105 1245.4838,-1437.1779 1249.2714,-1443.0647"/>
</g>
<!-- sourcefile~dataroomair.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge101" class="edge">
<title>sourcefile~dataroomair.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1145.9073,-1458.5524C1183.8663,-1454.3485 1226.0172,-1445.0553 1257.7409,-1437.101"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1258.8303,-1440.4353 1267.6559,-1434.5737 1257.1012,-1433.6522 1258.8303,-1440.4353"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M445.2776,-1005.7906C457.3656,-1008.162 470.0571,-1011.8437 480.9653,-1017.5524 500.7368,-1027.8995 498.4999,-1040.0222 516.9653,-1052.5524 732.8995,-1199.0799 876.5814,-1100.1047 1052.825,-1292.5524 1109.9518,-1354.9315 1061.8363,-1467.8631 1145.9073,-1458.5524"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge123" class="edge">
<title>sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M474.9433,-2216.7581C532.7709,-2213.3736 614.3,-2207.5431 685.3989,-2198.5524 718.343,-2194.3864 946.601,-2143.856 979.6978,-2146.5524"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge127" class="edge">
<title>sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M453.697,-2287.5102C588.4955,-2260.2553 936.5589,-2189.8805 1081.2922,-2160.6169"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1082.2479,-2163.9946 1091.3559,-2158.5821 1080.8606,-2157.1334 1082.2479,-2163.9946"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~EfferentGraph_edge165" class="edge">
<title>sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M652.7291,-744.6015C691.9209,-752.8248 747.226,-764.0495 795.9847,-772.5524"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M795.9847,-772.5524C830.2902,-778.5348 840.8531,-778.3996 870.5706,-796.5524 889.8804,-808.3477 888.028,-819.5842 906.5706,-832.5524 916.9682,-839.8242 929.1685,-846.2084 940.5921,-851.4221"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="939.3844,-854.7141 949.9486,-855.52 942.1928,-848.3021 939.3844,-854.7141"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefileplanticethermalstoragef90EfferentGraph = svgPanZoom('#sourcefileplanticethermalstoragef90EfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <h3>Files Dependent On This One</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~planticethermalstorage.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefileplanticethermalstoragef90AfferentGraph" width="641pt" height="70pt"
 viewBox="0.00 0.00 641.00 70.15" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~planticethermalstorage.f90~~AfferentGraph" class="graph" transform="scale(.3788 .3788) rotate(0) translate(4 181.2131)">
<title>sourcefile~~planticethermalstorage.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-181.2131 1688.3601,-181.2131 1688.3601,4 -4,4"/>
<!-- sourcefile~planticethermalstorage.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~planticethermalstorage.f90</title>
<polygon fill="none" stroke="#000000" points="142.6062,-118.9685 .1311,-118.9685 .1311,-96.9576 142.6062,-96.9576 142.6062,-118.9685"/>
<text text-anchor="middle" x="71.3687" y="-104.8131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">PlantIceThermalStorage.f90</text>
</g>
<!-- sourcefile~plantloopequipment.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~plantloopequipment.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~AfferentGraph_node2"><a xlink:href="../sourcefile/plantloopequipment.f90.html" xlink:title="PlantLoopEquipment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="305.7413,-138.9685 178.736,-138.9685 178.736,-116.9576 305.7413,-116.9576 305.7413,-138.9685"/>
<text text-anchor="middle" x="242.2386" y="-124.8131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantLoopEquipment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~planticethermalstorage.f90&#45;&gt;sourcefile~plantloopequipment.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~AfferentGraph_edge18" class="edge">
<title>sourcefile~planticethermalstorage.f90&#45;&gt;sourcefile~plantloopequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M142.8429,-116.329C151.3878,-117.3292 160.1242,-118.3517 168.6977,-119.3552"/>
<polygon fill="#ff0000" stroke="#ff0000" points="168.327,-122.8357 178.6661,-120.522 169.1408,-115.8831 168.327,-122.8357"/>
</g>
<!-- sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~hvacmanager.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~AfferentGraph_node3"><a xlink:href="../sourcefile/hvacmanager.f90.html" xlink:title="HVACManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="712.7141,-99.9685 614.156,-99.9685 614.156,-77.9576 712.7141,-77.9576 712.7141,-99.9685"/>
<text text-anchor="middle" x="663.4351" y="-85.8131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~planticethermalstorage.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~AfferentGraph_edge19" class="edge">
<title>sourcefile~planticethermalstorage.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M142.7857,-105.6712C260.7741,-101.8849 494.2463,-94.3925 603.9068,-90.8734"/>
<polygon fill="#ff0000" stroke="#ff0000" points="604.242,-94.3645 614.1246,-90.5455 604.0174,-87.3681 604.242,-94.3645"/>
</g>
<!-- sourcefile~plantmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~plantmanager.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~AfferentGraph_node4"><a xlink:href="../sourcefile/plantmanager.f90.html" xlink:title="PlantManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="578.2028,-138.9685 483.5753,-138.9685 483.5753,-116.9576 578.2028,-116.9576 578.2028,-138.9685"/>
<text text-anchor="middle" x="530.889" y="-124.8131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M305.9415,-127.9631C355.9016,-127.9631 424.8391,-127.9631 473.1889,-127.9631"/>
<polygon fill="#ff0000" stroke="#ff0000" points="473.4839,-131.4632 483.4838,-127.9631 473.4838,-124.4632 473.4839,-131.4632"/>
</g>
<!-- sourcefile~plantloopsolver.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~plantloopsolver.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~AfferentGraph_node5"><a xlink:href="../sourcefile/plantloopsolver.f90.html" xlink:title="PlantLoopSolver.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="447.7286,-176.9685 341.7438,-176.9685 341.7438,-154.9576 447.7286,-154.9576 447.7286,-176.9685"/>
<text text-anchor="middle" x="394.7362" y="-162.8131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantLoopSolver.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantloopsolver.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantloopsolver.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M286.7572,-139.0564C303.513,-143.2317 322.7569,-148.027 340.3146,-152.4021"/>
<polygon fill="#ff0000" stroke="#ff0000" points="339.8764,-155.8998 350.426,-154.9216 341.569,-149.1075 339.8764,-155.8998"/>
</g>
<!-- sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~simulationmanager.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~AfferentGraph_node6"><a xlink:href="../sourcefile/simulationmanager.f90.html" xlink:title="SimulationManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1551.9427,-98.9685 1432.1322,-98.9685 1432.1322,-76.9576 1551.9427,-76.9576 1551.9427,-98.9685"/>
<text text-anchor="middle" x="1492.0375" y="-84.8131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SimulationManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~AfferentGraph_edge17" class="edge">
<title>sourcefile~hvacmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M713.0629,-87.1595C807.3057,-84.1553 1018.6284,-79.4342 1196.1042,-89.9631"/>
</g>
<!-- sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~heatbalanceairmanager.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~AfferentGraph_node9"><a xlink:href="../sourcefile/heatbalanceairmanager.f90.html" xlink:title="HeatBalanceAirManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="892.3306,-61.9685 748.6555,-61.9685 748.6555,-39.9576 892.3306,-39.9576 892.3306,-61.9685"/>
<text text-anchor="middle" x="820.493" y="-47.8131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceAirManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacmanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~AfferentGraph_edge16" class="edge">
<title>sourcefile~hvacmanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M709.2849,-77.8697C726.7031,-73.6554 746.7319,-68.8095 764.9505,-64.4015"/>
<polygon fill="#00ffff" stroke="#00ffff" points="765.9612,-67.758 774.8577,-62.0045 764.315,-60.9544 765.9612,-67.758"/>
</g>
<!-- sourcefile~plantmanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~plantmanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M568.5169,-116.8916C583.2082,-112.5688 600.2251,-107.5618 615.7588,-102.9912"/>
<polygon fill="#ff0000" stroke="#ff0000" points="617.1078,-106.2427 625.7131,-100.0623 615.1318,-99.5274 617.1078,-106.2427"/>
</g>
<!-- sourcefile~plantmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~plantmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1346.8458,-127.9631C1384.6463,-125.3718 1426.1759,-112.8968 1455.1001,-102.5581"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1456.5943,-105.7383 1464.7785,-99.01 1454.1848,-99.166 1456.5943,-105.7383"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M578.2942,-127.9631C635.6494,-127.9631 735.1453,-127.9631 820.493,-127.9631 820.493,-127.9631 820.493,-127.9631 1011.5068,-127.9631 1160.5464,-127.9631 1198.1552,-138.1559 1346.8458,-127.9631"/>
</g>
<!-- sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~utilityroutines.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~AfferentGraph_node7"><a xlink:href="../sourcefile/utilityroutines.f90.html" xlink:title="UtilityRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1684.171,-138.9685 1587.9288,-138.9685 1587.9288,-116.9576 1684.171,-116.9576 1684.171,-138.9685"/>
<text text-anchor="middle" x="1636.0499" y="-124.8131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">UtilityRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~plantmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1346.8458,-127.9631C1426.6471,-121.6943 1519.2173,-123.2335 1577.7025,-125.2868"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1577.7363,-128.7903 1587.8583,-125.6607 1577.9939,-121.7951 1577.7363,-128.7903"/>
</g>
<!-- sourcefile~plantloopsolver.f90&#45;&gt;sourcefile~plantmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~plantloopsolver.f90&#45;&gt;sourcefile~plantmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M434.4833,-154.8697C449.1635,-150.7725 465.983,-146.0782 481.4198,-141.7698"/>
<polygon fill="#00ffff" stroke="#00ffff" points="482.637,-145.064 491.328,-139.0045 480.7552,-138.3216 482.637,-145.064"/>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1531.7707,-98.9991C1548.63,-103.6818 1568.4653,-109.1912 1586.2854,-114.1408"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1585.3744,-117.5202 1595.9464,-116.8242 1587.2479,-110.7755 1585.3744,-117.5202"/>
</g>
<!-- sourcefile~energyplus.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~energyplus.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~AfferentGraph_node8"><a xlink:href="../sourcefile/energyplus.f90.html" xlink:title="EnergyPlus.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1677.7584,-97.9685 1594.3414,-97.9685 1594.3414,-75.9576 1677.7584,-75.9576 1677.7584,-97.9685"/>
<text text-anchor="middle" x="1636.0499" y="-83.8131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EnergyPlus.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1551.8606,-87.5477C1562.5252,-87.4736 1573.557,-87.397 1583.9834,-87.3246"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1584.1964,-90.8233 1594.1719,-87.2539 1584.1478,-83.8235 1584.1964,-90.8233"/>
</g>
<!-- sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~AfferentGraph_edge15" class="edge">
<title>sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1346.8458,-11.9631C1394.3586,-20.4515 1442.6579,-51.0629 1469.8377,-70.7499"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1467.7735,-73.5765 1477.8925,-76.7161 1471.9399,-67.9515 1467.7735,-73.5765"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M866.2988,-39.944C958.1694,-19.5155 1171.1756,19.4215 1346.8458,-11.9631"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~AfferentGraph_node10" class="node">
<title>sourcefile~heatbalancesurfacemanager.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~AfferentGraph_node10"><a xlink:href="../sourcefile/heatbalancesurfacemanager.f90.html" xlink:title="HeatBalanceSurfaceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1094.6976,-61.9685 928.3161,-61.9685 928.3161,-39.9576 1094.6976,-39.9576 1094.6976,-61.9685"/>
<text text-anchor="middle" x="1011.5068" y="-47.8131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceSurfaceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~AfferentGraph_edge14" class="edge">
<title>sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M892.163,-50.9631C900.6087,-50.9631 909.3201,-50.9631 918.0094,-50.9631"/>
<polygon fill="#ff0000" stroke="#ff0000" points="918.1824,-54.4632 928.1823,-50.9631 918.1823,-47.4632 918.1824,-54.4632"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1196.1042,-89.9631C1273.3429,-94.0313 1362.0758,-92.6233 1422.0752,-90.7728"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1422.3095,-94.2672 1432.1921,-90.4482 1422.0849,-87.2708 1422.3095,-94.2672"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1047.8434,-61.9935C1084.7582,-72.4009 1143.7873,-86.8593 1196.1042,-89.9631"/>
</g>
<!-- sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~AfferentGraph_node11" class="node">
<title>sourcefile~heatbalancemanager.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~AfferentGraph_node11"><a xlink:href="../sourcefile/heatbalancemanager.f90.html" xlink:title="HeatBalanceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1261.1096,-61.9685 1131.0989,-61.9685 1131.0989,-39.9576 1261.1096,-39.9576 1261.1096,-61.9685"/>
<text text-anchor="middle" x="1196.1042" y="-47.8131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1094.8945,-50.9631C1103.6161,-50.9631 1112.4448,-50.9631 1121.0652,-50.9631"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1121.0703,-54.4632 1131.0703,-50.9631 1121.0702,-47.4632 1121.0703,-54.4632"/>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1226.4285,-39.9136C1263.43,-26.9959 1323.894,-7.8626 1346.8458,-11.9631"/>
</g>
<!-- sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~AfferentGraph_node12" class="node">
<title>sourcefile~sizingmanager.f90</title>
<g id="a_sourcefile~~planticethermalstorage.f90~~AfferentGraph_node12"><a xlink:href="../sourcefile/sizingmanager.f90.html" xlink:title="SizingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1396.3246,-61.9685 1297.3671,-61.9685 1297.3671,-39.9576 1396.3246,-39.9576 1396.3246,-61.9685"/>
<text text-anchor="middle" x="1346.8458" y="-47.8131" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SizingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1261.345,-50.9631C1269.8303,-50.9631 1278.4902,-50.9631 1286.8836,-50.9631"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1286.9602,-54.4632 1296.9602,-50.9631 1286.9601,-47.4632 1286.9602,-54.4632"/>
</g>
<!-- sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~planticethermalstorage.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1390.4081,-62.0643C1405.6953,-65.96 1423.039,-70.3798 1439.0158,-74.4513"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1438.2017,-77.8556 1448.7563,-76.9335 1439.9303,-71.0724 1438.2017,-77.8556"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefileplanticethermalstoragef90AfferentGraph = svgPanZoom('#sourcefileplanticethermalstoragef90AfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <br>

    <section class="visible-xs visible-sm hidden-md">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/icethermalstorage.html">IceThermalStorage</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html#src">PlantIceThermalStorage.f90</a>
  </div>
</div>


    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">MODULE </span><span class="n">IceThermalStorage</span>  <span class="c">! Ice Storage Module</span>
<a name="ln-2"></a>
<a name="ln-3"></a>          <span class="c">! MODULE INFORMATION:</span>
<a name="ln-4"></a>          <span class="c">!       AUTHOR         Pyeongchan Ihm</span>
<a name="ln-5"></a>          <span class="c">!       DATE WRITTEN   April 2002</span>
<a name="ln-6"></a>          <span class="c">!       MODIFIED       Modified Refined model, added Simple model, by Guo Zhou, Oct 2002</span>
<a name="ln-7"></a>          <span class="c">!                      Remove chiller, make just a storage tank, Michael J. Witte, Sep 2005</span>
<a name="ln-8"></a>          <span class="c">!                      Added detailed ice storage model, Rick Strand, Feb 2006</span>
<a name="ln-9"></a>          <span class="c">!                      B. Griffith, Sept 2010, plant upgrades, fluid properties</span>
<a name="ln-10"></a>          <span class="c">!                      Enhancements to detailed ice storage model, Rick Strand, Aug 2012</span>
<a name="ln-11"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-12"></a>
<a name="ln-13"></a>          <span class="c">! PURPOSE OF THIS MODULE:</span>
<a name="ln-14"></a>          <span class="c">! This module simulates the performance of Ice Thermal Storage</span>
<a name="ln-15"></a>
<a name="ln-16"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-17"></a>          <span class="c">! Once the PlantLoopManager determines that the Ice Thermal Storage</span>
<a name="ln-18"></a>          <span class="c">! is available to meet a loop cooling demand, it calls SimIceStorage</span>
<a name="ln-19"></a>          <span class="c">! which in turn calls the appropriate Ice Thermal Storage model.</span>
<a name="ln-20"></a>
<a name="ln-21"></a>          <span class="c">! REFERENCES: Dion J. King, ASHRAE Transactions v104, pt1, 1998.</span>
<a name="ln-22"></a>
<a name="ln-23"></a>          <span class="c">! OTHER NOTES: na</span>
<a name="ln-24"></a>
<a name="ln-25"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-26"></a>  <span class="k">USE </span><span class="n">DataPrecisionGlobals</span>
<a name="ln-27"></a>  <span class="k">USE </span><span class="n">CurveManager</span>
<a name="ln-28"></a>  <span class="k">USE </span><span class="n">DataLoopNode</span>
<a name="ln-29"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">WarmupFlag</span><span class="p">,</span> <span class="n">BeginDayFlag</span><span class="p">,</span> <span class="n">EndDayFlag</span><span class="p">,</span> <span class="n">TimeStepZone</span><span class="p">,</span> <span class="n">SecInHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-30"></a>                             <span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">,</span><span class="n">ScheduleAlwaysOn</span>
<a name="ln-31"></a>  <span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">ShowWarningError</span><span class="p">,</span> <span class="n">ShowContinueError</span><span class="p">,</span> <span class="n">ShowSevereError</span><span class="p">,</span> <span class="n">ShowFatalError</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-32"></a>                             <span class="n">ShowContinueErrorTimeStamp</span><span class="p">,</span> <span class="n">ShowRecurringWarningErrorAtEnd</span>
<a name="ln-33"></a>  <span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">OutWetBulbTemp</span><span class="p">,</span><span class="n">OutDryBulbTemp</span>  <span class="c">! This value is used to model Cooling Tower.  Twb + 2[degF]</span>
<a name="ln-34"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span>
<a name="ln-35"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-36"></a>
<a name="ln-37"></a>  <span class="k">IMPLICIT NONE</span>
<a name="ln-38"></a>
<a name="ln-39"></a><span class="k">  PRIVATE</span>
<a name="ln-40"></a>
<a name="ln-41"></a>          <span class="c">! MODULE PARAMETER DEFINITIONS</span>
<a name="ln-42"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">cIceStorageSimple</span>   <span class="o">=</span> <span class="s1">&#39;ThermalStorage:Ice:Simple&#39;</span>
<a name="ln-43"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">cIceStorageDetailed</span> <span class="o">=</span> <span class="s1">&#39;ThermalStorage:Ice:Detailed&#39;</span>
<a name="ln-44"></a>
<a name="ln-45"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">IceStorageType_Simple</span>   <span class="o">=</span> <span class="mi">1</span>
<a name="ln-46"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">IceStorageType_Detailed</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-47"></a>
<a name="ln-48"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DetIceInsideMelt</span>  <span class="o">=</span> <span class="mi">1</span>    <span class="c">! Inside melt system--charge starting with bare coil</span>
<a name="ln-49"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DetIceOutsideMelt</span> <span class="o">=</span> <span class="mi">2</span>    <span class="c">! Outside melt system--charge from existing ice layer on coil</span>
<a name="ln-50"></a>
<a name="ln-51"></a>       <span class="c">! ITS parameter</span>
<a name="ln-52"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">FreezTemp</span>   <span class="o">=</span> <span class="mf">0.0d0</span>      <span class="c">! Water freezing Temperature, 0[C]</span>
<a name="ln-53"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">FreezTempIP</span>  <span class="o">=</span> <span class="mi">3</span><span class="mf">2.0d0</span>    <span class="c">! Water freezing Temperature, 32[F]</span>
<a name="ln-54"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">TimeInterval</span> <span class="o">=</span> <span class="mi">360</span><span class="mf">0.0d0</span>  <span class="c">! Time Interval (1 hr) [s]</span>
<a name="ln-55"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ITSType_IceOnCoilInternal</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-56"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ITSType_IceOnCoilExternal</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-57"></a>       <span class="c">! Conversion parameter</span>
<a name="ln-58"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">EpsLimitForX</span>         <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!0.02  ! See Dion&#39;s code as eps1</span>
<a name="ln-59"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">EpsLimitForDisCharge</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!0.20  ! See Dion&#39;s code as eps2</span>
<a name="ln-60"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">EpsLimitForCharge</span>    <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!0.20  ! See Dion&#39;s code as eps3</span>
<a name="ln-61"></a>
<a name="ln-62"></a>      <span class="c">!variable used by simple model</span>
<a name="ln-63"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Delta</span> <span class="o">=</span> <span class="mf">0.005d0</span>
<a name="ln-64"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">PLRmin</span> <span class="o">=</span> <span class="mf">0.1d0</span>
<a name="ln-65"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Pa</span> <span class="o">=</span><span class="mf">0.088065d0</span>
<a name="ln-66"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Pb</span> <span class="o">=</span><span class="mf">1.137742d0</span>
<a name="ln-67"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Pc</span> <span class="o">=-</span><span class="mf">0.225806d0</span>
<a name="ln-68"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Tref</span> <span class="o">=</span> <span class="mi">8</span><span class="mf">5.d0</span>                <span class="c">!F</span>
<a name="ln-69"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Tcharge</span> <span class="o">=</span> <span class="mf">1.d0</span>             <span class="c">!F</span>
<a name="ln-70"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Tdischarge</span> <span class="o">=</span> <span class="mf">5.d0</span>          <span class="c">!F</span>
<a name="ln-71"></a>
<a name="ln-72"></a>          <span class="c">! Parameter used by the Detailed Ice Storage Model</span>
<a name="ln-73"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DeltaTofMin</span> <span class="o">=</span> <span class="mf">0.5d0</span>  <span class="c">! Minimum allowed outlet side temperature difference [C]</span>
<a name="ln-74"></a>                                        <span class="c">! This is (Tout - Tfreezing)</span>
<a name="ln-75"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DeltaTifMin</span> <span class="o">=</span> <span class="mf">1.0d0</span>  <span class="c">! Minimum allowed inlet side temperature difference [C]</span>
<a name="ln-76"></a>                                        <span class="c">! This is (Tin - Tfreezing)</span>
<a name="ln-77"></a>
<a name="ln-78"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-79"></a>     <span class="c">! TYPE ITSSetCap is used for information of ITS plant in Loop, Brach, and Components.</span>
<a name="ln-80"></a><span class="c">!  TYPE ITSSetCapData</span>
<a name="ln-81"></a><span class="c">!    LOGICAL :: ITSFlag    = .FALSE.</span>
<a name="ln-82"></a><span class="c">!    INTEGER :: LoopNum    =0</span>
<a name="ln-83"></a><span class="c">!    INTEGER :: BranchNum  =0</span>
<a name="ln-84"></a><span class="c">!    INTEGER :: CompNum    =0</span>
<a name="ln-85"></a><span class="c">!  END TYPE ITSSetCapData</span>
<a name="ln-86"></a>
<a name="ln-87"></a>  <span class="k">TYPE </span><span class="n">IceStorageMapping</span>
<a name="ln-88"></a>         <span class="c">! Input data</span>
<a name="ln-89"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Name</span>       <span class="o">=</span><span class="s1">&#39; &#39;</span>   <span class="c">! User identifier</span>
<a name="ln-90"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">StorageType</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-91"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">StorageType_Num</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-92"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">LocalEqNum</span>      <span class="o">=</span> <span class="mi">0</span>
<a name="ln-93"></a>  <span class="k">END TYPE</span>
<a name="ln-94"></a>
<a name="ln-95"></a>
<a name="ln-96"></a><span class="k">  TYPE </span><span class="n">IceStorageSpecs</span>
<a name="ln-97"></a>         <span class="c">! Input data</span>
<a name="ln-98"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Name</span>     <span class="o">=</span><span class="s1">&#39; &#39;</span>   <span class="c">! User identifier</span>
<a name="ln-99"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ITSType</span>  <span class="o">=</span><span class="s1">&#39; &#39;</span>   <span class="c">! Ice Thermal Storage Type</span>
<a name="ln-100"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">ITSType_Num</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! Storage Type as number (IceOnCoilInternal,IceOnCoilExternal)</span>
<a name="ln-101"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">MapNum</span>   <span class="o">=</span> <span class="mi">0</span>    <span class="c">! Number to Map structure</span>
<a name="ln-102"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">UratePtr</span>             <span class="o">=</span><span class="mi">0</span>    <span class="c">! Charging/Discharging SchedulePtr: u value schedule</span>
<a name="ln-103"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ITSNomCap</span>            <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Design nominal capacity of Ice Thermal Storage [J] (user input in GJ)</span>
<a name="ln-104"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">PltInletNodeNum</span>      <span class="o">=</span><span class="mi">0</span>    <span class="c">! Node number on the inlet side of the plant</span>
<a name="ln-105"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">PltOutletNodeNum</span>     <span class="o">=</span><span class="mi">0</span>     <span class="c">! Node number on the outlet side of the plant</span>
<a name="ln-106"></a>    <span class="c">!loop topology variables</span>
<a name="ln-107"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">LoopNum</span>            <span class="o">=</span><span class="mi">0</span>
<a name="ln-108"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">LoopSideNum</span>        <span class="o">=</span><span class="mi">0</span>
<a name="ln-109"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">BranchNum</span>          <span class="o">=</span><span class="mi">0</span>
<a name="ln-110"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">CompNum</span>            <span class="o">=</span><span class="mi">0</span>
<a name="ln-111"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">DesignMassFlowRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-112"></a>  <span class="k">END TYPE </span><span class="n">IceStorageSpecs</span>
<a name="ln-113"></a>
<a name="ln-114"></a>  <span class="k">TYPE </span><span class="n">DetailedIceStorageData</span>
<a name="ln-115"></a>          <span class="c">! Input data</span>
<a name="ln-116"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Name</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>                  <span class="c">! User identifier</span>
<a name="ln-117"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ScheduleName</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>          <span class="c">! User identifier</span>
<a name="ln-118"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">ScheduleIndex</span> <span class="o">=</span> <span class="mi">0</span>           <span class="c">! Plant inlet node number for ice storage unit</span>
<a name="ln-119"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">NomCapacity</span> <span class="o">=</span> <span class="mf">0.0d0</span>           <span class="c">! Design storage capacity of Ice Thermal Storage system [W-hr]</span>
<a name="ln-120"></a>                                                                <span class="c">! (User input for this parameter in GJ--need to convert to W-hr)</span>
<a name="ln-121"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">PlantInNodeNum</span> <span class="o">=</span> <span class="mi">0</span>          <span class="c">! Plant inlet node number for ice storage unit</span>
<a name="ln-122"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">PlantOutNodeNum</span> <span class="o">=</span> <span class="mi">0</span>         <span class="c">! Plant outlet node number for ice storage unit</span>
<a name="ln-123"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">PlantLoopNum</span>       <span class="o">=</span> <span class="mi">0</span>
<a name="ln-124"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">PlantLoopSideNum</span>   <span class="o">=</span> <span class="mi">0</span>
<a name="ln-125"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">PlantBranchNum</span>     <span class="o">=</span> <span class="mi">0</span>
<a name="ln-126"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">PlantCompNum</span>       <span class="o">=</span> <span class="mi">0</span>
<a name="ln-127"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">DesignMassFlowRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-128"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">MapNum</span>   <span class="o">=</span> <span class="mi">0</span>                <span class="c">! Number to Map structure</span>
<a name="ln-129"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DischargeCurveType</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>    <span class="c">! Type of discharging equation entered by user (QuadraticLinear)</span>
<a name="ln-130"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DischargeCurveName</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>    <span class="c">! Curve name for discharging (used to find the curve index)</span>
<a name="ln-131"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">DischargeCurveNum</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Curve index for discharging</span>
<a name="ln-132"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ChargeCurveType</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>       <span class="c">! Type of charging equation entered by user (QuadraticLinear)</span>
<a name="ln-133"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ChargeCurveName</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>       <span class="c">! Curve name for charging (used to find the curve index)</span>
<a name="ln-134"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">ChargeCurveNum</span> <span class="o">=</span> <span class="mi">0</span>          <span class="c">! Curve index for charging</span>
<a name="ln-135"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">CurveFitTimeStep</span> <span class="o">=</span> <span class="mf">1.0d0</span>      <span class="c">! Time step used to generate performance data [hours]</span>
<a name="ln-136"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">DischargeParaElecLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Parasitic electric load duing discharging [dimensionless]</span>
<a name="ln-137"></a>                                                                <span class="c">! (This is multiplied by the tank capacity to obtain elec consump)</span>
<a name="ln-138"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ChargeParaElecLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Parasitic electric load duing charging [dimensionless]</span>
<a name="ln-139"></a>                                                                <span class="c">! (This is multiplied by the tank capacity to obtain elec consump)</span>
<a name="ln-140"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">TankLossCoeff</span> <span class="o">=</span> <span class="mf">0.0d0</span>         <span class="c">! Fraction of total storage capacity lost per hour [1/hours]</span>
<a name="ln-141"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">FreezingTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>          <span class="c">! Freezing/melting temperature of ice storage unit [C]</span>
<a name="ln-142"></a>          <span class="c">! Reporting data</span>
<a name="ln-143"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">CompLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>              <span class="c">! load requested by plant [W]</span>
<a name="ln-144"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">IceFracChange</span> <span class="o">=</span> <span class="mf">0.0d0</span>         <span class="c">! Change in fraction of ice stored during the time step [fraction]</span>
<a name="ln-145"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">IceFracRemaining</span> <span class="o">=</span> <span class="mf">1.0d0</span>      <span class="c">! Fraction of ice remaining in storage [fraction]</span>
<a name="ln-146"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThawProcessIndicator</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">! User input determining whether system is inside or outside melt</span>
<a name="ln-147"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">ThawProcessIndex</span> <span class="o">=</span> <span class="mi">0</span>        <span class="c">! Conversion of thaw process indicator to integer index</span>
<a name="ln-148"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">IceFracOnCoil</span> <span class="o">=</span> <span class="mf">1.0d0</span>       <span class="c">! Fraction of ice on the coil (affects charging) [fraction]</span>
<a name="ln-149"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">DischargingRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>       <span class="c">! Rate at which energy is being added (thawing) to ice unit [W]</span>
<a name="ln-150"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">DischargingEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Total energy added to the ice storage unit [J]</span>
<a name="ln-151"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ChargingRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>          <span class="c">! Rate at which energy is removed (freezing) to ice unit [W]</span>
<a name="ln-152"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ChargingEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>        <span class="c">! Total energy removed from ice storage unit [J]</span>
<a name="ln-153"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">MassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>          <span class="c">! Total mass flow rate to component [kg/s]</span>
<a name="ln-154"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">BypassMassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Mass flow rate that bypasses the ice unit locally [kg/s]</span>
<a name="ln-155"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">TankMassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>      <span class="c">! Mass flow rate through the ice storage unit [kg/s]</span>
<a name="ln-156"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">InletTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>             <span class="c">! Component inlet temperature (same as bypass temperature) [C]</span>
<a name="ln-157"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">OutletTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>            <span class="c">! Component outlet temperature (blended) [C]</span>
<a name="ln-158"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">TankOutletTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>        <span class="c">! Ice storage unit outlet temperature [C]</span>
<a name="ln-159"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ParasiticElecRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Parasitic electrical energy rate consumed by ice storage [W]</span>
<a name="ln-160"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ParasiticElecEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>   <span class="c">! Total parasitic electrical energy consumed by ice storage [J]</span>
<a name="ln-161"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">DischargeIterErrors</span> <span class="o">=</span> <span class="mi">0</span>     <span class="c">! Number of max iterations exceeded errors during discharging</span>
<a name="ln-162"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">DischargeErrorCount</span> <span class="o">=</span> <span class="mi">0</span>     <span class="c">! Index for error counting routine</span>
<a name="ln-163"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">ChargeIterErrors</span> <span class="o">=</span> <span class="mi">0</span>        <span class="c">! Number of max iterations exceeded errors during charging</span>
<a name="ln-164"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">ChargeErrorCount</span> <span class="o">=</span> <span class="mi">0</span>        <span class="c">! Index for error counting routine</span>
<a name="ln-165"></a>  <span class="k">END TYPE </span><span class="n">DetailedIceStorageData</span>
<a name="ln-166"></a>
<a name="ln-167"></a>  <span class="k">TYPE </span><span class="n">ReportVars</span>
<a name="ln-168"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MyLoad</span>           <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! load requested by plant [W]</span>
<a name="ln-169"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">U</span>                <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! [fraction]</span>
<a name="ln-170"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Urate</span>            <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! [fraction]</span>
<a name="ln-171"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">IceFracRemain</span>    <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Fraction of ice remaining in storage [fraction]</span>
<a name="ln-172"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ITSCoolingRate</span>   <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! [W]</span>
<a name="ln-173"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ITSCoolingEnergy</span> <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! [J]</span>
<a name="ln-174"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ITSChargingRate</span>  <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! [W]</span>
<a name="ln-175"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ITSChargingEnergy</span><span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! [J]</span>
<a name="ln-176"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ITSmdot</span>          <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! [kg/s]</span>
<a name="ln-177"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ITSInletTemp</span>     <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! [C]</span>
<a name="ln-178"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ITSOutletTemp</span>    <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! [C]</span>
<a name="ln-179"></a>  <span class="k">END TYPE </span><span class="n">ReportVars</span>
<a name="ln-180"></a>
<a name="ln-181"></a> <span class="c">! TYPE (ITSSetCapData), SAVE                   :: ITSSetCap=ITSSetCapData(.false.,0,0,0)</span>
<a name="ln-182"></a>  <span class="k">TYPE</span> <span class="p">(</span><span class="n">IceStorageSpecs</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">IceStorage</span>         <span class="c">! dimension to number of machines</span>
<a name="ln-183"></a>  <span class="k">TYPE</span> <span class="p">(</span><span class="n">ReportVars</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">DIMENSION</span><span class="p">(:)</span>        <span class="kd">::</span> <span class="n">IceStorageReport</span>  <span class="c">! dimension to number of machines</span>
<a name="ln-184"></a>  <span class="k">TYPE</span> <span class="p">(</span><span class="n">DetailedIceStorageData</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">DetIceStor</span>  <span class="c">! Derived type for detailed ice storage model</span>
<a name="ln-185"></a>  <span class="k">TYPE</span> <span class="p">(</span><span class="n">IceStorageMapping</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">IceStorageTypeMap</span>
<a name="ln-186"></a>
<a name="ln-187"></a>
<a name="ln-188"></a>          <span class="c">! MODULE VARIABLE DECLARATIONS:</span>
<a name="ln-189"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ResetXForITSFlag</span> <span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-190"></a>
<a name="ln-191"></a>       <span class="c">! Input data</span>
<a name="ln-192"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ITSNomCap</span>        <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Design nominal capacity of Ice Thermal Storage [J] (user input in GJ)</span>
<a name="ln-193"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">InletNodeNum</span>     <span class="o">=</span><span class="mi">0</span>   <span class="c">! Node number on the inlet side of the plant</span>
<a name="ln-194"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">OutletNodeNum</span>    <span class="o">=</span><span class="mi">0</span>   <span class="c">! Node number on the inlet side of the plant</span>
<a name="ln-195"></a>
<a name="ln-196"></a>       <span class="c">! ITS numbers and FoundOrNot</span>
<a name="ln-197"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IceNum</span>     <span class="o">=</span><span class="mi">0</span>
<a name="ln-198"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumIceStorages</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-199"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">IceStorageNotFound</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-200"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumDetIceStorages</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-201"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotalIceStorages</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-202"></a>       <span class="c">! ITS UAice and HLoss</span>
<a name="ln-203"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">UAIceCh</span>       <span class="o">=</span><span class="mf">0.0d0</span>     <span class="c">! Charging Ice Thermal Storage overall heat transfer coefficient [W/C]</span>
<a name="ln-204"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">UAIceDisCh</span>    <span class="o">=</span><span class="mf">0.0d0</span>     <span class="c">! Discharging Ice Thermal Storage overall heat transfer coefficient [W/C]</span>
<a name="ln-205"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HLoss</span>         <span class="o">=</span><span class="mf">0.0d0</span>     <span class="c">! ITS Heat Loss</span>
<a name="ln-206"></a>       <span class="c">! ITS State</span>
<a name="ln-207"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">XCurIceFrac</span>   <span class="o">=</span><span class="mf">0.0d0</span>     <span class="c">! Current Fraction of Ice Thermal Storage remaining [fraction]</span>
<a name="ln-208"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">U</span>             <span class="o">=</span><span class="mf">0.0d0</span>     <span class="c">! Adjusted input U after reading U Schedule [fraction]</span>
<a name="ln-209"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Urate</span>   <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Final Urate adjusted Urate based on Error protection (I) [fraction] by HOUR</span>
<a name="ln-210"></a>       <span class="c">! ITS status information</span>
<a name="ln-211"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ITSMassFlowRate</span> <span class="o">=</span><span class="mf">0.0d0</span>       <span class="c">! ITS water mass flow rate [kg/s]</span>
<a name="ln-212"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ITSInletTemp</span>    <span class="o">=</span><span class="mf">0.0d0</span>       <span class="c">! ITS inlet water temperature [C]</span>
<a name="ln-213"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ITSOutletTemp</span>   <span class="o">=</span><span class="mf">0.0d0</span>       <span class="c">! ITS outlet water temperature [C]</span>
<a name="ln-214"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ITSOutletSetPointTemp</span> <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! ITS outlet water temperature setpoint [C]</span>
<a name="ln-215"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ITSCoolingRate</span>  <span class="o">=</span><span class="mf">0.0d0</span>       <span class="c">! ITS Discharge(-)/Charge(+) rate [W]</span>
<a name="ln-216"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ITSCoolingEnergy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-217"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ChillerOutletTemp</span><span class="o">=</span><span class="mf">0.0d0</span>     <span class="c">! Chiller outlet brine temperature [C]</span>
<a name="ln-218"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">CheckEquipName</span>
<a name="ln-219"></a>
<a name="ln-220"></a>          <span class="c">! SUBROUTINE SPECIFICATIONS FOR MODULE</span>
<a name="ln-221"></a>       <span class="c">! General routine</span>
<a name="ln-222"></a>  <span class="k">PUBLIC  </span><span class="n">SimIceStorage</span>
<a name="ln-223"></a>  <span class="k">PUBLIC  </span><span class="n">UpdateIceFractions</span>
<a name="ln-224"></a>  <span class="k">PRIVATE </span><span class="n">CalcIceStorageCapacity</span>
<a name="ln-225"></a>  <span class="k">PRIVATE </span><span class="n">GetIceStorageInput</span>
<a name="ln-226"></a>  <span class="k">PRIVATE </span><span class="n">UpdateNode</span>
<a name="ln-227"></a>  <span class="k">PRIVATE </span><span class="n">RecordOutput</span>
<a name="ln-228"></a>  <span class="k">PRIVATE </span><span class="n">CalcIceStorageDormant</span>
<a name="ln-229"></a>  <span class="k">PRIVATE </span><span class="n">CalcIceStorageCharge</span>
<a name="ln-230"></a>  <span class="k">PRIVATE </span><span class="n">CalcQiceChargeMaxByChiller</span>
<a name="ln-231"></a>  <span class="k">PRIVATE </span><span class="n">CalcQiceChargeMaxByITS</span>
<a name="ln-232"></a>  <span class="k">PRIVATE </span><span class="n">CalcIceStorageDischarge</span>
<a name="ln-233"></a>  <span class="k">PRIVATE </span><span class="n">CalcQiceDischageMax</span>
<a name="ln-234"></a>  <span class="k">PRIVATE </span><span class="n">CalcUAIce</span>
<a name="ln-235"></a>  <span class="k">PRIVATE </span><span class="n">InitDetailedIceStorage</span>
<a name="ln-236"></a>  <span class="k">PRIVATE </span><span class="n">InitSimpleIceStorage</span>
<a name="ln-237"></a>  <span class="k">PRIVATE </span><span class="n">SimDetailedIceStorage</span>
<a name="ln-238"></a>  <span class="k">PRIVATE </span><span class="n">CalcDetIceStorLMTDstar</span>
<a name="ln-239"></a>  <span class="k">PRIVATE </span><span class="n">UpdateDetailedIceStorage</span>
<a name="ln-240"></a>  <span class="k">PRIVATE </span><span class="n">ReportDetailedIceStorage</span>
<a name="ln-241"></a>
<a name="ln-242"></a>
<a name="ln-243"></a>  <span class="k">CONTAINS</span>
<a name="ln-244"></a>
<a name="ln-245"></a><span class="c">!*************************************************************************</span>
<a name="ln-246"></a><span class="k">SUBROUTINE </span><span class="n">SimIceStorage</span><span class="p">(</span><span class="n">IceStorageType</span><span class="p">,</span><span class="n">IceStorageName</span><span class="p">,</span><span class="n">CompIndex</span><span class="p">,</span><span class="n">RunFlag</span><span class="p">,</span><span class="n">FirstIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-247"></a>                           <span class="n">InitLoopEquip</span><span class="p">,</span><span class="n">MyLoad</span><span class="p">)</span>
<a name="ln-248"></a>
<a name="ln-249"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-250"></a>          <span class="c">!       AUTHOR</span>
<a name="ln-251"></a>          <span class="c">!       DATE WRITTEN</span>
<a name="ln-252"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-253"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-254"></a>
<a name="ln-255"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-256"></a>
<a name="ln-257"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-258"></a>
<a name="ln-259"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-260"></a>
<a name="ln-261"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-262"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TimeStepSys</span>           <span class="c">! [hr]</span>
<a name="ln-263"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-264"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCurrentScheduleValue</span>
<a name="ln-265"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">BeginEnvrnFlag</span><span class="p">,</span> <span class="n">WarmupFlag</span>
<a name="ln-266"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetSpecificHeatGlycol</span>
<a name="ln-267"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">PlantLoop</span><span class="p">,</span> <span class="n">SingleSetpoint</span><span class="p">,</span> <span class="n">DualSetpointDeadband</span>
<a name="ln-268"></a>
<a name="ln-269"></a>
<a name="ln-270"></a>  <span class="k">IMPLICIT NONE</span>
<a name="ln-271"></a>
<a name="ln-272"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-273"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">IceStorageType</span>
<a name="ln-274"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">IceStorageName</span>
<a name="ln-275"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompIndex</span>
<a name="ln-276"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RunFlag</span>
<a name="ln-277"></a>  <span class="kt">LOGICAL</span>                <span class="kd">::</span> <span class="n">FirstIteration</span>
<a name="ln-278"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InitLoopEquip</span>
<a name="ln-279"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MyLoad</span>
<a name="ln-280"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">DemandMdot</span>
<a name="ln-281"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">TempIn</span>
<a name="ln-282"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">TempSetPt</span>
<a name="ln-283"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">MyLoad2</span>
<a name="ln-284"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">MaxCap</span>
<a name="ln-285"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">MinCap</span>
<a name="ln-286"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">OptCap</span>
<a name="ln-287"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">Cp</span> <span class="c">!local plant fluid specific heat</span>
<a name="ln-288"></a>
<a name="ln-289"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-290"></a>          <span class="c">! na</span>
<a name="ln-291"></a>
<a name="ln-292"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-293"></a>          <span class="c">! na</span>
<a name="ln-294"></a>
<a name="ln-295"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-296"></a>
<a name="ln-297"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-298"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">FirstTime</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-299"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">MyEnvrnFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-300"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IceStorageNum</span>
<a name="ln-301"></a>
<a name="ln-302"></a>          <span class="c">! FLOW</span>
<a name="ln-303"></a>
<a name="ln-304"></a><span class="c">!  Set initialization flags</span>
<a name="ln-305"></a><span class="c">!  Allow ice to build up during warmup?</span>
<a name="ln-306"></a><span class="c">!  IF( (BeginEnvrnFlag) .OR. (WarmupFlag) ) THEN</span>
<a name="ln-307"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">BeginEnvrnFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MyEnvrnFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-308"></a><span class="k">    </span><span class="n">ResetXForITSFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-309"></a>    <span class="n">MyEnvrnFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-310"></a>  <span class="k">END IF</span>
<a name="ln-311"></a>
<a name="ln-312"></a><span class="k">  IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">BeginEnvrnFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-313"></a><span class="k">    </span><span class="n">MyEnvrnFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-314"></a>  <span class="k">END IF</span>
<a name="ln-315"></a>
<a name="ln-316"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">FirstTime</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-317"></a><span class="k">    CALL </span><span class="n">GetIceStorageInput</span>
<a name="ln-318"></a>    <span class="n">FirstTime</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-319"></a>  <span class="k">END IF</span>
<a name="ln-320"></a>
<a name="ln-321"></a>  <span class="c">! Find the correct Equipment</span>
<a name="ln-322"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CompIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-323"></a><span class="k">    </span><span class="n">IceStorageNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">IceStorageName</span><span class="p">,</span><span class="n">IceStorageTypeMap</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotalIceStorages</span><span class="p">)</span>
<a name="ln-324"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IceStorageNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-325"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimIceStorage: Unit not found=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">IceStorageName</span><span class="p">))</span>
<a name="ln-326"></a>    <span class="n">ENDIF</span>
<a name="ln-327"></a>    <span class="n">CompIndex</span><span class="o">=</span><span class="n">IceStorageNum</span>
<a name="ln-328"></a>  <span class="k">ELSE</span>
<a name="ln-329"></a><span class="k">    </span><span class="n">IceStorageNum</span><span class="o">=</span><span class="n">CompIndex</span>
<a name="ln-330"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IceStorageNum</span> <span class="o">&gt;</span> <span class="n">TotalIceStorages</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">IceStorageNum</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-331"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimIceStorage:  Invalid CompIndex passed=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-332"></a>                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">IceStorageNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-333"></a>                          <span class="s1">&#39;, Number of Units=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">TotalIceStorages</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-334"></a>                          <span class="s1">&#39;, Entered Unit name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">IceStorageName</span><span class="p">))</span>
<a name="ln-335"></a>    <span class="n">ENDIF</span>
<a name="ln-336"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CheckEquipName</span><span class="p">(</span><span class="n">IceStorageNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-337"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">IceStorageName</span> <span class="o">/=</span> <span class="n">IceStorageTypeMap</span><span class="p">(</span><span class="n">IceStorageNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-338"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimIceStorage: Invalid CompIndex passed=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-339"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">IceStorageNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-340"></a>                            <span class="s1">&#39;, Unit name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">IceStorageName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, stored Unit Name for that index=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-341"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">IceStorageTypeMap</span><span class="p">(</span><span class="n">IceStorageNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-342"></a>      <span class="n">ENDIF</span>
<a name="ln-343"></a>      <span class="n">CheckEquipName</span><span class="p">(</span><span class="n">IceStorageNum</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-344"></a>    <span class="n">ENDIF</span>
<a name="ln-345"></a>  <span class="n">ENDIF</span>
<a name="ln-346"></a>
<a name="ln-347"></a>
<a name="ln-348"></a>  <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">IceStorageTypeMap</span><span class="p">(</span><span class="n">IceStorageNum</span><span class="p">)%</span><span class="n">StorageType_Num</span><span class="p">)</span>
<a name="ln-349"></a>
<a name="ln-350"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">IceStorageType_Simple</span><span class="p">)</span>
<a name="ln-351"></a>
<a name="ln-352"></a>      <span class="c">!------------------------------------------------------------------------</span>
<a name="ln-353"></a>      <span class="c">! READING INPUT when first calling SimIceStorage</span>
<a name="ln-354"></a>      <span class="c">!------------------------------------------------------------------------</span>
<a name="ln-355"></a>      <span class="n">IceNum</span><span class="o">=</span><span class="n">IceStorageTypeMap</span><span class="p">(</span><span class="n">IceStorageNum</span><span class="p">)%</span><span class="n">LocalEqNum</span>
<a name="ln-356"></a>
<a name="ln-357"></a>      <span class="k">CALL </span><span class="n">InitSimpleIceStorage</span>
<a name="ln-358"></a>
<a name="ln-359"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InitLoopEquip</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-360"></a>
<a name="ln-361"></a>             <span class="c">! Find IceStorage Number</span>
<a name="ln-362"></a>             <span class="c">! Assign ice thermal storage data to Module variables by each Ice thermal storage</span>
<a name="ln-363"></a>        <span class="n">ITSNomCap</span>            <span class="o">=</span> <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSNomCap</span>
<a name="ln-364"></a>        <span class="n">InletNodeNum</span>         <span class="o">=</span> <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PltInletNodeNum</span>
<a name="ln-365"></a>        <span class="n">OutletNodeNum</span>        <span class="o">=</span> <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PltOutletNodeNum</span>
<a name="ln-366"></a>
<a name="ln-367"></a>        <span class="k">RETURN</span>
<a name="ln-368"></a><span class="k">      END IF</span>  <span class="c">! End Of InitLoopEquip</span>
<a name="ln-369"></a>
<a name="ln-370"></a>      <span class="c">!------------------------------------------------------------------------</span>
<a name="ln-371"></a>      <span class="c">! FIRST PROCESS (MyLoad = 0.0 as IN)</span>
<a name="ln-372"></a>      <span class="c">! At this moment as first calling of ITS, ITS provide ONLY MaxCap/OptCap/MinCap.</span>
<a name="ln-373"></a>      <span class="c">!------------------------------------------------------------------------</span>
<a name="ln-374"></a>      <span class="c">! First process is in subroutine CalcIceStorageCapacity(MaxCap,MinCap,OptCap) shown bellow.</span>
<a name="ln-375"></a>
<a name="ln-376"></a>      <span class="c">!------------------------------------------------------------------------</span>
<a name="ln-377"></a>      <span class="c">! SECOND PROCESS (MyLoad is provided by E+ based on MaxCap/OptCap/MinCap)</span>
<a name="ln-378"></a>      <span class="c">!------------------------------------------------------------------------</span>
<a name="ln-379"></a>           <span class="c">! Below routines are starting when second calling.</span>
<a name="ln-380"></a>           <span class="c">! After previous return, MyLoad is calculated based on MaxCap, OptCap, and MinCap.</span>
<a name="ln-381"></a>           <span class="c">! Then PlandSupplySideManager provides MyLoad to simulate Ice Thermal Storage.</span>
<a name="ln-382"></a>           <span class="c">! The process will be decided based on sign(+,-,0) of input U.</span>
<a name="ln-383"></a>
<a name="ln-384"></a><span class="c">! MJW 19 Sep 2005 - New approach - calculate MyLoad locally from inlet node temp</span>
<a name="ln-385"></a><span class="c">!                   and outlet node setpoint until MyLoad that is passed in behaves well</span>
<a name="ln-386"></a>
<a name="ln-387"></a><span class="c">!DSU? can we now use MyLoad? lets not yet to try to avoid scope creep</span>
<a name="ln-388"></a>
<a name="ln-389"></a>      <span class="n">TempIn</span>     <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">InletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-390"></a>      <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">LoopDemandCalcScheme</span><span class="p">)</span>
<a name="ln-391"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">SingleSetPoint</span><span class="p">)</span>
<a name="ln-392"></a>        <span class="n">TempSetPt</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">OutletNodeNum</span><span class="p">)%</span><span class="n">TempSetPoint</span>
<a name="ln-393"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">DualSetPointDeadBand</span><span class="p">)</span>
<a name="ln-394"></a>        <span class="n">TempSetPt</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">OutletNodeNum</span><span class="p">)%</span><span class="n">TempSetPointHi</span>
<a name="ln-395"></a>      <span class="k">END SELECT</span>
<a name="ln-396"></a><span class="k">      </span><span class="n">DemandMdot</span> <span class="o">=</span> <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">DesignMassFlowRate</span>
<a name="ln-397"></a>
<a name="ln-398"></a>      <span class="n">Cp</span> <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-399"></a>                                 <span class="n">TempIn</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-400"></a>                                 <span class="n">PlantLoop</span><span class="p">(</span><span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-401"></a>                                 <span class="s1">&#39;SimIceStorage&#39;</span><span class="p">)</span>
<a name="ln-402"></a>
<a name="ln-403"></a>      <span class="n">MyLoad2</span>    <span class="o">=</span> <span class="p">(</span><span class="n">DemandMdot</span><span class="o">*</span> <span class="n">Cp</span> <span class="o">*</span><span class="p">(</span><span class="n">TempIn</span> <span class="o">-</span> <span class="n">TempSetPt</span><span class="p">))</span>
<a name="ln-404"></a>      <span class="n">MyLoad</span>     <span class="o">=</span> <span class="n">MyLoad2</span>
<a name="ln-405"></a>
<a name="ln-406"></a>
<a name="ln-407"></a><span class="c">!     Set fraction of ice remaining in storage</span>
<a name="ln-408"></a>      <span class="n">XCurIceFrac</span> <span class="o">=</span> <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">IceFracRemain</span>
<a name="ln-409"></a>
<a name="ln-410"></a>      <span class="c">!***** Dormant Process for ITS *****************************************</span>
<a name="ln-411"></a>      <span class="c">!************************************************************************</span>
<a name="ln-412"></a><span class="c">!        IF( U .EQ. 0.0 ) THEN</span>
<a name="ln-413"></a>      <span class="k">IF</span><span class="p">((</span> <span class="n">MyLoad2</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">DemandMdot</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-414"></a><span class="k">        CALL </span><span class="n">CalcIceStorageDormant</span><span class="p">(</span><span class="n">IceStorageType_Simple</span><span class="p">,</span><span class="n">IceNum</span><span class="p">)</span>
<a name="ln-415"></a>
<a name="ln-416"></a>      <span class="c">!***** Charging Process for ITS *****************************************</span>
<a name="ln-417"></a>      <span class="c">!************************************************************************</span>
<a name="ln-418"></a><span class="c">!        ELSE IF( U .GT. 0.0 ) THEN</span>
<a name="ln-419"></a>      <span class="k">ELSE IF</span><span class="p">(</span> <span class="n">MyLoad2</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-420"></a>
<a name="ln-421"></a><span class="c">!             Call CalcIceStorageCapacity from here - MJW - 19 Sep 2005</span>
<a name="ln-422"></a>        <span class="k">CALL </span><span class="n">CalcIceStorageCapacity</span><span class="p">(</span><span class="n">IceStorageType_Simple</span><span class="p">,</span><span class="n">MaxCap</span><span class="p">,</span><span class="n">MinCap</span><span class="p">,</span><span class="n">OptCap</span><span class="p">)</span>
<a name="ln-423"></a>
<a name="ln-424"></a>        <span class="k">CALL </span><span class="n">CalcIceStorageCharge</span><span class="p">(</span><span class="n">IceStorageType_Simple</span><span class="p">,</span><span class="n">IceNum</span><span class="p">)</span>
<a name="ln-425"></a>
<a name="ln-426"></a>      <span class="c">!***** Discharging Process for ITS *****************************************</span>
<a name="ln-427"></a>      <span class="c">!************************************************************************</span>
<a name="ln-428"></a><span class="c">!        ELSE IF( U .LT. 0.0 ) THEN</span>
<a name="ln-429"></a>      <span class="k">ELSE IF</span><span class="p">(</span> <span class="n">MyLoad2</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-430"></a><span class="c">!             Call CalcIceStorageCapacity from here - MJW - 19 Sep 2005</span>
<a name="ln-431"></a>        <span class="k">CALL </span><span class="n">CalcIceStorageCapacity</span><span class="p">(</span><span class="n">IceStorageType_Simple</span><span class="p">,</span><span class="n">MaxCap</span><span class="p">,</span><span class="n">MinCap</span><span class="p">,</span><span class="n">OptCap</span><span class="p">)</span>
<a name="ln-432"></a>
<a name="ln-433"></a>        <span class="k">CALL </span><span class="n">CalcIceStorageDischarge</span><span class="p">(</span><span class="n">IceStorageType_Simple</span><span class="p">,</span><span class="n">IceNum</span><span class="p">,</span><span class="n">MyLoad</span><span class="p">,</span><span class="n">Runflag</span><span class="p">,</span><span class="n">FirstIteration</span><span class="p">,</span><span class="n">MaxCap</span><span class="p">)</span>
<a name="ln-434"></a>      <span class="k">END IF</span>  <span class="c">! Based on input of U value, deciding Dormant/Charge/Discharge process</span>
<a name="ln-435"></a>
<a name="ln-436"></a>           <span class="c">! Update Node properties: mdot and Temperature</span>
<a name="ln-437"></a>      <span class="k">CALL </span><span class="n">UpdateNode</span><span class="p">(</span><span class="n">MyLoad2</span><span class="p">,</span><span class="n">RunFlag</span><span class="p">,</span><span class="n">IceNum</span><span class="p">)</span>
<a name="ln-438"></a>
<a name="ln-439"></a>           <span class="c">! Update report variables.</span>
<a name="ln-440"></a>      <span class="k">CALL </span><span class="n">RecordOutput</span><span class="p">(</span><span class="n">IceNum</span><span class="p">,</span><span class="n">MyLoad2</span><span class="p">,</span><span class="n">RunFlag</span><span class="p">)</span>
<a name="ln-441"></a>    <span class="c">!--------------------------------------------------------------------------</span>
<a name="ln-442"></a>    <span class="c">!        Ali&#39;s TES modle   Itegrated by ZG  Oct. 2002</span>
<a name="ln-443"></a>    <span class="c">!---------------------------------------------------------------------------</span>
<a name="ln-444"></a>
<a name="ln-445"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">IceStorageType_Detailed</span><span class="p">)</span>
<a name="ln-446"></a>
<a name="ln-447"></a>      <span class="n">IceNum</span><span class="o">=</span><span class="n">IceStorageTypeMap</span><span class="p">(</span><span class="n">IceStorageNum</span><span class="p">)%</span><span class="n">LocalEqNum</span>
<a name="ln-448"></a>          <span class="c">! Read input when first calling SimIceStorage</span>
<a name="ln-449"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InitLoopEquip</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-450"></a><span class="k">        RETURN</span>
<a name="ln-451"></a><span class="k">      END IF</span>  <span class="c">! End Of InitLoopEquip</span>
<a name="ln-452"></a>
<a name="ln-453"></a>      <span class="k">CALL </span><span class="n">InitDetailedIceStorage</span>   <span class="c">! Initialize detailed ice storage</span>
<a name="ln-454"></a>
<a name="ln-455"></a>      <span class="k">CALL </span><span class="n">SimDetailedIceStorage</span>    <span class="c">! Simulate detailed ice storage</span>
<a name="ln-456"></a>
<a name="ln-457"></a>      <span class="k">CALL </span><span class="n">UpdateDetailedIceStorage</span> <span class="c">! Update detailed ice storage</span>
<a name="ln-458"></a>
<a name="ln-459"></a>      <span class="k">CALL </span><span class="n">ReportDetailedIceStorage</span> <span class="c">! Report detailed ice storage</span>
<a name="ln-460"></a>
<a name="ln-461"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-462"></a>      <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Specified IceStorage not found in SimIceStorage&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">IceStorageType</span><span class="p">))</span>
<a name="ln-463"></a>  <span class="k">END SELECT</span>
<a name="ln-464"></a>
<a name="ln-465"></a>
<a name="ln-466"></a><span class="k">  RETURN</span>
<a name="ln-467"></a><span class="k">END SUBROUTINE </span><span class="n">SimIceStorage</span>
<a name="ln-468"></a>
<a name="ln-469"></a><span class="k">SUBROUTINE </span><span class="n">SimDetailedIceStorage</span>
<a name="ln-470"></a>
<a name="ln-471"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-472"></a>          <span class="c">!       AUTHOR         Rick Strand</span>
<a name="ln-473"></a>          <span class="c">!       DATE WRITTEN   February 2006</span>
<a name="ln-474"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-475"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-476"></a>
<a name="ln-477"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-478"></a>          <span class="c">! This subroutine is the main simulation subroutine for the detailed</span>
<a name="ln-479"></a>          <span class="c">! ice storage model.</span>
<a name="ln-480"></a>
<a name="ln-481"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-482"></a>          <span class="c">! Based on whether the unit is dormant, in charging mode, or in discharging</span>
<a name="ln-483"></a>          <span class="c">! mode, the code either passes the flow through the bypass, through the tank,</span>
<a name="ln-484"></a>          <span class="c">! or both.  This depends on the temperature relative to the setpoint temperature</span>
<a name="ln-485"></a>          <span class="c">! and other features of the model.  The model itself is a LMTD model that uses</span>
<a name="ln-486"></a>          <span class="c">! performance curve fits that are quadratic in fraction charged/discharged and</span>
<a name="ln-487"></a>          <span class="c">! linear in LMTD for the calculation of Q.  The equations are actually non-</span>
<a name="ln-488"></a>          <span class="c">! dimensionalized.</span>
<a name="ln-489"></a>
<a name="ln-490"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-491"></a>          <span class="c">! Ice Storage Component Model Proposal (Revised).doc by Rick Strand (Dec 2005/Jan 2006)</span>
<a name="ln-492"></a>
<a name="ln-493"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-494"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span>    <span class="n">ONLY</span> <span class="p">:</span> <span class="n">CurveValue</span>
<a name="ln-495"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">GetCurrentScheduleValue</span>
<a name="ln-496"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">GetSpecificHeatGlycol</span>
<a name="ln-497"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>       <span class="n">ONLY</span> <span class="p">:</span> <span class="n">PlantLoop</span><span class="p">,</span> <span class="n">CommonPipe_TwoWay</span><span class="p">,</span>  <span class="n">SingleSetpoint</span><span class="p">,</span> <span class="n">DualSetpointDeadband</span>
<a name="ln-498"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span>  <span class="n">ONLY</span> <span class="p">:</span> <span class="n">SetComponentFlowRate</span>
<a name="ln-499"></a>  <span class="k">USE </span><span class="n">DataBranchAirLoopPlant</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">MassFlowTolerance</span>
<a name="ln-500"></a>
<a name="ln-501"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-502"></a>
<a name="ln-503"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-504"></a>          <span class="c">! na</span>
<a name="ln-505"></a>
<a name="ln-506"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-507"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span>   <span class="kd">::</span> <span class="n">MaxIterNum</span> <span class="o">=</span> <span class="mi">100</span>            <span class="c">! Maximum number of internal iterations for ice storage solution</span>
<a name="ln-508"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">SmallestLoad</span>       <span class="o">=</span> <span class="mf">0.1d0</span>    <span class="c">! Smallest load to actually run the ice storage unit [Watts]</span>
<a name="ln-509"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">TankDischargeToler</span> <span class="o">=</span> <span class="mf">0.001d0</span>  <span class="c">! Below this fraction, there is nothing left to discharge</span>
<a name="ln-510"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">TankChargeToler</span>    <span class="o">=</span> <span class="mf">0.999d0</span>  <span class="c">! Above this fraction, we don&#39;t have anything left to charge</span>
<a name="ln-511"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">TemperatureToler</span>   <span class="o">=</span> <span class="mf">0.1d0</span>    <span class="c">! Temperature difference between iterations that indicates convergence [C]</span>
<a name="ln-512"></a>
<a name="ln-513"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-514"></a>          <span class="c">! na</span>
<a name="ln-515"></a>
<a name="ln-516"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-517"></a>          <span class="c">! na</span>
<a name="ln-518"></a>
<a name="ln-519"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-520"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ActualLoad</span>     <span class="c">! Actual load on the ice storage unit [W]</span>
<a name="ln-521"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">AvgFracCharged</span> <span class="c">! Average fraction charged for the current time step</span>
<a name="ln-522"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ChargeFrac</span>     <span class="c">! Fraction of tank to be charged in the current time step</span>
<a name="ln-523"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IterNum</span>        <span class="c">! Iteration number</span>
<a name="ln-524"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">LMTDstar</span>       <span class="c">! Non-dimensional log mean temperature difference of ice storage unit [non-dimensional]</span>
<a name="ln-525"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">LocalLoad</span>      <span class="c">! Estimated load on the ice storage unit [W]</span>
<a name="ln-526"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NodeNumIn</span>      <span class="c">! Plant loop inlet node number for component</span>
<a name="ln-527"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NodeNumOut</span>     <span class="c">! Plant loop outlet node number for component</span>
<a name="ln-528"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Qstar</span>          <span class="c">! Current load on the ice storage unit [non-dimensional]</span>
<a name="ln-529"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TempIn</span>         <span class="c">! Inlet temperature to component (from plant loop) [C]</span>
<a name="ln-530"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TempSetPt</span>      <span class="c">! Setpoint temperature defined by loop controls [C]</span>
<a name="ln-531"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ToutNew</span>        <span class="c">! Updated outlet temperature from the tank [C]</span>
<a name="ln-532"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ToutOld</span>        <span class="c">! Tank outlet temperature from the last iteration [C]</span>
<a name="ln-533"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Cp</span>             <span class="c">! local plant fluid specific heat</span>
<a name="ln-534"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">mdot</span>           <span class="c">! local mass flow rate for plant connection</span>
<a name="ln-535"></a>
<a name="ln-536"></a>          <span class="c">! FLOW:</span>
<a name="ln-537"></a>          <span class="c">! Set local variables</span>
<a name="ln-538"></a>  <span class="n">NodeNumIn</span>  <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantInNodeNum</span>
<a name="ln-539"></a>  <span class="n">NodeNumOut</span> <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantOutNodeNum</span>
<a name="ln-540"></a>  <span class="n">TempIn</span>     <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">NodeNumIn</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-541"></a>  <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantLoopNum</span><span class="p">)%</span><span class="n">LoopDemandCalcScheme</span><span class="p">)</span>
<a name="ln-542"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">SingleSetPoint</span><span class="p">)</span>
<a name="ln-543"></a>    <span class="n">TempSetPt</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">NodeNumOut</span><span class="p">)%</span><span class="n">TempSetPoint</span>
<a name="ln-544"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">DualSetPointDeadBand</span><span class="p">)</span>
<a name="ln-545"></a>    <span class="n">TempSetPt</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">NodeNumOut</span><span class="p">)%</span><span class="n">TempSetPointHi</span>
<a name="ln-546"></a>  <span class="k">END SELECT</span>
<a name="ln-547"></a>
<a name="ln-548"></a><span class="k">  </span><span class="n">IterNum</span>    <span class="o">=</span> <span class="mi">0</span>
<a name="ln-549"></a>
<a name="ln-550"></a>          <span class="c">! Set derived type variables</span>
<a name="ln-551"></a>  <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">InletTemp</span>     <span class="o">=</span> <span class="n">TempIn</span>
<a name="ln-552"></a>  <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">MassFlowRate</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">NodeNumIn</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-553"></a>
<a name="ln-554"></a>  <span class="c">!if two-way common pipe and no mass flow and tank is not full, then use design flow rate</span>
<a name="ln-555"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantLoopNum</span><span class="p">)%</span><span class="n">CommonPipeType</span> <span class="o">==</span> <span class="n">CommonPipe_TwoWay</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-556"></a>       <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">MassFlowRate</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">MassFlowTolerance</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-557"></a>       <span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">IceFracRemaining</span> <span class="o">&lt;</span> <span class="n">TankChargeToler</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-558"></a><span class="k">     </span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">MassFlowRate</span>  <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">DesignMassFlowRate</span>
<a name="ln-559"></a>  <span class="n">ENDIF</span>
<a name="ln-560"></a>
<a name="ln-561"></a>          <span class="c">! Calculate the current load on the ice storage unit</span>
<a name="ln-562"></a>  <span class="n">Cp</span> <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-563"></a>                             <span class="n">TempIn</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-564"></a>                             <span class="n">PlantLoop</span><span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-565"></a>                             <span class="s1">&#39;SimDetailedIceStorage&#39;</span><span class="p">)</span>
<a name="ln-566"></a>
<a name="ln-567"></a>  <span class="n">LocalLoad</span> <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span> <span class="n">Cp</span> <span class="o">*</span> <span class="p">(</span><span class="n">TempIn</span> <span class="o">-</span> <span class="n">TempSetPt</span><span class="p">)</span>
<a name="ln-568"></a>
<a name="ln-569"></a>          <span class="c">! Determine what the status is regarding the ice storage unit and the loop level flow</span>
<a name="ln-570"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">LocalLoad</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">SmallestLoad</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ScheduleIndex</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-571"></a>          <span class="c">! No real load on the ice storage device or ice storage OFF--bypass all of the flow and leave the tank alone</span>
<a name="ln-572"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">CompLoad</span>           <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-573"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">OutletTemp</span>         <span class="o">=</span> <span class="n">TempIn</span>
<a name="ln-574"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">TankOutletTemp</span>     <span class="o">=</span> <span class="n">TempIn</span>
<a name="ln-575"></a>    <span class="n">mdot</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-576"></a>    <span class="k">CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">mdot</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-577"></a>                            <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantInNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-578"></a>                            <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantOutNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-579"></a>                            <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-580"></a>                            <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-581"></a>                            <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-582"></a>                            <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantCompNum</span><span class="p">)</span>
<a name="ln-583"></a>
<a name="ln-584"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">BypassMassFlowRate</span> <span class="o">=</span> <span class="n">mdot</span>
<a name="ln-585"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">TankMassFlowRate</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-586"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">MassFlowRate</span>       <span class="o">=</span> <span class="n">mdot</span>
<a name="ln-587"></a>
<a name="ln-588"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">LocalLoad</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-589"></a>          <span class="c">! The load is less than zero so we should be charging</span>
<a name="ln-590"></a>          <span class="c">! Before we do anything, we should check to make sure that we will actually be charging the unit</span>
<a name="ln-591"></a>
<a name="ln-592"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">TempIn</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">FreezingTemp</span><span class="o">-</span><span class="n">DeltaTifMin</span><span class="p">))</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-593"></a>         <span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">IceFracRemaining</span> <span class="o">&gt;=</span> <span class="n">TankChargeToler</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-594"></a>          <span class="c">! If the inlet temperature is not below the freezing temperature of the</span>
<a name="ln-595"></a>          <span class="c">! device, then we cannot actually do any charging.  Bypass all of the flow.</span>
<a name="ln-596"></a>          <span class="c">! Also, if the tank is already sufficiently charged, we don&#39;t need to</span>
<a name="ln-597"></a>          <span class="c">! do any further charging.  So, bypass all of the flow.</span>
<a name="ln-598"></a>      <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">CompLoad</span>           <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-599"></a>      <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">OutletTemp</span>         <span class="o">=</span> <span class="n">TempIn</span>
<a name="ln-600"></a>      <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">TankOutletTemp</span>     <span class="o">=</span> <span class="n">TempIn</span>
<a name="ln-601"></a>      <span class="n">mdot</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-602"></a>      <span class="k">CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">mdot</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-603"></a>                              <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantInNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-604"></a>                              <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantOutNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-605"></a>                              <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-606"></a>                              <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-607"></a>                              <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-608"></a>                              <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantCompNum</span><span class="p">)</span>
<a name="ln-609"></a>
<a name="ln-610"></a>      <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">BypassMassFlowRate</span> <span class="o">=</span> <span class="n">mdot</span>
<a name="ln-611"></a>      <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">TankMassFlowRate</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-612"></a>      <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">MassFlowRate</span>       <span class="o">=</span> <span class="n">mdot</span>
<a name="ln-613"></a>
<a name="ln-614"></a>    <span class="k">ELSE</span>
<a name="ln-615"></a>      <span class="c">!make flow request so tank will get flow</span>
<a name="ln-616"></a>      <span class="n">mdot</span> <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">DesignMassFlowRate</span>
<a name="ln-617"></a>      <span class="k">CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">mdot</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-618"></a>                              <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantInNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-619"></a>                              <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantOutNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-620"></a>                              <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-621"></a>                              <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-622"></a>                              <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-623"></a>                              <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantCompNum</span><span class="p">)</span>
<a name="ln-624"></a>
<a name="ln-625"></a>          <span class="c">! We are in charging mode, the temperatures are low enough to charge</span>
<a name="ln-626"></a>          <span class="c">! the tank, and we have some charging left to do.</span>
<a name="ln-627"></a>          <span class="c">! Make first guess at Qstar based on the current ice fraction remaining</span>
<a name="ln-628"></a>          <span class="c">! and LMTDstar that is based on the freezing or TempSetPt temperature.</span>
<a name="ln-629"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TempSetPt</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">FreezingTemp</span><span class="o">-</span><span class="n">DeltaTofMin</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-630"></a>          <span class="c">! Outlet temperature cannot be above the freezing temperature so set</span>
<a name="ln-631"></a>          <span class="c">! the outlet temperature to the freezing temperature and calculate</span>
<a name="ln-632"></a>          <span class="c">! LMTDstar based on that assumption.</span>
<a name="ln-633"></a>        <span class="n">TempSetPt</span>  <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">FreezingTemp</span><span class="o">-</span><span class="n">DeltaTofMin</span>
<a name="ln-634"></a>      <span class="k">END IF</span>
<a name="ln-635"></a>
<a name="ln-636"></a><span class="k">      </span><span class="n">ToutOld</span>  <span class="o">=</span> <span class="n">TempSetPt</span>
<a name="ln-637"></a>      <span class="n">LMTDstar</span> <span class="o">=</span> <span class="n">CalcDetIceStorLMTDstar</span><span class="p">(</span><span class="n">TempIn</span><span class="p">,</span><span class="n">ToutOld</span><span class="p">,</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">FreezingTemp</span><span class="p">)</span>
<a name="ln-638"></a>
<a name="ln-639"></a>          <span class="c">! Find initial guess at average fraction charged during time step</span>
<a name="ln-640"></a>      <span class="n">ChargeFrac</span> <span class="o">=</span> <span class="n">LocalLoad</span> <span class="o">*</span> <span class="n">TimeStepSys</span> <span class="o">/</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">NomCapacity</span>
<a name="ln-641"></a>      <span class="k">IF</span> <span class="p">((</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">IceFracRemaining</span><span class="o">+</span><span class="n">ChargeFrac</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-642"></a><span class="k">        </span><span class="n">ChargeFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">IceFracRemaining</span>
<a name="ln-643"></a>      <span class="k">END IF</span>
<a name="ln-644"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ThawProcessIndex</span> <span class="o">==</span> <span class="n">DetIceInsideMelt</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-645"></a><span class="k">        </span><span class="n">AvgFracCharged</span> <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">IceFracOnCoil</span> <span class="o">+</span> <span class="p">(</span><span class="n">ChargeFrac</span><span class="o">/</span><span class="mf">2.0d0</span><span class="p">)</span>
<a name="ln-646"></a>      <span class="k">ELSE</span> <span class="c">! (DetIceStor(IceNum)%ThawProcessIndex == DetIceOutsideMelt)</span>
<a name="ln-647"></a>        <span class="n">AvgFracCharged</span> <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">IceFracRemaining</span> <span class="o">+</span> <span class="p">(</span><span class="n">ChargeFrac</span><span class="o">/</span><span class="mf">2.0d0</span><span class="p">)</span>
<a name="ln-648"></a>      <span class="k">END IF</span>
<a name="ln-649"></a>
<a name="ln-650"></a><span class="k">      </span><span class="n">Qstar</span>    <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">CurveValue</span><span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ChargeCurveNum</span><span class="p">,</span><span class="n">AvgFracCharged</span><span class="p">,</span><span class="n">LMTDstar</span><span class="p">))</span>
<a name="ln-651"></a>
<a name="ln-652"></a>      <span class="n">ActualLoad</span> <span class="o">=</span> <span class="n">Qstar</span> <span class="o">*</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">NomCapacity</span> <span class="o">/</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">CurveFitTimeStep</span>
<a name="ln-653"></a>
<a name="ln-654"></a>      <span class="n">ToutNew</span> <span class="o">=</span> <span class="n">TempIn</span> <span class="o">+</span> <span class="p">(</span><span class="n">ActualLoad</span><span class="o">/</span><span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span> <span class="n">Cp</span> <span class="p">))</span>
<a name="ln-655"></a>          <span class="c">! Again, the outlet temperature cannot be above the freezing temperature (factoring in the tolerance)</span>
<a name="ln-656"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ToutNew</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">FreezingTemp</span><span class="o">-</span><span class="n">DeltaTofMin</span><span class="p">))</span> <span class="n">ToutNew</span> <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">FreezingTemp</span><span class="o">-</span><span class="n">DeltaTofMin</span>
<a name="ln-657"></a>
<a name="ln-658"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ActualLoad</span> <span class="o">&gt;</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">LocalLoad</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-659"></a>          <span class="c">! We have more than enough capacity to meet the load so no need to iterate to find a solution</span>
<a name="ln-660"></a>        <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">OutletTemp</span>         <span class="o">=</span> <span class="n">TempSetPt</span>
<a name="ln-661"></a>        <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">TankOutletTemp</span>     <span class="o">=</span> <span class="n">ToutNew</span>
<a name="ln-662"></a>        <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">CompLoad</span>           <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span> <span class="n">Cp</span> <span class="o">*</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">TempIn</span> <span class="o">-</span> <span class="n">TempSetPt</span><span class="p">)</span>
<a name="ln-663"></a>        <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">TankMassFlowRate</span>   <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">CompLoad</span> <span class="o">/</span> <span class="n">Cp</span> <span class="o">/</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">TempIn</span> <span class="o">-</span> <span class="n">ToutNew</span><span class="p">)</span>
<a name="ln-664"></a>        <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">BypassMassFlowRate</span> <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">-</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">TankMassFlowRate</span>
<a name="ln-665"></a>
<a name="ln-666"></a>      <span class="k">ELSE</span>
<a name="ln-667"></a>
<a name="ln-668"></a><span class="k">        DO WHILE</span> <span class="p">(</span><span class="n">IterNum</span> <span class="o">&lt;</span> <span class="n">MaxIterNum</span><span class="p">)</span>
<a name="ln-669"></a>          <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">ToutOld</span><span class="o">-</span><span class="n">ToutNew</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">TemperatureToler</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-670"></a>          <span class="c">! Not converged yet so recalculated what is needed and keep iterating</span>
<a name="ln-671"></a>          <span class="c">! Calculate new values for LMTDstar and Qstar based on updated outlet temperature</span>
<a name="ln-672"></a>            <span class="n">ToutOld</span>  <span class="o">=</span> <span class="n">ToutNew</span>
<a name="ln-673"></a>            <span class="n">LMTDstar</span> <span class="o">=</span> <span class="n">CalcDetIceStorLMTDstar</span><span class="p">(</span><span class="n">TempIn</span><span class="p">,</span><span class="n">ToutOld</span><span class="p">,</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">FreezingTemp</span><span class="p">)</span>
<a name="ln-674"></a>            <span class="n">Qstar</span>    <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">CurveValue</span><span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ChargeCurveNum</span><span class="p">,</span><span class="n">AvgFracCharged</span><span class="p">,</span><span class="n">LMTDstar</span><span class="p">))</span>
<a name="ln-675"></a>
<a name="ln-676"></a>          <span class="c">! Now make sure that we don&#39;t go above 100% charged and calculate the new average fraction</span>
<a name="ln-677"></a>            <span class="n">ChargeFrac</span> <span class="o">=</span> <span class="n">Qstar</span> <span class="o">*</span> <span class="p">(</span><span class="n">TimeStepSys</span><span class="o">/</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">CurveFitTimeStep</span><span class="p">)</span>
<a name="ln-678"></a>            <span class="k">IF</span> <span class="p">((</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">IceFracRemaining</span><span class="o">+</span><span class="n">ChargeFrac</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-679"></a><span class="k">              </span><span class="n">ChargeFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">IceFracRemaining</span>
<a name="ln-680"></a>              <span class="n">Qstar</span>      <span class="o">=</span> <span class="n">ChargeFrac</span>
<a name="ln-681"></a>            <span class="k">END IF</span>
<a name="ln-682"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ThawProcessIndex</span> <span class="o">==</span> <span class="n">DetIceInsideMelt</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-683"></a><span class="k">              </span><span class="n">AvgFracCharged</span> <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">IceFracOnCoil</span> <span class="o">+</span> <span class="p">(</span><span class="n">ChargeFrac</span><span class="o">/</span><span class="mf">2.0d0</span><span class="p">)</span>
<a name="ln-684"></a>            <span class="k">ELSE</span> <span class="c">! (DetIceStor(IceNum)%ThawProcessIndex == DetIceOutsideMelt)</span>
<a name="ln-685"></a>              <span class="n">AvgFracCharged</span> <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">IceFracRemaining</span> <span class="o">+</span> <span class="p">(</span><span class="n">ChargeFrac</span><span class="o">/</span><span class="mf">2.0d0</span><span class="p">)</span>
<a name="ln-686"></a>            <span class="k">END IF</span>
<a name="ln-687"></a>
<a name="ln-688"></a>          <span class="c">! Finally, update the actual load and calculate the new outlet temperature; increment iteration counter</span>
<a name="ln-689"></a>            <span class="n">ActualLoad</span> <span class="o">=</span> <span class="n">Qstar</span> <span class="o">*</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">NomCapacity</span> <span class="o">/</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">CurveFitTimeStep</span>
<a name="ln-690"></a>            <span class="n">ToutNew</span>    <span class="o">=</span> <span class="n">TempIn</span> <span class="o">+</span> <span class="p">(</span><span class="n">ActualLoad</span><span class="o">/</span><span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span> <span class="n">Cp</span> <span class="p">))</span>
<a name="ln-691"></a>          <span class="c">! Again, the outlet temperature cannot be above the freezing temperature (factoring in the tolerance)</span>
<a name="ln-692"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ToutNew</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">FreezingTemp</span><span class="o">-</span><span class="n">DeltaTofMin</span><span class="p">))</span> <span class="n">ToutNew</span> <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">FreezingTemp</span><span class="o">-</span><span class="n">DeltaTofMin</span>
<a name="ln-693"></a>            <span class="n">IterNum</span>    <span class="o">=</span> <span class="n">IterNum</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-694"></a>
<a name="ln-695"></a>          <span class="k">ELSE</span>
<a name="ln-696"></a>          <span class="c">! Converged to acceptable tolerance so set output variables and exit DO WHILE loop</span>
<a name="ln-697"></a>            <span class="k">EXIT</span>
<a name="ln-698"></a>
<a name="ln-699"></a><span class="k">          END IF</span>
<a name="ln-700"></a>
<a name="ln-701"></a><span class="k">        END DO</span>    <span class="c">! ...loop iterating for the ice storage outlet temperature</span>
<a name="ln-702"></a>
<a name="ln-703"></a>          <span class="c">! Keep track of times that the iterations got excessive and report if necessary</span>
<a name="ln-704"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IterNum</span> <span class="o">&gt;=</span> <span class="n">MaxIterNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-705"></a><span class="k">          </span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ChargeIterErrors</span> <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ChargeIterErrors</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-706"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ChargeIterErrors</span> <span class="o">&lt;=</span> <span class="mi">25</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-707"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Detailed Ice Storage model exceeded its internal charging maximum iteration limit&#39;</span><span class="p">)</span>
<a name="ln-708"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Detailed Ice Storage System Name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-709"></a>            <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-710"></a>          <span class="k">ELSE</span>
<a name="ln-711"></a><span class="k">            CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;Detailed Ice Storage system [&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-712"></a>                         <span class="s1">&#39;]  charging maximum iteration limit exceeded occurrence continues.&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-713"></a>                         <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ChargeErrorCount</span><span class="p">)</span>
<a name="ln-714"></a>          <span class="k">END IF</span>
<a name="ln-715"></a><span class="k">        END IF</span>
<a name="ln-716"></a>
<a name="ln-717"></a>          <span class="c">! Set the values for the key outlet parameters</span>
<a name="ln-718"></a>          <span class="c">! Note that in REAL(r64)ity the tank will probably bypass some flow when it</span>
<a name="ln-719"></a>          <span class="c">! gets close to full charge.  This is a simplification that assumes</span>
<a name="ln-720"></a>          <span class="c">! all flow through the tank during charging and a lower delta T near</span>
<a name="ln-721"></a>          <span class="c">! the full charge level.  From an energy perspective, this is a reasonable</span>
<a name="ln-722"></a>          <span class="c">! approximation.</span>
<a name="ln-723"></a>        <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">OutletTemp</span>         <span class="o">=</span> <span class="n">ToutNew</span>
<a name="ln-724"></a>        <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">TankOutletTemp</span>     <span class="o">=</span> <span class="n">ToutNew</span>
<a name="ln-725"></a>        <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">BypassMassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-726"></a>        <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">TankMassFlowRate</span>   <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-727"></a>        <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">CompLoad</span>           <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span> <span class="n">Cp</span> <span class="o">*</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">TempIn</span> <span class="o">-</span> <span class="n">ToutNew</span><span class="p">)</span>
<a name="ln-728"></a>
<a name="ln-729"></a>      <span class="k">END IF</span>
<a name="ln-730"></a>
<a name="ln-731"></a><span class="k">    END IF</span>
<a name="ln-732"></a>
<a name="ln-733"></a><span class="k">  </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">LocalLoad</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-734"></a>          <span class="c">! The load is greater than zero so we should be discharging</span>
<a name="ln-735"></a>          <span class="c">! Before we do anything, we should check to make sure that we will actually be discharging the unit</span>
<a name="ln-736"></a>
<a name="ln-737"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">InletTemp</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">FreezingTemp</span><span class="o">+</span><span class="n">DeltaTifMin</span><span class="p">))</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-738"></a>         <span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">IceFracRemaining</span> <span class="o">&lt;=</span> <span class="n">TankDischargeToler</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-739"></a>          <span class="c">! If the inlet temperature is below the freezing temperature of the</span>
<a name="ln-740"></a>          <span class="c">! device, then we cannot actually do any discharging.  Bypass all of the flow.</span>
<a name="ln-741"></a>          <span class="c">! Also, if the tank is already discharged, we can&#39;t to do any further</span>
<a name="ln-742"></a>          <span class="c">! discharging.  So, bypass all of the flow.</span>
<a name="ln-743"></a>      <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">CompLoad</span>           <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-744"></a>      <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">OutletTemp</span>         <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">InletTemp</span>
<a name="ln-745"></a>      <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">TankOutletTemp</span>     <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">InletTemp</span>
<a name="ln-746"></a>      <span class="n">mdot</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-747"></a>      <span class="k">CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">mdot</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-748"></a>                              <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantInNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-749"></a>                              <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantOutNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-750"></a>                              <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-751"></a>                              <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-752"></a>                              <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-753"></a>                              <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantCompNum</span><span class="p">)</span>
<a name="ln-754"></a>
<a name="ln-755"></a>      <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">BypassMassFlowRate</span> <span class="o">=</span> <span class="n">mdot</span>
<a name="ln-756"></a>      <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">TankMassFlowRate</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-757"></a>      <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">MassFlowRate</span>       <span class="o">=</span> <span class="n">mdot</span>
<a name="ln-758"></a>
<a name="ln-759"></a>    <span class="k">ELSE</span>
<a name="ln-760"></a>
<a name="ln-761"></a>          <span class="c">!make flow request so tank will get flow</span>
<a name="ln-762"></a>      <span class="n">mdot</span> <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">DesignMassFlowRate</span>
<a name="ln-763"></a>      <span class="k">CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">mdot</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-764"></a>                              <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantInNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-765"></a>                              <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantOutNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-766"></a>                              <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-767"></a>                              <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-768"></a>                              <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-769"></a>                              <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantCompNum</span><span class="p">)</span>
<a name="ln-770"></a>
<a name="ln-771"></a>          <span class="c">! We are in discharging mode, the temperatures are high enough to discharge</span>
<a name="ln-772"></a>          <span class="c">! the tank, and we have some discharging left to do.</span>
<a name="ln-773"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TempSetPt</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">FreezingTemp</span><span class="o">+</span><span class="n">DeltaTofMin</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-774"></a>          <span class="c">! Outlet temperature cannot be below the freezing temperature so set</span>
<a name="ln-775"></a>          <span class="c">! the outlet temperature to the freezing temperature and calculate</span>
<a name="ln-776"></a>          <span class="c">! LMTDstar based on that assumption.</span>
<a name="ln-777"></a>        <span class="n">TempSetPt</span>  <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">FreezingTemp</span><span class="o">+</span><span class="n">DeltaTofMin</span>
<a name="ln-778"></a>      <span class="k">END IF</span>
<a name="ln-779"></a>
<a name="ln-780"></a><span class="k">      </span><span class="n">ToutOld</span>  <span class="o">=</span> <span class="n">TempSetPt</span>
<a name="ln-781"></a>      <span class="n">LMTDstar</span> <span class="o">=</span> <span class="n">CalcDetIceStorLMTDstar</span><span class="p">(</span><span class="n">TempIn</span><span class="p">,</span><span class="n">ToutOld</span><span class="p">,</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">FreezingTemp</span><span class="p">)</span>
<a name="ln-782"></a>
<a name="ln-783"></a>          <span class="c">! Find initial guess at average fraction charged during time step</span>
<a name="ln-784"></a>      <span class="n">ChargeFrac</span> <span class="o">=</span> <span class="n">LocalLoad</span> <span class="o">*</span> <span class="n">TimeStepSys</span> <span class="o">/</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">NomCapacity</span>
<a name="ln-785"></a>      <span class="k">IF</span> <span class="p">((</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">IceFracRemaining</span><span class="o">-</span><span class="n">ChargeFrac</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">ChargeFrac</span> <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">IceFracRemaining</span>
<a name="ln-786"></a>      <span class="n">AvgFracCharged</span> <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">IceFracRemaining</span> <span class="o">-</span> <span class="p">(</span><span class="n">ChargeFrac</span><span class="o">/</span><span class="mf">2.0d0</span><span class="p">)</span>
<a name="ln-787"></a>
<a name="ln-788"></a>      <span class="n">Qstar</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">CurveValue</span><span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">DischargeCurveNum</span><span class="p">,(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">AvgFracCharged</span><span class="p">),</span><span class="n">LMTDstar</span><span class="p">))</span>
<a name="ln-789"></a>
<a name="ln-790"></a>      <span class="n">ActualLoad</span> <span class="o">=</span> <span class="n">Qstar</span> <span class="o">*</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">NomCapacity</span> <span class="o">/</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">CurveFitTimeStep</span>
<a name="ln-791"></a>
<a name="ln-792"></a>      <span class="n">ToutNew</span> <span class="o">=</span> <span class="n">TempIn</span> <span class="o">-</span> <span class="p">(</span><span class="n">ActualLoad</span><span class="o">/</span><span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span> <span class="n">Cp</span> <span class="p">))</span>
<a name="ln-793"></a>          <span class="c">! Again, the outlet temperature cannot be below the freezing temperature (factoring in the tolerance)</span>
<a name="ln-794"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ToutNew</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">FreezingTemp</span><span class="o">+</span><span class="n">DeltaTofMin</span><span class="p">))</span> <span class="n">ToutNew</span> <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">FreezingTemp</span><span class="o">+</span><span class="n">DeltaTofMin</span>
<a name="ln-795"></a>
<a name="ln-796"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ActualLoad</span> <span class="o">&gt;</span> <span class="n">LocalLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-797"></a>          <span class="c">! We have more than enough storage to meet the load so no need to iterate to find a solution</span>
<a name="ln-798"></a>        <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">OutletTemp</span>         <span class="o">=</span> <span class="n">TempSetPt</span>
<a name="ln-799"></a>        <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">TankOutletTemp</span>     <span class="o">=</span> <span class="n">ToutNew</span>
<a name="ln-800"></a>        <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">CompLoad</span>           <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span> <span class="n">Cp</span> <span class="o">*</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">TempIn</span> <span class="o">-</span> <span class="n">TempSetPt</span><span class="p">)</span>
<a name="ln-801"></a>        <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">TankMassFlowRate</span>   <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">CompLoad</span> <span class="o">/</span> <span class="n">Cp</span> <span class="o">/</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">TempIn</span> <span class="o">-</span> <span class="n">ToutNew</span><span class="p">)</span>
<a name="ln-802"></a>        <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">BypassMassFlowRate</span> <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">-</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">TankMassFlowRate</span>
<a name="ln-803"></a>
<a name="ln-804"></a>      <span class="k">ELSE</span>
<a name="ln-805"></a>
<a name="ln-806"></a><span class="k">        DO WHILE</span> <span class="p">(</span><span class="n">IterNum</span> <span class="o">&lt;</span> <span class="n">MaxIterNum</span><span class="p">)</span>
<a name="ln-807"></a>          <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">ToutOld</span><span class="o">-</span><span class="n">ToutNew</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">TemperatureToler</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-808"></a>          <span class="c">! Not converged yet so recalculated what is needed and keep iterating</span>
<a name="ln-809"></a>          <span class="c">! Calculate new values for LMTDstar and Qstar based on updated outlet temperature</span>
<a name="ln-810"></a>            <span class="n">ToutOld</span>  <span class="o">=</span> <span class="n">ToutNew</span>
<a name="ln-811"></a>            <span class="n">LMTDstar</span> <span class="o">=</span> <span class="n">CalcDetIceStorLMTDstar</span><span class="p">(</span><span class="n">TempIn</span><span class="p">,</span><span class="n">ToutOld</span><span class="p">,</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">FreezingTemp</span><span class="p">)</span>
<a name="ln-812"></a>            <span class="n">Qstar</span>    <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">CurveValue</span><span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">DischargeCurveNum</span><span class="p">,(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">AvgFracCharged</span><span class="p">),</span><span class="n">LMTDstar</span><span class="p">))</span>
<a name="ln-813"></a>
<a name="ln-814"></a>          <span class="c">! Now make sure that we don&#39;t go below 100% discharged and calculate the new average fraction</span>
<a name="ln-815"></a>            <span class="n">ChargeFrac</span> <span class="o">=</span> <span class="n">Qstar</span> <span class="o">*</span> <span class="p">(</span><span class="n">TimeStepSys</span><span class="o">/</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">CurveFitTimeStep</span><span class="p">)</span>
<a name="ln-816"></a>            <span class="k">IF</span> <span class="p">((</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">IceFracRemaining</span><span class="o">-</span><span class="n">ChargeFrac</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-817"></a><span class="k">              </span><span class="n">ChargeFrac</span> <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">IceFracRemaining</span>
<a name="ln-818"></a>              <span class="n">Qstar</span>      <span class="o">=</span> <span class="n">ChargeFrac</span>
<a name="ln-819"></a>            <span class="k">END IF</span>
<a name="ln-820"></a><span class="k">            </span><span class="n">AvgFracCharged</span> <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">IceFracRemaining</span> <span class="o">-</span> <span class="p">(</span><span class="n">ChargeFrac</span><span class="o">/</span><span class="mf">2.0d0</span><span class="p">)</span>
<a name="ln-821"></a>
<a name="ln-822"></a>          <span class="c">! Finally, update the actual load and calculate the new outlet temperature; increment iteration counter</span>
<a name="ln-823"></a>            <span class="n">ActualLoad</span> <span class="o">=</span> <span class="n">Qstar</span> <span class="o">*</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">NomCapacity</span> <span class="o">/</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">CurveFitTimeStep</span>
<a name="ln-824"></a>            <span class="n">ToutNew</span>    <span class="o">=</span> <span class="n">TempIn</span> <span class="o">-</span> <span class="p">(</span><span class="n">ActualLoad</span><span class="o">/</span><span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span> <span class="n">Cp</span><span class="p">))</span>
<a name="ln-825"></a>          <span class="c">! Again, the outlet temperature cannot be below the freezing temperature (factoring in the tolerance)</span>
<a name="ln-826"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ToutNew</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">FreezingTemp</span><span class="o">+</span><span class="n">DeltaTofMin</span><span class="p">))</span> <span class="n">ToutNew</span> <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">FreezingTemp</span><span class="o">+</span><span class="n">DeltaTofMin</span>
<a name="ln-827"></a>            <span class="n">IterNum</span>    <span class="o">=</span> <span class="n">IterNum</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-828"></a>
<a name="ln-829"></a>          <span class="k">ELSE</span>
<a name="ln-830"></a>          <span class="c">! Converged to acceptable tolerance so set output variables and exit DO WHILE loop</span>
<a name="ln-831"></a>            <span class="k">EXIT</span>
<a name="ln-832"></a>
<a name="ln-833"></a><span class="k">          END IF</span>
<a name="ln-834"></a>
<a name="ln-835"></a><span class="k">        END DO</span>    <span class="c">! ...loop iterating for the ice storage outlet temperature</span>
<a name="ln-836"></a>
<a name="ln-837"></a>          <span class="c">! Keep track of times that the iterations got excessive</span>
<a name="ln-838"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IterNum</span> <span class="o">&gt;=</span> <span class="n">MaxIterNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-839"></a><span class="k">          </span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">DischargeIterErrors</span> <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">DischargeIterErrors</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-840"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">DischargeIterErrors</span> <span class="o">&lt;=</span> <span class="mi">25</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-841"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Detailed Ice Storage model exceeded its internal discharging maximum iteration limit&#39;</span><span class="p">)</span>
<a name="ln-842"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Detailed Ice Storage System Name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-843"></a>            <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-844"></a>          <span class="k">ELSE</span>
<a name="ln-845"></a><span class="k">            CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;Detailed Ice Storage system [&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-846"></a>                         <span class="s1">&#39;]  discharging maximum iteration limit exceeded occurrence continues.&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-847"></a>                         <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">DischargeErrorCount</span><span class="p">)</span>
<a name="ln-848"></a>          <span class="k">END IF</span>
<a name="ln-849"></a><span class="k">        END IF</span>
<a name="ln-850"></a>
<a name="ln-851"></a>          <span class="c">! We are now done finding the outlet temperature of the tank.  We need</span>
<a name="ln-852"></a>          <span class="c">! to compare the outlet temperature to the setpoint temperature again</span>
<a name="ln-853"></a>          <span class="c">! to see where we are at and then we can set the values for the key</span>
<a name="ln-854"></a>          <span class="c">! outlet parameters.  If outlet temperature is greater than or equal</span>
<a name="ln-855"></a>          <span class="c">! to the setpoint temperature, then send all flow through the tank.</span>
<a name="ln-856"></a>          <span class="c">! Otherwise, we have more capacity than needed so let&#39;s bypass some</span>
<a name="ln-857"></a>          <span class="c">! flow and meet the setpoint temperautre.</span>
<a name="ln-858"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ToutNew</span> <span class="o">&gt;=</span> <span class="n">TempSetPt</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-859"></a><span class="k">          </span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">OutletTemp</span>         <span class="o">=</span> <span class="n">ToutNew</span>
<a name="ln-860"></a>          <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">TankOutletTemp</span>     <span class="o">=</span> <span class="n">ToutNew</span>
<a name="ln-861"></a>          <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">BypassMassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-862"></a>          <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">TankMassFlowRate</span>   <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-863"></a>          <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">CompLoad</span>           <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span> <span class="n">Cp</span> <span class="o">*</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">TempIn</span> <span class="o">-</span> <span class="n">ToutNew</span><span class="p">)</span>
<a name="ln-864"></a>        <span class="k">ELSE</span>
<a name="ln-865"></a><span class="k">          </span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">OutletTemp</span>         <span class="o">=</span> <span class="n">TempSetPt</span>
<a name="ln-866"></a>          <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">TankOutletTemp</span>     <span class="o">=</span> <span class="n">ToutNew</span>
<a name="ln-867"></a>          <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">CompLoad</span>           <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span> <span class="n">Cp</span> <span class="o">*</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">TempIn</span> <span class="o">-</span> <span class="n">TempSetPt</span><span class="p">)</span>
<a name="ln-868"></a>          <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">TankMassFlowRate</span>   <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">CompLoad</span><span class="o">/</span><span class="p">(</span><span class="n">Cp</span> <span class="o">*</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">TempIn</span> <span class="o">-</span> <span class="n">ToutNew</span><span class="p">))</span>
<a name="ln-869"></a>          <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">BypassMassFlowRate</span> <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">-</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">TankMassFlowRate</span>
<a name="ln-870"></a>        <span class="k">END IF</span>
<a name="ln-871"></a>
<a name="ln-872"></a><span class="k">      END IF</span>
<a name="ln-873"></a>
<a name="ln-874"></a><span class="k">    END IF</span>
<a name="ln-875"></a>
<a name="ln-876"></a><span class="k">  ELSE</span>    <span class="c">! Shouldn&#39;t get here ever (print error if we do)</span>
<a name="ln-877"></a>
<a name="ln-878"></a>    <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Detailed Ice Storage systemic code error--contact EnergyPlus support&#39;</span><span class="p">)</span>
<a name="ln-879"></a>
<a name="ln-880"></a>  <span class="k">END IF</span>
<a name="ln-881"></a>
<a name="ln-882"></a><span class="k">  RETURN</span>
<a name="ln-883"></a>
<a name="ln-884"></a><span class="k">END SUBROUTINE </span><span class="n">SimDetailedIceStorage</span>
<a name="ln-885"></a>
<a name="ln-886"></a>
<a name="ln-887"></a><span class="c">!******************************************************************************</span>
<a name="ln-888"></a><span class="k">SUBROUTINE </span><span class="n">GetIceStorageInput</span>
<a name="ln-889"></a>            <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-890"></a>            <span class="c">!       AUTHOR:</span>
<a name="ln-891"></a>            <span class="c">!       DATE WRITTEN:</span>
<a name="ln-892"></a>
<a name="ln-893"></a>            <span class="c">! PURPOSE OF THIS SUBROUTINE:!This routine will get the input</span>
<a name="ln-894"></a>                         <span class="c">!required by the PrimaryPlantLoopManager.  As such</span>
<a name="ln-895"></a>                         <span class="c">!it will interact with the Input Scanner to retrieve</span>
<a name="ln-896"></a>                         <span class="c">!information from the input file, count the number of</span>
<a name="ln-897"></a>                         <span class="c">!heating and cooling loops and begin to fill the</span>
<a name="ln-898"></a>                         <span class="c">!arrays associated with the type PlantLoopProps.</span>
<a name="ln-899"></a>
<a name="ln-900"></a>
<a name="ln-901"></a>            <span class="c">! METHODOLOGY EMPLOYED: to be determined...</span>
<a name="ln-902"></a>            <span class="c">! REFERENCES:</span>
<a name="ln-903"></a>
<a name="ln-904"></a>            <span class="c">! USE STATEMENTS:</span>
<a name="ln-905"></a>  <span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span>  <span class="n">ShowSevereError</span><span class="p">,</span> <span class="n">ShowWarningError</span><span class="p">,</span> <span class="n">ShowFatalError</span><span class="p">,</span> <span class="n">SetupOutputVariable</span><span class="p">,</span> <span class="n">ShowContinueError</span>
<a name="ln-906"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">VerifyName</span><span class="p">,</span> <span class="n">SameString</span>
<a name="ln-907"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>  <span class="c">! Data for field names, blank numerics</span>
<a name="ln-908"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span>
<a name="ln-909"></a>  <span class="k">USE </span><span class="n">BranchNodeConnections</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TestCompSet</span>
<a name="ln-910"></a>  <span class="k">USE </span><span class="n">NodeInputManager</span><span class="p">,</span>   <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetOnlySingleNode</span>
<a name="ln-911"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-912"></a>
<a name="ln-913"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-914"></a>
<a name="ln-915"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-916"></a>          <span class="c">! na</span>
<a name="ln-917"></a>
<a name="ln-918"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-919"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Blank</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
<a name="ln-920"></a>
<a name="ln-921"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-922"></a>          <span class="c">! na</span>
<a name="ln-923"></a>
<a name="ln-924"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-925"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IceNum</span>
<a name="ln-926"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumAlphas</span> <span class="c">! Number of elements in the alpha array</span>
<a name="ln-927"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumNums</span>   <span class="c">! Number of elements in the numeric array</span>
<a name="ln-928"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IOStat</span>    <span class="c">! IO Status when calling get input subroutine</span>
<a name="ln-929"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ErrorsFound</span>
<a name="ln-930"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">IsNotOK</span>               <span class="c">! Flag to verify name</span>
<a name="ln-931"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">IsBlank</span>               <span class="c">! Flag for blank name</span>
<a name="ln-932"></a>          <span class="c">! FLOW:</span>
<a name="ln-933"></a>
<a name="ln-934"></a>  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! Always need to reset this since there are multiple types of ice storage systems</span>
<a name="ln-935"></a>
<a name="ln-936"></a>  <span class="c">!LOAD ARRAYS WITH IceStorage DATA</span>
<a name="ln-937"></a>  <span class="n">NumIceStorages</span>    <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cIceStorageSimple</span><span class="p">)</span>      <span class="c">! by ZG</span>
<a name="ln-938"></a>  <span class="n">NumDetIceStorages</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cIceStorageDetailed</span><span class="p">)</span>
<a name="ln-939"></a>
<a name="ln-940"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">IceStorageTypeMap</span><span class="p">(</span><span class="n">NumIceStorages</span><span class="o">+</span><span class="n">NumDetIceStorages</span><span class="p">))</span>
<a name="ln-941"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">CheckEquipName</span><span class="p">(</span><span class="n">NumIceStorages</span><span class="o">+</span><span class="n">NumDetIceStorages</span><span class="p">))</span>
<a name="ln-942"></a>  <span class="n">CheckEquipName</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-943"></a>
<a name="ln-944"></a>  <span class="c">! Allocate IceStorage based on NumOfIceStorage</span>
<a name="ln-945"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">IceStorage</span><span class="p">(</span><span class="n">NumIceStorages</span><span class="p">))</span>
<a name="ln-946"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">IceStorageReport</span><span class="p">(</span><span class="n">NumIceStorages</span><span class="p">))</span>
<a name="ln-947"></a>
<a name="ln-948"></a>  <span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="n">cIceStorageSimple</span>
<a name="ln-949"></a>  <span class="k">DO </span><span class="n">IceNum</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">NumIceStorages</span>
<a name="ln-950"></a>
<a name="ln-951"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">IceNum</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-952"></a>                    <span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-953"></a>    <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-954"></a>    <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-955"></a>    <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">IceStorage</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">IceNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-956"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-957"></a><span class="k">      </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-958"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-959"></a>    <span class="n">ENDIF</span>
<a name="ln-960"></a>
<a name="ln-961"></a>    <span class="n">TotalIceStorages</span><span class="o">=</span><span class="n">TotalIceStorages</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-962"></a>    <span class="n">IceStorageTypeMap</span><span class="p">(</span><span class="n">TotalIceStorages</span><span class="p">)%</span><span class="n">StorageType</span><span class="o">=</span><span class="n">cCurrentModuleObject</span>
<a name="ln-963"></a>    <span class="n">IceStorageTypeMap</span><span class="p">(</span><span class="n">TotalIceStorages</span><span class="p">)%</span><span class="n">StorageType_Num</span><span class="o">=</span><span class="n">IceStorageType_Simple</span>
<a name="ln-964"></a>    <span class="n">IceStorageTypeMap</span><span class="p">(</span><span class="n">TotalIceStorages</span><span class="p">)%</span><span class="n">Name</span><span class="o">=</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-965"></a>    <span class="n">IceStorageTypeMap</span><span class="p">(</span><span class="n">TotalIceStorages</span><span class="p">)%</span><span class="n">LocalEqNum</span><span class="o">=</span><span class="n">IceNum</span>
<a name="ln-966"></a>    <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">MapNum</span>      <span class="o">=</span> <span class="n">TotalIceStorages</span>
<a name="ln-967"></a>
<a name="ln-968"></a>    <span class="c">! ITS name</span>
<a name="ln-969"></a>    <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">Name</span>      <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-970"></a>
<a name="ln-971"></a>    <span class="c">! Get Ice Thermal Storage Type</span>
<a name="ln-972"></a>    <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSType</span>   <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-973"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSType</span><span class="p">,</span><span class="s1">&#39;IceOnCoilInternal&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-974"></a><span class="k">      </span><span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSType_Num</span><span class="o">=</span><span class="n">ITSType_IceOnCoilInternal</span>
<a name="ln-975"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSType</span><span class="p">,</span><span class="s1">&#39;IceOnCoilExternal&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-976"></a><span class="k">      </span><span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSType_Num</span><span class="o">=</span><span class="n">ITSType_IceOnCoilExternal</span>
<a name="ln-977"></a>    <span class="k">ELSE</span>
<a name="ln-978"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-979"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-980"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-981"></a>    <span class="n">ENDIF</span>
<a name="ln-982"></a>
<a name="ln-983"></a>    <span class="c">! Get and Verify ITS nominal Capacity (user input is in GJ, internal value in in J)</span>
<a name="ln-984"></a>    <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSNomCap</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mf">1.d+09</span>
<a name="ln-985"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-986"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-987"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-988"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-989"></a>    <span class="n">ENDIF</span>
<a name="ln-990"></a>
<a name="ln-991"></a>    <span class="c">! Get Plant Inlet Node Num</span>
<a name="ln-992"></a>    <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PltInletNodeNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-993"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-994"></a>               <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-995"></a>
<a name="ln-996"></a>    <span class="c">! Get Plant Outlet Node Num</span>
<a name="ln-997"></a>    <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PltOutletNodeNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-998"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-999"></a>               <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-1000"></a>
<a name="ln-1001"></a>         <span class="c">! Test InletNode and OutletNode</span>
<a name="ln-1002"></a>    <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;Chilled Water Nodes&#39;</span><span class="p">)</span>
<a name="ln-1003"></a>
<a name="ln-1004"></a>         <span class="c">! Initialize Report Variables</span>
<a name="ln-1005"></a>    <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">MyLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1006"></a>    <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">U</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1007"></a>    <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">Urate</span>            <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1008"></a>    <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">IceFracRemain</span>    <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-1009"></a>    <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSCoolingRate</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1010"></a>    <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSCoolingEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1011"></a>    <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSChargingRate</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1012"></a>    <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSChargingEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1013"></a>    <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSmdot</span>          <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1014"></a>    <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSInletTemp</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1015"></a>    <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSOutletTemp</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1016"></a>
<a name="ln-1017"></a>  <span class="k">END DO</span>  <span class="c">! IceNum</span>
<a name="ln-1018"></a>
<a name="ln-1019"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1020"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Errors found in processing input for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1021"></a>  <span class="n">ENDIF</span>
<a name="ln-1022"></a>
<a name="ln-1023"></a>
<a name="ln-1024"></a>  <span class="c">! Setup Output Variables to Report  CurrentModuleObject=&#39;ThermalStorage:Ice:Simple&#39;</span>
<a name="ln-1025"></a>  <span class="c">!********************************************</span>
<a name="ln-1026"></a>  <span class="k">DO </span><span class="n">IceNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumIceStorages</span>
<a name="ln-1027"></a>
<a name="ln-1028"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Ice Thermal Storage Requested Load [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1029"></a>          <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">MyLoad</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1030"></a>
<a name="ln-1031"></a>          <span class="c">! Ice fraction</span>
<a name="ln-1032"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Ice Thermal Storage End Fraction []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1033"></a>          <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">IceFracRemain</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1034"></a>
<a name="ln-1035"></a>          <span class="c">! Discharge: ITS Information</span>
<a name="ln-1036"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Ice Thermal Storage Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1037"></a>          <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSmdot</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1038"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Ice Thermal Storage Inlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1039"></a>          <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSInletTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1040"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Ice Thermal Storage Outlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1041"></a>          <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSOutletTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1042"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Ice Thermal Storage Cooling Discharge Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1043"></a>          <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSCoolingRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1044"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Ice Thermal Storage Cooling Discharge Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1045"></a>          <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSCoolingEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1046"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Ice Thermal Storage Cooling Charge Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1047"></a>          <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSChargingRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1048"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Ice Thermal Storage Cooling Charge Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1049"></a>          <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSChargingEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1050"></a>
<a name="ln-1051"></a>  <span class="k">END DO</span>  <span class="c">! IceNum</span>
<a name="ln-1052"></a>
<a name="ln-1053"></a>  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! Always need to reset this since there are multiple types of ice storage systems</span>
<a name="ln-1054"></a>
<a name="ln-1055"></a>          <span class="c">! Determine the number of detailed ice storage devices are in the input file and allocate appropriately</span>
<a name="ln-1056"></a>  <span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="n">cIceStorageDetailed</span>
<a name="ln-1057"></a>
<a name="ln-1058"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">NumDetIceStorages</span><span class="p">))</span>   <span class="c">! Allocate DetIceStorage based on NumDetIceStorages</span>
<a name="ln-1059"></a>
<a name="ln-1060"></a>  <span class="k">DO </span><span class="n">IceNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumDetIceStorages</span>
<a name="ln-1061"></a>
<a name="ln-1062"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">IceNum</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1063"></a>                    <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1064"></a>                    <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-1065"></a>    <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1066"></a>    <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1067"></a>    <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">DetIceStor</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">IceNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-1068"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1069"></a><span class="k">      </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1070"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-1071"></a>    <span class="k">END IF</span>
<a name="ln-1072"></a>
<a name="ln-1073"></a><span class="k">    </span><span class="n">TotalIceStorages</span><span class="o">=</span><span class="n">TotalIceStorages</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1074"></a>    <span class="n">IceStorageTypeMap</span><span class="p">(</span><span class="n">TotalIceStorages</span><span class="p">)%</span><span class="n">StorageType</span><span class="o">=</span><span class="n">cCurrentModuleObject</span>
<a name="ln-1075"></a>    <span class="n">IceStorageTypeMap</span><span class="p">(</span><span class="n">TotalIceStorages</span><span class="p">)%</span><span class="n">StorageType_Num</span><span class="o">=</span><span class="n">IceStorageType_Detailed</span>
<a name="ln-1076"></a>    <span class="n">IceStorageTypeMap</span><span class="p">(</span><span class="n">TotalIceStorages</span><span class="p">)%</span><span class="n">Name</span><span class="o">=</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1077"></a>    <span class="n">IceStorageTypeMap</span><span class="p">(</span><span class="n">TotalIceStorages</span><span class="p">)%</span><span class="n">LocalEqNum</span><span class="o">=</span><span class="n">IceNum</span>
<a name="ln-1078"></a>
<a name="ln-1079"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">MapNum</span> <span class="o">=</span> <span class="n">TotalIceStorages</span>
<a name="ln-1080"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c">! Detailed ice storage name</span>
<a name="ln-1081"></a>
<a name="ln-1082"></a>          <span class="c">! Get and verify availability schedule</span>
<a name="ln-1083"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ScheduleName</span>  <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="c">! Detailed ice storage availability schedule name</span>
<a name="ln-1084"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1085"></a><span class="k">      </span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ScheduleIndex</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-1086"></a>    <span class="k">ELSE</span>
<a name="ln-1087"></a><span class="k">      </span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ScheduleIndex</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ScheduleName</span><span class="p">)</span>
<a name="ln-1088"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ScheduleIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1089"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-1090"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1091"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1092"></a>      <span class="k">END IF</span>
<a name="ln-1093"></a><span class="k">    END IF</span>
<a name="ln-1094"></a>
<a name="ln-1095"></a>          <span class="c">! Get and Verify ITS nominal Capacity (user input is in GJ, internal value is in W-hr)</span>
<a name="ln-1096"></a>          <span class="c">! Convert GJ to J by multiplying by 10^9</span>
<a name="ln-1097"></a>          <span class="c">! Convert J to W-hr by dividing by number of seconds in an hour (3600)</span>
<a name="ln-1098"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">NomCapacity</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.d+09</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">SecInHour</span><span class="p">)</span>
<a name="ln-1099"></a>
<a name="ln-1100"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1101"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-1102"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1103"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1104"></a>    <span class="n">ENDIF</span>
<a name="ln-1105"></a>
<a name="ln-1106"></a>          <span class="c">! Get Plant Inlet Node Num</span>
<a name="ln-1107"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantInNodeNum</span> <span class="o">=</span> <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1108"></a>                                                          <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-1109"></a>
<a name="ln-1110"></a>          <span class="c">! Get Plant Outlet Node Num</span>
<a name="ln-1111"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantOutNodeNum</span> <span class="o">=</span> <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1112"></a>                                                           <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-1113"></a>
<a name="ln-1114"></a>          <span class="c">! Test InletNode and OutletNode</span>
<a name="ln-1115"></a>    <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;Chilled Water Nodes&#39;</span><span class="p">)</span>
<a name="ln-1116"></a>
<a name="ln-1117"></a>          <span class="c">! Obtain the Charging and Discharging Curve types and names</span>
<a name="ln-1118"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">DischargeCurveName</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-1119"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">DischargeCurveNum</span>  <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1120"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">DischargeCurveNum</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1121"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-1122"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1123"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1124"></a>    <span class="k">ELSE</span>
<a name="ln-1125"></a><span class="k">    </span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">DischargeCurveType</span> <span class="o">=</span> <span class="n">GetCurveType</span><span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">DischargeCurveNum</span><span class="p">)</span>
<a name="ln-1126"></a>    <span class="k">END IF</span>
<a name="ln-1127"></a><span class="k">    IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">DischargeCurveType</span> <span class="o">/=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1128"></a>         <span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">DischargeCurveType</span> <span class="o">/=</span> <span class="s1">&#39;QUADRATICLINEAR&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1129"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Discharge curve type not valid, type=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-1130"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1131"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Type does not match type for curve name or type does not equal QuadraticLinear&#39;</span><span class="p">)</span>
<a name="ln-1132"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1133"></a>    <span class="k">END IF</span>
<a name="ln-1134"></a>
<a name="ln-1135"></a><span class="k">    </span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ChargeCurveName</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-1136"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ChargeCurveNum</span>  <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<a name="ln-1137"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ChargeCurveNum</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1138"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">)))</span>
<a name="ln-1139"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1140"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1141"></a>    <span class="k">ELSE</span>
<a name="ln-1142"></a><span class="k">    </span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ChargeCurveType</span> <span class="o">=</span> <span class="n">GetCurveType</span><span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ChargeCurveNum</span><span class="p">)</span>
<a name="ln-1143"></a>    <span class="k">END IF</span>
<a name="ln-1144"></a><span class="k">    IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ChargeCurveType</span> <span class="o">/=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1145"></a>         <span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ChargeCurveType</span> <span class="o">/=</span> <span class="s1">&#39;QUADRATICLINEAR&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1146"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: Charge curve type not valid, type=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">)))</span>
<a name="ln-1147"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1148"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Type does not match type for curve name or type does not equal QuadraticLinear&#39;</span><span class="p">)</span>
<a name="ln-1149"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1150"></a>    <span class="k">END IF</span>
<a name="ln-1151"></a>
<a name="ln-1152"></a><span class="k">    </span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">CurveFitTimeStep</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1153"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">CurveFitTimeStep</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">CurveFitTimeStep</span> <span class="o">&gt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1154"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1155"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1156"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve fit time step invalid, less than zero or greater than 1 for &#39;</span> <span class="p">&amp;</span>
<a name="ln-1157"></a>                           <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1158"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1159"></a>    <span class="k">END IF</span>
<a name="ln-1160"></a>
<a name="ln-1161"></a><span class="k">    </span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ThawProcessIndicator</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-1162"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ThawProcessIndicator</span><span class="p">,</span><span class="s1">&#39;INSIDEMELT&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1163"></a><span class="k">      </span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ThawProcessIndex</span> <span class="o">=</span> <span class="n">DetIceInsideMelt</span>
<a name="ln-1164"></a>    <span class="n">ELSEIF</span> <span class="p">(</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ThawProcessIndicator</span><span class="p">,</span><span class="s1">&#39;OUTSIDEMELT&#39;</span><span class="p">))</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1165"></a>             <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ThawProcessIndicator</span><span class="p">,</span><span class="n">Blank</span><span class="p">))</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1166"></a><span class="k">      </span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ThawProcessIndex</span> <span class="o">=</span> <span class="n">DetIceOutsideMelt</span>
<a name="ln-1167"></a>    <span class="k">ELSE</span>
<a name="ln-1168"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid thaw process indicator of &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; was entered&#39;</span><span class="p">)</span>
<a name="ln-1169"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1170"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Value should either be &quot;InsideMelt&quot; or &quot;OutsideMelt&quot;&#39;</span><span class="p">)</span>
<a name="ln-1171"></a>      <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ThawProcessIndex</span> <span class="o">=</span> <span class="n">DetIceInsideMelt</span> <span class="c">! Severe error will end simulation, but just in case...</span>
<a name="ln-1172"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1173"></a>    <span class="k">END IF</span>
<a name="ln-1174"></a>
<a name="ln-1175"></a>          <span class="c">! Get the other ice storage parameters (electric, heat loss, freezing temperature) and stupidity check each one</span>
<a name="ln-1176"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">DischargeParaElecLoad</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1177"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ChargeParaElecLoad</span>    <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1178"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">TankLossCoeff</span>         <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-1179"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">FreezingTemp</span>          <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-1180"></a>
<a name="ln-1181"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">DischargeParaElecLoad</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">DischargeParaElecLoad</span> <span class="o">&gt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1182"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1183"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1184"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Value is either less than/equal to zero or greater than 1&#39;</span><span class="p">)</span>
<a name="ln-1185"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1186"></a>    <span class="k">END IF</span>
<a name="ln-1187"></a>
<a name="ln-1188"></a><span class="k">    IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ChargeParaElecLoad</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ChargeParaElecLoad</span> <span class="o">&gt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1189"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1190"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1191"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Value is either less than/equal to zero or greater than 1&#39;</span><span class="p">)</span>
<a name="ln-1192"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1193"></a>    <span class="k">END IF</span>
<a name="ln-1194"></a>
<a name="ln-1195"></a><span class="k">    IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">TankLossCoeff</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">TankLossCoeff</span> <span class="o">&gt;</span> <span class="mf">0.1d0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1196"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1197"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1198"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Value is either less than/equal to zero or greater than 0.1 (10%)&#39;</span><span class="p">)</span>
<a name="ln-1199"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1200"></a>    <span class="k">END IF</span>
<a name="ln-1201"></a>
<a name="ln-1202"></a><span class="k">    IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">FreezingTemp</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">1</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">FreezingTemp</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1203"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Potentially invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1204"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1205"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Value is either less than -10.0C or greater than 10.0C&#39;</span><span class="p">)</span>
<a name="ln-1206"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This value will be allowed but the user should verify that this temperature is correct&#39;</span><span class="p">)</span>
<a name="ln-1207"></a>    <span class="k">END IF</span>
<a name="ln-1208"></a>
<a name="ln-1209"></a>          <span class="c">! Initialize Report Variables</span>
<a name="ln-1210"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">CompLoad</span>            <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1211"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">IceFracChange</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1212"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">IceFracRemaining</span>    <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-1213"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">IceFracOnCoil</span>       <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-1214"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">DischargingRate</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1215"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">DischargingEnergy</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1216"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ChargingRate</span>        <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1217"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ChargingEnergy</span>      <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1218"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">MassFlowRate</span>        <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1219"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">BypassMassFlowRate</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1220"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">TankMassFlowRate</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1221"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">InletTemp</span>           <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1222"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">OutletTemp</span>          <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1223"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">TankOutletTemp</span>      <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1224"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ParasiticElecRate</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1225"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ParasiticElecEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1226"></a>
<a name="ln-1227"></a>  <span class="k">END DO</span>  <span class="c">! ...over detailed ice storage units</span>
<a name="ln-1228"></a>
<a name="ln-1229"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">NumIceStorages</span><span class="o">+</span><span class="n">NumDetIceStorages</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1230"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;No Ice Storage Equipment found in GetIceStorage&#39;</span><span class="p">)</span>
<a name="ln-1231"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1232"></a>  <span class="n">ENDIF</span>
<a name="ln-1233"></a>
<a name="ln-1234"></a>
<a name="ln-1235"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1236"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Errors found in processing input for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">))</span>
<a name="ln-1237"></a>  <span class="n">ENDIF</span>
<a name="ln-1238"></a>
<a name="ln-1239"></a>
<a name="ln-1240"></a>  <span class="c">! Setup Output Variables to Report CurrentModuleObject=&#39;ThermalStorage:Ice:Detailed&#39;</span>
<a name="ln-1241"></a>  <span class="c">!********************************************</span>
<a name="ln-1242"></a>  <span class="k">DO </span><span class="n">IceNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumDetIceStorages</span>
<a name="ln-1243"></a>
<a name="ln-1244"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Ice Thermal Storage Cooling Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1245"></a>                               <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">CompLoad</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1246"></a>
<a name="ln-1247"></a>          <span class="c">! Ice fraction</span>
<a name="ln-1248"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Ice Thermal Storage Change Fraction []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1249"></a>                               <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">IceFracChange</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1250"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Ice Thermal Storage End Fraction []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1251"></a>                               <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">IceFracRemaining</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1252"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Ice Thermal Storage On Coil Fraction []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1253"></a>                               <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">IceFracOnCoil</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1254"></a>
<a name="ln-1255"></a>          <span class="c">! Discharge: ITS Information</span>
<a name="ln-1256"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Ice Thermal Storage Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1257"></a>                               <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">MassFlowRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1258"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Ice Thermal Storage Bypass Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1259"></a>                               <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">BypassMassFlowRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1260"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Ice Thermal Storage Tank Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1261"></a>                               <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">TankMassFlowRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1262"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Ice Thermal Storage Fluid Inlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1263"></a>                               <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">InletTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1264"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Ice Thermal Storage Blended Outlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1265"></a>                               <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">OutletTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1266"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Ice Thermal Storage Tank Outlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1267"></a>                               <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">TankOutletTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1268"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Ice Thermal Storage Cooling Discharge Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1269"></a>                               <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">DischargingRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1270"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Ice Thermal Storage Cooling Discharge Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1271"></a>                               <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">DischargingEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1272"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Ice Thermal Storage Cooling Charge Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1273"></a>                               <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ChargingRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1274"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Ice Thermal Storage Cooling Charge Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1275"></a>                               <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ChargingEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1276"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Ice Thermal Storage Ancillary Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1277"></a>                               <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ParasiticElecRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1278"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Ice Thermal Storage Ancillary Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1279"></a>                               <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ParasiticElecEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1280"></a>                               <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;ELECTRICITY&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-1281"></a>
<a name="ln-1282"></a>  <span class="k">END DO</span>  <span class="c">! ...over detailed ice storage units</span>
<a name="ln-1283"></a>
<a name="ln-1284"></a>  <span class="k">RETURN</span>
<a name="ln-1285"></a>
<a name="ln-1286"></a><span class="k">END SUBROUTINE </span><span class="n">GetIceStorageInput</span>
<a name="ln-1287"></a>
<a name="ln-1288"></a>
<a name="ln-1289"></a><span class="c">!******************************************************************************</span>
<a name="ln-1290"></a><span class="k">SUBROUTINE </span><span class="n">InitDetailedIceStorage</span>
<a name="ln-1291"></a>
<a name="ln-1292"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1293"></a>          <span class="c">!       AUTHOR         Rick Strand</span>
<a name="ln-1294"></a>          <span class="c">!       DATE WRITTEN   February 2006</span>
<a name="ln-1295"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-1296"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1297"></a>
<a name="ln-1298"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1299"></a>          <span class="c">! This subroutine initializes variables for the detailed ice storage model.</span>
<a name="ln-1300"></a>
<a name="ln-1301"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1302"></a>          <span class="c">! Initializes parameters based on current status flag values.</span>
<a name="ln-1303"></a>
<a name="ln-1304"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1305"></a>          <span class="c">! na</span>
<a name="ln-1306"></a>
<a name="ln-1307"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1308"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">BeginEnvrnFlag</span>
<a name="ln-1309"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>   <span class="n">ONLY</span> <span class="p">:</span> <span class="n">ScanPlantLoopsForObject</span><span class="p">,</span> <span class="n">PlantLoop</span><span class="p">,</span> <span class="n">TypeOf_TS_IceDetailed</span><span class="p">,</span> <span class="n">CommonPipe_TwoWay</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1310"></a>                          <span class="n">SupplySide</span><span class="p">,</span> <span class="n">LoopFlowStatus_NeedyAndTurnsLoopOn</span>
<a name="ln-1311"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">InitComponentNodes</span>
<a name="ln-1312"></a>
<a name="ln-1313"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1314"></a>
<a name="ln-1315"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1316"></a>          <span class="c">! na</span>
<a name="ln-1317"></a>
<a name="ln-1318"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1319"></a>          <span class="c">! na</span>
<a name="ln-1320"></a>
<a name="ln-1321"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-1322"></a>          <span class="c">! na</span>
<a name="ln-1323"></a>
<a name="ln-1324"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-1325"></a>          <span class="c">! na</span>
<a name="ln-1326"></a>
<a name="ln-1327"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1328"></a>  <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">SAVE</span>        <span class="kd">::</span> <span class="n">MyOneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1329"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyPlantScanFlag</span>
<a name="ln-1330"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyEnvrnFlag</span>
<a name="ln-1331"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CompNum</span> <span class="c">! local do loop index</span>
<a name="ln-1332"></a>          <span class="c">! FLOW:</span>
<a name="ln-1333"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MyOneTimeFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1334"></a><span class="k">    ALLOCATE</span><span class="p">(</span><span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">NumDetIceStorages</span><span class="p">))</span>
<a name="ln-1335"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">NumDetIceStorages</span><span class="p">))</span>
<a name="ln-1336"></a>    <span class="n">MyPlantScanFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1337"></a>    <span class="n">MyEnvrnFlag</span>     <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1338"></a>    <span class="n">MyOneTimeFlag</span>   <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1339"></a>  <span class="n">ENDIF</span>
<a name="ln-1340"></a>
<a name="ln-1341"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">IceNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1342"></a><span class="k">    CALL </span><span class="n">ScanPlantLoopsForObject</span><span class="p">(</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1343"></a>                                  <span class="n">TypeOf_TS_IceDetailed</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1344"></a>                                  <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1345"></a>                                  <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1346"></a>                                  <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1347"></a>                                  <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantCompNum</span><span class="p">)</span>
<a name="ln-1348"></a>
<a name="ln-1349"></a>
<a name="ln-1350"></a>    <span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1351"></a>  <span class="n">ENDIF</span>
<a name="ln-1352"></a>
<a name="ln-1353"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">BeginEnvrnFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">IceNum</span><span class="p">))</span> <span class="k">THEN</span>  <span class="c">! Beginning of environment initializations</span>
<a name="ln-1354"></a>          <span class="c">! Make sure all state variables are reset at the beginning of every environment to avoid problems.</span>
<a name="ln-1355"></a>          <span class="c">! The storage unit is assumed to be fully charged at the start of any environment.</span>
<a name="ln-1356"></a>          <span class="c">! The IceNum variable is a module level variable that is already set before this subroutine is called.</span>
<a name="ln-1357"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">IceFracChange</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1358"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">IceFracRemaining</span>    <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-1359"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">IceFracOnCoil</span>       <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-1360"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">InletTemp</span>           <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1361"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">OutletTemp</span>          <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1362"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">TankOutletTemp</span>      <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1363"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">DischargeIterErrors</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1364"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ChargeIterErrors</span>    <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1365"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">DesignMassFlowRate</span>  <span class="o">=</span> <span class="n">PlantLoop</span><span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantLoopNum</span><span class="p">)%</span><span class="n">MaxMassFlowRate</span>
<a name="ln-1366"></a>    <span class="c">!no design flow rates for model, assume min is zero and max is plant loop&#39;s max</span>
<a name="ln-1367"></a>    <span class="k">CALL </span><span class="n">InitComponentNodes</span><span class="p">(</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">DesignMassFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1368"></a>                                  <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantInNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1369"></a>                                  <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantOutNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1370"></a>                                  <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1371"></a>                                  <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1372"></a>                                  <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1373"></a>                                  <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantCompNum</span><span class="p">)</span>
<a name="ln-1374"></a>
<a name="ln-1375"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantLoopNum</span><span class="p">)%</span><span class="n">CommonPipeType</span> <span class="o">==</span> <span class="n">CommonPipe_TwoWay</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1376"></a>        <span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantLoopSideNum</span> <span class="o">==</span> <span class="n">SupplySide</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1377"></a>      <span class="c">! up flow priority of other components on the same branch as the Ice tank</span>
<a name="ln-1378"></a>      <span class="k">DO </span><span class="n">CompNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">PlantLoop</span><span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantLoopNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">(</span><span class="n">SupplySide</span><span class="p">)%</span> <span class="p">&amp;</span>
<a name="ln-1379"></a>                           <span class="n">Branch</span><span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantBranchNum</span><span class="p">)%</span><span class="n">TotalComponents</span>
<a name="ln-1380"></a>        <span class="n">PlantLoop</span><span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantLoopNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">(</span><span class="n">SupplySide</span><span class="p">)%</span> <span class="p">&amp;</span>
<a name="ln-1381"></a>           <span class="n">Branch</span><span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantBranchNum</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">FlowPriority</span> <span class="o">=</span> <span class="n">LoopFlowStatus_NeedyAndTurnsLoopOn</span>
<a name="ln-1382"></a>      <span class="n">ENDDO</span>
<a name="ln-1383"></a>
<a name="ln-1384"></a>    <span class="n">ENDIF</span>
<a name="ln-1385"></a>
<a name="ln-1386"></a>    <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1387"></a>  <span class="k">END IF</span>
<a name="ln-1388"></a><span class="k">  IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">BeginEnvrnFlag</span><span class="p">)</span> <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1389"></a>
<a name="ln-1390"></a>          <span class="c">! Initializations that are done every iteration</span>
<a name="ln-1391"></a>          <span class="c">! Make sure all of the reporting variables are always reset at the start of any iteration</span>
<a name="ln-1392"></a>  <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">CompLoad</span>            <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1393"></a>  <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">IceFracChange</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1394"></a>  <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">DischargingRate</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1395"></a>  <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">DischargingEnergy</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1396"></a>  <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ChargingRate</span>        <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1397"></a>  <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ChargingEnergy</span>      <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1398"></a>  <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">MassFlowRate</span>        <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1399"></a>  <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">BypassMassFlowRate</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1400"></a>  <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">TankMassFlowRate</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1401"></a>  <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ParasiticElecRate</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1402"></a>  <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ParasiticElecEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1403"></a>
<a name="ln-1404"></a>  <span class="k">RETURN</span>
<a name="ln-1405"></a>
<a name="ln-1406"></a><span class="k">END SUBROUTINE </span><span class="n">InitDetailedIceStorage</span>
<a name="ln-1407"></a>
<a name="ln-1408"></a>
<a name="ln-1409"></a><span class="k">SUBROUTINE </span><span class="n">InitSimpleIceStorage</span>
<a name="ln-1410"></a>
<a name="ln-1411"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1412"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-1413"></a>          <span class="c">!       DATE WRITTEN   Jan 2010</span>
<a name="ln-1414"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-1415"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1416"></a>
<a name="ln-1417"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1418"></a>          <span class="c">! do initializations for simple ice storage</span>
<a name="ln-1419"></a>
<a name="ln-1420"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1421"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-1422"></a>
<a name="ln-1423"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1424"></a>          <span class="c">! na</span>
<a name="ln-1425"></a>
<a name="ln-1426"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1427"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">BeginEnvrnFlag</span>
<a name="ln-1428"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">TypeOf_TS_IceSimple</span><span class="p">,</span> <span class="n">PlantLoop</span><span class="p">,</span> <span class="n">ScanPlantLoopsForObject</span><span class="p">,</span><span class="n">CommonPipe_TwoWay</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1429"></a>                          <span class="n">SupplySide</span><span class="p">,</span> <span class="n">LoopFlowStatus_NeedyAndTurnsLoopOn</span>
<a name="ln-1430"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">InitComponentNodes</span>
<a name="ln-1431"></a>
<a name="ln-1432"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1433"></a>
<a name="ln-1434"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1435"></a>          <span class="c">! na</span>
<a name="ln-1436"></a>
<a name="ln-1437"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1438"></a>          <span class="c">! na</span>
<a name="ln-1439"></a>
<a name="ln-1440"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-1441"></a>          <span class="c">! na</span>
<a name="ln-1442"></a>
<a name="ln-1443"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-1444"></a>          <span class="c">! na</span>
<a name="ln-1445"></a>
<a name="ln-1446"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1447"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyPlantScanFlag</span>
<a name="ln-1448"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span>                            <span class="kd">::</span> <span class="n">MyOneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1449"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyEnvrnFlag</span>
<a name="ln-1450"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">errFlag</span>
<a name="ln-1451"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CompNum</span> <span class="c">! local do loop counter</span>
<a name="ln-1452"></a>
<a name="ln-1453"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MyOneTimeFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1454"></a><span class="k">    ALLOCATE</span><span class="p">(</span><span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">NumIceStorages</span><span class="p">))</span>
<a name="ln-1455"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">NumIceStorages</span><span class="p">))</span>
<a name="ln-1456"></a>    <span class="n">MyOneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1457"></a>    <span class="n">MyPlantScanFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1458"></a>    <span class="n">MyEnvrnFlag</span>     <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1459"></a>  <span class="k">END IF</span>
<a name="ln-1460"></a>
<a name="ln-1461"></a>
<a name="ln-1462"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">IceNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1463"></a>    <span class="c">! Locate the storage on the plant loops for later usage</span>
<a name="ln-1464"></a>    <span class="n">errFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1465"></a>    <span class="k">CALL </span><span class="n">ScanPlantLoopsForObject</span><span class="p">(</span><span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1466"></a>                                 <span class="n">TypeOf_TS_IceSimple</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1467"></a>                                 <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1468"></a>                                 <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">LoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1469"></a>                                 <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">BranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1470"></a>                                 <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">CompNum</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1471"></a>                                 <span class="n">errFlag</span><span class="o">=</span><span class="n">errFlag</span><span class="p">)</span>
<a name="ln-1472"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">errFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1473"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;InitSimpleIceStorage: Program terminated due to previous condition(s).&#39;</span><span class="p">)</span>
<a name="ln-1474"></a>    <span class="n">ENDIF</span>
<a name="ln-1475"></a>    <span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1476"></a>  <span class="n">ENDIF</span>
<a name="ln-1477"></a>
<a name="ln-1478"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">BeginEnvrnFlag</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">IceNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1479"></a><span class="k">    </span><span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">DesignMassFlowRate</span> <span class="o">=</span> <span class="n">PlantLoop</span><span class="p">(</span><span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">MaxMassFlowRate</span>
<a name="ln-1480"></a>    <span class="c">!no design flow rates for model, assume min is zero and max is plant loop&#39;s max</span>
<a name="ln-1481"></a>    <span class="k">CALL </span><span class="n">InitComponentNodes</span><span class="p">(</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">DesignMassFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1482"></a>                                 <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PltInletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1483"></a>                                 <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PltOutletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1484"></a>                                 <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1485"></a>                                 <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">LoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1486"></a>                                 <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">BranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1487"></a>                                 <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">CompNum</span><span class="p">)</span>
<a name="ln-1488"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">CommonPipeType</span> <span class="o">==</span> <span class="n">CommonPipe_TwoWay</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1489"></a>        <span class="p">(</span><span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">LoopSideNum</span> <span class="o">==</span> <span class="n">SupplySide</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1490"></a>      <span class="c">! up flow priority of other components on the same branch as the Ice tank</span>
<a name="ln-1491"></a>      <span class="k">DO </span><span class="n">CompNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">PlantLoop</span><span class="p">(</span><span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">(</span><span class="n">SupplySide</span><span class="p">)%</span> <span class="p">&amp;</span>
<a name="ln-1492"></a>                           <span class="n">Branch</span><span class="p">(</span><span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">BranchNum</span><span class="p">)%</span><span class="n">TotalComponents</span>
<a name="ln-1493"></a>        <span class="n">PlantLoop</span><span class="p">(</span><span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">(</span><span class="n">SupplySide</span><span class="p">)%</span> <span class="p">&amp;</span>
<a name="ln-1494"></a>           <span class="n">Branch</span><span class="p">(</span><span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">BranchNum</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">FlowPriority</span> <span class="o">=</span> <span class="n">LoopFlowStatus_NeedyAndTurnsLoopOn</span>
<a name="ln-1495"></a>      <span class="n">ENDDO</span>
<a name="ln-1496"></a>
<a name="ln-1497"></a>    <span class="n">ENDIF</span>
<a name="ln-1498"></a>    <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">MyLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1499"></a>    <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">U</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1500"></a>    <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">Urate</span>            <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1501"></a>    <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">IceFracRemain</span>    <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-1502"></a>    <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSCoolingRate</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1503"></a>    <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSCoolingEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1504"></a>    <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSChargingRate</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1505"></a>    <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSChargingEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1506"></a>    <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSmdot</span>          <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1507"></a>    <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSInletTemp</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1508"></a>    <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSOutletTemp</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1509"></a>
<a name="ln-1510"></a>    <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1511"></a>  <span class="n">ENDIF</span>
<a name="ln-1512"></a>
<a name="ln-1513"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">BeginEnvrnFlag</span><span class="p">)</span> <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1514"></a>
<a name="ln-1515"></a>  <span class="n">ITSNomCap</span>            <span class="o">=</span> <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSNomCap</span>
<a name="ln-1516"></a>  <span class="n">InletNodeNum</span>         <span class="o">=</span> <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PltInletNodeNum</span>
<a name="ln-1517"></a>  <span class="n">OutletNodeNum</span>        <span class="o">=</span> <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PltOutletNodeNum</span>
<a name="ln-1518"></a>
<a name="ln-1519"></a>  <span class="k">RETURN</span>
<a name="ln-1520"></a>
<a name="ln-1521"></a><span class="k">END SUBROUTINE </span><span class="n">InitSimpleIceStorage</span>
<a name="ln-1522"></a>
<a name="ln-1523"></a>
<a name="ln-1524"></a><span class="c">!******************************************************************************</span>
<a name="ln-1525"></a><span class="k">SUBROUTINE </span><span class="n">CalcIceStorageCapacity</span><span class="p">(</span><span class="n">IceStorageType</span><span class="p">,</span><span class="n">MaxCap</span><span class="p">,</span><span class="n">MinCap</span><span class="p">,</span><span class="n">OptCap</span><span class="p">)</span>
<a name="ln-1526"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1527"></a>
<a name="ln-1528"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1529"></a>
<a name="ln-1530"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1531"></a>
<a name="ln-1532"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1533"></a>
<a name="ln-1534"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1535"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">WarmupFlag</span><span class="p">,</span> <span class="n">NumOfTimeStepInHour</span><span class="p">,</span> <span class="n">HourOfDay</span><span class="p">,</span> <span class="n">TimeStep</span>
<a name="ln-1536"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCurrentScheduleValue</span>
<a name="ln-1537"></a>
<a name="ln-1538"></a>  <span class="k">IMPLICIT NONE</span>
<a name="ln-1539"></a>
<a name="ln-1540"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1541"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span><span class="n">IceStorageType</span>
<a name="ln-1542"></a>
<a name="ln-1543"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">MaxCap</span>
<a name="ln-1544"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">MinCap</span>
<a name="ln-1545"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">OptCap</span>
<a name="ln-1546"></a>
<a name="ln-1547"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1548"></a>          <span class="c">! na</span>
<a name="ln-1549"></a>
<a name="ln-1550"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-1551"></a>          <span class="c">! na</span>
<a name="ln-1552"></a>
<a name="ln-1553"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1554"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Umax</span>               <span class="c">! Max Urate  [fraction]</span>
<a name="ln-1555"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Umin</span>               <span class="c">! Min Urate  [fraction]</span>
<a name="ln-1556"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Uact</span>               <span class="c">! Acting between Umax and Umin [fraction]</span>
<a name="ln-1557"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ITSCoolingRateMax</span>
<a name="ln-1558"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ITSCoolingRateOpt</span>
<a name="ln-1559"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ITSCoolingRateMin</span>
<a name="ln-1560"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QiceMin</span>
<a name="ln-1561"></a><span class="c">! unused  REAL(r64)    :: Tdb</span>
<a name="ln-1562"></a>
<a name="ln-1563"></a>
<a name="ln-1564"></a>          <span class="c">! FLOW</span>
<a name="ln-1565"></a><span class="k">SELECT CASE</span><span class="p">(</span><span class="n">IceStorageType</span><span class="p">)</span>
<a name="ln-1566"></a><span class="k">CASE</span><span class="p">(</span><span class="n">IceStorageType_Simple</span><span class="p">)</span>
<a name="ln-1567"></a>
<a name="ln-1568"></a>  <span class="c">!------------------------------------------------------------------------</span>
<a name="ln-1569"></a>  <span class="c">! FIRST PROCESS (MyLoad = 0.0 as IN)</span>
<a name="ln-1570"></a>  <span class="c">! At this moment as first calling of ITS, ITS provide ONLY MaxCap/OptCap/MinCap.</span>
<a name="ln-1571"></a>  <span class="c">!------------------------------------------------------------------------</span>
<a name="ln-1572"></a>
<a name="ln-1573"></a>       <span class="c">! Initialize Capacity</span>
<a name="ln-1574"></a>  <span class="n">MaxCap</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1575"></a>  <span class="n">MinCap</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1576"></a>  <span class="n">OptCap</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1577"></a>
<a name="ln-1578"></a>       <span class="c">! Initialize processed Usys values</span>
<a name="ln-1579"></a>  <span class="n">Umax</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1580"></a>  <span class="n">Umin</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1581"></a>  <span class="n">Uact</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1582"></a>
<a name="ln-1583"></a>       <span class="c">! XCurIceFrac is reset to 1.0 when first hour of day.</span>
<a name="ln-1584"></a>       <span class="c">! Starting full is assumed, because most ice systems are fully charged overnight</span>
<a name="ln-1585"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">ResetXForITSFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1586"></a><span class="k">    </span><span class="n">XCurIceFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-1587"></a>    <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">IceFracRemain</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-1588"></a>    <span class="n">Urate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1589"></a>    <span class="n">ResetXForITSFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1590"></a>  <span class="k">END IF</span>
<a name="ln-1591"></a>
<a name="ln-1592"></a>       <span class="c">! Calculate UAIceDisch[W/C] and UAIceCh[W/F] based on ONLY XCurIceFrac</span>
<a name="ln-1593"></a>  <span class="k">CALL </span><span class="n">CalcUAIce</span><span class="p">(</span><span class="n">IceNum</span><span class="p">,</span><span class="n">XCurIceFrac</span><span class="p">,</span>  <span class="n">UAIceCh</span><span class="p">,</span><span class="n">UAIceDisCh</span><span class="p">,</span><span class="n">HLoss</span><span class="p">)</span>
<a name="ln-1594"></a>
<a name="ln-1595"></a>         <span class="c">! Calculate QiceMin by UAiceDisCh*deltaTlm</span>
<a name="ln-1596"></a>         <span class="c">!   with UAiceDisCh(function of XCurIceFrac), ITSInletTemp and ITSOutletTemp(=Node(OutletNodeNum)%TempSetPoint by E+[C])</span>
<a name="ln-1597"></a>         <span class="c">! QiceMin is REAL(r64) ITS capacity.</span>
<a name="ln-1598"></a>  <span class="k">CALL </span><span class="n">CalcQiceDischageMax</span><span class="p">(</span><span class="n">QiceMin</span><span class="p">)</span>
<a name="ln-1599"></a>
<a name="ln-1600"></a>         <span class="c">! Check Umax and Umin to verify the input U value.</span>
<a name="ln-1601"></a>  <span class="n">Umax</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1602"></a>         <span class="c">! At the first call of ITS model, MyLoad is 0. After that proper MyLoad will be provided by E+.</span>
<a name="ln-1603"></a>         <span class="c">! Therefore, Umin is decided between input U and ITS REAL(r64) capacity.</span>
<a name="ln-1604"></a>  <span class="n">Umin</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span> <span class="nb">MAX</span><span class="p">(</span> <span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">EpsLimitForDisCharge</span><span class="p">)</span><span class="o">*</span><span class="n">QiceMin</span><span class="o">*</span><span class="n">TimeInterval</span><span class="o">/</span><span class="n">ITSNomCap</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="n">XCurIceFrac</span><span class="o">+</span><span class="n">EpsLimitForX</span><span class="p">)</span> <span class="p">),</span> <span class="mf">0.0d0</span> <span class="p">)</span>
<a name="ln-1605"></a>
<a name="ln-1606"></a>        <span class="c">! Calculate CoolingRate with Uact to provide E+.</span>
<a name="ln-1607"></a>  <span class="n">Uact</span> <span class="o">=</span> <span class="n">Umin</span>
<a name="ln-1608"></a>  <span class="n">ITSCoolingRateMax</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">Uact</span><span class="o">*</span><span class="n">ITSNomCap</span><span class="o">/</span><span class="n">TimeInterval</span><span class="p">)</span>
<a name="ln-1609"></a>  <span class="n">ITSCoolingRateOpt</span> <span class="o">=</span> <span class="n">ITSCoolingRateMax</span>
<a name="ln-1610"></a>  <span class="n">ITSCoolingRateMin</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1611"></a>
<a name="ln-1612"></a>       <span class="c">! Define MaxCap, OptCap, and MinCap</span>
<a name="ln-1613"></a>  <span class="n">MaxCap</span> <span class="o">=</span> <span class="n">ITSCoolingRateMax</span>
<a name="ln-1614"></a>  <span class="n">OptCap</span> <span class="o">=</span> <span class="n">ITSCoolingRateOpt</span>
<a name="ln-1615"></a>  <span class="n">MinCap</span> <span class="o">=</span> <span class="n">ITSCoolingRateMin</span>
<a name="ln-1616"></a>
<a name="ln-1617"></a><span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1618"></a>
<a name="ln-1619"></a><span class="k">END SELECT</span>
<a name="ln-1620"></a>
<a name="ln-1621"></a>
<a name="ln-1622"></a><span class="k">RETURN</span>
<a name="ln-1623"></a><span class="k">END SUBROUTINE </span><span class="n">CalcIceStorageCapacity</span>
<a name="ln-1624"></a>
<a name="ln-1625"></a>
<a name="ln-1626"></a><span class="c">!******************************************************************************</span>
<a name="ln-1627"></a><span class="k">SUBROUTINE </span><span class="n">CalcIceStorageDormant</span><span class="p">(</span><span class="n">IceStorageType</span><span class="p">,</span><span class="n">IceNum</span><span class="p">)</span>
<a name="ln-1628"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1629"></a>
<a name="ln-1630"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1631"></a>
<a name="ln-1632"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1633"></a>
<a name="ln-1634"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1635"></a>
<a name="ln-1636"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1637"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCurrentScheduleValue</span>
<a name="ln-1638"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SetComponentFlowRate</span>
<a name="ln-1639"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>      <span class="n">ONLY</span> <span class="p">:</span> <span class="n">PlantLoop</span><span class="p">,</span> <span class="n">SingleSetpoint</span><span class="p">,</span> <span class="n">DualSetpointDeadband</span>
<a name="ln-1640"></a>
<a name="ln-1641"></a>  <span class="k">IMPLICIT NONE</span>
<a name="ln-1642"></a>
<a name="ln-1643"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1644"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IceStorageType</span>  <span class="c">!BY ZG</span>
<a name="ln-1645"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IceNum</span>
<a name="ln-1646"></a>
<a name="ln-1647"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1648"></a>          <span class="c">! na</span>
<a name="ln-1649"></a>
<a name="ln-1650"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-1651"></a>          <span class="c">! na</span>
<a name="ln-1652"></a>
<a name="ln-1653"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1654"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Umax</span>   <span class="c">! Max Urate  [fraction]</span>
<a name="ln-1655"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Umin</span>   <span class="c">! Min Urate  [fraction]</span>
<a name="ln-1656"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Uact</span>   <span class="c">! Acting between Umax and Umin [fraction]</span>
<a name="ln-1657"></a>
<a name="ln-1658"></a>          <span class="c">! FLOW</span>
<a name="ln-1659"></a><span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">IceStorageType</span><span class="p">)</span>   <span class="c">!by ZG</span>
<a name="ln-1660"></a>
<a name="ln-1661"></a><span class="k">CASE</span><span class="p">(</span><span class="n">IceStorageType_Simple</span><span class="p">)</span>   <span class="c">!by ZG</span>
<a name="ln-1662"></a>
<a name="ln-1663"></a>       <span class="c">! Initialize processed Usys values</span>
<a name="ln-1664"></a>  <span class="n">Umax</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1665"></a>  <span class="n">Umin</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1666"></a>  <span class="n">Uact</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1667"></a>
<a name="ln-1668"></a>       <span class="c">! Provide output results for ITS.</span>
<a name="ln-1669"></a>  <span class="n">ITSMassFlowRate</span>  <span class="o">=</span> <span class="mf">0.d0</span>                        <span class="c">![kg/s]</span>
<a name="ln-1670"></a>
<a name="ln-1671"></a>  <span class="k">CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">ITSMassFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1672"></a>                            <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PltInletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1673"></a>                            <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PltOutletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1674"></a>                            <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1675"></a>                            <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">LoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1676"></a>                            <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">BranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1677"></a>                            <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">CompNum</span> <span class="p">)</span>
<a name="ln-1678"></a>
<a name="ln-1679"></a>  <span class="n">ITSInletTemp</span>     <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">InletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>  <span class="c">![C]</span>
<a name="ln-1680"></a>  <span class="n">ITSOutletTemp</span>    <span class="o">=</span> <span class="n">ITSInletTemp</span>             <span class="c">![C]</span>
<a name="ln-1681"></a>  <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">LoopDemandCalcScheme</span><span class="p">)</span>
<a name="ln-1682"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">SingleSetPoint</span><span class="p">)</span>
<a name="ln-1683"></a>    <span class="n">ITSOutletSetPointTemp</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">OutletNodeNum</span><span class="p">)%</span><span class="n">TempSetPoint</span>
<a name="ln-1684"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">DualSetPointDeadBand</span><span class="p">)</span>
<a name="ln-1685"></a>    <span class="n">ITSOutletSetPointTemp</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">OutletNodeNum</span><span class="p">)%</span><span class="n">TempSetPointHi</span>
<a name="ln-1686"></a>  <span class="k">END SELECT</span>
<a name="ln-1687"></a><span class="k">  </span><span class="n">ITSCoolingRate</span>   <span class="o">=</span> <span class="mf">0.0d0</span>                      <span class="c">![W]</span>
<a name="ln-1688"></a>  <span class="n">ITSCoolingEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>                      <span class="c">![J]</span>
<a name="ln-1689"></a>
<a name="ln-1690"></a>  <span class="n">Urate</span> <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">![n/a]</span>
<a name="ln-1691"></a>
<a name="ln-1692"></a><span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1693"></a>
<a name="ln-1694"></a><span class="k">END SELECT</span>
<a name="ln-1695"></a>
<a name="ln-1696"></a>
<a name="ln-1697"></a><span class="k">RETURN</span>
<a name="ln-1698"></a><span class="k">END SUBROUTINE </span><span class="n">CalcIceStorageDormant</span>
<a name="ln-1699"></a>
<a name="ln-1700"></a>
<a name="ln-1701"></a><span class="c">!******************************************************************************</span>
<a name="ln-1702"></a><span class="k">SUBROUTINE </span><span class="n">CalcIceStorageCharge</span><span class="p">(</span><span class="n">IceStorageType</span><span class="p">,</span><span class="n">IceNum</span><span class="p">)</span>
<a name="ln-1703"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1704"></a>
<a name="ln-1705"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1706"></a>
<a name="ln-1707"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1708"></a>
<a name="ln-1709"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1710"></a>
<a name="ln-1711"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1712"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">TimeStepSys</span>
<a name="ln-1713"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCurrentScheduleValue</span>
<a name="ln-1714"></a>  <span class="k">USE </span><span class="n">Psychrometrics</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span><span class="n">CPCW</span>
<a name="ln-1715"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SetComponentFlowRate</span>
<a name="ln-1716"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">PlantLoop</span><span class="p">,</span> <span class="n">SingleSetpoint</span><span class="p">,</span> <span class="n">DualSetpointDeadband</span>
<a name="ln-1717"></a>
<a name="ln-1718"></a>  <span class="k">IMPLICIT NONE</span>
<a name="ln-1719"></a>
<a name="ln-1720"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1721"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IceStorageType</span>  <span class="c">!BY ZG</span>
<a name="ln-1722"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IceNum</span>
<a name="ln-1723"></a>
<a name="ln-1724"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1725"></a>          <span class="c">! na</span>
<a name="ln-1726"></a>
<a name="ln-1727"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-1728"></a>          <span class="c">! na</span>
<a name="ln-1729"></a>
<a name="ln-1730"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1731"></a>
<a name="ln-1732"></a>          <span class="c">! FLOW</span>
<a name="ln-1733"></a>
<a name="ln-1734"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1735"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Umax</span>               <span class="c">! Max Urate adjusted Urate based on Error protection (I) [fraction]</span>
<a name="ln-1736"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Umin</span>               <span class="c">! Min Urate adjusted Urate based on Error protection (I) [fraction]</span>
<a name="ln-1737"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Uact</span>               <span class="c">! Acting between Usys and UsysLow Urate adjusted Urate based on Error protection (I) [fraction]</span>
<a name="ln-1738"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QiceMax</span>            <span class="c">![W]</span>
<a name="ln-1739"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QiceMaxByChiller</span>   <span class="c">![W]</span>
<a name="ln-1740"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QiceMaxByITS</span>       <span class="c">![W]</span>
<a name="ln-1741"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Qice</span>               <span class="c">![W]</span>
<a name="ln-1742"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DeltaTemp</span>          <span class="c">![C]</span>
<a name="ln-1743"></a>
<a name="ln-1744"></a>          <span class="c">! FLOW</span>
<a name="ln-1745"></a><span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">IceStorageType</span><span class="p">)</span>
<a name="ln-1746"></a><span class="k">CASE</span><span class="p">(</span><span class="n">IceStorageType_Simple</span><span class="p">)</span>
<a name="ln-1747"></a>
<a name="ln-1748"></a>  <span class="c">!--------------------------------------------------------</span>
<a name="ln-1749"></a>  <span class="c">! Initialize</span>
<a name="ln-1750"></a>  <span class="c">!--------------------------------------------------------</span>
<a name="ln-1751"></a>       <span class="c">! Below values for ITS are reported forCharging process.</span>
<a name="ln-1752"></a>  <span class="n">ITSMassFlowRate</span>  <span class="o">=</span> <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">DesignMassFlowRate</span> <span class="c">![kg/s]</span>
<a name="ln-1753"></a>
<a name="ln-1754"></a>  <span class="k">CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">ITSMassFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1755"></a>                            <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PltInletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1756"></a>                            <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PltOutletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1757"></a>                            <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1758"></a>                            <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">LoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1759"></a>                            <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">BranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1760"></a>                            <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">CompNum</span> <span class="p">)</span>
<a name="ln-1761"></a>
<a name="ln-1762"></a>  <span class="n">ITSInletTemp</span>     <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">InletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>  <span class="c">![C]</span>
<a name="ln-1763"></a>  <span class="n">ITSOutletTemp</span>    <span class="o">=</span> <span class="n">ITSInletTemp</span>             <span class="c">![C]</span>
<a name="ln-1764"></a>  <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">LoopDemandCalcScheme</span><span class="p">)</span>
<a name="ln-1765"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">SingleSetPoint</span><span class="p">)</span>
<a name="ln-1766"></a>    <span class="n">ITSOutletSetPointTemp</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">OutletNodeNum</span><span class="p">)%</span><span class="n">TempSetPoint</span>
<a name="ln-1767"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">DualSetPointDeadBand</span><span class="p">)</span>
<a name="ln-1768"></a>    <span class="n">ITSOutletSetPointTemp</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">OutletNodeNum</span><span class="p">)%</span><span class="n">TempSetPointHi</span>
<a name="ln-1769"></a>  <span class="k">END SELECT</span>
<a name="ln-1770"></a><span class="k">  </span><span class="n">ITSCoolingRate</span>   <span class="o">=</span> <span class="mf">0.0d0</span>                      <span class="c">![W]</span>
<a name="ln-1771"></a>  <span class="n">ITSCoolingEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>                      <span class="c">![J]</span>
<a name="ln-1772"></a>
<a name="ln-1773"></a>       <span class="c">! Initialize processed U values</span>
<a name="ln-1774"></a>  <span class="n">Umax</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1775"></a>  <span class="n">Umin</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1776"></a>  <span class="n">Uact</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1777"></a>  <span class="n">Urate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1778"></a>
<a name="ln-1779"></a>       <span class="c">! Calculate QiceMax which is REAL(r64) ITS capacity.</span>
<a name="ln-1780"></a>       <span class="c">! There are three possible to calculate QiceMax</span>
<a name="ln-1781"></a>       <span class="c">!   with ChillerCapacity(Chiller+ITS), ITS capacity(ITS), and QchillerMax(Chiller).</span>
<a name="ln-1782"></a>  <span class="c">!--------------------------------------------------------</span>
<a name="ln-1783"></a>  <span class="c">! Calcualte QiceMax with QiceMaxByChiller, QiceMaxByITS, QchillerMax</span>
<a name="ln-1784"></a>  <span class="c">!--------------------------------------------------------</span>
<a name="ln-1785"></a>       <span class="c">! Calculate Qice charge max by Chiller with Twb and UAiceCh</span>
<a name="ln-1786"></a>  <span class="k">CALL </span><span class="n">CalcQiceChargeMaxByChiller</span><span class="p">(</span><span class="n">IceNum</span><span class="p">,</span><span class="n">QiceMaxByChiller</span><span class="p">)</span>  <span class="c">![W]</span>
<a name="ln-1787"></a>
<a name="ln-1788"></a>         <span class="c">! Chiller is remote now, so chiller out is inlet node temp</span>
<a name="ln-1789"></a>  <span class="n">ChillerOutletTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PltInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-1790"></a>       <span class="c">! Calculate Qice charge max by ITS with ChillerOutletTemp</span>
<a name="ln-1791"></a>  <span class="k">CALL </span><span class="n">CalcQiceChargeMaxByITS</span><span class="p">(</span><span class="n">IceNum</span><span class="p">,</span><span class="n">ChillerOutletTemp</span><span class="p">,</span><span class="n">QiceMaxByITS</span><span class="p">)</span>  <span class="c">![W]</span>
<a name="ln-1792"></a>
<a name="ln-1793"></a>       <span class="c">! Select minimum as QiceMax</span>
<a name="ln-1794"></a>       <span class="c">! Because It is uncertain that QiceMax by chiller is same as QiceMax by ITS.</span>
<a name="ln-1795"></a>  <span class="n">QiceMax</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">QiceMaxByChiller</span><span class="p">,</span><span class="n">QiceMaxByITS</span><span class="p">)</span>
<a name="ln-1796"></a>
<a name="ln-1797"></a>  <span class="c">!--------------------------------------------------------</span>
<a name="ln-1798"></a>  <span class="c">! Calculate Umin,Umax,Uact</span>
<a name="ln-1799"></a>  <span class="c">!--------------------------------------------------------</span>
<a name="ln-1800"></a>       <span class="c">! Set Umin</span>
<a name="ln-1801"></a>  <span class="n">Umin</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1802"></a>       <span class="c">! Calculate Umax based on real ITS Max Capacity and remained XCurIceFrac.</span>
<a name="ln-1803"></a>       <span class="c">! Umax should be equal or larger than 0.02 for realistic purpose by Dion.</span>
<a name="ln-1804"></a>  <span class="n">Umax</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span> <span class="nb">MIN</span><span class="p">(</span> <span class="p">((</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">EpsLimitForCharge</span><span class="p">)</span><span class="o">*</span><span class="n">QiceMax</span><span class="o">*</span><span class="n">TimeInterval</span><span class="o">/</span><span class="n">ITSNomCap</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">XCurIceFrac</span><span class="o">-</span><span class="n">EpsLimitForX</span><span class="p">)</span> <span class="p">),</span> <span class="mf">0.0d0</span> <span class="p">)</span>
<a name="ln-1805"></a>
<a name="ln-1806"></a>         <span class="c">! Cannot charge more than the fraction that is left uncharged</span>
<a name="ln-1807"></a>  <span class="n">Umax</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">Umax</span><span class="p">,(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">IceFracRemain</span><span class="p">)</span><span class="o">/</span><span class="n">TimeStepSys</span><span class="p">)</span>
<a name="ln-1808"></a>       <span class="c">! First, check input U value.</span>
<a name="ln-1809"></a>       <span class="c">! Based on Umax and Umin, if necessary to run E+, calculate proper Uact.</span>
<a name="ln-1810"></a>  <span class="k">IF</span><span class="p">(</span> <span class="n">Umax</span> <span class="o">==</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="k">THEN</span>  <span class="c">!(No Capacity of ITS), ITS is OFF.</span>
<a name="ln-1811"></a>    <span class="n">Uact</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1812"></a>
<a name="ln-1813"></a>  <span class="k">ELSE</span>  <span class="c">! Umax non-zero</span>
<a name="ln-1814"></a>    <span class="n">Uact</span> <span class="o">=</span> <span class="n">Umax</span>
<a name="ln-1815"></a>  <span class="k">END IF</span>  <span class="c">! Check Uact for Discharging Process</span>
<a name="ln-1816"></a>
<a name="ln-1817"></a>  <span class="c">!--------------------------------------------------------</span>
<a name="ln-1818"></a>  <span class="c">! Calcualte possible ITSChargingRate with Uact, Then error check</span>
<a name="ln-1819"></a>  <span class="c">!--------------------------------------------------------</span>
<a name="ln-1820"></a>       <span class="c">! Calculate possible ITSChargingRate with Uact</span>
<a name="ln-1821"></a>  <span class="n">Qice</span> <span class="o">=</span> <span class="n">Uact</span><span class="o">*</span><span class="n">ITSNomCap</span><span class="o">/</span><span class="n">TimeInterval</span>  <span class="c">![W]</span>
<a name="ln-1822"></a>       <span class="c">! If Qice is equal or less than 0.0, no need to calculate anymore.</span>
<a name="ln-1823"></a>  <span class="k">IF</span><span class="p">(</span> <span class="n">Qice</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1824"></a><span class="k">    </span><span class="n">Urate</span>               <span class="o">=</span> <span class="mf">0.0d0</span>                <span class="c">![ratio]</span>
<a name="ln-1825"></a>  <span class="k">END IF</span>
<a name="ln-1826"></a>
<a name="ln-1827"></a>  <span class="c">!--------------------------------------------------------</span>
<a name="ln-1828"></a>  <span class="c">! Find ChillerOutlet Temperature</span>
<a name="ln-1829"></a>  <span class="c">!--------------------------------------------------------</span>
<a name="ln-1830"></a>         <span class="c">! Chiller is remote now, so chiller out is inlet node temp</span>
<a name="ln-1831"></a>  <span class="n">ChillerOutletTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PltInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-1832"></a>
<a name="ln-1833"></a>        <span class="c">! Calculate leaving water temperature</span>
<a name="ln-1834"></a>  <span class="k">IF</span><span class="p">((</span><span class="n">Qice</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">XCurIceFrac</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1835"></a><span class="k">    </span><span class="n">ITSOutletTemp</span> <span class="o">=</span> <span class="n">ITSInletTemp</span>
<a name="ln-1836"></a>    <span class="n">DeltaTemp</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1837"></a>    <span class="n">Qice</span>          <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1838"></a>    <span class="n">Uact</span>          <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1839"></a>  <span class="k">ELSE</span>
<a name="ln-1840"></a><span class="k">    </span><span class="n">DeltaTemp</span> <span class="o">=</span> <span class="n">Qice</span><span class="o">/</span><span class="n">CPCW</span><span class="p">(</span><span class="n">ITSInletTemp</span><span class="p">)</span><span class="o">/</span><span class="n">ITSMassFlowRate</span>
<a name="ln-1841"></a>    <span class="n">ITSOutletTemp</span> <span class="o">=</span> <span class="n">ITSInletTemp</span> <span class="o">+</span> <span class="n">DeltaTemp</span>
<a name="ln-1842"></a>     <span class="c">! Limit leaving temp to be no greater than setpoint or freezing temp minus 1C</span>
<a name="ln-1843"></a>    <span class="n">ITSOutletTemp</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">ITSOutletTemp</span><span class="p">,</span> <span class="n">ITSOutletSetPointTemp</span><span class="p">,</span> <span class="p">(</span><span class="n">FreezTemp</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-1844"></a>     <span class="c">! Limit leaving temp to be no less than inlet temp</span>
<a name="ln-1845"></a>    <span class="n">ITSOutletTemp</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">ITSOutletTemp</span><span class="p">,</span> <span class="n">ITSInletTemp</span><span class="p">)</span>
<a name="ln-1846"></a>    <span class="n">DeltaTemp</span>     <span class="o">=</span> <span class="n">ITSOutletTemp</span> <span class="o">-</span> <span class="n">ITSInletTemp</span>
<a name="ln-1847"></a>    <span class="n">Qice</span>          <span class="o">=</span> <span class="n">DeltaTemp</span><span class="o">*</span><span class="n">CPCW</span><span class="p">(</span><span class="n">ITSInletTemp</span><span class="p">)</span><span class="o">*</span><span class="n">ITSMassFlowRate</span>
<a name="ln-1848"></a>    <span class="n">Uact</span>          <span class="o">=</span> <span class="n">Qice</span><span class="o">/</span><span class="p">(</span><span class="n">ITSNomCap</span><span class="o">/</span><span class="n">TimeInterval</span><span class="p">)</span>
<a name="ln-1849"></a>  <span class="k">END IF</span>  <span class="c">! End of leaving temp checks</span>
<a name="ln-1850"></a>
<a name="ln-1851"></a>  <span class="n">Urate</span> <span class="o">=</span> <span class="n">Uact</span>
<a name="ln-1852"></a>  <span class="n">ITSCoolingRate</span>   <span class="o">=</span> <span class="o">-</span><span class="n">Qice</span>
<a name="ln-1853"></a>  <span class="n">ITSCoolingEnergy</span> <span class="o">=</span> <span class="n">ITSCoolingRate</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-1854"></a>
<a name="ln-1855"></a><span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1856"></a>
<a name="ln-1857"></a><span class="k">END SELECT</span>
<a name="ln-1858"></a>
<a name="ln-1859"></a>
<a name="ln-1860"></a><span class="k">RETURN</span>
<a name="ln-1861"></a><span class="k">END SUBROUTINE </span><span class="n">CalcIceStorageCharge</span>
<a name="ln-1862"></a>
<a name="ln-1863"></a>
<a name="ln-1864"></a><span class="c">!******************************************************************************</span>
<a name="ln-1865"></a><span class="k">SUBROUTINE </span><span class="n">CalcQiceChargeMaxByChiller</span><span class="p">(</span><span class="n">IceNum</span><span class="p">,</span><span class="n">QiceMaxByChiller</span><span class="p">)</span>
<a name="ln-1866"></a>
<a name="ln-1867"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1868"></a>
<a name="ln-1869"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1870"></a>
<a name="ln-1871"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1872"></a>          <span class="c">! Calculation inside is IP unit, then return QiceMaxByChiller as SI [W] unit.</span>
<a name="ln-1873"></a>
<a name="ln-1874"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1875"></a>
<a name="ln-1876"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1877"></a>
<a name="ln-1878"></a>  <span class="k">IMPLICIT NONE</span>
<a name="ln-1879"></a>
<a name="ln-1880"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1881"></a>  <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">IceNum</span>
<a name="ln-1882"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">QiceMaxByChiller</span>
<a name="ln-1883"></a>
<a name="ln-1884"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1885"></a>          <span class="c">! na</span>
<a name="ln-1886"></a>
<a name="ln-1887"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-1888"></a>          <span class="c">! na</span>
<a name="ln-1889"></a>
<a name="ln-1890"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1891"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TchillerOut</span>
<a name="ln-1892"></a>
<a name="ln-1893"></a>          <span class="c">! FLOW</span>
<a name="ln-1894"></a>
<a name="ln-1895"></a>         <span class="c">! Chiller is remote now, so chiller out is inlet node temp</span>
<a name="ln-1896"></a>  <span class="n">TchillerOut</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PltInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-1897"></a>  <span class="n">QiceMaxByChiller</span> <span class="o">=</span> <span class="n">UAiceCh</span><span class="o">*</span><span class="p">(</span> <span class="n">FreezTemp</span><span class="o">-</span><span class="n">TchillerOut</span> <span class="p">)</span>  <span class="c">![W] = [W/degC]*[degC]</span>
<a name="ln-1898"></a>
<a name="ln-1899"></a>       <span class="c">! If it happened, it is occurred at the Discharing or Dormant process.</span>
<a name="ln-1900"></a>  <span class="k">IF</span><span class="p">(</span> <span class="n">QiceMaxByChiller</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1901"></a><span class="k">    </span><span class="n">QiceMaxByChiller</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1902"></a>  <span class="k">END IF</span>
<a name="ln-1903"></a>
<a name="ln-1904"></a><span class="k">RETURN</span>
<a name="ln-1905"></a><span class="k">END SUBROUTINE </span><span class="n">CalcQiceChargeMaxByChiller</span>
<a name="ln-1906"></a>
<a name="ln-1907"></a>
<a name="ln-1908"></a><span class="c">!******************************************************************************</span>
<a name="ln-1909"></a><span class="k">SUBROUTINE </span><span class="n">CalcQiceChargeMaxByITS</span><span class="p">(</span><span class="n">IceNum</span><span class="p">,</span><span class="n">ChillerOutletTemp</span><span class="p">,</span><span class="n">QiceMaxByITS</span><span class="p">)</span>
<a name="ln-1910"></a>
<a name="ln-1911"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1912"></a>
<a name="ln-1913"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1914"></a>
<a name="ln-1915"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1916"></a>
<a name="ln-1917"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1918"></a>
<a name="ln-1919"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1920"></a>
<a name="ln-1921"></a>  <span class="k">IMPLICIT NONE</span>
<a name="ln-1922"></a>
<a name="ln-1923"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1924"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">IceNum</span>
<a name="ln-1925"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ChillerOutletTemp</span>  <span class="c">![degC]</span>
<a name="ln-1926"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QiceMaxByITS</span>       <span class="c">![W]</span>
<a name="ln-1927"></a>
<a name="ln-1928"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1929"></a>          <span class="c">! na</span>
<a name="ln-1930"></a>
<a name="ln-1931"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-1932"></a>          <span class="c">! na</span>
<a name="ln-1933"></a>
<a name="ln-1934"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1935"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Tfr</span>
<a name="ln-1936"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ChillerInletTemp</span>
<a name="ln-1937"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ChOutletTemp</span>
<a name="ln-1938"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LogTerm</span>
<a name="ln-1939"></a>
<a name="ln-1940"></a>          <span class="c">! FLOW</span>
<a name="ln-1941"></a>  <span class="c">! Qice is maximized when ChillerInletTemp and ChillerOutletTemp(input data) is almost same due to LMTD method.</span>
<a name="ln-1942"></a>  <span class="c">! Qice is minimized(=0) when ChillerInletTemp is almost same as FreezTemp(=0).</span>
<a name="ln-1943"></a>
<a name="ln-1944"></a>       <span class="c">! Initilize</span>
<a name="ln-1945"></a>  <span class="n">Tfr</span> <span class="o">=</span> <span class="n">FreezTempIP</span>
<a name="ln-1946"></a>  <span class="n">ChOutletTemp</span> <span class="o">=</span> <span class="n">TempSItoIP</span><span class="p">(</span><span class="n">ChillerOutletTemp</span><span class="p">)</span>  <span class="c">![degF] = ConvertSItoIP[degC]</span>
<a name="ln-1947"></a>       <span class="c">! Chiller outlet temp must be below freeze temp, or else no charge</span>
<a name="ln-1948"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ChOutletTemp</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">Tfr</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1949"></a><span class="k">    </span><span class="n">ChillerInletTemp</span> <span class="o">=</span> <span class="n">ChOutletTemp</span>
<a name="ln-1950"></a>    <span class="n">QiceMaxByITS</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1951"></a>  <span class="k">ELSE</span>
<a name="ln-1952"></a>       <span class="c">! Make ChillerInletTemp as almost same as ChillerOutletTemp(input data)</span>
<a name="ln-1953"></a>    <span class="n">ChillerInletTemp</span> <span class="o">=</span> <span class="n">ChOutletTemp</span> <span class="o">+</span> <span class="mf">0.01</span>
<a name="ln-1954"></a>       <span class="c">! ChillerInletTemp cannot be greater than or equal to freeze temp</span>
<a name="ln-1955"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ChillerInletTemp</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">Tfr</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1956"></a><span class="k">      </span><span class="n">ChillerInletTemp</span> <span class="o">=</span> <span class="n">ChOutletTemp</span> <span class="o">+</span> <span class="p">(</span><span class="n">Tfr</span> <span class="o">-</span> <span class="n">ChOutletTemp</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<a name="ln-1957"></a>    <span class="n">ENDIF</span>
<a name="ln-1958"></a>
<a name="ln-1959"></a>    <span class="n">LogTerm</span>      <span class="o">=</span> <span class="p">(</span><span class="n">Tfr</span> <span class="o">-</span> <span class="n">ChOutletTemp</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">Tfr</span> <span class="o">-</span> <span class="n">ChillerInletTemp</span><span class="p">)</span>
<a name="ln-1960"></a>       <span class="c">! Need to protect this from LogTerm &lt;= 0 - not sure what it should do then</span>
<a name="ln-1961"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">LogTerm</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1962"></a><span class="k">      </span><span class="n">ChillerInletTemp</span> <span class="o">=</span> <span class="n">ChOutletTemp</span>
<a name="ln-1963"></a>      <span class="n">QiceMaxByITS</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1964"></a>    <span class="n">ENDIF</span>
<a name="ln-1965"></a>    <span class="n">QiceMaxByITS</span> <span class="o">=</span> <span class="n">UAiceCh</span> <span class="o">*</span> <span class="p">(</span> <span class="n">TempIPtoSI</span><span class="p">(</span><span class="n">ChillerInletTemp</span><span class="p">)</span> <span class="o">-</span> <span class="n">TempIPtoSI</span><span class="p">(</span><span class="n">ChOutletTemp</span><span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="nb">LOG</span><span class="p">(</span><span class="n">LogTerm</span><span class="p">)</span>
<a name="ln-1966"></a>  <span class="n">ENDIF</span>
<a name="ln-1967"></a>
<a name="ln-1968"></a><span class="k">RETURN</span>
<a name="ln-1969"></a><span class="k">END SUBROUTINE </span><span class="n">CalcQiceChargeMaxByITS</span>
<a name="ln-1970"></a>
<a name="ln-1971"></a>
<a name="ln-1972"></a><span class="c">!******************************************************************************</span>
<a name="ln-1973"></a><span class="k">SUBROUTINE </span><span class="n">CalcIceStorageDischarge</span><span class="p">(</span><span class="n">IceStorageType</span><span class="p">,</span><span class="n">IceNum</span><span class="p">,</span><span class="n">MyLoad</span><span class="p">,</span><span class="n">Runflag</span><span class="p">,</span><span class="n">FirstIteration</span><span class="p">,</span><span class="n">MaxCap</span><span class="p">)</span>
<a name="ln-1974"></a>
<a name="ln-1975"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1976"></a>
<a name="ln-1977"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1978"></a>
<a name="ln-1979"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1980"></a>
<a name="ln-1981"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1982"></a>
<a name="ln-1983"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1984"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span>
<a name="ln-1985"></a>  <span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ShowFatalError</span>
<a name="ln-1986"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">TimeStepSys</span>
<a name="ln-1987"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span>  <span class="n">PlantLoop</span><span class="p">,</span> <span class="n">SingleSetpoint</span><span class="p">,</span> <span class="n">DualSetpointDeadband</span>
<a name="ln-1988"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetDensityGlycol</span>
<a name="ln-1989"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SetComponentFlowRate</span>
<a name="ln-1990"></a>
<a name="ln-1991"></a>  <span class="k">IMPLICIT NONE</span>
<a name="ln-1992"></a>
<a name="ln-1993"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1994"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">IceStorageType</span>  <span class="c">!by ZG</span>
<a name="ln-1995"></a>
<a name="ln-1996"></a>  <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">IceNum</span>          <span class="c">! ice storage number</span>
<a name="ln-1997"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">MyLoad</span>          <span class="c">! operating load</span>
<a name="ln-1998"></a>  <span class="kt">LOGICAL</span>                <span class="kd">::</span> <span class="n">FirstIteration</span>  <span class="c">! TRUE when first iteration of timestep</span>
<a name="ln-1999"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RunFlag</span>         <span class="c">! TRUE when ice storage operating</span>
<a name="ln-2000"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MaxCap</span>          <span class="c">! Max possible discharge rate (positive value)</span>
<a name="ln-2001"></a>
<a name="ln-2002"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2003"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">TempTol</span> <span class="o">=</span> <span class="mf">0.0001d0</span>          <span class="c">! C - minimum significant mass flow rate</span>
<a name="ln-2004"></a>
<a name="ln-2005"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2006"></a>          <span class="c">! na</span>
<a name="ln-2007"></a>
<a name="ln-2008"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2009"></a>
<a name="ln-2010"></a>          <span class="c">! FLOW</span>
<a name="ln-2011"></a>
<a name="ln-2012"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2013"></a>       <span class="c">! External function</span>
<a name="ln-2014"></a>       <span class="c">! Local</span>
<a name="ln-2015"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Umax</span>      <span class="o">=</span><span class="mf">0.0d0</span>     <span class="c">! Max Urate adjusted Urate based on Error protection (I) [fraction]</span>
<a name="ln-2016"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Umin</span>      <span class="o">=</span><span class="mf">0.0d0</span>     <span class="c">! Min Urate adjusted Urate based on Error protection (I) [fraction]</span>
<a name="ln-2017"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Uact</span>      <span class="o">=</span><span class="mf">0.0d0</span>     <span class="c">! Acting between Usys and UsysLow Urate adjusted Urate based on Error protection (I) [fraction]</span>
<a name="ln-2018"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Umyload</span>   <span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2019"></a><span class="c">! unused  REAL(r64)    :: QiceMin</span>
<a name="ln-2020"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Qice</span>      <span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2021"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DeltaTemp</span> <span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2022"></a>
<a name="ln-2023"></a>
<a name="ln-2024"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">LoopNum</span>
<a name="ln-2025"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">LoopSideNum</span>
<a name="ln-2026"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CpFluid</span> <span class="c">! local temporary for plant loop&#39;s fluid specific heat</span>
<a name="ln-2027"></a>
<a name="ln-2028"></a>
<a name="ln-2029"></a>
<a name="ln-2030"></a>          <span class="c">! FLOW</span>
<a name="ln-2031"></a><span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">IceStorageType</span><span class="p">)</span>
<a name="ln-2032"></a><span class="k">CASE</span><span class="p">(</span><span class="n">IceStorageType_Simple</span><span class="p">)</span>
<a name="ln-2033"></a>
<a name="ln-2034"></a>       <span class="c">! Initialize processed Rate and Energy</span>
<a name="ln-2035"></a>  <span class="n">ITSMassFlowRate</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2036"></a>  <span class="n">ITSCoolingRate</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2037"></a>  <span class="n">ITSCoolingEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2038"></a>
<a name="ln-2039"></a>  <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">LoopDemandCalcScheme</span><span class="p">)</span>
<a name="ln-2040"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">SingleSetPoint</span><span class="p">)</span>
<a name="ln-2041"></a>    <span class="n">ITSOutletSetPointTemp</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">OutletNodeNum</span><span class="p">)%</span><span class="n">TempSetPoint</span>
<a name="ln-2042"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">DualSetPointDeadBand</span><span class="p">)</span>
<a name="ln-2043"></a>    <span class="n">ITSOutletSetPointTemp</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">OutletNodeNum</span><span class="p">)%</span><span class="n">TempSetPointHi</span>
<a name="ln-2044"></a>  <span class="k">END SELECT</span>
<a name="ln-2045"></a>
<a name="ln-2046"></a>       <span class="c">! Initialize processed U values</span>
<a name="ln-2047"></a>  <span class="n">Umax</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2048"></a>  <span class="n">Umin</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2049"></a>  <span class="n">Uact</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2050"></a>  <span class="n">Umyload</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2051"></a>  <span class="n">Urate</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2052"></a>
<a name="ln-2053"></a>       <span class="c">! If no component demand or ITS OFF, then RETURN.</span>
<a name="ln-2054"></a>  <span class="k">IF</span><span class="p">(</span> <span class="n">MyLoad</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">RunFlag</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2055"></a><span class="k">    </span><span class="n">ITSMassFlowRate</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2056"></a>    <span class="n">ITSInletTemp</span>     <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">InletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-2057"></a>    <span class="n">ITSOutletTemp</span>    <span class="o">=</span> <span class="n">ITSInletTemp</span>
<a name="ln-2058"></a>    <span class="n">ITSCoolingRate</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2059"></a>    <span class="n">ITSCoolingEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2060"></a>    <span class="k">RETURN</span>
<a name="ln-2061"></a><span class="k">  END IF</span>
<a name="ln-2062"></a>
<a name="ln-2063"></a>       <span class="c">! If FlowLock(provided by PlantSupplyManager) is False(=0), that is, MyLoad is not changed.</span>
<a name="ln-2064"></a>       <span class="c">! then based on MyLoad, new ITSMassFlowRate will be calculated.</span>
<a name="ln-2065"></a>
<a name="ln-2066"></a>
<a name="ln-2067"></a>  <span class="c">!----------------------------</span>
<a name="ln-2068"></a>  <span class="n">LoopNum</span> <span class="o">=</span> <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">LoopNum</span>
<a name="ln-2069"></a>  <span class="n">LoopSideNum</span> <span class="o">=</span> <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">LoopSideNum</span>
<a name="ln-2070"></a>
<a name="ln-2071"></a>  <span class="n">CpFluid</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2072"></a>                             <span class="n">Node</span><span class="p">(</span><span class="n">InletNodeNum</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2073"></a>                             <span class="n">PlantLoop</span><span class="p">(</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2074"></a>                             <span class="s1">&#39;CalcIceStorageDischarge&#39;</span><span class="p">)</span>
<a name="ln-2075"></a>
<a name="ln-2076"></a>       <span class="c">! Calculate Umyload based on MyLoad from E+</span>
<a name="ln-2077"></a>  <span class="n">Umyload</span> <span class="o">=</span> <span class="o">-</span><span class="n">MyLoad</span><span class="o">*</span><span class="n">TimeInterval</span><span class="o">/</span><span class="n">ITSNomCap</span>
<a name="ln-2078"></a>       <span class="c">! Calculate Umax and Umin</span>
<a name="ln-2079"></a>       <span class="c">! Cannot discharge more than the fraction that is left</span>
<a name="ln-2080"></a>  <span class="n">Umax</span> <span class="o">=</span> <span class="o">-</span><span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">IceFracRemain</span><span class="o">/</span><span class="n">TimeStepSys</span>
<a name="ln-2081"></a>       <span class="c">! Calculate Umin based on returned Myload from E+.</span>
<a name="ln-2082"></a>  <span class="n">Umin</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span> <span class="n">Umyload</span><span class="p">,</span> <span class="mf">0.0d0</span> <span class="p">)</span>
<a name="ln-2083"></a>       <span class="c">! Based on Umax and Umin, if necessary to run E+, calculate proper Uact</span>
<a name="ln-2084"></a>       <span class="c">! U is negative here.</span>
<a name="ln-2085"></a>  <span class="n">Uact</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">Umin</span><span class="p">,</span><span class="n">Umax</span><span class="p">)</span>
<a name="ln-2086"></a>
<a name="ln-2087"></a>       <span class="c">! Set ITSInletTemp provided by E+</span>
<a name="ln-2088"></a>  <span class="n">ITSInletTemp</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">InletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-2089"></a>       <span class="c">!The first thing is to set the ITSMassFlowRate</span>
<a name="ln-2090"></a>  <span class="n">ITSMassFlowRate</span> <span class="o">=</span> <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">DesignMassFlowRate</span> <span class="c">![kg/s]</span>
<a name="ln-2091"></a>
<a name="ln-2092"></a>  <span class="k">CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">ITSMassFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2093"></a>                          <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PltInletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2094"></a>                          <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PltOutletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2095"></a>                          <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2096"></a>                          <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">LoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2097"></a>                          <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">BranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2098"></a>                          <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">CompNum</span> <span class="p">)</span>
<a name="ln-2099"></a>
<a name="ln-2100"></a>       <span class="c">! Qice is calculate input U which is within boundary between Umin and Umax.</span>
<a name="ln-2101"></a>  <span class="n">Qice</span> <span class="o">=</span> <span class="n">Uact</span><span class="o">*</span><span class="n">ITSNomCap</span><span class="o">/</span><span class="n">TimeInterval</span>
<a name="ln-2102"></a>       <span class="c">! Qice cannot exceed MaxCap calulated by CalcIceStorageCapacity</span>
<a name="ln-2103"></a>       <span class="c">! Note Qice is negative here, MaxCap is positive</span>
<a name="ln-2104"></a>  <span class="n">Qice</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">Qice</span><span class="p">,</span> <span class="o">-</span><span class="n">MaxCap</span><span class="p">)</span>
<a name="ln-2105"></a>
<a name="ln-2106"></a>        <span class="c">! Calculate leaving water temperature</span>
<a name="ln-2107"></a>  <span class="k">IF</span><span class="p">((</span><span class="n">Qice</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">XCurIceFrac</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2108"></a><span class="k">    </span><span class="n">ITSOutletTemp</span> <span class="o">=</span> <span class="n">ITSInletTemp</span>
<a name="ln-2109"></a>    <span class="n">DeltaTemp</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2110"></a>    <span class="n">Qice</span>          <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2111"></a>    <span class="n">Uact</span>          <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2112"></a>  <span class="k">ELSE</span>
<a name="ln-2113"></a><span class="k">    </span><span class="n">DeltaTemp</span> <span class="o">=</span> <span class="n">Qice</span><span class="o">/</span><span class="n">CpFluid</span><span class="o">/</span><span class="n">ITSMassFlowRate</span>
<a name="ln-2114"></a>    <span class="n">ITSOutletTemp</span> <span class="o">=</span> <span class="n">ITSInletTemp</span> <span class="o">+</span> <span class="n">DeltaTemp</span>
<a name="ln-2115"></a>     <span class="c">! Limit leaving temp to be no less than setpoint or freezing temp plus 1C</span>
<a name="ln-2116"></a>    <span class="n">ITSOutletTemp</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">ITSOutletTemp</span><span class="p">,</span> <span class="n">ITSOutletSetPointTemp</span><span class="p">,</span> <span class="p">(</span><span class="n">FreezTemp</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-2117"></a>     <span class="c">! Limit leaving temp to be no greater than inlet temp</span>
<a name="ln-2118"></a>    <span class="n">ITSOutletTemp</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">ITSOutletTemp</span><span class="p">,</span> <span class="n">ITSInletTemp</span><span class="p">)</span>
<a name="ln-2119"></a>    <span class="n">DeltaTemp</span>     <span class="o">=</span> <span class="n">ITSOutletTemp</span> <span class="o">-</span> <span class="n">ITSInletTemp</span>
<a name="ln-2120"></a>    <span class="n">Qice</span>          <span class="o">=</span> <span class="n">DeltaTemp</span><span class="o">*</span><span class="n">CpFluid</span><span class="o">*</span><span class="n">ITSMassFlowRate</span>
<a name="ln-2121"></a>    <span class="n">Uact</span>          <span class="o">=</span> <span class="n">Qice</span><span class="o">/</span><span class="p">(</span><span class="n">ITSNomCap</span><span class="o">/</span><span class="n">TimeInterval</span><span class="p">)</span>
<a name="ln-2122"></a>  <span class="k">END IF</span>  <span class="c">! End of leaving temp checks</span>
<a name="ln-2123"></a>
<a name="ln-2124"></a>       <span class="c">! Calculate reported U value</span>
<a name="ln-2125"></a>  <span class="n">Urate</span> <span class="o">=</span> <span class="n">Uact</span>
<a name="ln-2126"></a>       <span class="c">! Calculate ITSCoolingEnergy [J]</span>
<a name="ln-2127"></a>  <span class="n">ITSCoolingRate</span>   <span class="o">=</span> <span class="o">-</span><span class="n">Qice</span>
<a name="ln-2128"></a>  <span class="n">ITSCoolingEnergy</span> <span class="o">=</span> <span class="n">ITSCoolingRate</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-2129"></a>
<a name="ln-2130"></a><span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2131"></a><span class="k">END SELECT</span>
<a name="ln-2132"></a>
<a name="ln-2133"></a><span class="k">RETURN</span>
<a name="ln-2134"></a><span class="k">END SUBROUTINE </span><span class="n">CalcIceStorageDischarge</span>
<a name="ln-2135"></a>
<a name="ln-2136"></a>
<a name="ln-2137"></a><span class="c">!******************************************************************************</span>
<a name="ln-2138"></a><span class="k">SUBROUTINE </span><span class="n">CalcQiceDischageMax</span><span class="p">(</span><span class="n">QiceMin</span><span class="p">)</span>
<a name="ln-2139"></a>
<a name="ln-2140"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2141"></a>
<a name="ln-2142"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2143"></a>
<a name="ln-2144"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2145"></a>
<a name="ln-2146"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2147"></a>
<a name="ln-2148"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2149"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">PlantLoop</span><span class="p">,</span> <span class="n">SingleSetpoint</span><span class="p">,</span> <span class="n">DualSetpointDeadband</span>
<a name="ln-2150"></a>  <span class="k">IMPLICIT NONE</span>
<a name="ln-2151"></a>
<a name="ln-2152"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2153"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QiceMin</span>
<a name="ln-2154"></a>
<a name="ln-2155"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2156"></a>          <span class="c">! na</span>
<a name="ln-2157"></a>
<a name="ln-2158"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2159"></a>          <span class="c">! na</span>
<a name="ln-2160"></a>
<a name="ln-2161"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2162"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ITSInletTemp</span>
<a name="ln-2163"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ITSOutletTemp</span>
<a name="ln-2164"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LogTerm</span>
<a name="ln-2165"></a>
<a name="ln-2166"></a>          <span class="c">! FLOW</span>
<a name="ln-2167"></a>  <span class="c">! Qice is minimized when ITSInletTemp and ITSOutletTemp is almost same due to LMTD method.</span>
<a name="ln-2168"></a>  <span class="c">! Qice is maximized(=0) when ITSOutletTemp is almost same as FreezTemp(=0).</span>
<a name="ln-2169"></a>
<a name="ln-2170"></a>       <span class="c">! Set ITSInletTemp from E+.</span>
<a name="ln-2171"></a>  <span class="n">ITSInletTemp</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">InletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-2172"></a>
<a name="ln-2173"></a>       <span class="c">! Make ITSOutletTemp as almost same as ITSInletTemp</span>
<a name="ln-2174"></a>  <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">LoopDemandCalcScheme</span><span class="p">)</span>
<a name="ln-2175"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">SingleSetPoint</span><span class="p">)</span>
<a name="ln-2176"></a>    <span class="n">ITSOutletTemp</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">OutletNodeNum</span><span class="p">)%</span><span class="n">TempSetPoint</span>
<a name="ln-2177"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">DualSetPointDeadBand</span><span class="p">)</span>
<a name="ln-2178"></a>    <span class="n">ITSOutletTemp</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">OutletNodeNum</span><span class="p">)%</span><span class="n">TempSetPointHi</span>
<a name="ln-2179"></a>  <span class="k">END SELECT</span>
<a name="ln-2180"></a>
<a name="ln-2181"></a><span class="k">    </span><span class="n">LogTerm</span>       <span class="o">=</span> <span class="p">(</span><span class="n">ITSInletTemp</span> <span class="o">-</span> <span class="n">FreezTemp</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">ITSOutletTemp</span> <span class="o">-</span> <span class="n">FreezTemp</span><span class="p">)</span>
<a name="ln-2182"></a>
<a name="ln-2183"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">LogTerm</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2184"></a><span class="k">    </span><span class="n">QiceMin</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2185"></a>  <span class="k">ELSE</span>
<a name="ln-2186"></a><span class="k">    </span><span class="n">QiceMin</span> <span class="o">=</span> <span class="n">UAiceDisCh</span> <span class="o">*</span> <span class="p">(</span><span class="n">ITSInletTemp</span><span class="o">-</span><span class="n">ITSOutletTemp</span><span class="p">)</span> <span class="o">/</span> <span class="nb">LOG</span><span class="p">(</span><span class="n">LogTerm</span><span class="p">)</span>
<a name="ln-2187"></a>  <span class="n">ENDIF</span>
<a name="ln-2188"></a>
<a name="ln-2189"></a><span class="k">RETURN</span>
<a name="ln-2190"></a><span class="k">END SUBROUTINE </span><span class="n">CalcQiceDischageMax</span>
<a name="ln-2191"></a>
<a name="ln-2192"></a>
<a name="ln-2193"></a><span class="c">!******************************************************************************</span>
<a name="ln-2194"></a><span class="k">SUBROUTINE </span><span class="n">CalcUAIce</span><span class="p">(</span><span class="n">IceNum</span><span class="p">,</span><span class="n">XCurIceFrac</span><span class="p">,</span><span class="n">UAIceCh</span><span class="p">,</span><span class="n">UAIceDisCh</span><span class="p">,</span><span class="n">HLoss</span><span class="p">)</span>
<a name="ln-2195"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2196"></a>          <span class="c">!       AUTHOR</span>
<a name="ln-2197"></a>          <span class="c">!       DATE WRITTEN</span>
<a name="ln-2198"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-2199"></a>          <span class="c">!       RE-ENGINEERED</span>
<a name="ln-2200"></a>
<a name="ln-2201"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2202"></a>
<a name="ln-2203"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2204"></a>  <span class="c">! This routine is funtion of XCurIceFrac, and UA vaule is based on 1 hour.</span>
<a name="ln-2205"></a>
<a name="ln-2206"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2207"></a>
<a name="ln-2208"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2209"></a>
<a name="ln-2210"></a>  <span class="k">IMPLICIT NONE</span>
<a name="ln-2211"></a>
<a name="ln-2212"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2213"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IceNum</span>
<a name="ln-2214"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">XCurIceFrac</span>
<a name="ln-2215"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">UAIceCh</span>
<a name="ln-2216"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">UAIceDisCh</span>
<a name="ln-2217"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">HLoss</span>
<a name="ln-2218"></a>
<a name="ln-2219"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2220"></a>          <span class="c">! na</span>
<a name="ln-2221"></a>
<a name="ln-2222"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2223"></a>          <span class="c">! na</span>
<a name="ln-2224"></a>
<a name="ln-2225"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2226"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">y</span>
<a name="ln-2227"></a><span class="c">!  REAL(r64)  :: dTlmic</span>
<a name="ln-2228"></a><span class="c">!  REAL(r64)  :: Tfr     ! IP freezing temperature</span>
<a name="ln-2229"></a>
<a name="ln-2230"></a>  <span class="c">! Flow</span>
<a name="ln-2231"></a>
<a name="ln-2232"></a>  <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSType_Num</span> <span class="p">)</span>
<a name="ln-2233"></a>    <span class="k">CASE</span><span class="p">(</span><span class="n">ITSType_IceOnCoilInternal</span><span class="p">)</span>
<a name="ln-2234"></a>      <span class="n">y</span> <span class="o">=</span> <span class="n">XCurIceFrac</span>
<a name="ln-2235"></a>      <span class="n">UAIceCh</span> <span class="o">=</span> <span class="p">(</span> <span class="mf">1.3879d0</span> <span class="o">-</span> <span class="mf">7.6333d0</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mi">2</span><span class="mf">6.3423d0</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="mf">7.6084d0</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">4</span><span class="mf">1.8498d0</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">1</span><span class="mf">4.2948d0</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="mi">5</span> <span class="p">)</span>  <span class="p">&amp;</span>     <span class="c">! [W/C]</span>
<a name="ln-2236"></a>               <span class="o">*</span> <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSNomCap</span> <span class="o">/</span> <span class="n">TimeInterval</span> <span class="o">/</span> <span class="mi">1</span><span class="mf">0.0d0</span>
<a name="ln-2237"></a>      <span class="n">y</span><span class="o">=</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">XCurIceFrac</span>
<a name="ln-2238"></a>      <span class="n">UAIceDisCh</span> <span class="o">=</span> <span class="p">(</span> <span class="mf">1.3879d0</span> <span class="o">-</span> <span class="mf">7.6333d0</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mi">2</span><span class="mf">6.3423d0</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="mf">7.6084d0</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">4</span><span class="mf">1.8498d0</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">1</span><span class="mf">4.2948d0</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="mi">5</span> <span class="p">)</span>  <span class="p">&amp;</span>  <span class="c">! [W/C]</span>
<a name="ln-2239"></a>                  <span class="o">*</span> <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSNomCap</span> <span class="o">/</span> <span class="n">TimeInterval</span> <span class="o">/</span> <span class="mi">1</span><span class="mf">0.0d0</span>
<a name="ln-2240"></a>      <span class="n">HLoss</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2241"></a>    <span class="k">CASE</span><span class="p">(</span><span class="n">ITSType_IceOnCoilExternal</span><span class="p">)</span>
<a name="ln-2242"></a>      <span class="n">y</span> <span class="o">=</span> <span class="n">XCurIceFrac</span>
<a name="ln-2243"></a>      <span class="n">UAIceCh</span> <span class="o">=</span> <span class="p">(</span> <span class="mf">1.3879d0</span> <span class="o">-</span> <span class="mf">7.6333d0</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mi">2</span><span class="mf">6.3423d0</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="mf">7.6084d0</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">4</span><span class="mf">1.8498d0</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">1</span><span class="mf">4.2948d0</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="mi">5</span> <span class="p">)</span>  <span class="p">&amp;</span>     <span class="c">! [W/C]</span>
<a name="ln-2244"></a>               <span class="o">*</span> <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSNomCap</span> <span class="o">/</span> <span class="n">TimeInterval</span> <span class="o">/</span> <span class="mi">1</span><span class="mf">0.0d0</span>
<a name="ln-2245"></a>      <span class="n">y</span> <span class="o">=</span> <span class="mf">1.0d0</span><span class="o">-</span><span class="n">XCurIceFrac</span>
<a name="ln-2246"></a>      <span class="n">UAIceDisCh</span> <span class="o">=</span> <span class="p">(</span> <span class="mf">1.1756d0</span> <span class="o">-</span> <span class="mf">5.3689d0</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="mf">7.3602d0</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span><span class="mf">0.1077d0</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="mf">5.6387d0</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mf">8.5102d0</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="mi">5</span> <span class="p">)</span>  <span class="p">&amp;</span>   <span class="c">! [W/C]</span>
<a name="ln-2247"></a>                  <span class="o">*</span> <span class="n">IceStorage</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSNomCap</span> <span class="o">/</span> <span class="n">TimeInterval</span> <span class="o">/</span> <span class="mi">1</span><span class="mf">0.0d0</span>
<a name="ln-2248"></a>      <span class="n">HLoss</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2249"></a>
<a name="ln-2250"></a>  <span class="k">END SELECT</span>
<a name="ln-2251"></a>
<a name="ln-2252"></a><span class="k">RETURN</span>
<a name="ln-2253"></a><span class="k">END SUBROUTINE </span><span class="n">CalcUAIce</span>
<a name="ln-2254"></a>
<a name="ln-2255"></a>
<a name="ln-2256"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">CalcDetIceStorLMTDstar</span><span class="p">(</span><span class="n">Tin</span><span class="p">,</span> <span class="n">Tout</span><span class="p">,</span> <span class="n">Tfr</span><span class="p">)</span>
<a name="ln-2257"></a>
<a name="ln-2258"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2259"></a>          <span class="c">!       AUTHOR         Rick Strand</span>
<a name="ln-2260"></a>          <span class="c">!       DATE WRITTEN   February 2006</span>
<a name="ln-2261"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-2262"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2263"></a>
<a name="ln-2264"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2265"></a>          <span class="c">! This subroutine calculates the log mean temperature difference for</span>
<a name="ln-2266"></a>          <span class="c">! the detailed ice storage unit.  The temperature difference is non-</span>
<a name="ln-2267"></a>          <span class="c">! dimensionalized using a nominal temperature difference of 10C.</span>
<a name="ln-2268"></a>          <span class="c">! This value must be used when obtaining the curve fit coefficients.</span>
<a name="ln-2269"></a>
<a name="ln-2270"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2271"></a>          <span class="c">! Straight-forward calculation where:</span>
<a name="ln-2272"></a>          <span class="c">! LMTD* = LMTD/Tnom</span>
<a name="ln-2273"></a>          <span class="c">! LMTD = (Tin-Tout)/ln((Tin-Tfr)/(Tout-Tfr))</span>
<a name="ln-2274"></a>
<a name="ln-2275"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2276"></a>          <span class="c">! na</span>
<a name="ln-2277"></a>
<a name="ln-2278"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2279"></a>          <span class="c">! na</span>
<a name="ln-2280"></a>
<a name="ln-2281"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2282"></a>
<a name="ln-2283"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2284"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Tin</span>   <span class="c">! ice storage unit inlet temperature</span>
<a name="ln-2285"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Tout</span>  <span class="c">! ice storage unit outlet (setpoint) temperature</span>
<a name="ln-2286"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Tfr</span>   <span class="c">! freezing temperature</span>
<a name="ln-2287"></a>
<a name="ln-2288"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2289"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Tnom</span> <span class="o">=</span><span class="mi">1</span><span class="mf">0.0d0</span>         <span class="c">! Nominal temperature difference across the ice storage unit [C]</span>
<a name="ln-2290"></a>
<a name="ln-2291"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2292"></a>          <span class="c">! na</span>
<a name="ln-2293"></a>
<a name="ln-2294"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2295"></a>          <span class="c">! na</span>
<a name="ln-2296"></a>
<a name="ln-2297"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2298"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DeltaTio</span>  <span class="c">! Inlet to outlet temperature difference</span>
<a name="ln-2299"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DeltaTif</span>  <span class="c">! Inlet to freezing temperature difference</span>
<a name="ln-2300"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DeltaTof</span>  <span class="c">! Outlet to freezing temperature difference</span>
<a name="ln-2301"></a>
<a name="ln-2302"></a>          <span class="c">! FLOW:</span>
<a name="ln-2303"></a>          <span class="c">! First set the temperature differences and avoid problems with the LOG</span>
<a name="ln-2304"></a>          <span class="c">! term by setting some reasonable minimums</span>
<a name="ln-2305"></a>  <span class="n">DeltaTio</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">Tin</span><span class="o">-</span><span class="n">Tout</span><span class="p">)</span>
<a name="ln-2306"></a>  <span class="n">DeltaTif</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">Tin</span><span class="o">-</span><span class="n">Tfr</span><span class="p">)</span>
<a name="ln-2307"></a>  <span class="n">DeltaTof</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">Tout</span><span class="o">-</span><span class="n">Tfr</span><span class="p">)</span>
<a name="ln-2308"></a>
<a name="ln-2309"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaTif</span> <span class="o">&lt;</span> <span class="n">DeltaTifMin</span><span class="p">)</span> <span class="n">DeltaTif</span> <span class="o">=</span> <span class="n">DeltaTifMin</span>
<a name="ln-2310"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaTof</span> <span class="o">&lt;</span> <span class="n">DeltaTofMin</span><span class="p">)</span> <span class="n">DeltaTof</span> <span class="o">=</span> <span class="n">DeltaTofMin</span>
<a name="ln-2311"></a>
<a name="ln-2312"></a>  <span class="n">CalcDetIceStorLMTDstar</span> <span class="o">=</span> <span class="p">(</span> <span class="n">DeltaTio</span> <span class="o">/</span> <span class="nb">LOG</span><span class="p">(</span><span class="n">DeltaTif</span><span class="o">/</span><span class="n">DeltaTof</span><span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="n">Tnom</span>
<a name="ln-2313"></a>
<a name="ln-2314"></a>  <span class="k">RETURN</span>
<a name="ln-2315"></a>
<a name="ln-2316"></a><span class="k">END FUNCTION </span><span class="n">CalcDetIceStorLMTDstar</span>
<a name="ln-2317"></a>
<a name="ln-2318"></a>
<a name="ln-2319"></a><span class="c">! *****************************************************************************</span>
<a name="ln-2320"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">TempSItoIP</span><span class="p">(</span><span class="n">Temp</span><span class="p">)</span>
<a name="ln-2321"></a>  <span class="k">IMPLICIT NONE</span>
<a name="ln-2322"></a><span class="k">  </span><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Temp</span>
<a name="ln-2323"></a>
<a name="ln-2324"></a>  <span class="n">TempSItoIP</span> <span class="o">=</span> <span class="p">(</span><span class="n">Temp</span><span class="o">*</span><span class="mf">9.0d0</span><span class="o">/</span><span class="mf">5.0d0</span><span class="p">)</span><span class="o">+</span><span class="mi">3</span><span class="mf">2.0d0</span>
<a name="ln-2325"></a>  <span class="k">RETURN</span>
<a name="ln-2326"></a><span class="k">END FUNCTION</span>
<a name="ln-2327"></a>
<a name="ln-2328"></a><span class="c">! *****************************************************************************</span>
<a name="ln-2329"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">TempIPtoSI</span><span class="p">(</span><span class="n">Temp</span><span class="p">)</span>
<a name="ln-2330"></a>  <span class="k">IMPLICIT NONE</span>
<a name="ln-2331"></a><span class="k">  </span><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Temp</span>
<a name="ln-2332"></a>
<a name="ln-2333"></a>  <span class="n">TempIPtoSI</span> <span class="o">=</span> <span class="p">(</span><span class="n">Temp</span><span class="o">-</span><span class="mi">3</span><span class="mf">2.0d0</span><span class="p">)</span><span class="o">*</span><span class="mf">5.0d0</span><span class="o">/</span><span class="mf">9.0d0</span>
<a name="ln-2334"></a>  <span class="k">RETURN</span>
<a name="ln-2335"></a><span class="k">END FUNCTION</span>
<a name="ln-2336"></a>
<a name="ln-2337"></a>
<a name="ln-2338"></a><span class="c">! *****************************************************************************</span>
<a name="ln-2339"></a><span class="k">SUBROUTINE </span><span class="n">UpdateNode</span><span class="p">(</span><span class="n">MyLoad</span><span class="p">,</span><span class="n">RunFlag</span><span class="p">,</span><span class="n">Num</span><span class="p">)</span>
<a name="ln-2340"></a>            <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2341"></a>            <span class="c">!       AUTHOR:          Dan Fisher</span>
<a name="ln-2342"></a>            <span class="c">!       DATE WRITTEN:    October 1998</span>
<a name="ln-2343"></a>
<a name="ln-2344"></a>            <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2345"></a>
<a name="ln-2346"></a>            <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2347"></a>
<a name="ln-2348"></a>            <span class="c">! REFERENCES:</span>
<a name="ln-2349"></a>
<a name="ln-2350"></a>            <span class="c">! USE STATEMENTS:</span>
<a name="ln-2351"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">SafeCopyPlantNode</span>
<a name="ln-2352"></a>
<a name="ln-2353"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2354"></a>
<a name="ln-2355"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2356"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">MyLoad</span>
<a name="ln-2357"></a>  <span class="kt">LOGICAL</span>              <span class="kd">::</span> <span class="n">RunFlag</span>
<a name="ln-2358"></a>  <span class="kt">INTEGER</span>              <span class="kd">::</span> <span class="n">Num</span>
<a name="ln-2359"></a>
<a name="ln-2360"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2361"></a>          <span class="c">! na</span>
<a name="ln-2362"></a>
<a name="ln-2363"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2364"></a>          <span class="c">! na</span>
<a name="ln-2365"></a>
<a name="ln-2366"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2367"></a>          <span class="c">! na</span>
<a name="ln-2368"></a>
<a name="ln-2369"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2370"></a>          <span class="c">! na</span>
<a name="ln-2371"></a>
<a name="ln-2372"></a>          <span class="c">! FLOW</span>
<a name="ln-2373"></a>
<a name="ln-2374"></a>       <span class="c">! Update Node Inlet &amp; Outlet MassFlowRat</span>
<a name="ln-2375"></a>  <span class="k">CALL </span><span class="n">SafeCopyPlantNode</span><span class="p">(</span><span class="n">InletNodeNum</span><span class="p">,</span> <span class="n">OutletNodeNum</span><span class="p">)</span>
<a name="ln-2376"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MyLoad</span> <span class="o">==</span><span class="mi">0</span>  <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">RunFlag</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2377"></a>         <span class="c">! Update Outlet Conditions so that same as Inlet, so component can be bypassed if necessary</span>
<a name="ln-2378"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">OutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>          <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">InletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-2379"></a>  <span class="k">ELSE</span>
<a name="ln-2380"></a><span class="k">    </span><span class="n">Node</span><span class="p">(</span><span class="n">OutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>          <span class="o">=</span> <span class="n">ITSOutletTemp</span>
<a name="ln-2381"></a>  <span class="k">END IF</span>
<a name="ln-2382"></a>
<a name="ln-2383"></a><span class="c">!! ??? For now, always set outletnode mass flow equal to inletnode mass flow</span>
<a name="ln-2384"></a><span class="c">!! ??? Node(InletNodeNum)%MassFlowRate   = ITSMassFlowRate</span>
<a name="ln-2385"></a><span class="c">!! ???  Node(OutletNodeNum)%MassFlowRate  = ITSMassFlowRate</span>
<a name="ln-2386"></a><span class="c">!</span>
<a name="ln-2387"></a><span class="c">!!  IF (Node(InletNodeNum)%MassFlowRate &gt; 0.0) THEN</span>
<a name="ln-2388"></a><span class="c">!    Node(OutletNodeNum)%MassFlowRate = Node(InletNodeNum)%MassFlowRate</span>
<a name="ln-2389"></a><span class="c">!!  ELSE</span>
<a name="ln-2390"></a><span class="c">!!    Node(InletNodeNum)%MassFlowRate  = Node(InletNodeNum)%MassFlowRateMaxAvail</span>
<a name="ln-2391"></a><span class="c">!!    Node(OutletNodeNum)%MassFlowRate = Node(InletNodeNum)%MassFlowRateMaxAvail</span>
<a name="ln-2392"></a><span class="c">!!  ENDIF</span>
<a name="ln-2393"></a><span class="c">!</span>
<a name="ln-2394"></a><span class="c">!  Node(OutletNodeNum)%MassFlowRateMax = Node(InletNodeNum)%MassFlowRateMax</span>
<a name="ln-2395"></a><span class="c">!  Node(OutletNodeNum)%MassFlowRateMin = Node(InletNodeNum)%MassFlowRateMin</span>
<a name="ln-2396"></a><span class="c">!  Node(OutletNodeNum)%MassFlowRateMaxAvail = Node(InletNodeNum)%MassFlowRateMaxAvail</span>
<a name="ln-2397"></a><span class="c">!  Node(OutletNodeNum)%MassFlowRateMinAvail = Node(InletNodeNum)%MassFlowRateMinAvail</span>
<a name="ln-2398"></a>
<a name="ln-2399"></a><span class="k">RETURN</span>
<a name="ln-2400"></a><span class="k">END SUBROUTINE </span><span class="n">UpdateNode</span>
<a name="ln-2401"></a>
<a name="ln-2402"></a>
<a name="ln-2403"></a><span class="c">! *****************************************************************************</span>
<a name="ln-2404"></a><span class="k">SUBROUTINE </span><span class="n">RecordOutput</span><span class="p">(</span><span class="n">IceNum</span><span class="p">,</span><span class="n">MyLoad</span><span class="p">,</span><span class="n">RunFlag</span><span class="p">)</span>
<a name="ln-2405"></a>
<a name="ln-2406"></a>            <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2407"></a>
<a name="ln-2408"></a>            <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2409"></a>
<a name="ln-2410"></a>            <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2411"></a>
<a name="ln-2412"></a>            <span class="c">! REFERENCES:</span>
<a name="ln-2413"></a>
<a name="ln-2414"></a>            <span class="c">! USE STATEMENTS:</span>
<a name="ln-2415"></a>
<a name="ln-2416"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2417"></a>
<a name="ln-2418"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2419"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IceNum</span>
<a name="ln-2420"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MyLoad</span>
<a name="ln-2421"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RunFlag</span>
<a name="ln-2422"></a>
<a name="ln-2423"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2424"></a>          <span class="c">! na</span>
<a name="ln-2425"></a>
<a name="ln-2426"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2427"></a>          <span class="c">! na</span>
<a name="ln-2428"></a>
<a name="ln-2429"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2430"></a>          <span class="c">! na</span>
<a name="ln-2431"></a>
<a name="ln-2432"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2433"></a>
<a name="ln-2434"></a>          <span class="c">! FLOW</span>
<a name="ln-2435"></a>
<a name="ln-2436"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MyLoad</span> <span class="o">==</span><span class="mi">0</span>  <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">RunFlag</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2437"></a><span class="k">    </span><span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">MyLoad</span> <span class="o">=</span> <span class="n">MyLoad</span>
<a name="ln-2438"></a>    <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">U</span> <span class="o">=</span> <span class="n">U</span>
<a name="ln-2439"></a>    <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">Urate</span> <span class="o">=</span> <span class="n">Urate</span>
<a name="ln-2440"></a>    <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSCoolingRate</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2441"></a>    <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSCoolingEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2442"></a>    <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSChargingRate</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2443"></a>    <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSChargingEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2444"></a>    <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSmdot</span>          <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2445"></a>    <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSInletTemp</span>     <span class="o">=</span> <span class="n">ITSInletTemp</span>
<a name="ln-2446"></a>    <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSOutletTemp</span>    <span class="o">=</span> <span class="n">ITSOutletTemp</span>
<a name="ln-2447"></a>
<a name="ln-2448"></a>  <span class="k">ELSE</span>
<a name="ln-2449"></a><span class="k">    </span><span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">MyLoad</span> <span class="o">=</span> <span class="n">MyLoad</span>
<a name="ln-2450"></a>    <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">U</span> <span class="o">=</span> <span class="n">U</span>
<a name="ln-2451"></a>    <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">Urate</span> <span class="o">=</span> <span class="n">Urate</span>
<a name="ln-2452"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">ITSCoolingRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2453"></a><span class="k">      </span><span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSCoolingRate</span>   <span class="o">=</span> <span class="n">ITSCoolingRate</span>
<a name="ln-2454"></a>      <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSCoolingEnergy</span> <span class="o">=</span> <span class="n">ITSCoolingEnergy</span>
<a name="ln-2455"></a>      <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSChargingRate</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2456"></a>      <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSChargingEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2457"></a>    <span class="k">ELSE</span>
<a name="ln-2458"></a><span class="k">      </span><span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSCoolingRate</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2459"></a>      <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSCoolingEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2460"></a>      <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSChargingRate</span>   <span class="o">=</span> <span class="o">-</span><span class="n">ITSCoolingRate</span>
<a name="ln-2461"></a>      <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSChargingEnergy</span> <span class="o">=</span> <span class="o">-</span><span class="n">ITSCoolingEnergy</span>
<a name="ln-2462"></a>    <span class="n">ENDIF</span>
<a name="ln-2463"></a>    <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSmdot</span>          <span class="o">=</span> <span class="n">ITSMassFlowRate</span>
<a name="ln-2464"></a>    <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSInletTemp</span>     <span class="o">=</span> <span class="n">ITSInletTemp</span>
<a name="ln-2465"></a>    <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ITSOutletTemp</span>    <span class="o">=</span> <span class="n">ITSOutletTemp</span>
<a name="ln-2466"></a>
<a name="ln-2467"></a>  <span class="k">END IF</span>
<a name="ln-2468"></a>
<a name="ln-2469"></a>
<a name="ln-2470"></a><span class="k">RETURN</span>
<a name="ln-2471"></a><span class="k">END SUBROUTINE </span><span class="n">RecordOutput</span>
<a name="ln-2472"></a>
<a name="ln-2473"></a><span class="c">! *****************************************************************************</span>
<a name="ln-2474"></a><span class="k">SUBROUTINE </span><span class="n">UpdateIceFractions</span>
<a name="ln-2475"></a>
<a name="ln-2476"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2477"></a>          <span class="c">!       AUTHOR         Mike Witte</span>
<a name="ln-2478"></a>          <span class="c">!       DATE WRITTEN   September 2005</span>
<a name="ln-2479"></a>          <span class="c">!       MODIFIED       Rick Strand (Feb 2006, for detailed ice storage model)</span>
<a name="ln-2480"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2481"></a>
<a name="ln-2482"></a>
<a name="ln-2483"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2484"></a>          <span class="c">! Update all ice fractions at end of system time step.</span>
<a name="ln-2485"></a>
<a name="ln-2486"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2487"></a>          <span class="c">! This is called from HVACManager once we have actually stepped forward</span>
<a name="ln-2488"></a>          <span class="c">! a system time step.</span>
<a name="ln-2489"></a>
<a name="ln-2490"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2491"></a>          <span class="c">! na</span>
<a name="ln-2492"></a>
<a name="ln-2493"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2494"></a>          <span class="c">! na</span>
<a name="ln-2495"></a>
<a name="ln-2496"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2497"></a>
<a name="ln-2498"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2499"></a>          <span class="c">! na</span>
<a name="ln-2500"></a>
<a name="ln-2501"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2502"></a>          <span class="c">! na</span>
<a name="ln-2503"></a>
<a name="ln-2504"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2505"></a>          <span class="c">! na</span>
<a name="ln-2506"></a>
<a name="ln-2507"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2508"></a>          <span class="c">! na</span>
<a name="ln-2509"></a>
<a name="ln-2510"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2511"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IceNum2</span>
<a name="ln-2512"></a>
<a name="ln-2513"></a>          <span class="c">! FLOW</span>
<a name="ln-2514"></a>
<a name="ln-2515"></a>  <span class="k">DO </span><span class="n">IceNum2</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumIceStorages</span>
<a name="ln-2516"></a>    <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum2</span><span class="p">)%</span><span class="n">IceFracRemain</span> <span class="o">=</span> <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum2</span><span class="p">)%</span><span class="n">IceFracRemain</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2517"></a>        <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum2</span><span class="p">)%</span><span class="n">Urate</span><span class="o">*</span><span class="n">TimeStepSys</span>
<a name="ln-2518"></a>    <span class="k">IF</span><span class="p">(</span> <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum2</span><span class="p">)%</span><span class="n">IceFracRemain</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.001d0</span><span class="p">)</span> <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum2</span><span class="p">)%</span><span class="n">IceFracRemain</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2519"></a>    <span class="k">IF</span><span class="p">(</span> <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum2</span><span class="p">)%</span><span class="n">IceFracRemain</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.0d0</span>  <span class="p">)</span> <span class="n">IceStorageReport</span><span class="p">(</span><span class="n">IceNum2</span><span class="p">)%</span><span class="n">IceFracRemain</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2520"></a>  <span class="k">END DO</span>
<a name="ln-2521"></a>
<a name="ln-2522"></a><span class="k">  DO </span><span class="n">IceNum2</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumDetIceStorages</span>
<a name="ln-2523"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum2</span><span class="p">)%</span><span class="n">IceFracRemaining</span> <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum2</span><span class="p">)%</span><span class="n">IceFracRemaining</span> <span class="p">&amp;</span>
<a name="ln-2524"></a>                                          <span class="o">+</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum2</span><span class="p">)%</span><span class="n">IceFracChange</span> <span class="p">&amp;</span>
<a name="ln-2525"></a>                                          <span class="o">-</span><span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum2</span><span class="p">)%</span><span class="n">TankLossCoeff</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="p">)</span>
<a name="ln-2526"></a>    <span class="k">IF</span><span class="p">(</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum2</span><span class="p">)%</span><span class="n">IceFracRemaining</span> <span class="o">&lt;</span> <span class="mf">0.001d0</span><span class="p">)</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum2</span><span class="p">)%</span><span class="n">IceFracRemaining</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2527"></a>    <span class="k">IF</span><span class="p">(</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum2</span><span class="p">)%</span><span class="n">IceFracRemaining</span> <span class="o">&gt;</span> <span class="mf">1.000d0</span><span class="p">)</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum2</span><span class="p">)%</span><span class="n">IceFracRemaining</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2528"></a>         <span class="c">! Reset the ice on the coil to zero for inside melt whenever discharging takes place.</span>
<a name="ln-2529"></a>         <span class="c">! This assumes that any remaining ice floats away from the coil and resettles perfectly.</span>
<a name="ln-2530"></a>         <span class="c">! While this is not exactly what happens and it is possible theoretically to have multiple</span>
<a name="ln-2531"></a>         <span class="c">! freeze thaw cycles that are not complete, this is the best we can do.</span>
<a name="ln-2532"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum2</span><span class="p">)%</span><span class="n">ThawProcessIndex</span> <span class="o">==</span> <span class="n">DetIceInsideMelt</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2533"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum2</span><span class="p">)%</span><span class="n">IceFracChange</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2534"></a><span class="k">        </span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum2</span><span class="p">)%</span><span class="n">IceFracOnCoil</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2535"></a>      <span class="k">ELSE</span>
<a name="ln-2536"></a>         <span class="c">! Assume loss term does not impact ice on the coil but what is remaining</span>
<a name="ln-2537"></a>        <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum2</span><span class="p">)%</span><span class="n">IceFracOnCoil</span> <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum2</span><span class="p">)%</span><span class="n">IceFracOnCoil</span> <span class="p">&amp;</span>
<a name="ln-2538"></a>                                           <span class="o">+</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum2</span><span class="p">)%</span><span class="n">IceFracChange</span>
<a name="ln-2539"></a>         <span class="c">! If the ice remaining has run out because of tank losses, reset ice fraction on coil so that it keeps track of losses</span>
<a name="ln-2540"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum2</span><span class="p">)%</span><span class="n">IceFracOnCoil</span> <span class="o">&gt;</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum2</span><span class="p">)%</span><span class="n">IceFracRemaining</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2541"></a>            <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum2</span><span class="p">)%</span><span class="n">IceFracOnCoil</span> <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum2</span><span class="p">)%</span><span class="n">IceFracRemaining</span>
<a name="ln-2542"></a>      <span class="k">END IF</span>
<a name="ln-2543"></a><span class="k">    ELSE</span> <span class="c">! Outside melt system so IceFracOnCoil is always the same as IceFracRemaining (needs to be done for reporting only)</span>
<a name="ln-2544"></a>      <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum2</span><span class="p">)%</span><span class="n">IceFracOnCoil</span> <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum2</span><span class="p">)%</span><span class="n">IceFracRemaining</span>
<a name="ln-2545"></a>    <span class="k">END IF</span>
<a name="ln-2546"></a><span class="k">  END DO</span>
<a name="ln-2547"></a>
<a name="ln-2548"></a><span class="k">  RETURN</span>
<a name="ln-2549"></a>
<a name="ln-2550"></a><span class="k">END SUBROUTINE </span><span class="n">UpdateIceFractions</span>
<a name="ln-2551"></a>
<a name="ln-2552"></a>
<a name="ln-2553"></a><span class="k">SUBROUTINE </span><span class="n">UpdateDetailedIceStorage</span>
<a name="ln-2554"></a>
<a name="ln-2555"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2556"></a>          <span class="c">!       AUTHOR         Rick Strand</span>
<a name="ln-2557"></a>          <span class="c">!       DATE WRITTEN   February 2006</span>
<a name="ln-2558"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-2559"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2560"></a>
<a name="ln-2561"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2562"></a>          <span class="c">! This subroutine takes the necessary information from the local data</span>
<a name="ln-2563"></a>          <span class="c">! structure and moves it back to the loop node data structure.</span>
<a name="ln-2564"></a>
<a name="ln-2565"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2566"></a>          <span class="c">! Not much mystery here--just move the data to the appropriate place</span>
<a name="ln-2567"></a>          <span class="c">! for the detailed ice storage system in question.</span>
<a name="ln-2568"></a>
<a name="ln-2569"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2570"></a>          <span class="c">! na</span>
<a name="ln-2571"></a>
<a name="ln-2572"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2573"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">SafeCopyPlantNode</span>
<a name="ln-2574"></a>
<a name="ln-2575"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2576"></a>
<a name="ln-2577"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2578"></a>          <span class="c">! na</span>
<a name="ln-2579"></a>
<a name="ln-2580"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2581"></a>          <span class="c">! na</span>
<a name="ln-2582"></a>
<a name="ln-2583"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2584"></a>          <span class="c">! na</span>
<a name="ln-2585"></a>
<a name="ln-2586"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2587"></a>          <span class="c">! na</span>
<a name="ln-2588"></a>
<a name="ln-2589"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2590"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">InNodeNum</span>  <span class="c">! Plant inlet node number for component</span>
<a name="ln-2591"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">OutNodeNum</span> <span class="c">! Plant outlet node number for component</span>
<a name="ln-2592"></a>
<a name="ln-2593"></a>          <span class="c">! FLOW:</span>
<a name="ln-2594"></a>          <span class="c">! Set the temperature and flow rate for the component outlet node</span>
<a name="ln-2595"></a>  <span class="n">InNodeNum</span>  <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantInNodeNum</span>
<a name="ln-2596"></a>  <span class="n">OutNodeNum</span> <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">PlantOutNodeNum</span>
<a name="ln-2597"></a>
<a name="ln-2598"></a>  <span class="k">CALL </span><span class="n">SafeCopyPlantNode</span><span class="p">(</span><span class="n">InNodeNum</span><span class="p">,</span> <span class="n">OutNodeNum</span><span class="p">)</span>
<a name="ln-2599"></a>
<a name="ln-2600"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">OutNodeNum</span><span class="p">)%</span><span class="n">Temp</span>                 <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">OutletTemp</span>
<a name="ln-2601"></a>
<a name="ln-2602"></a>
<a name="ln-2603"></a>  <span class="k">RETURN</span>
<a name="ln-2604"></a>
<a name="ln-2605"></a><span class="k">END SUBROUTINE </span><span class="n">UpdateDetailedIceStorage</span>
<a name="ln-2606"></a>
<a name="ln-2607"></a>
<a name="ln-2608"></a><span class="k">SUBROUTINE </span><span class="n">ReportDetailedIceStorage</span>
<a name="ln-2609"></a>
<a name="ln-2610"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2611"></a>          <span class="c">!       AUTHOR         Rick Strand</span>
<a name="ln-2612"></a>          <span class="c">!       DATE WRITTEN   February 2006</span>
<a name="ln-2613"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-2614"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2615"></a>
<a name="ln-2616"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2617"></a>          <span class="c">! This subroutine reports all of the output necessary for the model.</span>
<a name="ln-2618"></a>
<a name="ln-2619"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2620"></a>          <span class="c">! Just take what has already been calculated or calculate the appropriate</span>
<a name="ln-2621"></a>          <span class="c">! output value based on simulation data.</span>
<a name="ln-2622"></a>
<a name="ln-2623"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2624"></a>          <span class="c">! na</span>
<a name="ln-2625"></a>
<a name="ln-2626"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2627"></a>          <span class="c">! na</span>
<a name="ln-2628"></a>
<a name="ln-2629"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2630"></a>
<a name="ln-2631"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2632"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">LowLoadLimit</span> <span class="o">=</span> <span class="mf">0.1d0</span> <span class="c">! Load below which device can be assumed off [W]</span>
<a name="ln-2633"></a>
<a name="ln-2634"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2635"></a>          <span class="c">! na</span>
<a name="ln-2636"></a>
<a name="ln-2637"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2638"></a>          <span class="c">! na</span>
<a name="ln-2639"></a>
<a name="ln-2640"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2641"></a>          <span class="c">! na</span>
<a name="ln-2642"></a>
<a name="ln-2643"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2644"></a>          <span class="c">! na</span>
<a name="ln-2645"></a>
<a name="ln-2646"></a>          <span class="c">! FLOW:</span>
<a name="ln-2647"></a>          <span class="c">! Determine what is going on  based on load and the inlet and outlet temperature comparison</span>
<a name="ln-2648"></a>
<a name="ln-2649"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">CompLoad</span> <span class="o">&lt;</span> <span class="n">LowLoadLimit</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! No load condition</span>
<a name="ln-2650"></a>
<a name="ln-2651"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">IceFracChange</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2652"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">DischargingRate</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2653"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">DischargingEnergy</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2654"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ChargingRate</span>        <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2655"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ChargingEnergy</span>      <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2656"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ParasiticElecRate</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2657"></a>    <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ParasiticElecEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2658"></a>
<a name="ln-2659"></a>  <span class="k">ELSE</span>  <span class="c">! There is a load, determine whether we are charging or discharging based on inlet and outlet temperature</span>
<a name="ln-2660"></a>
<a name="ln-2661"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">InletTemp</span> <span class="o">&lt;</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">OutletTemp</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Charging Mode</span>
<a name="ln-2662"></a>
<a name="ln-2663"></a>      <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ChargingRate</span>        <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">CompLoad</span>
<a name="ln-2664"></a>      <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ChargingEnergy</span>      <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">CompLoad</span> <span class="o">*</span> <span class="p">(</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span><span class="p">)</span>
<a name="ln-2665"></a>      <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">IceFracChange</span>       <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">CompLoad</span> <span class="o">*</span> <span class="n">TimeStepSys</span> <span class="o">/</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">NomCapacity</span>
<a name="ln-2666"></a>      <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">DischargingRate</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2667"></a>      <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">DischargingEnergy</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2668"></a>      <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ParasiticElecRate</span>   <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ChargeParaElecLoad</span> <span class="o">*</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">CompLoad</span>
<a name="ln-2669"></a>      <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ParasiticElecEnergy</span> <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ChargeParaElecLoad</span> <span class="o">*</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ChargingEnergy</span>
<a name="ln-2670"></a>
<a name="ln-2671"></a>    <span class="k">ELSE</span>    <span class="c">! (DetIceStor(IceNum)%InletTemp &lt; DetIceStor(IceNum)%OutletTemp) Discharging Mode</span>
<a name="ln-2672"></a>
<a name="ln-2673"></a>      <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">DischargingRate</span>     <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">CompLoad</span>
<a name="ln-2674"></a>      <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">DischargingEnergy</span>   <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">CompLoad</span> <span class="o">*</span> <span class="p">(</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span><span class="p">)</span>
<a name="ln-2675"></a>      <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">IceFracChange</span>       <span class="o">=-</span><span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">CompLoad</span> <span class="o">*</span> <span class="n">TimeStepSys</span> <span class="o">/</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">NomCapacity</span>
<a name="ln-2676"></a>      <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ChargingRate</span>        <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2677"></a>      <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ChargingEnergy</span>      <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2678"></a>      <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ParasiticElecRate</span>   <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">DischargeParaElecLoad</span> <span class="o">*</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">CompLoad</span>
<a name="ln-2679"></a>      <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ParasiticElecEnergy</span> <span class="o">=</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">DischargeParaElecLoad</span> <span class="o">*</span> <span class="n">DetIceStor</span><span class="p">(</span><span class="n">IceNum</span><span class="p">)%</span><span class="n">ChargingEnergy</span>
<a name="ln-2680"></a>
<a name="ln-2681"></a>    <span class="k">END IF</span>
<a name="ln-2682"></a>
<a name="ln-2683"></a><span class="k">  END IF</span>
<a name="ln-2684"></a>
<a name="ln-2685"></a><span class="k">  RETURN</span>
<a name="ln-2686"></a>
<a name="ln-2687"></a><span class="k">END SUBROUTINE </span><span class="n">ReportDetailedIceStorage</span>
<a name="ln-2688"></a>
<a name="ln-2689"></a><span class="c">!     NOTICE</span>
<a name="ln-2690"></a><span class="c">!</span>
<a name="ln-2691"></a><span class="c">!     Copyright  1996-2013 The Board of Trustees of the University of Illinois</span>
<a name="ln-2692"></a><span class="c">!     and The Regents of the University of California through Ernest Orlando Lawrence</span>
<a name="ln-2693"></a><span class="c">!     Berkeley National Laboratory.  All rights reserved.</span>
<a name="ln-2694"></a><span class="c">!</span>
<a name="ln-2695"></a><span class="c">!     Portions of the EnergyPlus software package have been developed and copyrighted</span>
<a name="ln-2696"></a><span class="c">!     by other individuals, companies and institutions.  These portions have been</span>
<a name="ln-2697"></a><span class="c">!     incorporated into the EnergyPlus software package under license.   For a complete</span>
<a name="ln-2698"></a><span class="c">!     list of contributors, see &quot;Notice&quot; located in EnergyPlus.f90.</span>
<a name="ln-2699"></a><span class="c">!</span>
<a name="ln-2700"></a><span class="c">!     NOTICE: The U.S. Government is granted for itself and others acting on its</span>
<a name="ln-2701"></a><span class="c">!     behalf a paid-up, nonexclusive, irrevocable, worldwide license in this data to</span>
<a name="ln-2702"></a><span class="c">!     reproduce, prepare derivative works, and perform publicly and display publicly.</span>
<a name="ln-2703"></a><span class="c">!     Beginning five (5) years after permission to assert copyright is granted,</span>
<a name="ln-2704"></a><span class="c">!     subject to two possible five year renewals, the U.S. Government is granted for</span>
<a name="ln-2705"></a><span class="c">!     itself and others acting on its behalf a paid-up, non-exclusive, irrevocable</span>
<a name="ln-2706"></a><span class="c">!     worldwide license in this data to reproduce, prepare derivative works,</span>
<a name="ln-2707"></a><span class="c">!     distribute copies to the public, perform publicly and display publicly, and to</span>
<a name="ln-2708"></a><span class="c">!     permit others to do so.</span>
<a name="ln-2709"></a><span class="c">!</span>
<a name="ln-2710"></a><span class="c">!     TRADEMARKS: EnergyPlus is a trademark of the US Department of Energy.</span>
<a name="ln-2711"></a><span class="c">!</span>
<a name="ln-2712"></a>
<a name="ln-2713"></a><span class="k">END MODULE </span><span class="n">IceThermalStorage</span>
</pre></div>

    </section>
    </div>
  </div>

  <section class="visible-xs visible-sm hidden-md">
    <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-1">All Source Files</a></h3></div>
  <div id="allfiles-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


  </section>

    <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2017 </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by
            <a href="https://github.com/cmacmackin/ford">FORD</a>

          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> EnergyPlusFortran</p></div>
      </div>
      <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': {
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>
