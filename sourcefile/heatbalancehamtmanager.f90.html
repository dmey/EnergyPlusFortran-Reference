<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

	 <meta name="description" content="">

    <meta name="author" content="dmey (forked from NREL)" >
    <link rel="icon" href="../favicon.png">

    <title>HeatBalanceHAMTManager.f90 &ndash; EnergyPlusFortran</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>


    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>


  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">EnergyPlusFortran <small>8.1.0.009</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">

            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
		 aria-expanded="false">Contents <span class="caret"></span></a>
	      <ul class="dropdown-menu">

            <li><a href="../lists/files.html">Source Files</a></li>


            <li><a href="../lists/modules.html">Modules</a></li>


            <li><a href="../lists/procedures.html">Procedures</a></li>


            <li><a href="../lists/types.html">Derived Types</a></li>


            <li><a href="../program/energyplus.html">Program</a></li>

            </ul>
            </li>

<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/energyplus.html">Program</a></li>

          </ul>


        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">


  <div class="row">
    <h1>HeatBalanceHAMTManager.f90
    <small>Source File</small>

    </h1>

<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">


     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
	  data-placement="bottom" data-html="true"
	  title=" 0.3% of total for source files.">1085 statements</a>
     </li>


    <li><i class="fa fa-code"></i><a href="../src/HeatBalanceHAMTManager.f90"> Source File</a></li>

  </ul>
  <ol class="breadcrumb in-well text-right">

     <li class="active">HeatBalanceHAMTManager.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">

<div id="sidebar">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/heatbalancehamtmanager.html">HeatBalanceHAMTManager</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html#src">HeatBalanceHAMTManager.f90</a>
  </div>
</div>


  <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-0">All Source Files</a></h3></div>
  <div id="allfiles-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


</div>

    </div>
    <div class="col-md-9" id='text'>


    <h3>This File Depends On</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefileheatbalancehamtmanagerf90EfferentGraph" width="641pt" height="396pt"
 viewBox="0.00 0.00 641.00 395.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph" class="graph" transform="scale(.4806 .4806) rotate(0) translate(4 818.8974)">
<title>sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-818.8974 1329.6741,-818.8974 1329.6741,4 -4,4"/>
<!-- sourcefile~heatbalancehamtmanager.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~heatbalancehamtmanager.f90</title>
<polygon fill="none" stroke="#000000" points="1325.7998,-372.3818 1165.2974,-372.3818 1165.2974,-350.371 1325.7998,-350.371 1325.7998,-372.3818"/>
<text text-anchor="middle" x="1245.5486" y="-358.2264" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">HeatBalanceHAMTManager.f90</text>
</g>
<!-- sourcefile~datamoisturebalance.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~datamoisturebalance.f90</title>
<g id="a_sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node2"><a xlink:href="../sourcefile/datamoisturebalance.f90.html" xlink:title="DataMoistureBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="820.3223,-760.3818 690.5234,-760.3818 690.5234,-738.371 820.3223,-738.371 820.3223,-760.3818"/>
<text text-anchor="middle" x="755.4229" y="-746.2264" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataMoistureBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datamoisturebalance.f90&#45;&gt;sourcefile~heatbalancehamtmanager.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge69" class="edge">
<title>sourcefile~datamoisturebalance.f90&#45;&gt;sourcefile~heatbalancehamtmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M820.7093,-748.2825C850.6645,-748.0617 886.6386,-748.1913 918.9895,-749.3764"/>
</g>
<!-- sourcefile~general.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~general.f90</title>
<g id="a_sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node3"><a xlink:href="../sourcefile/general.f90.html" xlink:title="General.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="788.7916,-212.3818 722.0541,-212.3818 722.0541,-190.371 788.7916,-190.371 788.7916,-212.3818"/>
<text text-anchor="middle" x="755.4229" y="-198.2264" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">General.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~heatbalancehamtmanager.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge70" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~heatbalancehamtmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M778.482,-212.5007C810.4307,-228.075 869.7872,-257.5958 918.9895,-285.3764"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M918.9895,-285.3764C944.9423,-300.0299 954.647,-296.6697 981.6064,-309.3764 1024.0601,-329.3859 1027.865,-350.477 1073.5148,-361.3764"/>
</g>
<!-- sourcefile~psychroutines.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~psychroutines.f90</title>
<g id="a_sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node6"><a xlink:href="../sourcefile/psychroutines.f90.html" xlink:title="PsychRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1123.0636,-279.3818 1023.9659,-279.3818 1023.9659,-257.371 1123.0636,-257.371 1123.0636,-279.3818"/>
<text text-anchor="middle" x="1073.5148" y="-265.2264" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PsychRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M766.4056,-190.0559C797.1413,-158.966 884.054,-75.2272 918.9895,-85.3764"/>
</g>
<!-- sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~dataenvironment.f90</title>
<g id="a_sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node9"><a xlink:href="../sourcefile/dataenvironment.f90.html" xlink:title="DataEnvironment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="974.1275,-173.3818 863.8515,-173.3818 863.8515,-151.371 974.1275,-151.371 974.1275,-173.3818"/>
<text text-anchor="middle" x="918.9895" y="-159.2264" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEnvironment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M788.9177,-193.3901C810.1935,-188.3171 838.2623,-181.6246 862.8781,-175.7553"/>
<polygon fill="#002eff" stroke="#002eff" points="863.9136,-179.1066 872.8291,-173.3826 862.29,-172.2975 863.9136,-179.1066"/>
</g>
<!-- sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~dataheatbalance.f90</title>
<g id="a_sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node10"><a xlink:href="../sourcefile/dataheatbalance.f90.html" xlink:title="DataHeatBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1129.3316,-411.3818 1017.698,-411.3818 1017.698,-389.371 1129.3316,-389.371 1129.3316,-411.3818"/>
<text text-anchor="middle" x="1073.5148" y="-397.2264" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M918.9895,-285.3764C970.6605,-314.5509 967.9759,-342.8517 1017.6064,-375.3764 1022.9756,-378.895 1028.9219,-382.1445 1034.8744,-385.056"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="1033.6057,-388.3253 1044.1516,-389.3433 1036.5423,-381.9711 1033.6057,-388.3253"/>
</g>
<!-- sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~datasurfaces.f90</title>
<g id="a_sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node4"><a xlink:href="../sourcefile/datasurfaces.f90.html" xlink:title="DataSurfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="632.3482,-685.3818 539.0902,-685.3818 539.0902,-663.371 632.3482,-663.371 632.3482,-685.3818"/>
<text text-anchor="middle" x="585.7192" y="-671.2264" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSurfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~heatbalancehamtmanager.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge71" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~heatbalancehamtmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M918.9895,-749.3764C987.6214,-751.8906 1018.4077,-790.3626 1073.5148,-749.3764"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1073.5148,-749.3764C1199.2712,-655.8443 1234.8148,-449.8976 1243.2414,-382.8986"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1246.747,-383.0558 1244.4438,-372.7144 1239.7953,-382.235 1246.747,-383.0558"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.4229,-672.3764C835.7708,-672.0258 838.6947,-746.4349 918.9895,-749.3764"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M594.8266,-663.106C609.374,-644.593 637.8986,-606.1218 654.4731,-569.3764 710.9104,-444.2559 742.1183,-280.6187 751.9675,-222.765"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="755.4621,-223.0868 753.6537,-212.6475 748.5573,-221.936 755.4621,-223.0868"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M632.5381,-673.638C666.6164,-673.146 713.8783,-672.5577 755.4229,-672.3764"/>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M755.4229,-672.3764C835.5825,-672.0266 850.5257,-638.0705 918.9895,-596.3764"/>
</g>
<!-- sourcefile~dataheatbalsurface.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~dataheatbalsurface.f90</title>
<g id="a_sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node5"><a xlink:href="../sourcefile/dataheatbalsurface.f90.html" xlink:title="DataHeatBalSurface.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="981.7236,-799.3818 856.2554,-799.3818 856.2554,-777.371 981.7236,-777.371 981.7236,-799.3818"/>
<text text-anchor="middle" x="918.9895" y="-785.2264" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalSurface.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~heatbalancehamtmanager.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge72" class="edge">
<title>sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~heatbalancehamtmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M981.6885,-783.7056C1011.8479,-778.8347 1047.0953,-769.026 1073.5148,-749.3764"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~heatbalancehamtmanager.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge73" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~heatbalancehamtmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1093.9249,-279.4099C1124.189,-295.7704 1181.13,-326.5523 1215.9662,-345.3844"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1214.7037,-348.6806 1225.165,-350.3572 1218.0326,-342.5227 1214.7037,-348.6806"/>
</g>
<!-- sourcefile~dataglobals.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~dataglobals.f90</title>
<g id="a_sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node7"><a xlink:href="../sourcefile/dataglobals.f90.html" xlink:title="DataGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="267.6355,-527.3818 180.0456,-527.3818 180.0456,-505.371 267.6355,-505.371 267.6355,-527.3818"/>
<text text-anchor="middle" x="223.8406" y="-513.2264" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~heatbalancehamtmanager.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge74" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~heatbalancehamtmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M918.9895,-361.3764C946.7864,-341.2146 1040.0085,-353.8602 1073.5148,-361.3764"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M585.7192,-555.3764C725.4281,-512.1903 750.1588,-292.7349 754.5046,-222.8107"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="758.0127,-222.7533 755.0571,-212.5791 751.0229,-222.3758 758.0127,-222.7533"/>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M399.0839,-555.3764C481.9024,-560.0285 506.47,-579.8735 585.7192,-555.3764"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M399.0839,-555.3764C436.3837,-557.4716 451.8142,-551.0124 480.9653,-574.3764 509.8167,-597.5002 489.5617,-624.554 516.9653,-649.3764 521.0249,-653.0535 525.6677,-656.2012 530.5823,-658.8935"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="529.1263,-662.077 539.6544,-663.2638 532.1642,-655.7706 529.1263,-662.077"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M755.4229,-596.3764C880.3148,-571.9757 815.9799,-436.0919 918.9895,-361.3764"/>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M585.7192,-555.3764C657.8506,-526.7779 679.2688,-611.2549 755.4229,-596.3764"/>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M918.9895,-361.3764C960.398,-331.3418 1011.8879,-301.7659 1043.7275,-284.2954"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="1045.4466,-287.3446 1052.5534,-279.4869 1042.0976,-281.1978 1045.4466,-287.3446"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M585.7192,-555.3764C679.5672,-526.3665 857.6528,-257.9228 906.3889,-182.186"/>
<polygon fill="#002eff" stroke="#002eff" points="909.4681,-183.8678 911.9157,-173.5596 903.574,-180.0916 909.4681,-183.8678"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M755.4229,-596.3764C826.7702,-582.4369 857.1017,-634.5163 918.9895,-596.3764"/>
</g>
<!-- sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~inputprocessor.f90</title>
<g id="a_sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node11"><a xlink:href="../sourcefile/inputprocessor.f90.html" xlink:title="InputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="635.2783,-387.3818 536.1602,-387.3818 536.1602,-365.371 635.2783,-365.371 635.2783,-387.3818"/>
<text text-anchor="middle" x="585.7192" y="-373.2264" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">InputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge62" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M257.9555,-527.4379C292.936,-537.9534 349.1372,-552.5708 399.0839,-555.3764"/>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M399.0839,-555.3764C436.3837,-557.4716 450.335,-557.7645 480.9653,-536.3764 532.0322,-500.7181 564.5072,-431.4032 578.2164,-396.9058"/>
<polygon fill="#e700ff" stroke="#e700ff" points="581.5517,-397.9834 581.8683,-387.3933 575.0168,-395.4745 581.5517,-397.9834"/>
</g>
<!-- sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~datahvacglobals.f90</title>
<g id="a_sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node14"><a xlink:href="../sourcefile/datahvacglobals.f90.html" xlink:title="DataHVACGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="456.7769,-211.3818 341.3908,-211.3818 341.3908,-189.371 456.7769,-189.371 456.7769,-211.3818"/>
<text text-anchor="middle" x="399.0839" y="-197.2264" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHVACGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M231.045,-505.2771C243.0492,-486.3319 267.2043,-446.2217 281.2024,-409.3764 305.7048,-344.8819 278.5736,-315.5403 317.2024,-258.3764 329.3002,-240.4738 348.8959,-226.3039 365.8843,-216.4522"/>
<polygon fill="#ff0000" stroke="#ff0000" points="367.9259,-219.3232 374.9899,-211.427 364.5436,-213.1946 367.9259,-219.3232"/>
</g>
<!-- sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~dataipshortcuts.f90</title>
<g id="a_sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node15"><a xlink:href="../sourcefile/dataipshortcuts.f90.html" xlink:title="DataIPShortCuts.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="453.3838,-367.3818 344.7839,-367.3818 344.7839,-345.371 453.3838,-345.371 453.3838,-367.3818"/>
<text text-anchor="middle" x="399.0839" y="-353.2264" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataIPShortCuts.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M232.6868,-505.2419C248.5059,-485.6849 283.1797,-444.3943 317.2024,-414.3764 334.5068,-399.1089 355.8273,-384.1118 372.3741,-373.1933"/>
<polygon fill="#7fff00" stroke="#7fff00" points="374.5445,-375.9569 381.0199,-367.5713 370.7285,-370.0885 374.5445,-375.9569"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~dataruntimelanguage.f90</title>
<g id="a_sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node16"><a xlink:href="../sourcefile/dataruntimelanguage.f90.html" xlink:title="DataRuntimeLanguage.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="654.2279,-173.3818 517.2105,-173.3818 517.2105,-151.371 654.2279,-151.371 654.2279,-173.3818"/>
<text text-anchor="middle" x="585.7192" y="-159.2264" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRuntimeLanguage.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M229.9953,-505.1969C240.6369,-485.8015 263.0756,-444.6128 281.2024,-409.3764 297.7508,-377.2082 288.8548,-358.8499 317.2024,-336.3764 375.7523,-289.9589 425.9197,-348.9002 480.9653,-298.3764 519.1738,-263.3066 480.9424,-224.6876 516.9653,-187.3764 520.37,-183.8499 524.3108,-180.8186 528.5485,-178.2132"/>
<polygon fill="#00ffff" stroke="#00ffff" points="530.3784,-181.205 537.5878,-173.4413 527.1104,-175.0146 530.3784,-181.205"/>
</g>
<!-- sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~databsdfwindow.f90</title>
<g id="a_sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node19"><a xlink:href="../sourcefile/databsdfwindow.f90.html" xlink:title="DataBSDFWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="457.5516,-724.3818 340.6161,-724.3818 340.6161,-702.371 457.5516,-702.371 457.5516,-724.3818"/>
<text text-anchor="middle" x="399.0839" y="-710.2264" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBSDFWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M229.4606,-527.4459C242.4575,-552.3293 276.6049,-613.7575 317.2024,-655.3764 333.0083,-671.5799 353.8638,-686.2769 370.5709,-696.8223"/>
<polygon fill="#00ffff" stroke="#00ffff" points="369.0167,-699.9755 379.3674,-702.2369 372.6861,-694.0143 369.0167,-699.9755"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~datacomplexfenestration.f90</title>
<g id="a_sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node20"><a xlink:href="../sourcefile/datacomplexfenestration.f90.html" xlink:title="DataComplexFenestration.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="475.0737,-605.3818 323.0941,-605.3818 323.0941,-583.371 475.0737,-583.371 475.0737,-605.3818"/>
<text text-anchor="middle" x="399.0839" y="-591.2264" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataComplexFenestration.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M240.8033,-527.5242C259.0764,-539.1655 289.2956,-557.369 317.2024,-569.3764 326.5207,-573.3858 336.6903,-577.0342 346.5949,-580.2293"/>
<polygon fill="#ff0000" stroke="#ff0000" points="345.7816,-583.6416 356.37,-583.2697 347.8608,-576.9575 345.7816,-583.6416"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node21" class="node">
<title>sourcefile~dataequivalentlayerwindow.f90</title>
<g id="a_sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node21"><a xlink:href="../sourcefile/dataequivalentlayerwindow.f90.html" xlink:title="DataEquivalentLayerWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="480.847,-646.3818 317.3208,-646.3818 317.3208,-624.371 480.847,-624.371 480.847,-646.3818"/>
<text text-anchor="middle" x="399.0839" y="-632.2264" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEquivalentLayerWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M231.1309,-527.4098C245.2264,-547.8405 278.2824,-591.5545 317.2024,-614.3764 321.1546,-616.6939 325.3605,-618.7584 329.6996,-620.5973"/>
<polygon fill="#00ffff" stroke="#00ffff" points="328.7733,-623.9895 339.3643,-624.2729 331.2616,-617.4467 328.7733,-623.9895"/>
</g>
<!-- sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node22" class="node">
<title>sourcefile~sortandstringutilities.f90</title>
<g id="a_sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node22"><a xlink:href="../sourcefile/sortandstringutilities.f90.html" xlink:title="SortAndStringUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.3044,-527.3818 334.8633,-527.3818 334.8633,-505.371 463.3044,-505.371 463.3044,-527.3818"/>
<text text-anchor="middle" x="399.0839" y="-513.2264" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SortAndStringUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge53" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M267.6098,-516.3764C284.8758,-516.3764 305.2027,-516.3764 324.6437,-516.3764"/>
<polygon fill="#ff0000" stroke="#ff0000" points="324.7084,-519.8765 334.7083,-516.3764 324.7083,-512.8765 324.7084,-519.8765"/>
</g>
<!-- sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node23" class="node">
<title>sourcefile~dataoutputs.f90</title>
<g id="a_sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node23"><a xlink:href="../sourcefile/dataoutputs.f90.html" xlink:title="DataOutputs.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="443.5485,-486.3818 354.6193,-486.3818 354.6193,-464.371 443.5485,-464.371 443.5485,-486.3818"/>
<text text-anchor="middle" x="399.0839" y="-472.2264" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataOutputs.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge54" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M267.6098,-506.1361C290.9546,-500.6744 319.8949,-493.9035 344.6753,-488.1058"/>
<polygon fill="#7fff00" stroke="#7fff00" points="345.7158,-491.457 354.6555,-485.7709 344.1211,-484.6411 345.7158,-491.457"/>
</g>
<!-- sourcefile~datasizing.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node24" class="node">
<title>sourcefile~datasizing.f90</title>
<g id="a_sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node24"><a xlink:href="../sourcefile/datasizing.f90.html" xlink:title="DataSizing.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="439.3754,-445.3818 358.7923,-445.3818 358.7923,-423.371 439.3754,-423.371 439.3754,-445.3818"/>
<text text-anchor="middle" x="399.0839" y="-431.2264" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSizing.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge55" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M237.5558,-505.3194C255.0571,-491.7223 286.7258,-468.8004 317.2024,-455.3764 327.0748,-451.0279 338.0288,-447.4452 348.6292,-444.5471"/>
<polygon fill="#00ffff" stroke="#00ffff" points="349.823,-447.8541 358.6374,-441.9756 348.0809,-441.0743 349.823,-447.8541"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~dataheatbalfansys.f90</title>
<g id="a_sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node8"><a xlink:href="../sourcefile/dataheatbalfansys.f90.html" xlink:title="DataHeatBalFanSys.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="817.5676,-801.3818 693.2781,-801.3818 693.2781,-779.371 817.5676,-779.371 817.5676,-801.3818"/>
<text text-anchor="middle" x="755.4229" y="-787.2264" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalFanSys.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~heatbalancehamtmanager.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge75" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~heatbalancehamtmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M789.9789,-779.2957C830.1522,-766.8445 894.122,-748.4654 918.9895,-749.3764"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~heatbalancehamtmanager.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge76" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~heatbalancehamtmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M925.1276,-173.4969C947.692,-213.7827 1027.1402,-350.3039 1073.5148,-361.3764"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1073.5148,-361.3764C1099.6607,-367.619 1128.686,-369.4722 1155.3345,-369.2508"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1155.4851,-372.7487 1165.4204,-369.0691 1155.359,-365.7498 1155.4851,-372.7487"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M935.2344,-173.5199C962.2909,-192.08 1016.7567,-229.4419 1048.663,-251.3288"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="1046.7963,-254.2926 1057.0225,-257.0632 1050.756,-248.5202 1046.7963,-254.2926"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge50" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M926.2972,-173.4592C938.8031,-192.7555 964.602,-234.0372 981.6064,-271.3764 1001.8785,-315.8908 984.5608,-339.3142 1017.6064,-375.3764 1020.6796,-378.73 1024.2869,-381.661 1028.1641,-384.2168"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="1026.5577,-387.3296 1036.9804,-389.2314 1030.0185,-381.245 1026.5577,-387.3296"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~heatbalancehamtmanager.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge77" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~heatbalancehamtmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1122.3526,-389.3049C1142.5053,-384.7363 1166.0295,-379.4033 1187.0894,-374.6291"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1187.9079,-378.0324 1196.8866,-372.408 1186.3602,-371.2056 1187.9079,-378.0324"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~heatbalancehamtmanager.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge78" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~heatbalancehamtmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M635.3985,-366.3813C724.5874,-350.293 917.1412,-324.0405 1073.5148,-361.3764"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M596.5931,-365.1631C625.0218,-335.8472 701.7951,-256.6779 737.1482,-220.2214"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="739.9709,-222.3382 744.4199,-212.7227 734.9457,-217.4651 739.9709,-222.3382"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge51" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M918.9895,-596.3764C990.4811,-550.9828 1042.8761,-460.6656 1063.6653,-420.473"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="1066.8683,-421.8951 1068.2622,-411.3923 1060.6229,-418.7335 1066.8683,-421.8951"/>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M596.6311,-387.4442C646.5214,-437.4518 853.2921,-638.0909 918.9895,-596.3764"/>
</g>
<!-- sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~datainterfaces.f90</title>
<g id="a_sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node12"><a xlink:href="../sourcefile/datainterfaces.f90.html" xlink:title="DataInterfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="447.8836,-95.3818 350.2841,-95.3818 350.2841,-73.371 447.8836,-73.371 447.8836,-95.3818"/>
<text text-anchor="middle" x="399.0839" y="-81.2264" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataInterfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~heatbalancehamtmanager.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge79" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~heatbalancehamtmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-47.3764C761.9788,-49.5424 822.6129,4.7365 981.6064,-71.3764 1109.6242,-132.6607 1204.1829,-286.4614 1234.8754,-341.4456"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1231.8239,-343.1603 1239.7065,-350.2395 1237.959,-339.7897 1231.8239,-343.1603"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M433.7632,-73.3444C470.9351,-62.5036 531.8764,-47.5511 585.7192,-47.3764"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M448.2041,-92.9324C486.071,-99.9388 539.5878,-110.7349 585.7192,-123.3764"/>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M585.7192,-123.3764C616.2946,-131.755 626.7398,-127.0167 654.4731,-142.3764 673.4607,-152.8924 672.0991,-163.8219 690.4731,-175.3764 697.2688,-179.6498 704.8848,-183.4497 712.4446,-186.7357"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="711.3438,-190.0671 721.9242,-190.6201 713.998,-183.5897 711.3438,-190.0671"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M585.7192,-47.3764C618.0823,-47.7741 626.0456,-55.9037 654.4731,-71.3764 672.2766,-81.0666 672.7581,-89.5254 690.4731,-99.3764 717.3687,-114.3325 725.3346,-116.9146 755.4229,-123.3764"/>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M755.4229,-123.3764C828.3914,-139.0471 847.3203,-64.5556 918.9895,-85.3764"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M755.4229,-123.3764C792.1236,-131.2583 833.2218,-141.0615 865.0408,-148.8674"/>
<polygon fill="#002eff" stroke="#002eff" points="864.4815,-152.3342 875.0283,-151.3267 866.1552,-145.5372 864.4815,-152.3342"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M755.4229,-123.3764C854.0541,-144.5584 907.8386,-73.5644 981.6064,-142.3764 1058.2292,-213.8516 954.0423,-292.0736 1017.6064,-375.3764 1020.0755,-378.6122 1023.0564,-381.4393 1026.3407,-383.9076"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="1024.6772,-386.9954 1035.0111,-389.3323 1028.39,-381.0611 1024.6772,-386.9954"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge67" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M448.1631,-91.2992C460.1035,-95.0073 472.0009,-100.6862 480.9653,-109.3764 516.689,-144.007 499.1825,-168.9089 516.9653,-215.3764 536.5826,-266.6371 562.7358,-325.6928 576.4422,-356.0383"/>
<polygon fill="#e700ff" stroke="#e700ff" points="573.2683,-357.5141 580.5858,-365.176 579.6434,-354.6232 573.2683,-357.5141"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M445.7231,-95.4115C457.5586,-99.0683 470.0154,-103.694 480.9653,-109.3764 498.9568,-118.7129 499.2247,-127.5715 516.9653,-137.3764 523.9217,-141.221 531.5854,-144.6799 539.1951,-147.7119"/>
<polygon fill="#00ffff" stroke="#00ffff" points="538.1561,-151.0607 548.7477,-151.3209 540.6301,-144.5125 538.1561,-151.0607"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~dataprecisionglobals.f90</title>
<g id="a_sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node13"><a xlink:href="../sourcefile/dataprecisionglobals.f90.html" xlink:title="DataPrecisionGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="130.719,-606.3818 -.2403,-606.3818 -.2403,-584.371 130.719,-584.371 130.719,-606.3818"/>
<text text-anchor="middle" x="65.2394" y="-592.2264" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPrecisionGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datamoisturebalance.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datamoisturebalance.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-790.3764C608.9674,-788.9773 665.46,-774.4827 706.905,-763.1195"/>
<polygon fill="#ff0000" stroke="#ff0000" points="707.8494,-766.4898 716.5578,-760.4553 705.987,-759.7421 707.8494,-766.4898"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M399.0839,-123.3764C482.0329,-123.4505 505.7196,-101.4539 585.7192,-123.3764"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M223.8406,-674.3764C330.2894,-693.1149 457.0972,-686.6678 528.8258,-680.4233"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="529.3546,-683.8899 539.0001,-679.5064 528.7263,-676.9181 529.3546,-683.8899"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalsurface.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalsurface.f90</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M585.7192,-790.3764C633.0319,-787.5291 643.2856,-805.9121 690.4731,-810.3764 747.9496,-815.8141 762.9868,-816.6996 820.3726,-810.3764 836.3922,-808.6112 853.6152,-805.2794 869.1145,-801.7329"/>
<polygon fill="#5cff00" stroke="#5cff00" points="870.0973,-805.097 879.0208,-799.3856 868.4833,-798.2856 870.0973,-805.097"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M223.8406,-123.3764C467.4033,67.4525 621.8578,.9439 918.9895,-85.3764"/>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M67.3085,-584.0838C79.6122,-518.2362 145.2845,-184.6552 223.8406,-123.3764"/>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M918.9895,-85.3764C947.0621,-94.9115 958.944,-89.2608 981.6064,-108.3764 1005.3209,-128.3793 1045.7636,-209.7062 1064.0457,-248.11"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="1060.9522,-249.7558 1068.3882,-257.3028 1067.2816,-246.7659 1060.9522,-249.7558"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90</title>
<path fill="none" stroke="#00ffb9" stroke-dasharray="5,2" d="M87.6267,-584.2252C115.0201,-570.5804 161.5639,-547.3967 192.5044,-531.9851"/>
<polygon fill="#00ffb9" stroke="#00ffb9" points="194.1766,-535.0624 201.5672,-527.4709 191.0556,-528.7966 194.1766,-535.0624"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalfansys.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalfansys.f90</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M585.7192,-790.3764C617.4197,-788.4686 652.5115,-788.1674 682.5185,-788.4581"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="682.8647,-791.9625 692.9064,-788.5839 682.9496,-784.963 682.8647,-791.9625"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M223.8406,-123.3764C285.1499,-75.3412 321.198,-123.3068 399.0839,-123.3764"/>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M399.0839,-123.3764C512.7606,-123.4779 546.9493,-72.4841 654.4731,-109.3764 673.6458,-115.9547 671.6872,-129.7638 690.4731,-137.3764 742.5072,-158.4621 806.3597,-163.923 853.3287,-164.5642"/>
<polygon fill="#002eff" stroke="#002eff" points="853.3604,-168.0644 863.3837,-164.6317 853.4075,-161.0645 853.3604,-168.0644"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M585.7192,-790.3764C617.9999,-788.0348 627.1805,-783.7729 654.4731,-766.3764 673.8208,-754.044 670.8158,-741.2089 690.4731,-729.3764 716.2413,-713.8655 728.7021,-724.1816 755.4229,-710.3764"/>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M69.9588,-606.4429C81.8829,-632.9835 115.9149,-700.4864 166.4788,-733.3764 240.041,-781.2261 584.9395,-790.433 585.7192,-790.3764"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge61" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M223.8406,-395.3764C249.1009,-380.4787 429.536,-377.2031 525.7044,-376.5228"/>
<polygon fill="#e700ff" stroke="#e700ff" points="525.892,-380.0218 535.8695,-376.4584 525.8475,-373.0219 525.892,-380.0218"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge68" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90</title>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M223.8406,-123.3764C256.6952,-97.6351 303.1282,-88.1525 339.9446,-84.9625"/>
<polygon fill="#ff008b" stroke="#ff008b" points="340.3371,-88.4432 350.0544,-84.2213 339.8252,-81.462 340.3371,-88.4432"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-123.3764C248.6377,-103.9481 332.8203,-155.5278 374.8286,-183.5967"/>
<polygon fill="#ff0000" stroke="#ff0000" points="373.1092,-186.659 383.3544,-189.3583 377.0287,-180.8592 373.1092,-186.659"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M223.8406,-395.3764C257.4389,-375.5612 300.0672,-365.7994 334.8675,-360.997"/>
<polygon fill="#7fff00" stroke="#7fff00" points="335.4508,-364.4511 344.9281,-359.7149 334.5658,-357.5072 335.4508,-364.4511"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-123.3764C449.5254,-123.4214 506.0448,-137.2312 543.5342,-148.403"/>
<polygon fill="#00ffff" stroke="#00ffff" points="542.5247,-151.7542 553.1107,-151.3231 544.5664,-145.0585 542.5247,-151.7542"/>
</g>
<!-- sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~datavectortypes.f90</title>
<g id="a_sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node18"><a xlink:href="../sourcefile/datavectortypes.f90.html" xlink:title="DataVectorTypes.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="278.8255,-724.3818 168.8556,-724.3818 168.8556,-702.371 278.8255,-702.371 278.8255,-724.3818"/>
<text text-anchor="middle" x="223.8406" y="-710.2264" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataVectorTypes.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M74.9141,-606.3947C91.9021,-625.2175 128.8739,-663.8995 166.4788,-688.3764 171.9159,-691.9154 177.9378,-695.1637 183.9759,-698.0644"/>
<polygon fill="#ff0000" stroke="#ff0000" points="182.8422,-701.3931 193.3957,-702.3283 185.7288,-695.016 182.8422,-701.3931"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-674.3764C264.631,-681.5568 310.292,-691.791 344.7768,-699.974"/>
<polygon fill="#00ffff" stroke="#00ffff" points="344.1073,-703.4124 354.6469,-702.3324 345.7341,-696.6041 344.1073,-703.4124"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-674.3764C272.1826,-682.8862 272.1329,-634.8215 317.2024,-615.3764 323.2682,-612.7593 329.7326,-610.4133 336.2678,-608.3239"/>
<polygon fill="#ff0000" stroke="#ff0000" points="337.2845,-611.6731 345.8552,-605.4447 335.271,-604.9689 337.2845,-611.6731"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M79.9511,-606.4011C106.7958,-625.6351 166.2784,-664.2436 223.8406,-674.3764"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-674.3764C248.4742,-678.7127 311.1012,-662.2824 354.3995,-649.4201"/>
<polygon fill="#00ffff" stroke="#00ffff" points="355.5706,-652.7228 364.1387,-646.4908 353.5544,-646.0195 355.5706,-652.7228"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge56" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-395.3764C234.8689,-388.8723 303.9345,-406.7841 351.9922,-420.4488"/>
<polygon fill="#00ffff" stroke="#00ffff" points="351.3224,-423.8978 361.8998,-423.2899 353.252,-417.169 351.3224,-423.8978"/>
</g>
<!-- sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node25" class="node">
<title>sourcefile~datasystemvariables.f90</title>
<g id="a_sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node25"><a xlink:href="../sourcefile/datasystemvariables.f90.html" xlink:title="DataSystemVariables.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.7837,-289.3818 334.3841,-289.3818 334.3841,-267.371 463.7837,-267.371 463.7837,-289.3818"/>
<text text-anchor="middle" x="399.0839" y="-275.2264" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSystemVariables.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge58" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M70.513,-583.9123C87.2562,-548.9401 142.9182,-443.1016 223.8406,-395.3764"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M223.8406,-395.3764C274.0191,-365.7828 267.1525,-333.187 317.2024,-303.3764 324.1021,-299.2668 331.7368,-295.7783 339.4889,-292.8318"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="340.6886,-296.1201 348.9615,-289.5011 338.3667,-289.5164 340.6886,-296.1201"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M456.8256,-203.8234C493.7746,-205.2551 542.6799,-205.7134 585.7192,-201.3764"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M451.8667,-345.338C462.031,-341.8413 472.2225,-337.2864 480.9653,-331.3764 542.4389,-289.8209 511.8917,-208.8159 585.7192,-201.3764"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge63" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M453.3172,-362.1881C476.0991,-364.6294 502.6742,-367.4772 526.0122,-369.9781"/>
<polygon fill="#e700ff" stroke="#e700ff" points="525.8215,-373.4777 536.1375,-371.0632 526.5674,-366.5175 525.8215,-373.4777"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M633.8955,-173.4479C658.5037,-179.1032 688.2081,-185.9296 712.0895,-191.4178"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="711.4062,-194.852 721.936,-193.6807 712.974,-188.0298 711.4062,-194.852"/>
</g>
<!-- sourcefile~datastringglobals.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~datastringglobals.f90</title>
<g id="a_sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_node17"><a xlink:href="../sourcefile/datastringglobals.f90.html" xlink:title="DataStringGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="281.0645,-250.3818 166.6166,-250.3818 166.6166,-228.371 281.0645,-228.371 281.0645,-250.3818"/>
<text text-anchor="middle" x="223.8406" y="-236.2264" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataStringGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M236.2858,-228.1966C253.1782,-213.8517 284.9714,-189.7071 317.2024,-180.3764 387.1153,-160.137 408.5376,-173.1881 480.9653,-180.3764 528.2168,-185.066 538.4749,-206.1372 585.7192,-201.3764"/>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M585.7192,-201.3764C628.303,-196.5709 677.281,-197.2261 711.6401,-198.6881"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="711.6584,-202.1927 721.8107,-199.1626 711.9847,-195.2003 711.6584,-202.1927"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge65" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M281.1973,-231.7262C335.536,-227.1353 417.9723,-227.2233 480.9653,-258.3764 524.6764,-279.9936 558.2487,-328.6032 574.6471,-356.2139"/>
<polygon fill="#e700ff" stroke="#e700ff" points="571.6973,-358.1053 579.7196,-365.0258 577.764,-354.613 571.6973,-358.1053"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge57" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M273.5895,-250.4479C294.1182,-255.0165 318.0812,-260.3494 339.534,-265.1237"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="338.9925,-268.5888 349.5141,-267.3447 340.5132,-261.7559 338.9925,-268.5888"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M254.7189,-724.4267C289.3717,-735.84 347.5011,-752.0416 399.0839,-752.3764"/>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M399.0839,-752.3764C461.9449,-752.7844 528.1481,-714.4854 562.285,-691.4104"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="564.411,-694.1956 570.6431,-685.6276 560.4281,-688.4391 564.411,-694.1956"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M399.0839,-752.3764C482.0312,-752.9147 502.969,-758.1165 585.7192,-752.3764"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M278.8078,-713.3764C295.1003,-713.3764 313.1505,-713.3764 330.2066,-713.3764"/>
<polygon fill="#00ffff" stroke="#00ffff" points="330.6733,-716.8765 340.6733,-713.3764 330.6733,-709.8765 330.6733,-716.8765"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M452.0668,-702.3049C476.1254,-697.2775 504.613,-691.3246 529.0936,-686.2091"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="529.8893,-689.6185 538.9619,-684.147 528.4574,-682.7665 529.8893,-689.6185"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M439.023,-724.3902C484.9876,-736.5911 557.7327,-754.3177 585.7192,-752.3764"/>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M585.7192,-752.3764C595.4084,-751.7043 746.794,-714.8345 755.4229,-710.3764"/>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M755.4229,-710.3764C782.7637,-696.2508 794.0862,-702.379 820.3726,-686.3764 871.0575,-655.5205 868.4735,-627.5081 918.9895,-596.3764"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M585.7192,-635.3764C734.6504,-643.0911 791.6191,-673.9444 918.9895,-596.3764"/>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M442.7234,-605.4242C488.7889,-616.8231 558.4339,-633.2368 585.7192,-635.3764"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge52" class="edge">
<title>sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M480.956,-632.611C513.5949,-632.2299 551.4783,-632.6914 585.7192,-635.3764"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge59" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M459.8088,-505.2228C467.2183,-502.6002 474.4595,-499.3653 480.9653,-495.3764 522.5252,-469.8947 556.7207,-422.7103 573.8484,-396.0513"/>
<polygon fill="#e700ff" stroke="#e700ff" points="576.8335,-397.8789 579.1789,-387.547 570.9023,-394.1612 576.8335,-397.8789"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge60" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M443.5343,-467.3054C455.9943,-464.1626 469.3116,-459.9419 480.9653,-454.3764 513.8743,-438.6599 546.7813,-411.9027 566.6985,-394.182"/>
<polygon fill="#e700ff" stroke="#e700ff" points="569.0962,-396.7325 574.1572,-387.4245 564.3964,-391.5449 569.0962,-396.7325"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge64" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M435.3826,-423.3691C449.6062,-419.0362 466.0593,-413.9997 480.9653,-409.3764 500.7249,-403.2477 522.5522,-396.3862 541.145,-390.514"/>
<polygon fill="#e700ff" stroke="#e700ff" points="542.3455,-393.8052 550.8254,-387.4537 540.2355,-387.1308 542.3455,-393.8052"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~EfferentGraph_edge66" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M420.1305,-289.4277C453.2628,-306.8251 517.7133,-340.6673 555.6978,-360.6125"/>
<polygon fill="#e700ff" stroke="#e700ff" points="554.2687,-363.8152 564.7495,-365.3654 557.523,-357.6176 554.2687,-363.8152"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefileheatbalancehamtmanagerf90EfferentGraph = svgPanZoom('#sourcefileheatbalancehamtmanagerf90EfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <h3>Files Dependent On This One</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~heatbalancehamtmanager.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefileheatbalancehamtmanagerf90AfferentGraph" width="641pt" height="48pt"
 viewBox="0.00 0.00 641.00 47.72" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~heatbalancehamtmanager.f90~~AfferentGraph" class="graph" transform="scale(.6674 .6674) rotate(0) translate(4 67.5)">
<title>sourcefile~~heatbalancehamtmanager.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-67.5 956.4495,-67.5 956.4495,4 -4,4"/>
<!-- sourcefile~heatbalancehamtmanager.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~heatbalancehamtmanager.f90</title>
<polygon fill="none" stroke="#000000" points="160.3767,-22.2554 -.1257,-22.2554 -.1257,-.2446 160.3767,-.2446 160.3767,-22.2554"/>
<text text-anchor="middle" x="80.1255" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">HeatBalanceHAMTManager.f90</text>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~heatbalancesurfacemanager.f90</title>
<g id="a_sourcefile~~heatbalancehamtmanager.f90~~AfferentGraph_node2"><a xlink:href="../sourcefile/heatbalancesurfacemanager.f90.html" xlink:title="HeatBalanceSurfaceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="362.7869,-22.2554 196.4055,-22.2554 196.4055,-.2446 362.7869,-.2446 362.7869,-22.2554"/>
<text text-anchor="middle" x="279.5962" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceSurfaceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalancehamtmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~heatbalancehamtmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M160.3956,-11.25C168.8769,-11.25 177.5536,-11.25 186.1672,-11.25"/>
<polygon fill="#ff0000" stroke="#ff0000" points="186.2346,-14.7501 196.2345,-11.25 186.2345,-7.7501 186.2346,-14.7501"/>
</g>
<!-- sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~heatbalancemanager.f90</title>
<g id="a_sourcefile~~heatbalancehamtmanager.f90~~AfferentGraph_node3"><a xlink:href="../sourcefile/heatbalancemanager.f90.html" xlink:title="HeatBalanceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="529.1989,-42.2554 399.1883,-42.2554 399.1883,-20.2446 529.1989,-20.2446 529.1989,-42.2554"/>
<text text-anchor="middle" x="464.1936" y="-28.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M362.9838,-20.2845C371.7054,-21.2295 380.5342,-22.186 389.1546,-23.12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="388.8408,-26.6064 399.1596,-24.204 389.5948,-19.6471 388.8408,-26.6064"/>
</g>
<!-- sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~simulationmanager.f90</title>
<g id="a_sourcefile~~heatbalancehamtmanager.f90~~AfferentGraph_node4"><a xlink:href="../sourcefile/simulationmanager.f90.html" xlink:title="SimulationManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="820.0321,-42.2554 700.2216,-42.2554 700.2216,-20.2446 820.0321,-20.2446 820.0321,-42.2554"/>
<text text-anchor="middle" x="760.1268" y="-28.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SimulationManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M362.8001,-6.3275C440.9148,-2.8699 560.9188,-.5502 664.4246,-11.25 678.148,-12.6687 692.8047,-15.2026 706.4184,-18.0007"/>
<polygon fill="#ff0000" stroke="#ff0000" points="706.0819,-21.5078 716.5929,-20.1777 707.5466,-14.6628 706.0819,-21.5078"/>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M510.0326,-42.2702C527.2934,-45.8995 547.1669,-49.462 565.4458,-51.25 609.2274,-55.5326 620.6672,-55.7734 664.4246,-51.25 678.148,-49.8313 692.8047,-47.2974 706.4184,-44.4993"/>
<polygon fill="#ff0000" stroke="#ff0000" points="707.5466,-47.8372 716.5929,-42.3223 706.0819,-40.9922 707.5466,-47.8372"/>
</g>
<!-- sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~sizingmanager.f90</title>
<g id="a_sourcefile~~heatbalancehamtmanager.f90~~AfferentGraph_node5"><a xlink:href="../sourcefile/sizingmanager.f90.html" xlink:title="SizingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="664.4139,-42.2554 565.4564,-42.2554 565.4564,-20.2446 664.4139,-20.2446 664.4139,-42.2554"/>
<text text-anchor="middle" x="614.9352" y="-28.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SizingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M529.4343,-31.25C537.9197,-31.25 546.5795,-31.25 554.973,-31.25"/>
<polygon fill="#ff0000" stroke="#ff0000" points="555.0495,-34.7501 565.0495,-31.25 555.0495,-27.7501 555.0495,-34.7501"/>
</g>
<!-- sourcefile~energyplus.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~energyplus.f90</title>
<g id="a_sourcefile~~heatbalancehamtmanager.f90~~AfferentGraph_node6"><a xlink:href="../sourcefile/energyplus.f90.html" xlink:title="EnergyPlus.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="945.8478,-63.2554 862.4308,-63.2554 862.4308,-41.2446 945.8478,-41.2446 945.8478,-63.2554"/>
<text text-anchor="middle" x="904.1393" y="-49.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EnergyPlus.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M819.95,-39.9735C830.6146,-41.5286 841.6464,-43.1372 852.0727,-44.6576"/>
<polygon fill="#00ffff" stroke="#00ffff" points="851.8608,-48.1637 862.2612,-46.1433 852.8709,-41.2369 851.8608,-48.1637"/>
</g>
<!-- sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~utilityroutines.f90</title>
<g id="a_sourcefile~~heatbalancehamtmanager.f90~~AfferentGraph_node7"><a xlink:href="../sourcefile/utilityroutines.f90.html" xlink:title="UtilityRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="952.2604,-22.2554 856.0182,-22.2554 856.0182,-.2446 952.2604,-.2446 952.2604,-22.2554"/>
<text text-anchor="middle" x="904.1393" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">UtilityRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M819.95,-22.942C828.4109,-21.7669 837.103,-20.5598 845.5404,-19.388"/>
<polygon fill="#00ffff" stroke="#00ffff" points="846.2499,-22.8232 855.6734,-17.9808 845.2869,-15.8897 846.2499,-22.8232"/>
</g>
<!-- sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~heatbalancehamtmanager.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M664.4958,-31.25C672.7622,-31.25 681.4731,-31.25 690.1345,-31.25"/>
<polygon fill="#ff0000" stroke="#ff0000" points="690.25,-34.7501 700.25,-31.25 690.2499,-27.7501 690.25,-34.7501"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefileheatbalancehamtmanagerf90AfferentGraph = svgPanZoom('#sourcefileheatbalancehamtmanagerf90AfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <br>

    <section class="visible-xs visible-sm hidden-md">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/heatbalancehamtmanager.html">HeatBalanceHAMTManager</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html#src">HeatBalanceHAMTManager.f90</a>
  </div>
</div>


    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">MODULE </span><span class="n">HeatBalanceHAMTManager</span>
<a name="ln-2"></a>
<a name="ln-3"></a>
<a name="ln-4"></a>  <span class="c">! MODULE INFORMATION:</span>
<a name="ln-5"></a>  <span class="c">!       AUTHOR      Phillip Biddulph</span>
<a name="ln-6"></a>  <span class="c">!       DATE WRITTEN   June 2008</span>
<a name="ln-7"></a>  <span class="c">!       MODIFIED</span>
<a name="ln-8"></a>  <span class="c">!       Bug fixes to make sure HAMT can cope with data limits  ! PDB August 2009</span>
<a name="ln-9"></a>  <span class="c">!       RE-ENGINEERED</span>
<a name="ln-10"></a>  <span class="c">!</span>
<a name="ln-11"></a>
<a name="ln-12"></a>
<a name="ln-13"></a>  <span class="c">! PURPOSE OF THIS MODULE:</span>
<a name="ln-14"></a>  <span class="c">! Calculate, record and report the one dimentional heat and moisture transfer</span>
<a name="ln-15"></a>  <span class="c">! through a surface given the material composition of the building surface and</span>
<a name="ln-16"></a>  <span class="c">! the external and internal Temperatures and Relative Humidities.</span>
<a name="ln-17"></a>
<a name="ln-18"></a>  <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-19"></a>  <span class="c">! Each surface is split into &quot;cells&quot;, where all characteristics are initiallised.</span>
<a name="ln-20"></a>  <span class="c">! Cells are matched and links created in the initialisation routine.</span>
<a name="ln-21"></a>  <span class="c">! The internal and external &quot;surfaces&quot; of the surface are virtual cells to allow for the</span>
<a name="ln-22"></a>  <span class="c">! input of heat and vapor via heat transfer coefficients, radiation,</span>
<a name="ln-23"></a>  <span class="c">! and vapor transfer coefficients</span>
<a name="ln-24"></a>  <span class="c">! Uses Forward (implicit) finite difference alogorithm. Heat transfer is caclulated first,</span>
<a name="ln-25"></a>  <span class="c">! with the option of including the latent heat, then liquid and vapor transfer. The process is ittereated.</span>
<a name="ln-26"></a>  <span class="c">! Once the temperatures have converged the internal surface</span>
<a name="ln-27"></a>  <span class="c">! temperature and vapor densities are passed back to EnergyPlus.</span>
<a name="ln-28"></a>
<a name="ln-29"></a>  <span class="c">! Temperatures and relative humidities are updated once EnergyPlus has checked that</span>
<a name="ln-30"></a>  <span class="c">! the zone temperatures have converged.</span>
<a name="ln-31"></a>
<a name="ln-32"></a>  <span class="c">! REFERENCES:</span>
<a name="ln-33"></a>  <span class="c">! K?zel, H.M. (1995) Simultaneous Heat and Moisture Transport in Building Components.</span>
<a name="ln-34"></a>  <span class="c">! One- and two-dimensional calculation using simple parameters. IRB Verlag 1995</span>
<a name="ln-35"></a>  <span class="c">!</span>
<a name="ln-36"></a>  <span class="c">! Holman, J.P. (2002) Heat Transfer, Ninth Edition. McGraw-Hill</span>
<a name="ln-37"></a>  <span class="c">!</span>
<a name="ln-38"></a>  <span class="c">! Winterton, R.H.S. (1997) Heat Transfer. (Oxford Chemistry Primers; 50) Oxford University Press</span>
<a name="ln-39"></a>  <span class="c">!</span>
<a name="ln-40"></a>  <span class="c">! Kumar Kumaran, M. (1996) IEA ANNEX 24, Final Report, Volume 3</span>
<a name="ln-41"></a>
<a name="ln-42"></a>
<a name="ln-43"></a>  <span class="c">! USE STATEMENTS:</span>
<a name="ln-44"></a>
<a name="ln-45"></a>  <span class="k">USE </span><span class="n">DataGlobals</span>
<a name="ln-46"></a>  <span class="k">USE </span><span class="n">DataMoistureBalance</span>
<a name="ln-47"></a>  <span class="k">USE </span><span class="n">DataSurfaces</span>
<a name="ln-48"></a>  <span class="k">USE </span><span class="n">DataHeatBalSurface</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">QRadSWOutAbs</span><span class="p">,</span><span class="n">QRadSWInAbs</span><span class="p">,</span><span class="n">NetLWRadToSurf</span><span class="p">,</span><span class="n">MaxSurfaceTempLimit</span><span class="p">,</span><span class="n">MaxSurfaceTempLimitBeforeFatal</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-49"></a>                                <span class="n">MinSurfaceTempLimit</span><span class="p">,</span><span class="n">MinSurfaceTempLimitBeforeFatal</span>
<a name="ln-50"></a>  <span class="k">USE </span><span class="n">DataHeatBalance</span>
<a name="ln-51"></a>  <span class="k">USE </span><span class="n">Psychrometrics</span>
<a name="ln-52"></a>  <span class="k">USE </span><span class="n">DataHeatBalFanSys</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">Mat</span><span class="p">,</span><span class="n">QHtRadSysSurf</span><span class="p">,</span> <span class="n">QHWBaseboardSurf</span><span class="p">,</span> <span class="n">QSteamBaseboardSurf</span><span class="p">,</span> <span class="n">QElecBaseboardSurf</span>
<a name="ln-53"></a>  <span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SkyTemp</span><span class="p">,</span>  <span class="n">SunIsUp</span><span class="p">,</span> <span class="n">OutBaroPress</span><span class="p">,</span> <span class="n">OutEnthalpy</span><span class="p">,</span> <span class="n">IsRain</span>
<a name="ln-54"></a>  <span class="k">USE </span><span class="n">DataInterfaces</span>
<a name="ln-55"></a>
<a name="ln-56"></a>
<a name="ln-57"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables</span>
<a name="ln-58"></a>
<a name="ln-59"></a>  <span class="k">PRIVATE</span> <span class="c">! Everything private unless explicitly made public</span>
<a name="ln-60"></a>
<a name="ln-61"></a>  <span class="c">! MODULE PARAMETER DEFINITIONS:</span>
<a name="ln-62"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ittermax</span><span class="o">=</span><span class="mi">150</span> <span class="c">! Maximum Number of itterations</span>
<a name="ln-63"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span>  <span class="n">adjmax</span><span class="o">=</span><span class="mi">6</span>    <span class="c">! Maximum Number of Adjacent Cells</span>
<a name="ln-64"></a>
<a name="ln-65"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">wdensity</span><span class="o">=</span><span class="mi">100</span><span class="mf">0.d0</span>   <span class="c">! Density of water kg.m-3</span>
<a name="ln-66"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">wspech</span><span class="o">=</span><span class="mi">418</span><span class="mf">0.d0</span>     <span class="c">! Specific Heat Capacity of Water J.kg-1.K-1 (at 20C)</span>
<a name="ln-67"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">whv</span><span class="o">=</span><span class="mi">248900</span><span class="mf">0.d0</span>     <span class="c">! Evaporation enthalpy of water J.kg-1</span>
<a name="ln-68"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">convt</span><span class="o">=</span><span class="mf">0.002d0</span>     <span class="c">! Temperature convergence limit</span>
<a name="ln-69"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">qvplim</span><span class="o">=</span><span class="mi">10000</span><span class="mf">0.d0</span>   <span class="c">! Maximum latent heat W</span>
<a name="ln-70"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">rhmax</span><span class="o">=</span><span class="mf">1.01d0</span>      <span class="c">! Maximum RH value</span>
<a name="ln-71"></a>
<a name="ln-72"></a>  <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-73"></a>  <span class="k">TYPE</span> <span class="kd">::</span> <span class="n">subcell</span>
<a name="ln-74"></a>
<a name="ln-75"></a>     <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">matid</span><span class="o">=-</span><span class="mi">1</span>                  <span class="c">! Material Id Number</span>
<a name="ln-76"></a>     <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">sid</span><span class="o">=-</span><span class="mi">1</span>                    <span class="c">! Surface Id Number</span>
<a name="ln-77"></a>     <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Qadds</span><span class="o">=</span><span class="mf">0.0d0</span>            <span class="c">! Additional sources of heat</span>
<a name="ln-78"></a>     <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">density</span><span class="o">=-</span><span class="mf">1.0d0</span>         <span class="c">! Density</span>
<a name="ln-79"></a>     <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">wthermalc</span><span class="o">=</span><span class="mf">0.0d0</span>        <span class="c">! Moisture Dependant Thermal Conductivity</span>
<a name="ln-80"></a>     <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">spech</span><span class="o">=</span><span class="mf">0.0d0</span>            <span class="c">! Specific Heat capacity</span>
<a name="ln-81"></a>     <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">htc</span><span class="o">=-</span><span class="mf">1.0d0</span>             <span class="c">! Heat Transfer Coefficient</span>
<a name="ln-82"></a>     <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vtc</span><span class="o">=-</span><span class="mf">1.0d0</span>             <span class="c">! Vapor Transfer Coefficient</span>
<a name="ln-83"></a>     <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">mu</span><span class="o">=-</span><span class="mf">1.0d0</span>              <span class="c">! Vapor Diffusion resistance Factor</span>
<a name="ln-84"></a>     <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">volume</span><span class="o">=</span><span class="mf">0.0d0</span>           <span class="c">! Cell Volume</span>
<a name="ln-85"></a>     <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">temp</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-86"></a>     <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tempp1</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-87"></a>     <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tempp2</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-88"></a>     <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">wreport</span><span class="o">=</span><span class="mf">0.0d0</span>          <span class="c">! Water content for reporting</span>
<a name="ln-89"></a>     <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">water</span><span class="o">=</span><span class="mf">0.0d0</span>            <span class="c">! Water Content of cells</span>
<a name="ln-90"></a>     <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vp</span><span class="o">=</span><span class="mf">0.0d0</span>               <span class="c">! Vapor Pressure</span>
<a name="ln-91"></a>     <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vpp1</span><span class="o">=</span><span class="mf">0.0d0</span>             <span class="c">! Vapor Pressure</span>
<a name="ln-92"></a>     <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vpsat</span><span class="o">=</span><span class="mf">0.0d0</span>            <span class="c">! Saturation Vapor Pressure</span>
<a name="ln-93"></a>     <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rh</span><span class="o">=</span><span class="mf">0.1d0</span>
<a name="ln-94"></a>     <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhp1</span><span class="o">=</span><span class="mf">0.1d0</span>
<a name="ln-95"></a>     <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhp2</span><span class="o">=</span><span class="mf">0.1d0</span>             <span class="c">! Relative Humidity</span>
<a name="ln-96"></a>     <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhp</span><span class="o">=</span><span class="mi">1</span><span class="mf">0.d0</span>              <span class="c">! cell relative humidity (percent - reporting)</span>
<a name="ln-97"></a>     <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dwdphi</span><span class="o">=-</span><span class="mf">1.0d0</span>                  <span class="c">! Moisture storage capacity</span>
<a name="ln-98"></a>     <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dw</span><span class="o">=-</span><span class="mf">1.0d0</span>                      <span class="c">! Liquid transport Coefficient</span>
<a name="ln-99"></a>     <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">origin</span><span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Cell origin. The geometric centre of the cell.</span>
<a name="ln-100"></a>     <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">length</span><span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Cell lengths</span>
<a name="ln-101"></a>     <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="kd">::</span> <span class="n">overlap</span><span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Area of overlap</span>
<a name="ln-102"></a>     <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dist</span><span class="o">=</span><span class="mf">0.0d0</span>   <span class="c">! distance between cell origins</span>
<a name="ln-103"></a>     <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="kd">::</span> <span class="n">adjs</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-104"></a>     <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="kd">::</span> <span class="n">adjsl</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-105"></a>  <span class="k">END TYPE </span><span class="n">subcell</span>
<a name="ln-106"></a>
<a name="ln-107"></a>  <span class="k">TYPE</span> <span class="p">(</span><span class="n">subcell</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">cells</span>
<a name="ln-108"></a>
<a name="ln-109"></a>
<a name="ln-110"></a>  <span class="c">! MODULE VARIABLE DECLARATIONS:</span>
<a name="ln-111"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">firstcell</span>
<a name="ln-112"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">lastcell</span>
<a name="ln-113"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">Extcell</span>
<a name="ln-114"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">ExtRadcell</span>
<a name="ln-115"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">ExtConcell</span>
<a name="ln-116"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">ExtSkycell</span>
<a name="ln-117"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">ExtGrncell</span>
<a name="ln-118"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">Intcell</span>
<a name="ln-119"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">IntConcell</span>
<a name="ln-120"></a>
<a name="ln-121"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">watertot</span>
<a name="ln-122"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">surfrh</span>
<a name="ln-123"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">surfextrh</span>
<a name="ln-124"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">surftemp</span>
<a name="ln-125"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">surfexttemp</span>
<a name="ln-126"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">surfvp</span>
<a name="ln-127"></a>
<a name="ln-128"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">extvtc</span>  <span class="c">! External Surface vapor transfer coefficient</span>
<a name="ln-129"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">intvtc</span>  <span class="c">! Internal Surface Vapor Transfer Coefficient</span>
<a name="ln-130"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">extvtcflag</span>  <span class="c">! External Surface vapor transfer coefficient flag</span>
<a name="ln-131"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">intvtcflag</span>  <span class="c">! Internal Surface Vapor Transfer Coefficient flag</span>
<a name="ln-132"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">MyEnvrnFlag</span> <span class="c">! Flag to reset surface properties.</span>
<a name="ln-133"></a>
<a name="ln-134"></a>
<a name="ln-135"></a>
<a name="ln-136"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">deltat</span><span class="o">=</span><span class="mf">0.0d0</span>            <span class="c">! time step in seconds</span>
<a name="ln-137"></a>
<a name="ln-138"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotCellsMax</span><span class="o">=</span><span class="mi">0</span>         <span class="c">! Maximum number of cells per material</span>
<a name="ln-139"></a>
<a name="ln-140"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">latswitch</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">! latent heat switch,</span>
<a name="ln-141"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">rainswitch</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">! rain switch,</span>
<a name="ln-142"></a>
<a name="ln-143"></a>
<a name="ln-144"></a>  <span class="c">! SUBROUTINE SPECIFICATIONS FOR MODULE HeatBalanceHAMTManager:</span>
<a name="ln-145"></a>
<a name="ln-146"></a>  <span class="k">PUBLIC </span><span class="n">ManageHeatBalHAMT</span>
<a name="ln-147"></a>  <span class="k">PUBLIC </span><span class="n">UpdateHeatBalHAMT</span>
<a name="ln-148"></a>
<a name="ln-149"></a>  <span class="k">PRIVATE </span><span class="n">GetHeatBalHAMTInput</span>
<a name="ln-150"></a>  <span class="k">PRIVATE </span><span class="n">InitHeatBalHAMT</span>
<a name="ln-151"></a>  <span class="k">PRIVATE </span><span class="n">CalcHeatBalHAMT</span>
<a name="ln-152"></a>
<a name="ln-153"></a><span class="k">CONTAINS</span>
<a name="ln-154"></a><span class="k">  SUBROUTINE </span><span class="n">ManageHeatBalHAMT</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">TempSurfInTmp</span><span class="p">,</span><span class="n">TempSurfOutTmp</span><span class="p">)</span>
<a name="ln-155"></a>
<a name="ln-156"></a>    <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-157"></a>    <span class="c">!       AUTHOR         Phillip Biddulph</span>
<a name="ln-158"></a>    <span class="c">!       DATE WRITTEN   June 2008</span>
<a name="ln-159"></a>    <span class="c">!       MODIFIED       na</span>
<a name="ln-160"></a>    <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-161"></a>
<a name="ln-162"></a>    <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-163"></a>    <span class="c">! Manages the Heat and Moisture Transfer calculations.</span>
<a name="ln-164"></a>
<a name="ln-165"></a>    <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-166"></a>    <span class="c">! na</span>
<a name="ln-167"></a>
<a name="ln-168"></a>    <span class="c">! REFERENCES:</span>
<a name="ln-169"></a>    <span class="c">! na</span>
<a name="ln-170"></a>
<a name="ln-171"></a>    <span class="c">! USE STATEMENTS:</span>
<a name="ln-172"></a>    <span class="c">! na</span>
<a name="ln-173"></a>
<a name="ln-174"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-175"></a>
<a name="ln-176"></a>    <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-177"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">In</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfNum</span>
<a name="ln-178"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TempSurfInTmp</span>
<a name="ln-179"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TempSurfOutTmp</span>
<a name="ln-180"></a>
<a name="ln-181"></a>
<a name="ln-182"></a>    <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-183"></a>    <span class="c">! na</span>
<a name="ln-184"></a>
<a name="ln-185"></a>    <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-186"></a>    <span class="c">! na</span>
<a name="ln-187"></a>
<a name="ln-188"></a>    <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-189"></a>    <span class="c">! na</span>
<a name="ln-190"></a>
<a name="ln-191"></a>    <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-192"></a>
<a name="ln-193"></a>    <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">SAVE</span> <span class="kd">::</span> <span class="n">OneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-194"></a>
<a name="ln-195"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">OneTimeFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-196"></a><span class="k">       </span><span class="n">OneTimeFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-197"></a>       <span class="k">CALL </span><span class="n">DisplayString</span><span class="p">(</span><span class="s1">&#39;Initialising Heat and Moisture Transfer Model&#39;</span><span class="p">)</span>
<a name="ln-198"></a>       <span class="k">CALL </span><span class="n">GetHeatBalHAMTInput</span>
<a name="ln-199"></a>       <span class="k">CALL </span><span class="n">InitHeatBalHAMT</span>
<a name="ln-200"></a>    <span class="n">ENDIF</span>
<a name="ln-201"></a>
<a name="ln-202"></a>    <span class="k">CALL </span><span class="n">CalcHeatBalHAMT</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">TempSurfInTmp</span><span class="p">,</span><span class="n">TempSurfOutTmp</span><span class="p">)</span>
<a name="ln-203"></a>
<a name="ln-204"></a>  <span class="k">END SUBROUTINE </span><span class="n">ManageHeatBalHAMT</span>
<a name="ln-205"></a>
<a name="ln-206"></a>  <span class="k">SUBROUTINE </span><span class="n">GetHeatBalHAMTInput</span>
<a name="ln-207"></a>
<a name="ln-208"></a>    <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-209"></a>    <span class="c">!       AUTHOR         Phillip Biddulph</span>
<a name="ln-210"></a>    <span class="c">!       DATE WRITTEN   June 2008</span>
<a name="ln-211"></a>    <span class="c">!       MODIFIED       na</span>
<a name="ln-212"></a>    <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-213"></a>
<a name="ln-214"></a>    <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-215"></a>    <span class="c">! gets input for the HAMT model</span>
<a name="ln-216"></a>
<a name="ln-217"></a>    <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-218"></a>    <span class="c">! na</span>
<a name="ln-219"></a>
<a name="ln-220"></a>    <span class="c">! REFERENCES:</span>
<a name="ln-221"></a>    <span class="c">! na</span>
<a name="ln-222"></a>
<a name="ln-223"></a>    <span class="c">! USE STATEMENTS:</span>
<a name="ln-224"></a>    <span class="k">USE </span><span class="n">InputProcessor</span>
<a name="ln-225"></a>
<a name="ln-226"></a>
<a name="ln-227"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-228"></a>
<a name="ln-229"></a>    <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-230"></a>    <span class="c">! na</span>
<a name="ln-231"></a>
<a name="ln-232"></a>    <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-233"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">cHAMTObject1</span><span class="o">=</span><span class="s1">&#39;MaterialProperty:HeatAndMoistureTransfer:Settings&#39;</span>
<a name="ln-234"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">cHAMTObject2</span><span class="o">=</span><span class="s1">&#39;MaterialProperty:HeatAndMoistureTransfer:SorptionIsotherm&#39;</span>
<a name="ln-235"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">cHAMTObject3</span><span class="o">=</span><span class="s1">&#39;MaterialProperty:HeatAndMoistureTransfer:Suction&#39;</span>
<a name="ln-236"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">cHAMTObject4</span><span class="o">=</span><span class="s1">&#39;MaterialProperty:HeatAndMoistureTransfer:Redistribution&#39;</span>
<a name="ln-237"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">cHAMTObject5</span><span class="o">=</span><span class="s1">&#39;MaterialProperty:HeatAndMoistureTransfer:Diffusion&#39;</span>
<a name="ln-238"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">cHAMTObject6</span><span class="o">=</span><span class="s1">&#39;MaterialProperty:HeatAndMoistureTransfer:ThermalConductivity&#39;</span>
<a name="ln-239"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">cHAMTObject7</span><span class="o">=</span><span class="s1">&#39;SurfaceProperties:VaporCoefficients&#39;</span>
<a name="ln-240"></a>
<a name="ln-241"></a>    <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-242"></a>    <span class="c">! na</span>
<a name="ln-243"></a>
<a name="ln-244"></a>    <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-245"></a>    <span class="c">! na</span>
<a name="ln-246"></a>
<a name="ln-247"></a>    <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-248"></a>
<a name="ln-249"></a>
<a name="ln-250"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:),</span><span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">AlphaArray</span>
<a name="ln-251"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:),</span><span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">cAlphaFieldNames</span>
<a name="ln-252"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:),</span><span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">cNumericFieldNames</span>
<a name="ln-253"></a>
<a name="ln-254"></a>    <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">DIMENSION</span><span class="p">(:),</span><span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">lAlphaBlanks</span>
<a name="ln-255"></a>    <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">DIMENSION</span><span class="p">(:),</span><span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">lNumericBlanks</span>
<a name="ln-256"></a>
<a name="ln-257"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:),</span><span class="k">ALLOCATABLE</span> <span class="kd">::</span>  <span class="n">NumArray</span>
<a name="ln-258"></a>
<a name="ln-259"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dumrh</span>
<a name="ln-260"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dumdata</span>
<a name="ln-261"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">avdata</span>
<a name="ln-262"></a>
<a name="ln-263"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MaxNums</span>
<a name="ln-264"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MaxAlphas</span>
<a name="ln-265"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumParams</span>
<a name="ln-266"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumNums</span>
<a name="ln-267"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumAlphas</span>
<a name="ln-268"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">status</span>
<a name="ln-269"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">matid</span>
<a name="ln-270"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">iso</span>
<a name="ln-271"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Numid</span>
<a name="ln-272"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">suc</span>
<a name="ln-273"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">red</span>
<a name="ln-274"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">mu</span>
<a name="ln-275"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">tc</span>
<a name="ln-276"></a><span class="c">!unused1208    INTEGER :: sid</span>
<a name="ln-277"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HAMTitems</span>
<a name="ln-278"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">item</span>
<a name="ln-279"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ii</span>
<a name="ln-280"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">jj</span>
<a name="ln-281"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">vtcsid</span>
<a name="ln-282"></a>
<a name="ln-283"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">avflag</span>
<a name="ln-284"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">isoerrrise</span>
<a name="ln-285"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ErrorsFound</span>
<a name="ln-286"></a>
<a name="ln-287"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">watertot</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-288"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">surfrh</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-289"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">surfextrh</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-290"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">surftemp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-291"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">surfexttemp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-292"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">surfvp</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-293"></a>
<a name="ln-294"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">firstcell</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-295"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">lastcell</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-296"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">Extcell</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-297"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ExtRadcell</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-298"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ExtConcell</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-299"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ExtSkycell</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-300"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ExtGrncell</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-301"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">Intcell</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-302"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">IntConcell</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-303"></a>
<a name="ln-304"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">extvtc</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-305"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">intvtc</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-306"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">extvtcflag</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-307"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">intvtcflag</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-308"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-309"></a>
<a name="ln-310"></a>    <span class="n">extvtc</span><span class="o">=-</span><span class="mf">1.0d0</span>
<a name="ln-311"></a>    <span class="n">intvtc</span><span class="o">=-</span><span class="mf">1.0d0</span>
<a name="ln-312"></a>    <span class="n">extvtcflag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-313"></a>    <span class="n">intvtcflag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-314"></a>    <span class="n">MyEnvrnFlag</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-315"></a>
<a name="ln-316"></a>    <span class="n">latswitch</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-317"></a>    <span class="n">rainswitch</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-318"></a>
<a name="ln-319"></a>    <span class="n">MaxAlphas</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-320"></a>    <span class="n">MaxNums</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-321"></a>    <span class="k">CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="n">cHAMTObject1</span><span class="p">,</span><span class="n">NumParams</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumNums</span><span class="p">)</span>
<a name="ln-322"></a>    <span class="n">MaxAlphas</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">)</span>
<a name="ln-323"></a>    <span class="n">MaxNums</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxNums</span><span class="p">,</span><span class="n">NumNums</span><span class="p">)</span>
<a name="ln-324"></a>    <span class="k">CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="n">cHAMTObject2</span><span class="p">,</span><span class="n">NumParams</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumNums</span><span class="p">)</span>
<a name="ln-325"></a>    <span class="n">MaxAlphas</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">)</span>
<a name="ln-326"></a>    <span class="n">MaxNums</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxNums</span><span class="p">,</span><span class="n">NumNums</span><span class="p">)</span>
<a name="ln-327"></a>    <span class="k">CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="n">cHAMTObject3</span><span class="p">,</span><span class="n">NumParams</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumNums</span><span class="p">)</span>
<a name="ln-328"></a>    <span class="n">MaxAlphas</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">)</span>
<a name="ln-329"></a>    <span class="n">MaxNums</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxNums</span><span class="p">,</span><span class="n">NumNums</span><span class="p">)</span>
<a name="ln-330"></a>    <span class="k">CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="n">cHAMTObject4</span><span class="p">,</span><span class="n">NumParams</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumNums</span><span class="p">)</span>
<a name="ln-331"></a>    <span class="n">MaxAlphas</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">)</span>
<a name="ln-332"></a>    <span class="n">MaxNums</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxNums</span><span class="p">,</span><span class="n">NumNums</span><span class="p">)</span>
<a name="ln-333"></a>    <span class="k">CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="n">cHAMTObject5</span><span class="p">,</span><span class="n">NumParams</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumNums</span><span class="p">)</span>
<a name="ln-334"></a>    <span class="n">MaxAlphas</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">)</span>
<a name="ln-335"></a>    <span class="n">MaxNums</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxNums</span><span class="p">,</span><span class="n">NumNums</span><span class="p">)</span>
<a name="ln-336"></a>    <span class="k">CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="n">cHAMTObject6</span><span class="p">,</span><span class="n">NumParams</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumNums</span><span class="p">)</span>
<a name="ln-337"></a>    <span class="n">MaxAlphas</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">)</span>
<a name="ln-338"></a>    <span class="n">MaxNums</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxNums</span><span class="p">,</span><span class="n">NumNums</span><span class="p">)</span>
<a name="ln-339"></a>    <span class="k">CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="n">cHAMTObject7</span><span class="p">,</span><span class="n">NumParams</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumNums</span><span class="p">)</span>
<a name="ln-340"></a>    <span class="n">MaxAlphas</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">)</span>
<a name="ln-341"></a>    <span class="n">MaxNums</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxNums</span><span class="p">,</span><span class="n">NumNums</span><span class="p">)</span>
<a name="ln-342"></a>
<a name="ln-343"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-344"></a>
<a name="ln-345"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">AlphaArray</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">))</span>
<a name="ln-346"></a>    <span class="n">AlphaArray</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-347"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">))</span>
<a name="ln-348"></a>    <span class="n">cAlphaFieldNames</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-349"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="n">MaxNums</span><span class="p">))</span>
<a name="ln-350"></a>    <span class="n">cNumericFieldNames</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-351"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="n">MaxNums</span><span class="p">))</span>
<a name="ln-352"></a>    <span class="n">NumArray</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-353"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">))</span>
<a name="ln-354"></a>    <span class="n">lAlphaBlanks</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-355"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">lNumericBlanks</span><span class="p">(</span><span class="n">MaxNums</span><span class="p">))</span>
<a name="ln-356"></a>    <span class="n">lNumericBlanks</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-357"></a>
<a name="ln-358"></a>    <span class="n">HAMTitems</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cHAMTObject1</span><span class="p">)</span>  <span class="c">! MaterialProperty:HeatAndMoistureTransfer:Settings</span>
<a name="ln-359"></a>    <span class="k">DO </span><span class="n">item</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">HAMTitems</span>
<a name="ln-360"></a>       <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cHAMTObject1</span><span class="p">,</span><span class="n">item</span><span class="p">,</span><span class="n">AlphaArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">status</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-361"></a>                       <span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericBlanks</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-362"></a>                       <span class="n">AlphaFieldNames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-363"></a>
<a name="ln-364"></a>       <span class="n">matid</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">AlphaArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Material</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotMaterials</span><span class="p">)</span>
<a name="ln-365"></a>
<a name="ln-366"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">matid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-367"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">cHAMTObject1</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphaArray</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-368"></a>             <span class="s1">&#39;&quot; is invalid (undefined).&#39;</span><span class="p">)</span>
<a name="ln-369"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The basic material must be defined in addition to specifying &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-370"></a>            <span class="s1">&#39;HeatAndMoistureTransfer properties.&#39;</span><span class="p">)</span>
<a name="ln-371"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-372"></a>          <span class="k">CYCLE</span>
<a name="ln-373"></a><span class="k">       </span><span class="n">ENDIF</span>
<a name="ln-374"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">ROnly</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-375"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">cHAMTObject1</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphaArray</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-376"></a>             <span class="s1">&#39;&quot; is defined as an R-only value material.&#39;</span><span class="p">)</span>
<a name="ln-377"></a>          <span class="k">CYCLE</span>
<a name="ln-378"></a><span class="k">       </span><span class="n">ENDIF</span>
<a name="ln-379"></a>
<a name="ln-380"></a>       <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">Porosity</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-381"></a>       <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">iwater</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-382"></a>
<a name="ln-383"></a>    <span class="n">ENDDO</span>
<a name="ln-384"></a>
<a name="ln-385"></a>    <span class="n">HAMTitems</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cHAMTObject2</span><span class="p">)</span> <span class="c">! MaterialProperty:HeatAndMoistureTransfer:SorptionIsotherm</span>
<a name="ln-386"></a>    <span class="k">DO </span><span class="n">item</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">HAMTitems</span>
<a name="ln-387"></a>       <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cHAMTObject2</span><span class="p">,</span><span class="n">item</span><span class="p">,</span><span class="n">AlphaArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">status</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-388"></a>                       <span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericBlanks</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-389"></a>                       <span class="n">AlphaFieldNames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-390"></a>
<a name="ln-391"></a>       <span class="n">matid</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">AlphaArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Material</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotMaterials</span><span class="p">)</span>
<a name="ln-392"></a>
<a name="ln-393"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">matid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-394"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">cHAMTObject2</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphaArray</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-395"></a>             <span class="s1">&#39;&quot; is invalid (undefined).&#39;</span><span class="p">)</span>
<a name="ln-396"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The basic material must be defined in addition to specifying &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-397"></a>            <span class="s1">&#39;HeatAndMoistureTransfer properties.&#39;</span><span class="p">)</span>
<a name="ln-398"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-399"></a>          <span class="k">CYCLE</span>
<a name="ln-400"></a><span class="k">       </span><span class="n">ENDIF</span>
<a name="ln-401"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">ROnly</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-402"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">cHAMTObject2</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphaArray</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-403"></a>             <span class="s1">&#39;&quot; is defined as an R-only value material.&#39;</span><span class="p">)</span>
<a name="ln-404"></a>          <span class="k">CYCLE</span>
<a name="ln-405"></a><span class="k">       </span><span class="n">ENDIF</span>
<a name="ln-406"></a>
<a name="ln-407"></a>       <span class="n">Numid</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-408"></a>
<a name="ln-409"></a>       <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">niso</span><span class="o">=</span><span class="nb">INT</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="n">Numid</span><span class="p">))</span>
<a name="ln-410"></a>
<a name="ln-411"></a>       <span class="k">DO </span><span class="n">iso</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">niso</span>
<a name="ln-412"></a>          <span class="n">Numid</span><span class="o">=</span><span class="n">Numid</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-413"></a>          <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">isorh</span><span class="p">(</span><span class="n">iso</span><span class="p">)</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="n">Numid</span><span class="p">)</span>
<a name="ln-414"></a>          <span class="n">Numid</span><span class="o">=</span><span class="n">Numid</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-415"></a>          <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">isodata</span><span class="p">(</span><span class="n">iso</span><span class="p">)</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="n">Numid</span><span class="p">)</span>
<a name="ln-416"></a>       <span class="n">ENDDO</span>
<a name="ln-417"></a>
<a name="ln-418"></a>       <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">niso</span><span class="o">=</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">niso</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-419"></a>       <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">isorh</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">niso</span><span class="p">)</span><span class="o">=</span><span class="n">rhmax</span>
<a name="ln-420"></a>       <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">isodata</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">niso</span><span class="p">)</span><span class="o">=</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">Porosity</span><span class="o">*</span><span class="n">wdensity</span>
<a name="ln-421"></a>
<a name="ln-422"></a>       <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">niso</span><span class="o">=</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">niso</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-423"></a>       <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">isorh</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">niso</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-424"></a>       <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">isodata</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">niso</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-425"></a>    <span class="n">ENDDO</span>
<a name="ln-426"></a>
<a name="ln-427"></a>
<a name="ln-428"></a>
<a name="ln-429"></a>    <span class="c">! check the isotherm</span>
<a name="ln-430"></a>    <span class="k">DO </span><span class="n">matid</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotMaterials</span>
<a name="ln-431"></a>       <span class="k">IF</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">niso</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-432"></a>          <span class="c">! - First sort</span>
<a name="ln-433"></a>          <span class="k">DO </span><span class="n">jj</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">niso</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-434"></a>             <span class="k">DO </span><span class="n">ii</span><span class="o">=</span><span class="n">jj</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">niso</span>
<a name="ln-435"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">isorh</span><span class="p">(</span><span class="n">jj</span><span class="p">)</span><span class="o">&gt;</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">isorh</span><span class="p">(</span><span class="n">ii</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-436"></a>
<a name="ln-437"></a><span class="k">                   </span><span class="n">dumrh</span><span class="o">=</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">isorh</span><span class="p">(</span><span class="n">jj</span><span class="p">)</span>
<a name="ln-438"></a>                   <span class="n">dumdata</span><span class="o">=</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">isodata</span><span class="p">(</span><span class="n">jj</span><span class="p">)</span>
<a name="ln-439"></a>
<a name="ln-440"></a>                   <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">isorh</span><span class="p">(</span><span class="n">jj</span><span class="p">)</span><span class="o">=</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">isorh</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span>
<a name="ln-441"></a>                   <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">isodata</span><span class="p">(</span><span class="n">jj</span><span class="p">)</span><span class="o">=</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">isodata</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span>
<a name="ln-442"></a>
<a name="ln-443"></a>                   <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">isorh</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="o">=</span><span class="n">dumrh</span>
<a name="ln-444"></a>                   <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">isodata</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="o">=</span><span class="n">dumdata</span>
<a name="ln-445"></a>
<a name="ln-446"></a>
<a name="ln-447"></a>                <span class="n">ENDIF</span>
<a name="ln-448"></a>             <span class="n">ENDDO</span>
<a name="ln-449"></a>          <span class="n">ENDDO</span>
<a name="ln-450"></a>          <span class="c">!- Now make sure the data rises</span>
<a name="ln-451"></a>          <span class="n">isoerrrise</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-452"></a>          <span class="k">DO </span><span class="n">ii</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span>
<a name="ln-453"></a>             <span class="n">avflag</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-454"></a>             <span class="k">DO </span><span class="n">jj</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">niso</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-455"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">isodata</span><span class="p">(</span><span class="n">jj</span><span class="p">)</span><span class="o">&gt;</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">isodata</span><span class="p">(</span><span class="n">jj</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-456"></a><span class="k">                   </span><span class="n">isoerrrise</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-457"></a>                   <span class="n">avdata</span><span class="o">=</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">isodata</span><span class="p">(</span><span class="n">jj</span><span class="p">)</span><span class="o">+</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">isodata</span><span class="p">(</span><span class="n">jj</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="mf">2.0d0</span>
<a name="ln-458"></a>                   <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">isodata</span><span class="p">(</span><span class="n">jj</span><span class="p">)</span><span class="o">=</span><span class="n">avdata</span>
<a name="ln-459"></a>                   <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">isodata</span><span class="p">(</span><span class="n">jj</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">avdata</span>
<a name="ln-460"></a>                   <span class="n">avflag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-461"></a>                <span class="n">ENDIF</span>
<a name="ln-462"></a>             <span class="n">ENDDO</span>
<a name="ln-463"></a>             <span class="k">IF</span><span class="p">(</span><span class="n">avflag</span><span class="p">)</span><span class="k">EXIT</span>
<a name="ln-464"></a><span class="k">          </span><span class="n">ENDDO</span>
<a name="ln-465"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">isoerrrise</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-466"></a><span class="k">             CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">cHAMTObject2</span><span class="o">//</span><span class="s1">&#39; data not rising - Check material &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-467"></a>             <span class="k">Call </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Isotherm data has been fixed, and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-468"></a>          <span class="n">ENDIF</span>
<a name="ln-469"></a>       <span class="n">ENDIF</span>
<a name="ln-470"></a>    <span class="n">ENDDO</span>
<a name="ln-471"></a>
<a name="ln-472"></a>
<a name="ln-473"></a>    <span class="n">HAMTitems</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cHAMTObject3</span><span class="p">)</span>  <span class="c">! MaterialProperty:HeatAndMoistureTransfer:Suction</span>
<a name="ln-474"></a>    <span class="k">DO </span><span class="n">item</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">HAMTitems</span>
<a name="ln-475"></a>       <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cHAMTObject3</span><span class="p">,</span><span class="n">item</span><span class="p">,</span><span class="n">AlphaArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">status</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-476"></a>                       <span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericBlanks</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-477"></a>                       <span class="n">AlphaFieldNames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-478"></a>
<a name="ln-479"></a>       <span class="n">matid</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">AlphaArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Material</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotMaterials</span><span class="p">)</span>
<a name="ln-480"></a>
<a name="ln-481"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">matid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-482"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">cHAMTObject3</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphaArray</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-483"></a>             <span class="s1">&#39;&quot; is invalid (undefined).&#39;</span><span class="p">)</span>
<a name="ln-484"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The basic material must be defined in addition to specifying &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-485"></a>            <span class="s1">&#39;HeatAndMoistureTransfer properties.&#39;</span><span class="p">)</span>
<a name="ln-486"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-487"></a>          <span class="k">CYCLE</span>
<a name="ln-488"></a><span class="k">       </span><span class="n">ENDIF</span>
<a name="ln-489"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">ROnly</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-490"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">cHAMTObject3</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphaArray</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-491"></a>             <span class="s1">&#39;&quot; is defined as an R-only value material.&#39;</span><span class="p">)</span>
<a name="ln-492"></a>          <span class="k">CYCLE</span>
<a name="ln-493"></a><span class="k">       </span><span class="n">ENDIF</span>
<a name="ln-494"></a>
<a name="ln-495"></a>       <span class="n">Numid</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-496"></a>
<a name="ln-497"></a>       <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">nsuc</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="n">Numid</span><span class="p">)</span>
<a name="ln-498"></a>       <span class="k">DO </span><span class="n">suc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">nsuc</span>
<a name="ln-499"></a>          <span class="n">Numid</span><span class="o">=</span><span class="n">Numid</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-500"></a>          <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">sucwater</span><span class="p">(</span><span class="n">suc</span><span class="p">)</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="n">Numid</span><span class="p">)</span>
<a name="ln-501"></a>          <span class="n">Numid</span><span class="o">=</span><span class="n">Numid</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-502"></a>          <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">sucdata</span><span class="p">(</span><span class="n">suc</span><span class="p">)</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="n">Numid</span><span class="p">)</span>
<a name="ln-503"></a>       <span class="n">ENDDO</span>
<a name="ln-504"></a>
<a name="ln-505"></a>       <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">nsuc</span><span class="o">=</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">nsuc</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-506"></a>       <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">sucwater</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">nsuc</span><span class="p">)</span><span class="o">=</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">isodata</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">niso</span><span class="p">)</span>
<a name="ln-507"></a>       <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">sucdata</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">nsuc</span><span class="p">)</span><span class="o">=</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">sucdata</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">nsuc</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-508"></a>
<a name="ln-509"></a>    <span class="n">ENDDO</span>
<a name="ln-510"></a>
<a name="ln-511"></a>
<a name="ln-512"></a>    <span class="n">HAMTitems</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cHAMTObject4</span><span class="p">)</span>  <span class="c">! MaterialProperty:HeatAndMoistureTransfer:Redistribution</span>
<a name="ln-513"></a>    <span class="k">DO </span><span class="n">item</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">HAMTitems</span>
<a name="ln-514"></a>       <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cHAMTObject4</span><span class="p">,</span><span class="n">item</span><span class="p">,</span><span class="n">AlphaArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">status</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-515"></a>                       <span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericBlanks</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-516"></a>                       <span class="n">AlphaFieldNames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-517"></a>
<a name="ln-518"></a>       <span class="n">matid</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">AlphaArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Material</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotMaterials</span><span class="p">)</span>
<a name="ln-519"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">matid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-520"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">cHAMTObject4</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphaArray</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-521"></a>             <span class="s1">&#39;&quot; is invalid (undefined).&#39;</span><span class="p">)</span>
<a name="ln-522"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The basic material must be defined in addition to specifying &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-523"></a>            <span class="s1">&#39;HeatAndMoistureTransfer properties.&#39;</span><span class="p">)</span>
<a name="ln-524"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-525"></a>          <span class="k">CYCLE</span>
<a name="ln-526"></a><span class="k">       </span><span class="n">ENDIF</span>
<a name="ln-527"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">ROnly</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-528"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">cHAMTObject4</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphaArray</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-529"></a>             <span class="s1">&#39;&quot; is defined as an R-only value material.&#39;</span><span class="p">)</span>
<a name="ln-530"></a>          <span class="k">CYCLE</span>
<a name="ln-531"></a><span class="k">       </span><span class="n">ENDIF</span>
<a name="ln-532"></a>       <span class="n">Numid</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-533"></a>
<a name="ln-534"></a>       <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">nred</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="n">Numid</span><span class="p">)</span>
<a name="ln-535"></a>       <span class="k">DO </span><span class="n">red</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">nred</span>
<a name="ln-536"></a>          <span class="n">Numid</span><span class="o">=</span><span class="n">Numid</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-537"></a>          <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">redwater</span><span class="p">(</span><span class="n">red</span><span class="p">)</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="n">Numid</span><span class="p">)</span>
<a name="ln-538"></a>          <span class="n">Numid</span><span class="o">=</span><span class="n">Numid</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-539"></a>          <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">reddata</span><span class="p">(</span><span class="n">red</span><span class="p">)</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="n">Numid</span><span class="p">)</span>
<a name="ln-540"></a>       <span class="n">ENDDO</span>
<a name="ln-541"></a>
<a name="ln-542"></a>       <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">nred</span><span class="o">=</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">nred</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-543"></a>       <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">redwater</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">nred</span><span class="p">)</span><span class="o">=</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">isodata</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">niso</span><span class="p">)</span>
<a name="ln-544"></a>       <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">reddata</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">nred</span><span class="p">)</span><span class="o">=</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">reddata</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">nred</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-545"></a>
<a name="ln-546"></a>    <span class="n">ENDDO</span>
<a name="ln-547"></a>
<a name="ln-548"></a>
<a name="ln-549"></a>    <span class="n">HAMTitems</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cHAMTObject5</span><span class="p">)</span>  <span class="c">! MaterialProperty:HeatAndMoistureTransfer:Diffusion</span>
<a name="ln-550"></a>    <span class="k">DO </span><span class="n">item</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">HAMTitems</span>
<a name="ln-551"></a>       <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cHAMTObject5</span><span class="p">,</span><span class="n">item</span><span class="p">,</span><span class="n">AlphaArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">status</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-552"></a>                       <span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericBlanks</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-553"></a>                       <span class="n">AlphaFieldNames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-554"></a>
<a name="ln-555"></a>       <span class="n">matid</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">AlphaArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Material</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotMaterials</span><span class="p">)</span>
<a name="ln-556"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">matid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-557"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">cHAMTObject5</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphaArray</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-558"></a>             <span class="s1">&#39;&quot; is invalid (undefined).&#39;</span><span class="p">)</span>
<a name="ln-559"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The basic material must be defined in addition to specifying &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-560"></a>            <span class="s1">&#39;HeatAndMoistureTransfer properties.&#39;</span><span class="p">)</span>
<a name="ln-561"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-562"></a>          <span class="k">CYCLE</span>
<a name="ln-563"></a><span class="k">       </span><span class="n">ENDIF</span>
<a name="ln-564"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">ROnly</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-565"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">cHAMTObject5</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphaArray</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-566"></a>             <span class="s1">&#39;&quot; is defined as an R-only value material.&#39;</span><span class="p">)</span>
<a name="ln-567"></a>          <span class="k">CYCLE</span>
<a name="ln-568"></a><span class="k">       </span><span class="n">ENDIF</span>
<a name="ln-569"></a>
<a name="ln-570"></a>       <span class="n">Numid</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-571"></a>
<a name="ln-572"></a>       <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">nmu</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="n">Numid</span><span class="p">)</span>
<a name="ln-573"></a>       <span class="k">IF</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">nmu</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-574"></a><span class="k">          DO </span><span class="n">mu</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">nmu</span>
<a name="ln-575"></a>             <span class="n">Numid</span><span class="o">=</span><span class="n">Numid</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-576"></a>             <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">murh</span><span class="p">(</span><span class="n">mu</span><span class="p">)</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="n">Numid</span><span class="p">)</span>
<a name="ln-577"></a>             <span class="n">Numid</span><span class="o">=</span><span class="n">Numid</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-578"></a>             <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">mudata</span><span class="p">(</span><span class="n">mu</span><span class="p">)</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="n">Numid</span><span class="p">)</span>
<a name="ln-579"></a>          <span class="n">ENDDO</span>
<a name="ln-580"></a>
<a name="ln-581"></a>          <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">nmu</span><span class="o">=</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">nmu</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-582"></a>          <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">murh</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">nmu</span><span class="p">)</span><span class="o">=</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">isorh</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">niso</span><span class="p">)</span>
<a name="ln-583"></a>          <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">mudata</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">nmu</span><span class="p">)</span><span class="o">=</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">mudata</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">nmu</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-584"></a>
<a name="ln-585"></a>       <span class="n">ENDIF</span>
<a name="ln-586"></a>    <span class="n">ENDDO</span>
<a name="ln-587"></a>
<a name="ln-588"></a>
<a name="ln-589"></a>    <span class="n">HAMTitems</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cHAMTObject6</span><span class="p">)</span>  <span class="c">! MaterialProperty:HeatAndMoistureTransfer:ThermalConductivity</span>
<a name="ln-590"></a>    <span class="k">DO </span><span class="n">item</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">HAMTitems</span>
<a name="ln-591"></a>       <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cHAMTObject6</span><span class="p">,</span><span class="n">item</span><span class="p">,</span><span class="n">AlphaArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">status</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-592"></a>                       <span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericBlanks</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-593"></a>                       <span class="n">AlphaFieldNames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-594"></a>
<a name="ln-595"></a>       <span class="n">matid</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">AlphaArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Material</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotMaterials</span><span class="p">)</span>
<a name="ln-596"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">matid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-597"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">cHAMTObject6</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphaArray</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-598"></a>             <span class="s1">&#39;&quot; is invalid (undefined).&#39;</span><span class="p">)</span>
<a name="ln-599"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The basic material must be defined in addition to specifying &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-600"></a>            <span class="s1">&#39;HeatAndMoistureTransfer properties.&#39;</span><span class="p">)</span>
<a name="ln-601"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-602"></a>          <span class="k">CYCLE</span>
<a name="ln-603"></a><span class="k">       </span><span class="n">ENDIF</span>
<a name="ln-604"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">ROnly</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-605"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">cHAMTObject6</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphaArray</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-606"></a>             <span class="s1">&#39;&quot; is defined as an R-only value material.&#39;</span><span class="p">)</span>
<a name="ln-607"></a>          <span class="k">CYCLE</span>
<a name="ln-608"></a><span class="k">       </span><span class="n">ENDIF</span>
<a name="ln-609"></a>       <span class="n">Numid</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-610"></a>
<a name="ln-611"></a>       <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">ntc</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="n">Numid</span><span class="p">)</span>
<a name="ln-612"></a>       <span class="k">IF</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">ntc</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-613"></a><span class="k">          DO </span><span class="n">tc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">ntc</span>
<a name="ln-614"></a>             <span class="n">Numid</span><span class="o">=</span><span class="n">Numid</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-615"></a>             <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">tcwater</span><span class="p">(</span><span class="n">tc</span><span class="p">)</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="n">Numid</span><span class="p">)</span>
<a name="ln-616"></a>             <span class="n">Numid</span><span class="o">=</span><span class="n">Numid</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-617"></a>             <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">tcdata</span><span class="p">(</span><span class="n">tc</span><span class="p">)</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="n">Numid</span><span class="p">)</span>
<a name="ln-618"></a>          <span class="n">ENDDO</span>
<a name="ln-619"></a>
<a name="ln-620"></a>          <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">ntc</span><span class="o">=</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">ntc</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-621"></a>          <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">tcwater</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">ntc</span><span class="p">)</span><span class="o">=</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">isodata</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">niso</span><span class="p">)</span>
<a name="ln-622"></a>          <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">tcdata</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">ntc</span><span class="p">)</span><span class="o">=</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">tcdata</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">ntc</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-623"></a>
<a name="ln-624"></a>       <span class="n">ENDIF</span>
<a name="ln-625"></a>    <span class="n">ENDDO</span>
<a name="ln-626"></a>
<a name="ln-627"></a>    <span class="c">! Vapor Transfer coefficients</span>
<a name="ln-628"></a>    <span class="n">HAMTitems</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cHAMTObject7</span><span class="p">)</span>  <span class="c">! SurfaceProperties:VaporCoefficients</span>
<a name="ln-629"></a>    <span class="k">DO </span><span class="n">item</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">HAMTitems</span>
<a name="ln-630"></a>       <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cHAMTObject7</span><span class="p">,</span><span class="n">item</span><span class="p">,</span><span class="n">AlphaArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">status</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-631"></a>                       <span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericBlanks</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-632"></a>                       <span class="n">AlphaFieldNames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-633"></a>
<a name="ln-634"></a>       <span class="n">vtcsid</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">AlphaArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Surface</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotSurfaces</span><span class="p">)</span>
<a name="ln-635"></a>       <span class="k">IF</span><span class="p">(</span><span class="n">vtcsid</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-636"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">cHAMTObject7</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphaArray</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-637"></a>             <span class="s1">&#39;&quot; is invalid (undefined).&#39;</span><span class="p">)</span>
<a name="ln-638"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The basic material must be defined in addition to specifying &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-639"></a>            <span class="s1">&#39;HeatAndMoistureTransfer properties.&#39;</span><span class="p">)</span>
<a name="ln-640"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-641"></a>          <span class="k">CYCLE</span>
<a name="ln-642"></a><span class="k">       </span><span class="n">ENDIF</span>
<a name="ln-643"></a>
<a name="ln-644"></a>       <span class="k">IF</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphaArray</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">==</span> <span class="s1">&#39;YES&#39;</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-645"></a><span class="k">          </span><span class="n">extvtcflag</span><span class="p">(</span><span class="n">vtcsid</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-646"></a>          <span class="n">extvtc</span><span class="p">(</span><span class="n">vtcsid</span><span class="p">)</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-647"></a>       <span class="n">ENDIF</span>
<a name="ln-648"></a>
<a name="ln-649"></a>       <span class="k">IF</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphaArray</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="o">==</span> <span class="s1">&#39;YES&#39;</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-650"></a><span class="k">          </span><span class="n">intvtcflag</span><span class="p">(</span><span class="n">vtcsid</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-651"></a>          <span class="n">intvtc</span><span class="p">(</span><span class="n">vtcsid</span><span class="p">)</span><span class="o">=</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-652"></a>       <span class="n">ENDIF</span>
<a name="ln-653"></a>
<a name="ln-654"></a>    <span class="n">ENDDO</span>
<a name="ln-655"></a>
<a name="ln-656"></a>    <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">AlphaArray</span><span class="p">)</span>
<a name="ln-657"></a>    <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">)</span>
<a name="ln-658"></a>    <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-659"></a>    <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">NumArray</span><span class="p">)</span>
<a name="ln-660"></a>    <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">)</span>
<a name="ln-661"></a>    <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">lNumericBlanks</span><span class="p">)</span>
<a name="ln-662"></a>
<a name="ln-663"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-664"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;GetHeatBalHAMTInput: Errors found getting input.  Program terminates.&#39;</span><span class="p">)</span>
<a name="ln-665"></a>    <span class="n">ENDIF</span>
<a name="ln-666"></a>
<a name="ln-667"></a>  <span class="k">END SUBROUTINE </span><span class="n">GetHeatBalHAMTInput</span>
<a name="ln-668"></a>
<a name="ln-669"></a>  <span class="k">SUBROUTINE </span><span class="n">InitHeatBalHAMT</span>
<a name="ln-670"></a>    <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-671"></a>    <span class="c">!       AUTHOR         Phillip Biddulph</span>
<a name="ln-672"></a>    <span class="c">!       DATE WRITTEN   June 2008</span>
<a name="ln-673"></a>    <span class="c">!       MODIFIED       B. Griffith, Aug 2012 for surface-specific algorithms</span>
<a name="ln-674"></a>    <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-675"></a>
<a name="ln-676"></a>    <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-677"></a>    <span class="c">! &lt;description&gt;</span>
<a name="ln-678"></a>
<a name="ln-679"></a>    <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-680"></a>    <span class="c">! &lt;description&gt;</span>
<a name="ln-681"></a>
<a name="ln-682"></a>    <span class="c">! REFERENCES:</span>
<a name="ln-683"></a>    <span class="c">! na</span>
<a name="ln-684"></a>
<a name="ln-685"></a>    <span class="c">! USE STATEMENTS:</span>
<a name="ln-686"></a>    <span class="k">USE </span><span class="n">General</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span><span class="p">,</span> <span class="n">ScanForReports</span><span class="p">,</span> <span class="n">RoundSigDigits</span>
<a name="ln-687"></a>
<a name="ln-688"></a>
<a name="ln-689"></a>
<a name="ln-690"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-691"></a>
<a name="ln-692"></a>    <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-693"></a>    <span class="c">! na</span>
<a name="ln-694"></a>
<a name="ln-695"></a>    <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-696"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">adjdist</span><span class="o">=</span><span class="mf">0.00005d0</span> <span class="c">! Allowable distance between two cells, also used as limit on cell length</span>
<a name="ln-697"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;InitCombinedHeatAndMoistureFiniteElement: &#39;</span>
<a name="ln-698"></a>
<a name="ln-699"></a>
<a name="ln-700"></a>    <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-701"></a>    <span class="c">! na</span>
<a name="ln-702"></a>
<a name="ln-703"></a>    <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-704"></a>    <span class="c">! na</span>
<a name="ln-705"></a>
<a name="ln-706"></a>    <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-707"></a>
<a name="ln-708"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ii</span>
<a name="ln-709"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">cid</span>
<a name="ln-710"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">cid1</span>
<a name="ln-711"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">cid2</span>
<a name="ln-712"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">sid</span>
<a name="ln-713"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">conid</span>
<a name="ln-714"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">lid</span>
<a name="ln-715"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">matid</span>
<a name="ln-716"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">did</span>
<a name="ln-717"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">adj1</span>
<a name="ln-718"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">adj2</span>
<a name="ln-719"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">errorCount</span>
<a name="ln-720"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">concell</span>
<a name="ln-721"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MaterNum</span>
<a name="ln-722"></a>
<a name="ln-723"></a>
<a name="ln-724"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">runor</span>
<a name="ln-725"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">high1</span>
<a name="ln-726"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">low2</span>
<a name="ln-727"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">testlen</span>
<a name="ln-728"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">waterd</span> <span class="c">! water density</span>
<a name="ln-729"></a>    <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">DoReport</span>
<a name="ln-730"></a>    <span class="n">deltat</span><span class="o">=</span><span class="n">TimeStepZone</span><span class="o">*</span><span class="mi">360</span><span class="mf">0.0d0</span>
<a name="ln-731"></a>
<a name="ln-732"></a>
<a name="ln-733"></a>    <span class="c">! Check the materials information and work out how many cells are required.</span>
<a name="ln-734"></a>    <span class="n">errorCount</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-735"></a>    <span class="n">TotCellsMax</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-736"></a>    <span class="k">DO </span><span class="n">sid</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-737"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-738"></a><span class="k">       IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="n">HeatTransferAlgorithm</span> <span class="o">/=</span> <span class="n">HeatTransferModel_HAMT</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-739"></a><span class="k">        </span><span class="n">conid</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-740"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">conid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-741"></a><span class="k">        DO </span><span class="n">lid</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">conid</span><span class="p">)%</span><span class="n">TotLayers</span>
<a name="ln-742"></a>           <span class="n">matid</span><span class="o">=</span><span class="n">Construct</span><span class="p">(</span><span class="n">conid</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="n">lid</span><span class="p">)</span>
<a name="ln-743"></a>           <span class="k">IF</span> <span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">ROnly</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-744"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Construction=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">conid</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-745"></a>                 <span class="s1">&#39; cannot contain R-only value materials.&#39;</span><span class="p">)</span>
<a name="ln-746"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Reference Material=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-747"></a>              <span class="n">errorCount</span><span class="o">=</span><span class="n">errorCount</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-748"></a>              <span class="k">CYCLE</span>
<a name="ln-749"></a><span class="k">           </span><span class="n">ENDIF</span>
<a name="ln-750"></a>
<a name="ln-751"></a>           <span class="k">IF</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">nmu</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-752"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Construction=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">conid</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-753"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Reference Material=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-754"></a>                <span class="s1">&#39; does not have required Water Vapor Diffusion Resistance Factor (mu) data.&#39;</span><span class="p">)</span>
<a name="ln-755"></a>              <span class="n">errorCount</span><span class="o">=</span><span class="n">errorCount</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-756"></a>           <span class="n">ENDIF</span>
<a name="ln-757"></a>
<a name="ln-758"></a>           <span class="k">IF</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">niso</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-759"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Construction=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">conid</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-760"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Reference Material=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-761"></a>                <span class="s1">&#39; does not have required isotherm data.&#39;</span><span class="p">)</span>
<a name="ln-762"></a>              <span class="n">errorCount</span><span class="o">=</span><span class="n">errorCount</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-763"></a>           <span class="n">ENDIF</span>
<a name="ln-764"></a>           <span class="k">IF</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">nsuc</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-765"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Construction=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">conid</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-766"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Reference Material=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-767"></a>                <span class="s1">&#39; does not have required liquid transport coefficient (suction) data.&#39;</span><span class="p">)</span>
<a name="ln-768"></a>              <span class="n">errorCount</span><span class="o">=</span><span class="n">errorCount</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-769"></a>           <span class="n">ENDIF</span>
<a name="ln-770"></a>           <span class="k">IF</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">nred</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-771"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Construction=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">conid</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-772"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Reference Material=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-773"></a>                <span class="s1">&#39; does not have required liquid transport coefficient (redistribution) data.&#39;</span><span class="p">)</span>
<a name="ln-774"></a>              <span class="n">errorCount</span><span class="o">=</span><span class="n">errorCount</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-775"></a>           <span class="n">ENDIF</span>
<a name="ln-776"></a>           <span class="k">IF</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">ntc</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-777"></a><span class="k">              IF</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">Conductivity</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-778"></a><span class="k">                 CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Construction=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">conid</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-779"></a>                 <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Reference Material=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-780"></a>                   <span class="s1">&#39; does not have thermal conductivity data. Using fixed value.&#39;</span><span class="p">)</span>
<a name="ln-781"></a>                 <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">ntc</span><span class="o">=</span><span class="mi">2</span>
<a name="ln-782"></a>                 <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">tcwater</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-783"></a>                 <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">tcdata</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">Conductivity</span>
<a name="ln-784"></a>                 <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">tcwater</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">isodata</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">niso</span><span class="p">)</span>
<a name="ln-785"></a>                 <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">tcdata</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">Conductivity</span>
<a name="ln-786"></a>              <span class="k">ELSE</span>
<a name="ln-787"></a><span class="k">                 CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Construction=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">conid</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-788"></a>                 <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Reference Material=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-789"></a>                  <span class="s1">&#39; does not have required thermal conductivity data.&#39;</span><span class="p">)</span>
<a name="ln-790"></a>                 <span class="n">errorCount</span><span class="o">=</span><span class="n">errorCount</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-791"></a>              <span class="n">ENDIF</span>
<a name="ln-792"></a>           <span class="n">ENDIF</span>
<a name="ln-793"></a>
<a name="ln-794"></a>           <span class="c">! convert material water content to RH</span>
<a name="ln-795"></a>
<a name="ln-796"></a>           <span class="n">waterd</span><span class="o">=</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">iwater</span><span class="o">*</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">density</span>
<a name="ln-797"></a>           <span class="k">CALL </span><span class="n">interp</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">niso</span><span class="p">,</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">isodata</span><span class="p">,</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">isorh</span><span class="p">,&amp;</span>
<a name="ln-798"></a>                <span class="n">waterd</span><span class="p">,</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">irh</span><span class="p">)</span>
<a name="ln-799"></a>
<a name="ln-800"></a>           <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">divs</span><span class="o">=</span><span class="nb">INT</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">Thickness</span><span class="o">/</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">divsize</span><span class="p">)</span><span class="o">+</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">divmin</span>
<a name="ln-801"></a>           <span class="k">IF</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">divs</span><span class="o">&gt;</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">divmax</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-802"></a><span class="k">              </span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">divs</span><span class="o">=</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">divmax</span>
<a name="ln-803"></a>           <span class="n">ENDIF</span>
<a name="ln-804"></a>           <span class="c">! Check length of cell - reduce number of divisions if neccessary</span>
<a name="ln-805"></a>           <span class="k">DO</span>
<a name="ln-806"></a><span class="k">              </span><span class="n">testlen</span><span class="o">=</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">Thickness</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-807"></a>               <span class="p">((</span><span class="nb">SIN</span><span class="p">(</span><span class="n">PI</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0d0</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">divs</span><span class="p">,</span><span class="n">r64</span><span class="p">))</span><span class="o">-</span><span class="n">PI</span><span class="o">/</span><span class="mf">2.0d0</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0d0</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="nb">SIN</span><span class="p">(</span><span class="o">-</span><span class="n">PI</span><span class="o">/</span><span class="mf">2.0d0</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0d0</span><span class="p">))</span>
<a name="ln-808"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">testlen</span><span class="o">&gt;</span><span class="n">adjdist</span><span class="p">)</span><span class="k">EXIT</span>
<a name="ln-809"></a><span class="k">              </span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">divs</span><span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">divs</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-810"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">divs</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-811"></a><span class="k">                 CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Construction=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">conid</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-812"></a>                 <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Reference Material=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-813"></a>                   <span class="s1">&#39; is too thin.&#39;</span><span class="p">)</span>
<a name="ln-814"></a>                 <span class="n">errorCount</span><span class="o">=</span><span class="n">errorCount</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-815"></a>                 <span class="k">EXIT</span>
<a name="ln-816"></a><span class="k">              </span><span class="n">ENDIF</span>
<a name="ln-817"></a>           <span class="n">ENDDO</span>
<a name="ln-818"></a>           <span class="n">TotCellsMax</span><span class="o">=</span><span class="n">TotCellsMax</span><span class="o">+</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">divs</span>
<a name="ln-819"></a>        <span class="n">ENDDO</span>
<a name="ln-820"></a>        <span class="n">TotCellsMax</span><span class="o">=</span><span class="n">TotCellsMax</span><span class="o">+</span><span class="mi">7</span>
<a name="ln-821"></a>
<a name="ln-822"></a>    <span class="n">ENDDO</span>
<a name="ln-823"></a>
<a name="ln-824"></a>
<a name="ln-825"></a>
<a name="ln-826"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">errorCount</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-827"></a><span class="k">       CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;CombinedHeatAndMoistureFiniteElement: Incomplete data to start solution, program terminates.&#39;</span><span class="p">)</span>
<a name="ln-828"></a>    <span class="n">ENDIF</span>
<a name="ln-829"></a>
<a name="ln-830"></a>
<a name="ln-831"></a>    <span class="c">! Make the cells and initialise</span>
<a name="ln-832"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">TotCellsMax</span><span class="p">))</span>
<a name="ln-833"></a>    <span class="k">DO </span><span class="n">ii</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">adjmax</span>
<a name="ln-834"></a>       <span class="n">cells</span><span class="p">%</span><span class="n">adjs</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="o">=-</span><span class="mi">1</span>
<a name="ln-835"></a>       <span class="n">cells</span><span class="p">%</span><span class="n">adjsl</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="o">=-</span><span class="mi">1</span>
<a name="ln-836"></a>    <span class="n">ENDDO</span>
<a name="ln-837"></a>
<a name="ln-838"></a>    <span class="n">cid</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-839"></a>
<a name="ln-840"></a>    <span class="c">! Set up surface cell structure</span>
<a name="ln-841"></a>    <span class="k">DO </span><span class="n">sid</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-842"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-843"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-844"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="n">HeatTransferAlgorithm</span> <span class="o">/=</span> <span class="n">HeatTransferModel_HAMT</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-845"></a>      <span class="c">! Boundary Cells</span>
<a name="ln-846"></a>      <span class="n">runor</span><span class="o">=-</span><span class="mf">0.02d0</span>
<a name="ln-847"></a>      <span class="c">! Air Convection Cell</span>
<a name="ln-848"></a>      <span class="n">cid</span><span class="o">=</span><span class="n">cid</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-849"></a>      <span class="n">firstcell</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">=</span><span class="n">cid</span>
<a name="ln-850"></a>      <span class="n">ExtConcell</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">=</span><span class="n">cid</span>
<a name="ln-851"></a>      <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">rh</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-852"></a>      <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">sid</span><span class="o">=</span><span class="n">sid</span>
<a name="ln-853"></a>      <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">length</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mf">0.01d0</span>
<a name="ln-854"></a>      <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">origin</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span> <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">length</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0d0</span><span class="o">+</span><span class="n">runor</span>
<a name="ln-855"></a>
<a name="ln-856"></a>      <span class="c">! Air Radiation Cell</span>
<a name="ln-857"></a>      <span class="n">cid</span><span class="o">=</span><span class="n">cid</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-858"></a>      <span class="n">ExtRadcell</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">=</span><span class="n">cid</span>
<a name="ln-859"></a>      <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">rh</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-860"></a>      <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">sid</span><span class="o">=</span><span class="n">sid</span>
<a name="ln-861"></a>      <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">length</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mf">0.01d0</span>
<a name="ln-862"></a>      <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">origin</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span> <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">length</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0d0</span><span class="o">+</span><span class="n">runor</span>
<a name="ln-863"></a>
<a name="ln-864"></a>      <span class="c">! Sky Cell</span>
<a name="ln-865"></a>      <span class="n">cid</span><span class="o">=</span><span class="n">cid</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-866"></a>      <span class="n">ExtSkycell</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">=</span><span class="n">cid</span>
<a name="ln-867"></a>      <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">rh</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-868"></a>      <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">sid</span><span class="o">=</span><span class="n">sid</span>
<a name="ln-869"></a>      <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">length</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mf">0.01d0</span>
<a name="ln-870"></a>      <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">origin</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span> <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">length</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0d0</span><span class="o">+</span><span class="n">runor</span>
<a name="ln-871"></a>
<a name="ln-872"></a>      <span class="c">! Ground Cell</span>
<a name="ln-873"></a>      <span class="n">cid</span><span class="o">=</span><span class="n">cid</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-874"></a>      <span class="n">ExtGrncell</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">=</span><span class="n">cid</span>
<a name="ln-875"></a>      <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">rh</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-876"></a>      <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">sid</span><span class="o">=</span><span class="n">sid</span>
<a name="ln-877"></a>      <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">length</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mf">0.01d0</span>
<a name="ln-878"></a>      <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">origin</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span> <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">length</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0d0</span><span class="o">+</span><span class="n">runor</span>
<a name="ln-879"></a>      <span class="n">runor</span><span class="o">=</span><span class="n">runor</span><span class="o">+</span> <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">length</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-880"></a>
<a name="ln-881"></a>      <span class="c">! External Virtual Cell</span>
<a name="ln-882"></a>      <span class="n">cid</span><span class="o">=</span><span class="n">cid</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-883"></a>      <span class="n">Extcell</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">=</span><span class="n">cid</span>
<a name="ln-884"></a>      <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">rh</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-885"></a>      <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">sid</span><span class="o">=</span><span class="n">sid</span>
<a name="ln-886"></a>      <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">length</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mf">0.01d0</span>
<a name="ln-887"></a>      <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">origin</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span> <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">length</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0d0</span><span class="o">+</span><span class="n">runor</span>
<a name="ln-888"></a>      <span class="n">runor</span><span class="o">=</span><span class="n">runor</span><span class="o">+</span> <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">length</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-889"></a>
<a name="ln-890"></a>
<a name="ln-891"></a>      <span class="c">! Material Cells</span>
<a name="ln-892"></a>      <span class="n">conid</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-893"></a>      <span class="k">DO </span><span class="n">lid</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">conid</span><span class="p">)%</span><span class="n">TotLayers</span>
<a name="ln-894"></a>         <span class="n">matid</span><span class="o">=</span><span class="n">Construct</span><span class="p">(</span><span class="n">conid</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="n">lid</span><span class="p">)</span>
<a name="ln-895"></a>
<a name="ln-896"></a>         <span class="k">DO </span><span class="n">did</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">divs</span>
<a name="ln-897"></a>            <span class="n">cid</span><span class="o">=</span><span class="n">cid</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-898"></a>
<a name="ln-899"></a>            <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">matid</span><span class="o">=</span><span class="n">matid</span>
<a name="ln-900"></a>            <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">sid</span><span class="o">=</span><span class="n">sid</span>
<a name="ln-901"></a>
<a name="ln-902"></a>            <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">temp</span><span class="o">=</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">itemp</span>
<a name="ln-903"></a>            <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">tempp1</span><span class="o">=</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">itemp</span>
<a name="ln-904"></a>            <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">tempp2</span><span class="o">=</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">itemp</span>
<a name="ln-905"></a>
<a name="ln-906"></a>            <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">rh</span><span class="o">=</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">irh</span>
<a name="ln-907"></a>            <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">rhp1</span><span class="o">=</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">irh</span>
<a name="ln-908"></a>            <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">rhp2</span><span class="o">=</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">irh</span>
<a name="ln-909"></a>
<a name="ln-910"></a>            <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">density</span><span class="o">=</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">Density</span>
<a name="ln-911"></a>            <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">spech</span><span class="o">=</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">SpecHeat</span>
<a name="ln-912"></a>
<a name="ln-913"></a>            <span class="c">! Make cells smaller near the surface</span>
<a name="ln-914"></a>            <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">length</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">Thickness</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-915"></a>                 <span class="p">((</span><span class="nb">SIN</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="kt">REAL</span><span class="p">(</span><span class="n">did</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">divs</span><span class="p">,</span><span class="n">r64</span><span class="p">))</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.0d0</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0d0</span><span class="p">)</span><span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-916"></a>                 <span class="p">(</span><span class="nb">SIN</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="kt">REAL</span><span class="p">(</span><span class="n">did</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">divs</span><span class="p">,</span><span class="n">r64</span><span class="p">))</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.0d0</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0d0</span><span class="p">))</span>
<a name="ln-917"></a>
<a name="ln-918"></a>            <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">origin</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">runor</span><span class="o">+</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">length</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0d0</span>
<a name="ln-919"></a>            <span class="n">runor</span><span class="o">=</span><span class="n">runor</span><span class="o">+</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">length</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-920"></a>
<a name="ln-921"></a>            <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">volume</span><span class="o">=</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">length</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-922"></a>
<a name="ln-923"></a>         <span class="n">ENDDO</span>
<a name="ln-924"></a>      <span class="n">ENDDO</span>
<a name="ln-925"></a>
<a name="ln-926"></a>      <span class="c">! Interior Virtual Cell</span>
<a name="ln-927"></a>      <span class="n">cid</span><span class="o">=</span><span class="n">cid</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-928"></a>      <span class="n">Intcell</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">=</span><span class="n">cid</span>
<a name="ln-929"></a>      <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">sid</span><span class="o">=</span><span class="n">sid</span>
<a name="ln-930"></a>      <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">rh</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-931"></a>      <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">length</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mf">0.01d0</span>
<a name="ln-932"></a>      <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">origin</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">length</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0d0</span><span class="o">+</span><span class="n">runor</span>
<a name="ln-933"></a>      <span class="n">runor</span><span class="o">=</span><span class="n">runor</span><span class="o">+</span> <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">length</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-934"></a>
<a name="ln-935"></a>      <span class="c">! Air Convection Cell</span>
<a name="ln-936"></a>      <span class="n">cid</span><span class="o">=</span><span class="n">cid</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-937"></a>      <span class="n">lastcell</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">=</span><span class="n">cid</span>
<a name="ln-938"></a>      <span class="n">IntConcell</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">=</span><span class="n">cid</span>
<a name="ln-939"></a>      <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">rh</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-940"></a>      <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">sid</span><span class="o">=</span><span class="n">sid</span>
<a name="ln-941"></a>      <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">length</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mf">0.01d0</span>
<a name="ln-942"></a>      <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">origin</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span> <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">length</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0d0</span><span class="o">+</span><span class="n">runor</span>
<a name="ln-943"></a>
<a name="ln-944"></a>    <span class="n">ENDDO</span>
<a name="ln-945"></a>
<a name="ln-946"></a>
<a name="ln-947"></a>    <span class="c">! Find adjacent cells.</span>
<a name="ln-948"></a>    <span class="k">DO </span><span class="n">cid1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotCellsMax</span>
<a name="ln-949"></a>       <span class="k">DO </span><span class="n">cid2</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotCellsMax</span>
<a name="ln-950"></a>          <span class="k">IF</span><span class="p">((</span><span class="n">cid1</span><span class="o">/=</span><span class="n">cid2</span><span class="p">).</span><span class="nb">AND</span><span class="p">.(</span><span class="n">cells</span><span class="p">(</span><span class="n">cid1</span><span class="p">)%</span><span class="n">sid</span><span class="o">==</span><span class="n">cells</span><span class="p">(</span><span class="n">cid2</span><span class="p">)%</span><span class="n">sid</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-951"></a><span class="k">             </span><span class="n">high1</span><span class="o">=</span><span class="n">cells</span><span class="p">(</span><span class="n">cid1</span><span class="p">)%</span><span class="n">origin</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">cells</span><span class="p">(</span><span class="n">cid1</span><span class="p">)%</span><span class="n">length</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0d0</span>
<a name="ln-952"></a>             <span class="n">low2</span><span class="o">=</span><span class="n">cells</span><span class="p">(</span><span class="n">cid2</span><span class="p">)%</span><span class="n">origin</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">cells</span><span class="p">(</span><span class="n">cid2</span><span class="p">)%</span><span class="n">length</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0d0</span>
<a name="ln-953"></a>             <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">low2</span><span class="o">-</span><span class="n">high1</span><span class="p">)</span><span class="o">&lt;</span><span class="n">adjdist</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-954"></a><span class="k">                </span><span class="n">adj1</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-955"></a>                <span class="k">DO </span><span class="n">ii</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">adjmax</span>
<a name="ln-956"></a>                   <span class="n">adj1</span><span class="o">=</span><span class="n">adj1</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-957"></a>                   <span class="k">IF</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">cid1</span><span class="p">)%</span><span class="n">adjs</span><span class="p">(</span><span class="n">adj1</span><span class="p">)</span><span class="o">==-</span><span class="mi">1</span><span class="p">)</span><span class="k">EXIT</span>
<a name="ln-958"></a><span class="k">                END DO</span>
<a name="ln-959"></a><span class="k">                </span><span class="n">adj2</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-960"></a>                <span class="k">DO </span><span class="n">ii</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">adjmax</span>
<a name="ln-961"></a>                   <span class="n">adj2</span><span class="o">=</span><span class="n">adj2</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-962"></a>                   <span class="k">IF</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">cid2</span><span class="p">)%</span><span class="n">adjs</span><span class="p">(</span><span class="n">adj2</span><span class="p">)</span><span class="o">==-</span><span class="mi">1</span><span class="p">)</span><span class="k">EXIT</span>
<a name="ln-963"></a><span class="k">                END DO</span>
<a name="ln-964"></a><span class="k">                </span><span class="n">cells</span><span class="p">(</span><span class="n">cid1</span><span class="p">)%</span><span class="n">adjs</span><span class="p">(</span><span class="n">adj1</span><span class="p">)</span><span class="o">=</span><span class="n">cid2</span>
<a name="ln-965"></a>                <span class="n">cells</span><span class="p">(</span><span class="n">cid2</span><span class="p">)%</span><span class="n">adjs</span><span class="p">(</span><span class="n">adj2</span><span class="p">)</span><span class="o">=</span><span class="n">cid1</span>
<a name="ln-966"></a>
<a name="ln-967"></a>                <span class="n">cells</span><span class="p">(</span><span class="n">cid1</span><span class="p">)%</span><span class="n">adjsl</span><span class="p">(</span><span class="n">adj1</span><span class="p">)</span><span class="o">=</span><span class="n">adj2</span>
<a name="ln-968"></a>                <span class="n">cells</span><span class="p">(</span><span class="n">cid2</span><span class="p">)%</span><span class="n">adjsl</span><span class="p">(</span><span class="n">adj2</span><span class="p">)</span><span class="o">=</span><span class="n">adj1</span>
<a name="ln-969"></a>
<a name="ln-970"></a>                <span class="n">sid</span><span class="o">=</span><span class="n">cells</span><span class="p">(</span><span class="n">cid1</span><span class="p">)%</span><span class="n">sid</span>
<a name="ln-971"></a>                <span class="n">cells</span><span class="p">(</span><span class="n">cid1</span><span class="p">)%</span><span class="n">overlap</span><span class="p">(</span><span class="n">adj1</span><span class="p">)</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-972"></a>                <span class="n">cells</span><span class="p">(</span><span class="n">cid2</span><span class="p">)%</span><span class="n">overlap</span><span class="p">(</span><span class="n">adj2</span><span class="p">)</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-973"></a>                <span class="n">cells</span><span class="p">(</span><span class="n">cid1</span><span class="p">)%</span><span class="n">dist</span><span class="p">(</span><span class="n">adj1</span><span class="p">)</span><span class="o">=</span><span class="n">cells</span><span class="p">(</span><span class="n">cid1</span><span class="p">)%</span><span class="n">length</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0d0</span>
<a name="ln-974"></a>                <span class="n">cells</span><span class="p">(</span><span class="n">cid2</span><span class="p">)%</span><span class="n">dist</span><span class="p">(</span><span class="n">adj2</span><span class="p">)</span><span class="o">=</span><span class="n">cells</span><span class="p">(</span><span class="n">cid2</span><span class="p">)%</span><span class="n">length</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0d0</span>
<a name="ln-975"></a>             <span class="n">ENDIF</span>
<a name="ln-976"></a>          <span class="n">ENDIF</span>
<a name="ln-977"></a>       <span class="n">ENDDO</span>
<a name="ln-978"></a>    <span class="n">ENDDO</span>
<a name="ln-979"></a>
<a name="ln-980"></a>    <span class="c">! Reset surface virtual cell origins and volumes. Initialise report variables.</span>
<a name="ln-981"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">1966</span><span class="p">)</span>
<a name="ln-982"></a><span class="mi">1966</span>      <span class="k">FORMAT</span><span class="p">(</span><span class="s1">&#39;! &lt;HAMT cells&gt;, Surface Name, Construction Name, Cell Numbers&#39;</span><span class="p">)</span>
<a name="ln-983"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">1965</span><span class="p">)</span>
<a name="ln-984"></a><span class="mi">1965</span>      <span class="k">FORMAT</span><span class="p">(</span><span class="s1">&#39;! &lt;HAMT origins&gt;, Surface Name, Construction Name, Cell origins (m) &#39;</span><span class="p">)</span>
<a name="ln-985"></a>    <span class="c">!cCurrentModuleObject=&#39;MaterialProperty:HeatAndMoistureTransfer:*&#39;</span>
<a name="ln-986"></a>    <span class="k">DO </span><span class="n">sid</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-987"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-988"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-989"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="n">HeatTransferAlgorithm</span> <span class="o">/=</span> <span class="n">HeatTransferModel_HAMT</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-990"></a><span class="k">      </span><span class="n">cells</span><span class="p">(</span><span class="n">Extcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">origin</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">cells</span><span class="p">(</span><span class="n">Extcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">origin</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">cells</span><span class="p">(</span><span class="n">Extcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">length</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0d0</span>
<a name="ln-991"></a>      <span class="n">cells</span><span class="p">(</span><span class="n">Intcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">origin</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">cells</span><span class="p">(</span><span class="n">Intcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">origin</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">cells</span><span class="p">(</span><span class="n">Intcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">length</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0d0</span>
<a name="ln-992"></a>      <span class="n">cells</span><span class="p">(</span><span class="n">Extcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">volume</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-993"></a>      <span class="n">cells</span><span class="p">(</span><span class="n">Intcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">volume</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-994"></a>      <span class="n">watertot</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-995"></a>      <span class="n">surfrh</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-996"></a>      <span class="n">surfextrh</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-997"></a>      <span class="n">surftemp</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-998"></a>      <span class="n">surfexttemp</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-999"></a>      <span class="n">surfvp</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1000"></a>      <span class="k">CALL </span><span class="n">SetUpOutputVariable</span><span class="p">(</span><span class="s1">&#39;HAMT Surface Average Water Content Ratio [kg/kg]&#39;</span><span class="p">,</span><span class="n">watertot</span><span class="p">(</span><span class="n">sid</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-1001"></a>         <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1002"></a>      <span class="k">CALL </span><span class="n">SetUpOutputVariable</span><span class="p">(</span><span class="s1">&#39;HAMT Surface Inside Face Temperature [C]&#39;</span><span class="p">,</span><span class="n">surftemp</span><span class="p">(</span><span class="n">sid</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-1003"></a>         <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1004"></a>      <span class="k">CALL </span><span class="n">SetUpOutputVariable</span><span class="p">(</span><span class="s1">&#39;HAMT Surface Inside Face Relative Humidity [%]&#39;</span><span class="p">,</span><span class="n">surfrh</span><span class="p">(</span><span class="n">sid</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-1005"></a>         <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1006"></a>      <span class="k">CALL </span><span class="n">SetUpOutputVariable</span><span class="p">(</span><span class="s1">&#39;HAMT Surface Inside Face Vapor Pressure [Pa]&#39;</span><span class="p">,</span><span class="n">surfvp</span><span class="p">(</span><span class="n">sid</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-1007"></a>         <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1008"></a>      <span class="k">CALL </span><span class="n">SetUpOutputVariable</span><span class="p">(</span><span class="s1">&#39;HAMT Surface Outside Face Temperature [C]&#39;</span><span class="p">,</span><span class="n">surfexttemp</span><span class="p">(</span><span class="n">sid</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-1009"></a>         <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1010"></a>      <span class="k">CALL </span><span class="n">SetUpOutputVariable</span><span class="p">(</span><span class="s1">&#39;HAMT Surface Outside Face Relative Humidity [%]&#39;</span><span class="p">,</span><span class="n">surfextrh</span><span class="p">(</span><span class="n">sid</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-1011"></a>         <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1012"></a>
<a name="ln-1013"></a>
<a name="ln-1014"></a>      <span class="c">! write cell origins to initilisation output file</span>
<a name="ln-1015"></a>      <span class="n">conid</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-1016"></a>      <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">1968</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">conid</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-1017"></a>         <span class="p">(</span><span class="n">concell</span><span class="p">,</span> <span class="n">concell</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Intcell</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">-</span><span class="n">Extcell</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1018"></a><span class="mi">1968</span>      <span class="k">FORMAT</span><span class="p">(</span><span class="s1">&#39;HAMT cells, &#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="mi">400</span><span class="p">(:,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">i4</span><span class="p">))</span>
<a name="ln-1019"></a>      <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">1967</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">conid</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-1020"></a>         <span class="n">cells</span><span class="p">(</span><span class="n">Extcell</span><span class="p">(</span><span class="n">sid</span><span class="p">):</span><span class="n">Intcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">origin</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1021"></a><span class="mi">1967</span>      <span class="k">FORMAT</span><span class="p">(</span><span class="s1">&#39;HAMT origins,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="mi">400</span><span class="p">(:,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">f10</span><span class="p">.</span><span class="mi">7</span><span class="p">))</span>
<a name="ln-1022"></a>
<a name="ln-1023"></a>      <span class="n">concell</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-1024"></a>      <span class="k">DO </span><span class="n">cid</span><span class="o">=</span><span class="n">Extcell</span><span class="p">(</span><span class="n">sid</span><span class="p">),</span><span class="n">Intcell</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span>
<a name="ln-1025"></a>         <span class="k">CALL </span><span class="n">SetUpOutputVariable</span><span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-1026"></a>              <span class="s1">&#39;HAMT Surface Temperature Cell &#39;</span> <span class="p">&amp;</span>
<a name="ln-1027"></a>              <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">concell</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1028"></a>              <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">temp</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1029"></a>         <span class="n">concell</span><span class="o">=</span><span class="n">concell</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1030"></a>      <span class="n">ENDDO</span>
<a name="ln-1031"></a>      <span class="n">concell</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-1032"></a>      <span class="k">DO </span><span class="n">cid</span><span class="o">=</span><span class="n">Extcell</span><span class="p">(</span><span class="n">sid</span><span class="p">),</span><span class="n">Intcell</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span>
<a name="ln-1033"></a>         <span class="k">CALL </span><span class="n">SetUpOutputVariable</span><span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-1034"></a>              <span class="s1">&#39;HAMT Surface Water Content Cell &#39;</span> <span class="p">&amp;</span>
<a name="ln-1035"></a>              <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">concell</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; [kg/kg]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1036"></a>              <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">wreport</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1037"></a>         <span class="n">concell</span><span class="o">=</span><span class="n">concell</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1038"></a>      <span class="n">ENDDO</span>
<a name="ln-1039"></a>      <span class="n">concell</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-1040"></a>      <span class="k">DO </span><span class="n">cid</span><span class="o">=</span><span class="n">Extcell</span><span class="p">(</span><span class="n">sid</span><span class="p">),</span><span class="n">Intcell</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span>
<a name="ln-1041"></a>         <span class="k">CALL </span><span class="n">SetUpOutputVariable</span><span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-1042"></a>              <span class="s1">&#39;HAMT Surface Relative Humidity Cell &#39;</span> <span class="p">&amp;</span>
<a name="ln-1043"></a>              <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">concell</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; [%]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1044"></a>              <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">rhp</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1045"></a>         <span class="n">concell</span><span class="o">=</span><span class="n">concell</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1046"></a>      <span class="n">ENDDO</span>
<a name="ln-1047"></a>    <span class="n">ENDDO</span>
<a name="ln-1048"></a>
<a name="ln-1049"></a>    <span class="k">CALL </span><span class="n">ScanForReports</span><span class="p">(</span><span class="s1">&#39;Constructions&#39;</span><span class="p">,</span><span class="n">DoReport</span><span class="p">,</span><span class="s1">&#39;Constructions&#39;</span><span class="p">)</span>
<a name="ln-1050"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DoReport</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1051"></a>
<a name="ln-1052"></a><span class="k">      WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">108</span><span class="p">)</span>
<a name="ln-1053"></a>
<a name="ln-1054"></a>      <span class="k">Do </span><span class="n">MaterNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotMaterials</span>
<a name="ln-1055"></a>
<a name="ln-1056"></a>         <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">111</span><span class="p">)</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">NominalR</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">),</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-1057"></a>
<a name="ln-1058"></a>      <span class="k">end do</span>
<a name="ln-1059"></a>
<a name="ln-1060"></a><span class="k">    End If</span>
<a name="ln-1061"></a>
<a name="ln-1062"></a><span class="k">    </span><span class="mi">108</span> <span class="k">FORMAT</span><span class="p">(</span><span class="s1">&#39;! &lt;Material Nominal Resistance&gt;, Material Name,  Nominal R&#39;</span><span class="p">)</span>
<a name="ln-1063"></a>    <span class="mi">111</span> <span class="k">FORMAT</span><span class="p">(</span><span class="s1">&#39;Material Nominal Resistance&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">))</span>
<a name="ln-1064"></a>
<a name="ln-1065"></a>  <span class="k">END SUBROUTINE </span><span class="n">InitHeatBalHAMT</span>
<a name="ln-1066"></a>
<a name="ln-1067"></a>  <span class="k">SUBROUTINE </span><span class="n">CalcHeatBalHAMT</span><span class="p">(</span><span class="n">sid</span><span class="p">,</span><span class="n">TempSurfInTmp</span><span class="p">,</span><span class="n">TempSurfOutTmp</span><span class="p">)</span>
<a name="ln-1068"></a>    <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1069"></a>    <span class="c">!       AUTHOR         Phillip Biddulph</span>
<a name="ln-1070"></a>    <span class="c">!       DATE WRITTEN   June 2008</span>
<a name="ln-1071"></a>    <span class="c">!       MODIFIED       na</span>
<a name="ln-1072"></a>    <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1073"></a>
<a name="ln-1074"></a>    <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1075"></a>    <span class="c">! To calculate the heat and moisture transfer through the surface</span>
<a name="ln-1076"></a>
<a name="ln-1077"></a>    <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1078"></a>    <span class="c">! na</span>
<a name="ln-1079"></a>
<a name="ln-1080"></a>    <span class="c">! REFERENCES:</span>
<a name="ln-1081"></a>    <span class="c">! na</span>
<a name="ln-1082"></a>
<a name="ln-1083"></a>    <span class="c">! USE STATEMENTS:</span>
<a name="ln-1084"></a>    <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-1085"></a>    <span class="k">USE </span><span class="n">DataSurfaces</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">OtherSideCondModeledExt</span><span class="p">,</span> <span class="n">OSCM</span>
<a name="ln-1086"></a>
<a name="ln-1087"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1088"></a>
<a name="ln-1089"></a>    <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1090"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sid</span>
<a name="ln-1091"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TempSurfInTmp</span>
<a name="ln-1092"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TempSurfOutTmp</span>
<a name="ln-1093"></a>
<a name="ln-1094"></a>
<a name="ln-1095"></a>    <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1096"></a>    <span class="c">! na</span>
<a name="ln-1097"></a>
<a name="ln-1098"></a>    <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-1099"></a>    <span class="c">! na</span>
<a name="ln-1100"></a>
<a name="ln-1101"></a>    <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-1102"></a>    <span class="c">! na</span>
<a name="ln-1103"></a>
<a name="ln-1104"></a>    <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1105"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TempSurfInP</span>
<a name="ln-1106"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RhoIn</span>
<a name="ln-1107"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RhoOut</span>
<a name="ln-1108"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">torsum</span>
<a name="ln-1109"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">oorsum</span>
<a name="ln-1110"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">phioosum</span>
<a name="ln-1111"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">phiorsum</span>
<a name="ln-1112"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vpoosum</span>
<a name="ln-1113"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vporsum</span>
<a name="ln-1114"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhr1</span>
<a name="ln-1115"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhr2</span>
<a name="ln-1116"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">wcap</span>
<a name="ln-1117"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">thermr1</span>
<a name="ln-1118"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">thermr2</span>
<a name="ln-1119"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tcap</span>
<a name="ln-1120"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">qvp</span>
<a name="ln-1121"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vaporr1</span>
<a name="ln-1122"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vaporr2</span>
<a name="ln-1123"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vpdiff</span>
<a name="ln-1124"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sumtp1</span>
<a name="ln-1125"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tempmax</span>
<a name="ln-1126"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tempmin</span>
<a name="ln-1127"></a>
<a name="ln-1128"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ii</span>
<a name="ln-1129"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">matid</span>
<a name="ln-1130"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">itter</span>
<a name="ln-1131"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">cid</span>
<a name="ln-1132"></a><span class="c">!unused1208    INTEGER :: cid1</span>
<a name="ln-1133"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">adj</span>
<a name="ln-1134"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">adjl</span>
<a name="ln-1135"></a>
<a name="ln-1136"></a>
<a name="ln-1137"></a><span class="c">!    INTEGER, SAVE :: tempErrCount=0</span>
<a name="ln-1138"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">qvpErrCount</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1139"></a><span class="c">!    INTEGER, SAVE :: tempErrReport=0</span>
<a name="ln-1140"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">qvpErrreport</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1141"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">denominator</span>
<a name="ln-1142"></a>
<a name="ln-1143"></a>
<a name="ln-1144"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">BeginEnvrnFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">sid</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-1145"></a><span class="k">       </span><span class="n">cells</span><span class="p">(</span><span class="n">Extcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">rh</span><span class="o">=</span><span class="mf">0.0D0</span>
<a name="ln-1146"></a>       <span class="n">cells</span><span class="p">(</span><span class="n">Extcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">rhp1</span><span class="o">=</span><span class="mf">0.0D0</span>
<a name="ln-1147"></a>       <span class="n">cells</span><span class="p">(</span><span class="n">Extcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">rhp2</span><span class="o">=</span><span class="mf">0.0D0</span>
<a name="ln-1148"></a>
<a name="ln-1149"></a>       <span class="n">cells</span><span class="p">(</span><span class="n">Extcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">temp</span><span class="o">=</span><span class="mi">1</span><span class="mf">0.0D0</span>
<a name="ln-1150"></a>       <span class="n">cells</span><span class="p">(</span><span class="n">Extcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">tempp1</span><span class="o">=</span><span class="mi">1</span><span class="mf">0.0D0</span>
<a name="ln-1151"></a>       <span class="n">cells</span><span class="p">(</span><span class="n">Extcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">tempp2</span><span class="o">=</span><span class="mi">1</span><span class="mf">0.0D0</span>
<a name="ln-1152"></a>
<a name="ln-1153"></a>       <span class="n">cells</span><span class="p">(</span><span class="n">Intcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">rh</span><span class="o">=</span><span class="mf">0.0D0</span>
<a name="ln-1154"></a>       <span class="n">cells</span><span class="p">(</span><span class="n">Intcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">rhp1</span><span class="o">=</span><span class="mf">0.0D0</span>
<a name="ln-1155"></a>       <span class="n">cells</span><span class="p">(</span><span class="n">Intcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">rhp2</span><span class="o">=</span><span class="mf">0.0D0</span>
<a name="ln-1156"></a>
<a name="ln-1157"></a>       <span class="n">cells</span><span class="p">(</span><span class="n">Intcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">temp</span><span class="o">=</span><span class="mi">1</span><span class="mf">0.0D0</span>
<a name="ln-1158"></a>       <span class="n">cells</span><span class="p">(</span><span class="n">Intcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">tempp1</span><span class="o">=</span><span class="mi">1</span><span class="mf">0.0D0</span>
<a name="ln-1159"></a>       <span class="n">cells</span><span class="p">(</span><span class="n">Intcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">tempp2</span><span class="o">=</span><span class="mi">1</span><span class="mf">0.0D0</span>
<a name="ln-1160"></a>
<a name="ln-1161"></a>       <span class="k">DO </span><span class="n">cid</span><span class="o">=</span><span class="n">Extcell</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">Intcell</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-1162"></a>          <span class="n">matid</span><span class="o">=</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">matid</span>
<a name="ln-1163"></a>
<a name="ln-1164"></a>          <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">temp</span><span class="o">=</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">itemp</span>
<a name="ln-1165"></a>          <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">tempp1</span><span class="o">=</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">itemp</span>
<a name="ln-1166"></a>          <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">tempp2</span><span class="o">=</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">itemp</span>
<a name="ln-1167"></a>
<a name="ln-1168"></a>          <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">rh</span><span class="o">=</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">irh</span>
<a name="ln-1169"></a>          <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">rhp1</span><span class="o">=</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">irh</span>
<a name="ln-1170"></a>          <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">rhp2</span><span class="o">=</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">irh</span>
<a name="ln-1171"></a>       <span class="n">ENDDO</span>
<a name="ln-1172"></a>       <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1173"></a>    <span class="n">ENDIF</span>
<a name="ln-1174"></a>    <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">BeginEnvrnFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1175"></a><span class="k">       </span><span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1176"></a>    <span class="n">ENDIF</span>
<a name="ln-1177"></a>
<a name="ln-1178"></a>    <span class="c">! Set all the boundary values</span>
<a name="ln-1179"></a>    <span class="n">cells</span><span class="p">(</span><span class="n">ExtRadcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">temp</span><span class="o">=</span><span class="n">TempOutsideAirFD</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span>
<a name="ln-1180"></a>    <span class="n">cells</span><span class="p">(</span><span class="n">ExtConcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">temp</span><span class="o">=</span><span class="n">TempOutsideAirFD</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span>
<a name="ln-1181"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">OtherSideCondModeledExt</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1182"></a>     <span class="c">!CR8046 switch modeled rad temp for sky temp.</span>
<a name="ln-1183"></a>      <span class="n">cells</span><span class="p">(</span><span class="n">ExtSkycell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">temp</span> <span class="o">=</span>  <span class="n">OSCM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="n">OSCMPtr</span><span class="p">)%</span><span class="n">TRad</span>
<a name="ln-1184"></a>      <span class="n">cells</span><span class="p">(</span><span class="n">Extcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">Qadds</span><span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! eliminate incident shortwave on underlying surface</span>
<a name="ln-1185"></a>    <span class="k">ELSE</span>
<a name="ln-1186"></a><span class="k">      </span><span class="n">cells</span><span class="p">(</span><span class="n">ExtSkycell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">temp</span> <span class="o">=</span> <span class="n">SkyTemp</span>
<a name="ln-1187"></a>
<a name="ln-1188"></a>      <span class="n">cells</span><span class="p">(</span><span class="n">Extcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">Qadds</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="n">Area</span><span class="o">*</span><span class="n">QRadSWOutAbs</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span>
<a name="ln-1189"></a>
<a name="ln-1190"></a>    <span class="n">ENDIF</span>
<a name="ln-1191"></a>
<a name="ln-1192"></a>    <span class="n">cells</span><span class="p">(</span><span class="n">ExtGrncell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">temp</span><span class="o">=</span><span class="n">TempOutsideAirFD</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span>
<a name="ln-1193"></a>    <span class="n">RhoOut</span><span class="o">=</span><span class="n">RhoVaporAirOut</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span>
<a name="ln-1194"></a>
<a name="ln-1195"></a>    <span class="c">! Special case when the surface is an internal mass</span>
<a name="ln-1196"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">sid</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1197"></a><span class="k">       </span><span class="n">cells</span><span class="p">(</span><span class="n">ExtConcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">temp</span><span class="o">=</span> <span class="n">Mat</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)</span>
<a name="ln-1198"></a>       <span class="n">RhoOut</span><span class="o">=</span><span class="n">RhoVaporAirIn</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span>
<a name="ln-1199"></a>    <span class="n">ENDIF</span>
<a name="ln-1200"></a>
<a name="ln-1201"></a>    <span class="n">RhoIn</span><span class="o">=</span><span class="n">RhoVaporAirIn</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span>
<a name="ln-1202"></a>
<a name="ln-1203"></a>    <span class="n">cells</span><span class="p">(</span><span class="n">ExtRadcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">htc</span><span class="o">=</span><span class="n">HAirFD</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span>
<a name="ln-1204"></a>    <span class="n">cells</span><span class="p">(</span><span class="n">ExtConcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">htc</span><span class="o">=</span><span class="n">HConvExtFD</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span>
<a name="ln-1205"></a>    <span class="n">cells</span><span class="p">(</span><span class="n">ExtSkycell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">htc</span><span class="o">=</span><span class="n">HSkyFD</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span>
<a name="ln-1206"></a>    <span class="n">cells</span><span class="p">(</span><span class="n">ExtGrncell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">htc</span><span class="o">=</span><span class="n">HGrndFD</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span>
<a name="ln-1207"></a>
<a name="ln-1208"></a>
<a name="ln-1209"></a>
<a name="ln-1210"></a>    <span class="n">cells</span><span class="p">(</span><span class="n">IntConcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">temp</span><span class="o">=</span><span class="n">Mat</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)</span>
<a name="ln-1211"></a>
<a name="ln-1212"></a>    <span class="n">cells</span><span class="p">(</span><span class="n">IntConcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">htc</span><span class="o">=</span><span class="n">HConvInFD</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span>
<a name="ln-1213"></a>
<a name="ln-1214"></a>    <span class="n">cells</span><span class="p">(</span><span class="n">Intcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">Qadds</span><span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1215"></a>         <span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="n">Area</span><span class="o">*</span><span class="p">(</span><span class="n">QRadSWInAbs</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">+</span><span class="n">NetLWRadToSurf</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">+</span><span class="n">QHtRadSysSurf</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">+</span><span class="n">QHWBaseboardSurf</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-1216"></a>                            <span class="n">QSteamBaseboardSurf</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">+</span><span class="n">QElecBaseboardSurf</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">+</span><span class="n">QRadThermInAbs</span><span class="p">(</span><span class="n">sid</span><span class="p">))</span>
<a name="ln-1217"></a>    <span class="c">! Check, Is this per unit area or for the whole wall.</span>
<a name="ln-1218"></a>    <span class="c">!    cells(Intcell(sid))%Qadds=QRadSWInAbs(sid)+NetLWRadToSurf(sid)+QHtRadSysSurf(sid)+QRadThermInAbs(sid)</span>
<a name="ln-1219"></a>
<a name="ln-1220"></a>
<a name="ln-1221"></a>    <span class="n">cells</span><span class="p">(</span><span class="n">ExtConcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">rh</span><span class="o">=</span><span class="n">PsyRhFnTdbRhov</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">ExtConcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">temp</span><span class="p">,</span><span class="n">RhoOut</span><span class="p">,</span><span class="s1">&#39;HAMT-Ext&#39;</span><span class="p">)</span>
<a name="ln-1222"></a>    <span class="n">cells</span><span class="p">(</span><span class="n">IntConcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">rh</span><span class="o">=</span><span class="n">PsyRhFnTdbRhov</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">IntConcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">temp</span><span class="p">,</span><span class="n">RhoIn</span><span class="p">,</span><span class="s1">&#39;HAMT-Int&#39;</span><span class="p">)</span>
<a name="ln-1223"></a>
<a name="ln-1224"></a>
<a name="ln-1225"></a>
<a name="ln-1226"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">ExtConcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">rh</span><span class="o">&gt;</span><span class="n">rhmax</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1227"></a><span class="k">       </span><span class="n">cells</span><span class="p">(</span><span class="n">ExtConcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">rh</span><span class="o">=</span><span class="n">rhmax</span>
<a name="ln-1228"></a>    <span class="n">ENDIF</span>
<a name="ln-1229"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">IntConcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">rh</span><span class="o">&gt;</span><span class="n">rhmax</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1230"></a><span class="k">       </span><span class="n">cells</span><span class="p">(</span><span class="n">IntConcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">rh</span><span class="o">=</span><span class="n">rhmax</span>
<a name="ln-1231"></a>    <span class="n">ENDIF</span>
<a name="ln-1232"></a>
<a name="ln-1233"></a><span class="c">! PDB August 2009 Start! Correction for when no vapour transfer coefficient have been defined.</span>
<a name="ln-1234"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">extvtcflag</span><span class="p">(</span><span class="n">sid</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-1235"></a><span class="k">       </span><span class="n">cells</span><span class="p">(</span><span class="n">ExtConcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">vtc</span><span class="o">=</span><span class="n">extvtc</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span>
<a name="ln-1236"></a>    <span class="k">ELSE</span>
<a name="ln-1237"></a><span class="k">       IF</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">ExtConcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">rh</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1238"></a><span class="k">          </span><span class="n">cells</span><span class="p">(</span><span class="n">ExtConcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">vtc</span><span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1239"></a>               <span class="n">HMassConvExtFD</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">*</span><span class="n">RhoOut</span><span class="o">/</span><span class="p">(</span><span class="n">PsyPsatFnTemp</span><span class="p">(</span><span class="n">TempOutsideAirFD</span><span class="p">(</span><span class="n">sid</span><span class="p">))</span><span class="o">*</span><span class="n">cells</span><span class="p">(</span><span class="n">ExtConcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">rh</span><span class="p">)</span>
<a name="ln-1240"></a>       <span class="k">ELSE</span>
<a name="ln-1241"></a><span class="k">          </span><span class="n">cells</span><span class="p">(</span><span class="n">ExtConcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">vtc</span><span class="o">=</span><span class="mi">1000</span><span class="mf">0.0d0</span>
<a name="ln-1242"></a>       <span class="n">ENDIF</span>
<a name="ln-1243"></a>    <span class="n">ENDIF</span>
<a name="ln-1244"></a>
<a name="ln-1245"></a>
<a name="ln-1246"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">intvtcflag</span><span class="p">(</span><span class="n">sid</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-1247"></a><span class="k">       </span><span class="n">cells</span><span class="p">(</span><span class="n">IntConcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">vtc</span><span class="o">=</span><span class="n">intvtc</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span>
<a name="ln-1248"></a>       <span class="n">HMassConvInFD</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1249"></a>            <span class="n">cells</span><span class="p">(</span><span class="n">IntConcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">vtc</span><span class="o">*</span><span class="n">PsyPsatFnTemp</span><span class="p">(</span><span class="n">Mat</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="n">Zone</span><span class="p">))</span><span class="o">*</span><span class="n">cells</span><span class="p">(</span><span class="n">IntConcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">rh</span><span class="o">/</span><span class="n">RhoIn</span>
<a name="ln-1250"></a>    <span class="k">ELSE</span>
<a name="ln-1251"></a><span class="k">       IF</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">IntConcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">rh</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1252"></a><span class="k">          </span><span class="n">cells</span><span class="p">(</span><span class="n">IntConcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">vtc</span><span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1253"></a>               <span class="n">HMassConvInFD</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">*</span><span class="n">RhoIn</span><span class="o">/</span><span class="p">(</span><span class="n">PsyPsatFnTemp</span><span class="p">(</span><span class="n">Mat</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="n">Zone</span><span class="p">))</span><span class="o">*</span><span class="n">cells</span><span class="p">(</span><span class="n">IntConcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">rh</span><span class="p">)</span>
<a name="ln-1254"></a>       <span class="k">ELSE</span>
<a name="ln-1255"></a><span class="k">          </span><span class="n">cells</span><span class="p">(</span><span class="n">IntConcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">vtc</span><span class="o">=</span> <span class="mi">1000</span><span class="mf">0.0d0</span>
<a name="ln-1256"></a>       <span class="n">ENDIF</span>
<a name="ln-1257"></a>    <span class="n">ENDIF</span>
<a name="ln-1258"></a><span class="c">! PDB August 2009 End</span>
<a name="ln-1259"></a>
<a name="ln-1260"></a>    <span class="c">! Initialise</span>
<a name="ln-1261"></a>    <span class="k">DO </span><span class="n">cid</span><span class="o">=</span><span class="n">firstcell</span><span class="p">(</span><span class="n">sid</span><span class="p">),</span><span class="n">Extcell</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-1262"></a>       <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">tempp1</span><span class="o">=</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">temp</span>
<a name="ln-1263"></a>       <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">tempp2</span><span class="o">=</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">temp</span>
<a name="ln-1264"></a>       <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">rhp1</span><span class="o">=</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">rh</span>
<a name="ln-1265"></a>       <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">rhp2</span><span class="o">=</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">rh</span>
<a name="ln-1266"></a>    <span class="n">ENDDO</span>
<a name="ln-1267"></a>    <span class="k">DO </span><span class="n">cid</span><span class="o">=</span><span class="n">Intcell</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">lastcell</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span>
<a name="ln-1268"></a>       <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">tempp1</span><span class="o">=</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">temp</span>
<a name="ln-1269"></a>       <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">tempp2</span><span class="o">=</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">temp</span>
<a name="ln-1270"></a>       <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">rhp1</span><span class="o">=</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">rh</span>
<a name="ln-1271"></a>       <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">rhp2</span><span class="o">=</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">rh</span>
<a name="ln-1272"></a>    <span class="n">ENDDO</span>
<a name="ln-1273"></a>
<a name="ln-1274"></a>    <span class="n">itter</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1275"></a>    <span class="k">DO</span>
<a name="ln-1276"></a><span class="k">       </span><span class="n">itter</span><span class="o">=</span><span class="n">itter</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1277"></a>       <span class="c">! Update Moisture values</span>
<a name="ln-1278"></a>
<a name="ln-1279"></a>       <span class="k">DO </span><span class="n">cid</span><span class="o">=</span><span class="n">firstcell</span><span class="p">(</span><span class="n">sid</span><span class="p">),</span><span class="n">lastcell</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span>
<a name="ln-1280"></a>          <span class="n">matid</span><span class="o">=</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">matid</span>
<a name="ln-1281"></a>          <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">vp</span><span class="o">=</span><span class="n">RHTOVP</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">rh</span><span class="p">,</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">temp</span><span class="p">)</span>
<a name="ln-1282"></a>          <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">vpp1</span><span class="o">=</span><span class="n">RHTOVP</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">rhp1</span><span class="p">,</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">tempp1</span><span class="p">)</span>
<a name="ln-1283"></a>          <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">vpsat</span><span class="o">=</span><span class="n">PsyPsatFnTemp</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">tempp1</span><span class="p">)</span>
<a name="ln-1284"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">matid</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1285"></a><span class="k">             CALL </span><span class="n">interp</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">niso</span><span class="p">,</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">isorh</span><span class="p">,</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">isodata</span><span class="p">,</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">rhp1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1286"></a>                  <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">water</span><span class="p">,</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">dwdphi</span><span class="p">)</span>
<a name="ln-1287"></a>             <span class="k">IF</span><span class="p">(</span><span class="n">IsRain</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="n">rainswitch</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1288"></a><span class="k">                CALL </span><span class="n">interp</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">nsuc</span><span class="p">,</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">sucwater</span><span class="p">,</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">sucdata</span><span class="p">,</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">water</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1289"></a>                     <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">dw</span><span class="p">)</span>
<a name="ln-1290"></a>             <span class="k">ELSE</span>
<a name="ln-1291"></a><span class="k">                CALL </span><span class="n">interp</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">nred</span><span class="p">,</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">redwater</span><span class="p">,</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">reddata</span><span class="p">,</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">water</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1292"></a>                     <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">dw</span><span class="p">)</span>
<a name="ln-1293"></a>             <span class="n">ENDIF</span>
<a name="ln-1294"></a>             <span class="k">CALL </span><span class="n">interp</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">nmu</span><span class="p">,</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">murh</span><span class="p">,</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">mudata</span><span class="p">,</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">rhp1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1295"></a>                  <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">mu</span><span class="p">)</span>
<a name="ln-1296"></a>             <span class="k">CALL </span><span class="n">interp</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">ntc</span><span class="p">,</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">tcwater</span><span class="p">,</span><span class="n">Material</span><span class="p">(</span><span class="n">matid</span><span class="p">)%</span><span class="n">tcdata</span><span class="p">,</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">water</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1297"></a>                  <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">wthermalc</span><span class="p">)</span>
<a name="ln-1298"></a>          <span class="n">ENDIF</span>
<a name="ln-1299"></a>       <span class="n">ENDDO</span>
<a name="ln-1300"></a>
<a name="ln-1301"></a>
<a name="ln-1302"></a>       <span class="c">!Calculate Heat and Vapor resistances,</span>
<a name="ln-1303"></a>       <span class="k">DO </span><span class="n">cid</span><span class="o">=</span><span class="n">Extcell</span><span class="p">(</span><span class="n">sid</span><span class="p">),</span><span class="n">Intcell</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span>
<a name="ln-1304"></a>          <span class="n">torsum</span><span class="o">=</span><span class="mf">0.0D0</span>
<a name="ln-1305"></a>          <span class="n">oorsum</span><span class="o">=</span><span class="mf">0.0D0</span>
<a name="ln-1306"></a>          <span class="n">vpdiff</span><span class="o">=</span><span class="mf">0.0D0</span>
<a name="ln-1307"></a>          <span class="k">DO </span><span class="n">ii</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">adjmax</span>
<a name="ln-1308"></a>             <span class="n">adj</span><span class="o">=</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">adjs</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span>
<a name="ln-1309"></a>             <span class="n">adjl</span><span class="o">=</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">adjsl</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span>
<a name="ln-1310"></a>             <span class="k">IF</span><span class="p">(</span><span class="n">adj</span><span class="o">==-</span><span class="mi">1</span><span class="p">)</span><span class="k">EXIT</span>
<a name="ln-1311"></a>
<a name="ln-1312"></a><span class="k">             IF</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">htc</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1313"></a><span class="k">                </span><span class="n">thermr1</span><span class="o">=</span><span class="mf">1.0D0</span><span class="o">/</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">overlap</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="o">*</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">htc</span><span class="p">)</span>
<a name="ln-1314"></a>             <span class="k">ELSE IF</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">matid</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1315"></a><span class="k">                </span><span class="n">thermr1</span><span class="o">=</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">dist</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">overlap</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="o">*</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">wthermalc</span><span class="p">)</span>
<a name="ln-1316"></a>             <span class="k">ELSE</span>
<a name="ln-1317"></a><span class="k">                </span><span class="n">thermr1</span><span class="o">=</span><span class="mf">0.0D0</span>
<a name="ln-1318"></a>             <span class="n">ENDIF</span>
<a name="ln-1319"></a>
<a name="ln-1320"></a>             <span class="k">IF</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">vtc</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1321"></a><span class="k">                </span><span class="n">vaporr1</span><span class="o">=</span><span class="mf">1.0d0</span><span class="o">/</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">overlap</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="o">*</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">vtc</span><span class="p">)</span>
<a name="ln-1322"></a>             <span class="k">ELSE IF</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">matid</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1323"></a><span class="k">                </span><span class="n">vaporr1</span><span class="o">=</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">dist</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="o">*</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">mu</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">overlap</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="o">*</span><span class="n">WVDC</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">tempp1</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">))</span>
<a name="ln-1324"></a>             <span class="k">ELSE</span>
<a name="ln-1325"></a><span class="k">                </span><span class="n">vaporr1</span><span class="o">=</span><span class="mf">0.0D0</span>
<a name="ln-1326"></a>             <span class="n">ENDIF</span>
<a name="ln-1327"></a>
<a name="ln-1328"></a>             <span class="k">IF</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">adj</span><span class="p">)%</span><span class="n">htc</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1329"></a><span class="k">                </span><span class="n">thermr2</span><span class="o">=</span><span class="mf">1.0D0</span><span class="o">/</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">overlap</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="o">*</span><span class="n">cells</span><span class="p">(</span><span class="n">adj</span><span class="p">)%</span><span class="n">htc</span><span class="p">)</span>
<a name="ln-1330"></a>             <span class="k">ELSE IF</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">adj</span><span class="p">)%</span><span class="n">matid</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1331"></a><span class="k">                </span><span class="n">thermr2</span><span class="o">=</span><span class="n">cells</span><span class="p">(</span><span class="n">adj</span><span class="p">)%</span><span class="n">dist</span><span class="p">(</span><span class="n">adjl</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">overlap</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="o">*</span><span class="n">cells</span><span class="p">(</span><span class="n">adj</span><span class="p">)%</span><span class="n">wthermalc</span><span class="p">)</span>
<a name="ln-1332"></a>             <span class="k">ELSE</span>
<a name="ln-1333"></a><span class="k">                </span><span class="n">thermr2</span><span class="o">=</span><span class="mf">0.0D0</span>
<a name="ln-1334"></a>             <span class="n">ENDIF</span>
<a name="ln-1335"></a>
<a name="ln-1336"></a>             <span class="k">IF</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">adj</span><span class="p">)%</span><span class="n">vtc</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1337"></a><span class="k">                </span><span class="n">vaporr2</span><span class="o">=</span><span class="mf">1.0D0</span><span class="o">/</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">overlap</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="o">*</span><span class="n">cells</span><span class="p">(</span><span class="n">adj</span><span class="p">)%</span><span class="n">vtc</span><span class="p">)</span>
<a name="ln-1338"></a>             <span class="k">ELSE IF</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">adj</span><span class="p">)%</span><span class="n">matid</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1339"></a><span class="k">                </span><span class="n">vaporr2</span><span class="o">=</span><span class="n">cells</span><span class="p">(</span><span class="n">adj</span><span class="p">)%</span><span class="n">mu</span><span class="o">*</span><span class="n">cells</span><span class="p">(</span><span class="n">adj</span><span class="p">)%</span><span class="n">dist</span><span class="p">(</span><span class="n">adjl</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">WVDC</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">adj</span><span class="p">)%</span><span class="n">tempp1</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">)</span><span class="o">*</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">overlap</span><span class="p">(</span><span class="n">ii</span><span class="p">))</span>
<a name="ln-1340"></a>             <span class="k">ELSE</span>
<a name="ln-1341"></a><span class="k">                </span><span class="n">vaporr2</span><span class="o">=</span><span class="mf">0.0D0</span>
<a name="ln-1342"></a>             <span class="n">ENDIF</span>
<a name="ln-1343"></a>
<a name="ln-1344"></a>             <span class="k">IF</span><span class="p">(</span><span class="n">thermr1</span><span class="o">+</span><span class="n">thermr2</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1345"></a><span class="k">                </span><span class="n">oorsum</span><span class="o">=</span><span class="n">oorsum</span><span class="o">+</span><span class="mf">1.0D0</span><span class="o">/</span><span class="p">(</span><span class="n">thermr1</span><span class="o">+</span><span class="n">thermr2</span><span class="p">)</span>
<a name="ln-1346"></a>                <span class="n">torsum</span><span class="o">=</span><span class="n">torsum</span><span class="o">+</span><span class="n">cells</span><span class="p">(</span><span class="n">adj</span><span class="p">)%</span><span class="n">tempp1</span><span class="o">/</span><span class="p">(</span><span class="n">thermr1</span><span class="o">+</span><span class="n">thermr2</span><span class="p">)</span>
<a name="ln-1347"></a>             <span class="n">ENDIF</span>
<a name="ln-1348"></a>             <span class="k">IF</span><span class="p">(</span><span class="n">vaporr1</span><span class="o">+</span><span class="n">vaporr2</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1349"></a><span class="k">                </span><span class="n">vpdiff</span><span class="o">=</span><span class="n">vpdiff</span><span class="o">+</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">adj</span><span class="p">)%</span><span class="n">vp</span><span class="o">-</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">vp</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">vaporr1</span><span class="o">+</span><span class="n">vaporr2</span><span class="p">)</span>
<a name="ln-1350"></a>             <span class="n">ENDIF</span>
<a name="ln-1351"></a>
<a name="ln-1352"></a>
<a name="ln-1353"></a>          <span class="n">ENDDO</span>
<a name="ln-1354"></a>
<a name="ln-1355"></a>
<a name="ln-1356"></a>          <span class="c">! Calculate Heat Capacitance</span>
<a name="ln-1357"></a>          <span class="n">tcap</span><span class="o">=</span><span class="p">((</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">density</span><span class="o">*</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">spech</span><span class="o">+</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">water</span><span class="o">*</span><span class="n">wspech</span><span class="p">)</span><span class="o">*</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">volume</span><span class="p">)</span>
<a name="ln-1358"></a>
<a name="ln-1359"></a>          <span class="c">! calculate the latent heat if wanted and check for divergence</span>
<a name="ln-1360"></a>          <span class="n">qvp</span><span class="o">=</span><span class="mf">0.0D0</span>
<a name="ln-1361"></a>          <span class="k">IF</span><span class="p">((</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">matid</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">).</span><span class="nb">AND</span><span class="p">.(</span><span class="n">latswitch</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-1362"></a><span class="k">             </span><span class="n">qvp</span><span class="o">=</span><span class="n">vpdiff</span><span class="o">*</span><span class="n">whv</span>
<a name="ln-1363"></a>          <span class="n">ENDIF</span>
<a name="ln-1364"></a>          <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">qvp</span><span class="p">)</span><span class="o">&gt;</span><span class="n">qvplim</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1365"></a><span class="k">             IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1366"></a><span class="k">                </span><span class="n">qvpErrCount</span><span class="o">=</span><span class="n">qvpErrCount</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1367"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">qvpErrCount</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1368"></a><span class="k">                   CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;HeatAndMoistureTransfer: Large Latent Heat for Surface &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1369"></a>                <span class="k">ELSE</span>
<a name="ln-1370"></a><span class="k">                   CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;HeatAndMoistureTransfer: Large Latent Heat Errors &#39;</span><span class="p">,</span><span class="n">qvpErrReport</span><span class="p">)</span>
<a name="ln-1371"></a>                <span class="n">ENDIF</span>
<a name="ln-1372"></a>             <span class="n">ENDIF</span>
<a name="ln-1373"></a>             <span class="n">qvp</span><span class="o">=</span><span class="mf">0.0D0</span>
<a name="ln-1374"></a>          <span class="n">ENDIF</span>
<a name="ln-1375"></a>
<a name="ln-1376"></a>          <span class="c">! Calculate the temperature for the next time step</span>
<a name="ln-1377"></a>          <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">tempp1</span><span class="o">=</span><span class="p">(</span><span class="n">torsum</span><span class="o">+</span><span class="n">qvp</span><span class="o">+</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">Qadds</span><span class="o">+</span><span class="p">(</span><span class="n">tcap</span><span class="o">*</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">temp</span><span class="o">/</span><span class="n">deltat</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">oorsum</span><span class="o">+</span><span class="p">(</span><span class="n">tcap</span><span class="o">/</span><span class="n">deltat</span><span class="p">))</span>
<a name="ln-1378"></a>       <span class="n">ENDDO</span>
<a name="ln-1379"></a>
<a name="ln-1380"></a>       <span class="c">!Check for silly temperatures</span>
<a name="ln-1381"></a>       <span class="n">tempmax</span><span class="o">=</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">cells</span><span class="p">%</span><span class="n">tempp1</span><span class="p">)</span>
<a name="ln-1382"></a>       <span class="n">tempmin</span><span class="o">=</span><span class="nb">MINVAL</span><span class="p">(</span><span class="n">cells</span><span class="p">%</span><span class="n">tempp1</span><span class="p">)</span>
<a name="ln-1383"></a>       <span class="k">IF</span><span class="p">(</span><span class="n">tempmax</span><span class="o">&gt;</span><span class="n">MaxSurfaceTempLimit</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1384"></a><span class="k">          IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1385"></a><span class="k">             IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="n">HighTempErrCount</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1386"></a><span class="k">               CALL </span><span class="n">ShowSevereMessage</span><span class="p">(</span><span class="s1">&#39;HAMT: Temperature (high) out of bounds (&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">tempmax</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1387"></a>                                 <span class="s1">&#39;) for surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1388"></a>               <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-1389"></a>             <span class="n">ENDIF</span>
<a name="ln-1390"></a>             <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;HAMT: Temperature Temperature (high) out of bounds; Surface=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1391"></a>                <span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-1392"></a>                <span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="n">HighTempErrCount</span><span class="p">,</span><span class="n">ReportMinOf</span><span class="o">=</span><span class="n">tempmax</span><span class="p">,</span><span class="n">ReportMinUnits</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1393"></a>                <span class="n">ReportMaxOf</span><span class="o">=</span><span class="n">tempmax</span><span class="p">,</span><span class="n">ReportMaxUnits</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">)</span>
<a name="ln-1394"></a>          <span class="n">ENDIF</span>
<a name="ln-1395"></a>       <span class="n">ENDIF</span>
<a name="ln-1396"></a>       <span class="k">IF</span><span class="p">(</span><span class="n">tempmax</span><span class="o">&gt;</span><span class="n">MaxSurfaceTempLimitBeforeFatal</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1397"></a><span class="k">          IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1398"></a><span class="k">             CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;HAMT: HAMT: Temperature (high) out of bounds ( &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">tempmax</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1399"></a>                                 <span class="s1">&#39;) for surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1400"></a>             <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-1401"></a>             <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Program terminates due to preceding condition.&#39;</span><span class="p">)</span>
<a name="ln-1402"></a>          <span class="n">ENDIF</span>
<a name="ln-1403"></a>       <span class="n">ENDIF</span>
<a name="ln-1404"></a>       <span class="k">IF</span><span class="p">(</span><span class="n">tempmin</span><span class="o">&lt;</span><span class="n">MinSurfaceTempLimit</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1405"></a><span class="k">          IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1406"></a><span class="k">             IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="n">HighTempErrCount</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1407"></a><span class="k">               CALL </span><span class="n">ShowSevereMessage</span><span class="p">(</span><span class="s1">&#39;HAMT: Temperature (low) out of bounds (&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">tempmin</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1408"></a>                                 <span class="s1">&#39;) for surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1409"></a>               <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-1410"></a>             <span class="n">ENDIF</span>
<a name="ln-1411"></a>             <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;HAMT: Temperature Temperature (high) out of bounds; Surface=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1412"></a>                <span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-1413"></a>                <span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="n">HighTempErrCount</span><span class="p">,</span><span class="n">ReportMinOf</span><span class="o">=</span><span class="n">tempmin</span><span class="p">,</span><span class="n">ReportMinUnits</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1414"></a>                <span class="n">ReportMaxOf</span><span class="o">=</span><span class="n">tempmin</span><span class="p">,</span><span class="n">ReportMaxUnits</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">)</span>
<a name="ln-1415"></a>          <span class="n">ENDIF</span>
<a name="ln-1416"></a>       <span class="n">ENDIF</span>
<a name="ln-1417"></a>       <span class="k">IF</span><span class="p">(</span><span class="n">tempmin</span><span class="o">&lt;</span><span class="n">MinSurfaceTempLimitBeforeFatal</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1418"></a><span class="k">          IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1419"></a><span class="k">             CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;HAMT: HAMT: Temperature (low) out of bounds ( &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">tempmin</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1420"></a>                                 <span class="s1">&#39;) for surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1421"></a>             <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-1422"></a>             <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Program terminates due to preceding condition.&#39;</span><span class="p">)</span>
<a name="ln-1423"></a>          <span class="n">ENDIF</span>
<a name="ln-1424"></a>       <span class="n">ENDIF</span>
<a name="ln-1425"></a>
<a name="ln-1426"></a>
<a name="ln-1427"></a>       <span class="c">! Calculate the liquid and vapor resisitances</span>
<a name="ln-1428"></a>       <span class="k">DO </span><span class="n">cid</span><span class="o">=</span><span class="n">Extcell</span><span class="p">(</span><span class="n">sid</span><span class="p">),</span><span class="n">Intcell</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span>
<a name="ln-1429"></a>          <span class="n">phioosum</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1430"></a>          <span class="n">phiorsum</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1431"></a>          <span class="n">vpoosum</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1432"></a>          <span class="n">vporsum</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1433"></a>
<a name="ln-1434"></a>          <span class="k">DO </span><span class="n">ii</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">adjmax</span>
<a name="ln-1435"></a>             <span class="n">adj</span><span class="o">=</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">adjs</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span>
<a name="ln-1436"></a>             <span class="n">adjl</span><span class="o">=</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">adjsl</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span>
<a name="ln-1437"></a>             <span class="k">IF</span><span class="p">(</span><span class="n">adj</span><span class="o">==-</span><span class="mi">1</span><span class="p">)</span><span class="k">EXIT</span>
<a name="ln-1438"></a>
<a name="ln-1439"></a><span class="k">             IF</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">vtc</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1440"></a><span class="k">                </span><span class="n">vaporr1</span><span class="o">=</span><span class="mf">1.0d0</span><span class="o">/</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">overlap</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="o">*</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">vtc</span><span class="p">)</span>
<a name="ln-1441"></a>             <span class="k">ELSE IF</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">matid</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1442"></a><span class="k">                </span><span class="n">vaporr1</span><span class="o">=</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">dist</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="o">*</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">mu</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">overlap</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="o">*</span><span class="n">WVDC</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">tempp1</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">))</span>
<a name="ln-1443"></a>             <span class="k">ELSE</span>
<a name="ln-1444"></a><span class="k">                </span><span class="n">vaporr1</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1445"></a>             <span class="n">ENDIF</span>
<a name="ln-1446"></a>
<a name="ln-1447"></a>             <span class="k">IF</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">adj</span><span class="p">)%</span><span class="n">vtc</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1448"></a><span class="k">                </span><span class="n">vaporr2</span><span class="o">=</span><span class="mf">1.0d0</span><span class="o">/</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">overlap</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="o">*</span><span class="n">cells</span><span class="p">(</span><span class="n">adj</span><span class="p">)%</span><span class="n">vtc</span><span class="p">)</span>
<a name="ln-1449"></a>             <span class="k">ELSE IF</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">adj</span><span class="p">)%</span><span class="n">matid</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1450"></a><span class="k">                </span><span class="n">vaporr2</span><span class="o">=</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">adj</span><span class="p">)%</span><span class="n">dist</span><span class="p">(</span><span class="n">adjl</span><span class="p">)</span><span class="o">*</span><span class="n">cells</span><span class="p">(</span><span class="n">adj</span><span class="p">)%</span><span class="n">mu</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">overlap</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="o">*</span><span class="n">WVDC</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">adj</span><span class="p">)%</span><span class="n">tempp1</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">))</span>
<a name="ln-1451"></a>             <span class="k">ELSE</span>
<a name="ln-1452"></a><span class="k">                </span><span class="n">vaporr2</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1453"></a>             <span class="n">ENDIF</span>
<a name="ln-1454"></a>             <span class="k">IF</span><span class="p">(</span><span class="n">vaporr1</span><span class="o">+</span><span class="n">vaporr2</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1455"></a><span class="k">                </span><span class="n">vpoosum</span><span class="o">=</span><span class="n">vpoosum</span><span class="o">+</span><span class="mf">1.0d0</span><span class="o">/</span><span class="p">(</span><span class="n">vaporr1</span><span class="o">+</span><span class="n">vaporr2</span><span class="p">)</span>
<a name="ln-1456"></a>                <span class="n">vporsum</span><span class="o">=</span><span class="n">vporsum</span><span class="o">+</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">adj</span><span class="p">)%</span><span class="n">vpp1</span><span class="o">/</span><span class="p">(</span><span class="n">vaporr1</span><span class="o">+</span><span class="n">vaporr2</span><span class="p">))</span>
<a name="ln-1457"></a>             <span class="n">ENDIF</span>
<a name="ln-1458"></a>
<a name="ln-1459"></a>             <span class="k">IF</span><span class="p">((</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">dw</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">).</span><span class="nb">AND</span><span class="p">.(</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">dwdphi</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-1460"></a><span class="k">                </span><span class="n">rhr1</span><span class="o">=</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">dist</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">overlap</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="o">*</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">dw</span><span class="o">*</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">dwdphi</span><span class="p">)</span>
<a name="ln-1461"></a>             <span class="k">ELSE</span>
<a name="ln-1462"></a><span class="k">                </span><span class="n">rhr1</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1463"></a>             <span class="n">ENDIF</span>
<a name="ln-1464"></a>             <span class="k">IF</span><span class="p">((</span><span class="n">cells</span><span class="p">(</span><span class="n">adj</span><span class="p">)%</span><span class="n">dw</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">).</span><span class="nb">AND</span><span class="p">.(</span><span class="n">cells</span><span class="p">(</span><span class="n">adj</span><span class="p">)%</span><span class="n">dwdphi</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-1465"></a><span class="k">                </span><span class="n">rhr2</span><span class="o">=</span><span class="n">cells</span><span class="p">(</span><span class="n">adj</span><span class="p">)%</span><span class="n">dist</span><span class="p">(</span><span class="n">adjl</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">overlap</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="o">*</span><span class="n">cells</span><span class="p">(</span><span class="n">adj</span><span class="p">)%</span><span class="n">dw</span><span class="o">*</span><span class="n">cells</span><span class="p">(</span><span class="n">adj</span><span class="p">)%</span><span class="n">dwdphi</span><span class="p">)</span>
<a name="ln-1466"></a>             <span class="k">ELSE</span>
<a name="ln-1467"></a><span class="k">                </span><span class="n">rhr2</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1468"></a>             <span class="n">ENDIF</span>
<a name="ln-1469"></a>
<a name="ln-1470"></a>             <span class="c">!             IF(rhr1+rhr2&gt;0)THEN</span>
<a name="ln-1471"></a>             <span class="k">IF</span><span class="p">(</span><span class="n">rhr1</span><span class="o">*</span><span class="n">rhr2</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1472"></a><span class="k">                </span><span class="n">phioosum</span><span class="o">=</span><span class="n">phioosum</span><span class="o">+</span><span class="mf">1.0d0</span><span class="o">/</span><span class="p">(</span><span class="n">rhr1</span><span class="o">+</span><span class="n">rhr2</span><span class="p">)</span>
<a name="ln-1473"></a>                <span class="n">phiorsum</span><span class="o">=</span><span class="n">phiorsum</span><span class="o">+</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">adj</span><span class="p">)%</span><span class="n">rhp1</span><span class="o">/</span><span class="p">(</span><span class="n">rhr1</span><span class="o">+</span><span class="n">rhr2</span><span class="p">))</span>
<a name="ln-1474"></a>             <span class="n">ENDIF</span>
<a name="ln-1475"></a>
<a name="ln-1476"></a>          <span class="n">ENDDO</span>
<a name="ln-1477"></a>
<a name="ln-1478"></a>          <span class="c">! Moisture Capacitance</span>
<a name="ln-1479"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">dwdphi</span><span class="o">&gt;</span><span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1480"></a><span class="k">             </span><span class="n">wcap</span><span class="o">=</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">dwdphi</span><span class="o">*</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">volume</span>
<a name="ln-1481"></a>          <span class="k">ELSE</span>
<a name="ln-1482"></a><span class="k">             </span><span class="n">wcap</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1483"></a>          <span class="n">ENDIF</span>
<a name="ln-1484"></a>
<a name="ln-1485"></a>          <span class="c">! Calculate the RH for the next time step</span>
<a name="ln-1486"></a>          <span class="n">denominator</span><span class="o">=</span><span class="p">(</span><span class="n">phioosum</span><span class="o">+</span><span class="n">vpoosum</span><span class="o">*</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">vpsat</span><span class="o">+</span><span class="n">wcap</span><span class="o">/</span><span class="n">deltat</span><span class="p">)</span>
<a name="ln-1487"></a>          <span class="k">if</span> <span class="p">(</span><span class="n">denominator</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1488"></a><span class="k">            </span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">rhp1</span><span class="o">=</span><span class="p">(</span><span class="n">phiorsum</span><span class="o">+</span><span class="n">vporsum</span><span class="o">+</span><span class="p">(</span><span class="n">wcap</span><span class="o">*</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">rh</span><span class="p">)</span><span class="o">/</span><span class="n">deltat</span><span class="p">)</span><span class="o">/</span><span class="n">denominator</span>
<a name="ln-1489"></a>          <span class="k">else</span>
<a name="ln-1490"></a><span class="k">            call </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;CalcHeatBalHAMT: demoninator in calculating RH is zero.  Check material properties for accuracy.&#39;</span><span class="p">)</span>
<a name="ln-1491"></a>            <span class="k">call </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Problem occurs in Material=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">MatID</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1492"></a>            <span class="k">call </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Program terminates due to preceding condition.&#39;</span><span class="p">)</span>
<a name="ln-1493"></a>          <span class="n">endif</span>
<a name="ln-1494"></a>
<a name="ln-1495"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">rhp1</span><span class="o">&gt;</span><span class="n">rhmax</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1496"></a><span class="k">             </span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">rhp1</span><span class="o">=</span><span class="n">rhmax</span>
<a name="ln-1497"></a>          <span class="n">ENDIF</span>
<a name="ln-1498"></a>       <span class="n">ENDDO</span>
<a name="ln-1499"></a>
<a name="ln-1500"></a>       <span class="c">!Check for convergence or too many itterations</span>
<a name="ln-1501"></a>       <span class="n">sumtp1</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1502"></a>       <span class="k">DO </span><span class="n">cid</span><span class="o">=</span><span class="n">Extcell</span><span class="p">(</span><span class="n">sid</span><span class="p">),</span><span class="n">Intcell</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span>
<a name="ln-1503"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">sumtp1</span><span class="o">&lt;</span><span class="nb">ABS</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">tempp2</span><span class="o">-</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">tempp1</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-1504"></a><span class="k">             </span><span class="n">sumtp1</span><span class="o">=</span><span class="nb">ABS</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">tempp2</span><span class="o">-</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">tempp1</span><span class="p">)</span>
<a name="ln-1505"></a>          <span class="n">ENDIF</span>
<a name="ln-1506"></a>       <span class="n">ENDDO</span>
<a name="ln-1507"></a>       <span class="k">IF</span><span class="p">(</span><span class="n">sumtp1</span><span class="o">&lt;</span><span class="n">convt</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1508"></a><span class="k">          EXIT</span>
<a name="ln-1509"></a><span class="k">       </span><span class="n">ENDIF</span>
<a name="ln-1510"></a>       <span class="k">IF</span><span class="p">(</span><span class="n">itter</span><span class="o">&gt;</span><span class="n">ittermax</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1511"></a><span class="k">          EXIT</span>
<a name="ln-1512"></a><span class="k">       </span><span class="n">ENDIF</span>
<a name="ln-1513"></a>       <span class="k">DO </span><span class="n">cid</span><span class="o">=</span><span class="n">firstcell</span><span class="p">(</span><span class="n">sid</span><span class="p">),</span><span class="n">lastcell</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span>
<a name="ln-1514"></a>          <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">tempp2</span><span class="o">=</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">tempp1</span>
<a name="ln-1515"></a>          <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">rhp2</span><span class="o">=</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">rhp1</span>
<a name="ln-1516"></a>       <span class="n">ENDDO</span>
<a name="ln-1517"></a>    <span class="n">ENDDO</span>
<a name="ln-1518"></a>
<a name="ln-1519"></a>
<a name="ln-1520"></a>    <span class="c">! report back to CalcHeatBalanceInsideSurf</span>
<a name="ln-1521"></a>    <span class="n">TempSurfOutTmp</span><span class="o">=</span><span class="n">cells</span><span class="p">(</span><span class="n">Extcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">tempp1</span>
<a name="ln-1522"></a>    <span class="n">TempSurfInTmp</span><span class="o">=</span><span class="n">cells</span><span class="p">(</span><span class="n">Intcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">tempp1</span>
<a name="ln-1523"></a>
<a name="ln-1524"></a>    <span class="n">TempSurfInP</span><span class="o">=</span><span class="n">cells</span><span class="p">(</span><span class="n">Intcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">rhp1</span><span class="o">*</span><span class="n">PsyPsatFnTemp</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">Intcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">tempp1</span><span class="p">)</span>
<a name="ln-1525"></a>
<a name="ln-1526"></a>    <span class="n">RhoVaporSurfIn</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">=</span><span class="n">TempSurfInP</span><span class="o">/</span><span class="p">(</span><span class="mi">46</span><span class="mf">1.52d0</span><span class="o">*</span><span class="p">(</span><span class="n">Mat</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">sid</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)</span><span class="o">+</span><span class="n">KelvinConv</span><span class="p">))</span>
<a name="ln-1527"></a>
<a name="ln-1528"></a>  <span class="k">END SUBROUTINE </span><span class="n">CalcHeatBalHAMT</span>
<a name="ln-1529"></a>  <span class="k">SUBROUTINE </span><span class="n">UpdateHeatBalHAMT</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span>
<a name="ln-1530"></a>    <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1531"></a>    <span class="c">!       AUTHOR         Phillip Biddulph</span>
<a name="ln-1532"></a>    <span class="c">!       DATE WRITTEN   June 2008</span>
<a name="ln-1533"></a>    <span class="c">!       MODIFIED       na</span>
<a name="ln-1534"></a>    <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1535"></a>
<a name="ln-1536"></a>    <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1537"></a>    <span class="c">! The zone heat balance equation has converged, so now the HAMT values are to be fixed</span>
<a name="ln-1538"></a>    <span class="c">! ready for the next itteration.</span>
<a name="ln-1539"></a>    <span class="c">! Fill all the report variables</span>
<a name="ln-1540"></a>
<a name="ln-1541"></a>    <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1542"></a>    <span class="c">! na</span>
<a name="ln-1543"></a>
<a name="ln-1544"></a>    <span class="c">! REFERENCES:</span>
<a name="ln-1545"></a>    <span class="c">! na</span>
<a name="ln-1546"></a>
<a name="ln-1547"></a>    <span class="c">! USE STATEMENTS:</span>
<a name="ln-1548"></a>    <span class="c">! na</span>
<a name="ln-1549"></a>
<a name="ln-1550"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1551"></a>
<a name="ln-1552"></a>    <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1553"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sid</span>
<a name="ln-1554"></a>
<a name="ln-1555"></a>
<a name="ln-1556"></a>    <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1557"></a>    <span class="c">! na</span>
<a name="ln-1558"></a>
<a name="ln-1559"></a>    <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-1560"></a>    <span class="c">! na</span>
<a name="ln-1561"></a>
<a name="ln-1562"></a>    <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-1563"></a>    <span class="c">! na</span>
<a name="ln-1564"></a>
<a name="ln-1565"></a>    <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1566"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">cid</span>
<a name="ln-1567"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">watermass</span>
<a name="ln-1568"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">matmass</span>
<a name="ln-1569"></a><span class="c">!unused1208    REAL(r64), SAVE :: InOld=0.0D0</span>
<a name="ln-1570"></a><span class="c">!unused1208    REAL(r64), SAVE :: OutOld=0.0D0</span>
<a name="ln-1571"></a>
<a name="ln-1572"></a>
<a name="ln-1573"></a>    <span class="c">!Update Temperatures and RHs. Calculate report variables</span>
<a name="ln-1574"></a>    <span class="n">matmass</span><span class="o">=</span><span class="mf">0.0D0</span>
<a name="ln-1575"></a>    <span class="n">watermass</span><span class="o">=</span><span class="mf">0.0D0</span>
<a name="ln-1576"></a>    <span class="k">DO </span><span class="n">cid</span><span class="o">=</span><span class="n">firstcell</span><span class="p">(</span><span class="n">sid</span><span class="p">),</span><span class="n">lastcell</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span>
<a name="ln-1577"></a>       <span class="c">! fix HAMT values for this surface</span>
<a name="ln-1578"></a>       <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">temp</span><span class="o">=</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">tempp1</span>
<a name="ln-1579"></a>       <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">rh</span><span class="o">=</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">rhp1</span>
<a name="ln-1580"></a>       <span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">rhp</span><span class="o">=</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">rh</span><span class="o">*</span><span class="mi">10</span><span class="mf">0.d0</span>
<a name="ln-1581"></a>       <span class="k">IF</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">density</span><span class="o">&gt;</span><span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1582"></a><span class="k">          </span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">wreport</span><span class="o">=</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">water</span><span class="o">/</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">density</span>
<a name="ln-1583"></a>          <span class="n">watermass</span><span class="o">=</span><span class="n">watermass</span><span class="o">+</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">water</span><span class="o">*</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">volume</span><span class="p">)</span>
<a name="ln-1584"></a>          <span class="n">matmass</span><span class="o">=</span><span class="n">matmass</span><span class="o">+</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">density</span><span class="o">*</span><span class="n">cells</span><span class="p">(</span><span class="n">cid</span><span class="p">)%</span><span class="n">volume</span><span class="p">)</span>
<a name="ln-1585"></a>       <span class="n">ENDIF</span>
<a name="ln-1586"></a>    <span class="n">ENDDO</span>
<a name="ln-1587"></a>
<a name="ln-1588"></a>    <span class="n">watertot</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1589"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">matmass</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">watertot</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">=</span><span class="n">watermass</span><span class="o">/</span><span class="n">matmass</span>
<a name="ln-1590"></a>
<a name="ln-1591"></a>    <span class="n">surfrh</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">=</span><span class="mi">10</span><span class="mf">0.0d0</span><span class="o">*</span><span class="n">cells</span><span class="p">(</span><span class="n">Intcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">rh</span>
<a name="ln-1592"></a>    <span class="n">surfextrh</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">=</span><span class="mi">10</span><span class="mf">0.0d0</span><span class="o">*</span><span class="n">cells</span><span class="p">(</span><span class="n">Extcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">rh</span>
<a name="ln-1593"></a>    <span class="n">surftemp</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">=</span><span class="n">cells</span><span class="p">(</span><span class="n">Intcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">temp</span>
<a name="ln-1594"></a>    <span class="n">surfexttemp</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">=</span><span class="n">cells</span><span class="p">(</span><span class="n">Extcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">temp</span>
<a name="ln-1595"></a>    <span class="n">surfvp</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">=</span><span class="n">RHTOVP</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">Intcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">rh</span><span class="p">,</span><span class="n">cells</span><span class="p">(</span><span class="n">Intcell</span><span class="p">(</span><span class="n">sid</span><span class="p">))%</span><span class="n">temp</span><span class="p">)</span>
<a name="ln-1596"></a>
<a name="ln-1597"></a>  <span class="k">END SUBROUTINE </span><span class="n">UpdateHeatBalHAMT</span>
<a name="ln-1598"></a>
<a name="ln-1599"></a>  <span class="k">SUBROUTINE </span><span class="n">interp</span><span class="p">(</span><span class="n">ndata</span><span class="p">,</span><span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="p">,</span><span class="n">invalue</span><span class="p">,</span><span class="n">outvalue</span><span class="p">,</span><span class="n">outgrad</span><span class="p">)</span>
<a name="ln-1600"></a>    <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1601"></a>    <span class="c">!       AUTHOR         Phillip Biddulph</span>
<a name="ln-1602"></a>    <span class="c">!       DATE WRITTEN   June 2008</span>
<a name="ln-1603"></a>    <span class="c">!       MODIFIED       na</span>
<a name="ln-1604"></a>    <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1605"></a>
<a name="ln-1606"></a>    <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1607"></a>    <span class="c">! To find a value by searching an array and interpolating between two coordinates</span>
<a name="ln-1608"></a>    <span class="c">! Also returns the gradient if required.</span>
<a name="ln-1609"></a>
<a name="ln-1610"></a>    <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1611"></a>    <span class="c">! Simple search</span>
<a name="ln-1612"></a>
<a name="ln-1613"></a>    <span class="c">! REFERENCES:</span>
<a name="ln-1614"></a>    <span class="c">! na</span>
<a name="ln-1615"></a>
<a name="ln-1616"></a>    <span class="c">! USE STATEMENTS:</span>
<a name="ln-1617"></a>    <span class="c">! na</span>
<a name="ln-1618"></a>
<a name="ln-1619"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1620"></a>
<a name="ln-1621"></a>    <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1622"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ndata</span>
<a name="ln-1623"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">ndata</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xx</span>
<a name="ln-1624"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">ndata</span><span class="p">)</span> <span class="kd">::</span> <span class="n">yy</span>
<a name="ln-1625"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">invalue</span>
<a name="ln-1626"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">outvalue</span>
<a name="ln-1627"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">outgrad</span>
<a name="ln-1628"></a>
<a name="ln-1629"></a>
<a name="ln-1630"></a>    <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1631"></a>    <span class="c">! na</span>
<a name="ln-1632"></a>
<a name="ln-1633"></a>    <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-1634"></a>    <span class="c">! na</span>
<a name="ln-1635"></a>
<a name="ln-1636"></a>    <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-1637"></a>    <span class="c">! na</span>
<a name="ln-1638"></a>
<a name="ln-1639"></a>    <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1640"></a>
<a name="ln-1641"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xxlow</span>
<a name="ln-1642"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xxhigh</span>
<a name="ln-1643"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">yylow</span>
<a name="ln-1644"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">yyhigh</span>
<a name="ln-1645"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">mygrad</span>
<a name="ln-1646"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">step</span>
<a name="ln-1647"></a>
<a name="ln-1648"></a>    <span class="n">mygrad</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1649"></a>    <span class="n">outvalue</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1650"></a>
<a name="ln-1651"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">ndata</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1652"></a><span class="k">       </span><span class="n">xxlow</span><span class="o">=</span><span class="n">xx</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1653"></a>       <span class="n">yylow</span><span class="o">=</span><span class="n">yy</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1654"></a>       <span class="k">DO </span><span class="n">step</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">ndata</span>
<a name="ln-1655"></a>          <span class="n">xxhigh</span><span class="o">=</span><span class="n">xx</span><span class="p">(</span><span class="n">step</span><span class="p">)</span>
<a name="ln-1656"></a>          <span class="n">yyhigh</span><span class="o">=</span><span class="n">yy</span><span class="p">(</span><span class="n">step</span><span class="p">)</span>
<a name="ln-1657"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">invalue</span><span class="o">&lt;=</span><span class="n">xxhigh</span><span class="p">)</span><span class="k">EXIT</span>
<a name="ln-1658"></a><span class="k">          </span><span class="n">xxlow</span><span class="o">=</span><span class="n">xxhigh</span>
<a name="ln-1659"></a>          <span class="n">yylow</span><span class="o">=</span><span class="n">yyhigh</span>
<a name="ln-1660"></a>       <span class="n">ENDDO</span>
<a name="ln-1661"></a>
<a name="ln-1662"></a>       <span class="k">IF</span><span class="p">(</span><span class="n">xxhigh</span><span class="o">&gt;</span><span class="n">xxlow</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1663"></a><span class="k">          </span><span class="n">mygrad</span><span class="o">=</span><span class="p">(</span><span class="n">yyhigh</span><span class="o">-</span><span class="n">yylow</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">xxhigh</span><span class="o">-</span><span class="n">xxlow</span><span class="p">)</span>
<a name="ln-1664"></a>          <span class="n">outvalue</span><span class="o">=</span><span class="p">(</span><span class="n">invalue</span><span class="o">-</span><span class="n">xxlow</span><span class="p">)</span><span class="o">*</span><span class="n">mygrad</span><span class="o">+</span><span class="n">yylow</span>
<a name="ln-1665"></a><span class="c">! PDB August 2009 bug fix</span>
<a name="ln-1666"></a>        <span class="k">else if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">xxhigh</span><span class="o">-</span><span class="n">xxlow</span><span class="p">)</span><span class="o">&lt;</span><span class="mf">0.0000000001d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1667"></a><span class="k">          </span><span class="n">outvalue</span><span class="o">=</span><span class="n">yylow</span>
<a name="ln-1668"></a>      <span class="n">ENDIF</span>
<a name="ln-1669"></a>    <span class="n">ENDIF</span>
<a name="ln-1670"></a>
<a name="ln-1671"></a>    <span class="k">IF</span><span class="p">(</span> <span class="nb">PRESENT</span><span class="p">(</span><span class="n">outgrad</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1672"></a>       <span class="c">! return gradient if required</span>
<a name="ln-1673"></a>       <span class="n">outgrad</span><span class="o">=</span><span class="n">mygrad</span>
<a name="ln-1674"></a>    <span class="n">ENDIF</span>
<a name="ln-1675"></a>    <span class="k">RETURN</span>
<a name="ln-1676"></a><span class="k">  END SUBROUTINE </span><span class="n">interp</span>
<a name="ln-1677"></a>
<a name="ln-1678"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">RHtoVP</span><span class="p">(</span><span class="n">RH</span><span class="p">,</span><span class="n">Temperature</span><span class="p">)</span>
<a name="ln-1679"></a>    <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-1680"></a>    <span class="c">!       AUTHOR         Phillip Biddulph</span>
<a name="ln-1681"></a>    <span class="c">!       DATE WRITTEN   June 2008</span>
<a name="ln-1682"></a>    <span class="c">!       MODIFIED       na</span>
<a name="ln-1683"></a>    <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1684"></a>
<a name="ln-1685"></a>    <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-1686"></a>    <span class="c">! Convert Relative Humidity and Temperature to Vapor Pressure</span>
<a name="ln-1687"></a>
<a name="ln-1688"></a>    <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1689"></a>    <span class="c">! &lt;description&gt;</span>
<a name="ln-1690"></a>
<a name="ln-1691"></a>    <span class="c">! REFERENCES:</span>
<a name="ln-1692"></a>    <span class="c">! na</span>
<a name="ln-1693"></a>
<a name="ln-1694"></a>    <span class="c">! USE STATEMENTS:</span>
<a name="ln-1695"></a>    <span class="c">! na</span>
<a name="ln-1696"></a>
<a name="ln-1697"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1698"></a>
<a name="ln-1699"></a>    <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-1700"></a>
<a name="ln-1701"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RH</span>
<a name="ln-1702"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Temperature</span>
<a name="ln-1703"></a>
<a name="ln-1704"></a>
<a name="ln-1705"></a>    <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-1706"></a>    <span class="c">! na</span>
<a name="ln-1707"></a>
<a name="ln-1708"></a>    <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-1709"></a>    <span class="c">! na</span>
<a name="ln-1710"></a>
<a name="ln-1711"></a>    <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-1712"></a>    <span class="c">! na</span>
<a name="ln-1713"></a>
<a name="ln-1714"></a>    <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1715"></a>
<a name="ln-1716"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">VPSat</span>
<a name="ln-1717"></a>
<a name="ln-1718"></a>    <span class="n">VPSat</span><span class="o">=</span><span class="n">PsyPsatFnTemp</span><span class="p">(</span><span class="n">Temperature</span><span class="p">)</span>
<a name="ln-1719"></a>
<a name="ln-1720"></a>    <span class="n">RHtoVP</span><span class="o">=</span><span class="n">RH</span><span class="o">*</span><span class="n">VPsat</span>
<a name="ln-1721"></a>
<a name="ln-1722"></a>    <span class="k">RETURN</span>
<a name="ln-1723"></a><span class="k">  END FUNCTION </span><span class="n">RHtoVP</span>
<a name="ln-1724"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">WVDC</span><span class="p">(</span><span class="n">Temperature</span><span class="p">,</span><span class="n">ambp</span><span class="p">)</span>
<a name="ln-1725"></a>    <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-1726"></a>    <span class="c">!       AUTHOR         Phillip Biddulph</span>
<a name="ln-1727"></a>    <span class="c">!       DATE WRITTEN   June 2008</span>
<a name="ln-1728"></a>    <span class="c">!       MODIFIED       na</span>
<a name="ln-1729"></a>    <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1730"></a>
<a name="ln-1731"></a>    <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-1732"></a>    <span class="c">! To calculate the Water Vapor Diffusion Coefficient in air</span>
<a name="ln-1733"></a>    <span class="c">! using the temperature and ambient atmospheric pressor</span>
<a name="ln-1734"></a>
<a name="ln-1735"></a>    <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1736"></a>    <span class="c">! na</span>
<a name="ln-1737"></a>
<a name="ln-1738"></a>    <span class="c">! REFERENCES:</span>
<a name="ln-1739"></a>    <span class="c">! K?zel, H.M. (1995) Simultaneous Heat and Moisture Transport in Building Components.</span>
<a name="ln-1740"></a>    <span class="c">! One- and two-dimensional calculation using simple parameters. IRB Verlag 1995</span>
<a name="ln-1741"></a>
<a name="ln-1742"></a>    <span class="c">! USE STATEMENTS:</span>
<a name="ln-1743"></a>    <span class="c">! na</span>
<a name="ln-1744"></a>
<a name="ln-1745"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1746"></a>
<a name="ln-1747"></a>    <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-1748"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Temperature</span>
<a name="ln-1749"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ambp</span>
<a name="ln-1750"></a>
<a name="ln-1751"></a>
<a name="ln-1752"></a>    <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-1753"></a>    <span class="c">! na</span>
<a name="ln-1754"></a>
<a name="ln-1755"></a>    <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-1756"></a>    <span class="c">! na</span>
<a name="ln-1757"></a>
<a name="ln-1758"></a>    <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-1759"></a>    <span class="c">! na</span>
<a name="ln-1760"></a>
<a name="ln-1761"></a>    <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1762"></a>    <span class="c">! na</span>
<a name="ln-1763"></a>    <span class="c">!</span>
<a name="ln-1764"></a>
<a name="ln-1765"></a>
<a name="ln-1766"></a>    <span class="n">WVDC</span><span class="o">=</span><span class="p">(</span><span class="mf">2.d-7</span><span class="o">*</span><span class="p">(</span><span class="n">Temperature</span><span class="o">+</span><span class="n">KelvinConv</span><span class="p">)</span><span class="o">**</span><span class="mf">0.81d0</span><span class="p">)</span><span class="o">/</span><span class="n">ambp</span>
<a name="ln-1767"></a>
<a name="ln-1768"></a>    <span class="k">RETURN</span>
<a name="ln-1769"></a><span class="k">  END FUNCTION </span><span class="n">WVDC</span>
<a name="ln-1770"></a>
<a name="ln-1771"></a><span class="c">!</span>
<a name="ln-1772"></a><span class="c">!                                 COPYRIGHT NOTICE</span>
<a name="ln-1773"></a><span class="c">!</span>
<a name="ln-1774"></a><span class="c">!     Portions Copyright ?University College London 2007.  All rights</span>
<a name="ln-1775"></a><span class="c">!     reserved.</span>
<a name="ln-1776"></a><span class="c">!</span>
<a name="ln-1777"></a><span class="c">!     UCL LEGAL NOTICE</span>
<a name="ln-1778"></a><span class="c">!     Neither UCL, members of UCL nor any person or organisation acting on</span>
<a name="ln-1779"></a><span class="c">!     behalf of either:</span>
<a name="ln-1780"></a><span class="c">!</span>
<a name="ln-1781"></a><span class="c">!     A. Makes any warranty of representation, express or implied with</span>
<a name="ln-1782"></a><span class="c">!        respect to the accuracy, completeness, or usefulness of the</span>
<a name="ln-1783"></a><span class="c">!        information contained in this program, including any warranty of</span>
<a name="ln-1784"></a><span class="c">!        merchantability or fitness of any purpose with respect to the</span>
<a name="ln-1785"></a><span class="c">!        program, or that the use of any information disclosed in this</span>
<a name="ln-1786"></a><span class="c">!        program may not infringe privately-owned rights, or</span>
<a name="ln-1787"></a><span class="c">!</span>
<a name="ln-1788"></a><span class="c">!     B. Assumes any liability with respect to the use of, or for any and</span>
<a name="ln-1789"></a><span class="c">!        all damages resulting from the use of the program or any portion</span>
<a name="ln-1790"></a><span class="c">!        thereof or any information disclosed therein.</span>
<a name="ln-1791"></a><span class="c">!</span>
<a name="ln-1792"></a><span class="c">!</span>
<a name="ln-1793"></a><span class="c">!     NOTICE</span>
<a name="ln-1794"></a><span class="c">!</span>
<a name="ln-1795"></a><span class="c">!     Copyright © 1996-2013 The Board of Trustees of the University of</span>
<a name="ln-1796"></a><span class="c">!     Illinois and The Regents of the University of California through</span>
<a name="ln-1797"></a><span class="c">!     Ernest Orlando Lawrence Berkeley National Laboratory.  All rights</span>
<a name="ln-1798"></a><span class="c">!     reserved.</span>
<a name="ln-1799"></a><span class="c">!</span>
<a name="ln-1800"></a><span class="c">!     Portions of the EnergyPlus software package have been developed and</span>
<a name="ln-1801"></a><span class="c">!     copyrighted by other individuals, companies and institutions.  These</span>
<a name="ln-1802"></a><span class="c">!     portions have been incorporated into the EnergyPlus software package</span>
<a name="ln-1803"></a><span class="c">!     under license.  For a complete list of contributors, see &quot;Notice&quot;</span>
<a name="ln-1804"></a><span class="c">!     located in EnergyPlus.f90.</span>
<a name="ln-1805"></a><span class="c">!</span>
<a name="ln-1806"></a><span class="c">!     NOTICE: The U.S. Government is granted for itself and others acting</span>
<a name="ln-1807"></a><span class="c">!     on its behalf a paid-up, nonexclusive, irrevocable, worldwide license</span>
<a name="ln-1808"></a><span class="c">!     in this data to reproduce, prepare derivative works, and perform</span>
<a name="ln-1809"></a><span class="c">!     publicly and display publicly. Beginning five (5) years after</span>
<a name="ln-1810"></a><span class="c">!     permission to assert copyright is granted, subject to two possible</span>
<a name="ln-1811"></a><span class="c">!     five year renewals, the U.S. Government is granted for itself and</span>
<a name="ln-1812"></a><span class="c">!     others acting on its behalf a paid-up, non-exclusive, irrevocable</span>
<a name="ln-1813"></a><span class="c">!     worldwide license in this data to reproduce, prepare derivative works,</span>
<a name="ln-1814"></a><span class="c">!     distribute copies to the public, perform publicly and display</span>
<a name="ln-1815"></a><span class="c">!     publicly, and to permit others to do so.</span>
<a name="ln-1816"></a><span class="c">!</span>
<a name="ln-1817"></a><span class="c">!     TRADEMARKS: EnergyPlus is a trademark of the US Department of Energy.</span>
<a name="ln-1818"></a><span class="c">!</span>
<a name="ln-1819"></a>
<a name="ln-1820"></a><span class="k">END MODULE </span><span class="n">HeatBalanceHAMTManager</span>
</pre></div>

    </section>
    </div>
  </div>

  <section class="visible-xs visible-sm hidden-md">
    <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-1">All Source Files</a></h3></div>
  <div id="allfiles-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


  </section>

    <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2017 </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by
            <a href="https://github.com/cmacmackin/ford">FORD</a>

          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> EnergyPlusFortran</p></div>
      </div>
      <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': {
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>
