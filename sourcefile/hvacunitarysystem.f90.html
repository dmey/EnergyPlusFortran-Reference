<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

	 <meta name="description" content="">

    <meta name="author" content="dmey (forked from NREL)" >
    <link rel="icon" href="../favicon.png">

    <title>HVACUnitarySystem.f90 &ndash; EnergyPlusFortran</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>


    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>


  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">EnergyPlusFortran <small>8.1.0.009</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">

            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
		 aria-expanded="false">Contents <span class="caret"></span></a>
	      <ul class="dropdown-menu">

            <li><a href="../lists/files.html">Source Files</a></li>


            <li><a href="../lists/modules.html">Modules</a></li>


            <li><a href="../lists/procedures.html">Procedures</a></li>


            <li><a href="../lists/types.html">Derived Types</a></li>


            <li><a href="../program/energyplus.html">Program</a></li>

            </ul>
            </li>

<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/energyplus.html">Program</a></li>

          </ul>


        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">


  <div class="row">
    <h1>HVACUnitarySystem.f90
    <small>Source File</small>

    </h1>

<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">


     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
	  data-placement="bottom" data-html="true"
	  title=" 2.5% of total for source files.">9344 statements</a>
     </li>


    <li><i class="fa fa-code"></i><a href="../src/HVACUnitarySystem.f90"> Source File</a></li>

  </ul>
  <ol class="breadcrumb in-well text-right">

     <li class="active">HVACUnitarySystem.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">

<div id="sidebar">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/hvacunitarysystem.html">HVACUnitarySystem</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html#src">HVACUnitarySystem.f90</a>
  </div>
</div>


  <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-0">All Source Files</a></h3></div>
  <div id="allfiles-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


</div>

    </div>
    <div class="col-md-9" id='text'>


    <h3>This File Depends On</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~hvacunitarysystem.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilehvacunitarysystemf90EfferentGraph" width="641pt" height="2161pt"
 viewBox="0.00 0.00 641.00 2161.24" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph" class="graph" transform="scale(.1848 .1848) rotate(0) translate(4 11693.0016)">
<title>sourcefile~~hvacunitarysystem.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-11693.0016 3465.2009,-11693.0016 3465.2009,4 -4,4"/>
<!-- sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~hvacunitarysystem.f90</title>
<polygon fill="none" stroke="#000000" points="3461.2897,-9648.007 3334.9349,-9648.007 3334.9349,-9625.9962 3461.2897,-9625.9962 3461.2897,-9648.007"/>
<text text-anchor="middle" x="3398.1123" y="-9633.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">HVACUnitarySystem.f90</text>
</g>
<!-- sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~hvacwatertoair.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node2"><a xlink:href="../sourcefile/hvacwatertoair.f90.html" xlink:title="HVACWatertoAir.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2355.2388,-7975.007 2249.1445,-7975.007 2249.1445,-7952.9962 2355.2388,-7952.9962 2355.2388,-7975.007"/>
<text text-anchor="middle" x="2302.1917" y="-7960.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACWatertoAir.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacwatertoair.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge614" class="edge">
<title>sourcefile~hvacwatertoair.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2302.3929,-7975.0523C2304.207,-8064.2233 2320.1962,-8675.2645 2424.6335,-9157.0016 2436.9041,-9213.602 2543.8894,-9617.2074 2590.9226,-9651.0016 2712.0726,-9738.0501 2777.6462,-9659.6035 2926.5784,-9651.0016 2980.5339,-9647.8853 2995.1683,-9623.013 3047.3719,-9637.0016"/>
</g>
<!-- sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~datahvacglobals.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node3"><a xlink:href="../sourcefile/datahvacglobals.f90.html" xlink:title="DataHVACGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="643.4123,-7635.007 528.0262,-7635.007 528.0262,-7612.9962 643.4123,-7612.9962 643.4123,-7635.007"/>
<text text-anchor="middle" x="585.7192" y="-7620.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHVACGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge615" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.9827,-7635.2913C587.7296,-7693.8511 600.5793,-7967.9372 690.4731,-8167.0016 739.9375,-8276.5373 766.9641,-8300.0437 855.7932,-8381.0016 917.1343,-8436.9072 942.8484,-8437.4521 1013.4998,-8481.0016 1108.8481,-8539.7744 1819.9658,-8903.3795 1878.2922,-8999.0016 1943.1136,-9105.2718 1877.2188,-9439.171 1914.2922,-9558.0016 1943.0061,-9650.0374 1952.5963,-9681.3994 2025.9177,-9744.0016 2081.9778,-9791.866 2131.4376,-9750.3269 2179.7498,-9806.0016 2223.5518,-9856.4788 2186.7052,-9891.8104 2215.7498,-9952.0016 2275.0433,-10074.8801 2487.7198,-10348.7602 2590.9226,-10438.0016 2693.0639,-10526.3251 2742.9836,-10512.6479 2855.7019,-10587.0016"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1070.5822,-7661.0016C1360.5449,-7661.3537 1437.436,-7678.0802 1715.2896,-7761.0016 1791.5285,-7783.754 1823.6546,-7777.1675 1878.2922,-7835.0016 1908.7297,-7867.2197 1877.73,-7902.9488 1914.2922,-7928.0016 1942.019,-7947.0003 1956.77,-7933.5648 1989.9177,-7928.0016 2042.2794,-7919.2137 2057.1793,-7861.8974 2102.8337,-7889.0016"/>
</g>
<!-- sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~hvacfancomponent.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node4"><a xlink:href="../sourcefile/hvacfancomponent.f90.html" xlink:title="HVACFanComponent.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2555.0675,-5849.007 2424.4887,-5849.007 2424.4887,-5826.9962 2555.0675,-5826.9962 2555.0675,-5849.007"/>
<text text-anchor="middle" x="2489.7781" y="-5834.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACFanComponent.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff4c00" stroke-dasharray="5,2" d="M755.1332,-7906.0016C805.4299,-7942.9343 1831.1626,-7875.1044 1878.2922,-7916.0016 1951.4682,-7979.5007 1840.3428,-8068.4049 1914.2922,-8131.0016 1939.9465,-8152.7175 1956.9138,-8137.3628 1989.9177,-8131.0016 2063.5599,-8116.8078 2257.4705,-8063.2068 2302.1917,-8003.0016"/>
<path fill="none" stroke="#ff4c00" stroke-dasharray="5,2" d="M596.6672,-7635.1097C611.081,-7650.1094 636.6742,-7678.0728 654.4731,-7705.0016 709.5635,-7788.3501 679.2492,-7841.0129 755.1332,-7906.0016"/>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~hvachxassistedcoolingcoil.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node5"><a xlink:href="../sourcefile/hvachxassistedcoolingcoil.f90.html" xlink:title="HVACHXAssistedCoolingCoil.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3130.2472,-3147.007 2964.4967,-3147.007 2964.4967,-3124.9962 3130.2472,-3124.9962 3130.2472,-3147.007"/>
<text text-anchor="middle" x="3047.3719" y="-3132.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACHXAssistedCoolingCoil.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge82" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ff7200" stroke-dasharray="5,2" d="M1247.8813,-8307.0016C1305.0433,-8331.147 1313.9206,-8347.7481 1368.0981,-8378.0016 1520.3923,-8463.0448 1579.5948,-8451.3988 1715.2896,-8561.0016 1734.6792,-8576.6629 1733.1891,-8586.8667 1751.2896,-8604.0016 1802.4801,-8652.4615 1844.7633,-8636.9965 1878.2922,-8699.0016 1938.8731,-8811.0337 1844.0676,-9164.7484 1914.2922,-9271.0016 1935.0327,-9302.3829 1963.2709,-9282.4516 1989.9177,-9309.0016 2014.9807,-9333.9736 1997.3116,-9359.1823 2025.9177,-9380.0016 2216.1381,-9518.4421 2380.086,-9518.4238 2554.9226,-9361.0016 2722.85,-9209.8005 2679.6221,-9106.1116 2748.8254,-8891.0016 2749.6502,-8888.4378 2926.2533,-8138.6751 2926.5784,-8136.0016 2971.3634,-7767.6929 2951.1181,-5167.8461 2962.5784,-4797.0016 2983.3758,-4124.016 3036.6386,-3298.9145 3045.9671,-3157.1921"/>
<polygon fill="#ff7200" stroke="#ff7200" points="3049.4605,-3157.4071 3046.6268,-3147.1983 3042.4757,-3156.946 3049.4605,-3157.4071"/>
</g>
<!-- sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~datazoneequipment.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node7"><a xlink:href="../sourcefile/datazoneequipment.f90.html" xlink:title="DataZoneEquipment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1877.6145,-5647.007 1751.9673,-5647.007 1751.9673,-5624.9962 1877.6145,-5624.9962 1877.6145,-5647.007"/>
<text text-anchor="middle" x="1814.7909" y="-5632.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataZoneEquipment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge96" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M600.3761,-7612.8406C615.4202,-7600.8164 638.7859,-7580.4966 654.4731,-7559.0016 758.9533,-7415.8403 1275.3064,-6282.8883 1332.0981,-6115.0016 1354.3443,-6049.2379 1330.319,-6021.2467 1368.0981,-5963.0016 1413.5054,-5892.996 1471.2545,-5918.609 1517.2698,-5849.0016 1552.9368,-5795.0481 1508.6786,-5754.8496 1553.2698,-5708.0016 1579.248,-5680.7086 1599.8659,-5698.3464 1634.2797,-5683.0016"/>
</g>
<!-- sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~setpointmanager.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node8"><a xlink:href="../sourcefile/setpointmanager.f90.html" xlink:title="SetPointManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2544.8516,-6307.007 2434.7046,-6307.007 2434.7046,-6284.9962 2544.8516,-6284.9962 2544.8516,-6307.007"/>
<text text-anchor="middle" x="2489.7781" y="-6292.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SetPointManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge115" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M755.1332,-7906.0016C858.0486,-7976.7486 1787.4515,-7863.3004 1878.2922,-7949.0016 1938.7036,-8005.995 1852.8016,-8265.1744 1914.2922,-8321.0016 1939.1774,-8343.5948 1958.0736,-8331.7566 1989.9177,-8321.0016 2095.4793,-8285.3494 2338.0105,-8116.257 2388.6335,-8017.0016 2426.658,-7942.4479 2411.3784,-6593.6358 2424.6335,-6511.0016 2436.3781,-6437.7847 2466.6094,-6354.7336 2481.3903,-6316.8397"/>
<polygon fill="#ffe500" stroke="#ffe500" points="2484.7024,-6317.9814 2485.1213,-6307.3948 2478.192,-6315.4095 2484.7024,-6317.9814"/>
</g>
<!-- sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~hvacheatingcoils.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node15"><a xlink:href="../sourcefile/hvacheatingcoils.f90.html" xlink:title="HVACHeatingCoils.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2914.6437,-4745.007 2796.7602,-4745.007 2796.7602,-4722.9962 2914.6437,-4722.9962 2914.6437,-4745.007"/>
<text text-anchor="middle" x="2855.7019" y="-4730.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACHeatingCoils.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge258" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#0cff00" stroke-dasharray="5,2" d="M1070.5822,-8153.0016C1089.4691,-8153.0016 1699.0281,-8359.3953 1715.2896,-8369.0016 1736.4811,-8381.5203 1867.5769,-8496.8435 1878.2922,-8519.0016 1925.4389,-8616.4962 1854.0807,-8914.9873 1914.2922,-9005.0016 1935.2063,-9036.2675 1959.7242,-9020.5671 1989.9177,-9043.0016 2008.5916,-9056.8768 2004.5464,-9071.8091 2025.9177,-9081.0016 2088.7239,-9108.0166 2114.7341,-9102.1532 2179.7498,-9081.0016 2288.9322,-9045.4813 2314.9181,-9017.0274 2388.6335,-8929.0016 2497.1474,-8799.422 2512.8665,-8750.7008 2554.9226,-8587.0016 2594.4538,-8433.1303 2535.0547,-8021.7224 2590.9226,-7873.0016 2610.8361,-7819.9918 2662.8692,-7829.1934 2669.874,-7773.0016"/>
</g>
<!-- sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~branchinputmanager.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node18"><a xlink:href="../sourcefile/branchinputmanager.f90.html" xlink:title="BranchInputManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1878.2936,-9115.007 1751.2882,-9115.007 1751.2882,-9092.9962 1878.2936,-9092.9962 1878.2936,-9115.007"/>
<text text-anchor="middle" x="1814.7909" y="-9100.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">BranchInputManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge294" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M586.665,-7635.0827C593.473,-7713.597 636.2799,-8186.5911 690.4731,-8319.0016 781.9587,-8542.5285 821.0085,-8610.1216 1013.4998,-8756.0016 1218.7839,-8911.5768 1309.6201,-8883.4549 1553.2698,-8967.0016 1588.7908,-8979.1816 1600.1316,-8975.381 1634.2797,-8991.0016"/>
</g>
<!-- sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node28" class="node">
<title>sourcefile~hvacdxsystem.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node28"><a xlink:href="../sourcefile/hvacdxsystem.f90.html" xlink:title="HVACDXSystem.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3287.1006,-6693.007 3180.0886,-6693.007 3180.0886,-6670.9962 3287.1006,-6670.9962 3287.1006,-6693.007"/>
<text text-anchor="middle" x="3233.5946" y="-6678.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACDXSystem.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge431" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M755.1332,-8153.0016C792.2369,-8230.8986 792.6665,-8260.1828 855.7932,-8319.0016 1168.2996,-8610.1819 1385.6776,-8477.336 1715.2896,-8749.0016 1735.5943,-8765.7367 1734.4713,-8775.7657 1751.2896,-8796.0016 1805.1976,-8860.8641 1845.284,-8859.3893 1878.2922,-8937.0016 1922.4111,-9040.7382 1886.3981,-9333.7786 1914.2922,-9443.0016 1943.801,-9558.5469 1945.0631,-9599.3431 2025.9177,-9687.0016 2079.0248,-9744.5777 2124.9999,-9716.9853 2179.7498,-9773.0016 2203.6521,-9797.4569 2193.7895,-9814.7884 2215.7498,-9841.0016 2314.9852,-9959.4556 2335.2497,-10055.0016 2489.7781,-10055.0016 2489.7781,-10055.0016 2489.7781,-10055.0016 2669.874,-10055.0016 2837.0715,-10055.0016 2854.4021,-9930.8179 2926.5784,-9780.0016 3208.934,-9190.0042 3231.8178,-6946.3889 3233.4741,-6703.3823"/>
<polygon fill="#0019ff" stroke="#0019ff" points="3236.976,-6703.0908 3233.5395,-6693.0688 3229.9761,-6703.0464 3236.976,-6703.0908"/>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node30" class="node">
<title>sourcefile~hvacwatercoilcomponent.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node30"><a xlink:href="../sourcefile/hvacwatercoilcomponent.f90.html" xlink:title="HVACWaterCoilComponent.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2748.7769,-5811.007 2590.9712,-5811.007 2590.9712,-5788.9962 2748.7769,-5788.9962 2748.7769,-5811.007"/>
<text text-anchor="middle" x="2669.874" y="-5796.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACWaterCoilComponent.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge457" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M755.1332,-7906.0016C876.2579,-8009.7354 911.1083,-8077.0016 1070.5822,-8077.0016 1070.5822,-8077.0016 1070.5822,-8077.0016 1247.8813,-8077.0016 1318.6372,-8077.0016 1829.208,-8116.0396 1878.2922,-8167.0016 1931.6123,-8222.3615 1857.1842,-8459.5582 1914.2922,-8511.0016 2094.6905,-8673.5061 2247.3055,-8437.4291 2388.6335,-8240.0016 2409.2276,-8211.2329 2407.6716,-8200.0507 2424.6335,-8169.0016 2479.4811,-8068.6024 2523.8716,-8057.111 2554.9226,-7947.0016 2612.0509,-7744.4202 2557.2341,-6260.7706 2590.9226,-6053.0016 2605.3461,-5964.0469 2643.9101,-5863.1215 2661.2355,-5820.6064"/>
<polygon fill="#3200ff" stroke="#3200ff" points="2664.488,-5821.8999 2665.0625,-5811.3207 2658.016,-5819.2326 2664.488,-5821.8999"/>
</g>
<!-- sourcefile~general.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node31" class="node">
<title>sourcefile~general.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node31"><a xlink:href="../sourcefile/general.f90.html" xlink:title="General.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="788.502,-4895.007 721.7644,-4895.007 721.7644,-4872.9962 788.502,-4872.9962 788.502,-4895.007"/>
<text text-anchor="middle" x="755.1332" y="-4880.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">General.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge484" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#5900ff" stroke-dasharray="5,2" d="M587.0848,-7612.6154C595.2598,-7543.8968 637.9242,-7177.3905 654.4731,-6877.0016 657.4808,-6822.4086 659.1477,-4953.8141 690.4731,-4909.0016 695.7902,-4901.3952 703.7706,-4896.1029 712.3275,-4892.4207"/>
<polygon fill="#5900ff" stroke="#5900ff" points="713.522,-4895.7106 721.74,-4889.0238 711.1457,-4889.1263 713.522,-4895.7106"/>
</g>
<!-- sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node32" class="node">
<title>sourcefile~dxcoil.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node32"><a xlink:href="../sourcefile/dxcoil.f90.html" xlink:title="DXCoil.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2701.0621,-4458.007 2638.686,-4458.007 2638.686,-4435.9962 2701.0621,-4435.9962 2701.0621,-4458.007"/>
<text text-anchor="middle" x="2669.874" y="-4443.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DXCoil.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge503" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M755.1332,-7906.0016C953.2419,-8065.4287 1705.169,-7938.7427 1878.2922,-8125.0016 1931.2223,-8181.9477 1856.5583,-8420.9321 1914.2922,-8473.0016 1939.2519,-8495.5124 1958.5054,-8484.9593 1989.9177,-8473.0016 2017.6359,-8462.4502 2374.3139,-8143.9742 2388.6335,-8118.0016 2435.8349,-8032.3887 2407.8102,-7997.3059 2424.6335,-7901.0016 2479.842,-7584.9629 2523.7055,-7510.3039 2554.9226,-7191.0016 2562.1696,-7116.8761 2558.1676,-4576.8912 2590.9226,-4510.0016 2600.8393,-4489.7506 2620.7128,-4473.9488 2638.0389,-4463.2358"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="2639.943,-4466.1768 2646.8009,-4458.1009 2636.4036,-4460.1374 2639.943,-4466.1768"/>
</g>
<!-- sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node38" class="node">
<title>sourcefile~hvacsteamcoilcomponent.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node38"><a xlink:href="../sourcefile/hvacsteamcoilcomponent.f90.html" xlink:title="HVACSteamCoilComponent.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2382.3224,-7386.007 2222.0609,-7386.007 2222.0609,-7363.9962 2382.3224,-7363.9962 2382.3224,-7386.007"/>
<text text-anchor="middle" x="2302.1917" y="-7371.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACSteamCoilComponent.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge560" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M1070.5822,-7661.0016C1143.022,-7657.7155 1104.5223,-7568.9604 1163.6646,-7527.0016 1310.2165,-7423.0296 1375.2221,-7443.2227 1553.2698,-7419.0016 1624.6214,-7409.2952 1646.7737,-7396.8467 1715.2896,-7419.0016 1734.0687,-7425.0739 1735.1166,-7433.6894 1751.2896,-7445.0016 1807.1505,-7484.0734 1832.4546,-7480.5441 1878.2922,-7531.0016 1900.7596,-7555.7334 1885.5602,-7579.9453 1914.2922,-7597.0016 2015.7441,-7657.2268 2078.1573,-7656.9893 2179.7498,-7597.0016 2255.5399,-7552.2495 2287.6357,-7441.9559 2298.0547,-7395.8194"/>
<polygon fill="#ff0098" stroke="#ff0098" points="2301.48,-7396.5387 2300.154,-7386.0271 2294.6355,-7395.0713 2301.48,-7396.5387"/>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M755.1332,-7547.0016C886.4225,-7476.3889 921.6827,-7653.7929 1070.5822,-7661.0016"/>
</g>
<!-- sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node40" class="node">
<title>sourcefile~hvacwatertoairmultispeedhp.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node40"><a xlink:href="../sourcefile/hvacwatertoairmultispeedhp.f90.html" xlink:title="HVACWatertoAirMultiSpeedHP.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2388.5755,-6757.007 2215.8078,-6757.007 2215.8078,-6734.9962 2388.5755,-6734.9962 2388.5755,-6757.007"/>
<text text-anchor="middle" x="2302.1917" y="-6742.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACWatertoAirMultiSpeedHP.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge580" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M755.1332,-7547.0016C825.9186,-7512.6806 954.842,-7357.4208 1013.4998,-7305.0016 1078.8898,-7246.5662 1086.1411,-7217.9977 1163.6646,-7177.0016 1500.216,-6999.0257 1639.8391,-7100.6252 1989.9177,-6951.0016 2080.4131,-6912.3239 2111.6179,-6908.0187 2179.7498,-6837.0016 2202.8816,-6812.8902 2189.6949,-6791.9203 2215.7498,-6771.0016 2220.6263,-6767.0864 2226.0915,-6763.7843 2231.8419,-6760.9993"/>
<polygon fill="#ff004c" stroke="#ff004c" points="2233.2631,-6764.1981 2241.0694,-6757.0348 2230.4999,-6757.7666 2233.2631,-6764.1981"/>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M618.9313,-7612.8938C630.3238,-7608.8289 643.0716,-7603.995 654.4731,-7599.0016 700.5982,-7578.8009 708.3394,-7565.601 755.1332,-7547.0016"/>
</g>
<!-- sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node48" class="node">
<title>sourcefile~heatrecovery.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node48"><a xlink:href="../sourcefile/heatrecovery.f90.html" xlink:title="HeatRecovery.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2903.4691,-3147.007 2807.9347,-3147.007 2807.9347,-3124.9962 2903.4691,-3124.9962 2903.4691,-3147.007"/>
<text text-anchor="middle" x="2855.7019" y="-3132.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatRecovery.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge64" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M595.175,-7635.1233C610.2113,-7653.4277 639.4082,-7691.612 654.4731,-7729.0016 686.7566,-7809.1259 650.7046,-7843.3166 690.4731,-7920.0016 756.9141,-8048.1184 781.0788,-8103.5069 916.6465,-8153.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M916.6465,-8153.0016C976.9879,-8185.2451 1002.1883,-8151.2668 1070.5822,-8153.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1070.5822,-8153.0016C1187.3038,-8155.9622 1225.7776,-8129.7455 1332.0981,-8178.0016 1352.1384,-8187.0974 1348.6847,-8201.6351 1368.0981,-8212.0016 1428.0808,-8244.0316 1451.6636,-8228.1225 1517.2698,-8246.0016 1606.3757,-8270.2849 1630.1081,-8273.3131 1715.2896,-8309.0016 1753.0634,-8324.8277 1856.0509,-8360.612 1878.2922,-8395.0016 1947.4585,-8501.9467 1821.4479,-8879.8169 1914.2922,-8967.0016 1949.2192,-8999.7995 2086.1365,-9002.0601 2179.7498,-8948.0016 2427.1652,-8805.1275 2465.1323,-8697.2305 2554.9226,-8426.0016 2632.4892,-8191.6969 2513.1789,-6439.2476 2590.9226,-6205.0016 2628.7204,-6091.1148 2711.099,-6099.9121 2748.8254,-5986.0016 2790.8723,-5859.0461 2773.2314,-3712.2353 2784.8254,-3579.0016 2799.062,-3415.4005 2837.9245,-3220.79 2851.1925,-3157.2211"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2854.6621,-3157.7293 2853.2947,-3147.2231 2847.8119,-3156.2889 2854.6621,-3157.7293"/>
</g>
<!-- sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node51" class="node">
<title>sourcefile~runtimelanguageprocessor.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node51"><a xlink:href="../sourcefile/runtimelanguageprocessor.f90.html" xlink:title="RuntimeLanguageProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1715.2994,-2353.007 1553.2599,-2353.007 1553.2599,-2330.9962 1715.2994,-2330.9962 1715.2994,-2353.007"/>
<text text-anchor="middle" x="1634.2797" y="-2338.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RuntimeLanguageProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge154" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M587.1221,-7612.6173C595.5147,-7543.9103 639.2289,-7177.4595 654.4731,-6877.0016 659.7488,-6773.0194 648.873,-3224.4456 690.4731,-3129.0016 692.9424,-3123.3365 1008.9646,-2827.1997 1013.4998,-2823.0016 1116.5772,-2727.5858 1123.9486,-2677.1061 1247.8813,-2611.0016"/>
</g>
<!-- sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node61" class="node">
<title>sourcefile~refrigeratedcase.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node61"><a xlink:href="../sourcefile/refrigeratedcase.f90.html" xlink:title="RefrigeratedCase.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2357.9982,-3908.007 2246.3851,-3908.007 2246.3851,-3885.9962 2357.9982,-3885.9962 2357.9982,-3908.007"/>
<text text-anchor="middle" x="2302.1917" y="-3893.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RefrigeratedCase.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge235" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M587.8587,-7612.9583C596.8627,-7566.2285 632.2367,-7380.0731 654.4731,-7226.0016 674.2863,-7088.7203 650.7938,-7048.9086 690.4731,-6916.0016 727.1662,-6793.0971 773.1088,-6777.469 819.7932,-6658.0016 840.8356,-6604.1533 837.991,-6588.0062 855.7932,-6533.0016 919.503,-6336.1539 931.2329,-6284.844 1013.4998,-6095.0016 1071.8395,-5960.3744 1093.8059,-5930.0278 1163.6646,-5801.0016 1235.3643,-5668.5749 1258.609,-5638.4438 1332.0981,-5507.0016 1348.404,-5477.8372 1350.5734,-5469.4503 1368.0981,-5441.0016 1577.2366,-5101.4991 1671.7351,-5044.0808 1878.2922,-4703.0016 2061.8281,-4399.9365 2248.8694,-4009.83 2292.6348,-3917.3116"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2295.8409,-3918.7188 2296.945,-3908.1816 2289.5108,-3915.7304 2295.8409,-3918.7188"/>
</g>
<!-- sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node62" class="node">
<title>sourcefile~watermanager.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node62"><a xlink:href="../sourcefile/watermanager.f90.html" xlink:title="WaterManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1296.8809,-2775.007 1198.8818,-2775.007 1198.8818,-2752.9962 1296.8809,-2752.9962 1296.8809,-2775.007"/>
<text text-anchor="middle" x="1247.8813" y="-2760.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WaterManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge223" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M587.0891,-7612.6156C595.2897,-7543.8985 638.0771,-7177.3989 654.4731,-6877.0016 704.9599,-5952.018 637.6521,-5717.8549 690.4731,-4793.0016 693.1816,-4745.5786 835.7138,-3134.0492 855.7932,-3091.0016 872.1148,-3056.0103 889.5237,-3056.4815 916.6465,-3029.0016"/>
</g>
<!-- sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node68" class="node">
<title>sourcefile~packagedthermalstoragecoil.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node68"><a xlink:href="../sourcefile/packagedthermalstoragecoil.f90.html" xlink:title="PackagedThermalStorageCoil.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3131.9596,-8127.007 2962.7843,-8127.007 2962.7843,-8104.9962 3131.9596,-8104.9962 3131.9596,-8127.007"/>
<text text-anchor="middle" x="3047.3719" y="-8112.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PackagedThermalStorageCoil.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge400" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M595.4583,-7635.0145C610.8925,-7653.1661 640.6362,-7691.1403 654.4731,-7729.0016 699.9635,-7853.4745 652.0195,-7898.1782 690.4731,-8025.0016 708.9667,-8085.995 725.4795,-8096.5847 755.1332,-8153.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-8153.0016C823.2051,-8282.5103 886.8215,-8283.797 1013.4998,-8357.0016 1309.6714,-8528.1527 1451.7588,-8454.9147 1715.2896,-8673.0016 1800.4878,-8743.5081 1835.5079,-8759.0242 1878.2922,-8861.0016 1955.5722,-9045.2 1868.9171,-9114.4705 1914.2922,-9309.0016 1944.8179,-9439.8706 1932.9849,-9492.9345 2025.9177,-9590.0016 2077.7378,-9644.127 2116.1909,-9619.3136 2179.7498,-9659.0016 2197.4158,-9670.0328 2196.1664,-9681.9115 2215.7498,-9689.0016 2490.1496,-9788.3481 2666.9438,-9764.567 2855.7019,-9542.0016"/>
</g>
<!-- sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node69" class="node">
<title>sourcefile~plantwaterthermaltank.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node69"><a xlink:href="../sourcefile/plantwaterthermaltank.f90.html" xlink:title="PlantWaterThermalTank.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2926.455,-8127.007 2784.9488,-8127.007 2784.9488,-8104.9962 2926.455,-8104.9962 2926.455,-8127.007"/>
<text text-anchor="middle" x="2855.7019" y="-8112.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantWaterThermalTank.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge369" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M916.6465,-8153.0016C1030.858,-8200.9157 1048.8723,-8235.496 1163.6646,-8282.0016 1199.8517,-8296.6621 1210.0829,-8297.2181 1247.8813,-8307.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1247.8813,-8307.0016C1284.6351,-8319.8047 1295.2484,-8318.4774 1332.0981,-8331.0016 1505.5693,-8389.9599 1565.8615,-8376.9847 1715.2896,-8483.0016 1805.4838,-8546.993 1836.3361,-8568.6806 1878.2922,-8671.0016 1925.7708,-8786.7903 1850.5304,-9125.3184 1914.2922,-9233.0016 1934.5756,-9267.2568 1962.2274,-9252.3995 1989.9177,-9281.0016 2011.8143,-9303.6192 1998.7879,-9326.0333 2025.9177,-9342.0016 2164.8593,-9423.7811 2231.1006,-9381.2947 2388.6335,-9347.0016 2468.0333,-9329.7172 2507.7379,-9337.1581 2554.9226,-9271.0016 2602.8919,-9203.7451 2560.0772,-8977.6375 2590.9226,-8901.0016 2633.2095,-8795.939 2702.1795,-8804.2028 2748.8254,-8701.0016 2751.8385,-8694.3355 2833.3543,-8240.5697 2851.9501,-8136.9227"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2855.4047,-8137.4868 2853.7254,-8127.0259 2848.5147,-8136.2508 2855.4047,-8137.4868"/>
</g>
<!-- sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node70" class="node">
<title>sourcefile~plantsolarcollectors.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node70"><a xlink:href="../sourcefile/plantsolarcollectors.f90.html" xlink:title="PlantSolarCollectors.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2364.3313,-7252.007 2240.052,-7252.007 2240.052,-7229.9962 2364.3313,-7229.9962 2364.3313,-7252.007"/>
<text text-anchor="middle" x="2302.1917" y="-7237.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantSolarCollectors.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge355" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-7547.0016C921.3952,-7460.625 979.3531,-7476.6655 1163.6646,-7443.0016 1253.6092,-7426.5735 1277.1388,-7429.2927 1368.0981,-7420.0016 1521.7906,-7404.3026 1562.0239,-7383.5733 1715.2896,-7403.0016 1789.5075,-7412.4096 1813.8311,-7407.0334 1878.2922,-7445.0016 1898.3379,-7456.8087 1892.9209,-7473.8091 1914.2922,-7483.0016 1945.1685,-7496.2825 1961.5158,-7500.9752 1989.9177,-7483.0016 2021.5005,-7463.015 1996.2596,-7429.7466 2025.9177,-7407.0016 2053.4896,-7385.8565 2075.9739,-7415.0442 2102.8337,-7393.0016"/>
</g>
<!-- sourcefile~standardratings.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node71" class="node">
<title>sourcefile~standardratings.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node71"><a xlink:href="../sourcefile/standardratings.f90.html" xlink:title="StandardRatings.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2156.5645,-5125.007 2049.1029,-5125.007 2049.1029,-5102.9962 2156.5645,-5102.9962 2156.5645,-5125.007"/>
<text text-anchor="middle" x="2102.8337" y="-5110.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">StandardRatings.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge495" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M588.3744,-7612.8545C599.3191,-7567.3158 642.6168,-7391.1272 690.4731,-7250.0016 745.5896,-7087.4665 915.5557,-6693.0591 977.4998,-6533.0016 1062.7837,-6312.6361 1040.9875,-6236.9538 1163.6646,-6035.0016 1292.9463,-5822.1767 1708.1666,-5342.7171 1914.2922,-5203.0016 1929.1263,-5192.9469 1939.4847,-5201.7246 1952.105,-5189.0016"/>
</g>
<!-- sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge616" class="edge">
<title>sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3047.3719,-7678.0016C3072.2841,-7865.9192 3107.0408,-7908.1124 3132.1655,-8096.0016 3154.9087,-8266.0804 3102.989,-9525.7081 3233.5946,-9637.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2508.3353,-5849.0456C2522.2121,-5857.8931 2541.0959,-5871.2347 2554.9226,-5886.0016 2664.199,-6002.709 2686.9736,-6041.5693 2748.8254,-6189.0016 3009.9371,-6811.3973 2958.6704,-7008.9069 3047.3719,-7678.0016"/>
</g>
<!-- sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge504" class="edge">
<title>sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M2490.0864,-5826.8905C2493.5155,-5705.8027 2525.6347,-4633.3951 2590.9226,-4510.0016 2601.5379,-4489.9389 2621.6023,-4474.0584 2638.8469,-4463.26"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="2640.7419,-4466.2052 2647.5427,-4458.0811 2637.1601,-4460.191 2640.7419,-4466.2052"/>
</g>
<!-- sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge370" class="edge">
<title>sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2493.1426,-5849.231C2504.4998,-5887.7501 2541.4591,-6018.2498 2554.9226,-6129.0016 2577.1591,-6311.9206 2528.6025,-7613.5945 2590.9226,-7787.0016 2610.0742,-7840.2914 2647.3251,-7835.0581 2669.874,-7887.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2669.874,-7887.0016C2709.3698,-7977.9837 2795.5011,-8062.4013 2835.0714,-8098.0905"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2832.9794,-8100.9143 2842.775,-8104.9514 2837.635,-8095.6869 2832.9794,-8100.9143"/>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge617" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3047.4241,-3124.9801C3048.2716,-2971.2317 3061.5677,-1261.8133 3233.5946,-1345.0016"/>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge434" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M3047.9568,-3147.1387C3058.8224,-3354.0384 3217.6084,-6377.5972 3232.4795,-6660.7679"/>
<polygon fill="#0019ff" stroke="#0019ff" points="3228.9944,-6661.1463 3233.0142,-6670.9489 3235.9848,-6660.7791 3228.9944,-6661.1463"/>
</g>
<!-- sourcefile~datahvaccontrollers.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~datahvaccontrollers.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node6"><a xlink:href="../sourcefile/datahvaccontrollers.f90.html" xlink:title="DataHVACControllers.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3298.9528,-9687.007 3168.2364,-9687.007 3168.2364,-9664.9962 3298.9528,-9664.9962 3298.9528,-9687.007"/>
<text text-anchor="middle" x="3233.5946" y="-9672.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHVACControllers.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvaccontrollers.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge618" class="edge">
<title>sourcefile~datahvaccontrollers.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3280.2987,-9664.9301C3299.3965,-9660.4028 3321.6604,-9655.125 3341.6598,-9650.384"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3342.6534,-9653.7456 3351.5764,-9648.0333 3341.0387,-9646.9344 3342.6534,-9653.7456"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge619" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1829.439,-5624.7908C1879.8629,-5586.8489 2052.1671,-5462.5406 2215.7498,-5407.0016 2408.6409,-5341.512 2498.3891,-5235.0525 2669.874,-5345.0016"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff4c00" stroke-dasharray="5,2" d="M2302.1917,-5763.0016C2341.2471,-5771.0289 2352.699,-5769.725 2388.6335,-5787.0016 2406.4211,-5795.5535 2407.275,-5803.6095 2424.6335,-5813.0016 2431.5256,-5816.7307 2439.0942,-5820.1714 2446.5572,-5823.2315"/>
<polygon fill="#ff4c00" stroke="#ff4c00" points="2445.3076,-5826.5009 2455.8951,-5826.897 2447.8655,-5819.985 2445.3076,-5826.5009"/>
<path fill="none" stroke="#ff4c00" stroke-dasharray="5,2" d="M2102.8337,-5719.0016C2190.8988,-5740.8547 2213.3136,-5744.7341 2302.1917,-5763.0016"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge116" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M1822.7192,-5647.1052C1849.2452,-5683.8982 1938.1724,-5804.3998 2025.9177,-5891.0016 2088.419,-5952.6883 2113.0035,-5957.9349 2179.7498,-6015.0016 2292.2282,-6111.1684 2422.0157,-6232.2229 2470.3392,-6277.6595"/>
<polygon fill="#ffe500" stroke="#ffe500" points="2468.2084,-6280.4605 2477.8888,-6284.7665 2473.0065,-6275.3636 2468.2084,-6280.4605"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge236" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1815.4897,-5624.738C1819.4472,-5565.0541 1841.5184,-5280.225 1914.2922,-5061.0016 1996.4186,-4813.6047 2100.5572,-4786.3532 2179.7498,-4538.0016 2212.7849,-4434.402 2196.2273,-4402.9739 2215.7498,-4296.0016 2242.2889,-4150.5817 2282.9582,-3977.2847 2297.1203,-3918.0488"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2300.5883,-3918.5956 2299.5173,-3908.055 2293.7814,-3916.9629 2300.5883,-3918.5956"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge401" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1849.9755,-5624.903C1961.3532,-5590.7258 2303.8354,-5493.25 2388.6335,-5559.0016 2439.4053,-5598.3695 2385.8952,-5647.7478 2424.6335,-5699.0016 2465.055,-5752.4823 2509.8402,-5725.3866 2554.9226,-5775.0016 2580.5989,-5803.2594 2566.0849,-5824.004 2590.9226,-5853.0016 2682.8459,-5960.3205 2776.5112,-5911.9715 2855.7019,-6029.0016"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge371" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2102.8337,-5719.0016C2226.7942,-5749.762 2269.3289,-5703.4078 2388.6335,-5749.0016 2407.0697,-5756.0472 2407.0562,-5766.0257 2424.6335,-5775.0016 2478.941,-5802.7338 2517.5365,-5769.8285 2554.9226,-5818.0016 2591.0428,-5864.5436 2584.557,-6288.4328 2590.9226,-6347.0016 2669.4069,-7069.1197 2825.5182,-7948.4781 2851.8796,-8094.8833"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2848.4519,-8095.5981 2853.672,-8104.8177 2855.3407,-8094.3551 2848.4519,-8095.5981"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1856.0244,-5647.1231C1912.132,-5662.4293 2015.5434,-5691.2547 2102.8337,-5719.0016"/>
</g>
<!-- sourcefile~setpointmanager.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge620" class="edge">
<title>sourcefile~setpointmanager.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2534.2379,-6307.1369C2541.8497,-6310.6045 2549.1514,-6315.1237 2554.9226,-6321.0016 3004.4263,-6778.8137 2928.5881,-7047.4971 3047.3719,-7678.0016"/>
</g>
<!-- sourcefile~setpointmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge458" class="edge">
<title>sourcefile~setpointmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M2492.8271,-6284.8277C2504.2147,-6243.474 2545.9136,-6095.3906 2590.9226,-5977.0016 2612.92,-5919.141 2644.0741,-5853.0335 2659.8643,-5820.4127"/>
<polygon fill="#3200ff" stroke="#3200ff" points="2663.0165,-5821.9337 2664.2443,-5811.4103 2656.722,-5818.8712 2663.0165,-5821.9337"/>
</g>
<!-- sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~plantutilities.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node9"><a xlink:href="../sourcefile/plantutilities.f90.html" xlink:title="PlantUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2146.6184,-8699.007 2059.0491,-8699.007 2059.0491,-8676.9962 2146.6184,-8676.9962 2146.6184,-8699.007"/>
<text text-anchor="middle" x="2102.8337" y="-8684.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge621" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2105.3814,-8699.2541C2136.8665,-8837.2075 2455.2417,-10200.8539 2784.8254,-10411.0016 3106.5145,-10616.1155 3115.9106,-10013.3508 3132.1655,-9955.0016 3171.9766,-9812.0948 3120.681,-9540.7841 3233.5946,-9637.0016"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2104.4486,-8676.9699C2117.3634,-8588.879 2203.6917,-8002.6199 2215.7498,-7989.0016 2222.1294,-7981.7965 2230.4441,-7976.6114 2239.393,-7972.8913"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2240.6391,-7976.163 2248.8939,-7969.5216 2238.2992,-7969.5657 2240.6391,-7976.163"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge460" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M2123.1688,-8676.8562C2173.5051,-8648.4649 2305.8206,-8568.8445 2388.6335,-8473.0016 2410.4791,-8447.7189 2408.6112,-8436.3227 2424.6335,-8407.0016 2482.4592,-8301.1798 2524.0446,-8285.5718 2554.9226,-8169.0016 2615.1332,-7941.6958 2553.5182,-6285.1527 2590.9226,-6053.0016 2605.2574,-5964.0326 2643.8685,-5863.1148 2661.2208,-5820.604"/>
<polygon fill="#3200ff" stroke="#3200ff" points="2664.473,-5821.8982 2665.054,-5811.3193 2658.0027,-5819.2269 2664.473,-5821.8982"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge569" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M2104.7931,-8676.7164C2114.3327,-8621.4254 2156.4027,-8373.5329 2179.7498,-8169.0016 2202.4043,-7970.5375 2183.432,-7918.1229 2215.7498,-7721.0016 2236.2736,-7595.817 2279.3143,-7449.3873 2295.6839,-7395.9032"/>
<polygon fill="#ff0098" stroke="#ff0098" points="2299.0707,-7396.7972 2298.6713,-7386.2099 2292.3812,-7394.7355 2299.0707,-7396.7972"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge581" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M2105.0228,-8676.7394C2115.6394,-8621.5566 2161.9779,-8374.0926 2179.7498,-8169.0016 2186.4569,-8091.5993 2168.2685,-6832.4966 2215.7498,-6771.0016 2218.1336,-6767.9141 2220.8748,-6765.1911 2223.8809,-6762.7908"/>
<polygon fill="#ff004c" stroke="#ff004c" points="2225.9825,-6765.5972 2232.3935,-6757.1622 2222.1217,-6759.7582 2225.9825,-6765.5972"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge237" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2105.0901,-8676.745C2116.0218,-8621.5882 2163.6097,-8374.2274 2179.7498,-8169.0016 2243.5035,-7358.3543 2154.8493,-5320.8683 2215.7498,-4510.0016 2233.2805,-4276.5869 2283.5459,-3996.6595 2298.1607,-3918.295"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2301.6459,-3918.6991 2300.0502,-3908.2251 2294.766,-3917.4081 2301.6459,-3918.6991"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge373" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2114.197,-8699.1119C2154.7711,-8739.1508 2295.0646,-8880.784 2388.6335,-9015.0016 2430.099,-9074.4806 2417.9617,-9152.9788 2489.7781,-9143.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2489.7781,-9143.0016C2519.5916,-9135.0508 2536.347,-9143.6391 2554.9226,-9119.0016 2619.8521,-9032.8833 2540.1962,-8730.1805 2590.9226,-8635.0016 2611.9069,-8595.6285 2647.4202,-8611.5556 2669.874,-8573.0016"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge361" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2104.9449,-8676.7323C2115.1961,-8621.5161 2160.0866,-8373.9199 2179.7498,-8169.0016 2197.0447,-7988.7638 2154.2614,-7525.3071 2215.7498,-7355.0016 2229.6612,-7316.4708 2261.5267,-7280.2698 2282.4381,-7259.3896"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2285.1346,-7261.6489 2289.8559,-7252.1642 2280.2503,-7256.6345 2285.1346,-7261.6489"/>
</g>
<!-- sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~dataipshortcuts.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node10"><a xlink:href="../sourcefile/dataipshortcuts.f90.html" xlink:title="DataIPShortCuts.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="453.3838,-7711.007 344.7839,-7711.007 344.7839,-7688.9962 453.3838,-7688.9962 453.3838,-7711.007"/>
<text text-anchor="middle" x="399.0839" y="-7696.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataIPShortCuts.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge622" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.845,-7711.3986C409.7077,-7857.2492 514.9861,-9360.6324 690.4731,-9765.0016 821.2265,-10066.2923 1297.3574,-10759.1342 1553.2698,-10965.0016 1781.4326,-11148.546 1895.0299,-11237.4224 2179.7498,-11169.0016 2417.5149,-11111.8644 2425.3597,-10922.1053 2669.874,-10919.0016"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge259" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#0cff00" stroke-dasharray="5,2" d="M399.8007,-7711.0714C405.1741,-7791.5671 441.0406,-8287.4002 516.9653,-8414.0016 566.9382,-8497.3293 608.5057,-8494.8277 690.4731,-8547.0016 760.3426,-8591.4748 777.4852,-8606.0302 855.7932,-8633.0016 1074.3068,-8708.2636 1722.1541,-8652.6096 1878.2922,-8823.0016 1934.4024,-8884.2341 1852.8016,-9139.1744 1914.2922,-9195.0016 2142.5461,-9402.2328 2405.2047,-9198.4995 2554.9226,-8929.0016 2619.575,-8812.6249 2568.2271,-8462.1823 2590.9226,-8331.0016 2633.8414,-8082.9299 2711.902,-8036.0362 2748.8254,-7787.0016 2761.1623,-7703.7942 2735.8279,-4827.375 2784.8254,-4759.0016 2787.0865,-4755.8464 2789.7793,-4753.0868 2792.7729,-4750.6737"/>
<polygon fill="#0cff00" stroke="#0cff00" points="2794.8766,-4753.4793 2801.3096,-4745.061 2791.031,-4747.6302 2794.8766,-4753.4793"/>
</g>
<!-- sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~curvemanager.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node20"><a xlink:href="../sourcefile/curvemanager.f90.html" xlink:title="CurveManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1492.0739,-8203.007 1393.294,-8203.007 1393.294,-8180.9962 1492.0739,-8180.9962 1492.0739,-8203.007"/>
<text text-anchor="middle" x="1442.684" y="-8188.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CurveManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge313" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ffb2" stroke-dasharray="5,2" d="M400.0557,-7711.1845C406.2139,-7779.4738 441.9754,-8139.847 516.9653,-8215.0016 695.344,-8393.7722 830.9473,-8422.7074 1070.5822,-8343.0016"/>
<path fill="none" stroke="#00ffb2" stroke-dasharray="5,2" d="M1070.5822,-8343.0016C1113.3561,-8323.6189 1120.2436,-8310.888 1163.6646,-8293.0016 1199.7656,-8278.1305 1209.4904,-8275.1133 1247.8813,-8268.0016"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge440" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M585.7192,-8723.0016C605.7268,-8748.4422 626.9415,-8729.9859 654.4731,-8747.0016 673.4556,-8758.7336 671.0121,-8771.0818 690.4731,-8782.0016 961.6393,-8934.1552 1066.7185,-8879.5024 1368.0981,-8956.0016 1396.4225,-8963.1912 1859.8371,-9061.344 1878.2922,-9084.0016 1938.3413,-9157.7248 1869.0077,-9855.3935 1914.2922,-9939.0016 1933.9618,-9975.3173 1963.4207,-9961.3215 1989.9177,-9993.0016 2013.8967,-10021.6712 2003.4226,-10039.1535 2025.9177,-10069.0016 2093.5499,-10158.7406 2117.6743,-10181.1527 2215.7498,-10236.0016 2499.7163,-10394.8105 2677.2951,-10620.0832 2926.5784,-10411.0016 3328.7502,-10073.6876 3075.9846,-9769.8892 3132.1655,-9248.0016 3189.5349,-8715.0745 3228.6166,-6919.5061 3233.1524,-6703.3526"/>
<polygon fill="#0019ff" stroke="#0019ff" points="3236.6581,-6703.1142 3233.3676,-6693.0433 3229.6596,-6702.9681 3236.6581,-6703.1142"/>
</g>
<!-- sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node29" class="node">
<title>sourcefile~schedulemanager.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node29"><a xlink:href="../sourcefile/schedulemanager.f90.html" xlink:title="ScheduleManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1127.7471,-3077.007 1013.4172,-3077.007 1013.4172,-3054.9962 1127.7471,-3054.9962 1127.7471,-3077.007"/>
<text text-anchor="middle" x="1070.5822" y="-3062.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ScheduleManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge452" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0c00ff" stroke-dasharray="5,2" d="M755.1332,-4807.0016C801.0013,-4470.2631 716.9169,-3591.1791 855.7932,-3281.0016 871.5712,-3245.7618 900.0711,-3253.8735 916.6465,-3219.0016"/>
<path fill="none" stroke="#0c00ff" stroke-dasharray="5,2" d="M916.6465,-3219.0016C947.2721,-3154.5705 957.4905,-3135.186 1013.4998,-3091.0016 1017.9591,-3087.4837 1022.9902,-3084.3573 1028.1709,-3081.6097"/>
<polygon fill="#0c00ff" stroke="#0c00ff" points="1030.0849,-3084.5721 1037.5666,-3077.0705 1027.0398,-3078.2691 1030.0849,-3084.5721"/>
<path fill="none" stroke="#0c00ff" stroke-dasharray="5,2" d="M406.1571,-7688.9913C423.0305,-7662.0183 465.3933,-7589.9461 480.9653,-7523.0016 519.0386,-7359.3238 501.4329,-6178.3299 516.9653,-6011.0016 552.1341,-5632.1347 601.3847,-5542.7755 654.4731,-5166.0016 673.333,-5032.1513 627.6386,-4983.6821 690.4731,-4864.0016 708.2813,-4830.0825 749.9626,-4844.9609 755.1332,-4807.0016"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge459" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M585.7192,-8362.0016C603.7265,-8388.8952 625.3606,-8371.8601 654.4731,-8386.0016 671.5515,-8394.2975 674.349,-8398.9763 690.4731,-8409.0016 763.3984,-8454.3435 774.6203,-8480.9851 855.7932,-8509.0016 1288.5175,-8658.3545 1556.7592,-8307.1595 1878.2922,-8633.0016 1930.7267,-8686.1388 1858.7488,-8917.1232 1914.2922,-8967.0016 1951.8378,-9000.7178 2092.7425,-9004.3769 2179.7498,-8948.0016 2271.5501,-8888.5207 2369.4587,-8615.4528 2424.6335,-8521.0016 2481.7604,-8423.2088 2524.0219,-8410.9606 2554.9226,-8302.0016 2623.1109,-8061.5628 2551.2919,-6299.7603 2590.9226,-6053.0016 2605.2126,-5964.0254 2643.8474,-5863.1114 2661.2134,-5820.6028"/>
<polygon fill="#3200ff" stroke="#3200ff" points="2664.4655,-5821.8973 2665.0497,-5811.3186 2657.996,-5819.2241 2664.4655,-5821.8973"/>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M399.655,-7711.1712C403.5763,-7778.3571 431.1981,-8133.506 585.7192,-8362.0016"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge488" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#5900ff" stroke-dasharray="5,2" d="M406.1228,-7688.9833C422.9199,-7661.9923 465.1261,-7589.8834 480.9653,-7523.0016 538.9656,-7278.0931 461.4812,-6636.4924 516.9653,-6391.0016 550.5514,-6242.3991 620.9598,-6225.6206 654.4731,-6077.0016 668.7539,-6013.6721 652.9463,-4961.9762 690.4731,-4909.0016 695.7301,-4901.5806 703.5171,-4896.3624 711.8826,-4892.6931"/>
<polygon fill="#5900ff" stroke="#5900ff" points="713.288,-4895.9056 721.4692,-4889.1737 710.8756,-4889.3344 713.288,-4895.9056"/>
</g>
<!-- sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node41" class="node">
<title>sourcefile~inputprocessor.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node41"><a xlink:href="../sourcefile/inputprocessor.f90.html" xlink:title="InputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="635.2783,-2964.007 536.1602,-2964.007 536.1602,-2941.9962 635.2783,-2941.9962 635.2783,-2964.007"/>
<text text-anchor="middle" x="585.7192" y="-2949.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">InputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge609" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0026" stroke-dasharray="5,2" d="M406.4787,-7688.6055C423.6697,-7661.3592 465.9974,-7589.7368 480.9653,-7523.0016 508.3653,-7400.8382 466.0842,-3130.3946 516.9653,-3016.0016 525.4355,-2996.9586 542.7732,-2981.1366 557.9181,-2970.1117"/>
<polygon fill="#ff0026" stroke="#ff0026" points="560.2583,-2972.7491 566.4982,-2964.1866 556.2806,-2966.989 560.2583,-2972.7491"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge73" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-8362.0016C603.85,-8388.8121 630.6136,-8364.1327 654.4731,-8386.0016 683.216,-8412.3464 662.8065,-8438.5289 690.4731,-8466.0016 747.4674,-8522.5963 779.1529,-8514.9691 855.7932,-8539.0016 1298.3837,-8677.787 1568.1923,-8403.0585 1878.2922,-8748.0016 1951.8715,-8829.8483 1859.1728,-8897.7407 1914.2922,-8993.0016 1945.9311,-9047.682 1966.2306,-9060.3036 2025.9177,-9081.0016 2327.2829,-9185.5074 2466.9123,-8902.5903 2554.9226,-8596.0016 2591.1489,-8469.8053 2532.3854,-6350.5229 2590.9226,-6233.0016 2630.5847,-6153.3746 2709.2036,-6189.6487 2748.8254,-6110.0016 2780.1426,-6047.0484 2778.7555,-3649.0518 2784.8254,-3579.0016 2799.0021,-3415.3953 2837.9034,-3220.7881 2851.1869,-3157.2206"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2854.6564,-3157.7294 2853.2916,-3147.2228 2847.8066,-3156.2873 2854.6564,-3157.7294"/>
</g>
<!-- sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node52" class="node">
<title>sourcefile~outputprocessor.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node52"><a xlink:href="../sourcefile/outputprocessor.f90.html" xlink:title="OutputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1496.4097,-2011.007 1388.9583,-2011.007 1388.9583,-1988.9962 1496.4097,-1988.9962 1496.4097,-2011.007"/>
<text text-anchor="middle" x="1442.684" y="-1996.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge192" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M406.4794,-7688.6057C423.6717,-7661.3596 466.0022,-7589.7378 480.9653,-7523.0016 536.7564,-7274.1716 435.5409,-3174.6606 516.9653,-2933.0016 558.0779,-2810.9839 597.4909,-2790.0683 690.4731,-2701.0016 802.0253,-2594.147 871.5243,-2617.3893 977.4998,-2505.0016 998.8347,-2482.3757 990.0011,-2465.3713 1013.4998,-2445.0016 1034.2954,-2426.9751 1049.1708,-2438.2923 1070.5822,-2421.0016"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge402" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-8723.0016C593.9989,-8734.0864 1056.7465,-8837.0016 1070.5822,-8837.0016 1070.5822,-8837.0016 1070.5822,-8837.0016 1247.8813,-8837.0016 1320.3147,-8837.0016 1835.8201,-8944.327 1878.2922,-9003.0016 1943.2223,-9092.7014 1881.015,-9394.3863 1914.2922,-9500.0016 1943.3798,-9592.3198 1961.7119,-9614.5699 2025.9177,-9687.0016 2083.2557,-9751.6856 2114.4728,-9749.3396 2179.7498,-9806.0016 2196.6019,-9820.6297 2195.4597,-9831.7124 2215.7498,-9841.0016 2326.9106,-9891.8931 2367.5215,-9865.0016 2489.7781,-9865.0016 2489.7781,-9865.0016 2489.7781,-9865.0016 2669.874,-9865.0016 2808.2049,-9865.0016 2857.4588,-9808.8261 2926.5784,-9689.0016 3007.8487,-9548.1128 3042.2988,-8314.4146 3046.8457,-8137.1738"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3050.3477,-8137.1353 3047.1022,-8127.0499 3043.35,-8136.958 3050.3477,-8137.1353"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge372" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-8723.0016C622.9345,-8770.4827 1067.5748,-8750.6485 1127.6646,-8756.0016 1389.5882,-8779.3354 1455.9924,-8781.2582 1715.2896,-8825.0016 1788.4473,-8837.3433 1830.1189,-8804.5774 1878.2922,-8861.0016 1965.0228,-8962.5869 1817.0545,-9369.4232 1914.2922,-9461.0016 1972.1891,-9515.5288 1750.4323,-9560.933 2388.6335,-9381.0016 2464.4018,-9359.6399 2506.8619,-9382.3499 2554.9226,-9320.0016 2606.8429,-9252.6464 2550.1767,-9013.6489 2590.9226,-8939.0016 2633.6751,-8860.6782 2705.1493,-8892.8137 2748.8254,-8815.0016 2815.4201,-8696.3586 2764.8019,-8645.5753 2784.8254,-8511.0016 2806.1623,-8367.6014 2839.6415,-8196.3415 2851.4256,-8137.2607"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2854.8939,-8137.7654 2853.4246,-8127.273 2848.03,-8136.3916 2854.8939,-8137.7654"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.7749,-7711.2714C406.1141,-7811.5026 456.8838,-8550.5177 585.7192,-8723.0016"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge362" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2102.8337,-7393.0016C2170.3572,-7348.2825 2245.0499,-7288.264 2280.8128,-7258.8155"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2283.1617,-7261.4149 2288.6396,-7252.346 2278.702,-7256.0194 2283.1617,-7261.4149"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M406.199,-7688.7328C453.6867,-7615.0519 733.1257,-7205.0016 1070.5822,-7205.0016 1070.5822,-7205.0016 1070.5822,-7205.0016 1247.8813,-7205.0016 1345.1456,-7205.0016 2021.741,-7446.7073 2102.8337,-7393.0016"/>
</g>
<!-- sourcefile~datasizing.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~datasizing.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node11"><a xlink:href="../sourcefile/datasizing.f90.html" xlink:title="DataSizing.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="439.3754,-10414.007 358.7923,-10414.007 358.7923,-10391.9962 439.3754,-10391.9962 439.3754,-10414.007"/>
<text text-anchor="middle" x="399.0839" y="-10399.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSizing.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge623" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2489.7781,-11613.0016C2523.7934,-11607.8888 2659.6018,-11539.0408 2669.874,-11537.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-11499.0016C587.7659,-11501.2871 687.4919,-11533.2772 690.4731,-11534.0016 1019.2414,-11613.8925 1104.3481,-11651.0016 1442.684,-11651.0016 1442.684,-11651.0016 1442.684,-11651.0016 1814.7909,-11651.0016 1994.4872,-11651.0016 2036.4269,-11610.5812 2215.7498,-11599.0016 2292.4273,-11594.0502 2311.9779,-11593.7216 2388.6335,-11599.0016 2433.908,-11602.1201 2444.9005,-11619.7471 2489.7781,-11613.0016"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.2665,-10414.0906C400.8824,-10499.1898 415.1995,-11048.606 516.9653,-11171.0016 537.6576,-11195.8885 557.8433,-11178.556 585.7192,-11195.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-11195.0016C640.8401,-11227.5207 794.5794,-11113.6742 855.7932,-11095.0016 949.7392,-11066.3445 974.6647,-11064.1417 1070.5822,-11043.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1070.5822,-11043.0016C1702.256,-10865.8187 1985.422,-10695.6135 2179.7498,-10069.0016 2213.9833,-9958.6152 2145.5047,-8080.777 2215.7498,-7989.0016 2221.7399,-7981.1755 2230.0272,-7975.6883 2239.1156,-7971.8626"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2240.5434,-7975.0706 2248.814,-7968.4489 2238.2192,-7968.4677 2240.5434,-7975.0706"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff4c00" stroke-dasharray="5,2" d="M1070.5822,-11043.0016C1185.9346,-11020.5626 1218.3755,-11033.6136 1332.0981,-11004.0016 1417.2417,-10981.8313 1436.2409,-10968.2838 1517.2698,-10934.0016 1606.8166,-10896.1156 1632.5185,-10892.0207 1715.2896,-10841.0016 1995.534,-10668.2624 2082.3307,-10578.4619 2179.7498,-10264.0016 2239.4415,-10071.3217 2196.0573,-9557.7523 2215.7498,-9357.0016 2264.0636,-8864.4754 2345.617,-8750.0187 2388.6335,-8257.0016 2465.1757,-7379.7447 2351.7074,-7153.5665 2424.6335,-6276.0016 2438.0571,-6114.4679 2473.5578,-5921.9109 2485.6649,-5859.0022"/>
<polygon fill="#ff4c00" stroke="#ff4c00" points="2489.1158,-5859.5911 2487.5829,-5849.1078 2482.2437,-5858.259 2489.1158,-5859.5911"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge101" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M439.6065,-10400.2588C454.935,-10397.0535 471.0564,-10390.6307 480.9653,-10378.0016 524.9989,-10321.8799 507.5397,-9807.7106 516.9653,-9737.0016 564.9304,-9377.1786 724.7028,-8477.5109 855.7932,-8139.0016 942.1072,-7916.1164 1060.6602,-7904.432 1127.6646,-7675.0016 1186.2666,-7474.3418 1119.5239,-6939.3302 1163.6646,-6735.0016 1205.523,-6541.2377 1279.8793,-6513.2338 1332.0981,-6322.0016 1361.0897,-6215.8306 1319.2415,-6175.6212 1368.0981,-6077.0016 1374.8577,-6063.357 1739.9121,-5695.1219 1751.2896,-5685.0016 1763.8482,-5673.8307 1778.6811,-5662.3007 1790.8517,-5653.2337"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="1793.1951,-5655.8547 1799.1726,-5647.1071 1789.0447,-5650.2178 1793.1951,-5655.8547"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge145" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#f2ff00" stroke-dasharray="5,2" d="M403.5158,-10414.2731C428.8983,-10476.8108 561.5217,-10777.1633 755.1332,-10744.0016"/>
<path fill="none" stroke="#f2ff00" stroke-dasharray="5,2" d="M755.1332,-10744.0016C801.3233,-10745.2157 1487.3768,-10446.2353 1517.2698,-10411.0016 1559.3912,-10361.3549 1514.7159,-10321.4669 1553.2698,-10269.0016 1653.7066,-10132.324 1790.1146,-10213.8913 1878.2922,-10069.0016 1934.3624,-9976.8695 1893.8223,-9690.8939 1914.2922,-9585.0016 1935.3575,-9476.0295 1969.8079,-9456.1541 1989.9177,-9347.0016 2002.7019,-9277.6115 1982.8456,-8768.8873 2025.9177,-8713.0016 2031.8976,-8705.2427 2040.3306,-8699.8561 2049.4356,-8696.1249"/>
<polygon fill="#f2ff00" stroke="#f2ff00" points="2050.7731,-8699.3663 2059.0925,-8692.8059 2048.4978,-8692.7463 2050.7731,-8699.3663"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge261" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#0cff00" stroke-dasharray="5,2" d="M585.7192,-11385.0016C684.7877,-11462.3651 1592.7372,-11350.9408 1715.2896,-11323.0016 1844.1388,-11293.6268 1890.1759,-11295.6999 1989.9177,-11209.0016 2013.6769,-11188.3495 2005.5639,-11172.0169 2025.9177,-11148.0016 2083.6084,-11079.9331 2124.4669,-11089.0397 2179.7498,-11019.0016 2211.9184,-10978.247 2371.8228,-10650.1255 2388.6335,-10601.0016 2421.9001,-10503.7909 2738.315,-8889.2079 2748.8254,-8787.0016 2754.5485,-8731.3484 2752.3041,-4804.5251 2784.8254,-4759.0016 2787.0819,-4755.843 2789.7711,-4753.081 2792.7619,-4750.6659"/>
<polygon fill="#0cff00" stroke="#0cff00" points="2794.8654,-4753.4715 2801.2936,-4745.0495 2791.0164,-4747.6247 2794.8654,-4753.4715"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge301" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M439.4843,-10412.1837C518.9033,-10427.8944 698.1943,-10451.5861 819.7932,-10378.0016 946.3558,-10301.4135 1083.6771,-9932.4437 1163.6646,-9808.0016 1250.7077,-9672.5824 1271.8674,-9638.054 1368.0981,-9509.0016 1480.3255,-9358.4966 1493.0486,-9304.6969 1634.2797,-9181.0016"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1634.2797,-9181.0016C1671.4442,-9150.364 1722.6085,-9130.083 1760.9778,-9118.0631"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1762.3876,-9121.2929 1770.9384,-9115.0372 1760.3528,-9114.5951 1762.3876,-9121.2929"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge461" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M755.1332,-11195.0016C894.1479,-11176.8133 930.3826,-11195.0016 1070.5822,-11195.0016 1070.5822,-11195.0016 1070.5822,-11195.0016 1247.8813,-11195.0016 1388.0741,-11195.0016 1757.9637,-11242.9396 1878.2922,-11171.0016 1925.6243,-11142.7043 2143.9099,-10762.8764 2179.7498,-10639.0016 2258.4356,-10367.0366 2149.3038,-10278.2131 2215.7498,-10003.0016 2260.2476,-9818.6966 2322.6978,-9790.768 2388.6335,-9613.0016 2477.5902,-9373.1696 2514.0778,-9314.5178 2554.9226,-9062.0016 2601.1752,-8776.0521 2581.0901,-8048.5007 2590.9226,-7759.0016 2618.0597,-6960.0033 2661.8593,-5978.1284 2668.904,-5821.5022"/>
<polygon fill="#3200ff" stroke="#3200ff" points="2672.4095,-5821.4571 2669.363,-5811.3097 2665.4166,-5821.1421 2672.4095,-5821.4571"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge505" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M755.1332,-11195.0016C797.4352,-11189.1569 1478.2076,-11112.2574 1517.2698,-11095.0016 1709.4073,-11010.1247 1721.841,-10930.1585 1878.2922,-10790.0016 1929.2504,-10744.3507 1943.6348,-10734.3864 1989.9177,-10684.0016 2007.2444,-10665.1393 2007.4752,-10656.7744 2025.9177,-10639.0016 2087.1928,-10579.9516 2139.983,-10600.2356 2179.7498,-10525.0016 2227.1406,-10435.3437 2191.5027,-9711.4725 2215.7498,-9613.0016 2258.5709,-9439.0983 2324.2976,-9416.145 2388.6335,-9249.0016 2408.6356,-9197.0366 2408.5257,-9182.3025 2424.6335,-9129.0016 2453.3943,-9033.8321 2470.1287,-9012.4609 2489.7781,-8915.0016"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M585.7192,-11195.0016C648.0144,-11237.2942 679.8899,-11197.793 755.1332,-11195.0016"/>
</g>
<!-- sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node33" class="node">
<title>sourcefile~dataplant.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node33"><a xlink:href="../sourcefile/dataplant.f90.html" xlink:title="DataPlant.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1989.7314,-7899.007 1914.4786,-7899.007 1914.4786,-7876.9962 1989.7314,-7876.9962 1989.7314,-7899.007"/>
<text text-anchor="middle" x="1952.105" y="-7884.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPlant.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge536" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#a500ff" stroke-dasharray="5,2" d="M425.1931,-10414.0249C448.7067,-10423.3173 484.4655,-10435.8928 516.9653,-10441.0016 577.3385,-10450.492 593.5587,-10445.9431 654.4731,-10441.0016 941.8444,-10417.6894 1468.6948,-10308.6214 1517.2698,-10259.0016 1574.3415,-10200.7022 1524.4444,-10155.324 1553.2698,-10079.0016 1615.327,-9914.6896 1660.8597,-9887.5738 1751.2896,-9737.0016 1806.2771,-9645.4433 1846.6443,-9635.0063 1878.2922,-9533.0016 1879.8723,-9527.9089 1942.7026,-8101.6057 1951.1656,-7909.3469"/>
<polygon fill="#a500ff" stroke="#a500ff" points="1954.6625,-7909.4917 1951.6057,-7899.3474 1947.6693,-7909.1838 1954.6625,-7909.4917"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge570" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M916.6465,-10744.0016C1181.6679,-10711.7742 1264.4718,-10838.8392 1517.2698,-10753.0016 1622.326,-10717.3297 1630.6169,-10672.6942 1715.2896,-10601.0016 1790.8872,-10536.9929 1822.7353,-10531.0111 1878.2922,-10449.0016 1890.9948,-10430.251 2008.4525,-10083.4207 2025.9177,-10069.0016 2052.7126,-10046.8801 2095.0499,-10088.8651 2102.8337,-10055.0016"/>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M2102.8337,-10055.0016C2113.3794,-10012.3788 2160.4892,-10032.4598 2179.7498,-9993.0016 2235.1249,-9879.5572 2199.3434,-7846.169 2215.7498,-7721.0016 2232.2364,-7595.2216 2277.7021,-7449.1496 2295.201,-7395.832"/>
<polygon fill="#ff0098" stroke="#ff0098" points="2298.5795,-7396.7634 2298.4008,-7386.17 2291.9344,-7394.5626 2298.5795,-7396.7634"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge582" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M916.6465,-10744.0016C1209.0725,-10708.8962 1314.4414,-10677.5572 1517.2698,-10464.0016 1544.3999,-10435.4366 1528.9682,-10414.0086 1553.2698,-10383.0016 1560.3169,-10374.01 1872.4133,-10140.797 1878.2922,-10131.0016 1953.825,-10005.1503 1972.7829,-9625.776 1989.9177,-9480.0016 2004.4754,-9356.1529 1983.6319,-9037.3146 2025.9177,-8920.0016 2065.3934,-8810.4848 2142.7819,-8818.3902 2179.7498,-8708.0016 2213.9281,-8605.9428 2150.2779,-6856.4276 2215.7498,-6771.0016 2218.1226,-6767.9056 2220.8548,-6765.1757 2223.8539,-6762.77"/>
<polygon fill="#ff004c" stroke="#ff004c" points="2225.9553,-6765.5761 2232.3519,-6757.1301 2222.0844,-6759.7437 2225.9553,-6765.5761"/>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M755.1332,-10744.0016C826.4941,-10751.7808 844.9085,-10746.5615 916.6465,-10744.0016"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge610" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0026" stroke-dasharray="5,2" d="M439.4942,-10400.5867C454.9997,-10397.4501 471.2815,-10390.9899 480.9653,-10378.0016 524.4679,-10319.6545 515.5707,-5210.7677 516.9653,-5138.0016 534.1345,-4242.1612 578.1091,-3140.3625 584.8474,-2974.3514"/>
<polygon fill="#ff0026" stroke="#ff0026" points="588.3577,-2974.1654 585.2673,-2964.0314 581.3635,-2973.8808 588.3577,-2974.1654"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge75" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-11385.0016C623.0218,-11415.6972 643.3382,-11366.5847 690.4731,-11356.0016 832.6424,-11324.0807 869.2118,-11320.3002 1013.4998,-11300.0016 1396.5401,-11246.1149 1543.5149,-11395.7743 1878.2922,-11202.0016 1890.1808,-11195.1204 2174.2356,-10822.5827 2179.7498,-10810.0016 2217.5866,-10723.6725 2195.7909,-10693.121 2215.7498,-10601.0016 2219.6868,-10582.8305 2552.1045,-9324.3796 2554.9226,-9306.0016 2605.302,-8977.4565 2553.2953,-8889.2503 2590.9226,-8559.0016 2635.608,-8166.806 2711.8722,-8078.0012 2748.8254,-7685.0016 2834.248,-6776.5293 2708.5333,-4488.2861 2784.8254,-3579.0016 2798.5558,-3415.3572 2837.7459,-3220.7747 2851.1452,-3157.2171"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2854.6143,-3157.7299 2853.2687,-3147.2209 2847.7671,-3156.2753 2854.6143,-3157.7299"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.4112,-10414.2152C402.5672,-10513.89 430.941,-11247.6353 585.7192,-11385.0016"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge403" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.6675,-10414.2052C404.8118,-10510.87 443.9599,-11205.0816 516.9653,-11399.0016 535.9685,-11449.4787 548.585,-11459.8851 585.7192,-11499.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-11499.0016C615.7463,-11530.6315 934.2335,-11517.5146 977.4998,-11523.0016 1186.4089,-11549.4954 1232.1015,-11613.0016 1442.684,-11613.0016 1442.684,-11613.0016 1442.684,-11613.0016 1814.7909,-11613.0016 1988.2034,-11613.0016 2053.7955,-11594.1965 2179.7498,-11475.0016 2419.0997,-11248.4964 2407.9844,-11132.094 2590.9226,-10858.0016 2675.9721,-10730.5738 2691.1201,-10694.2064 2784.8254,-10573.0016 2843.3424,-10497.3119 2890.8921,-10499.769 2926.5784,-10411.0016 2959.2712,-10329.6803 2958.1164,-9710.5348 2962.5784,-9623.0016 2993.5264,-9015.8738 3038.017,-8271.5505 3046.0908,-8137.2644"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3049.5956,-8137.2881 3046.7027,-8127.0959 3042.6082,-8136.8676 3049.5956,-8137.2881"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge374" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-11385.0016C636.548,-11426.7439 1098.6495,-11503.0505 1163.6646,-11513.0016 1286.6983,-11531.833 1318.2174,-11537.0016 1442.684,-11537.0016 1442.684,-11537.0016 1442.684,-11537.0016 1814.7909,-11537.0016 1916.4108,-11537.0016 1918.4303,-11462.2245 1989.9177,-11390.0016 2038.9934,-11340.4211 2361.1491,-10969.1207 2388.6335,-10905.0016 2440.4978,-10784.0063 2394.2713,-10739.095 2424.6335,-10611.0016 2523.2718,-10194.8628 2669.3643,-10125.2241 2748.8254,-9705.0016 2798.1469,-9444.1699 2757.3094,-8775.0256 2784.8254,-8511.0016 2799.8535,-8366.8037 2837.28,-8196.0429 2850.7627,-8137.1769"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2854.2206,-8137.7576 2853.0587,-8127.2267 2847.3998,-8136.1837 2854.2206,-8137.7576"/>
</g>
<!-- sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~emsmanager.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node12"><a xlink:href="../sourcefile/emsmanager.f90.html" xlink:title="EMSManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2348.8258,-2349.007 2255.5575,-2349.007 2255.5575,-2326.9962 2348.8258,-2326.9962 2348.8258,-2349.007"/>
<text text-anchor="middle" x="2302.1917" y="-2334.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EMSManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge624" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2309.2361,-2326.8052C2326.1105,-2299.3904 2368.9061,-2226.2226 2388.6335,-2159.0016 2425.9521,-2031.8395 2395.3422,-1992.249 2424.6335,-1863.0016 2425.4336,-1859.4714 2588.0815,-1371.2444 2590.9226,-1369.0016 2683.6694,-1295.7874 2737.5398,-1345.0016 2855.7019,-1345.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2855.7019,-1345.0016C3023.3884,-1335.5567 3070.3929,-1305.3381 3233.5946,-1345.0016"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff4c00" stroke-dasharray="5,2" d="M2303.6016,-2349.1434C2313.1091,-2424.8288 2368.0985,-2871.4588 2388.6335,-3237.0016 2443.4331,-4212.4835 2338.4554,-4461.7898 2424.6335,-5435.0016 2437.6714,-5582.2382 2472.7027,-5757.0466 2485.2388,-5816.7804"/>
<polygon fill="#ff4c00" stroke="#ff4c00" points="2481.8766,-5817.7984 2487.3704,-5826.8576 2488.7251,-5816.3498 2481.8766,-5817.7984"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge117" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M2303.1886,-2349.0439C2311.3058,-2439.467 2366.7998,-3067.6105 2388.6335,-3579.0016 2410.2391,-4085.0482 2383.2867,-5353.1844 2424.6335,-5858.0016 2437.8652,-6019.5511 2473.4901,-6212.0979 2485.647,-6275.0025"/>
<polygon fill="#ffe500" stroke="#ffe500" points="2482.2266,-6275.7493 2487.573,-6284.8963 2489.0976,-6274.4117 2482.2266,-6275.7493"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge260" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#0cff00" stroke-dasharray="5,2" d="M2317.5398,-2349.1788C2348.6832,-2371.4499 2422.0969,-2421.8894 2489.7781,-2453.0016"/>
<path fill="none" stroke="#0cff00" stroke-dasharray="5,2" d="M2669.874,-2567.0016C2733.2173,-2646.1535 2728.8341,-2681.6148 2748.8254,-2781.0016 2785.0564,-2961.1237 2775.059,-3423.5316 2784.8254,-3607.0016 2808.6026,-4053.6763 2846.2973,-4599.3771 2854.2136,-4712.7686"/>
<polygon fill="#0cff00" stroke="#0cff00" points="2850.7329,-4713.1687 2854.922,-4722.9002 2857.7158,-4712.6803 2850.7329,-4713.1687"/>
<path fill="none" stroke="#0cff00" stroke-dasharray="5,2" d="M2489.7781,-2453.0016C2517.8133,-2465.8891 2531.5676,-2456.8372 2554.9226,-2477.0016 2580.2136,-2498.8376 2565.0104,-2521.9065 2590.9226,-2543.0016 2619.3643,-2566.1559 2646.9586,-2538.3671 2669.874,-2567.0016"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge441" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M2307.9414,-2326.8254C2322.2516,-2298.859 2360.3492,-2223.471 2388.6335,-2159.0016 2469.2929,-1975.1521 2485.1166,-1927.24 2554.9226,-1739.0016 2571.9297,-1693.1404 2562.5184,-1674.8224 2590.9226,-1635.0016 2686.0214,-1501.6797 2795.2059,-1385.2274 2926.5784,-1483.0016 3181.9101,-1673.0327 3082.4557,-1854.6212 3132.1655,-2169.0016 3207.1642,-2643.3164 3231.5271,-6346.1476 3233.4664,-6660.7183"/>
<polygon fill="#0019ff" stroke="#0019ff" points="3229.967,-6660.8374 3233.5281,-6670.8158 3236.9669,-6660.7945 3229.967,-6660.8374"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge462" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M2304.3697,-2349.3209C2315.3794,-2406.9991 2365.2957,-2674.0911 2388.6335,-2895.0016 2418.3779,-3176.554 2396.3914,-3249.2946 2424.6335,-3531.0016 2465.0825,-3934.4684 2518.0346,-4030.1937 2554.9226,-4434.0016 2592.3503,-4843.718 2546.5649,-4949.9775 2590.9226,-5359.0016 2608.6034,-5522.0372 2650.7142,-5715.6571 2665.0209,-5778.8941"/>
<polygon fill="#3200ff" stroke="#3200ff" points="2661.6527,-5779.8665 2667.2859,-5788.8397 2668.4779,-5778.3121 2661.6527,-5779.8665"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge506" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M2324.3694,-2349.0536C2343.8738,-2359.8276 2371.7195,-2377.9418 2388.6335,-2401.0016 2422.8872,-2447.7013 2543.4554,-2838.233 2554.9226,-2895.0016 2618.0053,-3207.293 2662.4175,-4261.371 2669.0213,-4425.4528"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="2665.5344,-4425.854 2669.4312,-4435.7062 2672.5289,-4425.5744 2665.5344,-4425.854"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge74" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2321.2803,-2326.7505C2389.1801,-2288.3405 2621.7132,-2170.822 2748.8254,-2283.0016 2813.3917,-2339.9829 2848.4065,-2987.5227 2854.6755,-3114.4804"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2851.1964,-3114.9969 2855.1786,-3124.8148 2858.1881,-3114.6564 2851.1964,-3114.9969"/>
</g>
<!-- sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~datainterfaces.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node13"><a xlink:href="../sourcefile/datainterfaces.f90.html" xlink:title="DataInterfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="447.8836,-8886.007 350.2841,-8886.007 350.2841,-8863.9962 447.8836,-8863.9962 447.8836,-8886.007"/>
<text text-anchor="middle" x="399.0839" y="-8871.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataInterfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge625" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M400.0715,-8886.2536C407.2037,-8967.6994 451.3921,-9475.4547 480.9653,-9889.0016 490.1449,-10017.3671 478.9425,-10344.0535 516.9653,-10467.0016 607.988,-10761.327 1134.6052,-11499.0016 1442.684,-11499.0016 1442.684,-11499.0016 1442.684,-11499.0016 2102.8337,-11499.0016 2355.4169,-11499.0016 2421.6806,-11583.8877 2669.874,-11537.0016"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1442.684,-10169.0016C1561.3217,-10194.9526 1806.8854,-9937.2332 1878.2922,-9839.0016 1922.699,-9777.9131 1974.4724,-9591.9287 1989.9177,-9518.0016 2032.3098,-9315.0976 1959.6245,-9249.4 2025.9177,-9053.0016 2046.0582,-8993.3342 2089.2375,-8995.4913 2102.8337,-8934.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-9751.0016C847.8556,-9767.0143 1090.7969,-9856.2616 1332.0981,-10045.0016 1390.2626,-10090.4964 1372.8881,-10144.889 1442.684,-10169.0016"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff4c00" stroke-dasharray="5,2" d="M1442.684,-10169.0016C1638.7953,-10221.7702 1735.7357,-10175.6453 1878.2922,-10031.0016 1979.2917,-9928.5234 2090.6254,-9118.5527 2102.8337,-9067.0016"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge90" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ff7200" stroke-dasharray="5,2" d="M399.9333,-8886.0924C409.5569,-9011.5124 498.061,-10159.003 516.9653,-10188.0016 555.099,-10246.4974 610.2472,-10209.9646 654.4731,-10264.0016 688.1252,-10305.1191 657.3669,-10336.4434 690.4731,-10378.0016 732.0117,-10430.1449 766.6869,-10413.7015 819.7932,-10454.0016 897.3406,-10512.8491 917.7614,-10529.1384 977.4998,-10606.0016 1080.1251,-10738.046 1040.3103,-10820.0795 1163.6646,-10933.0016 1375.5285,-11126.948 1470.6504,-11140.8198 1751.2896,-11202.0016 1806.4398,-11214.0249 1824.3999,-11218.7863 1878.2922,-11202.0016 1964.8674,-11175.038 2122.6161,-10997.415 2179.7498,-10927.0016 2565.6373,-10451.4213 2554.3392,-10252.7433 2748.8254,-9672.0016 2837.6871,-9406.658 2885.5029,-9344.7983 2926.5784,-9068.0016 2961.4092,-8833.2857 2955.528,-5034.1831 2962.5784,-4797.0016 2982.5841,-4123.992 3036.4975,-3298.9102 3045.9483,-3157.1916"/>
<polygon fill="#ff7200" stroke="#ff7200" points="3049.4414,-3157.4093 3046.6167,-3147.1979 3042.457,-3156.942 3049.4414,-3157.4093"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge102" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M447.9307,-8870.4056C460.6182,-8866.7584 472.9553,-8860.5292 480.9653,-8850.0016 526.8998,-8789.6301 497.2866,-7558.2645 516.9653,-7485.0016 521.5678,-7467.8668 1119.9881,-6378.9971 1127.6646,-6363.0016 1145.5925,-6325.6448 1143.5755,-6313.242 1163.6646,-6277.0016 1226.4913,-6163.6629 1281.4476,-6158.2802 1332.0981,-6039.0016 1365.6913,-5959.8918 1307.2726,-5909.7233 1368.0981,-5849.0016 1391.9679,-5825.1726 1415.2537,-5854.6273 1442.684,-5835.0016"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge119" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M1442.684,-10245.0016C1465.675,-10265.0234 1963.2506,-10218.7774 1989.9177,-10204.0016 2013.5553,-10190.9044 2005.6631,-10172.8908 2025.9177,-10155.0016 2084.6263,-10103.1492 2138.5855,-10135.6414 2179.7498,-10069.0016 2225.8111,-9994.434 2200.9154,-9367.384 2215.7498,-9281.0016 2260.5555,-9020.0913 2347.6536,-8972.5401 2388.6335,-8711.0016 2464.3232,-8227.9411 2349.0118,-6994.0727 2424.6335,-6511.0016 2436.1021,-6437.7409 2466.4674,-6354.7111 2481.3355,-6316.831"/>
<polygon fill="#ffe500" stroke="#ffe500" points="2484.6469,-6317.9754 2485.0895,-6307.3898 2478.1423,-6315.3889 2484.6469,-6317.9754"/>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M585.7192,-9751.0016C714.5892,-9884.4564 1208.0318,-9987.0698 1332.0981,-10125.0016 1362.5717,-10158.8809 1335.1213,-10189.5537 1368.0981,-10221.0016 1393.2991,-10245.0341 1414.9109,-10223.9943 1442.684,-10245.0016"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge146" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#f2ff00" stroke-dasharray="5,2" d="M1442.684,-9675.0016C1639.251,-9646.382 1749.2648,-9726.0302 1878.2922,-9575.0016 1916.0559,-9530.7986 1901.8783,-9109.7986 1914.2922,-9053.0016 1924.4381,-9006.5818 1935.9035,-8997.6698 1952.105,-8953.0016"/>
<path fill="none" stroke="#f2ff00" stroke-dasharray="5,2" d="M1952.105,-8953.0016C1968.4557,-8908.3878 1975.5766,-8898.3014 1989.9177,-8853.0016 2009.3085,-8791.7513 1981.9319,-8759.8295 2025.9177,-8713.0016 2032.342,-8706.1622 2040.6537,-8701.19 2049.4296,-8697.5762"/>
<polygon fill="#f2ff00" stroke="#f2ff00" points="2050.8089,-8700.8008 2059.0673,-8694.1639 2048.4725,-8694.2022 2050.8089,-8700.8008"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge216" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1442.684,-9219.0016C1540.8239,-9212.1206 1814.7256,-9215.0887 1878.2922,-9140.0016 1925.7691,-9083.9203 1908.128,-6568.2216 1914.2922,-6495.0016 1932.6308,-6277.1727 1968.1903,-6226.5186 1989.9177,-6009.0016 1998.8058,-5920.0216 1976.0501,-5279.2287 2025.9177,-5205.0016 2067.91,-5142.4969 2138.5781,-5197.0498 2179.7498,-5134.0016 2209.1434,-5088.9896 2212.562,-3252.6663 2215.7498,-3199.0016 2235.7155,-2862.8882 2286.9781,-2455.3593 2299.4338,-2359.0886"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2302.9085,-2359.5087 2300.7264,-2349.141 2295.9669,-2358.6066 2302.9085,-2359.5087"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M916.6465,-9219.0016C1136.9859,-9140.8327 1208.9136,-9215.647 1442.684,-9219.0016"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge262" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#0cff00" stroke-dasharray="5,2" d="M755.1332,-10250.0016C778.1265,-10268.3288 798.0611,-10244.1952 819.7932,-10264.0016 859.0635,-10299.7921 818.1617,-10340.4919 855.7932,-10378.0016 895.9278,-10418.0063 924.9932,-10394.6893 977.4998,-10416.0016 1046.8087,-10444.1339 1084.7494,-10430.7363 1127.6646,-10492.0016 1204.457,-10601.6299 1080.825,-10685.868 1163.6646,-10791.0016 1223.658,-10867.1407 1274.9161,-10840.2909 1368.0981,-10867.0016 1634.2588,-10943.2968 1751.3094,-11045.4598 1989.9177,-10905.0016 2027.3717,-10882.9541 2164.4081,-10603.6652 2179.7498,-10563.0016 2206.245,-10492.775 2194.4456,-10469.9732 2215.7498,-10398.0016 2336.9602,-9988.5187 2464.8644,-9916.4435 2554.9226,-9499.0016 2607.5183,-9255.2079 2528.3766,-9180.4342 2590.9226,-8939.0016 2631.9999,-8780.4401 2712.1108,-8765.6297 2748.8254,-8606.0016 2772.7793,-8501.855 2722.6869,-4845.9447 2784.8254,-4759.0016 2787.0825,-4755.8435 2789.7722,-4753.0818 2792.7635,-4750.667"/>
<polygon fill="#0cff00" stroke="#0cff00" points="2794.867,-4753.4726 2801.2958,-4745.0511 2791.0185,-4747.6254 2794.867,-4753.4726"/>
</g>
<!-- sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~reportsizingmanager.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node16"><a xlink:href="../sourcefile/reportsizingmanager.f90.html" xlink:title="ReportSizingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2168.3288,-5769.007 2037.3387,-5769.007 2037.3387,-5746.9962 2168.3288,-5746.9962 2168.3288,-5769.007"/>
<text text-anchor="middle" x="2102.8337" y="-5754.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ReportSizingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge287" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#00ff19" stroke-dasharray="5,2" d="M1442.684,-9219.0016C1635.6529,-9200.05 1743.3846,-9334.2715 1878.2922,-9195.0016 1908.257,-9164.0679 1911.4569,-7687.9753 1914.2922,-7645.0016 1934.7187,-7335.4044 1967.9661,-7260.4945 1989.9177,-6951.0016 1998.4753,-6830.3497 1986.4197,-5977.3258 2025.9177,-5863.0016 2037.7861,-5828.6493 2065.1027,-5796.0154 2083.771,-5776.5008"/>
<polygon fill="#00ff19" stroke="#00ff19" points="2086.4205,-5778.7981 2090.9317,-5769.2117 2081.427,-5773.8925 2086.4205,-5778.7981"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge302" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1070.5822,-9143.0016C1115.3377,-9127.4279 1119.8992,-9109.1728 1163.6646,-9091.0016 1199.6094,-9076.0775 1209.1449,-9070.7765 1247.8813,-9067.0016"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M755.1332,-9295.0016C803.5136,-9308.9634 809.9441,-9263.8211 855.7932,-9243.0016 882.2652,-9230.9811 889.2463,-9228.7222 916.6465,-9219.0016"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M448.2646,-8878.2346C459.6748,-8880.6574 471.2968,-8884.6149 480.9653,-8891.0016 571.4963,-8950.8029 650.8881,-9264.9182 755.1332,-9295.0016"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M916.6465,-9219.0016C962.6924,-9202.6661 969.408,-9188.0489 1013.4998,-9167.0016 1038.3363,-9155.1458 1044.5897,-9152.0463 1070.5822,-9143.0016"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge315" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ffb2" stroke-dasharray="5,2" d="M585.7192,-8875.0016C997.9941,-8746.9279 1352.7031,-8309.2757 1427.9783,-8211.486"/>
<polygon fill="#00ffb2" stroke="#00ffb2" points="1430.9121,-8213.4112 1434.2045,-8203.3409 1425.3507,-8209.1601 1430.9121,-8213.4112"/>
</g>
<!-- sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node22" class="node">
<title>sourcefile~dataenvironment.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node22"><a xlink:href="../sourcefile/dataenvironment.f90.html" xlink:title="DataEnvironment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="971.7845,-5315.007 861.5084,-5315.007 861.5084,-5292.9962 971.7845,-5292.9962 971.7845,-5315.007"/>
<text text-anchor="middle" x="916.6465" y="-5300.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEnvironment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge320" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M585.7192,-6529.0016C593.5617,-6471.8845 629.2293,-6470.8342 654.4731,-6419.0016 748.8644,-6225.1905 769.635,-6172.6599 819.7932,-5963.0016 850.4228,-5834.9719 836.9644,-5799.2907 855.7932,-5669.0016 874.7483,-5537.8391 902.669,-5381.0544 912.7979,-5325.1093"/>
<polygon fill="#00ffff" stroke="#00ffff" points="916.2863,-5325.4881 914.6293,-5315.0237 909.3989,-5324.2374 916.2863,-5325.4881"/>
</g>
<!-- sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node23" class="node">
<title>sourcefile~dataheatbalance.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node23"><a xlink:href="../sourcefile/dataheatbalance.f90.html" xlink:title="DataHeatBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1126.399,-1402.007 1014.7654,-1402.007 1014.7654,-1379.9962 1126.399,-1379.9962 1126.399,-1402.007"/>
<text text-anchor="middle" x="1070.5822" y="-1387.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge333" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00d8ff" stroke-dasharray="5,2" d="M448.0697,-8870.5103C460.7602,-8866.8654 473.0642,-8860.6112 480.9653,-8850.0016 532.8222,-8780.3688 494.3916,-2682.8365 516.9653,-2599.0016 548.9285,-2480.2956 619.0556,-2476.7232 654.4731,-2359.0016 690.3999,-2239.5877 641.0967,-1913.511 690.4731,-1799.0016 770.7947,-1612.7271 974.2847,-1458.0451 1045.5025,-1408.0338"/>
<polygon fill="#00d8ff" stroke="#00d8ff" points="1047.6835,-1410.7803 1053.8946,-1402.197 1043.6865,-1405.0336 1047.6835,-1410.7803"/>
</g>
<!-- sourcefile~psychroutines.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node24" class="node">
<title>sourcefile~psychroutines.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node24"><a xlink:href="../sourcefile/psychroutines.f90.html" xlink:title="PsychRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1492.2328,-6189.007 1393.1351,-6189.007 1393.1351,-6166.9962 1492.2328,-6166.9962 1492.2328,-6189.007"/>
<text text-anchor="middle" x="1442.684" y="-6174.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PsychRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge341" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00b2ff" stroke-dasharray="5,2" d="M447.9138,-8870.3927C460.6009,-8866.7453 472.9421,-8860.5191 480.9653,-8850.0016 564.9696,-8739.8828 457.5767,-7729.125 516.9653,-7604.0016 551.6213,-7530.9866 601.6523,-7546.1751 654.4731,-7485.0016 700.274,-7431.9581 1304.3119,-6485.3387 1332.0981,-6421.0016 1357.9126,-6361.2301 1340.2375,-6337.8471 1368.0981,-6279.0016 1383.034,-6247.4551 1408.4661,-6215.8577 1425.4204,-6196.6153"/>
<polygon fill="#00b2ff" stroke="#00b2ff" points="1428.0364,-6198.9406 1432.1122,-6189.1611 1422.8274,-6194.2644 1428.0364,-6198.9406"/>
</g>
<!-- sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node26" class="node">
<title>sourcefile~branchnodeconnections.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node26"><a xlink:href="../sourcefile/branchnodeconnections.f90.html" xlink:title="BranchNodeConnections.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1515.9386,-3679.007 1369.4293,-3679.007 1369.4293,-3656.9962 1515.9386,-3656.9962 1515.9386,-3679.007"/>
<text text-anchor="middle" x="1442.684" y="-3664.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">BranchNodeConnections.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge348" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M585.7192,-6405.0016C594.0977,-6336.9918 634.8756,-6332.6633 654.4731,-6267.0016 693.3844,-6136.6294 669.0829,-6097.3648 690.4731,-5963.0016 736.4391,-5674.2658 778.1747,-5607.396 819.7932,-5318.0016 845.7689,-5137.3793 808.0403,-5085.1232 855.7932,-4909.0016 999.1162,-4380.4002 1358.0452,-3800.8119 1430.0062,-3687.7233"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1433.1212,-3689.3485 1435.5545,-3679.0368 1427.2219,-3685.5804 1433.1212,-3689.3485"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge442" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M400.0085,-8886.2583C406.6981,-8967.7375 448.3467,-9475.6837 480.9653,-9889.0016 489.1542,-9992.7647 478.4756,-10259.294 516.9653,-10356.0016 596.0555,-10554.7202 705.6588,-10549.1213 819.7932,-10730.0016 926.4837,-10899.0848 891.0895,-10977.9265 1013.4998,-11136.0016 1066.8415,-11204.8847 1086.4067,-11221.7345 1163.6646,-11262.0016 1447.4925,-11409.9337 1567.6385,-11428.0499 1878.2922,-11351.0016 1939.9648,-11335.7056 2169.5152,-11179.5529 2179.7498,-11173.0016 2182.7808,-11171.0614 3045.2065,-10608.8761 3047.3719,-10606.0016"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge456" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0c00ff" stroke-dasharray="5,2" d="M448.0097,-8870.4653C460.6989,-8866.8195 473.0172,-8860.576 480.9653,-8850.0016 522.0105,-8795.3944 500.8314,-6457.3819 516.9653,-6391.0016 549.3329,-6257.8309 621.1656,-6247.9404 654.4731,-6115.0016 688.2691,-5980.1134 631.4289,-4989.9015 690.4731,-4864.0016 706.7396,-4829.3167 750.3136,-4845.007 755.1332,-4807.0016"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge463" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M1442.684,-10245.0016C1470.0037,-10264.7809 1492.9335,-10235.6492 1517.2698,-10259.0016 1568.6114,-10308.2677 1501.5478,-10366.135 1553.2698,-10415.0016 1658.8446,-10514.7482 1747.8345,-10512.8468 1878.2922,-10449.0016 1974.3444,-10401.9943 1952.3063,-10336.5714 2025.9177,-10259.0016 2088.1314,-10193.4424 2139.9507,-10207.1471 2179.7498,-10126.0016 2244.9193,-9993.1287 2182.4339,-9605.1971 2215.7498,-9461.0016 2229.1653,-9402.9371 2380.1172,-9006.6218 2424.6335,-8967.0016 2469.6912,-8926.8996 2517.9933,-8976.6943 2554.9226,-8929.0016 2594.7367,-8877.5834 2588.6132,-7823.9914 2590.9226,-7759.0016 2619.3133,-6960.0469 2662.0662,-5978.1356 2668.9296,-5821.5031"/>
<polygon fill="#3200ff" stroke="#3200ff" points="2672.4351,-5821.454 2669.3767,-5811.3102 2665.4418,-5821.1472 2672.4351,-5821.454"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge492" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#5900ff" stroke-dasharray="5,2" d="M585.7192,-6405.0016C594.0977,-6336.9918 637.8947,-6333.4898 654.4731,-6267.0016 672.7324,-6193.7728 646.9799,-4970.6798 690.4731,-4909.0016 695.7141,-4901.5693 703.4946,-4896.3464 711.8587,-4892.6763"/>
<polygon fill="#5900ff" stroke="#5900ff" points="713.2644,-4895.8887 721.4459,-4889.1572 710.8523,-4889.3174 713.2644,-4895.8887"/>
<path fill="none" stroke="#5900ff" stroke-dasharray="5,2" d="M448.0045,-8870.4614C460.6935,-8866.8154 473.0131,-8860.5729 480.9653,-8850.0016 519.9613,-8798.1627 498.6012,-6577.2168 516.9653,-6515.0016 533.2867,-6459.7071 578.67,-6462.2221 585.7192,-6405.0016"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge507" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M399.431,-8886.031C402.4543,-8976.9853 426.4097,-9603.8028 516.9653,-9765.0016 661.8811,-10022.9672 1274.2665,-10502.4929 1553.2698,-10601.0016 1882.7557,-10717.3344 2042.9275,-10447.5198 2179.7498,-10126.0016 2238.0473,-9989.0083 2183.9514,-9602.448 2215.7498,-9457.0016 2219.1185,-9441.5929 2412.5993,-8939.1974 2424.6335,-8929.0016 2447.2286,-8909.8584 2484.1956,-8944.0849 2489.7781,-8915.0016"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M2489.7781,-8915.0016C2546.8102,-8632.1264 2539.0479,-8557.1319 2554.9226,-8269.0016 2560.6671,-8164.7383 2545.1798,-4603.8709 2590.9226,-4510.0016 2600.8003,-4489.7316 2620.674,-4473.9299 2638.0099,-4463.2217"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="2639.9156,-4466.1618 2646.7778,-4458.0896 2636.3794,-4460.1206 2639.9156,-4466.1618"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge537" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#a500ff" stroke-dasharray="5,2" d="M585.7192,-8875.0016C624.5718,-8861.454 629.1406,-8845.4257 654.4731,-8813.0016 863.4319,-8545.5478 771.8506,-8377.3311 1013.4998,-8139.0016 1276.1097,-7879.9993 1392.8257,-7845.8914 1751.2896,-7759.0016 1806.1466,-7745.7045 1832.3122,-7726.261 1878.2922,-7759.0016 1918.1363,-7787.3731 1884.3054,-7824.3586 1914.2922,-7863.0016 1916.4814,-7865.8228 1919.0825,-7868.4292 1921.8807,-7870.8085"/>
<polygon fill="#a500ff" stroke="#a500ff" points="1919.9906,-7873.764 1930.1102,-7876.9019 1924.1561,-7868.1383 1919.9906,-7873.764"/>
<path fill="none" stroke="#a500ff" stroke-dasharray="5,2" d="M448.1826,-8884.8313C486.9912,-8890.3222 541.7583,-8892.9106 585.7192,-8875.0016"/>
</g>
<!-- sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node37" class="node">
<title>sourcefile~nodeinputmanager.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node37"><a xlink:href="../sourcefile/nodeinputmanager.f90.html" xlink:title="NodeInputManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1693.6152,-6455.007 1574.9441,-6455.007 1574.9441,-6432.9962 1693.6152,-6432.9962 1693.6152,-6455.007"/>
<text text-anchor="middle" x="1634.2797" y="-6440.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">NodeInputManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge552" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M585.7192,-8400.0016C597.035,-8369.6787 634.7678,-8401.677 654.4731,-8376.0016 720.1381,-8290.4428 652.8337,-7993.0732 690.4731,-7892.0016 774.5132,-7666.3323 859.9492,-7642.5053 1013.4998,-7457.0016 1061.2667,-7399.2946 1093.6872,-7399.7647 1127.6646,-7333.0016 1164.6683,-7260.2918 1132.2924,-7228.3129 1163.6646,-7153.0016 1226.2749,-7002.7006 1276.8375,-6983.842 1368.0981,-6849.0016 1434.107,-6751.4716 1452.7551,-6728.5264 1517.2698,-6630.0016 1556.4309,-6570.1959 1600.9535,-6498.288 1622.0074,-6464.0368"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="1625.0505,-6465.7696 1627.2993,-6455.4161 1619.0849,-6462.1074 1625.0505,-6465.7696"/>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M447.9055,-8868.9249C460.1329,-8865.2262 472.2374,-8859.3406 480.9653,-8850.0016 489.7286,-8840.6249 581.1223,-8411.9843 585.7192,-8400.0016"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge571" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M755.1332,-9751.0016C894.8695,-9762.389 930.3826,-9751.0016 1070.5822,-9751.0016 1070.5822,-9751.0016 1070.5822,-9751.0016 1442.684,-9751.0016 1539.5358,-9751.0016 1806.6509,-9830.1767 1878.2922,-9765.0016 1909.6639,-9736.4615 1907.325,-9426.8367 1914.2922,-9385.0016 1949.2075,-9175.3511 1936.9969,-9113.0443 2025.9177,-8920.0016 2074.6226,-8814.2657 2141.7968,-8818.0554 2179.7498,-8708.0016 2251.3037,-8500.5139 2184.984,-7938.3138 2215.7498,-7721.0016 2233.5319,-7595.3982 2278.2195,-7449.2201 2295.356,-7395.8532"/>
<polygon fill="#ff0098" stroke="#ff0098" points="2298.7367,-7396.7738 2298.4876,-7386.1819 2292.0771,-7394.6173 2298.7367,-7396.7738"/>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M585.7192,-9751.0016C640.5721,-9802.5817 680.125,-9744.4345 755.1332,-9751.0016"/>
</g>
<!-- sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node39" class="node">
<title>sourcefile~fluidproperties.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node39"><a xlink:href="../sourcefile/fluidproperties.f90.html" xlink:title="FluidProperties.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1492.8112,-5010.007 1392.5567,-5010.007 1392.5567,-4987.9962 1492.8112,-4987.9962 1492.8112,-5010.007"/>
<text text-anchor="middle" x="1442.684" y="-4995.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">FluidProperties.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge578" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0072" stroke-dasharray="5,2" d="M447.9343,-8870.4083C460.6218,-8866.7612 472.9581,-8860.5313 480.9653,-8850.0016 527.825,-8788.3801 504.5811,-7533.4193 516.9653,-7457.0016 554.9141,-7222.8363 952.7681,-6018.1634 1013.4998,-5897.0016 1052.9698,-5818.2574 1092.9064,-5815.9362 1127.6646,-5735.0016 1159.8584,-5660.0379 1119.8596,-5623.8284 1163.6646,-5555.0016 1213.5763,-5476.5798 1280.118,-5508.068 1332.0981,-5431.0016 1379.2395,-5361.1094 1426.2081,-5097.4746 1439.179,-5020.3307"/>
<polygon fill="#ff0072" stroke="#ff0072" points="1442.6512,-5020.7864 1440.842,-5010.3472 1435.7464,-5019.6361 1442.6512,-5020.7864"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge583" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M448.2781,-8874.2243C460.658,-8876.5409 472.7472,-8881.4487 480.9653,-8891.0016 541.5998,-8961.4842 461.5163,-9652.3709 516.9653,-9727.0016 536.2677,-9752.9813 562.1408,-9728.83 585.7192,-9751.0016"/>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M1070.5822,-9675.0016C1234.2647,-9627.4537 1220.2978,-9517.9007 1368.0981,-9433.0016 1578.1834,-9312.3249 1737.8085,-9438.3921 1878.2922,-9241.0016 1922.5367,-9178.8347 1906.7266,-7943.9296 1914.2922,-7868.0016 1921.4602,-7796.0638 1978.2276,-7281.3347 2025.9177,-7227.0016 2049.5407,-7200.0881 2086.9277,-7235.0856 2102.8337,-7203.0016"/>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M585.7192,-9751.0016C588.2021,-9753.3364 1067.2317,-9675.6263 1070.5822,-9675.0016"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge613" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0026" stroke-dasharray="5,2" d="M448.067,-8870.5082C460.7574,-8866.8632 473.062,-8860.6095 480.9653,-8850.0016 529.3764,-8785.0238 484.102,-3090.0675 516.9653,-3016.0016 525.4182,-2996.9509 542.756,-2981.129 557.9052,-2970.106"/>
<polygon fill="#ff0026" stroke="#ff0026" points="560.2462,-2972.743 566.4883,-2964.1823 556.27,-2966.9819 560.2462,-2972.743"/>
</g>
<!-- sourcefile~globalnames.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node42" class="node">
<title>sourcefile~globalnames.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node42"><a xlink:href="../sourcefile/globalnames.f90.html" xlink:title="GlobalNames.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2149.4576,-7861.007 2056.2099,-7861.007 2056.2099,-7838.9962 2149.4576,-7838.9962 2149.4576,-7861.007"/>
<text text-anchor="middle" x="2102.8337" y="-7846.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">GlobalNames.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1070.5822,-9675.0016C1229.6732,-9629.8342 1279.1761,-9699.806 1442.684,-9675.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1442.684,-9675.0016C1549.5527,-9660.4688 1818.9757,-9551.0776 1878.2922,-9461.0016 1921.8573,-9394.8453 1907.2694,-8827.9019 1914.2922,-8749.0016 1915.3772,-8736.8123 2018.1113,-7884.4258 2025.9177,-7875.0016 2031.3899,-7868.3954 2038.6308,-7863.5185 2046.4846,-7859.9218"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2047.8607,-7863.1421 2055.9165,-7856.2606 2045.3276,-7856.6165 2047.8607,-7863.1421"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge76" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-10250.0016C778.2216,-10268.2089 792.1474,-10253.9874 819.7932,-10264.0016 964.9741,-10316.5908 993.2954,-10348.9224 1127.6646,-10425.0016 1143.9817,-10434.2403 1147.5081,-10437.4845 1163.6646,-10447.0016 1253.6761,-10500.0236 1273.1086,-10519.5231 1368.0981,-10563.0016 1447.5415,-10599.3643 1467.1771,-10614.1174 1553.2698,-10629.0016 1626.0544,-10641.5851 1978.0173,-10626.9838 1989.9177,-10620.0016 1994.3234,-10617.4167 2178.1239,-10309.844 2179.7498,-10305.0016 2228.1157,-10160.9485 2173.6077,-10110.9969 2215.7498,-9965.0016 2264.0872,-9797.5432 2324.8229,-9775.196 2388.6335,-9613.0016 2482.2829,-9374.9628 2511.3548,-9314.0622 2554.9226,-9062.0016 2610.325,-8741.4718 2563.6024,-8655.1349 2590.9226,-8331.0016 2640.5845,-7741.8002 2710.5778,-7600.0539 2748.8254,-7010.0016 2798.1469,-6249.1121 2720.4189,-4338.763 2784.8254,-3579.0016 2798.6969,-3415.3691 2837.7957,-3220.7789 2851.1584,-3157.2182"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2854.6276,-3157.7298 2853.276,-3147.2215 2847.7796,-3156.2791 2854.6276,-3157.7298"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.7347,-8886.1481C405.4491,-8982.3232 448.4923,-9673.0875 516.9653,-9868.0016 533.5435,-9915.1926 715.2321,-10219.8398 755.1332,-10250.0016"/>
</g>
<!-- sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node49" class="node">
<title>sourcefile~outairnodemanager.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node49"><a xlink:href="../sourcefile/outairnodemanager.f90.html" xlink:title="OutAirNodeManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1877.5301,-6681.007 1752.0517,-6681.007 1752.0517,-6658.9962 1877.5301,-6658.9962 1877.5301,-6681.007"/>
<text text-anchor="middle" x="1814.7909" y="-6666.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutAirNodeManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge114" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-8400.0016C597.3118,-8369.7834 633.8003,-8400.9046 654.4731,-8376.0016 722.5246,-8294.0253 654.4235,-8239.259 690.4731,-8139.0016 698.4707,-8116.7596 1117.6735,-7430.4224 1127.6646,-7409.0016 1148.3402,-7364.6732 1134.6615,-7344.3884 1163.6646,-7305.0016 1218.7838,-7230.1483 1261.4761,-7241.4473 1332.0981,-7181.0016 1514.3173,-7025.0394 1588.1915,-7004.4079 1715.2896,-6801.0016 1741.6545,-6758.8075 1716.9564,-6731.0112 1751.2896,-6695.0016 1754.6391,-6691.4885 1758.5429,-6688.4595 1762.7378,-6685.8497"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1764.5124,-6688.8697 1771.6728,-6681.0607 1761.2055,-6682.7 1764.5124,-6688.8697"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge165" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-6529.0016C593.5962,-6471.8892 637.7527,-6474.1768 654.4731,-6419.0016 732.1682,-6162.6183 628.5314,-5474.6396 690.4731,-5214.0016 721.8875,-5081.8164 785.808,-5068.5493 819.7932,-4937.0016 877.9627,-4711.8432 816.7016,-4644.2435 855.7932,-4415.0016 942.3569,-3907.3731 987.277,-3781.8068 1163.6646,-3298.0016 1225.1379,-3129.3891 1266.1949,-3097.9325 1332.0981,-2931.0016 1350.6778,-2883.94 1347.7631,-2869.3318 1368.0981,-2823.0016 1450.0076,-2636.3834 1580.4735,-2426.4248 1621.5,-2361.9086"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1624.6632,-2363.4581 1627.0925,-2353.1456 1618.7624,-2359.6923 1624.6632,-2363.4581"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M447.9871,-8870.4483C460.6758,-8866.8021 472.9995,-8860.5626 480.9653,-8850.0016 514.4419,-8805.6189 510.5966,-6904.2279 516.9653,-6849.0016 533.6304,-6704.4915 566.6979,-6673.2205 585.7192,-6529.0016"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge199" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M448.0431,-8870.4904C460.733,-8866.845 473.0433,-8860.5956 480.9653,-8850.0016 511.8416,-8808.7114 514.6238,-5189.5064 516.9653,-5138.0016 538.5637,-4662.9267 390.3029,-3373.8654 690.4731,-3005.0016 728.2847,-2958.537 776.8485,-3008.7679 819.7932,-2967.0016 856.9725,-2930.8425 833.791,-2902.9663 855.7932,-2856.0016 898.8146,-2764.1708 934.9491,-2755.0515 977.4998,-2663.0016 999.972,-2614.3874 981.2387,-2590.7517 1013.4998,-2548.0016 1050.0694,-2499.5422 1081.1076,-2511.9644 1127.6646,-2473.0016 1145.5056,-2458.0707 1147.0161,-2451.2516 1163.6646,-2435.0016 1235.8238,-2364.5692 1284.8528,-2372.0833 1332.0981,-2283.0016 1386.3448,-2180.7189 1294.133,-2114.0723 1368.0981,-2025.0016 1371.4477,-2020.968 1375.4699,-2017.582 1379.8878,-2014.74"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1381.6695,-2017.7556 1388.7986,-2009.9181 1378.338,-2011.5992 1381.6695,-2017.7556"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node53" class="node">
<title>sourcefile~dataruntimelanguage.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node53"><a xlink:href="../sourcefile/dataruntimelanguage.f90.html" xlink:title="DataRuntimeLanguage.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="654.2279,-1901.007 517.2105,-1901.007 517.2105,-1878.9962 654.2279,-1878.9962 654.2279,-1901.007"/>
<text text-anchor="middle" x="585.7192" y="-1886.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRuntimeLanguage.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge201" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M448.0732,-8870.5128C460.7638,-8866.868 473.0669,-8860.6132 480.9653,-8850.0016 537.8629,-8773.5594 488.2467,-2079.8641 516.9653,-1989.0016 526.9086,-1957.5423 550.6837,-1927.2812 567.4812,-1908.6755"/>
<polygon fill="#0000ff" stroke="#0000ff" points="570.1701,-1910.9236 574.4126,-1901.2152 565.0418,-1906.1589 570.1701,-1910.9236"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node58" class="node">
<title>sourcefile~sqlitefortranroutines.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node58"><a xlink:href="../sourcefile/sqlitefortranroutines.f90.html" xlink:title="SQLiteFortranRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1316.2791,-1973.007 1179.4836,-1973.007 1179.4836,-1950.9962 1316.2791,-1950.9962 1316.2791,-1973.007"/>
<text text-anchor="middle" x="1247.8813" y="-1958.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SQLiteFortranRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge178" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M448.0675,-8870.5086C460.758,-8866.8637 473.0625,-8860.6099 480.9653,-8850.0016 530.0622,-8784.0972 500.623,-3013.5424 516.9653,-2933.0016 594.7009,-2549.8939 708.3765,-2451.3663 1013.4998,-2207.0016 1061.0771,-2168.8982 1087.435,-2176.7953 1127.6646,-2131.0016 1151.5398,-2103.8242 1143.5643,-2088.0785 1163.6646,-2058.0016 1183.2826,-2028.6463 1211.0825,-1998.6639 1229.2933,-1980.1942"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1231.8692,-1982.568 1236.459,-1973.0189 1226.9161,-1977.6215 1231.8692,-1982.568"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge238" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M448.049,-8863.9907C508.2211,-8847.6025 608.0345,-8810.4947 654.4731,-8737.0016 718.6706,-8635.4037 655.0748,-8583.8511 690.4731,-8469.0016 809.1285,-8084.0253 976.6295,-8048.4642 1127.6646,-7675.0016 1153.045,-7612.2437 1130.2043,-7585.85 1163.6646,-7527.0016 1254.045,-7368.0444 1593.8052,-7043.9246 1751.2896,-6951.0016 1802.0329,-6921.0607 1842.1398,-6959.5242 1878.2922,-6913.0016 1908.1114,-6874.629 1908.9537,-6087.3042 1914.2922,-6039.0016 1935.032,-5851.3504 1962.8582,-5807.8462 1989.9177,-5621.0016 2000.4908,-5547.9948 1990.5181,-5355.7214 2025.9177,-5291.0016 2068.0584,-5213.9573 2139.9486,-5245.2802 2179.7498,-5167.0016 2217.2105,-5093.3259 2207.0464,-4506.1945 2215.7498,-4424.0016 2236.7401,-4225.7729 2283.4432,-3988.7973 2297.865,-3917.9725"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2301.3168,-3918.5624 2299.8935,-3908.0636 2294.459,-3917.1584 2301.3168,-3918.5624"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge229" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M448.0197,-8870.4728C460.7091,-8866.8271 473.025,-8860.5818 480.9653,-8850.0016 572.178,-8728.4641 438.9005,-6245.3742 516.9653,-6115.0016 552.8378,-6055.0926 618.6012,-6098.911 654.4731,-6039.0016 732.6508,-5908.4377 634.8508,-3441.6521 690.4731,-3300.0016 721.7931,-3220.2407 770.1945,-3226.8781 819.7932,-3157.0016 839.1333,-3129.7545 835.9005,-3117.8479 855.7932,-3091.0016 878.7803,-3059.9793 896.9263,-3062.1966 916.6465,-3029.0016"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge404" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.9714,-8886.0421C410.4136,-9015.8629 509.6151,-10247.1989 516.9653,-10264.0016 562.7967,-10368.7728 610.6586,-10372.1044 690.4731,-10454.0016 705.913,-10469.8444 967.732,-10710.1528 977.4998,-10730.0016 1042.0581,-10861.1885 931.6344,-10935.8578 1013.4998,-11057.0016 1163.2458,-11278.5948 1290.8785,-11271.2496 1553.2698,-11323.0016 1694.9939,-11350.9542 1740.2418,-11365.536 1878.2922,-11323.0016 1937.5714,-11304.7373 2157.5465,-11113.9563 2179.7498,-11095.0016 2275.1972,-11013.5191 2319.546,-11009.7705 2388.6335,-10905.0016 2415.5607,-10864.1675 2398.0114,-10842.0352 2424.6335,-10801.0016 2567.5459,-10580.7258 2727.3943,-10626.0923 2855.7019,-10397.0016"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge376" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.9175,-8886.2712C408.86,-9006.7671 487.3173,-10054.0941 516.9653,-10112.0016 528.6457,-10134.8154 670.1183,-10248.4267 690.4731,-10264.0016 745.291,-10305.9466 773.1672,-10299.1057 819.7932,-10350.0016 842.3638,-10374.6392 832.62,-10391.9299 855.7932,-10416.0016 953.3434,-10517.3341 1050.7374,-10460.2455 1127.6646,-10578.0016 1198.4556,-10686.3649 1077.9848,-10769.9812 1163.6646,-10867.0016 1288.3768,-11008.2208 1815.8712,-11129.1391 1989.9177,-11057.0016 2100.1908,-11011.2964 2111.9965,-10965.2799 2179.7498,-10867.0016 2308.3438,-10680.4716 2302.6629,-10611.6177 2388.6335,-10402.0016 2562.8209,-9977.2932 2658.7062,-9884.1094 2748.8254,-9434.0016 2829.4218,-9031.4566 2740.4661,-8919.1321 2784.8254,-8511.0016 2800.4908,-8366.8716 2837.5186,-8196.0683 2850.8296,-8137.184"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2854.2884,-8137.7581 2853.0957,-8127.2306 2847.4631,-8136.2042 2854.2884,-8137.7581"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge364" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-9295.0016C886.1715,-9344.8501 930.3826,-9295.0016 1070.5822,-9295.0016 1070.5822,-9295.0016 1070.5822,-9295.0016 1634.2797,-9295.0016 1745.3536,-9295.0016 1807.623,-9326.6945 1878.2922,-9241.0016 1926.8396,-9182.1335 1901.479,-7943.2221 1914.2922,-7868.0016 1941.4968,-7708.2966 1931.5056,-7652.6532 2025.9177,-7521.0016 2075.5099,-7451.8485 2120.5539,-7468.1358 2179.7498,-7407.0016 2199.3032,-7386.8079 2199.2541,-7377.7616 2215.7498,-7355.0016 2240.1988,-7321.268 2269.719,-7282.7991 2287.1689,-7260.2822"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2290.0708,-7262.2518 2293.4399,-7252.2069 2284.5421,-7257.9584 2290.0708,-7262.2518"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge501" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1070.5822,-9143.0016C1171.9305,-9107.735 1445.9872,-9131.3825 1553.2698,-9129.0016 1557.7834,-9128.9014 1875.1028,-9127.1969 1878.2922,-9124.0016 1904.3649,-9097.8811 1912.4955,-6503.864 1914.2922,-6467.0016 1915.1934,-6448.5141 2014.4207,-5153.5075 2025.9177,-5139.0016 2029.717,-5134.208 2034.4505,-5130.3219 2039.6903,-5127.1732"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2041.5466,-5130.1575 2048.9108,-5122.5405 2038.4039,-5123.9027 2041.5466,-5130.1575"/>
</g>
<!-- sourcefile~datazonecontrols.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~datazonecontrols.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node14"><a xlink:href="../sourcefile/datazonecontrols.f90.html" xlink:title="DataZoneControls.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2160.0577,-9837.007 2045.6098,-9837.007 2045.6098,-9814.9962 2160.0577,-9814.9962 2160.0577,-9837.007"/>
<text text-anchor="middle" x="2102.8337" y="-9822.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataZoneControls.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge626" class="edge">
<title>sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2103.5591,-9837.0561C2107.2902,-9887.0945 2127.717,-10095.998 2215.7498,-10236.0016 2330.7164,-10418.8398 2879.5462,-10874.9488 3047.3719,-10739.0016"/>
</g>
<!-- sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge118" class="edge">
<title>sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M2103.9553,-9814.954C2114.9444,-9706.8074 2203.2473,-8839.9796 2215.7498,-8787.0016 2266.4883,-8572.0026 2347.4407,-8538.0319 2388.6335,-8321.0016 2463.652,-7925.7562 2361.7131,-6908.3525 2424.6335,-6511.0016 2436.2311,-6437.7612 2466.5338,-6354.7216 2481.3611,-6316.835"/>
<polygon fill="#ffe500" stroke="#ffe500" points="2484.6729,-6317.9782 2485.1044,-6307.3921 2478.1655,-6315.3985 2484.6729,-6317.9782"/>
</g>
<!-- sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge214" class="edge">
<title>sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M2103.8777,-9814.7257C2111.7922,-9728.637 2162.5024,-9166.343 2179.7498,-8708.0016 2225.7855,-7484.6191 2150.5304,-4421.5115 2215.7498,-3199.0016 2233.6871,-2862.7739 2286.473,-2455.3308 2299.3394,-2359.0833"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2302.8128,-2359.5151 2300.6753,-2349.1382 2295.8751,-2358.5831 2302.8128,-2359.5151"/>
</g>
<!-- sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge627" class="edge">
<title>sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3233.5946,-9637.0016C3247.2562,-9648.6431 3287.1577,-9648.8538 3324.2412,-9646.0516"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3324.9269,-9649.5067 3334.6017,-9645.1884 3324.3456,-9642.5309 3324.9269,-9649.5067"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2862.5557,-4745.0285C2888.6504,-4787.2664 2983.5371,-4943.2008 3047.3719,-5079.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3047.3719,-5079.0016C3182.0023,-5365.4113 3109.1313,-5470.3669 3132.1655,-5786.0016 3139.9541,-5892.7271 3152.1458,-9567.5963 3233.5946,-9637.0016"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge628" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2168.3466,-5747.1277C2183.8444,-5744.9972 2200.3445,-5743.0876 2215.7498,-5742.0016 2500.6317,-5721.9183 2580.9301,-5722.146 2855.7019,-5800.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2855.7019,-5800.0016C2940.7408,-5805.0179 3007.2814,-5724.8383 3047.3719,-5800.0016"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2114.8109,-5769.1861C2132.9199,-5786.9957 2166.5541,-5823.8113 2179.7498,-5863.0016 2216.5586,-5972.3217 2145.6382,-7847.4039 2215.7498,-7939.0016 2221.74,-7946.8277 2230.0274,-7952.3147 2239.1158,-7956.1404"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2238.2194,-7959.5353 2248.8143,-7959.5541 2240.5436,-7952.9324 2238.2194,-7959.5353"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff4c00" stroke-dasharray="5,2" d="M2168.137,-5753.8578C2207.3848,-5752.7925 2258.1051,-5753.9403 2302.1917,-5763.0016"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge263" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#0cff00" stroke-dasharray="5,2" d="M2302.1917,-5459.0016C2397.5809,-5360.836 2468.0085,-5388.7444 2554.9226,-5283.0016 2716.4082,-5086.5323 2598.4355,-4932.0235 2784.8254,-4759.0016 2788.8299,-4755.2844 2793.4207,-4752.1143 2798.2989,-4749.4119"/>
<polygon fill="#0cff00" stroke="#0cff00" points="2799.8543,-4752.5475 2807.3254,-4745.0353 2796.8003,-4746.2488 2799.8543,-4752.5475"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge464" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M2168.1621,-5751.9066C2183.7418,-5750.699 2200.3244,-5749.6154 2215.7498,-5749.0016 2292.5262,-5745.9467 2312.1052,-5742.1189 2388.6335,-5749.0016 2467.428,-5756.0881 2557.1568,-5774.1278 2613.6415,-5786.7297"/>
<polygon fill="#3200ff" stroke="#3200ff" points="2612.9221,-5790.1553 2623.4467,-5788.9373 2614.4597,-5783.3263 2612.9221,-5790.1553"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge508" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M2161.5283,-5746.9787C2168.4761,-5743.505 2174.8314,-5738.9555 2179.7498,-5733.0016 2220.8274,-5683.2761 2200.0311,-5507.555 2215.7498,-5445.0016 2328.7024,-4995.4982 2253.2962,-4789.5233 2590.9226,-4472.0016 2601.1883,-4462.3472 2615.1668,-4456.4208 2628.51,-4452.783"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="2629.588,-4456.1249 2638.5179,-4450.4234 2627.9815,-4449.3117 2629.588,-4456.1249"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge562" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M2114.7707,-5769.1997C2132.826,-5787.0275 2166.3895,-5823.8671 2179.7498,-5863.0016 2280.1546,-6157.1047 2112.9162,-6967.7389 2215.7498,-7261.0016 2229.3052,-7299.6592 2261.2734,-7335.8235 2282.3029,-7356.6618"/>
<polygon fill="#ff0098" stroke="#ff0098" points="2280.1418,-7359.4406 2289.7658,-7363.8711 2285.0053,-7354.406 2280.1418,-7359.4406"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge584" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M2114.6081,-5769.2568C2132.4457,-5787.161 2165.7226,-5824.1011 2179.7498,-5863.0016 2225.0593,-5988.6552 2192.0744,-6331.5434 2215.7498,-6463.0016 2233.9122,-6563.8489 2276.249,-6679.3484 2294.0631,-6725.4455"/>
<polygon fill="#ff004c" stroke="#ff004c" points="2290.8619,-6726.8701 2297.7566,-6734.9146 2297.3834,-6724.3263 2290.8619,-6726.8701"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge67" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2159.6506,-5746.8871C2167.1444,-5743.4363 2174.1531,-5738.9177 2179.7498,-5733.0016 2222.719,-5687.5794 2190.873,-5654.366 2215.7498,-5597.0016 2244.544,-5530.6039 2254.0434,-5513.0341 2302.1917,-5459.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2302.1917,-5459.0016C2320.523,-5438.4299 2571.1538,-4529.1961 2590.9226,-4510.0016 2643.1062,-4459.334 2703.5033,-4523.8895 2748.8254,-4467.0016 2779.5911,-4428.3849 2779.9168,-3628.1309 2784.8254,-3579.0016 2801.1519,-3415.5958 2838.6619,-3220.8589 2851.3876,-3157.2393"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2854.8595,-3157.7272 2853.4018,-3147.2331 2847.9971,-3156.3458 2854.8595,-3157.7272"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge405" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2163.2518,-5769.0403C2224.7108,-5782.588 2320.3701,-5810.277 2388.6335,-5861.0016 2488.1553,-5934.9534 2502.3086,-5972.7287 2554.9226,-6085.0016 2647.1902,-6281.891 2998.4597,-7890.913 3042.769,-8094.7889"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3039.4062,-8095.7971 3044.9491,-8104.8263 3046.2467,-8094.3113 3039.4062,-8095.7971"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge377" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2115.2371,-5769.1157C2156.3457,-5806.2217 2291.048,-5929.9913 2388.6335,-6045.0016 2470.4775,-6141.4596 2514.6642,-6156.0773 2554.9226,-6276.0016 2608.3676,-6435.2069 2533.9583,-7629.0214 2590.9226,-7787.0016 2610.1304,-7840.2711 2647.3251,-7835.0581 2669.874,-7887.0016"/>
</g>
<!-- sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~dataloopnode.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node17"><a xlink:href="../sourcefile/dataloopnode.f90.html" xlink:title="DataLoopNode.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1298.0343,-9839.007 1197.7284,-9839.007 1197.7284,-9816.9962 1298.0343,-9816.9962 1298.0343,-9839.007"/>
<text text-anchor="middle" x="1247.8813" y="-9824.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataLoopNode.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge629" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2669.874,-11537.0016C3057.8815,-11711.2761 3360.3074,-9876.4244 3394.8242,-9658.1086"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3398.2854,-9658.6284 3396.3807,-9648.2062 3391.3703,-9657.5414 3398.2854,-9658.6284"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1251.6328,-9839.1974C1264.573,-9878.1871 1307.8741,-10011.7984 1332.0981,-10125.0016 1355.2198,-10233.0533 1316.8434,-10273.1102 1368.0981,-10371.0016 1418.5818,-10467.4203 2281.4532,-11446.8594 2669.874,-11537.0016"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1298.0856,-9834.6507C1319.6013,-9837.1835 1345.0397,-9839.7585 1368.0981,-9841.0016 1481.6238,-9847.122 1794.2691,-9879.5891 1878.2922,-9803.0016 1938.5872,-9748.0424 1893.908,-9701.9983 1914.2922,-9623.0016 1942.0235,-9515.5324 1967.0156,-9493.6025 1989.9177,-9385.0016 2020.5435,-9239.7752 1976.2942,-9192.8806 2025.9177,-9053.0016 2046.973,-8993.6508 2089.5338,-8995.5561 2102.8337,-8934.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2102.8337,-8934.0016C2116.2692,-8873.239 2160.6174,-8876.2178 2179.7498,-8817.0016 2208.0613,-8729.3748 2158.8283,-8061.3891 2215.7498,-7989.0016 2221.8417,-7981.2544 2230.1806,-7975.8073 2239.289,-7971.9972"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2240.72,-7975.2044 2248.9976,-7968.5914 2238.4028,-7968.599 2240.72,-7975.2044"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff4c00" stroke-dasharray="5,2" d="M1442.684,-10055.0016C1467.9733,-10064.4942 1860.4287,-9859.2638 1878.2922,-9839.0016 1928.2366,-9782.3507 1968.3221,-9590.3715 1989.9177,-9518.0016 2049.0032,-9319.9981 2053.7744,-9267.7245 2102.8337,-9067.0016"/>
<path fill="none" stroke="#ff4c00" stroke-dasharray="5,2" d="M2102.8337,-9067.0016C2117.9323,-9005.8634 2160.2043,-9007.8666 2179.7498,-8948.0016 2223.0656,-8815.3309 2155.6194,-8446.9465 2215.7498,-8321.0016 2260.4686,-8227.3366 2345.7159,-8258.5055 2388.6335,-8164.0016 2432.0123,-8068.4822 2415.8988,-6380.5453 2424.6335,-6276.0016 2438.1294,-6114.4739 2473.5833,-5921.913 2485.6717,-5859.0028"/>
<polygon fill="#ff4c00" stroke="#ff4c00" points="2489.1227,-5859.591 2487.5866,-5849.1081 2482.2502,-5858.2609 2489.1227,-5859.591"/>
<path fill="none" stroke="#ff4c00" stroke-dasharray="5,2" d="M1259.4608,-9839.0298C1276.0863,-9855.0385 1307.433,-9885.8797 1332.0981,-9914.0016 1384.6129,-9973.8761 1369.9475,-10022.5644 1442.684,-10055.0016"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge80" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ff7200" stroke-dasharray="5,2" d="M1814.7909,-10435.0016C1860.5774,-10447.6387 1867.6199,-10465.1815 1914.2922,-10474.0016 1984.1266,-10487.1988 2173.9084,-10457.1237 2179.7498,-10454.0016 2307.7469,-10385.5902 2316.1297,-10328.7258 2388.6335,-10203.0016 2734.9373,-9602.4991 2802.0429,-9420.9257 2926.5784,-8739.0016 2965.9239,-8523.5557 2955.994,-5015.9117 2962.5784,-4797.0016 2982.8208,-4123.9991 3036.5397,-3298.9115 3045.9539,-3157.1917"/>
<polygon fill="#ff7200" stroke="#ff7200" points="3049.4471,-3157.4086 3046.6197,-3147.198 3042.4626,-3156.9432 3049.4471,-3157.4086"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge95" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M1248.6683,-9816.9126C1255.7942,-9716.0091 1309.4345,-8946.2119 1332.0981,-8321.0016 1336.4519,-8200.8972 1326.3446,-6270.6989 1368.0981,-6158.0016 1391.3815,-6095.1573 1718.0757,-5740.3218 1797.4881,-5654.6284"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="1800.1487,-5656.9067 1804.3827,-5647.1946 1795.0163,-5652.1465 1800.1487,-5656.9067"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge120" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M1814.7909,-10017.0016C1894.9389,-10036.8451 1917.4834,-9994.634 1989.9177,-9955.0016 2007.6998,-9945.2722 2008.8838,-9937.9885 2025.9177,-9927.0016 2090.851,-9885.1197 2138.6606,-9911.4394 2179.7498,-9846.0016 2240.1137,-9749.8672 2180.7206,-8932.9766 2215.7498,-8825.0016 2258.2302,-8694.0585 2347.3166,-8699.3165 2388.6335,-8568.0016 2457.2414,-8349.9498 2389.1513,-6736.8216 2424.6335,-6511.0016 2436.1437,-6437.7475 2466.4888,-6354.7145 2481.3437,-6316.8323"/>
<polygon fill="#ffe500" stroke="#ffe500" points="2484.6553,-6317.9763 2485.0943,-6307.3905 2478.1498,-6315.392 2484.6553,-6317.9763"/>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M1442.684,-10055.0016C1597.97,-10114.3508 1649.2681,-10001.5653 1814.7909,-10017.0016"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge138" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#f2ff00" stroke-dasharray="5,2" d="M1814.7909,-9751.0016C1830.6407,-9725.3289 1860.4828,-9751.3558 1878.2922,-9727.0016 1922.5606,-9666.4652 1898.8468,-9126.3895 1914.2922,-9053.0016 1924.0781,-9006.5046 1935.9035,-8997.6698 1952.105,-8953.0016"/>
<path fill="none" stroke="#f2ff00" stroke-dasharray="5,2" d="M1442.684,-9789.0016C1594.9357,-9722.2522 1727.4597,-9892.4559 1814.7909,-9751.0016"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge206" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1442.684,-9523.0016C1463.1715,-9494.8429 1492.4488,-9523.4264 1517.2698,-9499.0016 1552.733,-9464.1043 1522.256,-9431.9066 1553.2698,-9393.0016 1617.7055,-9312.1707 1662.9323,-9324.6541 1751.2896,-9271.0016 1807.5158,-9236.8598 1845.3966,-9251.9659 1878.2922,-9195.0016 1909.857,-9140.3419 1908.2819,-6985.8338 1914.2922,-6923.0016 1932.6862,-6730.7105 1970.1736,-6687.1588 1989.9177,-6495.0016 1996.7576,-6428.4333 1991.1994,-5348.2097 2025.9177,-5291.0016 2066.5555,-5224.0394 2139.5127,-5272.2054 2179.7498,-5205.0016 2208.3787,-5157.1858 2212.4634,-3254.6358 2215.7498,-3199.0016 2235.6049,-2862.8817 2286.9505,-2455.3576 2299.4286,-2359.0883"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2302.9033,-2359.5091 2300.7236,-2349.1409 2295.9619,-2358.6053 2302.9033,-2359.5091"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge265" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#0cff00" stroke-dasharray="5,2" d="M1442.684,-10207.0016C1464.3381,-10234.2734 1484.2964,-10219.8031 1517.2698,-10231.0016 1724.9601,-10301.5378 1782.9567,-10445.6498 1989.9177,-10373.0016 2091.9005,-10337.2033 2125.0388,-10314.215 2179.7498,-10221.0016 2228.7926,-10137.4452 2188.0737,-10098.8504 2215.7498,-10006.0016 2269.3349,-9826.2319 2507.5621,-9414.5105 2554.9226,-9233.0016 2596.6366,-9073.1332 2559.6803,-9025.2418 2590.9226,-8863.0016 2638.367,-8616.6247 2712.1258,-8569.2065 2748.8254,-8321.0016 2763.2988,-8223.1163 2727.2598,-4839.4827 2784.8254,-4759.0016 2787.0837,-4755.8444 2789.7743,-4753.0833 2792.7663,-4750.669"/>
<polygon fill="#0cff00" stroke="#0cff00" points="2794.8699,-4753.4746 2801.2999,-4745.054 2791.0222,-4747.6269 2794.8699,-4753.4746"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge292" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1298.3896,-9821.9546C1310.8165,-9818.2482 1323.1178,-9812.3512 1332.0981,-9803.0016 1377.1998,-9756.0458 1344.4391,-9721.6585 1368.0981,-9661.0016 1393.4326,-9596.0492 1403.5312,-9580.6879 1442.684,-9523.0016"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1442.684,-9523.0016C1462.2401,-9494.1883 1494.8469,-9525.6449 1517.2698,-9499.0016 1591.2531,-9411.0934 1495.3213,-9342.2153 1553.2698,-9243.0016 1576.1365,-9203.8514 1600.1727,-9210.8737 1634.2797,-9181.0016"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge308" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ffb2" stroke-dasharray="5,2" d="M1249.2293,-9816.6809C1265.2236,-9682.3574 1418.5544,-8394.6476 1440.1588,-8213.2084"/>
<polygon fill="#00ffb2" stroke="#00ffb2" points="1443.6574,-8213.4272 1441.3644,-8203.0835 1436.7065,-8212.5995 1443.6574,-8213.4272"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge344" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M1248.6932,-9816.9135C1256.0415,-9716.0177 1311.2697,-8946.2757 1332.0981,-8321.0016 1381.5514,-6836.4055 1317.8986,-6463.5726 1368.0981,-4979.0016 1385.8419,-4454.2586 1432.0267,-3812.6032 1441.1174,-3689.1056"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1444.6122,-3689.3044 1441.8584,-3679.0737 1437.6312,-3688.7887 1444.6122,-3689.3044"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge429" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M1251.072,-9839.0435C1262.3355,-9878.0671 1301.2173,-10013.1523 1332.0981,-10125.0016 1348.5101,-10184.445 1339.8662,-10204.1762 1368.0981,-10259.0016 1427.3894,-10374.1432 1451.6636,-10403.6945 1553.2698,-10484.0016 1688.4125,-10590.8153 1747.5921,-10581.5989 1914.2922,-10625.0016 1963.7903,-10637.8891 1975.1551,-10646.7321 2025.9177,-10653.0016 2093.772,-10661.382 2111.3851,-10653.8424 2179.7498,-10653.0016 2432.7297,-10649.8903 2532.8765,-10770.8143 2748.8254,-10639.0016 2777.3455,-10621.5933 2756.0934,-10590.0579 2784.8254,-10573.0016 2839.0002,-10540.8417 2864.1363,-10564.6257 2926.5784,-10573.0016 2981.7377,-10580.4006 3011.0425,-10648.1617 3047.3719,-10606.0016"/>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M3047.3719,-10606.0016C3095.0896,-10542.6597 3111.6967,-10525.6189 3132.1655,-10449.0016 3157.9677,-10352.4209 3226.9957,-7004.6082 3233.1539,-6703.599"/>
<polygon fill="#0019ff" stroke="#0019ff" points="3236.6617,-6703.2507 3233.3668,-6693.1812 3229.6632,-6703.1076 3236.6617,-6703.2507"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge466" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M1442.684,-10055.0016C1556.7457,-10105.868 1876.8303,-10235.9989 1989.9177,-10183.0016 2019.7671,-10169.013 2167.5454,-9985.6239 2179.7498,-9955.0016 2225.9172,-9839.1613 2190.7424,-9517.1697 2215.7498,-9395.0016 2306.4957,-8951.6809 2474.8538,-8880.3745 2554.9226,-8435.0016 2598.7708,-8191.1017 2565.1143,-6451.4641 2590.9226,-6205.0016 2606.5146,-6056.102 2649.2674,-5880.3984 2664.4426,-5820.892"/>
<polygon fill="#3200ff" stroke="#3200ff" points="2667.8429,-5821.7223 2666.9425,-5811.1658 2661.0633,-5819.9797 2667.8429,-5821.7223"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge510" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1814.7909,-10017.0016C1892.863,-10025.7582 1920.0285,-10028.8824 1989.9177,-9993.0016 2010.614,-9982.3762 2006.3945,-9967.6538 2025.9177,-9955.0016 2086.7252,-9915.595 2136.7749,-9959.3419 2179.7498,-9901.0016 2244.6371,-9812.9141 2176.4528,-9019.1071 2215.7498,-8917.0016 2258.6813,-8805.4522 2340.6562,-8820.4756 2388.6335,-8711.0016 2438.9964,-8596.0843 2394.7209,-8552.8526 2424.6335,-8431.0016 2464.5033,-8268.5896 2524.6809,-8242.4787 2554.9226,-8078.0016 2572.8462,-7980.5195 2547.481,-4599.0905 2590.9226,-4510.0016 2600.8055,-4489.7341 2620.6792,-4473.9324 2638.0138,-4463.2236"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="2639.9192,-4466.1638 2646.7809,-4458.0911 2636.3827,-4460.1228 2639.9192,-4466.1638"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge531" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#a500ff" stroke-dasharray="5,2" d="M1296.2961,-9816.9774C1308.3373,-9813.3388 1320.9753,-9808.7191 1332.0981,-9803.0016 1350.1257,-9793.735 1351.2778,-9786.3127 1368.0981,-9775.0016 1431.6022,-9732.2972 1472.6424,-9751.1693 1517.2698,-9689.0016 1564.8462,-9622.7258 1496.6105,-9567.7019 1553.2698,-9509.0016 1574.0095,-9487.5148 1794.9241,-9469.298 1814.7909,-9447.0016"/>
<path fill="none" stroke="#a500ff" stroke-dasharray="5,2" d="M1814.7909,-9447.0016C1834.4443,-9424.1095 1860.8367,-9447.6107 1878.2922,-9423.0016 1925.6189,-9356.2798 1891.4885,-8029.5611 1914.2922,-7951.0016 1918.8829,-7935.1868 1928.4591,-7919.3016 1936.8253,-7907.4386"/>
<polygon fill="#a500ff" stroke="#a500ff" points="1939.7683,-7909.3448 1942.8846,-7899.2187 1934.1337,-7905.1913 1939.7683,-7909.3448"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge543" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1248.5325,-9816.9066C1254.4506,-9715.9497 1299.4648,-8945.7708 1332.0981,-8321.0016 1349.2969,-7991.7287 1323.0516,-7906.6318 1368.0981,-7580.0016 1431.3047,-7121.6946 1593.5997,-6576.9485 1627.8665,-6464.7937"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="1631.2695,-6465.6345 1630.8555,-6455.0477 1624.5772,-6463.582 1631.2695,-6465.6345"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge558" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M1442.684,-9789.0016C1603.2785,-9714.9634 1846.1492,-9556.5509 1878.2922,-9499.0016 1918.9746,-9426.1635 1906.8926,-8832.1021 1914.2922,-8749.0016 1937.349,-8490.0663 1959.3839,-8427.162 1989.9177,-8169.0016 1998.8158,-8093.7691 1988.3139,-7895.7668 2025.9177,-7830.0016 2047.0378,-7793.0648 2085.127,-7811.6908 2102.8337,-7773.0016"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge586" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M1814.7909,-9447.0016C1834.4443,-9424.1095 1860.8138,-9447.5945 1878.2922,-9423.0016 1922.3348,-9361.0318 1895.4293,-8128.6507 1914.2922,-8055.0016 1932.5214,-7983.8267 1968.0513,-7978.1445 1989.9177,-7908.0016 2026.8656,-7789.4807 1983.721,-7747.7568 2025.9177,-7631.0016 2069.3637,-7510.7898 2140.5953,-7509.6789 2179.7498,-7388.0016 2200.7854,-7322.6306 2172.9025,-6824.667 2215.7498,-6771.0016 2218.3084,-6767.7969 2221.2513,-6764.9866 2224.4726,-6762.5234"/>
<polygon fill="#ff004c" stroke="#ff004c" points="2226.4442,-6765.4172 2232.9932,-6757.0889 2222.6799,-6759.5155 2226.4442,-6765.4172"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge63" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1442.684,-10207.0016C1481.8027,-10253.5519 1932.0454,-10222.6564 1989.9177,-10204.0016 2088.454,-10172.239 2128.6635,-10159.0486 2179.7498,-10069.0016 2229.4709,-9981.3609 2190.698,-9714.6003 2215.7498,-9617.0016 2262.2832,-9435.7126 2319.5333,-9406.9448 2388.6335,-9233.0016 2406.6919,-9187.5441 2403.1241,-9172.9315 2424.6335,-9129.0016 2471.2849,-9033.723 2523.1591,-9030.2214 2554.9226,-8929.0016 2593.8644,-8804.9068 2582.2236,-7888.7719 2590.9226,-7759.0016 2636.5269,-7078.685 2709.0721,-6913.6852 2748.8254,-6233.0016 2783.2143,-5644.1729 2734.1004,-4166.6484 2784.8254,-3579.0016 2798.9482,-3415.3906 2837.8844,-3220.7865 2851.1818,-3157.2202"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2854.6513,-3157.7295 2853.2888,-3147.2226 2847.8018,-3156.2859 2854.6513,-3157.7295"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1252.7278,-9839.1325C1266.4259,-9870.8583 1306.1165,-9964.6375 1332.0981,-10045.0016 1351.597,-10105.3139 1324.5529,-10136.9409 1368.0981,-10183.0016 1392.0211,-10208.3066 1420.543,-10180.1236 1442.684,-10207.0016"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge106" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1248.5019,-9816.7638C1256.7953,-9666.813 1345.7816,-8065.0863 1368.0981,-7969.0016 1407.3736,-7799.9 1467.6218,-7774.3536 1517.2698,-7608.0016 1541.7245,-7526.0628 1525.3757,-7499.8343 1553.2698,-7419.0016 1604.4967,-7270.5536 1671.5943,-7255.8384 1715.2896,-7105.0016 1740.7384,-7017.1518 1696.5474,-6768.2719 1751.2896,-6695.0016 1753.7328,-6691.7315 1756.6685,-6688.8887 1759.92,-6686.4176"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1761.9366,-6689.2843 1768.5518,-6681.0085 1758.2196,-6683.3527 1761.9366,-6689.2843"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge239" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1442.684,-9523.0016C1462.2401,-9494.1883 1486.6218,-9515.535 1517.2698,-9499.0016 1535.3521,-9489.2469 1536.4739,-9481.8347 1553.2698,-9470.0016 1691.7363,-9372.4489 1793.8705,-9417.8433 1878.2922,-9271.0016 1923.3269,-9192.6691 1908.3927,-7735.1643 1914.2922,-7645.0016 1934.5507,-7335.3933 1969.6614,-7260.61 1989.9177,-6951.0016 1992.869,-6905.8925 1997.6558,-5359.2833 2025.9177,-5324.0016 2047.9321,-5296.5192 2098.9706,-5340.0015 2102.8337,-5305.0016"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge407" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1442.684,-10207.0016C1464.8249,-10233.8796 1494.1422,-10204.9676 1517.2698,-10231.0016 1572.6117,-10293.2983 1503.2305,-10348.3707 1553.2698,-10415.0016 1607.4649,-10487.1663 1826.5846,-10579.7362 1914.2922,-10601.0016 2119.8309,-10650.8362 2234.0632,-10707.354 2388.6335,-10563.0016 2436.2175,-10518.5632 2393.5525,-10478.2116 2424.6335,-10421.0016 2581.3672,-10132.5061 2796.3906,-10180.4087 2926.5784,-9879.0016 2962.9201,-9794.8642 3036.6819,-8331.3322 3046.3242,-8137.2055"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3049.8238,-8137.2974 3046.8233,-8127.1364 3042.8324,-8136.9508 3049.8238,-8137.2974"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge379" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1814.7909,-10435.0016C1975.8664,-10456.8783 2048.8738,-10507.4142 2179.7498,-10411.0016 2321.7647,-10306.3833 2709.2533,-9100.8948 2748.8254,-8929.0016 2790.6581,-8747.2892 2760.3336,-8695.8516 2784.8254,-8511.0016 2803.8681,-8367.2788 2838.7828,-8196.2208 2851.1845,-8137.2268"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2854.6487,-8137.7618 2853.2915,-8127.2543 2847.7999,-8136.3147 2854.6487,-8137.7618"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1442.684,-10207.0016C1463.9922,-10234.5445 1493.4341,-10205.6143 1517.2698,-10231.0016 1561.8345,-10278.4674 1506.876,-10327.322 1553.2698,-10373.0016 1638.3886,-10456.8102 1697.1873,-10414.0617 1814.7909,-10435.0016"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge352" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1298.1896,-9823.1459C1338.4233,-9818.0421 1395.6775,-9808.0033 1442.684,-9789.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1442.684,-9789.0016C1478.1588,-9774.6614 1493.341,-9775.8599 1517.2698,-9746.0016 1550.7625,-9704.2095 1521.1524,-9673.8597 1553.2698,-9631.0016 1616.6988,-9546.3607 1655.5642,-9543.9904 1751.2896,-9499.0016 1804.6123,-9473.9411 1842.4502,-9507.7637 1878.2922,-9461.0016 1921.9742,-9404.0109 1892.6069,-8237.4545 1914.2922,-8169.0016 1932.6544,-8111.039 1968.8763,-8112.0462 1989.9177,-8055.0016 2035.7803,-7930.6654 1961.6047,-7874.8752 2025.9177,-7759.0016 2068.534,-7682.2193 2136.871,-7711.6376 2179.7498,-7635.0016 2241.0135,-7525.5065 2168.2431,-7471.1289 2215.7498,-7355.0016 2231.344,-7316.8825 2263.0028,-7280.3167 2283.373,-7259.2845"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2286.0229,-7261.5827 2290.5704,-7252.0134 2281.0479,-7256.6582 2286.0229,-7261.5827"/>
</g>
<!-- sourcefile~branchinputmanager.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge630" class="edge">
<title>sourcefile~branchinputmanager.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2669.874,-10919.0016C2755.5709,-10922.3636 2772.4681,-10887.6752 2855.7019,-10867.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1817.5077,-9115.2821C1827.459,-9157.0813 1862.1755,-9307.2144 1878.2922,-9433.0016 1909.9884,-9680.382 1870.8801,-9747.4063 1914.2922,-9993.0016 1974.8208,-10335.4296 1951.4257,-10489.0516 2215.7498,-10715.0016 2337.7516,-10819.2915 2412.5028,-10764.992 2554.9226,-10839.0016 2610.1544,-10867.7033 2607.6777,-10916.5616 2669.874,-10919.0016"/>
</g>
<!-- sourcefile~branchinputmanager.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge532" class="edge">
<title>sourcefile~branchinputmanager.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#a500ff" stroke-dasharray="5,2" d="M1815.6097,-9092.8267C1824.0721,-8977.577 1895.6558,-8008.5215 1914.2922,-7951.0016 1919.368,-7935.3357 1928.94,-7919.4493 1937.183,-7907.5484"/>
<polygon fill="#a500ff" stroke="#a500ff" points="1940.1241,-7909.4535 1943.1308,-7899.2943 1934.445,-7905.3612 1940.1241,-7909.4535"/>
</g>
<!-- sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~dataairsystems.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node19"><a xlink:href="../sourcefile/dataairsystems.f90.html" xlink:title="DataAirSystems.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2155.1164,-2045.007 2050.551,-2045.007 2050.551,-2022.9962 2155.1164,-2022.9962 2155.1164,-2045.007"/>
<text text-anchor="middle" x="2102.8337" y="-2030.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataAirSystems.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge631" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2109.6459,-2022.6559C2149.4909,-1956.3702 2353.0613,-1618.7723 2424.6335,-1521.0016 2618.5684,-1256.0783 2712.0871,-1227.5747 2926.5784,-979.0016 2943.7682,-959.0804 2940.8098,-946.7825 2962.5784,-932.0016 2994.9812,-910 3010.6327,-894.428 3047.3719,-908.0016"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2103.236,-2045.0651C2108.1806,-2181.5045 2157.4323,-3553.0639 2179.7498,-4662.0016 2180.6656,-4707.509 2188.1992,-7902.77 2215.7498,-7939.0016 2221.7151,-7946.8466 2229.9898,-7952.3434 2239.0734,-7956.1728"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2238.1745,-7959.5669 2248.7694,-7959.5884 2240.5004,-7952.9646 2238.1745,-7959.5669"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge121" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M2155.4771,-2042.6281C2164.6718,-2046.3161 2173.3311,-2051.5581 2179.7498,-2059.0016 2242.7345,-2132.043 2151.1936,-2201.3453 2215.7498,-2273.0016 2242.4376,-2302.6247 2289.4361,-2259.2251 2302.1917,-2297.0016"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge207" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M2155.2299,-2042.3456C2164.5598,-2046.051 2173.3334,-2051.3717 2179.7498,-2059.0016 2252.5669,-2145.5907 2142.4354,-2224.8331 2215.7498,-2311.0016 2223.5501,-2320.1696 2234.4165,-2326.2689 2245.8172,-2330.3148"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2244.878,-2333.6874 2255.464,-2333.2528 2246.9175,-2326.9911 2244.878,-2333.6874"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge266" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#0cff00" stroke-dasharray="5,2" d="M2302.1917,-2145.0016C2336.927,-2164.5776 2350.7746,-2156.493 2388.6335,-2169.0016 2463.8266,-2193.8455 2483.1972,-2199.4354 2554.9226,-2233.0016 2607.8842,-2257.7867 2652.3287,-2241.2218 2669.874,-2297.0016"/>
<path fill="none" stroke="#0cff00" stroke-dasharray="5,2" d="M2154.7357,-2045.094C2163.6757,-2048.5602 2172.4317,-2053.0899 2179.7498,-2059.0016 2204.5364,-2079.0249 2190.5341,-2101.5213 2215.7498,-2121.0016 2247.3025,-2145.3776 2268.6669,-2123.4179 2302.1917,-2145.0016"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge467" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M2155.3611,-2043.2467C2164.4535,-2046.8857 2173.1044,-2051.9516 2179.7498,-2059.0016 2223.2271,-2105.1264 2175.7853,-2147.8018 2215.7498,-2197.0016 2269.8581,-2263.6138 2341.5222,-2211.27 2388.6335,-2283.0016 2430.0469,-2346.0575 2414.19,-2886.2885 2424.6335,-2961.0016 2460.6085,-3218.3666 2523.2448,-3273.0725 2554.9226,-3531.0016 2604.4507,-3934.2726 2550.9985,-4954.6669 2590.9226,-5359.0016 2607.0368,-5522.1995 2650.1615,-5715.7144 2664.8747,-5778.9092"/>
<polygon fill="#3200ff" stroke="#3200ff" points="2661.5147,-5779.9113 2667.2056,-5788.848 2668.3297,-5778.3129 2661.5147,-5779.9113"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge511" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M2302.1917,-2145.0016C2337.4017,-2163.7104 2357.5294,-2144.0556 2388.6335,-2169.0016 2390.5488,-2170.5377 2554.2582,-2478.638 2554.9226,-2481.0016 2582.6482,-2579.6289 2659.2436,-4217.419 2668.8746,-4425.3518"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="2665.3899,-4425.7642 2669.3483,-4435.5918 2672.3824,-4425.4407 2665.3899,-4425.7642"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge587" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M2103.9129,-2045.1215C2111.8778,-2127.7633 2161.7407,-2654.981 2179.7498,-3085.0016 2195.4557,-3460.0275 2158.3394,-6092.0634 2215.7498,-6463.0016 2231.4225,-6564.2657 2275.1493,-6679.5325 2293.6988,-6725.5064"/>
<polygon fill="#ff004c" stroke="#ff004c" points="2290.5327,-6727.0115 2297.5501,-6734.9491 2297.0143,-6724.3678 2290.5327,-6727.0115"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge408" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2155.1442,-2040.8659C2215.3181,-2046.207 2315.2453,-2047.0508 2388.6335,-2007.0016 2477.4392,-1958.5389 2571.1941,-1626.7003 2669.874,-1649.0016"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge632" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2855.7019,-10867.0016C2955.1171,-10842.3089 2967.6628,-10803.3411 3047.3719,-10739.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1453.4239,-8203.0249C1493.5123,-8244.7234 1636.1442,-8398.106 1715.2896,-8549.0016 1824.2486,-8756.7391 1825.6584,-8822.4045 1878.2922,-9051.0016 1904.27,-9163.8271 1897.8799,-9194.3932 1914.2922,-9309.0016 1962.6884,-9646.9556 1900.5982,-9751.4325 2025.9177,-10069.0016 2119.8263,-10306.9729 2607.4156,-10928.6708 2855.7019,-10867.0016"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1634.2797,-8193.0016C1794.3662,-8203.7249 1843.5987,-8196.8305 1989.9177,-8131.0016 2048.4431,-8104.671 2047.9817,-8074.3149 2102.8337,-8041.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1492.1375,-8188.8705C1530.9636,-8187.2278 1586.2948,-8186.6876 1634.2797,-8193.0016"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff4c00" stroke-dasharray="5,2" d="M1814.7909,-8229.0016C1836.8919,-8249.5407 1859.1845,-8229.6521 1878.2922,-8253.0016 1941.0395,-8329.6781 1838.7881,-8408.8485 1914.2922,-8473.0016 1939.9063,-8494.7649 1962.997,-8493.1261 1989.9177,-8473.0016 2035.1979,-8439.1526 1988.608,-8393.4756 2025.9177,-8351.0016 2075.2505,-8294.8404 2126.2055,-8335.1632 2179.7498,-8283.0016 2206.5217,-8256.921 2191.2426,-8235.2211 2215.7498,-8207.0016 2276.0992,-8137.5105 2344.1993,-8173.6036 2388.6335,-8093.0016 2437.3769,-8004.5829 2416.1897,-6376.6122 2424.6335,-6276.0016 2438.1895,-6114.479 2473.6045,-5921.9148 2485.6773,-5859.0033"/>
<polygon fill="#ff4c00" stroke="#ff4c00" points="2489.1284,-5859.5908 2487.5896,-5849.1083 2482.2556,-5858.2625 2489.1284,-5859.5908"/>
<path fill="none" stroke="#ff4c00" stroke-dasharray="5,2" d="M1634.2797,-8193.0016C1674.8337,-8198.3379 1783.9251,-8202.1613 1814.7909,-8229.0016"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge123" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M1814.7909,-8229.0016C1836.8919,-8249.5407 1860.1578,-8228.8884 1878.2922,-8253.0016 1947.1211,-8344.5226 1838.379,-8749.5892 1952.105,-8763.0016"/>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M1952.105,-8763.0016C2035.5098,-8772.8381 2006.907,-8639.3399 2025.9177,-8597.0016 2087.5037,-8459.8453 2107.9002,-8421.7545 2215.7498,-8317.0016 2281.0783,-8253.5488 2343.9615,-8286.3646 2388.6335,-8207.0016 2434.8613,-8124.8748 2409.8316,-6604.0754 2424.6335,-6511.0016 2436.2801,-6437.769 2466.559,-6354.7256 2481.3708,-6316.8366"/>
<polygon fill="#ffe500" stroke="#ffe500" points="2484.6827,-6317.9792 2485.11,-6307.393 2478.1743,-6315.4022 2484.6827,-6317.9792"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge267" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#0cff00" stroke-dasharray="5,2" d="M2669.874,-7773.0016C2675.0249,-7728.684 2729.0726,-7751.0067 2748.8254,-7711.0016 2785.132,-7637.4704 2737.0473,-4825.6518 2784.8254,-4759.0016 2787.087,-4755.8467 2789.7802,-4753.0875 2792.774,-4750.6745"/>
<polygon fill="#0cff00" stroke="#0cff00" points="2794.8778,-4753.4801 2801.3113,-4745.0622 2791.0325,-4747.6308 2794.8778,-4753.4801"/>
<path fill="none" stroke="#0cff00" stroke-dasharray="5,2" d="M1952.105,-8801.0016C2026.0915,-8876.9469 2455.943,-8664.8059 2554.9226,-8511.0016 2631.7699,-8391.5887 2540.5876,-8005.7846 2590.9226,-7873.0016 2610.9947,-7820.0517 2663.3365,-7829.2497 2669.874,-7773.0016"/>
<path fill="none" stroke="#0cff00" stroke-dasharray="5,2" d="M1634.2797,-8193.0016C1671.51,-8197.9005 1682.6266,-8198.4752 1715.2896,-8217.0016 1736.6985,-8229.1448 1867.4261,-8344.9171 1878.2922,-8367.0016 1959.0493,-8531.1334 1819.2404,-8620.7131 1914.2922,-8777.0016 1924.6354,-8794.0083 1938.8582,-8786.1446 1952.105,-8801.0016"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge295" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1445.3483,-8203.0538C1456.2017,-8247.4236 1499.0914,-8416.586 1553.2698,-8549.0016 1612.7375,-8694.3447 1649.2612,-8720.5191 1715.2896,-8863.0016 1752.4864,-8943.2686 1790.8806,-9041.4396 1806.9648,-9083.3964"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1803.7214,-9084.714 1810.5591,-9092.8071 1810.2607,-9082.2165 1803.7214,-9084.714"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge514" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1952.105,-8763.0016C2004.757,-8772.3123 1995.1805,-8711.7526 2025.9177,-8668.0016 2059.7036,-8619.9112 2356.2733,-8332.0627 2388.6335,-8283.0016 2490.587,-8128.4309 2516.2152,-8082.0772 2554.9226,-7901.0016 2574.6142,-7808.883 2549.6135,-4594.6606 2590.9226,-4510.0016 2600.8108,-4489.7367 2620.6845,-4473.935 2638.0178,-4463.2255"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="2639.923,-4466.1658 2646.784,-4458.0926 2636.386,-4460.1251 2639.923,-4466.1658"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge590" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M1447.1277,-8180.862C1472.4048,-8118.0342 1602.2139,-7802.4798 1751.2896,-7569.0016 1856.1981,-7404.6967 1864.8437,-7336.8062 2025.9177,-7227.0016 2055.5068,-7206.8306 2088.1016,-7235.6413 2102.8337,-7203.0016"/>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M2102.8337,-7203.0016C2129.1694,-7149.88 2158.7102,-7149.4345 2179.7498,-7094.0016 2205.3778,-7026.4794 2169.2157,-6826.2341 2215.7498,-6771.0016 2218.5241,-6767.7086 2221.7031,-6764.835 2225.1674,-6762.3284"/>
<polygon fill="#ff004c" stroke="#ff004c" points="2226.9941,-6765.314 2233.7126,-6757.1217 2223.3517,-6759.3363 2226.9941,-6765.314"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge156" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1448.5281,-8180.9889C1463.5802,-8151.9321 1503.4622,-8070.3808 1517.2698,-7997.0016 1572.7683,-7702.0599 1505.9673,-2891.3682 1553.2698,-2595.0016 1567.5065,-2505.8032 1607.3744,-2405.007 1625.3227,-2362.566"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1628.5726,-2363.8679 1629.2887,-2353.2973 1622.137,-2361.1141 1628.5726,-2363.8679"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge242" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1448.2033,-8180.9213C1462.4718,-8151.7012 1500.6246,-8069.7896 1517.2698,-7997.0016 1538.4486,-7904.3883 1511.8778,-7656.5146 1553.2698,-7571.0016 1596.2882,-7482.1285 1661.4913,-7501.7952 1715.2896,-7419.0016 1835.2985,-7234.3121 1828.4064,-7165.5331 1878.2922,-6951.0016 1970.7816,-6553.2553 1954.8223,-6445.8489 1989.9177,-6039.0016 1996.754,-5959.7508 1975.3172,-5385.3775 2025.9177,-5324.0016 2048.3172,-5296.8322 2099.0804,-5340.0134 2102.8337,-5305.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2102.8337,-5305.0016C2106.7625,-5269.4074 2157.9309,-5309.3975 2179.7498,-5281.0016 2208.7842,-5243.2151 2210.8843,-4471.4057 2215.7498,-4424.0016 2236.1025,-4225.7065 2283.2389,-3988.776 2297.8159,-3917.9674"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2301.2668,-3918.5627 2299.8668,-3908.0608 2294.4122,-3917.1436 2301.2668,-3918.5627"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge411" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1472.9904,-8203.123C1557.097,-8235.8853 1792.8285,-8341.0596 1878.2922,-8519.0016 1979.3576,-8729.4274 1818.736,-8830.0175 1914.2922,-9043.0016 1980.9236,-9191.5153 2264.391,-9398.0209 2424.6335,-9461.0016 2526.56,-9501.0621 2561.568,-9468.7643 2669.874,-9485.0016"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge381" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1952.105,-8801.0016C2064.2329,-8887.4856 2352.9543,-9179.4904 2489.7781,-9143.0016"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge497" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1448.232,-8180.9278C1462.5696,-8151.7234 1500.8749,-8069.8464 1517.2698,-7997.0016 1562.6867,-7795.2074 1488.2117,-7729.3458 1553.2698,-7533.0016 1595.7395,-7404.8287 1672.8516,-7404.1851 1715.2896,-7276.0016 1748.0032,-7177.1904 1699.0076,-6899.004 1751.2896,-6809.0016 1785.5308,-6750.056 1845.241,-6782.6226 1878.2922,-6723.0016 1931.014,-6627.8972 1902.4116,-5853.0909 1914.2922,-5745.0016 1929.2531,-5608.8891 1935.6939,-5242.0069 2025.9177,-5139.0016 2029.8887,-5134.4681 2034.6903,-5130.752 2039.9323,-5127.7067"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2041.6779,-5130.7485 2049.1013,-5123.189 2038.5841,-5124.4693 2041.6779,-5130.7485"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node21" class="node">
<title>sourcefile~dataheatbalfansys.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node21"><a xlink:href="../sourcefile/dataheatbalfansys.f90.html" xlink:title="DataHeatBalFanSys.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2164.9785,-787.007 2040.6889,-787.007 2040.6889,-764.9962 2164.9785,-764.9962 2164.9785,-787.007"/>
<text text-anchor="middle" x="2102.8337" y="-772.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalFanSys.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge633" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2133.4337,-764.8547C2279.8707,-712.4 2907.7541,-497.8378 3047.3719,-623.0016"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge244" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2103.8193,-787.2044C2111.2033,-871.5844 2158.1722,-1416.2137 2179.7498,-1860.0016 2209.2652,-2467.0507 2168.8047,-2621.0512 2215.7498,-3227.0016 2235.6703,-3484.1289 2285.1463,-3793.8634 2298.7067,-3876.1209"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2295.2551,-3876.7015 2300.3426,-3885.9949 2302.1609,-3875.5572 2295.2551,-3876.7015"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge383" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2118.9795,-787.1369C2135.3702,-798.898 2160.9439,-818.5409 2179.7498,-839.0016 2290.6837,-959.6972 2308.8585,-999.7895 2388.6335,-1143.0016 2477.9494,-1303.3413 2500.062,-1345.8547 2554.9226,-1521.0016 2588.5574,-1628.3834 2737.4316,-2403.0537 2748.8254,-2515.0016 2788.5195,-2905.0072 2776.1271,-5651.0777 2784.8254,-6043.0016 2803.6501,-6891.1873 2847.8547,-7933.925 2854.7817,-8094.758"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2851.287,-8094.9595 2855.2151,-8104.7992 2858.2805,-8094.6575 2851.287,-8094.9595"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge634" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3047.3719,-5800.0016C3072.4816,-5847.0781 3193.156,-9602.1963 3233.5946,-9637.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2669.874,-5345.0016C2699.0634,-5365.446 2718.9307,-5339.6032 2748.8254,-5359.0016 2947.3768,-5487.8398 2935.9812,-5591.1619 3047.3719,-5800.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M972.0304,-5303.7323C1037.8062,-5303.4361 1150.8394,-5303.0016 1247.8813,-5303.0016 1247.8813,-5303.0016 1247.8813,-5303.0016 1634.2797,-5303.0016 1743.253,-5303.0016 1770.9233,-5308.3711 1878.2922,-5327.0016 1944.9371,-5338.5657 1958.7863,-5355.717 2025.9177,-5364.0016 2093.7728,-5372.3755 2115.843,-5388.2989 2179.7498,-5364.0016 2199.7596,-5356.3939 2196.5044,-5341.3765 2215.7498,-5332.0016 2300.581,-5290.678 2330.6543,-5302.4804 2424.6335,-5294.0016 2482.3056,-5288.7985 2498.2739,-5281.9992 2554.9226,-5294.0016 2609.6008,-5305.5865 2621.6249,-5316.7892 2669.874,-5345.0016"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1247.8813,-6749.0016C1271.3589,-6778.8093 1300.8838,-6741.4293 1332.0981,-6763.0016 1358.3112,-6781.1175 1351.0759,-6798.0655 1368.0981,-6825.0016 1582.2898,-7163.9401 1687.2248,-7216.5097 1878.2922,-7569.0016 1949.2976,-7699.9962 1908.7666,-7777.9313 2025.9177,-7870.0016 2053.6033,-7891.76 2072.1842,-7871.666 2102.8337,-7889.0016"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff4c00" stroke-dasharray="5,2" d="M1070.5822,-5455.0016C1224.4711,-5517.8784 1276.4452,-5493.0016 1442.684,-5493.0016 1442.684,-5493.0016 1442.684,-5493.0016 1634.2797,-5493.0016 1988.3281,-5493.0016 2082.159,-5571.7345 2388.6335,-5749.0016 2421.9107,-5768.2494 2454.149,-5799.4666 2472.9661,-5819.3507"/>
<polygon fill="#ff4c00" stroke="#ff4c00" points="2470.576,-5821.9202 2479.9472,-5826.863 2475.7037,-5817.1551 2470.576,-5821.9202"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge124" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M920.8563,-5315.3633C932.0156,-5344.2052 964.8675,-5421.3402 1013.4998,-5469.0016 1135.7464,-5588.8079 2258.947,-6175.8908 2459.2799,-6280.1533"/>
<polygon fill="#ffe500" stroke="#ffe500" points="2457.8849,-6283.3729 2468.3715,-6284.8833 2461.1156,-6277.163 2457.8849,-6283.3729"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge269" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#0cff00" stroke-dasharray="5,2" d="M1070.5822,-5037.0016C1099.2591,-4994.6156 1108.5167,-4984.4601 1127.6646,-4937.0016 1152.0252,-4876.623 1129.2135,-4850.2477 1163.6646,-4795.0016 1215.6261,-4711.6755 1278.6271,-4734.3672 1332.0981,-4652.0016 1363.1136,-4604.2262 1332.8933,-4573.7795 1368.0981,-4529.0016 1415.3969,-4468.8413 1453.5624,-4485.4021 1517.2698,-4443.0016 1609.4062,-4381.6802 1633.733,-4366.8213 1715.2896,-4292.0016 1812.2018,-4203.0947 1794.025,-4126.2201 1914.2922,-4073.0016 2031.3521,-4021.2024 2072.1354,-3978.6134 2388.6335,-4149.0016 2481.9765,-4199.2532 2503.5598,-4227.2654 2554.9226,-4320.0016 2587.5126,-4378.8432 2553.3417,-4411.2152 2590.9226,-4467.0016 2615.1028,-4502.8955 2641.7846,-4491.0769 2669.874,-4524.0016"/>
<path fill="none" stroke="#0cff00" stroke-dasharray="5,2" d="M922.4246,-5292.7372C941.7573,-5255.3384 1006.5739,-5132.2663 1070.5822,-5037.0016"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge334" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00d8ff" stroke-dasharray="5,2" d="M919.116,-5292.9711C928.9085,-5248.6199 965.0783,-5078.8693 977.4998,-4937.0016 985.9269,-4840.7535 979.9764,-1549.6156 1013.4998,-1459.0016 1020.7189,-1439.4881 1036.1955,-1421.647 1049.2143,-1409.14"/>
<polygon fill="#00d8ff" stroke="#00d8ff" points="1051.9095,-1411.4168 1056.907,-1402.0746 1047.1744,-1406.2613 1051.9095,-1411.4168"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge340" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00b2ff" stroke-dasharray="5,2" d="M1070.5822,-5721.0016C1155.5058,-5821.2962 1246.4874,-5759.2929 1332.0981,-5859.0016 1372.5319,-5906.0938 1421.7498,-6093.5911 1437.5453,-6156.9546"/>
<polygon fill="#00b2ff" stroke="#00b2ff" points="1434.223,-6158.0999 1440.0199,-6166.9681 1441.0185,-6156.4205 1434.223,-6158.0999"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge447" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M2669.874,-4600.0016C2737.6572,-4670.1659 2701.931,-4735.5614 2784.8254,-4787.0016 2834.6063,-4817.8932 3035.6143,-4753.6066 3047.3719,-4811.0016"/>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M1070.5822,-5037.0016C1099.1229,-4994.5238 1107.1583,-4983.8891 1127.6646,-4937.0016 1148.9551,-4888.3208 1129.2465,-4863.4801 1163.6646,-4823.0016 1217.9813,-4759.1207 1272.2297,-4796.7116 1332.0981,-4738.0016 1356.5136,-4714.0586 1345.7077,-4695.8483 1368.0981,-4670.0016 1434.7844,-4593.0212 1464.7685,-4585.4056 1553.2698,-4535.0016 1750.2932,-4422.7912 1804.2611,-4390.7275 2025.9177,-4343.0016 2183.5729,-4309.0561 2232.4857,-4292.6863 2388.6335,-4333.0016 2470.4149,-4354.1165 2501.3583,-4359.6954 2554.9226,-4425.0016 2588.3494,-4465.756 2560.8676,-4494.7007 2590.9226,-4538.0016 2616.3628,-4574.6538 2638.1293,-4568.6511 2669.874,-4600.0016"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge454" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0c00ff" stroke-dasharray="5,2" d="M918.9622,-5292.9562C928.1692,-5248.5482 962.4126,-5078.6106 977.4998,-4937.0016 1012.8542,-4605.1625 997.0141,-4520.3113 1013.4998,-4187.0016 1035.4642,-3742.9207 1063.62,-3199.9563 1069.4833,-3087.1292"/>
<polygon fill="#0c00ff" stroke="#0c00ff" points="1072.9834,-3087.2163 1070.0074,-3077.048 1065.9929,-3086.8528 1072.9834,-3087.2163"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge470" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M1070.5822,-5037.0016C1071.8986,-5035.2848 1551.4899,-4644.2315 1553.2698,-4643.0016 1705.7978,-4537.6016 1748.6121,-4517.2126 1914.2922,-4434.0016 1962.5513,-4409.764 1973.0235,-4396.892 2025.9177,-4386.0016 2183.8512,-4353.4846 2274.5847,-4280.0138 2388.6335,-4394.0016 2461.54,-4466.869 2393.3751,-5222.7778 2424.6335,-5321.0016 2440.719,-5371.5471 2473.53,-5370.5081 2489.7781,-5421.0016"/>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M2489.7781,-5421.0016C2536.5015,-5565.1535 2626.1992,-5725.2715 2658.1864,-5780.2368"/>
<polygon fill="#3200ff" stroke="#3200ff" points="2655.229,-5782.1128 2663.3021,-5788.9739 2661.2697,-5778.5759 2655.229,-5782.1128"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge517" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M918.2406,-5292.643C928.0466,-5223.4095 980.841,-4859.9321 1013.4998,-4823.0016 1048.9257,-4782.942 1093.0896,-4825.798 1127.6646,-4785.0016 1193.9923,-4706.7387 1114.7855,-4647.1974 1163.6646,-4557.0016 1211.708,-4468.3478 1262.2378,-4477.7148 1332.0981,-4405.0016 1424.8425,-4308.47 1968.9686,-3479.0016 2102.8337,-3479.0016 2102.8337,-3479.0016 2102.8337,-3479.0016 2302.1917,-3479.0016 2550.3958,-3479.0016 2484.2722,-3739.065 2554.9226,-3977.0016 2605.78,-4148.2795 2651.4792,-4359.3875 2665.4848,-4425.9081"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="2662.1156,-4426.8959 2667.5921,-4435.9655 2668.9669,-4425.4603 2662.1156,-4426.8959"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge555" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M917.6595,-5315.1095C922.5535,-5365.4887 946.3279,-5576.8874 1013.4998,-5735.0016 1035.0206,-5785.6591 1345.9321,-6252.2707 1368.0981,-6269.0016 1395.8925,-6289.9807 1412.5359,-6275.5733 1442.684,-6293.0016"/>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1442.684,-6293.0016C1505.6247,-6332.8779 1490.7378,-6378.4874 1553.2698,-6419.0016 1559.4693,-6423.0182 1566.3515,-6426.4208 1573.4105,-6429.2958"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="1572.5056,-6432.6933 1583.0985,-6432.8972 1574.9448,-6426.132 1572.5056,-6432.6933"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge574" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M918.7834,-5315.0073C927.3096,-5359.2511 959.3131,-5528.5188 977.4998,-5669.0016 999.7912,-5841.1924 977.3651,-5888.1757 1013.4998,-6058.0016 1030.3726,-6137.3007 1194.1175,-6688.3181 1247.8813,-6749.0016"/>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M1247.8813,-6749.0016C1259.4335,-6764.0506 1314.3444,-6756.3138 1332.0981,-6763.0016 1519.7113,-6833.6755 1566.8001,-6866.3005 1715.2896,-7001.0016 1757.359,-7039.1646 1974.993,-7381.8438 2025.9177,-7407.0016 2106.2028,-7446.664 2215.157,-7412.0662 2269.1073,-7389.987"/>
<polygon fill="#ff0098" stroke="#ff0098" points="2270.6585,-7393.1317 2278.5216,-7386.0308 2267.9466,-7386.6783 2270.6585,-7393.1317"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge592" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M917.7506,-5315.1662C922.634,-5360.6543 945.1645,-5535.4563 1013.4998,-5659.0016 1031.6289,-5691.7778 1046.0102,-5692.7322 1070.5822,-5721.0016"/>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M1070.5822,-5721.0016C1148.6217,-5810.784 1237.9814,-5705.2482 1332.0981,-5778.0016 1360.09,-5799.6397 1347.5152,-5820.225 1368.0981,-5849.0016 1436.6969,-5944.9084 1468.5452,-5956.9915 1553.2698,-6039.0016 1824.1781,-6301.2304 1913.5882,-6343.9561 2179.7498,-6611.0016 2219.4561,-6650.8398 2263.057,-6700.4446 2285.9989,-6727.0438"/>
<polygon fill="#ff004c" stroke="#ff004c" points="2283.5181,-6729.5273 2292.6905,-6734.8301 2288.827,-6724.9647 2283.5181,-6729.5273"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge79" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M918.4809,-5292.858C930.5192,-5219.8408 998.2021,-4811.0564 1013.4998,-4757.0016 1038.225,-4669.6341 1118.3081,-4455.6604 1163.6646,-4377.0016 1302.9949,-4135.37 1372.25,-4097.2057 1553.2698,-3885.0016 1587.9244,-3844.377 1851.7879,-3577.357 1878.2922,-3531.0016 1989.9205,-3335.7665 1884.2495,-3221.6663 2025.9177,-3047.0016 2141.8815,-2904.0284 2262.8671,-2981.4328 2388.6335,-2847.0016 2414.4426,-2819.4144 2393.449,-2791.3249 2424.6335,-2770.0016 2543.6406,-2688.6272 2633.8182,-2672.0659 2748.8254,-2759.0016 2807.4228,-2803.2962 2843.211,-3041.1225 2852.9751,-3114.4569"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2849.5548,-3115.2959 2854.3183,-3124.7595 2856.4961,-3114.3909 2849.5548,-3115.2959"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge112" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1070.5822,-5721.0016C1087.1274,-5741.2156 1108.2494,-5717.5258 1127.6646,-5735.0016 1162.7734,-5766.6035 1136.8175,-5796.1359 1163.6646,-5835.0016 1219.6404,-5916.0364 1283.7449,-5893.2001 1332.0981,-5979.0016 1380.5257,-6064.935 1310.9348,-6117.6142 1368.0981,-6198.0016 1411.818,-6259.4838 1468.3051,-6221.6086 1517.2698,-6279.0016 1548.4716,-6315.5742 1517.9462,-6348.3925 1553.2698,-6381.0016 1608.0117,-6431.5369 1665.2508,-6368.8053 1715.2896,-6424.0016 1782.1296,-6497.7309 1688.8218,-6567.533 1751.2896,-6645.0016 1753.9669,-6648.3219 1757.1471,-6651.2028 1760.6356,-6653.7022"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1758.8684,-6656.7235 1769.2438,-6658.8689 1762.4709,-6650.7216 1758.8684,-6656.7235"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge162" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M918.6611,-5292.9185C926.7216,-5248.3669 957.1931,-5077.9568 977.4998,-4937.0016 996.271,-4806.7042 988.4754,-4772.2439 1013.4998,-4643.0016 1050.9239,-4449.7182 1095.8371,-4409.285 1127.6646,-4215.0016 1168.0558,-3968.442 1097.205,-3894.8465 1163.6646,-3654.0016 1207.2556,-3496.0304 1264.8191,-3475.4292 1332.0981,-3326.0016 1425.1229,-3119.3925 1459.9588,-3070.2193 1517.2698,-2851.0016 1546.3311,-2739.8404 1527.6584,-2707.008 1553.2698,-2595.0016 1573.4044,-2506.9469 1610.1458,-2405.5444 1626.2995,-2362.7554"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1629.5714,-2363.998 1629.8545,-2353.407 1623.0285,-2361.5099 1629.5714,-2363.998"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge195" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M919.0804,-5292.9679C928.7377,-5248.6046 964.4623,-5078.814 977.4998,-4937.0016 987.1191,-4832.3683 964.385,-3138.8908 1013.4998,-3046.0016 1042.5801,-2991.0028 1085.7195,-3010.9489 1127.6646,-2965.0016 1149.1475,-2941.4689 1142.1582,-2926.513 1163.6646,-2903.0016 1225.5286,-2835.3702 1288.03,-2864.3705 1332.0981,-2784.0016 1372.6903,-2709.972 1317.1791,-2092.3467 1368.0981,-2025.0016 1371.3104,-2020.7531 1375.275,-2017.2188 1379.6881,-2014.2798"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1381.587,-2017.2294 1388.6477,-2009.3302 1378.2021,-2011.1022 1381.587,-2017.2294"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge181" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M919.0864,-5292.9685C928.7664,-5248.6072 964.5658,-5078.8235 977.4998,-4937.0016 998.1699,-4710.3515 958.8109,-3109.9239 1013.4998,-2889.0016 1040.5408,-2779.766 1098.3434,-2771.6474 1127.6646,-2663.0016 1162.7568,-2532.9715 1112.4885,-2182.5822 1163.6646,-2058.0016 1176.8442,-2025.9178 1205.367,-1997.1955 1225.558,-1979.7082"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1227.9667,-1982.2557 1233.3672,-1973.1406 1223.4612,-1976.8984 1227.9667,-1982.2557"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge245" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M919.7067,-5292.7337C930.3503,-5254.1745 967.6184,-5124.2957 1013.4998,-5023.0016 1055.7298,-4929.7686 1085.3728,-4916.2067 1127.6646,-4823.0016 1147.8755,-4778.4594 1137.3084,-4760.2065 1163.6646,-4719.0016 1219.6307,-4631.5047 1276.1319,-4644.4985 1332.0981,-4557.0016 1358.4543,-4515.7967 1333.1342,-4487.2071 1368.0981,-4453.0016 1417.8825,-4404.2972 1459.1466,-4443.3722 1517.2698,-4405.0016 1629.2796,-4331.0572 1627.5889,-4278.6017 1715.2896,-4177.0016 1787.9913,-4092.7776 1814.001,-4077.8084 1878.2922,-3987.0016 1916.2388,-3933.4048 1891.8312,-3885.0714 1952.105,-3859.0016"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge232" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M919.0818,-5292.9681C928.7441,-5248.6052 964.4855,-5078.8161 977.4998,-4937.0016 987.2696,-4830.5414 973.7049,-3112.2266 1013.4998,-3013.0016 1041.3846,-2943.4732 1088.8391,-2953.0669 1127.6646,-2889.0016 1152.1465,-2848.6043 1129.3251,-2821.4378 1163.6646,-2789.0016 1170.8991,-2782.1681 1179.9168,-2777.1939 1189.3388,-2773.5752"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1190.4749,-2776.8859 1198.8445,-2770.3897 1188.2506,-2770.2486 1190.4749,-2776.8859"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge413" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1070.5822,-5455.0016C1110.1313,-5471.1608 1121.8672,-5439.8464 1163.6646,-5431.0016 1200.7859,-5423.1463 1210.8051,-5425.0668 1247.8813,-5417.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1247.8813,-5417.0016C1418.9047,-5379.799 1459.2568,-5341.0016 1634.2797,-5341.0016 1634.2797,-5341.0016 1634.2797,-5341.0016 1814.7909,-5341.0016 1911.8697,-5341.0016 1929.9333,-5382.4653 2025.9177,-5397.0016 2065.7992,-5403.0414 2354.1095,-5391.1425 2388.6335,-5412.0016 2514.811,-5488.2368 2496.5441,-5563.6336 2554.9226,-5699.0016 2577.1413,-5750.5223 2549.6338,-5782.011 2590.9226,-5820.0016 2643.6822,-5868.5467 2690.2891,-5811.6047 2748.8254,-5853.0016 2823.544,-5905.8426 2813.7864,-5947.6498 2855.7019,-6029.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M923.5221,-5315.2587C942.4739,-5345.0539 998.8463,-5425.6914 1070.5822,-5455.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2855.7019,-6029.0016C3024.8064,-6358.4543 2916.9862,-7324.501 2962.5784,-7692.0016 2981.9808,-7848.397 3026.5838,-8033.4219 3042.0078,-8094.947"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3038.695,-8096.1236 3044.5356,-8104.9631 3045.4822,-8094.4106 3038.695,-8096.1236"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge384" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1247.8813,-5417.0016C1416.1259,-5382.5653 1462.5471,-5417.0016 1634.2797,-5417.0016 1634.2797,-5417.0016 1634.2797,-5417.0016 1814.7909,-5417.0016 1978.8932,-5417.0016 2024.5298,-5526.2588 2179.7498,-5473.0016 2198.9224,-5466.4233 2196.5771,-5451.5799 2215.7498,-5445.0016 2288.428,-5420.0651 2330.6143,-5394.6257 2388.6335,-5445.0016 2474.727,-5519.7533 2359.9379,-5605.1167 2424.6335,-5699.0016 2462.1741,-5753.4795 2518.1111,-5716.0284 2554.9226,-5771.0016 2633.0802,-5887.7199 2545.6343,-5952.0327 2590.9226,-6085.0016 2634.7561,-6213.699 2708.4699,-6217.1716 2748.8254,-6347.0016 2803.2516,-6522.0988 2848.9882,-7904.9741 2855.0262,-8094.5034"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2851.5312,-8094.7202 2855.3463,-8104.6043 2858.5277,-8094.4984 2851.5312,-8094.7202"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge368" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M918.4737,-5315.35C929.4285,-5383.1838 986.8194,-5735.6838 1013.4998,-5842.0016 1066.1548,-6051.8257 1043.9578,-6124.81 1163.6646,-6305.0016 1290.1925,-6495.461 1378.0378,-6494.1076 1553.2698,-6641.0016 1624.45,-6700.6708 1665.213,-6694.7751 1715.2896,-6773.0016 1749.9275,-6827.1109 1720.8731,-6856.4115 1751.2896,-6913.0016 1772.8402,-6953.0968 1987.577,-7192.465 2025.9177,-7217.0016 2056.0803,-7236.3045 2067.6069,-7234.5634 2102.8337,-7241.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2102.8337,-7241.0016C2144.4209,-7247.3993 2191.4681,-7247.7207 2229.411,-7246.2941"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2230.0174,-7249.7715 2239.8593,-7245.8489 2229.7194,-7242.7778 2230.0174,-7249.7715"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge635" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2489.7781,-395.0016C2568.3158,-412.6074 2590.3916,-401.3258 2669.874,-414.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2302.1917,-239.0016C2338.6528,-255.1371 2355.5891,-240.6894 2388.6335,-263.0016 2449.8868,-304.361 2417.6588,-378.8347 2489.7781,-395.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1071.9801,-1379.9805C1081.6557,-1304.0616 1139.01,-859.9892 1163.6646,-805.0016 1222.3866,-674.0328 1263.9109,-653.7241 1368.0981,-555.0016 1506.8825,-423.4967 1562.6602,-416.149 1715.2896,-301.0016 1731.4709,-288.794 1733.9949,-283.5733 1751.2896,-273.0016 1819.4903,-231.3126 1840.1266,-226.8138 1914.2922,-197.0016 1962.9181,-177.4556 1974.2142,-167.561 2025.9177,-159.0016 2093.3695,-147.8352 2115.0806,-136.8131 2179.7498,-159.0016 2198.9224,-165.5799 2199.0353,-175.5346 2215.7498,-187.0016 2252.72,-212.3652 2261.1926,-220.858 2302.1917,-239.0016"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge92" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ff7200" stroke-dasharray="5,2" d="M1442.684,-743.0016C1498.6148,-713.2126 1501.0673,-688.9259 1553.2698,-653.0016 1727.617,-533.0206 1779.0742,-444.6338 1989.9177,-463.0016 2169.1562,-478.6161 2224.1642,-460.0629 2388.6335,-533.0016 2407.1629,-541.219 2408.3307,-548.9566 2424.6335,-561.0016 2479.4209,-601.48 2893.5177,-853.4437 2926.5784,-913.0016 3039.342,-1116.1424 3046.8421,-2898.8369 3047.3372,-3114.6432"/>
<polygon fill="#ff7200" stroke="#ff7200" points="3043.8377,-3114.9512 3047.358,-3124.9441 3050.8377,-3114.937 3043.8377,-3114.9512"/>
<path fill="none" stroke="#ff7200" stroke-dasharray="5,2" d="M1247.8813,-819.0016C1303.0948,-744.2465 1359.0601,-783.5468 1442.684,-743.0016"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge104" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M1121.1393,-1379.9646C1179.1539,-1370.4754 1273.775,-1365.1735 1332.0981,-1415.0016 1381.6,-1457.2933 1340.0974,-1498.2226 1368.0981,-1557.0016 1415.7886,-1657.1133 1476.7126,-1653.7939 1517.2698,-1757.0016 1571.5532,-1895.1391 1501.2894,-1949.9812 1553.2698,-2089.0016 1597.4438,-2207.1442 1676.8253,-2201.8787 1715.2896,-2322.0016 1765.3905,-2478.4659 1735.852,-5115.4386 1751.2896,-5279.0016 1763.4644,-5407.9964 1797.1093,-5560.3335 1809.8312,-5615.0979"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="1806.4595,-5616.0501 1812.1488,-5624.9877 1813.2748,-5614.4529 1806.4595,-5616.0501"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge125" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M1247.8813,-1201.0016C1262.4934,-1196.6638 1504.0663,-1245.3861 1517.2698,-1253.0016 1589.1336,-1294.4511 1958.7916,-1754.1015 1989.9177,-1831.0016 2027.5848,-1924.0618 1967.3325,-1972.4738 2025.9177,-2054.0016 2071.0079,-2116.7496 2130.5683,-2075.4062 2179.7498,-2135.0016 2214.9203,-2177.6193 2180.0902,-2211.7922 2215.7498,-2254.0016 2243.4414,-2286.7796 2288.4644,-2256.3471 2302.1917,-2297.0016"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge217" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1952.105,-1845.0016C1965.8582,-1859.3911 1979.1349,-1852.2703 1989.9177,-1869.0016 2052.1595,-1965.5798 1951.5458,-2037.422 2025.9177,-2125.0016 2049.0975,-2152.2978 2081.7896,-2120.027 2102.8337,-2149.0016"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1247.8813,-1201.0016C1285.1582,-1189.8124 1297.621,-1206.9438 1332.0981,-1225.0016 1337.9932,-1228.0892 1513.4665,-1371.5409 1517.2698,-1377.0016 1545.2245,-1417.1392 1526.7802,-1439.8823 1553.2698,-1481.0016 1568.1905,-1504.1627 1892.4936,-1804.1528 1914.2922,-1821.0016 1930.0412,-1833.1745 1938.3518,-1830.6121 1952.105,-1845.0016"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge271" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#0cff00" stroke-dasharray="5,2" d="M1073.526,-1379.7554C1082.506,-1347.0811 1112.1245,-1250.4598 1163.6646,-1187.0016 1192.9671,-1150.9232 1221.9405,-1163.568 1247.8813,-1125.0016"/>
<path fill="none" stroke="#0cff00" stroke-dasharray="5,2" d="M1247.8813,-1125.0016C1315.3538,-1024.6901 1268.7279,-949.8528 1368.0981,-881.0016 1595.6861,-723.3116 1738.6941,-726.6008 1989.9177,-843.0016 2049.1204,-870.4323 2139.1947,-1015.8872 2179.7498,-1067.0016 2293.2676,-1210.0762 2303.6201,-1260.2083 2424.6335,-1397.0016 2477.6005,-1456.8754 2514.5651,-1451.997 2554.9226,-1521.0016 2587.7922,-1577.2031 2562.8079,-1604.2771 2590.9226,-1663.0016 2641.3479,-1768.3273 2710.6827,-1762.6325 2748.8254,-1873.0016 2780.2982,-1964.0707 2780.8007,-3510.7316 2784.8254,-3607.0016 2803.5096,-4053.9183 2845.1897,-4599.4297 2854.0329,-4712.7772"/>
<polygon fill="#0cff00" stroke="#0cff00" points="2850.5559,-4713.2084 2854.8256,-4722.9047 2857.5345,-4712.6621 2850.5559,-4713.2084"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge445" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M1071.3625,-1379.6464C1076.1723,-1317.1048 1106.4333,-1010.5122 1247.8813,-819.0016"/>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M1247.8813,-819.0016C1358.721,-668.9326 1404.1684,-643.1396 1553.2698,-531.0016 1687.356,-430.1565 1739.5661,-433.3622 1878.2922,-339.0016 1895.0524,-327.6015 1895.1196,-317.5799 1914.2922,-311.0016 2056.1752,-262.3205 2064.2656,-345.1635 2424.6335,-447.0016 2532.8216,-477.575 2561.5165,-479.0344 2669.874,-509.0016"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge519" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1075.7379,-1379.8214C1093.3381,-1343.3591 1155.1402,-1228.6557 1247.8813,-1201.0016"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1247.8813,-1201.0016C1292.4223,-1187.7201 1302.7174,-1175.0164 1332.0981,-1139.0016 1356.2334,-1109.4167 1336.3887,-1082.2688 1368.0981,-1061.0016 1436.5112,-1015.1177 1470.9137,-1054.7798 1553.2698,-1053.0016 1625.2618,-1051.4472 1643.3024,-1051.2361 1715.2896,-1053.0016 1787.8006,-1054.7799 1806.7445,-1049.0878 1878.2922,-1061.0016 1895.4866,-1063.8647 2168.3066,-1134.8526 2179.7498,-1148.0016 2253.7332,-1233.0139 2139.0593,-1316.4231 2215.7498,-1399.0016 2269.2857,-1456.6479 2332.7384,-1381.6398 2388.6335,-1437.0016 2393.0887,-1441.4142 2488.0835,-1870.9644 2489.7781,-1877.0016"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M2489.7781,-1877.0016C2498.6882,-1908.859 2537.5691,-1884.8389 2554.9226,-1913.0016 2582.1633,-1957.2102 2588.643,-2795.1243 2590.9226,-2847.0016 2619.335,-3493.5753 2661.3311,-4286.7529 2668.7378,-4425.734"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="2665.2516,-4426.0871 2669.2794,-4435.8864 2672.2417,-4425.7141 2665.2516,-4426.0871"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge163" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1442.684,-1771.0016C1493.6602,-1818.5629 1491.8249,-1844.0924 1517.2698,-1909.0016 1540.7175,-1968.8164 1536.7087,-1986.9264 1553.2698,-2049.0016 1580.5318,-2151.1867 1614.7515,-2272.928 1628.3319,-2320.9966"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1625.0275,-2322.1741 1631.1166,-2330.8443 1631.7634,-2320.2692 1625.0275,-2322.1741"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1084.0189,-1402.1878C1123.7361,-1435.5083 1243.3543,-1537.713 1332.0981,-1633.0016 1385.664,-1690.5179 1385.2162,-1717.3837 1442.684,-1771.0016"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge197" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1083.1295,-1402.222C1096.3158,-1414.7436 1116.6425,-1436.2527 1127.6646,-1459.0016 1162.0979,-1530.0705 1121.0423,-1566.5201 1163.6646,-1633.0016 1213.8357,-1711.2577 1273.529,-1684.8156 1332.0981,-1757.0016 1389.8337,-1828.1603 1424.3475,-1934.3352 1437.0732,-1979.0047"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1433.7299,-1980.0462 1439.7774,-1988.7455 1440.4748,-1978.1736 1433.7299,-1980.0462"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge179" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1083.4003,-1402.0958C1096.8181,-1414.5096 1117.3414,-1435.9271 1127.6646,-1459.0016 1173.5079,-1561.4714 1137.8346,-1599.7565 1163.6646,-1709.0016 1184.5264,-1797.2347 1222.7593,-1898.5426 1239.5737,-1941.2774"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1236.3356,-1942.6067 1243.2743,-1950.6133 1242.8431,-1940.0273 1236.3356,-1942.6067"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge246" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1247.8813,-1201.0016C1285.1649,-1189.835 1303.8624,-1198.2154 1332.0981,-1225.0016 1367.8887,-1258.9547 1340.5637,-1289.0671 1368.0981,-1330.0016 1417.1811,-1402.9716 1469.0813,-1386.4378 1517.2698,-1460.0016 1546.3844,-1504.4476 1531.0943,-1525.7174 1553.2698,-1574.0016 1667.6473,-1823.044 1764.5919,-1848.6493 1878.2922,-2098.0016 2066.1213,-2509.9232 2079.2722,-2629.5683 2179.7498,-3071.0016 2251.6335,-3386.8124 2291.3056,-3780.5144 2300.2396,-3875.6145"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2296.767,-3876.073 2301.1768,-3885.7065 2303.737,-3875.4256 2296.767,-3876.073"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge230" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1084.1618,-1402.1105C1098.0137,-1414.3792 1118.7058,-1435.5288 1127.6646,-1459.0016 1220.1013,-1701.1958 1090.0833,-2376.429 1163.6646,-2625.0016 1177.5629,-2671.9529 1211.3184,-2719.1237 1231.6226,-2744.6407"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1229.1682,-2747.1706 1238.1888,-2752.7275 1234.6024,-2742.7581 1229.1682,-2747.1706"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge415" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1442.684,-743.0016C1821.0875,-559.532 2000.0761,-604.1495 2388.6335,-765.0016 2666.3861,-879.9835 2808.8959,-898.3824 2926.5784,-1175.0016 2962.013,-1258.2927 2953.4111,-7601.9518 2962.5784,-7692.0016 2978.5393,-7848.7857 3025.3452,-8033.5617 3041.6735,-8094.9847"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3038.3838,-8096.2307 3044.3534,-8104.9837 3045.1452,-8094.4185 3038.3838,-8096.2307"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge386" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1247.8813,-1125.0016C1286.5161,-1070.5765 1304.7703,-1056.0804 1368.0981,-1035.0016 1711.3352,-920.7544 1914.2594,-850.2803 2179.7498,-1096.0016 2230.3832,-1142.8648 2180.1711,-1187.8911 2215.7498,-1247.0016 2268.5112,-1334.6597 2326.6194,-1317.6262 2388.6335,-1399.0016 2410.8023,-1428.0916 2403.0431,-1443.4799 2424.6335,-1473.0016 2448.2285,-1505.2642 2472.8977,-1498.7712 2489.7781,-1535.0016"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge366" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1077.6241,-1379.9729C1091.3,-1359.7166 1123.6532,-1317.1817 1163.6646,-1301.0016 1233.0643,-1272.9373 1271.3691,-1257.2306 1332.0981,-1301.0016 1373.1441,-1330.5859 1341.4132,-1366.0142 1368.0981,-1409.0016 1417.3541,-1488.3493 1472.1133,-1475.2514 1517.2698,-1557.0016 1552.7221,-1621.1836 1530.4929,-1648.3065 1553.2698,-1718.0016 1609.1621,-1889.0269 1672.5582,-1914.2228 1715.2896,-2089.0016 1771.3612,-2318.345 1724.9339,-2384.3789 1751.2896,-2619.0016 1791.8693,-2980.2497 1836.5525,-3065.8857 1878.2922,-3427.0016 1903.0597,-3641.2803 1855.5352,-3703.4531 1914.2922,-3911.0016 1984.2206,-4158.0109 2117.1484,-4175.0345 2179.7498,-4424.0016 2244.1075,-4679.9536 2188.3137,-6536.5124 2215.7498,-6799.0016 2232.8876,-6962.9645 2280.4307,-7156.6626 2296.6708,-7219.8983"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2293.3506,-7221.0386 2299.2442,-7229.8429 2300.1274,-7219.285 2293.3506,-7221.0386"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge636" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2855.7019,-10587.0016C2949.5439,-10641.9034 2962.7712,-10807.2895 3047.3719,-10739.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1634.2797,-6787.0016C1643.3248,-6822.4024 1691.4087,-6773.3477 1715.2896,-6801.0016 1767.6654,-6861.6527 1738.7828,-8163.8475 1751.2896,-8243.0016 1782.2568,-8438.9905 1825.9951,-8479.5973 1878.2922,-8671.0016 1895.6797,-8734.6387 1893.4682,-8752.4048 1914.2922,-8815.0016 1954.763,-8936.6564 1974.5753,-8963.5208 2025.9177,-9081.0016 2197.3807,-9473.3401 2240.5863,-9571.4066 2424.6335,-9958.0016 2570.3107,-10263.9994 2563.1812,-10415.864 2855.7019,-10587.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3047.3719,-10739.0016C3097.9057,-10698.2118 3111.2313,-10681.4771 3132.1655,-10620.0016 3166.7171,-10518.5374 3102.2153,-9740.4963 3168.1655,-9656.0016 3186.797,-9632.1312 3210.644,-9617.2481 3233.5946,-9637.0016"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1444.1941,-6189.1003C1451.5384,-6241.3671 1485.94,-6467.6729 1553.2698,-6641.0016 1580.14,-6710.1744 1616.1733,-6715.036 1634.2797,-6787.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1634.2797,-6787.0016C1638.7372,-6804.7185 1701.6077,-6788.8952 1715.2896,-6801.0016 1721.1567,-6806.1932 1876.1073,-7333.4782 1878.2922,-7341.0016 1895.3118,-7399.6038 1982.1258,-7827.5028 2025.9177,-7870.0016 2051.1869,-7894.5247 2071.5457,-7872.847 2102.8337,-7889.0016"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge51" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff4c00" stroke-dasharray="5,2" d="M1453.069,-6166.636C1479.9714,-6137.9436 1555.3527,-6062.2237 1634.2797,-6025.0016"/>
<path fill="none" stroke="#ff4c00" stroke-dasharray="5,2" d="M1634.2797,-6025.0016C1668.2434,-6008.9842 1680.1741,-6014.3056 1715.2896,-6001.0016 1790.0379,-5972.6822 1810.0915,-5966.6906 1878.2922,-5925.0016 1895.5869,-5914.4299 1895.4938,-5904.5833 1914.2922,-5897.0016 1992.4419,-5865.4825 2019.7482,-5862.9444 2102.8337,-5877.0016"/>
<path fill="none" stroke="#ff4c00" stroke-dasharray="5,2" d="M2102.8337,-5877.0016C2193.0313,-5877.4718 2213.2481,-5853.9971 2302.1917,-5839.0016"/>
<path fill="none" stroke="#ff4c00" stroke-dasharray="5,2" d="M2302.1917,-5839.0016C2338.5712,-5832.8682 2379.4859,-5831.9671 2413.7986,-5832.8686"/>
<polygon fill="#ff4c00" stroke="#ff4c00" points="2414.1161,-5836.3805 2424.223,-5833.2025 2414.3402,-5829.3841 2414.1161,-5836.3805"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge85" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ff7200" stroke-dasharray="5,2" d="M1814.7909,-6063.0016C1902.7836,-6020.8917 1931.4569,-6098.6477 2025.9177,-6123.0016 2109.7818,-6144.6235 2130.7707,-6150.2913 2215.7498,-6167.0016 2253.9377,-6174.5109 2263.2724,-6181.0016 2302.1917,-6181.0016 2302.1917,-6181.0016 2302.1917,-6181.0016 2489.7781,-6181.0016 2536.9901,-6181.0016 2651.1314,-6150.0606 2748.8254,-5960.0016 2779.0946,-5901.1144 2846.8556,-4838.6192 2855.7019,-4773.0016"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge126" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M2102.8337,-6329.0016C2218.4353,-6344.4436 2354.485,-6323.9492 2430.5658,-6309.0333"/>
<polygon fill="#ffe500" stroke="#ffe500" points="2431.322,-6312.4515 2440.4435,-6307.0618 2429.9518,-6305.5869 2431.322,-6312.4515"/>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M1634.2797,-6367.0016C1670.2573,-6384.7416 1774.8441,-6370.6557 1814.7909,-6367.0016"/>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M1814.7909,-6367.0016C1859.7107,-6362.8926 1869.6699,-6353.5983 1914.2922,-6347.0016 1997.5644,-6334.6912 2019.3161,-6318.4843 2102.8337,-6329.0016"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge272" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#0cff00" stroke-dasharray="5,2" d="M1814.7909,-6063.0016C1847.7966,-6042.1487 1953.425,-6035.1271 1989.9177,-6049.0016 2009.9276,-6056.6093 2005.9079,-6073.3939 2025.9177,-6081.0016 2245.6832,-6164.5563 2357.4859,-6208.6613 2554.9226,-6081.0016 2587.6643,-6059.8313 2566.0263,-6031.0078 2590.9226,-6001.0016 2645.536,-5935.1791 2708.0412,-5966.1805 2748.8254,-5891.0016 2808.8324,-5780.3887 2710.5095,-4860.5555 2784.8254,-4759.0016 2787.1178,-4755.869 2789.8346,-4753.1269 2792.8462,-4750.7268"/>
<polygon fill="#0cff00" stroke="#0cff00" points="2794.9517,-4753.5322 2801.4174,-4745.1391 2791.1289,-4747.6682 2794.9517,-4753.5322"/>
<path fill="none" stroke="#0cff00" stroke-dasharray="5,2" d="M1634.2797,-6367.0016C1755.2471,-6426.6486 1654.2894,-6180.7131 1751.2896,-6087.0016 1772.9885,-6066.0383 1787.5756,-6076.0258 1814.7909,-6063.0016"/>
<path fill="none" stroke="#0cff00" stroke-dasharray="5,2" d="M1492.5911,-6183.1704C1501.3013,-6185.576 1509.9151,-6189.0376 1517.2698,-6194.0016 1594.2089,-6245.9316 1551.026,-6325.9506 1634.2797,-6367.0016"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge435" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M1814.7909,-6063.0016C1842.3921,-6050.8165 1850.4943,-6075.2721 1878.2922,-6087.0016 1945.0195,-6115.1576 1956.7735,-6134.4525 2025.9177,-6156.0016 2250.9918,-6226.1469 2329.1323,-6262.8059 2554.9226,-6195.0016 2653.8222,-6165.3023 2694.2033,-6154.6349 2748.8254,-6067.0016 2782.1262,-6013.5753 2737.5658,-5827.5929 2784.8254,-5786.0016 2900.7122,-5684.0144 3017.0314,-5683.1655 3132.1655,-5786.0016 3199.7423,-5846.3601 3228.0464,-6530.3355 3232.8429,-6660.6326"/>
<polygon fill="#0019ff" stroke="#0019ff" points="3229.3545,-6661.0177 3233.2134,-6670.8847 3236.3499,-6660.7648 3229.3545,-6661.0177"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge472" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M2102.8337,-5877.0016C2153.4022,-5877.2652 2165.2768,-5887.8846 2215.7498,-5891.0016 2366.2066,-5900.2933 2412.5495,-5940.5345 2554.9226,-5891.0016 2556.3019,-5890.5218 2614.825,-5843.9268 2647.8196,-5817.6076"/>
<polygon fill="#3200ff" stroke="#3200ff" points="2650.3606,-5820.0578 2655.9944,-5811.085 2645.9948,-5814.5861 2650.3606,-5820.0578"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge520" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M2102.8337,-5877.0016C2153.0766,-5875.1647 2519.6448,-5893.8234 2554.9226,-5858.0016 2607.4891,-5804.6245 2557.5298,-4577.0632 2590.9226,-4510.0016 2600.9734,-4489.8169 2620.8464,-4474.0148 2638.1386,-4463.2851"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="2640.0375,-4466.2287 2646.8804,-4458.1401 2636.487,-4460.196 2640.0375,-4466.2287"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge549" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1492.4166,-6186.6073C1501.7693,-6190.2856 1510.67,-6195.5293 1517.2698,-6203.0016 1570.7007,-6263.4971 1510.7604,-6312.3903 1553.2698,-6381.0016 1565.4955,-6400.7343 1586.2602,-6416.6998 1603.7054,-6427.6214"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="1602.0854,-6430.7308 1612.4628,-6432.8662 1605.682,-6424.7255 1602.0854,-6430.7308"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge565" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M1814.7909,-6899.0016C1907.9191,-7057.6403 1887.9398,-7133.3414 2025.9177,-7255.0016 2089.8245,-7311.3505 2184.2929,-7344.5809 2244.5353,-7361.2953"/>
<polygon fill="#ff0098" stroke="#ff0098" points="2243.6995,-7364.695 2254.267,-7363.9344 2245.5316,-7357.939 2243.6995,-7364.695"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge594" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M1634.2797,-6367.0016C1668.2376,-6383.0315 1681.8875,-6373.8436 1715.2896,-6391.0016 1733.3197,-6400.2633 1735.0367,-6406.8893 1751.2896,-6419.0016 1871.5269,-6508.6076 1896.6358,-6539.025 2025.9177,-6615.0016 2108.2075,-6663.3618 2211.1956,-6708.4145 2265.2097,-6730.9482"/>
<polygon fill="#ff004c" stroke="#ff004c" points="2264.1314,-6734.2901 2274.7093,-6734.8894 2266.8139,-6727.8245 2264.1314,-6734.2901"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge69" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1634.2797,-6025.0016C1727.7751,-5982.1208 2462.394,-5972.9305 2554.9226,-5928.0016 2575.562,-5917.9798 2572.1276,-5904.1609 2590.9226,-5891.0016 2653.9556,-5846.869 2706.5183,-5884.2741 2748.8254,-5820.0016 2783.0563,-5767.9986 2779.3938,-3641.0223 2784.8254,-3579.0016 2799.1526,-3415.4084 2837.9565,-3220.7927 2851.2009,-3157.2218"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2854.6706,-3157.7292 2853.2993,-3147.2235 2847.8199,-3156.2914 2854.6706,-3157.7292"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge108" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1634.2797,-6367.0016C1668.2376,-6383.0315 1690.7616,-6362.5679 1715.2896,-6391.0016 1789.7639,-6477.3351 1680.6415,-6555.51 1751.2896,-6645.0016 1753.9325,-6648.3495 1757.0878,-6651.2501 1760.5592,-6653.7631"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1758.772,-6656.7725 1769.1404,-6658.9514 1762.3938,-6650.7823 1758.772,-6656.7725"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge157" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1443.6109,-6166.8703C1450.8417,-6079.5123 1498.4312,-5494.9834 1517.2698,-5019.0016 1527.9224,-4749.8493 1509.7263,-2860.8219 1553.2698,-2595.0016 1567.8715,-2505.8622 1607.5459,-2405.0347 1625.3832,-2362.5758"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1628.6338,-2363.8753 1629.3237,-2353.3029 1622.1914,-2361.1375 1628.6338,-2363.8753"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge247" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1452.3402,-6166.8457C1467.2809,-6149.2909 1496.4471,-6113.8295 1517.2698,-6081.0016 1536.0085,-6051.4591 1530.8319,-6037.8427 1553.2698,-6011.0016 1611.4278,-5941.4305 1650.0423,-5949.9722 1715.2896,-5887.0016 1797.3067,-5807.8463 1834.6813,-5794.3129 1878.2922,-5689.0016 1941.8452,-5535.5346 1851.9419,-5470.9612 1914.2922,-5317.0016 1944.1636,-5243.2412 1960.2412,-5221.9403 2025.9177,-5177.0016 2055.4719,-5156.7794 2091.4117,-5186.9416 2102.8337,-5153.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2102.8337,-5153.0016C2114.4239,-5119.7513 2157.3455,-5161.1671 2179.7498,-5134.0016 2230.0081,-5073.0627 2207.3438,-4502.5433 2215.7498,-4424.0016 2236.9628,-4225.7966 2283.5145,-3988.8049 2297.8821,-3917.9744"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2301.3342,-3918.5622 2299.9029,-3908.0645 2294.4753,-3917.1636 2301.3342,-3918.5622"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge416" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1814.7909,-6367.0016C1982.3485,-6367.205 2462.3755,-6371.3212 2554.9226,-6511.0016 2633.2619,-6629.2382 2516.7705,-7666.095 2590.9226,-7787.0016 2632.7016,-7855.1232 2682.4651,-7828.4781 2748.8254,-7873.0016 2860.8607,-7948.17 2981.8544,-8055.8996 3028.0058,-8098.0904"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3025.757,-8100.7771 3035.4912,-8104.9599 3030.49,-8095.6197 3025.757,-8100.7771"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge387" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1814.7909,-6367.0016C1923.7142,-6373.457 2199.1257,-6440.4865 2388.6335,-6726.0016 2663.2864,-7139.7973 2334.0629,-7399.932 2590.9226,-7825.0016 2613.9973,-7863.1872 2652.0791,-7846.088 2669.874,-7887.0016"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge358" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1443.6347,-6189.1816C1448.1589,-6237.1218 1470.8388,-6428.6916 1553.2698,-6557.0016 1604.7085,-6637.0699 1667.2723,-6614.8359 1715.2896,-6697.0016 1756.0136,-6766.6875 1699.0156,-6813.5037 1751.2896,-6875.0016 1770.8301,-6897.9902 1799.6853,-6872.8841 1814.7909,-6899.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1814.7909,-6899.0016C1918.3595,-7080.964 2163.1456,-7189.078 2260.8586,-7226.2951"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2259.8019,-7229.6369 2270.3939,-7229.8788 2262.2646,-7223.0844 2259.8019,-7229.6369"/>
</g>
<!-- sourcefile~datazoneenergydemands.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node25" class="node">
<title>sourcefile~datazoneenergydemands.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node25"><a xlink:href="../sourcefile/datazoneenergydemands.f90.html" xlink:title="DataZoneEnergyDemands.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2179.6659,-1891.007 2026.0016,-1891.007 2026.0016,-1868.9962 2179.6659,-1868.9962 2179.6659,-1891.007"/>
<text text-anchor="middle" x="2102.8337" y="-1876.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataZoneEnergyDemands.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge637" class="edge">
<title>sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2108.6481,-1868.7145C2124.8302,-1837.4672 2172.0769,-1747.3578 2215.7498,-1675.0016 2422.2276,-1332.9142 2436.9549,-1175.5799 2784.8254,-979.0016 2890.0638,-919.5325 2933.391,-867.7519 3047.3719,-908.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3047.3719,-908.0016C3083.9656,-921.9631 3104.9595,-903.8263 3132.1655,-932.0016 3263.4565,-1067.9703 3050.0077,-1300.0497 3233.5946,-1345.0016"/>
</g>
<!-- sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge127" class="edge">
<title>sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M2302.1917,-2297.0016C2314.8397,-2334.46 2364.0412,-2287.0449 2388.6335,-2318.0016 2419.2179,-2356.5011 2420.7577,-5808.9854 2424.6335,-5858.0016 2437.4107,-6019.5877 2473.3297,-6212.1108 2485.6046,-6275.0059"/>
<polygon fill="#ffe500" stroke="#ffe500" points="2482.186,-6275.7613 2487.5497,-6284.8981 2489.0545,-6274.4107 2482.186,-6275.7613"/>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M2111.1182,-1891.145C2127.1421,-1913.2957 2162.3328,-1964.9644 2179.7498,-2014.0016 2213.0574,-2107.779 2163.3071,-2150.424 2215.7498,-2235.0016 2240.6644,-2275.1832 2287.0665,-2252.2073 2302.1917,-2297.0016"/>
</g>
<!-- sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge248" class="edge">
<title>sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2111.9581,-1891.3018C2129.1042,-1913.3188 2165.673,-1964.182 2179.7498,-2014.0016 2216.4132,-2143.7585 2205.1101,-3092.5849 2215.7498,-3227.0016 2236.0998,-3484.0953 2285.2675,-3793.8539 2298.7323,-3876.1189"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2295.2799,-3876.6944 2300.3565,-3885.9938 2302.1871,-3875.5583 2295.2799,-3876.6944"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge638" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1443.13,-3656.9667C1446.4848,-3578.834 1469.9559,-3109.0507 1553.2698,-2999.0016 1601.2783,-2935.5872 1670.6416,-2988.8254 1715.2896,-2923.0016 1752.8421,-2867.6385 1743.4992,-2388.4439 1751.2896,-2322.0016 1771.8613,-2146.5481 1922.1143,-898.942 2025.9177,-756.0016 2073.5227,-690.4481 2589.0275,-408.7726 2669.874,-414.0016"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1444.5182,-3679.313C1452.6596,-3727.928 1488.0355,-3923.3422 1553.2698,-4071.0016 1658.4791,-4309.1457 2105.7138,-4811.4014 2179.7498,-5061.0016 2202.4855,-5137.6515 2167.3082,-7875.3971 2215.7498,-7939.0016 2221.7211,-7946.8421 2229.9988,-7952.3365 2239.0836,-7956.165"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2238.1853,-7959.5593 2248.7801,-7959.5802 2240.5108,-7952.9569 2238.1853,-7959.5593"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge52" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff4c00" stroke-dasharray="5,2" d="M1814.7909,-3517.0016C1910.979,-3462.6459 2271.7156,-3478.5073 2388.6335,-3617.0016 2421.2162,-3655.5972 2420.0922,-5384.6963 2424.6335,-5435.0016 2437.9233,-5582.2157 2472.7961,-5757.0383 2485.2648,-5816.7781"/>
<polygon fill="#ff4c00" stroke="#ff4c00" points="2481.9011,-5817.7909 2487.3846,-5826.8564 2488.7513,-5816.35 2481.9011,-5817.7909"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge91" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ff7200" stroke-dasharray="5,2" d="M1444.2564,-3656.9702C1453.3859,-3593.9776 1500.9861,-3279.7593 1553.2698,-3199.0016 1602.5498,-3122.8834 1668.6216,-3152.7487 1715.2896,-3075.0016 1765.8293,-2990.8043 1724.7173,-2951.5393 1751.2896,-2857.0016 1792.0238,-2712.0789 1831.4639,-2686.0714 1878.2922,-2543.0016 1898.5454,-2481.1241 1876.1046,-2453.7341 1914.2922,-2401.0016 1937.642,-2368.7585 1969.4818,-2387.166 1989.9177,-2353.0016 2046.3065,-2258.7322 1979.5681,-1959.5914 2025.9177,-1860.0016 2161.7247,-1568.1978 2283.4852,-1502.2656 2590.9226,-1407.0016 2737.0258,-1361.7294 2837.7236,-1358.5005 2926.5784,-1483.0016 3026.0426,-1622.3684 3044.9714,-2931.5004 3047.1399,-3114.7395"/>
<polygon fill="#ff7200" stroke="#ff7200" points="3043.6402,-3114.7882 3047.2547,-3124.7473 3050.6397,-3114.7078 3043.6402,-3114.7882"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge103" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M1443.2865,-3679.2079C1448.9812,-3783.6143 1494.4237,-4584.3022 1553.2698,-4671.0016 1599.0534,-4738.4558 1670.8967,-4688.6241 1715.2896,-4757.0016 1746.9476,-4805.764 1744.1886,-5221.2991 1751.2896,-5279.0016 1767.1149,-5407.5996 1798.5404,-5560.178 1810.252,-5615.0521"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="1806.8586,-5615.9204 1812.3803,-5624.9626 1813.7025,-5614.4506 1806.8586,-5615.9204"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge273" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#0cff00" stroke-dasharray="5,2" d="M1634.2797,-3517.0016C1678.6235,-3480.8734 1683.4616,-3464.5264 1715.2896,-3417.0016 1733.8824,-3389.2392 1732.9192,-3378.9117 1751.2896,-3351.0016 1801.5893,-3274.5814 1834.5054,-3269.3311 1878.2922,-3189.0016 1901.7023,-3146.0544 1884.5685,-3123.8474 1914.2922,-3085.0016 1950.7646,-3037.3362 1973.5048,-3038.2438 2025.9177,-3009.0016 2180.0997,-2922.9806 2237.2503,-2937.8576 2388.6335,-2847.0016 2406.0134,-2836.5707 2405.4609,-2825.5799 2424.6335,-2819.0016 2560.92,-2772.2407 2644.6428,-2719.4699 2748.8254,-2819.0016 2780.5125,-2849.2741 2782.4501,-3563.2426 2784.8254,-3607.0016 2809.0711,-4053.6512 2846.3992,-4599.3716 2854.2302,-4712.7677"/>
<polygon fill="#0cff00" stroke="#0cff00" points="2850.7492,-4713.165 2854.9309,-4722.8997 2857.7325,-4712.682 2850.7492,-4713.165"/>
<path fill="none" stroke="#0cff00" stroke-dasharray="5,2" d="M1456.5063,-3656.8567C1487.8653,-3631.6277 1566.9113,-3568.3457 1634.2797,-3517.0016"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge303" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1443.4714,-3679.0751C1450.0785,-3772.4389 1496.5414,-4437.9645 1517.2698,-4979.0016 1532.7736,-5383.6726 1507.3752,-6398.6427 1553.2698,-6801.0016 1592.9027,-7148.4646 1669.7966,-7224.2572 1715.2896,-7571.0016 1754.1974,-7867.5551 1732.2889,-7944.5108 1751.2896,-8243.0016 1772.6087,-8577.9143 1805.2104,-8985.601 1813.0515,-9082.5799"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1809.5865,-9083.1558 1813.8825,-9092.8405 1816.5637,-9082.5906 1809.5865,-9083.1558"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge443" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M1443.3941,-3656.8389C1448.2507,-3583.5756 1478.6318,-3171.5141 1553.2698,-3075.0016 1601.9273,-3012.0838 1670.0198,-3064.3993 1715.2896,-2999.0016 1773.1442,-2915.4236 1721.3709,-2640.1475 1751.2896,-2543.0016 1814.2533,-2338.5584 1927.7902,-2329.7005 1989.9177,-2125.0016 2055.7825,-1907.9893 1945.8158,-1828.1718 2025.9177,-1616.0016 2075.0693,-1485.8114 2126.0013,-1473.3529 2215.7498,-1367.0016 2303.5412,-1262.9693 2309.5432,-1215.6947 2424.6335,-1143.0016 2485.992,-1104.2465 3019.4325,-879.0225 3047.3719,-946.0016"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge473" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M1814.7909,-3517.0016C2041.3139,-3399.8115 2219.4646,-3325.1402 2388.6335,-3516.0016 2448.161,-3583.1623 2393.8765,-5046.6922 2424.6335,-5131.0016 2456.2995,-5217.8025 2514.7213,-5209.8091 2554.9226,-5293.0016 2639.3512,-5467.7178 2663.0455,-5706.5677 2668.4696,-5778.596"/>
<polygon fill="#3200ff" stroke="#3200ff" points="2664.9868,-5778.9629 2669.1898,-5788.6884 2671.9691,-5778.4646 2664.9868,-5778.9629"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge521" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M2302.1917,-3213.0016C2367.5672,-3167.9738 2443.0202,-2844.8521 2489.7781,-2909.0016"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1814.7909,-3517.0016C1874.1167,-3484.7719 1855.7909,-3442.6569 1878.2922,-3379.0016 1899.9912,-3317.6162 1864.1674,-3278.5529 1914.2922,-3237.0016 1980.7823,-3181.8842 2231.0652,-3261.9903 2302.1917,-3213.0016"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1634.2797,-3517.0016C1696.4772,-3466.3274 1743.5346,-3553.8656 1814.7909,-3517.0016"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge553" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1443.4464,-3679.0761C1449.8472,-3772.4481 1494.9411,-4438.0282 1517.2698,-4979.0016 1520.483,-5056.8499 1518.1403,-6311.456 1553.2698,-6381.0016 1563.5307,-6401.3151 1583.7205,-6417.0419 1601.3763,-6427.7019"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="1599.8938,-6430.886 1610.3122,-6432.8121 1603.3688,-6424.8095 1599.8938,-6430.886"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge572" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M1446.506,-3679.0318C1459.3707,-3715.6492 1503.115,-3836.118 1553.2698,-3929.0016 1676.7337,-4157.6493 1737.3531,-4196.6916 1878.2922,-4415.0016 1945.6,-4519.2591 1943.6507,-4559.0926 2025.9177,-4652.0016 2084.1334,-4717.7481 2141.2822,-4697.0591 2179.7498,-4776.0016 2240.2308,-4900.12 2170.7967,-7130.4545 2215.7498,-7261.0016 2229.0873,-7299.7349 2261.1184,-7335.8774 2282.2202,-7356.6905"/>
<polygon fill="#ff0098" stroke="#ff0098" points="2280.0756,-7359.4839 2289.7107,-7363.8902 2284.9265,-7354.4371 2280.0756,-7359.4839"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge595" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M1474.2613,-3679.1221C1605.5236,-3726.0918 2104.6731,-3912.327 2179.7498,-4054.0016 2242.423,-4172.2701 2194.9943,-6330.7724 2215.7498,-6463.0016 2231.6394,-6564.2318 2275.2451,-6679.5176 2293.7306,-6725.5015"/>
<polygon fill="#ff004c" stroke="#ff004c" points="2290.5612,-6726.9994 2297.5681,-6734.9463 2297.0464,-6724.3643 2290.5612,-6726.9994"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge77" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1450.1649,-3656.7792C1467.9676,-3630.0861 1514.2788,-3560.7255 1553.2698,-3503.0016 1624.8954,-3396.964 1653.7782,-3377.2093 1715.2896,-3265.0016 1803.6285,-3103.8556 1820.023,-3059.2902 1878.2922,-2885.0016 1944.4501,-2687.1173 1955.9961,-2634.8763 1989.9177,-2429.0016 2004.9672,-2337.6646 1970.0697,-2087.8253 2025.9177,-2014.0016 2054.4982,-1976.222 2378.0352,-1871.5298 2424.6335,-1863.0016 2481.5937,-1852.577 2505.36,-1833.057 2554.9226,-1863.0016 2713.4923,-1958.8059 2693.943,-2055.0532 2748.8254,-2232.0016 2802.5697,-2405.2804 2845.8779,-2994.8731 2854.2405,-3114.6617"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2850.7571,-3115.0236 2854.9399,-3124.7578 2857.7404,-3114.5398 2850.7571,-3115.0236"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge249" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1515.8872,-3670.5465C1624.0247,-3676.6827 1830.8182,-3697.6128 1989.9177,-3769.0016 2008.4111,-3777.2997 2007.9549,-3787.61 2025.9177,-3797.0016 2057.6524,-3813.5936 2070.7984,-3804.9979 2102.8337,-3821.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2102.8337,-3821.0016C2137.1663,-3831.183 2146.1355,-3832.654 2179.7498,-3845.0016 2210.3707,-3856.2497 2244.4768,-3870.9161 2268.8999,-3881.8042"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2267.5267,-3885.0242 2278.0833,-3885.9237 2270.3917,-3878.6374 2267.5267,-3885.0242"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge417" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2855.7019,-2221.0016C2975.2785,-2601.6864 2909.2475,-2717.355 2926.5784,-3116.0016 2948.6624,-3623.982 2910.4897,-7186.2166 2962.5784,-7692.0016 2978.723,-7848.7669 3025.4113,-8033.555 3041.6914,-8094.9829"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3038.4004,-8096.225 3044.3631,-8104.9827 3045.1632,-8094.4181 3038.4004,-8096.225"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2669.874,-1649.0016C2704.6404,-1660.6787 2724.2548,-1645.7741 2748.8254,-1673.0016 2915.0714,-1857.2241 2781.3397,-1984.2615 2855.7019,-2221.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1444.2255,-3656.6523C1452.5211,-3597.2181 1493.7013,-3322.3806 1553.2698,-3265.0016 1606.5392,-3213.6901 1666.3725,-3282.4779 1715.2896,-3227.0016 1765.8317,-3169.6824 1723.5234,-2956.1988 1751.2896,-2885.0016 1785.686,-2796.803 1842.9815,-2801.8382 1878.2922,-2714.0016 1925.9135,-2595.5421 1840.5873,-2533.2515 1914.2922,-2429.0016 1936.0076,-2398.2868 1968.9171,-2422.2095 1989.9177,-2391.0016 2046.1725,-2307.4044 1960.9284,-2016.0047 2025.9177,-1939.0016 2071.4096,-1885.1002 2117.1745,-1932.5472 2179.7498,-1900.0016 2198.4822,-1890.2588 2198.1,-1880.5909 2215.7498,-1869.0016 2403.2179,-1745.9051 2457.2753,-1577.5954 2669.874,-1649.0016"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge388" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1634.2797,-3517.0016C1753.5416,-3426.1074 1788.5326,-3404.1198 1878.2922,-3284.0016 1899.2337,-3255.9774 1896.5428,-3244.1489 1914.2922,-3214.0016 1959.5868,-3137.069 1956.0005,-3102.5156 2025.9177,-3047.0016 2083.1414,-3001.5663 2111.4571,-3014.983 2179.7498,-2989.0016 2288.711,-2947.5483 2313.5066,-2930.2397 2424.6335,-2895.0016 2478.2167,-2878.0105 2640.6497,-2784.983 2669.874,-2833.0016"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge365" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1451.2086,-3679.0462C1533.2046,-3785.2816 2179.1014,-4622.1491 2179.7498,-4624.0016 2219.6726,-4738.0668 2203.1029,-6678.8153 2215.7498,-6799.0016 2233.0018,-6962.9525 2280.471,-7156.6584 2296.6815,-7219.8971"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2293.3605,-7221.0353 2299.2501,-7229.8423 2300.1381,-7219.2848 2293.3605,-7221.0353"/>
</g>
<!-- sourcefile~dataairloop.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node27" class="node">
<title>sourcefile~dataairloop.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node27"><a xlink:href="../sourcefile/dataairloop.f90.html" xlink:title="DataAirLoop.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2146.7178,-5355.007 2058.9496,-5355.007 2058.9496,-5332.9962 2146.7178,-5332.9962 2146.7178,-5355.007"/>
<text text-anchor="middle" x="2102.8337" y="-5340.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataAirLoop.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge639" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2146.9029,-5337.1045C2158.7811,-5333.4068 2170.8034,-5327.7268 2179.7498,-5319.0016 2214.166,-5285.4363 2183.9861,-5253.0873 2215.7498,-5217.0016 2305.8477,-5114.6442 2353.4158,-5079.0016 2489.7781,-5079.0016 2489.7781,-5079.0016 2489.7781,-5079.0016 2669.874,-5079.0016 2837.6509,-5079.0016 2975.9985,-4927.1632 3047.3719,-5079.0016"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge53" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff4c00" stroke-dasharray="5,2" d="M2110.408,-5355.3258C2127.0532,-5379.5306 2169.0748,-5437.0236 2215.7498,-5473.0016 2283.7197,-5525.3942 2331.7725,-5494.7231 2388.6335,-5559.0016 2420.4859,-5595.0091 2408.3309,-5615.7762 2424.6335,-5661.0016 2445.0739,-5717.7052 2469.8011,-5784.3789 2482.0817,-5817.3666"/>
<polygon fill="#ff4c00" stroke="#ff4c00" points="2478.8393,-5818.689 2485.6104,-5826.8378 2485.3989,-5816.2451 2478.8393,-5818.689"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge128" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M2107.3131,-5355.0222C2146.3556,-5451.0785 2428.6962,-6145.7218 2481.3387,-6275.2383"/>
<polygon fill="#ffe500" stroke="#ffe500" points="2478.2155,-6276.8496 2485.2234,-6284.7957 2484.7003,-6274.2137 2478.2155,-6276.8496"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge215" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M2124.9412,-5332.9491C2143.344,-5322.3983 2168.3161,-5304.6161 2179.7498,-5281.0016 2230.1631,-5176.8802 2208.9658,-3314.4865 2215.7498,-3199.0016 2235.4948,-2862.8752 2286.9231,-2455.356 2299.4235,-2359.088"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2302.8981,-2359.5094 2300.7208,-2349.1407 2295.9569,-2358.6041 2302.8981,-2359.5094"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge274" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#0cff00" stroke-dasharray="5,2" d="M2302.1917,-4524.0016C2371.1473,-4480.1703 2615.9603,-4462.6063 2669.874,-4524.0016"/>
<path fill="none" stroke="#0cff00" stroke-dasharray="5,2" d="M2146.9475,-5339.0587C2159.4166,-5335.4478 2171.7539,-5329.3255 2179.7498,-5319.0016 2219.6262,-5267.515 2201.1585,-4797.4689 2215.7498,-4734.0016 2238.3641,-4635.6365 2219.7166,-4582.1821 2302.1917,-4524.0016"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge446" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M2302.1917,-4524.0016C2370.3694,-4475.9069 2608.3968,-4543.5937 2669.874,-4600.0016"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge522" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M2147.0546,-5339.1409C2159.5287,-5335.5338 2171.8418,-5329.3931 2179.7498,-5319.0016 2234.2392,-5247.3991 2156.5784,-4577.7863 2215.7498,-4510.0016 2320.2072,-4390.3389 2537.7644,-4418.9542 2628.6176,-4437.3885"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="2628.0388,-4440.8431 2638.5436,-4439.4654 2629.4724,-4433.9915 2628.0388,-4440.8431"/>
</g>
<!-- sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge640" class="edge">
<title>sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3234.2235,-6693.2968C3244.6979,-6881.4348 3382.6918,-9360.0255 3396.9281,-9615.7318"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3393.4454,-9616.1404 3397.4959,-9625.9303 3400.4345,-9615.7512 3393.4454,-9616.1404"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge641" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1247.8813,-2917.0016C1281.7237,-2878.8249 1307.2153,-2883.5393 1332.0981,-2839.0016 1372.3148,-2767.0181 1332.7507,-2731.497 1368.0981,-2657.0016 1375.0196,-2642.4144 1540.3822,-2442.728 1553.2698,-2433.0016 1616.0231,-2385.6408 1670.9163,-2426.9018 1715.2896,-2362.0016 1769.5195,-2282.6851 1734.397,-1592.5883 1751.2896,-1498.0016 1821.2367,-1106.3465 1777.9716,-957.1432 2025.9177,-646.0016 2172.0029,-462.6828 2256.8808,-368.4405 2489.7781,-395.0016"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge54" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff4c00" stroke-dasharray="5,2" d="M1634.2797,-3213.0016C1994.3428,-3183.0923 2183.4932,-3218.5836 2388.6335,-3516.0016 2418.9046,-3559.8895 2419.8677,-5381.9001 2424.6335,-5435.0016 2437.8466,-5582.2226 2472.7677,-5757.0408 2485.2569,-5816.7788"/>
<polygon fill="#ff4c00" stroke="#ff4c00" points="2481.8937,-5817.7932 2487.3803,-5826.8567 2488.7433,-5816.35 2481.8937,-5817.7932"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge94" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M1442.684,-5645.0016C1505.7379,-5704.6722 1554.9922,-5718.3552 1634.2797,-5683.0016"/>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M1071.519,-3077.0801C1077.1603,-3142.4366 1108.238,-3484.14 1163.6646,-3758.0016 1220.2218,-4037.4499 1286.4365,-4095.5677 1332.0981,-4377.0016 1377.8667,-4659.0944 1343.1806,-4734.3084 1368.0981,-5019.0016 1392.5282,-5298.1246 1239.1749,-5452.4126 1442.684,-5645.0016"/>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M1634.2797,-5683.0016C1645.832,-5677.8505 1710.5175,-5661.481 1759.1792,-5649.5049"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="1760.1088,-5652.8807 1768.9859,-5647.0973 1758.4397,-5646.0825 1760.1088,-5652.8807"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge129" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M1120.5127,-3077.0605C1123.0499,-3078.5101 1125.4573,-3080.1489 1127.6646,-3082.0016 1155.9851,-3105.7725 1146.8332,-3124.0803 1163.6646,-3157.0016 1199.3538,-3226.808 1189.4679,-3259.7089 1247.8813,-3312.0016"/>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M1247.8813,-3312.0016C1302.4125,-3360.8189 1808.6167,-3480.5941 1878.2922,-3503.0016 1928.183,-3519.0464 1941.3745,-3521.2513 1989.9177,-3541.0016 2171.7432,-3614.9793 2282.4547,-3565.8979 2388.6335,-3731.0016 2420.5966,-3780.7028 2419.7766,-5799.1098 2424.6335,-5858.0016 2437.9564,-6019.5436 2473.5222,-6212.0953 2485.6555,-6275.0018"/>
<polygon fill="#ffe500" stroke="#ffe500" points="2482.2347,-6275.7469 2487.5777,-6284.8959 2489.1063,-6274.4119 2482.2347,-6275.7469"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge204" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1442.684,-2837.0016C1495.5,-2801.9857 1503.5284,-2786.2628 1553.2698,-2747.0016 1624.4471,-2690.8208 1667.478,-2700.0507 1715.2896,-2623.0016 1759.2258,-2552.1976 1697.5233,-2502.6632 1751.2896,-2439.0016 1790.2246,-2392.9008 1836.2274,-2434.2656 1878.2922,-2391.0016 1912.3896,-2355.9322 1879.4377,-2321.3186 1914.2922,-2287.0016 1977.1494,-2225.1139 2029.0922,-2176.5939 2102.8337,-2225.0016"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge275" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#0cff00" stroke-dasharray="5,2" d="M1634.2797,-2909.0016C1807.7274,-2835.6612 1752.9751,-2688.1598 1914.2922,-2591.0016 2139.6052,-2455.3001 2250.7963,-2343.1447 2489.7781,-2453.0016"/>
<path fill="none" stroke="#0cff00" stroke-dasharray="5,2" d="M1247.8813,-2917.0016C1276.1443,-2884.6713 1592.8758,-2920.3929 1634.2797,-2909.0016"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge428" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M1247.8813,-2917.0016C1273.4497,-2887.6585 1301.9998,-2917.6765 1332.0981,-2893.0016 1359.1529,-2870.8219 1348.0682,-2851.6844 1368.0981,-2823.0016 1424.1356,-2742.7564 1460.26,-2740.559 1517.2698,-2661.0016 1536.7322,-2633.8417 1533.2512,-2621.7542 1553.2698,-2595.0016 1614.278,-2513.4709 1671.9653,-2525.1552 1715.2896,-2433.0016 1788.2195,-2277.8748 1709.2124,-2215.1721 1751.2896,-2049.0016 1872.4716,-1570.4315 1816.1933,-1329.9483 2215.7498,-1040.0016 2423.2859,-889.3986 2529.2794,-966.1851 2784.8254,-945.0016 2813.8978,-942.5917 3035.4271,-919.3871 3047.3719,-946.0016"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge474" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M1634.2797,-3213.0016C1847.4994,-3163.3267 1895.6528,-2990.2462 2102.8337,-3061.0016"/>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M1111.3688,-3077.0459C1238.6505,-3111.4591 1620.8709,-3214.3821 1634.2797,-3213.0016"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge523" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1127.854,-3056.9325C1388.043,-3016.073 2447.8958,-2853.458 2489.7781,-2909.0016"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge542" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1071.237,-3077.0445C1076.2862,-3162.5146 1109.3179,-3727.474 1127.6646,-4187.0016 1138.6975,-4463.3416 1123.7842,-5157.3319 1163.6646,-5431.0016 1176.3827,-5518.2773 1313.5425,-6128.7018 1368.0981,-6198.0016 1414.7638,-6257.279 1468.3051,-6221.6086 1517.2698,-6279.0016 1548.4716,-6315.5742 1525.1592,-6342.0028 1553.2698,-6381.0016 1567.1094,-6400.2019 1588.3999,-6416.4399 1605.6818,-6427.6197"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="1603.9565,-6430.6686 1614.293,-6432.9939 1607.6626,-6424.7302 1603.9565,-6430.6686"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge557" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M1070.8455,-3077.1082C1072.8194,-3151.8331 1087.4003,-3581.3579 1163.6646,-3682.0016 1213.2655,-3747.4585 1277.6272,-3696.538 1332.0981,-3758.0016 1367.6199,-3798.0834 1346.8964,-3823.82 1368.0981,-3873.0016 1506.0419,-4192.9893 1516.5266,-4299.5003 1751.2896,-4557.0016 1790.2306,-4599.7143 2152.4773,-4801.0409 2179.7498,-4852.0016 2242.9054,-4970.0131 2172.1423,-7134.4562 2215.7498,-7261.0016 2229.0962,-7299.7318 2261.1247,-7335.8752 2282.2235,-7356.6894"/>
<polygon fill="#ff0098" stroke="#ff0098" points="2280.0783,-7359.4821 2289.713,-7363.8894 2284.9297,-7354.4358 2280.0783,-7359.4821"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge596" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M1072.3435,-3077.1789C1079.4485,-3120.5413 1108.3108,-3281.2173 1163.6646,-3402.0016 1219.7891,-3524.4678 1277.0061,-3531.0675 1332.0981,-3654.0016 1358.1961,-3712.2373 1334.2584,-3738.8964 1368.0981,-3793.0016 1425.4658,-3884.7249 1469.2554,-3882.8416 1553.2698,-3951.0016 1570.334,-3964.8456 2169.8791,-4414.3696 2179.7498,-4434.0016 2230.3929,-4534.7268 2198.1117,-6351.6499 2215.7498,-6463.0016 2231.781,-6564.2095 2275.3077,-6679.5077 2293.7513,-6725.4982"/>
<polygon fill="#ff004c" stroke="#ff004c" points="2290.5799,-6726.9914 2297.5798,-6734.9445 2297.0673,-6724.362 2290.5799,-6726.9914"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge62" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1634.2797,-2609.0016C1655.533,-2578.0437 1690.1604,-2612.9054 1715.2896,-2585.0016 1773.9742,-2519.8373 1717.4353,-2471.8976 1751.2896,-2391.0016 1822.8411,-2220.0266 1917.961,-2219.8065 1989.9177,-2049.0016 2023.1158,-1970.1988 1961.1448,-1915.827 2025.9177,-1860.0016 2269.438,-1650.1205 2535.9212,-1644.1199 2748.8254,-1885.0016 2759.4756,-1897.0513 2841.3765,-2950.8 2854.0554,-3114.684"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2850.5862,-3115.2188 2854.8467,-3124.9192 2857.5653,-3114.6791 2850.5862,-3115.2188"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge184" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1107.8226,-3054.9283C1115.1207,-3051.4059 1122.197,-3046.8498 1127.6646,-3041.0016 1159.9243,-3006.4963 1129.148,-2973.2494 1163.6646,-2941.0016 1192.1038,-2914.4316 1222.2658,-2946.3035 1247.8813,-2917.0016"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1247.8813,-2917.0016C1286.1244,-2873.2551 1310.9413,-2871.1189 1332.0981,-2817.0016 1364.1729,-2734.9576 1315.0394,-2095.3207 1368.0981,-2025.0016 1371.3062,-2020.7499 1375.2679,-2017.2135 1379.679,-2014.273"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1381.5776,-2017.2227 1388.6361,-2009.3215 1378.191,-2011.0964 1381.5776,-2017.2227"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge170" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1075.4198,-3054.6786C1086.9757,-3027.0114 1116.083,-2953.5142 1127.6646,-2889.0016 1160.3255,-2707.0702 1094.8118,-2229.539 1163.6646,-2058.0016 1176.5848,-2025.8124 1205.1653,-1997.1136 1225.4403,-1979.6604"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1227.8544,-1982.2044 1233.285,-1973.1072 1223.3666,-1976.8322 1227.8544,-1982.2044"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge250" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1247.8813,-3312.0016C1281.391,-3344.2102 1298.2231,-3342.1775 1332.0981,-3374.0016 1350.2638,-3391.0675 1346.9581,-3403.798 1368.0981,-3417.0016 1502.9307,-3501.2149 1572.2785,-3433.5789 1715.2896,-3503.0016 1733.5244,-3511.8535 1734.7531,-3519.2794 1751.2896,-3531.0016 1936.0854,-3661.9976 1993.1906,-3678.5293 2179.7498,-3807.0016 2215.1635,-3831.389 2255.1142,-3861.2035 2279.4704,-3879.6497"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2277.6203,-3882.6396 2287.7009,-3885.9002 2281.8539,-3877.0649 2277.6203,-3882.6396"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge222" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1076.8042,-3054.8768C1091.6275,-3028.4242 1130.2846,-2959.7379 1163.6646,-2903.0016 1188.7679,-2860.3332 1219.02,-2810.86 1235.5717,-2783.9519"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1238.751,-2785.4638 1241.0149,-2775.1137 1232.7907,-2781.793 1238.751,-2785.4638"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge418" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1442.684,-2837.0016C1464.1731,-2822.7548 1533.2385,-2649.2344 1553.2698,-2633.0016 1582.4441,-2609.3594 1613.7129,-2640.4198 1634.2797,-2609.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1634.2797,-2609.0016C1659.1118,-2571.0676 1693.0775,-2586.5269 1715.2896,-2547.0016 1789.0846,-2415.6864 1694.4178,-2349.4828 1751.2896,-2210.0016 1785.6999,-2125.6083 1829.4745,-2125.9636 1878.2922,-2049.0016 1957.0363,-1924.8602 1925.3641,-1860.2429 2025.9177,-1753.0016 2166.1521,-1603.4404 2228.2483,-1579.8835 2424.6335,-1521.0016 2516.533,-1493.4475 2798.7735,-1419.7754 2855.7019,-1497.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1247.8813,-2917.0016C1273.4497,-2887.6585 1297.6881,-2911.187 1332.0981,-2893.0016 1350.5121,-2883.27 1349.9731,-2873.2612 1368.0981,-2863.0016 1398.6489,-2845.7085 1413.4246,-2856.3999 1442.684,-2837.0016"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge389" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2669.874,-2833.0016C2766.4707,-2983.0438 2779.7894,-5864.625 2784.8254,-6043.0016 2808.7684,-6891.0583 2848.6706,-7933.9044 2854.8792,-8094.7555"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2851.3836,-8094.9405 2855.2673,-8104.7979 2858.3784,-8094.6701 2851.3836,-8094.9405"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1634.2797,-2909.0016C1783.849,-2872.4329 1783.7253,-2786.6137 1914.2922,-2705.0016 1994.7254,-2654.7261 2007.9806,-2605.0016 2102.8337,-2605.0016 2102.8337,-2605.0016 2102.8337,-2605.0016 2302.1917,-2605.0016 2494.4745,-2605.0016 2565.7881,-2671.3265 2669.874,-2833.0016"/>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge642" class="edge">
<title>sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2748.9413,-5790.5615C2782.447,-5788.9666 2821.5581,-5790.3271 2855.7019,-5800.0016"/>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge81" class="edge">
<title>sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ff7200" stroke-dasharray="5,2" d="M2855.7019,-4773.0016C2860.0592,-4740.6811 2905.7763,-4779.1188 2926.5784,-4754.0016 3033.4372,-4624.9759 3046.0052,-3338.4856 3047.2483,-3157.1924"/>
<polygon fill="#ff7200" stroke="#ff7200" points="3050.7489,-3157.0978 3047.3135,-3147.0755 3043.7491,-3157.0527 3050.7489,-3157.0978"/>
<path fill="none" stroke="#ff7200" stroke-dasharray="5,2" d="M2672.2718,-5788.9218C2689.7773,-5707.6526 2798.8109,-5194.9895 2855.7019,-4773.0016"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge643" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M772.5441,-4872.9293C788.1366,-4861.9004 810.0064,-4843.4074 819.7932,-4821.0016 883.2353,-4675.7579 811.0859,-3547.0605 855.7932,-3395.0016 870.4686,-3345.0875 891.9605,-3340.7989 916.6465,-3295.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M916.6465,-3295.0016C934.9667,-3261.014 956.5173,-3265.4134 977.4998,-3233.0016 1001.3609,-3196.1431 983.6535,-3173.2057 1013.4998,-3141.0016 1051.7839,-3099.6931 1087.2086,-3125.1856 1127.6646,-3086.0016 1152.5106,-3061.9367 1139.0985,-3041.3523 1163.6646,-3017.0016 1223.3599,-2957.8296 1265.4419,-2982.2052 1332.0981,-2931.0016 1351.0655,-2916.4314 1347.7076,-2903.5027 1368.0981,-2891.0016 1426.6166,-2855.125 1469.5949,-2900.3842 1517.2698,-2851.0016 1566.6914,-2799.8097 1507.9926,-2749.8933 1553.2698,-2695.0016 1603.4105,-2634.2136 1665.1913,-2683.8246 1715.2896,-2623.0016 1760.8037,-2567.744 1734.3265,-2535.5515 1751.2896,-2466.0016 1866.8099,-1992.3594 1808.5442,-1840.3852 2025.9177,-1404.0016 2086.4009,-1282.58 2127.3524,-1267.8964 2215.7498,-1165.0016 2304.6676,-1061.501 2315.7347,-1022.2196 2424.6335,-940.0016 2548.5632,-846.4354 2931.3066,-519.8414 3047.3719,-623.0016"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M788.543,-4886.0579C832.2739,-4889.1364 911.1614,-4896.0209 977.4998,-4909.0016 1237.6895,-4959.9142 1292.527,-5017.0018 1553.2698,-5065.0016 1640.4576,-5081.0519 1662.7979,-5083.6586 1751.2896,-5089.0016 1807.6326,-5092.4036 1822.0943,-5094.284 1878.2922,-5089.0016 1911.5362,-5085.8768 1918.7164,-5074.6369 1952.105,-5075.0016"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge55" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff4c00" stroke-dasharray="5,2" d="M916.6465,-4429.0016C1024.1105,-4326.9765 1107.1165,-4437.2931 1247.8813,-4391.0016"/>
<path fill="none" stroke="#ff4c00" stroke-dasharray="5,2" d="M1247.8813,-4391.0016C1426.5639,-4351.9874 1824.1542,-3957.7227 1989.9177,-4035.0016 2239.7309,-4151.4645 2289.3214,-4252.8882 2388.6335,-4510.0016 2425.6938,-4605.9485 2414.408,-5332.6556 2424.6335,-5435.0016 2439.3286,-5582.0821 2473.3169,-5756.9888 2485.4096,-5816.7643"/>
<polygon fill="#ff4c00" stroke="#ff4c00" points="2482.0381,-5817.7487 2487.4638,-5826.8488 2488.8973,-5816.3514 2482.0381,-5817.7487"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge83" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ff7200" stroke-dasharray="5,2" d="M916.6465,-3105.0016C939.0715,-3050.5933 1084.8254,-2985.3494 1127.6646,-2945.0016 1145.5617,-2928.1453 1143.5505,-2917.1391 1163.6646,-2903.0016 1229.1814,-2856.9521 1280.2873,-2900.0643 1332.0981,-2839.0016 1384.3176,-2777.4574 1327.3162,-2730.6536 1368.0981,-2661.0016 1470.9928,-2485.2664 1620.087,-2542.0202 1715.2896,-2362.0016 1781.5783,-2236.6562 1717.4035,-2182.6875 1751.2896,-2045.0016 1832.0467,-1716.8687 1764.0352,-1549.5677 2025.9177,-1336.0016 2151.3342,-1233.7241 2227.5238,-1288.7166 2388.6335,-1304.0016 2630.975,-1326.9933 2765.0271,-1224.905 2926.5784,-1407.0016 2986.2048,-1474.2111 3039.727,-2921.3518 3046.6227,-3114.7163"/>
<polygon fill="#ff7200" stroke="#ff7200" points="3043.1342,-3115.105 3046.9866,-3124.9746 3050.1298,-3114.8567 3043.1342,-3115.105"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge97" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M916.6465,-5683.0016C949.1816,-5731.7411 1400.2965,-5604.5372 1442.684,-5645.0016"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge130" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M1247.8813,-4391.0016C1660.0529,-4336.7597 1863.6942,-4039.9341 2179.7498,-4310.0016 2218.7463,-4343.3239 2206.9465,-4487.4683 2215.7498,-4538.0016 2286.1783,-4942.2816 2332.3248,-5038.5144 2388.6335,-5445.0016 2413.9156,-5627.5104 2403.0707,-5675.0161 2424.6335,-5858.0016 2443.6029,-6018.9783 2475.5144,-6211.8958 2486.1826,-6274.949"/>
<polygon fill="#ffe500" stroke="#ffe500" points="2482.742,-6275.5942 2487.8671,-6284.8669 2489.6432,-6274.422 2482.742,-6275.5942"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge140" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#f2ff00" stroke-dasharray="5,2" d="M788.7928,-4889.1768C800.5248,-4892.7502 812.5536,-4898.7907 819.7932,-4909.0016 856.3781,-4960.602 845.71,-5984.5566 855.7932,-6047.0016 886.0939,-6234.6522 926.7762,-6273.8132 977.4998,-6457.0016 994.644,-6518.9183 995.344,-6535.3739 1013.4998,-6597.0016 1058.9035,-6751.1196 1097.4268,-6782.2058 1127.6646,-6940.0016 1153.9305,-7077.0705 1102.0828,-7441.76 1163.6646,-7567.0016 1207.3781,-7655.9039 1285.3556,-7625.6538 1332.0981,-7713.0016 1392.1291,-7825.1815 1292.1498,-7894.9237 1368.0981,-7997.0016 1479.3144,-8146.4812 1578.9265,-8096.2613 1751.2896,-8167.0016 1807.1135,-8189.9126 1841.8452,-8166.9097 1878.2922,-8215.0016 1933.5353,-8287.895 1857.8457,-8553.0362 1914.2922,-8625.0016 1946.1377,-8665.6024 2005.0968,-8680.2677 2048.6363,-8685.4432"/>
<polygon fill="#f2ff00" stroke="#f2ff00" points="2048.4767,-8688.9457 2058.7886,-8686.5135 2049.2106,-8681.9843 2048.4767,-8688.9457"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge209" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M916.6465,-3295.0016C958.339,-3226.2235 1468.4015,-2954.8811 1517.2698,-2891.0016 1547.5003,-2851.4849 1521.0235,-2822.8914 1553.2698,-2785.0016 1606.1069,-2722.9175 1658.0183,-2757.0206 1715.2896,-2699.0016 1739.8662,-2674.1041 1731.7664,-2658.0317 1751.2896,-2629.0016 1813.3798,-2536.6759 1826.8706,-2507.8252 1914.2922,-2439.0016 2012.4775,-2361.7043 2163.7758,-2343.152 2245.3658,-2338.9642"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2245.6132,-2342.4567 2255.4424,-2338.5023 2245.2926,-2335.464 2245.6132,-2342.4567"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge277" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#0cff00" stroke-dasharray="5,2" d="M916.6465,-3447.0016C946.3865,-3413.1173 1682.4883,-3333.932 1715.2896,-3303.0016 1762.6587,-3258.3342 1707.9261,-3209.5673 1751.2896,-3161.0016 1791.4792,-3115.9904 1840.6042,-3160.1274 1878.2922,-3113.0016 1950.0533,-3023.2702 1842.7612,-2946.9165 1914.2922,-2857.0016 1970.2763,-2786.6294 2613.6867,-2496.7916 2669.874,-2567.0016"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge283" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#00ff19" stroke-dasharray="5,2" d="M788.8367,-4889.4955C800.4271,-4893.1065 812.3484,-4899.0895 819.7932,-4909.0016 875.3858,-4983.0178 844.0483,-5232.1812 855.7932,-5324.0016 876.3261,-5484.5253 826.873,-5548.3533 916.6465,-5683.0016"/>
<path fill="none" stroke="#00ff19" stroke-dasharray="5,2" d="M916.6465,-5683.0016C924.3737,-5694.5914 1149.8164,-5641.5055 1163.6646,-5640.0016 1479.5984,-5605.6923 1578.1762,-5511.4947 1878.2922,-5616.0016 1957.3547,-5643.5329 1952.1374,-5693.4375 2025.9177,-5733.0016 2033.4776,-5737.0555 2041.8098,-5740.5984 2050.1151,-5743.6432"/>
<polygon fill="#00ff19" stroke="#00ff19" points="2049.2098,-5747.0333 2059.8045,-5746.9895 2051.4949,-5740.4168 2049.2098,-5747.0333"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge293" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M788.5148,-4889.0318C800.3613,-4892.5863 812.5419,-4898.6517 819.7932,-4909.0016 876.0056,-4989.2343 843.3547,-6574.8296 855.7932,-6672.0016 894.141,-6971.5808 926.7112,-7043.7163 1013.4998,-7333.0016 1056.1704,-7475.2321 1087.619,-7504.0098 1127.6646,-7647.0016 1149.6661,-7725.5633 1139.2125,-7749.1678 1163.6646,-7827.0016 1228.5556,-8033.5573 1448.5891,-8530.481 1553.2698,-8720.0016 1634.726,-8867.4751 1757.3564,-9029.9295 1799.7467,-9084.7452"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1797.1629,-9087.1245 1806.0594,-9092.8781 1802.6926,-9082.8324 1797.1629,-9087.1245"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge309" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ffb2" stroke-dasharray="5,2" d="M788.838,-4889.1448C800.5756,-4892.7143 812.5964,-4898.7605 819.7932,-4909.0016 869.2533,-4979.3842 841.5152,-6372.1716 855.7932,-6457.0016 921.4852,-6847.2965 1049.3723,-6917.0379 1127.6646,-7305.0016 1163.6744,-7483.4423 1093.7883,-7544.9091 1163.6646,-7713.0016 1208.2731,-7820.3107 1284.6732,-7806.9072 1332.0981,-7913.0016 1378.6275,-8017.0925 1295.1632,-8079.3638 1368.0981,-8167.0016 1372.5003,-8172.2912 1378.0594,-8176.4671 1384.1492,-8179.7627"/>
<polygon fill="#00ffb2" stroke="#00ffb2" points="1382.8291,-8183.0077 1393.3784,-8183.9885 1385.7433,-8176.6431 1382.8291,-8183.0077"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge318" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M788.7732,-4889.9148C800.2136,-4893.5704 812.0512,-4899.4744 819.7932,-4909.0016 882.0006,-4985.5524 831.5893,-5032.3776 855.7932,-5128.0016 870.3248,-5185.4126 895.2167,-5250.7741 908.2027,-5283.315"/>
<polygon fill="#00ffff" stroke="#00ffff" points="904.99,-5284.7068 911.9724,-5292.6753 911.4832,-5282.0917 904.99,-5284.7068"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge327" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00d8ff" stroke-dasharray="5,2" d="M755.587,-4872.5585C762.2357,-4705.0763 839.9435,-2753.643 855.7932,-2635.0016 888.4854,-2390.2883 943.3407,-2337.5145 977.4998,-2093.0016 997.0244,-1953.243 961.4811,-1590.1799 1013.4998,-1459.0016 1021.1694,-1439.6607 1036.6213,-1421.8102 1049.5163,-1409.2557"/>
<polygon fill="#00d8ff" stroke="#00d8ff" points="1052.1996,-1411.5389 1057.1223,-1402.1571 1047.4235,-1406.4214 1052.1996,-1411.5389"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge337" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00b2ff" stroke-dasharray="5,2" d="M916.6465,-5683.0016C1075.6386,-5900.3202 1337.9998,-6101.3273 1418.4687,-6160.4954"/>
<polygon fill="#00b2ff" stroke="#00b2ff" points="1416.8083,-6163.6173 1426.9456,-6166.6972 1420.9415,-6157.9678 1416.8083,-6163.6173"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge345" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M1247.8813,-3668.0016C1283.5414,-3658.3708 1324.2313,-3656.9577 1359.1685,-3658.5034"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1359.1649,-3662.008 1369.3362,-3659.0425 1359.5356,-3655.0178 1359.1649,-3662.008"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge433" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M916.6465,-3295.0016C919.8181,-3289.7696 1710.4169,-2926.7016 1715.2896,-2923.0016 1970.7474,-2729.024 1930.1837,-2549.077 2215.7498,-2403.0016 2286.4361,-2366.8435 2325.0683,-2405.577 2388.6335,-2358.0016 2413.5308,-2339.3673 2401.8594,-2319.1782 2424.6335,-2298.0016 2512.7942,-2216.0252 2549.4895,-2183.0016 2669.874,-2183.0016 2669.874,-2183.0016 2669.874,-2183.0016 2855.7019,-2183.0016 3311.7403,-2183.0016 3030.2025,-2307.3679 3132.1655,-3116.0016 3226.2164,-3861.8868 3233.1029,-6400.0156 3233.5635,-6660.3864"/>
<polygon fill="#0019ff" stroke="#0019ff" points="3230.064,-6660.7684 3233.5805,-6670.7627 3237.064,-6660.7569 3230.064,-6660.7684"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge449" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0c00ff" stroke-dasharray="5,2" d="M772.5537,-4872.9334C788.1529,-4861.9076 810.0273,-4843.4166 819.7932,-4821.0016 888.1575,-4664.0897 789.1856,-3438.6672 855.7932,-3281.0016 870.8189,-3245.4345 900.0711,-3253.8735 916.6465,-3219.0016"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge475" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M1070.5822,-4201.0016C1298.9256,-3994.8306 1444.1718,-4094.406 1715.2896,-3949.0016 1863.9254,-3869.2861 1865.0882,-3781.8056 2025.9177,-3731.0016 2179.6376,-3682.4435 2273.2791,-3618.3914 2388.6335,-3731.0016 2448.0826,-3789.0364 2398.1848,-5147.2445 2424.6335,-5226.0016 2456.1883,-5319.963 2511.432,-5317.9342 2554.9226,-5407.0016 2620.1219,-5540.5277 2655.4866,-5718.0142 2666.2693,-5778.6505"/>
<polygon fill="#3200ff" stroke="#3200ff" points="2662.886,-5779.6236 2668.0492,-5788.8752 2669.7823,-5778.4231 2662.886,-5779.6236"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge524" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M916.6465,-3782.0016C1001.6832,-3677.0262 1387.5367,-3725.69 1517.2698,-3688.0016 1908.8399,-3574.2476 1969.1881,-3448.3222 2302.1917,-3213.0016"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge533" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#a500ff" stroke-dasharray="5,2" d="M788.7172,-4889.2308C800.4399,-4892.8108 812.4822,-4898.8417 819.7932,-4909.0016 870.9868,-4980.1436 844.4255,-5610.095 855.7932,-5697.0016 919.7529,-6185.9775 920.8585,-6333.7773 1163.6646,-6763.0016 1227.4689,-6875.7929 1257.5295,-6895.0187 1332.0981,-7001.0016 1466.9277,-7192.6321 1432.7682,-7313.4424 1634.2797,-7433.0016"/>
<path fill="none" stroke="#a500ff" stroke-dasharray="5,2" d="M1814.7909,-7583.0016C1834.375,-7605.3646 1859.2615,-7581.1659 1878.2922,-7604.0016 1952.6953,-7693.2807 1852.3262,-7764.6819 1914.2922,-7863.0016 1916.0546,-7865.7979 1918.2565,-7868.3496 1920.7062,-7870.6616"/>
<polygon fill="#a500ff" stroke="#a500ff" points="1918.5855,-7873.4466 1928.6073,-7876.8839 1922.9165,-7867.9472 1918.5855,-7873.4466"/>
<path fill="none" stroke="#a500ff" stroke-dasharray="5,2" d="M1634.2797,-7433.0016C1671.1845,-7459.3389 1685.5655,-7460.7655 1715.2896,-7495.0016 1736.6853,-7519.6452 1726.5373,-7537.7316 1751.2896,-7559.0016 1774.1727,-7578.6655 1794.9135,-7560.3037 1814.7909,-7583.0016"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge546" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M916.6465,-5683.0016C946.7478,-5725.4362 951.744,-5737.7973 977.4998,-5783.0016 1104.1164,-6005.228 1008.465,-6201.0229 1247.8813,-6291.0016"/>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1247.8813,-6291.0016C1330.1547,-6317.9794 1369.5438,-6246.6635 1442.684,-6293.0016"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge561" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M783.7343,-4872.9946C858.6031,-4844.2843 1055.6115,-4769.4357 1070.5822,-4771.0016"/>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M1070.5822,-4771.0016C1397.3917,-4750.8524 2111.6628,-4849.5395 2179.7498,-4928.0016 2222.2287,-4976.9536 2194.6188,-7199.7297 2215.7498,-7261.0016 2229.1056,-7299.7286 2261.1314,-7335.8729 2282.2271,-7356.6881"/>
<polygon fill="#ff0098" stroke="#ff0098" points="2280.0812,-7359.4803 2289.7154,-7363.8886 2284.9331,-7354.4345 2280.0812,-7359.4803"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge575" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0072" stroke-dasharray="5,2" d="M1070.5822,-4771.0016C1227.9172,-4787.6729 1376.1701,-4928.862 1425.4637,-4980.3284"/>
<polygon fill="#ff0072" stroke="#ff0072" points="1423.0989,-4982.9219 1432.5116,-4987.7853 1428.1863,-4978.1136 1423.0989,-4982.9219"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge597" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M916.6465,-4429.0016C919.0686,-4427.3495 1748.3714,-4556.7176 1751.2896,-4557.0016 1847.2067,-4566.3375 2121.4787,-4547.2439 2179.7498,-4624.0016 2241.5373,-4705.3915 2199.6704,-6362.0884 2215.7498,-6463.0016 2231.8738,-6564.1948 2275.3486,-6679.5012 2293.7649,-6725.4961"/>
<polygon fill="#ff004c" stroke="#ff004c" points="2290.5921,-6726.9862 2297.5875,-6734.9432 2297.081,-6724.3605 2290.5921,-6726.9862"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge65" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M772.4847,-4872.9031C788.0352,-4861.8558 809.8767,-4843.3503 819.7932,-4821.0016 907.9094,-4622.4147 769.9003,-4043.5602 855.7932,-3844.0016 871.0579,-3808.5364 894.7756,-3813.8207 916.6465,-3782.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1247.8813,-3668.0016C1371.0032,-3634.7499 1643.6202,-3440.4918 1715.2896,-3335.0016 1752.8471,-3279.7206 1705.2032,-3237.4022 1751.2896,-3189.0016 1791.9184,-3146.3326 1836.9342,-3192.9642 1878.2922,-3151.0016 1919.475,-3109.2169 1880.2298,-3071.769 1914.2922,-3024.0016 2020.6595,-2874.8375 2416.1213,-2607.8508 2590.9226,-2553.0016 2657.8826,-2531.9909 2694.9127,-2508.0738 2748.8254,-2553.0016 2837.4125,-2626.825 2852.8044,-3018.2464 2855.2639,-3114.5721"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2851.7652,-3114.6728 2855.499,-3124.5879 2858.7633,-3114.5085 2851.7652,-3114.6728"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M916.6465,-3782.0016C1004.8367,-3653.6973 1093.4651,-3687.88 1247.8813,-3668.0016"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge155" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M916.6465,-3105.0016C931.0817,-3069.1908 954.7062,-3074.1664 977.4998,-3043.0016 997.6872,-3015.4 991.1386,-3000.8737 1013.4998,-2975.0016 1067.5977,-2912.4097 1092.716,-2907.5533 1163.6646,-2865.0016 1234.9006,-2822.2775 1281.4726,-2849.8574 1332.0981,-2784.0016 1384.2134,-2716.2078 1339.4315,-2675.5635 1368.0981,-2595.0016 1391.4707,-2529.3177 1391.3077,-2504.1305 1442.684,-2457.0016"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge187" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M755.426,-4872.8795C759.2895,-4727.622 800.9711,-3205.2774 855.7932,-3015.0016 886.6223,-2908.0004 937.8966,-2900.0751 977.4998,-2796.0016 1003.577,-2727.473 971.1895,-2694.8852 1013.4998,-2635.0016 1109.974,-2498.4574 1244.8681,-2577.6288 1332.0981,-2435.0016 1379.8183,-2356.9758 1311.4825,-2096.8341 1368.0981,-2025.0016 1371.3951,-2020.8185 1375.4186,-2017.3297 1379.8707,-2014.4208"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1381.7753,-2017.3689 1388.8823,-2009.5113 1378.4264,-2011.2219 1381.7753,-2017.3689"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge172" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M755.5593,-4872.9723C761.5247,-4718.9861 828.5348,-3002.7674 855.7932,-2901.0016 886.5323,-2786.2411 943.4862,-2776.8346 977.4998,-2663.0016 1019.9918,-2520.7938 952.1584,-2466.1529 1013.4998,-2331.0016 1044.4604,-2262.7871 1092.3697,-2273.0777 1127.6646,-2207.0016 1159.7631,-2146.9094 1132.29,-2118.4749 1163.6646,-2058.0016 1179.7278,-2027.0403 1207.8539,-1997.8772 1227.1498,-1979.9952"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1229.5092,-1982.5804 1234.5679,-1973.2713 1224.8081,-1977.3939 1229.5092,-1982.5804"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge251" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M916.6465,-4429.0016C1103.4041,-4303.9075 1167.0045,-4301.4421 1368.0981,-4201.0016 1594.351,-4087.9948 1680.27,-4106.3169 1878.2922,-3949.0016 1918.798,-3916.8225 1902.7599,-3874.5348 1952.105,-3859.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1952.105,-3859.0016C2060.8455,-3822.9625 2197.9619,-3860.0404 2263.6555,-3882.5067"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2262.5996,-3885.8452 2273.1944,-3885.8392 2264.9083,-3879.2369 2262.5996,-3885.8452"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge224" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M916.6465,-3105.0016C931.0817,-3069.1908 959.6459,-3077.2365 977.4998,-3043.0016 1017.646,-2966.0207 953.8249,-2914.0626 1013.4998,-2851.0016 1031.4543,-2832.0283 1050.3658,-2853.544 1070.5822,-2837.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.4757,-4872.762C759.7161,-4735.0028 802.8131,-3374.3057 855.7932,-3205.0016 871.3309,-3155.3491 897.1955,-3153.2556 916.6465,-3105.0016"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge419" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M916.6465,-3447.0016C934.6629,-3424.1835 951.7365,-3436.4743 977.4998,-3423.0016 994.54,-3414.0905 995.8381,-3406.6071 1013.4998,-3399.0016 1160.9762,-3335.4952 1598.7788,-3337.4897 1715.2896,-3227.0016 1753.8435,-3190.4406 1730.9093,-3162.0705 1751.2896,-3113.0016 1811.2995,-2968.5176 1817.0187,-2923.536 1914.2922,-2801.0016 1980.4736,-2717.6338 2385.2456,-2378.7677 2590.9226,-2283.0016 2645.7066,-2257.4934 2837.5922,-2163.3475 2855.7019,-2221.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M772.4983,-4872.9091C788.0584,-4861.8661 809.9064,-4843.3635 819.7932,-4821.0016 867.1319,-4713.9313 842.8529,-3884.3526 855.7932,-3768.0016 871.8439,-3623.6838 824.522,-3559.2439 916.6465,-3447.0016"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge390" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1070.5822,-4201.0016C1121.2067,-4145.0406 1105.7368,-4107.3634 1163.6646,-4059.0016 1482.85,-3792.5256 1617.7277,-3775.1832 2025.9177,-3696.0016 2061.4774,-3689.1037 2379.2215,-3689.2957 2388.6335,-3697.0016 2459.3862,-3754.9295 2543.7267,-4412.2479 2554.9226,-4503.0016 2560.7503,-4550.2411 2560.6862,-5322.2417 2590.9226,-5359.0016 2636.7766,-5414.7487 2703.048,-5341.1916 2748.8254,-5397.0016 2771.5431,-5424.698 2847.2124,-7842.6154 2855.0452,-8094.8027"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2851.5493,-8094.9927 2855.3578,-8104.8793 2858.546,-8094.7755 2851.5493,-8094.9927"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M916.6465,-4429.0016C1003.4624,-4342.9077 989.6739,-4292.6697 1070.5822,-4201.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M788.6072,-4873.019C800.0296,-4867.7292 811.8982,-4860.2499 819.7932,-4850.0016 878.3795,-4773.9521 848.4818,-4496.5994 916.6465,-4429.0016"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge354" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M916.6465,-4429.0016C927.7413,-4420.8606 1355.0073,-4628.759 1368.0981,-4633.0016 1586.1857,-4703.6816 1651.7198,-4743.9695 1878.2922,-4709.0016 1981.7339,-4693.037 2030.657,-4562.2021 2102.8337,-4638.0016"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge494" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M788.5454,-4894.7959C798.8549,-4898.682 810.0519,-4903.4888 819.7932,-4909.0016 837.434,-4918.985 839.6475,-4924.7469 855.7932,-4937.0016 1020.797,-5062.2406 1040.7316,-5189.0016 1247.8813,-5189.0016 1247.8813,-5189.0016 1247.8813,-5189.0016 1442.684,-5189.0016 1638.2388,-5189.0016 1685.3745,-5159.0084 1878.2922,-5127.0016 1911.2325,-5121.5365 1918.7146,-5112.8909 1952.105,-5113.0016"/>
</g>
<!-- sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge644" class="edge">
<title>sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2855.7019,-3593.0016C2860.3893,-3577.8814 3219.3433,-1338.11 3233.5946,-1345.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2671.178,-4435.7764C2681.7854,-4345.8718 2756.0636,-3742.4456 2855.7019,-3593.0016"/>
</g>
<!-- sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge84" class="edge">
<title>sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ff7200" stroke-dasharray="5,2" d="M2855.7019,-3593.0016C2909.7585,-3418.631 3005.8829,-3219.356 3037.2015,-3156.2544"/>
<polygon fill="#ff7200" stroke="#ff7200" points="3040.4811,-3157.5207 3041.8111,-3147.0097 3034.2166,-3154.3971 3040.4811,-3157.5207"/>
</g>
<!-- sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge276" class="edge">
<title>sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#0cff00" stroke-dasharray="5,2" d="M2688.1497,-4458.092C2705.5577,-4469.3929 2731.593,-4488.3059 2748.8254,-4510.0016 2801.0905,-4575.8036 2835.7497,-4671.3478 2849.2954,-4713.1299"/>
<polygon fill="#0cff00" stroke="#0cff00" points="2845.9914,-4714.2898 2852.3506,-4722.7639 2852.6639,-4712.1737 2845.9914,-4714.2898"/>
</g>
<!-- sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge432" class="edge">
<title>sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M3047.3719,-4811.0016C3071.2564,-4927.5935 3109.4058,-4948.1849 3132.1655,-5065.0016 3195.7254,-5391.2291 3228.3717,-6493.1021 3233.0154,-6660.5865"/>
<polygon fill="#0019ff" stroke="#0019ff" points="3229.5179,-6660.7306 3233.2912,-6670.6307 3236.5153,-6660.5384 3229.5179,-6660.7306"/>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M2855.7019,-3593.0016C3017.9672,-3069.5816 2937.3963,-4274.1553 3047.3719,-4811.0016"/>
</g>
<!-- sourcefile~dxcoil.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge66" class="edge">
<title>sourcefile~dxcoil.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2671.2503,-4435.728C2680.3958,-4361.0123 2733.5936,-3929.4604 2784.8254,-3579.0016 2808.5794,-3416.5093 2841.2823,-3221.1811 2852.081,-3157.3246"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2855.5631,-3157.7241 2853.7825,-3147.2799 2848.6614,-3156.5549 2855.5631,-3157.7241"/>
</g>
<!-- sourcefile~dxcoil.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge391" class="edge">
<title>sourcefile~dxcoil.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2671.0309,-4458.1915C2678.9469,-4535.1544 2725.4994,-4994.1951 2748.8254,-5369.0016 2784.5569,-5943.1419 2847.7613,-7871.7237 2855.0174,-8094.889"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2851.5218,-8095.0857 2855.3447,-8104.9667 2858.5181,-8094.8584 2851.5218,-8095.0857"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge645" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1985.1107,-7899.152C1986.9023,-7900.5805 1988.5323,-7902.1895 1989.9177,-7904.0016 2026.0144,-7951.2131 2012.4701,-8111.1132 2025.9177,-8169.0016 2086.3367,-8429.0893 2120.8472,-8489.4229 2215.7498,-8739.0016 2285.0205,-8921.1727 2335.5476,-8954.4739 2388.6335,-9142.0016 2418.4914,-9247.4753 2389.4954,-9282.1676 2424.6335,-9386.0016 2473.5003,-9530.4037 2459.5707,-9608.6286 2590.9226,-9686.0016 2798.6219,-9808.3472 2893.3451,-9683.7466 3132.1655,-9651.0016 3177.2507,-9644.8199 3199.0338,-9607.397 3233.5946,-9637.0016"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1989.8646,-7878.3191C2022.1449,-7872.2439 2068.6595,-7868.9044 2102.8337,-7889.0016"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge131" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M1963.618,-7876.5424C1977.3406,-7863.4931 2001.4978,-7842.3842 2025.9177,-7830.0016 2141.7253,-7771.2792 2204.6235,-7820.6764 2302.1917,-7735.0016"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge141" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#f2ff00" stroke-dasharray="5,2" d="M1952.2236,-7899.2948C1953.1285,-7961.6959 1960.8498,-8270.2204 2025.9177,-8511.0016 2041.998,-8570.5062 2074.6883,-8635.8949 2091.8114,-8667.981"/>
<polygon fill="#f2ff00" stroke="#f2ff00" points="2088.7575,-8669.6917 2096.5901,-8676.8262 2094.9162,-8666.3644 2088.7575,-8669.6917"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge306" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~dataairsystems.f90</title>
<path fill="none" stroke="#00ff8c" stroke-dasharray="5,2" d="M1952.693,-7876.8692C1956.7597,-7799.3346 1980.8119,-7331.8589 1989.9177,-6951.0016 1993.1153,-6817.2583 1982.6728,-2261.6009 2025.9177,-2135.0016 2037.2013,-2101.969 2063.9618,-2071.152 2082.7309,-2052.4518"/>
<polygon fill="#00ff8c" stroke="#00ff8c" points="2085.4644,-2054.6772 2090.2172,-2045.2082 2080.5968,-2049.6466 2085.4644,-2054.6772"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge477" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M1953.0418,-7899.1655C1956.3362,-7930.4163 1970.4042,-8018.8439 2025.9177,-8055.0016 2161.7378,-8143.4655 2277.9763,-8135.4411 2388.6335,-8017.0016 2614.2749,-7775.4913 2524.2326,-6868.0904 2554.9226,-6539.0016 2575.0342,-6323.3456 2550.3977,-6265.7685 2590.9226,-6053.0016 2607.7836,-5964.4766 2645.0556,-5863.3234 2661.6392,-5820.6775"/>
<polygon fill="#3200ff" stroke="#3200ff" points="2664.8999,-5821.9493 2665.2963,-5811.3619 2658.384,-5819.3913 2664.8999,-5821.9493"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge563" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M2102.8337,-7773.0016C2117.7364,-7740.4394 2154.2522,-7774.1464 2179.7498,-7749.0016 2232.1592,-7697.3173 2283.0866,-7467.6799 2297.8978,-7396.2675"/>
<polygon fill="#ff0098" stroke="#ff0098" points="2301.3787,-7396.7156 2299.9595,-7386.2163 2294.5214,-7395.309 2301.3787,-7396.7156"/>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M1958.2623,-7876.6939C1969.2946,-7857.4812 1994.2652,-7818.4654 2025.9177,-7797.0016 2055.5564,-7776.9035 2087.9311,-7805.5638 2102.8337,-7773.0016"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge599" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M1954.0147,-7876.8818C1963.1401,-7824.0904 2002.8134,-7598.5174 2025.9177,-7531.0016 2076.2331,-7383.9692 2138.5919,-7366.8556 2179.7498,-7217.0016 2206.0842,-7121.1188 2152.8482,-6848.0108 2215.7498,-6771.0016 2218.344,-6767.8256 2221.315,-6765.038 2224.5584,-6762.5927"/>
<polygon fill="#ff004c" stroke="#ff004c" points="2226.53,-6765.4872 2233.1218,-6757.1927 2222.7962,-6759.5662 2226.53,-6765.4872"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge252" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1953.0878,-7876.6401C1958.0509,-7818.756 1980.4909,-7550.817 1989.9177,-7331.0016 1992.3068,-7275.2938 1991.1491,-5367.5929 2025.9177,-5324.0016 2047.8745,-5296.4732 2099.0804,-5340.0134 2102.8337,-5305.0016"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge420" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2102.8337,-8155.0016C2296.3431,-8503.229 2181.5472,-9067.9227 2554.9226,-8929.0016 2759.4842,-8852.8908 2812.5743,-8794.1236 2926.5784,-8608.0016 3025.3493,-8446.7491 3043.4161,-8209.3282 3046.6697,-8137.4122"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3050.1705,-8137.4607 3047.0748,-8127.3282 3043.1762,-8137.1796 3050.1705,-8137.4607"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge392" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2102.8337,-8155.0016C2173.8654,-8294.5047 2591.0895,-8708.2776 2669.874,-8573.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2669.874,-8573.0016C2688.6895,-8541.521 2723.5901,-8575.6142 2748.8254,-8549.0016 2806.969,-8487.6846 2843.6575,-8216.166 2853.21,-8137.4546"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2856.7135,-8137.6324 2854.4218,-8127.2884 2849.7627,-8136.8038 2856.7135,-8137.6324"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1953.6184,-7899.1757C1958.605,-7932.5535 1977.0813,-8033.272 2025.9177,-8099.0016 2051.1365,-8132.9439 2082.294,-8118.0397 2102.8337,-8155.0016"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge357" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1956.0612,-7876.6059C1965.899,-7848.92 1993.0596,-7776.3287 2025.9177,-7721.0016 2083.18,-7624.5822 2132.5323,-7622.7178 2179.7498,-7521.0016 2211.5362,-7452.5269 2184.1992,-7423.5853 2215.7498,-7355.0016 2232.9624,-7317.5854 2264.143,-7280.8119 2283.9756,-7259.5462"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2286.6177,-7261.8467 2290.9682,-7252.1862 2281.5429,-7257.0252 2286.6177,-7261.8467"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge496" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1952.6407,-7876.8678C1956.3542,-7799.3236 1978.4527,-7331.7951 1989.9177,-6951.0016 1991.4328,-6900.6811 1995.9256,-5179.4357 2025.9177,-5139.0016 2029.6153,-5134.0167 2034.3292,-5130.0078 2039.5982,-5126.7867"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2041.5655,-5129.7138 2048.9081,-5122.076 2038.4051,-5123.4678 2041.5655,-5129.7138"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node34" class="node">
<title>sourcefile~dataprecisionglobals.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node34"><a xlink:href="../sourcefile/dataprecisionglobals.f90.html" xlink:title="DataPrecisionGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="130.719,-1861.007 -.2403,-1861.007 -.2403,-1838.9962 130.719,-1838.9962 130.719,-1861.007"/>
<text text-anchor="middle" x="65.2394" y="-1846.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPrecisionGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge646" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2302.1917,-11613.0016C2377.4693,-11577.167 2407.7486,-11627.9015 2489.7781,-11613.0016"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-11537.0016C746.966,-11575.924 1770.8241,-10916.3585 1878.2922,-10790.0016 1965.6388,-10687.3029 1958.8788,-10641.9727 2025.9177,-10525.0016 2092.8717,-10408.1787 2143.2893,-10393.6205 2179.7498,-10264.0016 2196.8637,-10203.1604 2177.3726,-8039.2185 2215.7498,-7989.0016 2221.7341,-7981.171 2230.0184,-7975.6816 2239.1057,-7971.8551"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2240.5333,-7975.0631 2248.8035,-7968.4409 2238.2087,-7968.4604 2240.5333,-7975.0631"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-11423.0016C445.3838,-11469.9187 458.9289,-11481.7499 516.9653,-11513.0016 545.4619,-11528.3466 554.8534,-11527.2637 585.7192,-11537.0016"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ff2600" stroke-dasharray="5,2" d="M223.8406,-7585.0016C233.7537,-7642.186 415.7611,-7637.3856 517.7882,-7630.1116"/>
<polygon fill="#ff2600" stroke="#ff2600" points="518.2923,-7633.584 528.0069,-7629.3558 517.776,-7626.6031 518.2923,-7633.584"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge57" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff4c00" stroke-dasharray="5,2" d="M223.8406,-7585.0016C232.6222,-7634.0318 271.1804,-7627.9478 317.2024,-7647.0016 385.8021,-7675.4029 429.4164,-7626.5669 480.9653,-7680.0016 549.4502,-7750.9918 483.9977,-7806.0343 516.9653,-7899.0016 568.96,-8045.6244 555.9401,-8124.883 690.4731,-8203.0016 740.177,-8231.8629 762.3405,-8204.6244 819.7932,-8203.0016 1063.7762,-8196.11 1124.2129,-8181.7574 1368.0981,-8172.0016 1538.3163,-8165.1926 1580.947,-8165.0017 1751.2896,-8163.0016 1807.7313,-8162.3389 1821.8582,-8161.8553 1878.2922,-8163.0016 2012.2723,-8165.7232 2066.5118,-8240.6621 2179.7498,-8169.0016 2211.3326,-8149.015 2188.9512,-8119.0549 2215.7498,-8093.0016 2275.9309,-8034.4941 2342.0303,-8086.8087 2388.6335,-8017.0016 2442.3489,-7936.5414 2416.5011,-6372.4021 2424.6335,-6276.0016 2438.2593,-6114.4849 2473.6291,-5921.9169 2485.6838,-5859.0038"/>
<polygon fill="#ff4c00" stroke="#ff4c00" points="2489.135,-5859.5907 2487.5932,-5849.1086 2482.2618,-5858.2643 2489.135,-5859.5907"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge86" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ff7200" stroke-dasharray="5,2" d="M1814.7909,-21.0016C1858.2188,-15.3018 2148.445,-139.3669 2179.7498,-170.0016 2208.4879,-198.1247 2190.8028,-221.4669 2215.7498,-253.0016 2287.6387,-343.8743 2328.3817,-344.4924 2424.6335,-409.0016 2480.6968,-446.5759 2501.7062,-445.4934 2554.9226,-487.0016 2572.7645,-500.9181 2571.5516,-511.307 2590.9226,-523.0016 2653.8282,-560.9787 2682.0206,-541.3996 2748.8254,-572.0016 2791.1644,-591.3963 2902.9999,-642.8419 2926.5784,-683.0016 2959.2019,-738.5672 3037.956,-2877.4098 3046.5983,-3114.6808"/>
<polygon fill="#ff7200" stroke="#ff7200" points="3043.1048,-3114.9246 3046.966,-3124.7907 3050.1001,-3114.6701 3043.1048,-3114.9246"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge98" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M223.8406,-7585.0016C238.7561,-7668.323 261.5463,-7482.7772 317.2024,-7419.0016 377.2301,-7350.2168 435.7274,-7374.2998 480.9653,-7295.0016 550.5705,-7172.9898 447.3264,-7102.9941 516.9653,-6981.0016 554.9531,-6914.4552 611.091,-6940.1639 654.4731,-6877.0016 687.2048,-6829.346 666.2061,-6804.4757 690.4731,-6752.0016 850.1135,-6406.8021 910.073,-6322.4431 1163.6646,-6039.0016 1228.7598,-5966.2441 1265.2859,-5969.1856 1332.0981,-5898.0016 1350.592,-5878.2976 1345.2218,-5863.3871 1368.0981,-5849.0016 1396.6502,-5831.047 1415.5188,-5854.9926 1442.684,-5835.0016"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge132" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M916.6465,-11537.0016C1066.5828,-11518.7689 1096.8405,-11461.0016 1247.8813,-11461.0016 1247.8813,-11461.0016 1247.8813,-11461.0016 1442.684,-11461.0016 2013.578,-11461.0016 2035.3326,-10961.3273 2179.7498,-10409.0016 2338.7824,-9800.7788 2337.5729,-9636.5949 2388.6335,-9010.0016 2411.188,-8733.2236 2381.9536,-6785.3977 2424.6335,-6511.0016 2436.0303,-6437.7297 2466.4305,-6354.7054 2481.3212,-6316.8288"/>
<polygon fill="#ffe500" stroke="#ffe500" points="2484.6325,-6317.9738 2485.0812,-6307.3885 2478.1294,-6315.3836 2484.6325,-6317.9738"/>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M585.7192,-11537.0016C725.983,-11581.2535 769.8745,-11546.4963 916.6465,-11537.0016"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge143" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#f2ff00" stroke-dasharray="5,2" d="M916.6465,-10364.0016C1050.1798,-10360.5341 1421.3016,-10432.9171 1517.2698,-10340.0016 1572.7558,-10286.2806 1506.2904,-10231.3007 1553.2698,-10170.0016 1613.3667,-10091.5865 1659.5854,-10105.7562 1751.2896,-10069.0016 1805.9786,-10047.0825 1841.8749,-10077.317 1878.2922,-10031.0016 1925.333,-9971.1755 1901.8075,-9422.0758 1914.2922,-9347.0016 1934.4546,-9225.7593 1967.1765,-9201.7868 1989.9177,-9081.0016 2005.4894,-8998.2959 1969.7664,-8766.6893 2025.9177,-8704.0016 2032.0661,-8697.1376 2040.3265,-8692.7821 2049.1558,-8690.0893"/>
<polygon fill="#f2ff00" stroke="#f2ff00" points="2049.9654,-8693.4945 2058.887,-8687.7798 2048.349,-8686.6837 2049.9654,-8693.4945"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge148" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M223.8406,-7585.0016C232.1865,-7640.2076 293.4762,-7670.5481 341.2497,-7685.9985"/>
<polygon fill="#cbff00" stroke="#cbff00" points="340.3218,-7689.375 350.9094,-7688.983 342.3882,-7682.6869 340.3218,-7689.375"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge150" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#a5ff00" stroke-dasharray="5,2" d="M223.8406,-7585.0016C247.0479,-7738.5106 222.7589,-10254.7782 317.2024,-10378.0016 324.9789,-10388.1479 336.7725,-10394.2984 349.006,-10397.9928"/>
<polygon fill="#a5ff00" stroke="#a5ff00" points="348.2922,-10401.422 358.8432,-10400.4584 349.9942,-10394.6321 348.2922,-10401.422"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge211" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1070.5822,-781.0016C1097.3078,-787.5708 1103.9125,-791.1001 1127.6646,-805.0016 1145.1583,-815.2403 1145.868,-823.2987 1163.6646,-833.0016 1309.8849,-912.7226 1408.0251,-831.2979 1517.2698,-957.0016 1570.7861,-1018.5808 1504.225,-1071.8049 1553.2698,-1137.0016 1602.0302,-1201.8203 1661.8655,-1159.9695 1715.2896,-1221.0016 1746.4021,-1256.5448 1728.1757,-1279.8062 1751.2896,-1321.0016 1795.3752,-1399.5747 1831.2035,-1402.1907 1878.2922,-1479.0016 1898.6703,-1512.2421 1896.9631,-1524.0746 1914.2922,-1559.0016 1945.5505,-1622.0027 1969.1656,-1630.8037 1989.9177,-1698.0016 2013.3801,-1773.9758 1981.4507,-1988.0831 2025.9177,-2054.0016 2069.1287,-2118.0581 2133.3609,-2073.2076 2179.7498,-2135.0016 2227.6835,-2198.8536 2162.2144,-2251.7675 2215.7498,-2311.0016 2223.6588,-2319.7526 2234.3562,-2325.6933 2245.5283,-2329.7193"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2244.8223,-2333.1648 2255.4104,-2332.787 2246.8976,-2326.4795 2244.8223,-2333.1648"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge219" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90</title>
<path fill="none" stroke="#59ff00" stroke-dasharray="5,2" d="M223.8406,-7585.0016C244.908,-7724.356 229.2333,-8739.8885 317.2024,-8850.0016 323.2616,-8857.5861 331.5587,-8862.9278 340.5575,-8866.6774"/>
<polygon fill="#59ff00" stroke="#59ff00" points="339.5298,-8870.026 350.1247,-8870.0359 341.8485,-8863.4212 339.5298,-8870.026"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge221" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90</title>
<path fill="none" stroke="#33ff00" stroke-dasharray="5,2" d="M399.0839,-10364.0016C424.6292,-10391.2615 444.6465,-10374.2487 480.9653,-10383.0016 496.9987,-10386.8657 500.6076,-10389.898 516.9653,-10392.0016 876.3006,-10438.2133 970.4366,-10420.4106 1332.0981,-10399.0016 1414.8306,-10394.1042 1435.4671,-10390.3044 1517.2698,-10377.0016 1605.9799,-10362.5755 1634.7029,-10375.7934 1715.2896,-10336.0016 1720.6576,-10333.351 1874.7438,-10199.8235 1878.2922,-10195.0016 1887.4883,-10182.5052 1983.8793,-9953.2938 1989.9177,-9939.0016 2006.3638,-9900.076 1994.9516,-9879.7553 2025.9177,-9851.0016 2029.8052,-9847.3919 2034.2205,-9844.3032 2038.9231,-9841.6602"/>
<polygon fill="#33ff00" stroke="#33ff00" points="2040.8041,-9844.637 2048.2576,-9837.1074 2037.7354,-9838.3454 2040.8041,-9844.637"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge279" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#0cff00" stroke-dasharray="5,2" d="M2669.874,-1421.0016C2715.7412,-1529.0362 2729.9977,-1557.1535 2748.8254,-1673.0016 2783.3031,-1885.1443 2776.0783,-3392.2536 2784.8254,-3607.0016 2803.03,-4053.9381 2845.0854,-4599.434 2854.0159,-4712.7779"/>
<polygon fill="#0cff00" stroke="#0cff00" points="2850.5392,-4713.2121 2854.8165,-4722.9051 2857.5174,-4712.6604 2850.5392,-4713.2121"/>
<path fill="none" stroke="#0cff00" stroke-dasharray="5,2" d="M1634.2797,-287.0016C1742.2183,-270.3646 1777.7063,-215.4575 1878.2922,-258.0016 2454.1578,-501.5712 2425.5246,-845.4665 2669.874,-1421.0016"/>
<path fill="none" stroke="#0cff00" stroke-dasharray="5,2" d="M1070.5822,-287.0016C1314.1216,-228.2231 1384.0567,-299.4465 1634.2797,-287.0016"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge284" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#00ff19" stroke-dasharray="5,2" d="M755.1332,-10364.0016C875.4866,-10319.9877 892.6705,-10278.6921 1013.4998,-10236.0016 1150.286,-10187.6733 1226.3221,-10264.2867 1332.0981,-10165.0016 1373.9402,-10125.7272 1338.8374,-10090.368 1368.0981,-10041.0016 1531.2562,-9765.7345 1748.7728,-9825.6058 1878.2922,-9533.0016 1913.5887,-9453.2614 1908.3858,-8836.0043 1914.2922,-8749.0016 1939.7112,-8374.5775 1969.7963,-8282.7478 1989.9177,-7908.0016 1996.0101,-7794.5363 1989.6442,-5970.685 2025.9177,-5863.0016 2037.52,-5828.5585 2064.9049,-5795.9479 2083.6607,-5776.4632"/>
<polygon fill="#00ff19" stroke="#00ff19" points="2086.3142,-5778.7576 2090.8578,-5769.1865 2081.3373,-5773.8351 2086.3142,-5778.7576"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge290" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataloopnode.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M399.0839,-10364.0016C416.9287,-10380.0861 802.6794,-10280.8618 819.7932,-10264.0016 866.1736,-10218.3084 819.6864,-10176.1801 855.7932,-10122.0016 950.3626,-9980.0996 1137.1876,-9880.1819 1213.8428,-9843.4888"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="1215.5152,-9846.5696 1223.058,-9839.1293 1212.5217,-9840.2419 1215.5152,-9846.5696"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge298" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M399.0839,-9903.0016C457.8315,-9946.2368 953.4382,-9835.9412 1127.6646,-9689.0016 1311.2737,-9534.1487 1199.7276,-9376.2998 1368.0981,-9205.0016 1373.9363,-9199.0619 1625.9515,-9066.9261 1634.2797,-9067.0016"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge307" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairsystems.f90</title>
<path fill="none" stroke="#00ff8c" stroke-dasharray="5,2" d="M1070.5822,-781.0016C1184.3282,-807.1715 1221.3674,-768.1 1332.0981,-805.0016 1538.3398,-873.7327 1589.5396,-931.6699 1715.2896,-1109.0016 1737.6088,-1140.4761 1734.0442,-1153.4851 1751.2896,-1188.0016 1818.9365,-1323.3963 1836.68,-1357.0625 1914.2922,-1487.0016 1945.8514,-1539.8383 1968.8616,-1545.1714 1989.9177,-1603.0016 2035.4094,-1727.9436 1983.9834,-1773.8212 2025.9177,-1900.0016 2040.5344,-1943.9831 2070.4579,-1989.6365 2088.3681,-2014.6703"/>
<polygon fill="#00ff8c" stroke="#00ff8c" points="2085.6576,-2016.8939 2094.3724,-2022.9191 2091.317,-2012.7743 2085.6576,-2016.8939"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge311" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ffb2" stroke-dasharray="5,2" d="M223.8406,-7585.0016C291.287,-7969.9361 197.8761,-8188.3789 516.9653,-8414.0016 566.8657,-8449.2854 593.3939,-8416.0791 654.4731,-8414.0016 798.2899,-8409.1099 839.0569,-8431.2542 977.4998,-8392.0016 1022.4787,-8379.2488 1027.9983,-8362.2982 1070.5822,-8343.0016"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalfansys.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge317" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalfansys.f90</title>
<path fill="none" stroke="#00ffd8" stroke-dasharray="5,2" d="M1814.7909,-287.0016C1998.4532,-398.8818 2078.3206,-675.4511 2097.8751,-754.5529"/>
<polygon fill="#00ffd8" stroke="#00ffd8" points="2094.5857,-755.8438 2100.3277,-764.7478 2101.3916,-754.2065 2094.5857,-755.8438"/>
<path fill="none" stroke="#00ffd8" stroke-dasharray="5,2" d="M1634.2797,-287.0016C1713.5705,-274.7802 1746.0805,-245.5855 1814.7909,-287.0016"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge321" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-6139.0016C418.9844,-6117.9332 632.9449,-6105.4038 654.4731,-6086.0016 693.6275,-6050.7141 674.0319,-6023.0811 690.4731,-5973.0016 774.6523,-5716.5942 881.2842,-5406.5218 909.523,-5324.6354"/>
<polygon fill="#00ffff" stroke="#00ffff" points="912.8905,-5325.606 912.8433,-5315.0113 906.2732,-5323.323 912.8905,-5325.606"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge329" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00d8ff" stroke-dasharray="5,2" d="M585.7192,-1051.0016C757.9516,-1123.2455 839.6486,-1076.9849 977.4998,-1203.0016 1028.8784,-1249.9694 1055.4241,-1331.6006 1065.578,-1369.9537"/>
<polygon fill="#00d8ff" stroke="#00d8ff" points="1062.2669,-1371.1361 1068.1139,-1379.9714 1069.0528,-1369.4182 1062.2669,-1371.1361"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge338" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00b2ff" stroke-dasharray="5,2" d="M223.8406,-7585.0016C233.7875,-7641.7715 273.4035,-7532.4639 317.2024,-7495.0016 351.8915,-7465.3312 369.0519,-7467.3782 399.0839,-7433.0016"/>
<path fill="none" stroke="#00b2ff" stroke-dasharray="5,2" d="M399.0839,-7433.0016C429.1158,-7398.625 452.2296,-7406.4689 480.9653,-7371.0016 618.8315,-7200.8391 567.4448,-7106.1822 690.4731,-6925.0016 863.0779,-6670.8112 942.3812,-6634.1655 1163.6646,-6421.0016 1255.75,-6332.295 1373.3202,-6234.6252 1421.0734,-6195.5591"/>
<polygon fill="#00b2ff" stroke="#00b2ff" points="1423.3658,-6198.2058 1428.8992,-6189.1708 1418.9392,-6192.7832 1423.3658,-6198.2058"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazoneenergydemands.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge342" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazoneenergydemands.f90</title>
<path fill="none" stroke="#008cff" stroke-dasharray="5,2" d="M1070.5822,-781.0016C1078.6152,-783.4215 1359.7399,-729.7265 1368.0981,-729.0016 1434.1487,-723.2729 1460.3666,-694.9793 1517.2698,-729.0016 1546.2834,-746.3488 1534.5135,-767.8784 1553.2698,-796.0016 1616.5514,-890.8864 1654.1137,-898.7457 1715.2896,-995.0016 1866.1244,-1232.3295 1881.2956,-1305.6237 1989.9177,-1565.0016 2035.4941,-1673.8331 2079.8243,-1808.2441 2096.1996,-1859.1485"/>
<polygon fill="#008cff" stroke="#008cff" points="2092.9591,-1860.5058 2099.3422,-1868.962 2099.6257,-1858.371 2092.9591,-1860.5058"/>
<path fill="none" stroke="#008cff" stroke-dasharray="5,2" d="M585.7192,-593.0016C617.6456,-587.6879 624.133,-605.7322 654.4731,-617.0016 840.8169,-686.2159 882.8974,-715.5109 1070.5822,-781.0016"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairloop.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge351" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairloop.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M223.8406,-7585.0016C247.7002,-7718.2864 217.5471,-7386.6691 317.2024,-7295.0016 372.1934,-7244.4183 433.2802,-7314.5238 480.9653,-7257.0016 542.4281,-7182.8596 476.2608,-6478.2819 516.9653,-6391.0016 557.3108,-6304.4912 1724.3148,-5295.4302 1814.7909,-5265.0016"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge436" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M1070.5822,-287.0016C1116.8559,-274.9096 1119.8886,-252.2665 1163.6646,-233.0016 1362.9419,-145.3037 1419.4991,-132.6623 1634.2797,-97.0016"/>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M755.1332,-477.0016C878.1337,-414.5479 889.0702,-364.5573 1013.4998,-305.0016 1037.4943,-293.5171 1044.8075,-293.5822 1070.5822,-287.0016"/>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M585.7192,-593.0016C631.2141,-589.5309 714.2798,-497.3199 755.1332,-477.0016"/>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M65.8889,-1838.962C71.7383,-1742.2706 117.603,-1038.838 223.8406,-861.0016"/>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M1634.2797,-97.0016C1691.0301,-85.7935 1697.3998,-61.0286 1751.2896,-40.0016 1778.7335,-29.2934 1785.873,-26.6221 1814.7909,-21.0016"/>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M223.8406,-861.0016C275.8073,-774.012 238.69,-717.0606 317.2024,-653.0016 411.9503,-575.6959 463.7897,-602.3034 585.7192,-593.0016"/>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M1814.7909,-21.0016C2084.1845,31.3581 2161.6682,-94.7253 2388.6335,-249.0016 2438.2763,-282.7455 2538.4074,-398.9292 2590.9226,-428.0016 2624.9411,-446.8343 2898.6814,-499.915 2926.5784,-527.0016 2963.4843,-562.8356 2941.6494,-590.0112 2962.5784,-637.0016 3024.1083,-775.1506 3091.8727,-786.2362 3132.1655,-932.0016 3214.174,-1228.6801 3232.3093,-6290.6423 3233.5265,-6660.6636"/>
<polygon fill="#0019ff" stroke="#0019ff" points="3230.0271,-6660.8565 3233.5596,-6670.8451 3237.027,-6660.8337 3230.0271,-6660.8565"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge450" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0c00ff" stroke-dasharray="5,2" d="M65.6675,-1861.0736C68.4372,-1917.1072 88.3372,-2171.9632 223.8406,-2305.0016"/>
<path fill="none" stroke="#0c00ff" stroke-dasharray="5,2" d="M223.8406,-2305.0016C258.0456,-2338.5844 609.1555,-2315.378 654.4731,-2331.0016 738.8506,-2360.0915 753.9352,-2384.7646 819.7932,-2445.0016 900.7727,-2519.0695 931.8537,-2535.201 977.4998,-2635.0016 1017.9801,-2723.5078 992.9898,-2755.8631 1013.4998,-2851.0016 1028.9813,-2922.815 1052.9726,-3006.6143 1064.2793,-3044.9364"/>
<polygon fill="#0c00ff" stroke="#0c00ff" points="1061.0359,-3046.3095 1067.2365,-3054.9004 1067.7466,-3044.3178 1061.0359,-3046.3095"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge478" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M1070.5822,-287.0016C1154.5633,-269.1392 1649.6737,-657.6261 1715.2896,-713.0016 1796.2712,-781.3448 1814.8013,-802.1622 1878.2922,-887.0016 2156.8236,-1259.1877 2265.9488,-1351.6149 2388.6335,-1800.0016 2408.2209,-1871.5893 2378.5176,-2408.8486 2424.6335,-2467.0016 2462.1127,-2514.2634 2518.4275,-2456.9758 2554.9226,-2505.0016 2602.8923,-2568.1274 2583.4112,-5280.0741 2590.9226,-5359.0016 2606.4592,-5522.2555 2649.9577,-5715.7341 2664.8208,-5778.9145"/>
<polygon fill="#3200ff" stroke="#3200ff" points="2661.4639,-5779.9277 2667.176,-5788.8508 2668.2752,-5778.3132 2661.4639,-5779.9277"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge486" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#5900ff" stroke-dasharray="5,2" d="M399.0839,-6139.0016C424.802,-6111.132 445.3285,-6127.9691 480.9653,-6115.0016 560.0784,-6086.2141 607.2922,-6108.7265 654.4731,-6039.0016 724.8733,-5934.9631 617.8059,-5011.4695 690.4731,-4909.0016 695.734,-4901.5833 703.5226,-4896.3662 711.8883,-4892.6972"/>
<polygon fill="#5900ff" stroke="#5900ff" points="713.2937,-4895.9097 721.4748,-4889.1776 710.8812,-4889.3385 713.2937,-4895.9097"/>
<path fill="none" stroke="#5900ff" stroke-dasharray="5,2" d="M223.8406,-7585.0016C278.8661,-7903.9747 176.8194,-6374.3103 399.0839,-6139.0016"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge526" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1814.7909,-287.0016C1872.6141,-321.8553 1851.6908,-362.9478 1878.2922,-425.0016 1948.2138,-588.1095 1952.5423,-634.4181 2025.9177,-796.0016 2087.872,-932.4343 2112.4261,-962.137 2179.7498,-1096.0016 2196.0033,-1128.3198 2196.6695,-1138.2675 2215.7498,-1169.0016 2282.4517,-1276.4442 2334.6157,-1280.6551 2388.6335,-1395.0016 2418.6572,-1458.5565 2403.0922,-1482.0941 2424.6335,-1549.0016 2470.9382,-1692.8236 2522.6961,-1715.3861 2554.9226,-1863.0016 2601.5932,-2076.7795 2581.5304,-2628.3903 2590.9226,-2847.0016 2618.7027,-3493.6028 2661.216,-4286.7579 2668.7221,-4425.7347"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="2665.2362,-4426.0904 2669.2711,-4435.8868 2672.226,-4425.7124 2665.2362,-4426.0904"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge534" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#a500ff" stroke-dasharray="5,2" d="M223.8406,-7585.0016C278.3587,-7889.5515 175.8141,-10149.8207 399.0839,-10364.0016"/>
<path fill="none" stroke="#a500ff" stroke-dasharray="5,2" d="M399.0839,-10364.0016C437.5945,-10400.9446 1088.0919,-9773.8047 1127.6646,-9738.0016 1237.0958,-9638.9943 1242.941,-9587.1894 1368.0981,-9509.0016 1574.9334,-9379.7881 1742.9849,-9509.9027 1878.2922,-9307.0016 1920.1029,-9244.3041 1893.2087,-8023.3521 1914.2922,-7951.0016 1918.8994,-7935.1916 1928.4755,-7919.3064 1936.8375,-7907.4421"/>
<polygon fill="#a500ff" stroke="#a500ff" points="1939.7803,-7909.3484 1942.893,-7899.2211 1934.1442,-7905.1969 1939.7803,-7909.3484"/>
</g>
<!-- sourcefile~dataglobals.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node35" class="node">
<title>sourcefile~dataglobals.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node35"><a xlink:href="../sourcefile/dataglobals.f90.html" xlink:title="DataGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="267.6355,-2944.007 180.0456,-2944.007 180.0456,-2921.9962 267.6355,-2921.9962 267.6355,-2944.007"/>
<text text-anchor="middle" x="223.8406" y="-2929.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge539" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90</title>
<path fill="none" stroke="#f200ff" stroke-dasharray="5,2" d="M66.8608,-1861.0732C82.0989,-1965.1263 200.0662,-2770.6595 220.7501,-2911.8984"/>
<polygon fill="#f200ff" stroke="#f200ff" points="217.3004,-2912.4972 222.2125,-2921.8845 224.2265,-2911.4828 217.3004,-2912.4972"/>
</g>
<!-- sourcefile~dataairflownetwork.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node36" class="node">
<title>sourcefile~dataairflownetwork.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node36"><a xlink:href="../sourcefile/dataairflownetwork.f90.html" xlink:title="DataAirflowNetwork.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="977.3534,-488.007 855.9396,-488.007 855.9396,-465.9962 977.3534,-465.9962 977.3534,-488.007"/>
<text text-anchor="middle" x="916.6465" y="-473.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataAirflowNetwork.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairflownetwork.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge541" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairflownetwork.f90</title>
<path fill="none" stroke="#ff00e5" stroke-dasharray="5,2" d="M755.1332,-477.0016C786.4924,-461.0789 825.8936,-460.7587 857.9289,-464.5744"/>
<polygon fill="#ff00e5" stroke="#ff00e5" points="857.6726,-468.0716 868.0516,-465.9441 858.6113,-461.1348 857.6726,-468.0716"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge550" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M399.0839,-7433.0016C493.5568,-7347.1882 1259.3836,-6867.8905 1332.0981,-6763.0016 1366.9877,-6712.6743 1323.1241,-6671.5644 1368.0981,-6630.0016 1392.8685,-6607.1101 1415.0961,-6635.4051 1442.684,-6616.0016"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge566" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M399.0839,-11423.0016C532.8207,-11556.8421 1477.2065,-11077.6567 1715.2896,-10841.0016 1809.6296,-10747.2274 2097.4856,-10076.6174 2102.8337,-10055.0016"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge576" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0072" stroke-dasharray="5,2" d="M223.8406,-7585.0016C251.6475,-7746.1935 261.7343,-7382.8825 317.2024,-7229.0016 375.7136,-7066.6786 438.325,-7044.1964 480.9653,-6877.0016 542.8178,-6634.4749 430.6254,-6549.9279 516.9653,-6315.0016 546.5063,-6234.6221 944.9367,-5776.205 977.4998,-5697.0016 1021.1894,-5590.735 967.7303,-5546.3892 1013.4998,-5441.0016 1079.5152,-5288.9963 1113.9508,-5248.6042 1247.8813,-5151.0016"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge600" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M399.0839,-10364.0016C425.201,-10390.7142 447.6484,-10366.1004 480.9653,-10383.0016 499.7956,-10392.5539 497.5293,-10405.7513 516.9653,-10414.0016 588.2507,-10444.261 613.1759,-10425.2733 690.4731,-10430.0016 1145.902,-10457.8607 1288.9151,-10531.4712 1715.2896,-10369.0016 1795.5924,-10338.4023 1820.7614,-10328.8379 1878.2922,-10265.0016 1952.4923,-10182.6691 1941.6369,-10141.7676 1989.9177,-10042.0016 2006.3742,-10007.9965 2002.3147,-9994.4983 2025.9177,-9965.0016 2079.9236,-9897.5106 2141.2172,-9923.3767 2179.7498,-9846.0016 2217.8292,-9769.5362 2164.0201,-6838.9799 2215.7498,-6771.0016 2218.1119,-6767.8975 2220.8356,-6765.161 2223.8278,-6762.7501"/>
<polygon fill="#ff004c" stroke="#ff004c" points="2225.929,-6765.5559 2232.3118,-6757.0995 2222.0486,-6759.7299 2225.929,-6765.5559"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge607" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0026" stroke-dasharray="5,2" d="M65.3808,-1861.2558C68.7257,-2125.8193 131.1577,-6971.9327 223.8406,-7585.0016"/>
<path fill="none" stroke="#ff0026" stroke-dasharray="5,2" d="M223.8406,-7585.0016C323.5542,-8244.5765 274.8052,-6752.7225 317.2024,-6087.0016 360.6684,-5404.4976 221.3473,-3632.6952 516.9653,-3016.0016 526.0329,-2997.0856 543.5345,-2981.1788 558.6097,-2970.0809"/>
<polygon fill="#ff0026" stroke="#ff0026" points="560.9418,-2972.7206 567.1233,-2964.1159 556.9251,-2966.9877 560.9418,-2972.7206"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-10364.0016C823.7579,-10342.9411 845.9883,-10376.6634 916.6465,-10364.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M916.6465,-10364.0016C959.4578,-10356.3299 970.402,-10355.8536 1013.4998,-10350.0016 1237.1448,-10319.6339 1354.0631,-10441.8955 1517.2698,-10286.0016 1584.7955,-10221.5015 1506.8274,-10160.0146 1553.2698,-10079.0016 1600.1698,-9997.1902 1655.3884,-10014.8342 1715.2896,-9942.0016 1809.9469,-9826.9096 1833.0925,-9790.9987 1878.2922,-9649.0016 1923.0428,-9508.4154 1895.3419,-9465.3163 1914.2922,-9319.0016 1943.3859,-9094.3702 1968.7455,-9040.5176 1989.9177,-8815.0016 1994.8027,-8762.9699 1994.3983,-7916.6872 2025.9177,-7875.0016 2031.2707,-7867.922 2038.6697,-7862.8144 2046.7779,-7859.1365"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2048.0627,-7862.3925 2056.1623,-7855.5627 2045.5714,-7855.8508 2048.0627,-7862.3925"/>
</g>
<!-- sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node43" class="node">
<title>sourcefile~outputreportpredefined.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node43"><a xlink:href="../sourcefile/outputreportpredefined.f90.html" xlink:title="OutputReportPredefined.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1319.7189,-7558.007 1176.0438,-7558.007 1176.0438,-7535.9962 1319.7189,-7535.9962 1319.7189,-7558.007"/>
<text text-anchor="middle" x="1247.8813" y="-7543.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputReportPredefined.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M399.0839,-7509.0016C690.4777,-7417.2541 1065.9197,-7498.8248 1198.7069,-7533.3315"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1198.0239,-7536.7708 1208.5852,-7535.9287 1199.8039,-7530.0009 1198.0239,-7536.7708"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node44" class="node">
<title>sourcefile~datacontaminantbalance.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node44"><a xlink:href="../sourcefile/datacontaminantbalance.f90.html" xlink:title="DataContaminantBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1517.3557,-1173.007 1368.0122,-1173.007 1368.0122,-1150.9962 1517.3557,-1150.9962 1517.3557,-1173.007"/>
<text text-anchor="middle" x="1442.684" y="-1158.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataContaminantBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M399.0839,-861.0016C560.2355,-877.2407 989.5362,-796.4195 1127.6646,-881.0016 1156.1598,-898.4505 1144.9426,-919.3261 1163.6646,-947.0016 1196.6048,-995.6949 1196.3187,-1020.7636 1247.8813,-1049.0016"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1247.8813,-1049.0016C1282.1842,-1067.3885 1297.5341,-1055.1107 1332.0981,-1073.0016 1368.389,-1091.7864 1404.0626,-1123.5758 1424.693,-1143.6421"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1422.263,-1146.1615 1431.8332,-1150.7072 1427.1865,-1141.1856 1422.263,-1146.1615"/>
</g>
<!-- sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node45" class="node">
<title>sourcefile~datasurfaces.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node45"><a xlink:href="../sourcefile/datasurfaces.f90.html" xlink:title="DataSurfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="632.3482,-1291.007 539.0902,-1291.007 539.0902,-1268.9962 632.3482,-1268.9962 632.3482,-1291.007"/>
<text text-anchor="middle" x="585.7192" y="-1276.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSurfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1280.0016C441.9945,-1271.8088 491.4733,-1272.2456 528.7,-1274.4948"/>
<polygon fill="#ff0000" stroke="#ff0000" points="528.6488,-1277.999 538.8593,-1275.1715 529.1141,-1271.0145 528.6488,-1277.999"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-1395.0016C274.4177,-1366.7267 267.1743,-1333.237 317.2024,-1304.0016 349.9444,-1284.8679 361.8339,-1287.1136 399.0839,-1280.0016"/>
</g>
<!-- sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node46" class="node">
<title>sourcefile~datavectortypes.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node46"><a xlink:href="../sourcefile/datavectortypes.f90.html" xlink:title="DataVectorTypes.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="278.8255,-1252.007 168.8556,-1252.007 168.8556,-1229.9962 278.8255,-1229.9962 278.8255,-1252.007"/>
<text text-anchor="middle" x="223.8406" y="-1237.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataVectorTypes.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M66.8912,-1838.9103C74.8279,-1786.6472 110.9605,-1560.0129 166.4788,-1381.0016 180.0703,-1337.1774 201.8216,-1287.9751 214.2686,-1261.1393"/>
<polygon fill="#ff0000" stroke="#ff0000" points="217.4738,-1262.5476 218.547,-1252.0072 211.135,-1259.5778 217.4738,-1262.5476"/>
</g>
<!-- sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node47" class="node">
<title>sourcefile~databsdfwindow.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node47"><a xlink:href="../sourcefile/databsdfwindow.f90.html" xlink:title="DataBSDFWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="457.5516,-1252.007 340.6161,-1252.007 340.6161,-1229.9962 457.5516,-1229.9962 457.5516,-1252.007"/>
<text text-anchor="middle" x="399.0839" y="-1237.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBSDFWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-1395.0016C285.6159,-1360.4664 259.6148,-1307.1421 317.2024,-1266.0016 322.7279,-1262.0542 328.8892,-1258.7195 335.2832,-1255.9045"/>
<polygon fill="#00ffff" stroke="#00ffff" points="336.7659,-1259.0818 344.7709,-1252.1413 334.1849,-1252.5749 336.7659,-1259.0818"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M67.1419,-1838.7578C78.497,-1773.244 139.6865,-1442.0476 223.8406,-1395.0016"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge70" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1634.2797,-97.0016C1792.38,-69.6703 1839.572,-102.976 1989.9177,-159.0016 2082.1371,-193.3667 2105.7628,-208.1071 2179.7498,-273.0016 2256.1489,-340.0119 2713.9579,-893.5477 2748.8254,-989.0016 2796.3465,-1119.0962 2777.3923,-2096.699 2784.8254,-2235.0016 2803.7584,-2587.2746 2844.1053,-3015.7523 2853.6482,-3114.856"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2850.1657,-3115.2063 2854.6113,-3124.8233 2857.1332,-3114.533 2850.1657,-3115.2063"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge109" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-7585.0016C238.8,-7668.5682 319.2747,-7537.9437 399.0839,-7509.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-7509.0016C451.6562,-7489.9368 463.2996,-7480.7276 516.9653,-7465.0016 783.4492,-7386.9121 929.385,-7527.4157 1127.6646,-7333.0016 1177.2359,-7284.3967 1126.9814,-7239.9431 1163.6646,-7181.0016 1214.9494,-7098.5984 1263.5296,-7110.6949 1332.0981,-7042.0016 1441.4429,-6932.4578 1428.1096,-6864.0568 1553.2698,-6773.0016 1615.8075,-6727.5049 1701.144,-6698.8646 1757.0826,-6683.6469"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1758.0674,-6687.0067 1766.8293,-6681.0502 1756.2653,-6680.2426 1758.0674,-6687.0067"/>
</g>
<!-- sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node50" class="node">
<title>sourcefile~databranchairloopplant.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node50"><a xlink:href="../sourcefile/databranchairloopplant.f90.html" xlink:title="DataBranchAirLoopPlant.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1320.4668,-10156.007 1175.2959,-10156.007 1175.2959,-10133.9962 1320.4668,-10133.9962 1320.4668,-10156.007"/>
<text text-anchor="middle" x="1247.8813" y="-10141.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBranchAirLoopPlant.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge137" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-10364.0016C793.6493,-10350.6999 798.059,-10333.4698 819.7932,-10299.0016 845.2113,-10258.6912 818.7792,-10228.0179 855.7932,-10198.0016 942.9086,-10127.3558 1078.407,-10125.2683 1165.1269,-10133.0226"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1164.9041,-10136.5172 1175.1922,-10133.9863 1165.5713,-10129.549 1164.9041,-10136.5172"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-10364.0016C427.8374,-10391.1735 717.4503,-10376.0464 755.1332,-10364.0016"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge158" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-1051.0016C621.0521,-1066.5011 717.2901,-1020.5213 755.1332,-1013.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-861.0016C516.8874,-872.5662 477.3205,-1003.4503 585.7192,-1051.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-1013.0016C813.9946,-1001.3054 800.0054,-945.1193 855.7932,-923.0016 911.9623,-900.7328 1082.4338,-878.9386 1127.6646,-919.0016 1177.2671,-962.9369 1125.7119,-1160.6848 1163.6646,-1215.0016 1211.8068,-1283.9015 1275.2844,-1239.0576 1332.0981,-1301.0016 1566.4244,-1556.4877 1485.6857,-1708.9806 1553.2698,-2049.0016 1573.8876,-2152.7316 1611.865,-2273.5992 1627.3913,-2321.2153"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1624.1478,-2322.5566 1630.5921,-2330.9663 1630.7987,-2320.3735 1624.1478,-2322.5566"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge189" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M755.1332,-1013.0016C861.101,-982.5348 896.2888,-1048.4216 977.4998,-1123.0016 1072.4049,-1210.1576 1065.4313,-1258.1735 1127.6646,-1371.0016 1144.9441,-1402.3292 1143.4703,-1413.4687 1163.6646,-1443.0016 1226.6141,-1535.0617 1280.4662,-1530.149 1332.0981,-1629.0016 1365.0407,-1692.0722 1348.4093,-1716.6243 1368.0981,-1785.0016 1388.9827,-1857.5317 1420.2328,-1941.5411 1434.7477,-1979.5063"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1431.5209,-1980.8668 1438.3754,-1988.9456 1438.055,-1978.3556 1431.5209,-1980.8668"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge202" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M399.0839,-1356.0016C431.8348,-1373.975 456.6686,-1346.6231 480.9653,-1375.0016 551.9736,-1457.939 451.0906,-1777.9309 516.9653,-1865.0016 519.4379,-1868.2697 522.3794,-1871.1112 525.6323,-1873.5816"/>
<polygon fill="#0000ff" stroke="#0000ff" points="523.9368,-1876.6495 534.2699,-1878.9898 527.6516,-1870.7164 523.9368,-1876.6495"/>
</g>
<!-- sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node54" class="node">
<title>sourcefile~datasystemvariables.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node54"><a xlink:href="../sourcefile/datasystemvariables.f90.html" xlink:title="DataSystemVariables.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.7837,-1824.007 334.3841,-1824.007 334.3841,-1801.9962 463.7837,-1801.9962 463.7837,-1824.007"/>
<text text-anchor="middle" x="399.0839" y="-1809.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSystemVariables.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge152" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-1395.0016C262.0002,-1373.6687 365.9676,-1704.3699 392.7324,-1791.9869"/>
<polygon fill="#ff0000" stroke="#ff0000" points="389.4095,-1793.0896 395.6681,-1801.6383 396.1065,-1791.0525 389.4095,-1793.0896"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge175" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-1513.0016C455.2968,-1547.4255 461.1864,-1567.8788 516.9653,-1603.0016 790.0219,-1774.9393 866.6751,-1806.8282 1163.6646,-1933.0016 1176.1401,-1938.3018 1189.9461,-1943.3723 1202.7086,-1947.7491"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1201.6315,-1951.0795 1212.2255,-1950.9532 1203.865,-1944.4453 1201.6315,-1951.0795"/>
</g>
<!-- sourcefile~dataroomair.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node60" class="node">
<title>sourcefile~dataroomair.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node60"><a xlink:href="../sourcefile/dataroomair.f90.html" xlink:title="DataRoomAir.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="445.0438,-2431.007 353.1239,-2431.007 353.1239,-2408.9962 445.0438,-2408.9962 445.0438,-2431.007"/>
<text text-anchor="middle" x="399.0839" y="-2416.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRoomAir.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataroomair.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge169" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataroomair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-2305.0016C267.8868,-2348.2466 330.5012,-2384.6726 367.7395,-2404.3301"/>
<polygon fill="#ff0000" stroke="#ff0000" points="366.1472,-2407.447 376.6334,-2408.9604 369.3797,-2401.238 366.1472,-2407.447"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge253" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-861.0016C263.7841,-794.1381 321.5706,-853.3922 399.0839,-861.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-861.0016C451.4944,-866.1467 464.4574,-853.0335 516.9653,-849.0016 721.1047,-833.3265 772.8002,-833.9137 977.4998,-838.0016 1044.2796,-839.3352 1064.8398,-821.3216 1127.6646,-844.0016 1140.4802,-848.6281 1507.8215,-1132.1845 1517.2698,-1142.0016 1536.5092,-1161.9922 1533.9158,-1173.1219 1553.2698,-1193.0016 1615.9629,-1257.3979 1661.8017,-1241.7772 1715.2896,-1314.0016 1743.4022,-1351.962 1733.4301,-1370.2712 1751.2896,-1414.0016 1802.495,-1539.3829 1835.6256,-1562.4636 1878.2922,-1691.0016 1902.3489,-1763.475 1893.0792,-1785.6455 1914.2922,-1859.0016 1954.2759,-1997.268 1968.0786,-2031.2028 2025.9177,-2163.0016 2085.9726,-2299.8493 2141.1718,-2317.6215 2179.7498,-2462.0016 2223.6823,-2626.4216 2200.8491,-3057.467 2215.7498,-3227.0016 2238.3298,-3483.909 2285.8966,-3793.8013 2298.8654,-3876.1078"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2295.4088,-3876.6576 2300.4287,-3885.9878 2302.3228,-3875.5636 2295.4088,-3876.6576"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge226" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1356.0016C431.8348,-1373.975 455.5086,-1347.6589 480.9653,-1375.0016 550.8709,-1450.0859 476.277,-1508.8267 516.9653,-1603.0016 566.9105,-1718.602 602.9203,-1736.4894 690.4731,-1827.0016 748.0815,-1886.5572 937.7624,-1992.2931 977.4998,-2065.0016 1040.6328,-2180.5178 947.6879,-2244.9903 1013.4998,-2359.0016 1045.2579,-2414.0189 1093.8512,-2391.223 1127.6646,-2445.0016 1171.0903,-2514.0683 1134.0816,-2548.9697 1163.6646,-2625.0016 1181.5111,-2670.8696 1214.1373,-2718.7654 1233.1161,-2744.63"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1230.4345,-2746.889 1239.2134,-2752.8203 1236.0494,-2742.709 1230.4345,-2746.889"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-1395.0016C293.4873,-1356.0659 328.1004,-1319.5598 399.0839,-1356.0016"/>
</g>
<!-- sourcefile~datawater.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node63" class="node">
<title>sourcefile~datawater.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node63"><a xlink:href="../sourcefile/datawater.f90.html" xlink:title="DataWater.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1109.8201,-1490.007 1031.3442,-1490.007 1031.3442,-1467.9962 1109.8201,-1467.9962 1109.8201,-1490.007"/>
<text text-anchor="middle" x="1070.5822" y="-1475.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataWater.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datawater.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge234" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datawater.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-1280.0016C436.3338,-1272.8896 447.3564,-1286.4352 480.9653,-1304.0016 499.1738,-1313.5187 498.6288,-1323.7337 516.9653,-1333.0016 562.7433,-1356.1393 894.6086,-1436.8807 1021.4624,-1467.2933"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1020.7674,-1470.7258 1031.3076,-1469.6513 1022.3979,-1463.9183 1020.7674,-1470.7258"/>
</g>
<!-- sourcefile~dataerrortracking.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node64" class="node">
<title>sourcefile~dataerrortracking.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node64"><a xlink:href="../sourcefile/dataerrortracking.f90.html" xlink:title="DataErrorTracking.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1500.0871,-9115.007 1385.2808,-9115.007 1385.2808,-9092.9962 1500.0871,-9092.9962 1500.0871,-9115.007"/>
<text text-anchor="middle" x="1442.684" y="-9100.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataErrorTracking.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataerrortracking.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge291" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataerrortracking.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-9903.0016C452.3447,-9939.3974 602.262,-9802.8877 654.4731,-9765.0016 780.8276,-9673.3147 1044.2299,-9381.5367 1163.6646,-9281.0016 1250.284,-9208.089 1267.7431,-9181.4234 1368.0981,-9129.0016 1375.6675,-9125.0476 1383.9892,-9121.5337 1392.244,-9118.4807"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1393.5767,-9121.7224 1401.8546,-9115.1097 1391.2598,-9115.1169 1393.5767,-9121.7224"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-7585.0016C269.3542,-7839.2505 191.0568,-9749.9044 399.0839,-9903.0016"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node65" class="node">
<title>sourcefile~datacomplexfenestration.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node65"><a xlink:href="../sourcefile/datacomplexfenestration.f90.html" xlink:title="DataComplexFenestration.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="475.0737,-1447.007 323.0941,-1447.007 323.0941,-1424.9962 475.0737,-1424.9962 475.0737,-1447.007"/>
<text text-anchor="middle" x="399.0839" y="-1432.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataComplexFenestration.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge323" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-1395.0016C226.5732,-1393.4739 294.6055,-1409.9378 345.0818,-1422.459"/>
<polygon fill="#ff0000" stroke="#ff0000" points="344.3694,-1425.8884 354.9184,-1424.9042 346.0581,-1419.0951 344.3694,-1425.8884"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node66" class="node">
<title>sourcefile~dataequivalentlayerwindow.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node66"><a xlink:href="../sourcefile/dataequivalentlayerwindow.f90.html" xlink:title="DataEquivalentLayerWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="480.847,-1406.007 317.3208,-1406.007 317.3208,-1383.9962 480.847,-1383.9962 480.847,-1406.007"/>
<text text-anchor="middle" x="399.0839" y="-1391.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEquivalentLayerWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge325" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-1395.0016C260.9797,-1374.2392 309.8403,-1376.1616 346.5319,-1382.1799"/>
<polygon fill="#00ffff" stroke="#00ffff" points="346.078,-1385.6542 356.5382,-1383.9705 347.3111,-1378.7637 346.078,-1385.6542"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge421" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-11537.0016C952.629,-11659.4981 1055.866,-11689.0016 1442.684,-11689.0016 1442.684,-11689.0016 1442.684,-11689.0016 1814.7909,-11689.0016 2034.0311,-11689.0016 2085.241,-11644.6037 2302.1917,-11613.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2302.1917,-11613.0016C2575.0152,-11571.9138 2464.3091,-11306.5972 2554.9226,-11046.0016 2576.1644,-10984.9123 2558.2899,-10960.8426 2590.9226,-10905.0016 2639.9159,-10821.1645 2685.177,-10827.3356 2748.8254,-10754.0016 2837.7143,-10651.5862 2882.4665,-10634.2369 2926.5784,-10506.0016 2958.5189,-10413.1491 2957.8201,-9721.0789 2962.5784,-9623.0016 2992.037,-9015.7997 3037.7377,-8271.5366 3046.0515,-8137.2624"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3049.5562,-8137.2923 3046.6818,-8127.0949 3042.5697,-8136.8591 3049.5562,-8137.2923"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge394" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M916.6465,-11537.0016C1149.4466,-11509.6309 1208.2803,-11575.0016 1442.684,-11575.0016 1442.684,-11575.0016 1442.684,-11575.0016 1814.7909,-11575.0016 1909.3964,-11575.0016 1919.5153,-11517.1974 1989.9177,-11454.0016 2075.5358,-11377.1477 2108.5035,-11368.3396 2179.7498,-11278.0016 2199.9595,-11252.3763 2196.3993,-11240.2818 2215.7498,-11214.0016 2282.0912,-11123.9023 2332.5173,-11127.8006 2388.6335,-11031.0016 2416.3465,-10983.1976 2407.8084,-10964.6338 2424.6335,-10912.0016 2562.0152,-10482.2452 2670.2585,-10394.2893 2748.8254,-9950.0016 2804.5278,-9635.011 2752.4841,-8829.2403 2784.8254,-8511.0016 2799.4836,-8366.7657 2837.1416,-8196.0287 2850.7238,-8137.1729"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2854.1812,-8137.7574 2853.0373,-8127.2245 2847.3631,-8136.1718 2854.1812,-8137.7574"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge359" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-7585.0016C261.4711,-7795.1026 243.5722,-11276.8009 399.0839,-11423.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-11423.0016C407.3345,-11430.7582 1117.9521,-11062.8246 1127.6646,-11057.0016 1309.4454,-10948.0171 1352.4435,-10915.2466 1517.2698,-10782.0016 1687.0265,-10644.7709 1757.0578,-10630.528 1878.2922,-10449.0016 1958.2301,-10329.3093 1941.5692,-10280.5697 1989.9177,-10145.0016 2006.3483,-10098.9307 1997.5464,-10080.8459 2025.9177,-10041.0016 2076.3723,-9970.1439 2141.1978,-9997.9774 2179.7498,-9920.0016 2242.912,-9792.2488 2169.3802,-7489.7611 2215.7498,-7355.0016 2229.0786,-7316.2653 2261.1122,-7280.1237 2282.2168,-7259.3116"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2284.9233,-7261.5649 2289.7085,-7252.1122 2280.073,-7256.5176 2284.9233,-7261.5649"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge498" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1513.0016C424.6096,-1525.8098 626.1038,-1538.7163 654.4731,-1542.0016 955.7181,-1576.8873 1049.7741,-1511.2827 1332.0981,-1622.0016 1426.9156,-1659.1861 1461.4196,-1671.8323 1517.2698,-1757.0016 1557.4774,-1818.3167 1528.4747,-1848.9987 1553.2698,-1918.0016 1607.0434,-2067.6499 1674.0367,-2083.4294 1715.2896,-2237.0016 1790.925,-2518.5704 1713.5165,-2602.9084 1751.2896,-2892.0016 1787.2241,-3167.0239 1842.9999,-3227.8962 1878.2922,-3503.0016 1918.8351,-3819.0359 1873.3254,-3903.022 1914.2922,-4219.0016 1960.144,-4572.6591 2070.649,-4994.6045 2097.083,-5092.8484"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2093.7065,-5093.7707 2099.6935,-5102.5118 2100.4643,-5091.945 2093.7065,-5093.7707"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-1395.0016C275.2368,-1366.2688 266.6067,-1458.8816 317.2024,-1489.0016 349.7882,-1508.4002 365.6788,-1495.0506 399.0839,-1513.0016"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge647" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-631.0016C684.6774,-590.3866 718.7423,-610.0874 819.7932,-575.0016 942.2248,-532.4922 1769.4563,-155.367 1878.2922,-85.0016 1914.7552,-61.4273 1910.9172,-34.7444 1952.105,-21.0016"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.918,-2944.2111C225.6009,-3185.1996 254.7807,-7232.1477 317.2024,-7333.0016 360.4678,-7402.905 433.002,-7352.2341 480.9653,-7419.0016 540.0503,-7501.2511 461.6769,-7559.1536 516.9653,-7644.0016 556.709,-7704.994 613.7729,-7672.6433 654.4731,-7733.0016 701.7922,-7803.1754 625.2135,-7866.107 690.4731,-7920.0016 734.7898,-7956.6005 762.3262,-7920.997 819.7932,-7920.0016 1063.594,-7915.7788 1124.3237,-7906.541 1368.0981,-7901.0016 1450.3802,-7899.1319 1470.9677,-7899.4461 1553.2698,-7899.0016 1697.7221,-7898.2215 1749.0883,-7834.3996 1878.2922,-7899.0016 1902.1436,-7910.9273 1895.2329,-7928.3508 1914.2922,-7947.0016 1957.9167,-7989.691 1969.7216,-8003.18 2025.9177,-8027.0016 2057.9087,-8040.5626 2071.6356,-8056.2987 2102.8337,-8041.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2102.8337,-8041.0016C2156.2733,-8026.9707 2163.9739,-8008.2865 2215.7498,-7989.0016 2226.5066,-7984.9951 2238.2096,-7981.2289 2249.4295,-7977.8953"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2250.5001,-7981.2291 2259.1292,-7975.0818 2248.55,-7974.5062 2250.5001,-7981.2291"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ff2600" stroke-dasharray="5,2" d="M223.9464,-2944.365C226.1997,-3184.5613 264.2172,-7153.2456 317.2024,-7257.0016 358.7232,-7338.3078 424.6412,-7309.1527 480.9653,-7381.0016 536.9992,-7452.4804 568.9615,-7558.481 580.6133,-7603.0545"/>
<polygon fill="#ff2600" stroke="#ff2600" points="577.228,-7603.9437 583.0834,-7612.7734 584.0123,-7602.2194 577.228,-7603.9437"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge58" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff4c00" stroke-dasharray="5,2" d="M585.7192,-6025.0016C746.935,-6010.6703 754.7949,-6177.0016 916.6465,-6177.0016 916.6465,-6177.0016 916.6465,-6177.0016 1070.5822,-6177.0016 1231.8834,-6177.0016 1599.3699,-5979.2098 1751.2896,-5925.0016 1823.436,-5899.2582 1841.0855,-5891.5538 1914.2922,-5869.0016 1956.9922,-5855.8474 2258.4263,-5754.0063 2302.1917,-5763.0016"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge87" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ff7200" stroke-dasharray="5,2" d="M225.1513,-2921.7202C232.1954,-2860.627 265.8094,-2563.1521 281.2024,-2319.0016 285.0427,-2258.0898 279.1396,-1268.7114 317.2024,-1221.0016 364.1321,-1162.1775 430.9438,-1234.2201 480.9653,-1178.0016 557.0486,-1092.4926 455.5438,-1019.5824 516.9653,-923.0016 609.0524,-778.2015 1010.441,-578.265 1163.6646,-501.0016 1250.218,-457.3568 1277.0229,-458.1929 1368.0981,-425.0016 1522.0469,-368.8968 1571.6549,-379.85 1715.2896,-301.0016 1733.0581,-291.2475 1732.1169,-279.5799 1751.2896,-273.0016 1804.68,-254.6829 1822.8549,-262.3806 1878.2922,-273.0016 2086.7525,-312.9397 2569.2249,-552.8895 2748.8254,-666.0016 2831.4226,-718.0211 2880.0131,-709.2112 2926.5784,-795.0016 2985.1356,-902.8855 3040.6234,-2887.2839 3046.8022,-3114.8024"/>
<polygon fill="#ff7200" stroke="#ff7200" points="3043.3035,-3114.9039 3047.0727,-3124.8056 3050.301,-3114.7146 3043.3035,-3114.9039"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge99" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M399.0839,-6101.0016C453.9286,-6123.2785 461.208,-6058.8843 516.9653,-6039.0016 546.3381,-6028.5275 554.5397,-6024.4561 585.7192,-6025.0016"/>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M585.7192,-6025.0016C610.0981,-6025.4281 1423.2154,-5849.6811 1442.684,-5835.0016"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge133" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M399.0839,-6863.0016C842.4588,-7139.9771 1040.8421,-7012.7961 1517.2698,-7228.0016 1687.0514,-7304.6931 1721.4175,-7340.5142 1878.2922,-7441.0016 2071.3573,-7564.6711 2129.9078,-7886.2845 2302.1917,-7735.0016"/>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M2302.1917,-7735.0016C2466.9712,-7582.4467 2359.5264,-6896.1685 2424.6335,-6511.0016 2436.9927,-6437.8859 2466.9258,-6354.7858 2481.5124,-6316.8598"/>
<polygon fill="#ffe500" stroke="#ffe500" points="2484.8263,-6317.995 2485.1923,-6307.4065 2478.3031,-6315.4557 2484.8263,-6317.995"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge144" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#f2ff00" stroke-dasharray="5,2" d="M223.9246,-2944.0275C225.8116,-3189.4353 259.3942,-7450.3102 317.2024,-7561.0016 358.8514,-7640.7514 436.4218,-7601.8316 480.9653,-7680.0016 565.8313,-7828.9341 464.011,-7900.9711 516.9653,-8064.0016 563.7187,-8207.9412 568.5071,-8267.3981 690.4731,-8357.0016 1058.8881,-8627.6612 1279.8686,-8305.7363 1715.2896,-8445.0016 1799.0104,-8471.7789 1832.0711,-8482.2366 1878.2922,-8557.0016 1939.1733,-8655.4797 1826.9513,-8739.0016 1914.2922,-8815.0016 1939.6481,-8837.0651 1962.7309,-8834.7652 1989.9177,-8815.0016 2031.8676,-8784.506 1987.31,-8738.6314 2025.9177,-8704.0016 2032.4833,-8698.1125 2040.6395,-8694.1777 2049.164,-8691.5856"/>
<polygon fill="#f2ff00" stroke="#f2ff00" points="2050.0044,-8694.9832 2058.8796,-8689.1969 2048.3331,-8688.1857 2050.0044,-8694.9832"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge147" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M223.9262,-2944.2066C225.8471,-3193.6001 260.0111,-7523.6892 317.2024,-7637.0016 327.5256,-7657.4549 347.9325,-7673.182 365.7903,-7683.8072"/>
<polygon fill="#cbff00" stroke="#cbff00" points="364.3985,-7687.0402 374.8294,-7688.8965 367.8328,-7680.9405 364.3985,-7687.0402"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge149" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#a5ff00" stroke-dasharray="5,2" d="M223.9798,-2944.1008C227.9875,-3263.689 317.2024,-10378.0016 317.2024,-10378.0016 324.8726,-10388.2285 336.6313,-10394.4055 348.8654,-10398.0994"/>
<polygon fill="#a5ff00" stroke="#a5ff00" points="348.1596,-10401.5306 358.7099,-10400.5595 349.8568,-10394.7394 348.1596,-10401.5306"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge212" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M755.1332,-2231.0016C801.872,-2214.662 928.1779,-2221.3434 977.4998,-2217.0016 1044.4072,-2211.1118 1061.144,-2209.2922 1127.6646,-2200.0016 1218.8865,-2187.2611 1266.115,-2230.2667 1332.0981,-2166.0016 1392.4172,-2107.2531 1305.3662,-2036.1664 1368.0981,-1980.0016 1429.6136,-1924.9259 1470.7691,-1968.3377 1553.2698,-1965.0016 1697.6124,-1959.1649 1736.1979,-1941.9621 1878.2922,-1968.0016 1930.1294,-1977.5011 1952.6844,-1970.7053 1989.9177,-2008.0016 2023.5865,-2041.7273 1994.6088,-2073.0744 2025.9177,-2109.0016 2051.2323,-2138.0503 2079.9548,-2117.9982 2102.8337,-2149.0016"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge220" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90</title>
<path fill="none" stroke="#33ff00" stroke-dasharray="5,2" d="M223.9622,-2944.126C226.8821,-3210.4884 281.7212,-8173.6644 317.2024,-8471.0016 336.9017,-8636.0845 291.5139,-8709.2376 399.0839,-8836.0016"/>
<path fill="none" stroke="#33ff00" stroke-dasharray="5,2" d="M399.0839,-8836.0016C435.9799,-8879.4811 606.9159,-8829.5358 654.4731,-8861.0016 682.3391,-8879.4388 662.6824,-8908.4511 690.4731,-8927.0016 774.5491,-8983.1228 815.5606,-8951.0016 916.6465,-8951.0016 916.6465,-8951.0016 916.6465,-8951.0016 1247.8813,-8951.0016 1455.9395,-8951.0016 1519.1784,-8907.5136 1715.2896,-8977.0016 1733.8928,-8983.5933 1733.9072,-8993.6536 1751.2896,-9003.0016 1804.4344,-9031.5822 1842.9617,-9002.0836 1878.2922,-9051.0016 1934.679,-9129.0737 1844.7943,-9850.3327 1914.2922,-9917.0016 1938.5476,-9940.2696 1961.0154,-9934.159 1989.9177,-9917.0016 2018.6497,-9899.9453 2000.2087,-9872.3438 2025.9177,-9851.0016 2030.4856,-9847.2096 2035.6428,-9843.9882 2041.0699,-9841.2524"/>
<polygon fill="#33ff00" stroke="#33ff00" points="2042.6939,-9844.3605 2050.402,-9837.0916 2039.8434,-9837.9672 2042.6939,-9844.3605"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge280" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#0cff00" stroke-dasharray="5,2" d="M1070.5822,-933.0016C1075.7592,-928.8099 1158.124,-715.6995 1163.6646,-712.0016 1239.2387,-661.5618 1277.238,-711.2238 1368.0981,-711.0016 1434.3964,-710.8395 1451.0394,-707.9976 1517.2698,-711.0016 1605.5507,-715.0057 1628.4371,-712.6862 1715.2896,-729.0016 1798.3014,-744.5955 2154.9267,-850.7743 2179.7498,-867.0016 2299.521,-945.2984 2315.7885,-988.8385 2388.6335,-1112.0016 2411.6194,-1150.865 2398.8498,-1169.9352 2424.6335,-1207.0016 2507.2397,-1325.7552 2601.11,-1293.7314 2669.874,-1421.0016"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge285" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#00ff19" stroke-dasharray="5,2" d="M1952.105,-5759.0016C1976.3772,-5755.6649 2003.0561,-5754.635 2027.1347,-5754.671"/>
<polygon fill="#00ff19" stroke="#00ff19" points="2027.2541,-5758.1719 2037.2804,-5754.7481 2027.3073,-5751.1721 2027.2541,-5758.1719"/>
<path fill="none" stroke="#00ff19" stroke-dasharray="5,2" d="M585.7192,-6025.0016C690.0889,-6023.9395 716.5042,-6021.0191 819.7932,-6006.0016 1050.0676,-5972.5213 1105.4101,-5950.5349 1332.0981,-5898.0016 1519.3083,-5854.617 1563.1528,-5831.1732 1751.2896,-5792.0016 1839.8389,-5773.5649 1862.4994,-5771.3198 1952.105,-5759.0016"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge289" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataloopnode.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M223.9469,-2944.1299C226.5996,-3221.0086 278.3548,-8574.6584 317.2024,-8895.0016 364.9632,-9288.8449 217.5383,-9504.7382 516.9653,-9765.0016 714.8796,-9937.0296 1067.2131,-9873.1018 1197.5722,-9841.4809"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="1198.4317,-9844.8739 1207.302,-9839.0801 1196.7547,-9838.0777 1198.4317,-9844.8739"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge299" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M399.0839,-8836.0016C423.0719,-8864.6415 448.0452,-8837.3399 480.9653,-8855.0016 500.3585,-8865.4061 497.7929,-8878.196 516.9653,-8889.0016 572.2018,-8920.133 600.1231,-8894.3473 654.4731,-8927.0016 674.4151,-8938.983 670.02,-8953.9154 690.4731,-8965.0016 911.8897,-9085.0159 997.2182,-9091.4288 1247.8813,-9067.0016"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1247.8813,-9067.0016C1418.2648,-9045.5175 1462.5499,-9066.0222 1634.2797,-9067.0016"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1634.2797,-9067.0016C1681.7946,-9067.4322 1734.9408,-9079.8192 1771.1877,-9090.143"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1770.3643,-9093.5486 1780.9444,-9092.9885 1772.3243,-9086.8286 1770.3643,-9093.5486"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge305" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairsystems.f90</title>
<path fill="none" stroke="#00ff8c" stroke-dasharray="5,2" d="M585.7192,-2345.0016C640.9657,-2318.2544 637.5943,-2286.1691 690.4731,-2255.0016 716.8809,-2239.4366 727.0409,-2243.2679 755.1332,-2231.0016"/>
<path fill="none" stroke="#00ff8c" stroke-dasharray="5,2" d="M755.1332,-2231.0016C814.7598,-2204.966 1285.5976,-2176.5086 1332.0981,-2131.0016 1391.6529,-2072.7193 1315.2322,-2011.4127 1368.0981,-1947.0016 1424.5374,-1878.2369 1467.0727,-1893.0027 1553.2698,-1871.0016 1742.0944,-1822.8057 1835.912,-1711.5872 1989.9177,-1831.0016 2040.6895,-1870.3695 1991.3505,-1916.8471 2025.9177,-1971.0016 2038.0636,-1990.0299 2057.8734,-2006.0583 2074.3468,-2017.1859"/>
<polygon fill="#00ff8c" stroke="#00ff8c" points="2072.7908,-2020.3482 2083.0856,-2022.8516 2076.5988,-2014.4747 2072.7908,-2020.3482"/>
<path fill="none" stroke="#00ff8c" stroke-dasharray="5,2" d="M399.0839,-2459.0016C421.483,-2429.1027 447.8683,-2457.3295 480.9653,-2440.0016 487.9256,-2436.3576 578.648,-2348.4251 585.7192,-2345.0016"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge312" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ffb2" stroke-dasharray="5,2" d="M1247.8813,-8268.0016C1308.9921,-8256.6812 1375.4888,-8226.5122 1412.8369,-8207.7677"/>
<polygon fill="#00ffb2" stroke="#00ffb2" points="1414.8031,-8210.6942 1422.1264,-8203.0379 1411.627,-8204.4562 1414.8031,-8210.6942"/>
<path fill="none" stroke="#00ffb2" stroke-dasharray="5,2" d="M223.8858,-2944.1488C224.8959,-3187.9545 243.2185,-7350.3199 317.2024,-7447.0016 363.2947,-7507.2349 431.0738,-7437.8755 480.9653,-7495.0016 551.3378,-7575.5786 486.5713,-7630.429 516.9653,-7733.0016 558.9806,-7874.7931 604.1655,-7896.936 654.4731,-8036.0016 675.0134,-8092.7812 645.9218,-8126.2462 690.4731,-8167.0016 736.9149,-8209.4863 1185.9915,-8279.4664 1247.8813,-8268.0016"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge319" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M755.1332,-5304.0016C786.6809,-5302.1041 821.7575,-5301.8774 851.1403,-5302.2182"/>
<polygon fill="#00ffff" stroke="#00ffff" points="851.2326,-5305.7197 861.2808,-5302.3606 851.3309,-5298.7204 851.2326,-5305.7197"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge330" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00d8ff" stroke-dasharray="5,2" d="M399.0839,-1475.0016C416.9166,-1442.1738 444.9341,-1465.8719 480.9653,-1456.0016 578.9154,-1429.1695 817.7424,-1294.9329 916.6465,-1318.0016"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge339" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00b2ff" stroke-dasharray="5,2" d="M399.0839,-6101.0016C432.3083,-6119.2847 444.6824,-6113.9704 480.9653,-6125.0016 574.3695,-6153.3995 593.9818,-6176.1625 690.4731,-6191.0016 972.3263,-6234.3469 1047.4195,-6207.677 1332.0981,-6191.0016 1348.6387,-6190.0327 1366.4997,-6188.2554 1382.9428,-6186.3195"/>
<polygon fill="#00b2ff" stroke="#00b2ff" points="1383.4691,-6189.7814 1392.9733,-6185.0995 1382.6238,-6182.8326 1383.4691,-6189.7814"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge347" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M399.0839,-2459.0016C427.3237,-2421.2159 784.7248,-2484.4508 819.7932,-2516.0016 869.7978,-2560.9904 836.0106,-2598.7125 855.7932,-2663.0016 914.8027,-2854.769 924.789,-2906.037 1013.4998,-3086.0016 1069.1317,-3198.8603 1078.1146,-3233.7346 1163.6646,-3326.0016 1195.2661,-3360.0844 1215.0251,-3355.1268 1247.8813,-3388.0016"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M1247.8813,-3388.0016C1286.7821,-3429.3314 1298.6306,-3438.1611 1332.0981,-3484.0016 1373.3023,-3540.439 1413.4692,-3612.9049 1432.0165,-3647.6482"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1429.082,-3649.5856 1436.8572,-3656.7826 1435.2671,-3646.3077 1429.082,-3649.5856"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairloop.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge350" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairloop.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M1814.7909,-5265.0016C1851.0873,-5250.6214 1956.4709,-5230.8639 1989.9177,-5251.0016 2019.2138,-5268.6402 1999.7427,-5296.9959 2025.9177,-5319.0016 2032.7114,-5324.7131 2040.8395,-5329.1283 2049.2289,-5332.5391"/>
<polygon fill="#003fff" stroke="#003fff" points="2048.1604,-5335.8744 2058.7547,-5335.9788 2050.5378,-5329.2905 2048.1604,-5335.8744"/>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M223.8909,-2944.2356C224.8666,-3147.3359 241.514,-6036.9996 399.0839,-6101.0016"/>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M755.1332,-5304.0016C800.6632,-5301.2631 810.6412,-5290.465 855.7932,-5284.0016 950.6607,-5270.4216 974.7476,-5265.0016 1070.5822,-5265.0016 1070.5822,-5265.0016 1070.5822,-5265.0016 1442.684,-5265.0016 1608.0648,-5265.0016 1657.1624,-5315.0424 1814.7909,-5265.0016"/>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M399.0839,-6101.0016C578.8051,-6174.0011 561.3207,-5312.0874 755.1332,-5304.0016"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge437" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M2669.874,-509.0016C2703.6124,-520.4782 2714.3913,-513.8211 2748.8254,-523.0016 2829.9575,-544.6323 2874.6921,-520.9856 2926.5784,-587.0016 3019.113,-704.7354 2865.9935,-807.5671 2962.5784,-922.0016 2987.8404,-951.9323 3027.3124,-912.3619 3047.3719,-946.0016"/>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M225.1341,-2921.7191C232.089,-2860.6202 265.3143,-2563.1204 281.2024,-2319.0016 284.7299,-2264.8017 283.8474,-1384.868 317.2024,-1342.0016 340.491,-1312.0721 386.3108,-1353.7086 399.0839,-1318.0016"/>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M3047.3719,-946.0016C3175.9445,-1164.9676 3110.7879,-1257.9798 3132.1655,-1511.0016 3224.8055,-2607.4734 3233.0299,-6344.288 3233.5624,-6660.6249"/>
<polygon fill="#0019ff" stroke="#0019ff" points="3230.0626,-6660.7798 3233.5788,-6670.7742 3237.0626,-6660.7685 3230.0626,-6660.7798"/>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M399.0839,-1318.0016C411.8569,-1282.2946 456.1763,-1322.7008 480.9653,-1294.0016 556.3579,-1206.7166 457.9407,-1136.0915 516.9653,-1037.0016 608.352,-883.5829 1006.7474,-645.2414 1163.6646,-560.0016 1286.2577,-493.4071 1618.7446,-382.5418 1751.2896,-339.0016 1769.1684,-333.1285 1895.6511,-295.5815 1914.2922,-293.0016 1964.6885,-286.0268 2127.8797,-288.0393 2179.7498,-298.0016 2276.9178,-316.664 2304.5411,-322.8635 2388.6335,-375.0016 2407.338,-386.5986 2405.5381,-398.0604 2424.6335,-409.0016 2476.9701,-438.9891 2501.4466,-419.0966 2554.9226,-447.0016 2573.1374,-456.5065 2573.269,-465.491 2590.9226,-476.0016 2623.6007,-495.4574 2633.4686,-498.0003 2669.874,-509.0016"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge451" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0c00ff" stroke-dasharray="5,2" d="M267.6559,-2932.5753C313.0278,-2933.0581 379.9231,-2936.6548 399.0839,-2953.0016"/>
<path fill="none" stroke="#0c00ff" stroke-dasharray="5,2" d="M399.0839,-2953.0016C439.5109,-2987.4916 464.0124,-2937.4618 516.9653,-2933.0016 651.1069,-2921.703 689.4458,-2905.3688 819.7932,-2939.0016 909.1329,-2962.0534 1003.2912,-3020.3194 1046.4286,-3049.2176"/>
<polygon fill="#0c00ff" stroke="#0c00ff" points="1044.597,-3052.2043 1054.8392,-3054.9151 1048.523,-3046.4088 1044.597,-3052.2043"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge480" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M585.7192,-1589.0016C634.7132,-1585.9766 643.6403,-1568.7067 690.4731,-1554.0016 899.5997,-1488.3379 946.6936,-1446.1346 1163.6646,-1415.0016 1319.2515,-1392.6766 1360.6751,-1407.4438 1517.2698,-1421.0016 1678.7133,-1434.9793 1734.1563,-1397.9459 1878.2922,-1472.0016 1942.2181,-1504.8462 1952.5013,-1527.6396 1989.9177,-1589.0016 2015.3826,-1630.7633 1994.5142,-1655.5007 2025.9177,-1693.0016 2076.2067,-1753.0548 2133.7853,-1715.5774 2179.7498,-1779.0016 2228.6481,-1846.4742 2176.0586,-1889.7335 2215.7498,-1963.0016 2266.7832,-2057.207 2343.8011,-2033.6922 2388.6335,-2131.0016 2441.1855,-2245.0662 2388.0864,-2574.8486 2424.6335,-2695.0016 2458.1493,-2805.1885 2524.1157,-2808.0269 2554.9226,-2919.0016 2591.1859,-3049.6319 2577.9343,-5224.0549 2590.9226,-5359.0016 2606.6338,-5522.2388 2650.0193,-5715.7283 2664.8371,-5778.9129"/>
<polygon fill="#3200ff" stroke="#3200ff" points="2661.4792,-5779.9228 2667.185,-5788.85 2668.2917,-5778.3131 2661.4792,-5779.9228"/>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M225.0011,-2921.7094C231.2633,-2860.5599 261.4711,-2562.8399 281.2024,-2319.0016 290.6522,-2202.221 261.5758,-1896.1166 317.2024,-1793.0016 388.3606,-1661.0956 435.9593,-1594.8858 585.7192,-1589.0016"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge487" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#5900ff" stroke-dasharray="5,2" d="M399.0839,-2953.0016C772.1779,-3271.3035 179.8391,-4876.7262 585.7192,-5152.0016"/>
<path fill="none" stroke="#5900ff" stroke-dasharray="5,2" d="M585.7192,-5152.0016C683.0528,-5218.015 605.7437,-4990.5645 690.4731,-4909.0016 696.643,-4903.0623 704.3786,-4898.4933 712.3327,-4894.9916"/>
<polygon fill="#5900ff" stroke="#5900ff" points="713.6382,-4898.2393 721.6899,-4891.3531 711.1013,-4891.7152 713.6382,-4898.2393"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge528" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1070.5822,-2117.0016C1128.7727,-2114.0008 1289.1334,-2137.3612 1332.0981,-2098.0016 1406.1255,-2030.1859 1309.4195,-1956.4622 1368.0981,-1875.0016 1545.8945,-1628.176 1708.2886,-1474.0255 1989.9177,-1589.0016 2124.223,-1643.8322 2332.8856,-1963.6334 2424.6335,-2076.0016 2482.4155,-2146.77 2521.9532,-2149.7964 2554.9226,-2235.0016 2560.1521,-2248.5166 2657.5568,-4199.8969 2668.8157,-4425.7608"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="2665.3304,-4426.1446 2669.3239,-4435.958 2672.3217,-4425.7961 2665.3304,-4426.1446"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge535" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#a500ff" stroke-dasharray="5,2" d="M1070.5822,-7319.0016C1115.512,-7334.0651 1120.2442,-7352.0207 1163.6646,-7371.0016 1172.379,-7374.8111 1808.5251,-7575.8467 1814.7909,-7583.0016"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairflownetwork.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge540" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairflownetwork.f90</title>
<path fill="none" stroke="#ff00e5" stroke-dasharray="5,2" d="M225.1864,-2921.7224C232.4137,-2860.6403 266.8256,-2563.2141 281.2024,-2319.0016 286.0098,-2237.3408 280.9664,-920.3403 317.2024,-847.0016 385.0481,-709.6874 433.4896,-647.8649 585.7192,-631.0016"/>
<path fill="none" stroke="#ff00e5" stroke-dasharray="5,2" d="M585.7192,-631.0016C615.556,-618.4598 624.6385,-619.5483 654.4731,-607.0016 741.1853,-570.5357 839.6121,-518.8141 887.4476,-492.9804"/>
<polygon fill="#ff00e5" stroke="#ff00e5" points="889.1975,-496.0131 896.3217,-488.1711 885.8621,-489.8588 889.1975,-496.0131"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge551" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M399.0839,-6101.0016C433.3688,-6117.2092 450.0117,-6103.0924 480.9653,-6125.0016 503.316,-6140.8216 495.9456,-6157.4517 516.9653,-6175.0016 691.8797,-6321.0418 1253.6773,-6743.2779 1442.684,-6616.0016"/>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1442.684,-6616.0016C1512.4128,-6566.9589 1584.5809,-6495.5311 1616.8564,-6462.2878"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="1619.4047,-6464.6874 1623.8278,-6455.06 1614.3664,-6459.8278 1619.4047,-6464.6874"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge567" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M585.7192,-6863.0016C633.6567,-6869.8836 643.5657,-6880.9578 690.4731,-6893.0016 973.7411,-6965.7329 1049.2064,-6964.8205 1332.0981,-7039.0016 1503.9715,-7084.071 1554.9551,-7076.4212 1715.2896,-7153.0016 1794.6056,-7190.8852 1820.945,-7198.3871 1878.2922,-7265.0016 1902.1542,-7292.7196 1891.6625,-7310.2688 1914.2922,-7339.0016 1954.0705,-7389.5078 1965.4087,-7409.2797 2025.9177,-7431.0016 2090.2668,-7454.102 2112.9465,-7445.5533 2179.7498,-7431.0016 2214.6317,-7423.4033 2251.4725,-7404.9397 2275.5199,-7391.2795"/>
<polygon fill="#ff0098" stroke="#ff0098" points="2277.4961,-7394.1792 2284.3854,-7386.1301 2273.9803,-7388.1262 2277.4961,-7394.1792"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge577" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0072" stroke-dasharray="5,2" d="M1247.8813,-5151.0016C1314.8204,-5107.4085 1387.4512,-5046.8075 1422.0734,-5017.009"/>
<polygon fill="#ff0072" stroke="#ff0072" points="1424.7571,-5019.3153 1430.0301,-5010.1258 1420.1774,-5014.0213 1424.7571,-5019.3153"/>
<path fill="none" stroke="#ff0072" stroke-dasharray="5,2" d="M585.7192,-5152.0016C707.5,-5234.5956 1124.5763,-5231.3023 1247.8813,-5151.0016"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge601" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M399.0839,-6863.0016C469.4341,-6906.9493 502.9985,-6856.851 585.7192,-6863.0016"/>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M585.7192,-6863.0016C632.5612,-6866.4845 643.6726,-6853.0022 690.4731,-6849.0016 1160.5678,-6808.8173 1279.7001,-6823.3952 1751.2896,-6809.0016 1775.0883,-6808.2752 2157.3204,-6806.991 2179.7498,-6799.0016 2198.8443,-6792.2001 2197.6897,-6780.2048 2215.7498,-6771.0016 2224.0295,-6766.7824 2233.1286,-6763.1741 2242.2193,-6760.1207"/>
<polygon fill="#ff004c" stroke="#ff004c" points="2243.5572,-6763.3687 2252.0411,-6757.0225 2241.4514,-6756.693 2243.5572,-6763.3687"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge608" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0026" stroke-dasharray="5,2" d="M399.0839,-2953.0016C438.9356,-2987.0008 502.887,-2978.0574 544.6053,-2966.8504"/>
<polygon fill="#ff0026" stroke="#ff0026" points="545.7824,-2970.1545 554.4452,-2964.0548 543.8693,-2963.421 545.7824,-2970.1545"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-7243.0016C408.7432,-7253.4594 640.318,-7262.4851 654.4731,-7264.0016 839.9575,-7283.8737 891.3199,-7267.384 1070.5822,-7319.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.9683,-2944.0375C226.4764,-3159.2985 265.6519,-6456.1424 317.2024,-6877.0016 337.4683,-7042.4528 288.9076,-7117.9176 399.0839,-7243.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1070.5822,-7319.0016C1105.6213,-7328.2745 1686.6053,-7396.8444 1715.2896,-7419.0016 1747.1108,-7443.582 1723.9609,-7472.507 1751.2896,-7502.0016 1794.6646,-7548.8143 1831.9423,-7525.1323 1878.2922,-7569.0016 1900.8782,-7590.3788 1897.3083,-7602.9506 1914.2922,-7629.0016 1961.2486,-7701.0262 1967.3234,-7724.0798 2025.9177,-7787.0016 2041.8974,-7804.1615 2062.5761,-7820.8494 2078.4673,-7832.7344"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2076.612,-7835.7144 2086.7429,-7838.8155 2080.7571,-7830.0736 2076.612,-7835.7144"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M399.0839,-7243.0016C409.6947,-7258.1072 463.1519,-7252.1591 480.9653,-7257.0016 773.3457,-7336.4836 1109.713,-7484.2794 1214.7876,-7531.8394"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1213.3913,-7535.0492 1223.9438,-7535.9954 1216.2846,-7528.6751 1213.3913,-7535.0492"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M399.0839,-1475.0016C415.9561,-1441.67 455.1681,-1483.0233 480.9653,-1456.0016 542.1242,-1391.9397 465.1296,-1331.8167 516.9653,-1260.0016 567.2359,-1190.3549 773.4416,-1098.4147 855.7932,-1074.0016 947.5715,-1046.794 975.2568,-1066.7537 1070.5822,-1058.0016"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M225.1044,-2921.7172C231.9043,-2860.6078 264.4547,-2563.063 281.2024,-2319.0016 284.3241,-2273.5092 289.0729,-1534.8909 317.2024,-1499.0016 340.5963,-1469.1543 381.8274,-1508.7707 399.0839,-1475.0016"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1070.5822,-1058.0016C1148.9448,-1048.7996 1178.6782,-1011.1029 1247.8813,-1049.0016"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1475.0016C416.9166,-1442.1738 454.4692,-1482.3384 480.9653,-1456.0016 529.897,-1407.3643 471.0574,-1356.5027 516.9653,-1305.0016 520.6628,-1300.8536 525.1046,-1297.3933 529.9282,-1294.5067"/>
<polygon fill="#ff0000" stroke="#ff0000" points="531.6283,-1297.5685 538.9449,-1289.9058 528.4466,-1291.3334 531.6283,-1297.5685"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M225.1453,-2921.7199C232.1587,-2860.6247 265.6385,-2563.1413 281.2024,-2319.0016 284.9264,-2260.586 281.5773,-1312.4462 317.2024,-1266.0016 321.1205,-1260.8936 326.0567,-1256.7983 331.5542,-1253.5194"/>
<polygon fill="#00ffff" stroke="#00ffff" points="333.2048,-1256.6074 340.5898,-1249.0106 330.0792,-1250.344 333.2048,-1256.6074"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge71" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1318.0016C411.8426,-1282.2895 454.5055,-1321.168 480.9653,-1294.0016 524.5917,-1249.2102 476.0563,-1205.2878 516.9653,-1158.0016 571.8161,-1094.6003 613.3255,-1116.8128 690.4731,-1084.0016 762.2261,-1053.4848 939.5052,-971.5896 1013.4998,-947.0016 1038.2888,-938.7643 1048.277,-946.5968 1070.5822,-933.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1070.5822,-933.0016C1121.3392,-890.2333 1106.77,-858.0003 1127.6646,-795.0016 1148.1607,-733.2042 1120.1696,-701.4495 1163.6646,-653.0016 1272.1276,-532.1873 1718.1137,-474.4845 1878.2922,-501.0016 2123.3325,-541.5673 2644.1551,-976.7585 2748.8254,-1202.0016 2797.2245,-1306.1528 2778.3206,-2120.3385 2784.8254,-2235.0016 2804.8066,-2587.2167 2844.3605,-3015.7382 2853.6948,-3114.8534"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2850.2114,-3115.1955 2854.6365,-3124.8219 2857.1804,-3114.537 2850.2114,-3115.1955"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge110" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.0306,-2944.217C227.1312,-3126.048 267.7838,-5466.8859 317.2024,-6153.0016 340.0223,-6469.8279 127.8217,-6697.7246 399.0839,-6863.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-6863.0016C538.5372,-6947.9689 384.2585,-6610.1624 516.9653,-6515.0016 605.1945,-6451.7347 659.4334,-6558.9634 1163.6646,-6631.0016 1371.9972,-6660.7656 1620.978,-6667.8685 1741.812,-6669.5261"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1742.0024,-6673.0288 1752.0466,-6669.6576 1742.0924,-6666.0293 1742.0024,-6673.0288"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge136" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.9799,-2944.3158C227.8201,-3256.1058 309.8306,-9907.7341 317.2024,-9917.0016 345.0013,-9951.9493 981.0759,-10088.7068 1185.341,-10131.872"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1184.8045,-10135.3358 1195.3119,-10133.9772 1186.2506,-10128.4868 1184.8045,-10135.3358"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge159" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M916.6465,-1661.0016C931.4655,-1659.1996 1432.7582,-1759.8512 1442.684,-1771.0016"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge190" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M916.6465,-2079.0016C1010.635,-2070.2997 1034.2382,-2068.4581 1127.6646,-2055.0016 1215.0336,-2042.4176 1315.39,-2024.2496 1378.9009,-2012.2878"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1379.5937,-2015.7189 1388.77,-2010.4231 1378.294,-2008.8406 1379.5937,-2015.7189"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge200" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M224.2031,-2921.9409C226.6919,-2852.7864 243.424,-2480.2027 317.2024,-2400.0016 368.1489,-2344.62 432.1564,-2414.276 480.9653,-2357.0016 534.2611,-2294.4623 488.6153,-2066.1241 516.9653,-1989.0016 528.4117,-1957.8632 552.0495,-1927.3236 568.3887,-1908.5833"/>
<polygon fill="#0000ff" stroke="#0000ff" points="571.045,-1910.8634 575.0997,-1901.0752 565.826,-1906.1985 571.045,-1910.8634"/>
</g>
<!-- sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node56" class="node">
<title>sourcefile~sortandstringutilities.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node56"><a xlink:href="../sourcefile/sortandstringutilities.f90.html" xlink:title="SortAndStringUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.3044,-2925.007 334.8633,-2925.007 334.8633,-2902.9962 463.3044,-2902.9962 463.3044,-2925.007"/>
<text text-anchor="middle" x="399.0839" y="-2910.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SortAndStringUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge166" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M267.6098,-2928.2561C284.8758,-2926.3841 305.2027,-2924.1803 324.6437,-2922.0725"/>
<polygon fill="#ff0000" stroke="#ff0000" points="325.1439,-2925.5388 334.7083,-2920.9813 324.3893,-2918.5796 325.1439,-2925.5388"/>
</g>
<!-- sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node57" class="node">
<title>sourcefile~dataoutputs.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node57"><a xlink:href="../sourcefile/dataoutputs.f90.html" xlink:title="DataOutputs.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="443.5485,-2509.007 354.6193,-2509.007 354.6193,-2486.9962 443.5485,-2486.9962 443.5485,-2509.007"/>
<text text-anchor="middle" x="399.0839" y="-2494.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataOutputs.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge167" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M224.8747,-2921.9388C230.6178,-2862.7681 260.4,-2584.0751 317.2024,-2523.0016 324.6424,-2515.0021 334.5599,-2509.5353 344.9189,-2505.8062"/>
<polygon fill="#7fff00" stroke="#7fff00" points="345.9765,-2509.1428 354.498,-2502.8473 343.9105,-2502.4546 345.9765,-2509.1428"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge177" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M916.6465,-2079.0016C934.1146,-2077.9277 1059.4558,-2043.9012 1070.5822,-2041.0016"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M585.7192,-2155.0016C704.0301,-2061.3232 766.0233,-2088.262 916.6465,-2079.0016"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M224.531,-2921.93C228.6938,-2858.7622 252.4746,-2544.4097 317.2024,-2478.0016 343.2783,-2451.2488 376.7191,-2488.9263 399.0839,-2459.0016"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-2459.0016C421.4486,-2429.0769 453.3747,-2465.1895 480.9653,-2440.0016 518.644,-2405.6042 499.6772,-2379.0015 516.9653,-2331.0016 545.4226,-2251.9912 519.1866,-2206.2448 585.7192,-2155.0016"/>
</g>
<!-- sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node59" class="node">
<title>sourcefile~dataglobalconstants.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node59"><a xlink:href="../sourcefile/dataglobalconstants.f90.html" xlink:title="DataGlobalConstants.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="819.9536,-2547.007 690.3127,-2547.007 690.3127,-2524.9962 819.9536,-2524.9962 819.9536,-2547.007"/>
<text text-anchor="middle" x="755.1332" y="-2532.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobalConstants.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge182" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataglobalconstants.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M228.5679,-2921.8885C251.2993,-2870.0012 354.9662,-2650.3474 516.9653,-2561.0016 566.5883,-2533.6335 630.8876,-2528.3219 680.1669,-2529.3378"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="680.3438,-2532.8446 690.4439,-2529.645 680.553,-2525.8477 680.3438,-2532.8446"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataroomair.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge168" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataroomair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.4578,-2921.642C228.2805,-2855.3599 250.7773,-2518.9658 317.2024,-2445.0016 324.2016,-2437.208 333.5528,-2431.8108 343.4306,-2428.0812"/>
<polygon fill="#ff0000" stroke="#ff0000" points="344.5607,-2431.3943 353.0028,-2424.9926 342.4111,-2424.7325 344.5607,-2431.3943"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge254" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M916.6465,-1661.0016C1186.2033,-1640.5447 1338.2285,-1554.4588 1517.2698,-1757.0016 1587.8325,-1836.8265 1515.1755,-1894.5032 1553.2698,-1994.0016 1600.2121,-2116.6101 1658.695,-2122.5386 1715.2896,-2241.0016 1763.937,-2342.8297 1977.5158,-3106.0566 2025.9177,-3208.0016 2079.7774,-3321.4418 2128.5291,-3330.3457 2179.7498,-3445.0016 2250.1251,-3602.5346 2287.9649,-3809.5086 2298.8485,-3875.6891"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2295.4195,-3876.4098 2300.4678,-3885.7245 2302.3301,-3875.2947 2295.4195,-3876.4098"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-1589.0016C736.1859,-1585.0077 766.1508,-1658.3139 916.6465,-1661.0016"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge227" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-2345.0016C865.7953,-2214.3613 1170.2249,-2645.5251 1235.2368,-2744.2883"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1232.3786,-2746.313 1240.772,-2752.7784 1238.2425,-2742.4899 1232.3786,-2746.313"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datawater.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge233" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datawater.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M585.7192,-1589.0016C755.6059,-1586.9963 950.8844,-1523.0464 1032.0774,-1493.5924"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1033.672,-1496.7358 1041.8582,-1490.0101 1031.2645,-1490.1628 1033.672,-1496.7358"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge322" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M225.1126,-2921.7177C231.9552,-2860.6113 264.6915,-2563.0791 281.2024,-2319.0016 284.4223,-2271.4018 288.0193,-1498.7436 317.2024,-1461.0016 319.6884,-1457.7864 322.5776,-1454.9729 325.7553,-1452.5118"/>
<polygon fill="#ff0000" stroke="#ff0000" points="327.6653,-1455.4449 334.1836,-1447.0925 323.8794,-1449.557 327.6653,-1455.4449"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge324" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M225.1214,-2921.7183C232.01,-2860.615 264.9463,-2563.0962 281.2024,-2319.0016 284.5386,-2268.9061 285.641,-1455.0474 317.2024,-1416.0016 318.1826,-1414.789 319.2225,-1413.6408 320.3154,-1412.5538"/>
<polygon fill="#00ffff" stroke="#00ffff" points="322.5987,-1415.2096 328.2282,-1406.2341 318.2302,-1409.74 322.5987,-1415.2096"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node67" class="node">
<title>sourcefile~databranchnodeconnections.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node67"><a xlink:href="../sourcefile/databranchnodeconnections.f90.html" xlink:title="DataBranchNodeConnections.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1332.3155,-2089.007 1163.4472,-2089.007 1163.4472,-2066.9962 1332.3155,-2066.9962 1332.3155,-2089.007"/>
<text text-anchor="middle" x="1247.8813" y="-2074.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBranchNodeConnections.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchnodeconnections.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge343" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchnodeconnections.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-2155.0016C673.6548,-2092.1675 962.6665,-2122.9182 1070.5822,-2117.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1070.5822,-2117.0016C1116.7043,-2114.6231 1168.1168,-2102.1894 1203.6515,-2091.991"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1205.0786,-2095.22 1213.6901,-2089.048 1203.1093,-2088.5027 1205.0786,-2095.22"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge423" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.9378,-2944.1232C226.044,-3183.3459 262.22,-7206.7938 317.2024,-7720.0016 366.2718,-8178.0177 229.1235,-8377.3718 516.9653,-8737.0016 577.6085,-8812.7692 819.5984,-8913.0016 916.6465,-8913.0016 916.6465,-8913.0016 916.6465,-8913.0016 1247.8813,-8913.0016 1530.6591,-8913.0016 1710.132,-8771.6575 1878.2922,-8999.0016 1944.6699,-9088.7408 1873.4951,-9396.104 1914.2922,-9500.0016 1943.2516,-9573.7521 1960.4495,-9594.3733 2025.9177,-9639.0016 2085.0966,-9679.3426 2119.4606,-9648.3396 2179.7498,-9687.0016 2199.8831,-9699.9127 2194.6237,-9715.7883 2215.7498,-9727.0016 2298.5383,-9770.944 2331.1287,-9749.5418 2424.6335,-9756.0016 2482.4021,-9759.9926 2497.5126,-9763.566 2554.9226,-9756.0016 2643.3822,-9744.3462 2669.6085,-9745.058 2748.8254,-9704.0016 2840.0959,-9656.6981 2879.0995,-9647.181 2926.5784,-9556.0016 2995.1047,-9424.4022 3040.1319,-8306.3695 3046.5739,-8137.3657"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3050.0762,-8137.3678 3046.9566,-8127.2426 3043.0812,-8137.1032 3050.0762,-8137.3678"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge396" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8755,-2944.3421C224.6612,-3192.3744 239.2136,-7426.8675 317.2024,-7523.0016 364.2749,-7581.0262 431.4485,-7505.0484 480.9653,-7561.0016 531.0247,-7617.5678 487.5198,-7829.4413 516.9653,-7899.0016 554.178,-7986.9106 610.8921,-7979.0695 654.4731,-8064.0016 683.6073,-8120.7792 654.1147,-8150.5559 690.4731,-8203.0016 741.6122,-8276.7677 774.2161,-8281.5608 855.7932,-8319.0016 1284.1265,-8515.5904 1583.8815,-8231.9813 1878.2922,-8600.0016 1939.3002,-8676.263 1862.738,-8955.0562 1914.2922,-9038.0016 1944.8368,-9087.1446 1970.1566,-9089.5518 2025.9177,-9105.0016 2254.4698,-9168.3269 2393.8102,-9209.0388 2554.9226,-9035.0016 2605.6363,-8980.2196 2553.4139,-8765.5465 2590.9226,-8701.0016 2634.4131,-8626.1632 2701.0783,-8659.1987 2748.8254,-8587.0016 2799.6273,-8510.1855 2841.9382,-8218.4015 2852.9246,-8137.1276"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2856.409,-8137.4764 2854.2646,-8127.1009 2849.4707,-8136.5491 2856.409,-8137.4764"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge360" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-6863.0016C1087.3473,-6927.5495 1249.0267,-6805.0524 1715.2896,-7001.0016 1819.6573,-7044.8626 1819.1721,-7098.613 1914.2922,-7160.0016 1961.0964,-7190.2081 1974.3383,-7195.963 2025.9177,-7217.0016 2059.0759,-7230.5264 2067.4397,-7235.5566 2102.8337,-7241.0016"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge500" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-5152.0016C634.8737,-5188.7633 632.9175,-5220.6725 690.4731,-5242.0016 744.3671,-5261.9738 762.3433,-5243.7182 819.7932,-5242.0016 931.4043,-5238.6668 958.9212,-5227.0016 1070.5822,-5227.0016 1070.5822,-5227.0016 1070.5822,-5227.0016 1442.684,-5227.0016 1556.2031,-5227.0016 1866.3611,-5263.3965 1952.105,-5189.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1952.105,-5189.0016C1981.8248,-5162.7953 1990.3222,-5156.4085 2025.9177,-5139.0016 2034.1619,-5134.97 2043.2101,-5131.3675 2052.1144,-5128.2377"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2053.3083,-5131.5289 2061.6751,-5125.0291 2051.0811,-5124.8926 2053.3083,-5131.5289"/>
</g>
<!-- sourcefile~dataairflownetwork.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge648" class="edge">
<title>sourcefile~dataairflownetwork.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2669.874,-414.0016C2788.2839,-432.8856 2824.9621,-433.3491 2926.5784,-497.0016 2992.3221,-538.1835 2991.1621,-569.5354 3047.3719,-623.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M922.8692,-465.7638C936.3616,-442.3875 970.5791,-388.1936 1013.4998,-358.0016 1081.1125,-310.4403 1637.6587,-139.4096 1715.2896,-111.0016 1821.0281,-72.308 1843.0865,-49.1586 1952.105,-21.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3233.5946,-1345.0016C3342.1663,-1371.5858 3394.9437,-9154.8447 3397.9737,-9615.6965"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3394.4739,-9615.7441 3398.0394,-9625.721 3401.4737,-9615.6982 3394.4739,-9615.7441"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1952.105,-21.0016C2230.7317,55.8612 2324.678,-90.2784 2554.9226,-265.0016 2621.5496,-315.5621 2589.0962,-392.3113 2669.874,-414.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3047.3719,-623.0016C3076.6465,-649.0212 3106.3504,-617.5466 3132.1655,-647.0016 3235.4749,-764.8773 3081.3517,-1307.7244 3233.5946,-1345.0016"/>
</g>
<!-- sourcefile~dataairflownetwork.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge60" class="edge">
<title>sourcefile~dataairflownetwork.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff4c00" stroke-dasharray="5,2" d="M974.0245,-488.0662C1085.794,-511.5546 1337.4767,-574.069 1517.2698,-691.0016 1712.5579,-818.0119 1748.4215,-877.6039 1878.2922,-1071.0016 1967.4135,-1203.7171 1957.6113,-1254.4671 2025.9177,-1399.0016 2103.4873,-1563.1367 2346.2792,-1954.4698 2388.6335,-2131.0016 2431.4603,-2309.5024 2408.9433,-5252.107 2424.6335,-5435.0016 2437.2678,-5582.2734 2472.5531,-5757.0597 2485.1972,-5816.784"/>
<polygon fill="#ff4c00" stroke="#ff4c00" points="2481.8374,-5817.8105 2487.3477,-5826.8596 2488.6832,-5816.3493 2481.8374,-5817.8105"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge649" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1952.105,-6937.0016C1966.0176,-6948.297 1974.9624,-6941.1282 1989.9177,-6951.0016 2009.3327,-6963.8193 2005.4943,-6977.8608 2025.9177,-6989.0016 2086.9956,-7022.319 2118.8891,-6984.2892 2179.7498,-7018.0016 2200.3846,-7029.4318 2199.1837,-7040.2085 2215.7498,-7057.0016 2290.1273,-7132.3987 2345.4099,-7124.3141 2388.6335,-7221.0016 2444.887,-7346.8359 2391.1046,-8327.306 2424.6335,-8461.0016 2484.0665,-8697.9888 2593.3484,-8720.9693 2669.874,-8953.0016"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1814.7909,-6823.0016C1827.6706,-6850.2856 1859.4058,-6823.4728 1878.2922,-6847.0016 1914.237,-6891.7818 1987.37,-7827.4415 2025.9177,-7870.0016 2049.556,-7896.1004 2072.4809,-7871.1517 2102.8337,-7889.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2102.8337,-7889.0016C2151.6018,-7914.1815 2164.1772,-7920.2233 2215.7498,-7939.0016 2226.6493,-7942.9703 2238.4979,-7946.7399 2249.8283,-7950.092"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2249.0361,-7953.5063 2259.6149,-7952.9249 2250.9824,-7946.7824 2249.0361,-7953.5063"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge59" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff4c00" stroke-dasharray="5,2" d="M1814.7909,-6101.0016C1837.0733,-6080.6596 1851.5078,-6090.8904 1878.2922,-6077.0016 1948.6439,-6040.5214 1957.5153,-6017.0173 2025.9177,-5977.0016 2055.5355,-5959.6751 2268.4621,-5845.3058 2302.1917,-5839.0016"/>
<path fill="none" stroke="#ff4c00" stroke-dasharray="5,2" d="M1654.2552,-6432.9859C1672.4917,-6421.9972 1699.0133,-6403.5312 1715.2896,-6381.0016 1792.6297,-6273.9475 1711.5258,-6183.3327 1814.7909,-6101.0016"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge88" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ff7200" stroke-dasharray="5,2" d="M1814.7909,-6631.0016C1967.9475,-6705.7664 2418.448,-6532.0869 2554.9226,-6430.0016 2663.3525,-6348.8942 2695.1329,-6319.31 2748.8254,-6195.0016 2877.2405,-5897.6961 3030.5832,-3413.3031 3046.091,-3157.2887"/>
<polygon fill="#ff7200" stroke="#ff7200" points="3049.5983,-3157.2724 3046.7077,-3147.0795 3042.611,-3156.8502 3049.5983,-3157.2724"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge100" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M1657.4883,-6432.823C1676.5457,-6422.2991 1702.4173,-6404.6253 1715.2896,-6381.0016 1758.8392,-6301.0775 1738.8474,-6063.1661 1751.2896,-5973.0016 1767.8914,-5852.6929 1798.3554,-5710.1392 1810.0485,-5657.1817"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="1813.4959,-5657.8023 1812.247,-5647.2813 1806.6624,-5656.2847 1813.4959,-5657.8023"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge134" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M1814.7909,-6405.0016C1844.5548,-6390.5197 2070.273,-6323.0506 2102.8337,-6329.0016"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge281" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#0cff00" stroke-dasharray="5,2" d="M2302.1917,-6449.0016C2417.2701,-6437.4629 2469.6695,-6465.1559 2554.9226,-6387.0016 2591.5978,-6353.3803 2570.4746,-6326.3595 2590.9226,-6281.0016 2649.0038,-6152.1653 2710.5485,-6141.0424 2748.8254,-6005.0016 2767.5819,-5938.3389 2744.0103,-4814.9466 2784.8254,-4759.0016 2787.1133,-4755.8657 2789.8265,-4753.121 2792.8355,-4750.719"/>
<polygon fill="#0cff00" stroke="#0cff00" points="2794.9408,-4753.5244 2801.4017,-4745.1276 2791.1146,-4747.6626 2794.9408,-4753.5244"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge300" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1637.9809,-6455.195C1651.4977,-6496.6902 1698.2899,-6645.8969 1715.2896,-6773.0016 1758.6071,-7096.8823 1735.2674,-7916.63 1751.2896,-8243.0016 1767.7612,-8578.5291 1804.0642,-8986.4981 1812.8488,-9082.8874"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1809.3634,-9083.2079 1813.7599,-9092.8474 1816.3343,-9082.5702 1809.3634,-9083.2079"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge439" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M1814.7909,-6709.0016C1846.7397,-6750.8479 1851.0243,-6763.965 1878.2922,-6809.0016 1912.3045,-6865.1774 1898.256,-6899.4138 1952.105,-6937.0016"/>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M1952.105,-6937.0016C1973.4005,-6951.8664 2155.1456,-6981.6893 2179.7498,-6990.0016 2276.1986,-7022.5862 2332.0981,-6999.3383 2388.6335,-7084.0016 2463.6983,-7196.4129 2390.3604,-8169.2485 2424.6335,-8300.0016 2464.9734,-8453.8993 2454.7792,-8534.6804 2590.9226,-8617.0016 2650.9767,-8653.3142 2680.1411,-8631.4083 2748.8254,-8617.0016 3016.3676,-8560.8839 3059.0697,-8399.412 3132.1655,-8136.0016 3211.7081,-7849.3597 3230.6987,-6862.7853 3233.2678,-6703.7287"/>
<polygon fill="#0019ff" stroke="#0019ff" points="3236.773,-6703.4199 3233.4305,-6693.3662 3229.7738,-6703.3099 3236.773,-6703.4199"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge481" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M1814.7909,-6405.0016C1842.385,-6392.8004 1852.7149,-6397.005 1878.2922,-6381.0016 1896.9491,-6369.3283 1896.4266,-6359.8533 1914.2922,-6347.0016 2176.301,-6158.5248 2345.313,-6250.4316 2554.9226,-6005.0016 2586.6885,-5967.8072 2567.5427,-5943.9653 2590.9226,-5901.0016 2607.9571,-5869.6984 2634.5705,-5838.04 2652.1152,-5818.7177"/>
<polygon fill="#3200ff" stroke="#3200ff" points="2654.816,-5820.9519 2659.0248,-5811.2289 2649.6713,-5816.2051 2654.816,-5820.9519"/>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M1693.652,-6434.4426C1729.2755,-6427.9047 1775.2061,-6418.0515 1814.7909,-6405.0016"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge529" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1814.7909,-6101.0016C1848.2107,-6074.3567 2528.7105,-5924.7619 2554.9226,-5891.0016 2601.9901,-5830.3803 2556.7348,-4578.7147 2590.9226,-4510.0016 2600.967,-4489.8137 2620.84,-4474.0116 2638.1339,-4463.2827"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="2640.033,-4466.2262 2646.8766,-4458.1382 2636.483,-4460.1932 2640.033,-4466.2262"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge568" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M1642.362,-6455.3351C1658.4256,-6478.3413 1694.5981,-6532.6191 1715.2896,-6583.0016 1739.6966,-6642.4314 1725.7552,-6664.0474 1751.2896,-6723.0016 1772.2142,-6771.313 1792.6341,-6775.2427 1814.7909,-6823.0016"/>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M1814.7909,-6823.0016C1827.4883,-6850.3709 1858.2162,-6824.4793 1878.2922,-6847.0016 1921.9019,-6895.9251 1881.8477,-6933.0573 1914.2922,-6990.0016 1940.1246,-7035.3408 2207.9936,-7287.0507 2282.8532,-7356.9774"/>
<polygon fill="#ff0098" stroke="#ff0098" points="2280.5479,-7359.6135 2290.2464,-7363.8784 2285.3244,-7354.4963 2280.5479,-7359.6135"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge602" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M2102.8337,-6785.0016C2154.9528,-6782.4587 2213.4211,-6769.8272 2253.4887,-6759.6185"/>
<polygon fill="#ff004c" stroke="#ff004c" points="2254.463,-6762.9816 2263.2639,-6757.0828 2252.7054,-6756.2059 2254.463,-6762.9816"/>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M1641.8147,-6455.114C1657.1961,-6478.1553 1692.6613,-6533.1518 1715.2896,-6583.0016 1736.0287,-6628.6899 1715.2156,-6655.1276 1751.2896,-6690.0016 1772.4695,-6710.4771 1797.8691,-6684.8875 1814.7909,-6709.0016"/>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M1814.7909,-6709.0016C1848.8853,-6757.5873 2078.4256,-6786.1925 2102.8337,-6785.0016"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge72" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1814.7909,-6631.0016C1904.6712,-6685.2771 1928.825,-6564.9679 2025.9177,-6525.0016 2143.6808,-6476.5269 2176.1125,-6466.9457 2302.1917,-6449.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2302.1917,-6449.0016C2309.8494,-6446.9297 2550.3702,-6322.4985 2554.9226,-6316.0016 2622.6251,-6219.3818 2539.1481,-6159.013 2590.9226,-6053.0016 2635.0459,-5962.6566 2710.2206,-5983.8389 2748.8254,-5891.0016 2798.1489,-5772.3881 2773.6496,-3706.9746 2784.8254,-3579.0016 2799.1123,-3415.4049 2837.9423,-3220.7915 2851.1972,-3157.2215"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2854.6668,-3157.7293 2853.2972,-3147.2233 2847.8163,-3156.2903 2854.6668,-3157.7293"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1689.2272,-6455.0351C1698.5106,-6458.5028 1707.6133,-6463.0482 1715.2896,-6469.0016 1782.0585,-6520.7854 1738.8587,-6593.9346 1814.7909,-6631.0016"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge111" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1694.0003,-6454.2021C1702.0081,-6457.7734 1709.4558,-6462.5689 1715.2896,-6469.0016 1768.9259,-6528.1443 1699.9304,-6583.871 1751.2896,-6645.0016 1754.0761,-6648.3184 1757.3621,-6651.1977 1760.9479,-6653.6968"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1759.368,-6656.8277 1769.7651,-6658.8652 1762.9079,-6650.7887 1759.368,-6656.8277"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge255" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1656.9932,-6432.9664C1676.0097,-6422.4267 1702.0948,-6404.651 1715.2896,-6381.0016 1787.6041,-6251.3897 1702.2287,-6189.079 1751.2896,-6049.0016 1786.0956,-5949.6241 1844.1606,-5948.6127 1878.2922,-5849.0016 1933.2824,-5688.5163 1867.7255,-5632.1304 1914.2922,-5469.0016 1935.0043,-5396.4448 1963.5713,-5387.7076 1989.9177,-5317.0016 2012.3505,-5256.7988 1981.6563,-5223.5691 2025.9177,-5177.0016 2050.5887,-5151.0453 2091.9037,-5187.1032 2102.8337,-5153.0016"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge424" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1814.7909,-6709.0016C1901.4797,-6827.5737 2313.4078,-6910.8455 2388.6335,-7037.0016 2444.3819,-7130.4935 2407.2839,-7908.5419 2424.6335,-8016.0016 2466.7631,-8276.943 2379.4986,-8428.3662 2590.9226,-8587.0016 2687.5981,-8659.539 2754.5867,-8591.2099 2855.7019,-8525.0016"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge397" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2102.8337,-6785.0016C2147.123,-6786.0521 2269.184,-6755.4527 2302.1917,-6785.0016"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge363" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1814.7909,-6709.0016C1845.334,-6751.8846 1857.4497,-6760.6547 1878.2922,-6809.0016 1904.0672,-6868.7901 1875.4493,-6898.7499 1914.2922,-6951.0016 1948.8124,-6997.4382 1975.8535,-6988.9918 2025.9177,-7018.0016 2093.6905,-7057.2727 2118.6279,-7055.017 2179.7498,-7104.0016 2224.6722,-7140.0036 2267.107,-7193.3299 2288.2368,-7221.6631"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2285.5767,-7223.9533 2294.3246,-7229.9303 2291.2133,-7219.8026 2285.5767,-7223.9533"/>
</g>
<!-- sourcefile~hvacsteamcoilcomponent.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge650" class="edge">
<title>sourcefile~hvacsteamcoilcomponent.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2304.5417,-7386.2494C2316.1702,-7442.4459 2367.8249,-7698.5239 2388.6335,-7911.0016 2410.6966,-8136.2875 2361.8413,-8711.5214 2424.6335,-8929.0016 2456.5816,-9039.6532 2519.2139,-9043.5058 2554.9226,-9153.0016 2578.8906,-9226.4961 2541.6897,-9439.4027 2590.9226,-9499.0016 2725.8986,-9662.3969 2844.407,-9575.9952 3047.3719,-9637.0016"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge651" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1445.9854,-4987.8412C1492.0722,-4832.0617 2005.4961,-3097.0437 2025.9177,-3047.0016 2156.6732,-2726.5913 2265.6785,-2681.4855 2388.6335,-2358.0016 2498.256,-2069.5946 2497.997,-1987.2427 2554.9226,-1684.0016 2566.3752,-1622.994 2549.2966,-1453.049 2590.9226,-1407.0016 2601.0539,-1395.7943 2840.659,-1346.4004 2855.7019,-1345.0016"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1814.7909,-5075.0016C1875.5836,-5080.3606 1891.0801,-5074.3351 1952.105,-5075.0016"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge139" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#f2ff00" stroke-dasharray="5,2" d="M1443.3004,-5010.21C1450.5795,-5142.0554 1520.4611,-6393.9917 1553.2698,-6464.0016 1595.819,-6554.7968 1668.7076,-6532.2079 1715.2896,-6621.0016 1760.5027,-6707.1861 1689.5422,-6761.7736 1751.2896,-6837.0016 1789.5739,-6883.6442 1843.1177,-6835.9713 1878.2922,-6885.0016 1911.4417,-6931.2092 1908.0996,-7851.4713 1914.2922,-7908.0016 1943.9717,-8178.9341 1946.2872,-8250.3404 2025.9177,-8511.0016 2043.9265,-8569.9512 2075.7735,-8635.5826 2092.2694,-8667.8492"/>
<polygon fill="#f2ff00" stroke="#f2ff00" points="2089.166,-8669.4676 2096.8637,-8676.7475 2095.3859,-8666.2562 2089.166,-8669.4676"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge482" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M1634.2797,-4771.0016C1741.9136,-4691.6601 1798.4813,-4702.2879 1878.2922,-4595.0016 1907.4868,-4555.7566 1876.9785,-4522.6272 1914.2922,-4491.0016 2075.2457,-4354.5844 2249.8923,-4351.047 2388.6335,-4510.0016 2447.9472,-4577.9568 2397.0421,-5235.1254 2424.6335,-5321.0016 2440.8591,-5371.5023 2473.622,-5370.4786 2489.7781,-5421.0016"/>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M1448.9349,-4987.8982C1470.0689,-4951.3422 1542.6781,-4833.5233 1634.2797,-4771.0016"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge545" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1443.3298,-5010.3742C1450.6667,-5139.0162 1518.6931,-6316.9244 1553.2698,-6381.0016 1564.1492,-6401.1632 1584.5377,-6416.9655 1602.1378,-6427.701"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="1600.6152,-6430.8638 1611.0223,-6432.8494 1604.1249,-6424.8072 1600.6152,-6430.8638"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge559" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M1474.5875,-5010.0527C1538.3769,-5031.1311 1686.5462,-5075.0016 1814.7909,-5075.0016"/>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M1814.7909,-5075.0016C1859.3518,-5077.9509 1869.7429,-5064.1203 1914.2922,-5061.0016 2031.9853,-5052.7624 2095.6448,-4978.2617 2179.7498,-5061.0016 2223.3197,-5103.8645 2195.7962,-7203.2312 2215.7498,-7261.0016 2229.1236,-7299.7223 2261.1442,-7335.8685 2282.234,-7356.6858"/>
<polygon fill="#ff0098" stroke="#ff0098" points="2280.0867,-7359.4767 2289.7199,-7363.887 2284.9396,-7354.4319 2280.0867,-7359.4767"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge603" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M1814.7909,-4961.0016C1842.8341,-4950.8778 1886.47,-4881.7177 1914.2922,-4871.0016 1975.1504,-4847.5613 2151.553,-4859.5495 2179.7498,-4890.0016 2239.1384,-4954.1406 2201.8524,-6376.7017 2215.7498,-6463.0016 2232.0412,-6564.168 2275.4226,-6679.4894 2293.7894,-6725.4922"/>
<polygon fill="#ff004c" stroke="#ff004c" points="2290.6142,-6726.9768 2297.6014,-6734.941 2297.1058,-6724.3578 2290.6142,-6726.9768"/>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M1492.7891,-4999.4305C1565.25,-4998.8168 1702.8734,-4992.9971 1814.7909,-4961.0016"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge256" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1634.2797,-4657.0016C1759.3314,-4525.1887 1780.3242,-4482.0207 1878.2922,-4329.0016 1896.3084,-4300.8616 1893.8881,-4289.4613 1914.2922,-4263.0016 2032.013,-4110.343 2214.8314,-3963.9031 2278.9896,-3914.5458"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2281.4216,-3917.0919 2287.2359,-3908.235 2277.1674,-3911.5329 2281.4216,-3917.0919"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1446.6094,-4987.8912C1459.3038,-4952.6285 1501.4445,-4840.6366 1553.2698,-4757.0016 1583.3978,-4708.3814 1597.9782,-4701.2037 1634.2797,-4657.0016"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge425" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1634.2797,-4657.0016C1663.0546,-4621.9641 1679.6601,-4623.0403 1715.2896,-4595.0016 1804.6924,-4524.6456 1816.8993,-4492.8017 1914.2922,-4434.0016 1960.5235,-4406.0899 1973.0235,-4396.892 2025.9177,-4386.0016 2183.8512,-4353.4846 2265.4326,-4289.9734 2388.6335,-4394.0016 2723.4507,-4676.7139 2444.8729,-4945.8451 2590.9226,-5359.0016 2700.0755,-5667.7816 2846.4406,-5697.4526 2926.5784,-6015.0016 2972.1831,-6195.7122 2942.2253,-7506.74 2962.5784,-7692.0016 2979.7883,-7848.6535 3025.7947,-8033.5142 3041.7949,-8094.9719"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3038.4965,-8096.1921 3044.4195,-8104.9767 3045.2673,-8094.4158 3038.4965,-8096.1921"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge398" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1634.2797,-4771.0016C1711.0595,-4718.5963 1934.4525,-4640.6018 2025.9177,-4624.0016 2093.1886,-4611.7925 2124.8606,-4583.2387 2179.7498,-4624.0016 2482.0285,-4848.4861 2288.9863,-5083.7673 2424.6335,-5435.0016 2473.2136,-5560.7909 2505.4303,-5583.5685 2554.9226,-5709.0016 2558.1855,-5717.2711 2747.2025,-6310.2611 2748.8254,-6319.0016 2816.5188,-6683.5721 2850.5453,-7916.2199 2855.1575,-8094.4506"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2851.6636,-8094.7381 2855.4188,-8104.6451 2858.6613,-8094.5586 2851.6636,-8094.7381"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge353" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1814.7909,-4961.0016C1968.7255,-4902.9192 2072.3311,-4898.3796 2179.7498,-5023.0016 2211.9656,-5060.3769 2210.4948,-6749.9388 2215.7498,-6799.0016 2233.3065,-6962.9201 2280.5785,-7156.6469 2296.71,-7219.8941"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2293.3871,-7221.0263 2299.2657,-7229.8406 2300.1669,-7219.2842 2293.3871,-7221.0263"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge493" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1952.105,-5113.0016C1980.5301,-5113.0959 2011.9701,-5113.2902 2038.7488,-5113.4827"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2038.7424,-5116.9826 2048.7678,-5113.5562 2038.7938,-5109.9828 2038.7424,-5116.9826"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1814.7909,-5075.0016C1878.1132,-5075.0016 1888.7831,-5112.7916 1952.105,-5113.0016"/>
</g>
<!-- sourcefile~hvacwatertoairmultispeedhp.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge652" class="edge">
<title>sourcefile~hvacwatertoairmultispeedhp.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2305.5864,-6757.2722C2318.2598,-6799.7129 2363.3687,-6954.0919 2388.6335,-7084.0016 2468.8147,-7496.2864 2458.3929,-8590.1194 2669.874,-8953.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2669.874,-8953.0016C2818.2115,-9266.946 2716.4843,-9531.7474 3047.3719,-9637.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3047.3719,-9637.0016C3129.2936,-9648.791 3170.5986,-9583.3206 3233.5946,-9637.0016"/>
</g>
<!-- sourcefile~hvacwatertoairmultispeedhp.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge444" class="edge">
<title>sourcefile~hvacwatertoairmultispeedhp.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M2369.3406,-6757.1317C2376.5715,-6760.6114 2383.2442,-6765.1336 2388.6335,-6771.0016 2700.0731,-7110.1048 2234.9872,-7494.9477 2590.9226,-7787.0016 2645.1758,-7831.5177 2690.0729,-7825.3843 2748.8254,-7787.0016 3154.4282,-7522.0237 3222.8232,-6833.9847 3232.2523,-6703.5262"/>
<polygon fill="#0019ff" stroke="#0019ff" points="3235.7635,-6703.4799 3232.9526,-6693.2648 3228.7798,-6703.0032 3235.7635,-6703.4799"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge653" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M586.1443,-2941.6905C588.5511,-2889.5126 603.6715,-2668.1287 690.4731,-2516.0016 741.1479,-2427.1899 779.611,-2424.2052 855.7932,-2356.0016 972.6496,-2251.3838 1030.4133,-2254.0565 1127.6646,-2131.0016 1150.0949,-2102.6199 1137.6501,-2083.139 1163.6646,-2058.0016 1222.7242,-2000.9331 1286.1315,-2050.0599 1332.0981,-1982.0016 1386.5596,-1901.3659 1337.4643,-1199.3582 1368.0981,-1107.0016 1414.0235,-968.5431 1453.9832,-942.8758 1553.2698,-836.0016 1698.1293,-680.0717 2102.0329,-166.6489 2302.1917,-239.0016"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1952.105,-5075.0016C2053.5606,-5078.8137 2110.5382,-5019.7215 2179.7498,-5094.0016 2233.6276,-5151.8252 2167.859,-7876.1298 2215.7498,-7939.0016 2221.7217,-7946.8417 2229.9997,-7952.3359 2239.0845,-7956.1643"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2238.1863,-7959.5586 2248.7812,-7959.5794 2240.5117,-7952.9561 2238.1863,-7959.5586"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M916.6465,-4923.0016C1010.6318,-4924.1208 1034.0266,-4928.8517 1127.6646,-4937.0016 1301.1697,-4952.1028 1345.3985,-4950.8528 1517.2698,-4979.0016 1541.6837,-4983.0001 1927.3864,-5073.9907 1952.105,-5075.0016"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge61" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff4c00" stroke-dasharray="5,2" d="M635.6043,-2957.3282C642.6767,-2959.8827 649.2922,-2963.6122 654.4731,-2969.0016 713.4313,-3030.3325 666.1512,-3075.4788 690.4731,-3157.0016 712.0478,-3229.3158 708.8444,-3254.4017 755.1332,-3314.0016"/>
<path fill="none" stroke="#ff4c00" stroke-dasharray="5,2" d="M755.1332,-3314.0016C806.2165,-3379.7748 839.1866,-3378.4145 916.6465,-3409.0016"/>
<path fill="none" stroke="#ff4c00" stroke-dasharray="5,2" d="M916.6465,-3409.0016C1094.1995,-3479.1132 1205.5392,-3375.0907 1332.0981,-3518.0016 1383.3007,-3575.8198 1309.1338,-3638.1233 1368.0981,-3688.0016 1454.7481,-3761.2993 2309.2281,-3649.912 2388.6335,-3731.0016 2421.7576,-3764.8282 2420.3457,-5387.8523 2424.6335,-5435.0016 2438.0208,-5582.2069 2472.8322,-5757.035 2485.2748,-5816.7772"/>
<polygon fill="#ff4c00" stroke="#ff4c00" points="2481.9106,-5817.788 2487.3901,-5826.8559 2488.7614,-5816.3501 2481.9106,-5817.788"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge93" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ff7200" stroke-dasharray="5,2" d="M1442.684,-2039.0016C1458.5653,-2008.7037 1495.7487,-2046.5915 1517.2698,-2020.0016 1581.0011,-1941.2599 1514.4599,-1202.5737 1553.2698,-1109.0016 1643.7609,-890.8241 1697.856,-813.5819 1914.2922,-719.0016 2086.0928,-643.9266 2578.279,-765.1196 2748.8254,-843.0016 2767.0182,-851.3096 2768.2847,-858.7586 2784.8254,-870.0016 2845.9605,-911.5561 2888.7091,-893.5178 2926.5784,-957.0016 2984.9761,-1054.8992 3040.3423,-2894.9269 3046.7544,-3114.6131"/>
<polygon fill="#ff7200" stroke="#ff7200" points="3043.2622,-3114.9359 3047.0513,-3124.8299 3050.2592,-3114.7325 3043.2622,-3114.9359"/>
<path fill="none" stroke="#ff7200" stroke-dasharray="5,2" d="M1247.8813,-2269.0016C1273.1581,-2239.407 1305.8761,-2273.7621 1332.0981,-2245.0016 1390.5928,-2180.8443 1306.7129,-2114.3989 1368.0981,-2053.0016 1391.9452,-2029.1499 1426.6547,-2068.6774 1442.684,-2039.0016"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge105" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M586.0506,-2964.1823C590.2407,-3104.3019 633.7201,-4521.3441 690.4731,-4937.0016 708.3964,-5068.2713 735.879,-5096.9205 755.1332,-5228.0016"/>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M1442.684,-5835.0016C1502.9451,-5790.6144 1490.5368,-5748.8208 1553.2698,-5708.0016 1584.8524,-5687.4514 1599.4652,-5697.4142 1634.2797,-5683.0016"/>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M755.1332,-5228.0016C760.9193,-5267.3931 802.5719,-5254.1046 819.7932,-5290.0016 859.0669,-5371.866 796.5198,-5628.2204 855.7932,-5697.0016 866.4929,-5709.4176 1415.9981,-5854.6579 1442.684,-5835.0016"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge135" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M755.1332,-3314.0016C803.7031,-3376.5386 800.4266,-3404.3938 855.7932,-3461.0016 973.5677,-3581.4163 1007.9615,-3617.7592 1163.6646,-3682.0016 1418.4708,-3787.1336 2225.6154,-3654.7314 2388.6335,-3877.0016 2421.1829,-3921.3817 2420.0757,-5803.1538 2424.6335,-5858.0016 2438.0571,-6019.5353 2473.5578,-6212.0923 2485.6649,-6275.001"/>
<polygon fill="#ffe500" stroke="#ffe500" points="2482.2437,-6275.7443 2487.5829,-6284.8955 2489.1158,-6274.4121 2482.2437,-6275.7443"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge218" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1070.5822,-2649.0016C1181.6276,-2613.058 1234.9639,-2689.7162 1332.0981,-2625.0016 1360.5567,-2606.0414 1344.22,-2581.4805 1368.0981,-2557.0016 1491.6776,-2430.3131 1603.4926,-2499.1996 1715.2896,-2362.0016 1748.5857,-2321.1404 1723.0964,-2293.5372 1751.2896,-2249.0016 1767.1592,-2223.933 1923.1414,-2066.5677 1952.105,-2073.0016"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge282" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#0cff00" stroke-dasharray="5,2" d="M916.6465,-2649.0016C1088.5536,-2505.1301 1156.6195,-2502.4947 1332.0981,-2363.0016 1606.4799,-2144.8876 1587.5238,-1957.8143 1914.2922,-1831.0016 2091.9827,-1762.0433 2034.8339,-1391.5494 2554.9226,-1863.0016 2593.4146,-1897.894 2577.4279,-2043.8318 2590.9226,-2094.0016 2616.0676,-2187.4845 2638.5771,-2205.3947 2669.874,-2297.0016"/>
<path fill="none" stroke="#0cff00" stroke-dasharray="5,2" d="M2669.874,-2297.0016C2702.0037,-2394.9118 2729.3426,-2413.8129 2748.8254,-2515.0016 2794.7306,-2753.421 2773.2045,-3364.4814 2784.8254,-3607.0016 2806.2347,-4053.7961 2845.7823,-4599.4031 2854.1296,-4712.7729"/>
<polygon fill="#0cff00" stroke="#0cff00" points="2850.6505,-4713.1872 2854.8772,-4722.9024 2857.6316,-4712.6719 2850.6505,-4713.1872"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge304" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1634.2797,-8991.0016C1692.057,-9021.8648 1756.3192,-9064.1309 1790.4179,-9087.2349"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1788.5745,-9090.214 1798.8105,-9092.9479 1792.5135,-9084.4274 1788.5745,-9090.214"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M586.0798,-2964.0336C590.1082,-3087.3844 627.0563,-4220.9023 654.4731,-5138.0016 671.3598,-5702.8647 631.2348,-5846.9996 690.4731,-6409.0016 732.1104,-6804.0202 853.8269,-7803.3013 1013.4998,-8167.0016 1105.6598,-8376.9223 1432.0621,-8882.982 1634.2797,-8991.0016"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge316" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ffb2" stroke-dasharray="5,2" d="M586.0637,-2964.3102C592.2055,-3165.831 678.5713,-5994.1201 690.4731,-6077.0016 772.4023,-6647.5376 843.0402,-6782.3954 1013.4998,-7333.0016 1057.4148,-7474.8528 1087.619,-7504.0098 1127.6646,-7647.0016 1149.6661,-7725.5633 1133.8368,-7751.0654 1163.6646,-7827.0016 1215.9268,-7960.052 1260.4192,-7977.3251 1332.0981,-8101.0016 1348.8528,-8129.9105 1342.4871,-8145.5419 1368.0981,-8167.0016 1372.9069,-8171.0309 1378.3915,-8174.4191 1384.1545,-8177.2666"/>
<polygon fill="#00ffb2" stroke="#00ffb2" points="1382.8189,-8180.5026 1393.3829,-8181.3105 1385.6285,-8174.0911 1382.8189,-8180.5026"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge335" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00d8ff" stroke-dasharray="5,2" d="M586.8044,-2941.9727C592.6504,-2884.7017 622.6797,-2615.8586 690.4731,-2407.0016 711.3845,-2342.5784 728.0753,-2331.0944 755.1332,-2269.0016"/>
<path fill="none" stroke="#00d8ff" stroke-dasharray="5,2" d="M755.1332,-2269.0016C767.3788,-2240.9003 799.8962,-2268.32 819.7932,-2245.0016 872.749,-2182.9396 834.4143,-2143.735 855.7932,-2065.0016 899.1703,-1905.2543 938.6603,-1873.9124 977.4998,-1713.0016 1004.2521,-1602.1674 967.0534,-1563.1296 1013.4998,-1459.0016 1022.0274,-1439.8835 1037.5727,-1421.9119 1050.2896,-1409.251"/>
<polygon fill="#00d8ff" stroke="#00d8ff" points="1052.9599,-1411.5395 1057.7541,-1402.0914 1048.1144,-1406.4876 1052.9599,-1411.5395"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge349" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M755.1332,-3143.0016C804.9684,-3176.4369 804.7131,-3201.5009 855.7932,-3233.0016 935.5401,-3282.181 1180.1753,-3323.24 1247.8813,-3388.0016"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge438" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M1442.684,-2039.0016C1458.7261,-2008.7885 1495.292,-2046.2153 1517.2698,-2020.0016 1586.705,-1937.1837 1520.3291,-1637.9334 1553.2698,-1535.0016 1614.9859,-1342.1533 1864.8825,-878.7494 2025.9177,-756.0016 2095.6792,-702.8265 2128.8736,-714.1178 2215.7498,-702.0016 2291.8505,-691.3883 2312.2658,-693.5207 2388.6335,-702.0016 2551.7142,-720.1123 2597.6238,-719.2728 2748.8254,-783.0016 2853.2504,-827.0149 2859.3943,-875.153 2962.5784,-922.0016 2998.2412,-938.1936 3029.6618,-911.0679 3047.3719,-946.0016"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge455" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0c00ff" stroke-dasharray="5,2" d="M755.1332,-2953.0016C814.7453,-2946.0834 800.9505,-3018.6346 855.7932,-3043.0016 902.1171,-3063.5837 959.4006,-3068.8434 1003.1571,-3069.223"/>
<polygon fill="#0c00ff" stroke="#0c00ff" points="1003.4065,-3072.723 1013.4074,-3069.2256 1003.4083,-3065.723 1003.4065,-3072.723"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge483" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M755.1332,-2953.0016C859.9704,-2944.4901 893.3378,-2935.0893 977.4998,-2872.0016 999.1228,-2855.793 992.894,-2840.4852 1013.4998,-2823.0016 1056.8962,-2786.1807 1077.6937,-2792.2402 1127.6646,-2765.0016 1143.9285,-2756.1363 1145.7832,-2748.8358 1163.6646,-2744.0016 1471.4215,-2660.7998 1575.8412,-2705.2035 1878.2922,-2806.0016 2125.5823,-2888.4162 2252.8977,-2872.47 2388.6335,-3095.0016 2440.8644,-3180.6313 2408.9965,-3897.926 2424.6335,-3997.0016 2458.0936,-4209.0032 2521.439,-4250.0038 2554.9226,-4462.0016 2617.1684,-4856.1038 2547.665,-4962.3659 2590.9226,-5359.0016 2608.7023,-5522.0265 2650.7491,-5715.6533 2665.0302,-5778.8931"/>
<polygon fill="#3200ff" stroke="#3200ff" points="2661.6614,-5779.8637 2667.291,-5788.8391 2668.4873,-5778.312 2661.6614,-5779.8637"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge491" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#5900ff" stroke-dasharray="5,2" d="M635.4095,-2962.7689C642.877,-2966.3679 649.6723,-2971.2853 654.4731,-2978.0016 715.2526,-3063.0316 630.5548,-4773.3626 690.4731,-4859.0016 695.7935,-4866.6057 703.7751,-4871.8972 712.3322,-4875.5792"/>
<polygon fill="#5900ff" stroke="#5900ff" points="711.1503,-4878.8736 721.7446,-4878.9763 713.5267,-4872.2893 711.1503,-4878.8736"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge530" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M2489.7781,-2909.0016C2508.0542,-2932.3036 2535.458,-2900.6829 2554.9226,-2923.0016 2658.3799,-3041.6288 2668.8079,-4249.7166 2669.7796,-4425.671"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="2666.2799,-4425.7636 2669.8308,-4435.7457 2673.2798,-4425.728 2666.2799,-4425.7636"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M755.1332,-2953.0016C893.4061,-2937.0369 891.6541,-2843.2914 1013.4998,-2776.0016 1077.161,-2740.8444 1095.8638,-2737.3045 1163.6646,-2711.0016 1237.478,-2682.3662 1258.4447,-2682.0461 1332.0981,-2653.0016 1521.8798,-2578.1631 1551.7583,-2508.4888 1751.2896,-2466.0016 1806.4975,-2454.2459 1824.0453,-2450.4009 1878.2922,-2466.0016 2135.5833,-2539.995 2220.3445,-2577.7889 2388.6335,-2786.0016 2418.0639,-2822.4139 2391.5974,-2851.8261 2424.6335,-2885.0016 2446.4057,-2906.8656 2470.7359,-2884.7229 2489.7781,-2909.0016"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge538" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#a500ff" stroke-dasharray="5,2" d="M586.0717,-2964.0702C592.2682,-3158.4994 678.235,-5849.653 690.4731,-5887.0016 722.2805,-5984.0717 784.6475,-5981.0897 819.7932,-6077.0016 872.38,-6220.5099 807.9496,-6273.8431 855.7932,-6419.0016 1033.6468,-6958.6129 1171.8061,-7102.9554 1634.2797,-7433.0016"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge554" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M755.1332,-5228.0016C761.0537,-5267.3731 802.7067,-5254.0403 819.7932,-5290.0016 904.9483,-5469.224 802.3994,-5543.8965 855.7932,-5735.0016 897.9234,-5885.7925 922.8069,-5922.3784 1013.4998,-6050.0016 1100.0489,-6171.7938 1105.9066,-6244.4476 1247.8813,-6291.0016"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge573" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M755.1332,-4923.0016C814.2254,-4963.7571 844.9713,-4926.9474 916.6465,-4923.0016"/>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M916.6465,-4923.0016C960.074,-4920.6109 970.1185,-4912.1208 1013.4998,-4909.0016 1064.109,-4905.3628 1076.9409,-4907.7185 1127.6646,-4909.0016 1461.5973,-4917.4488 1547.6392,-4899.5572 1878.2922,-4947.0016 2014.6453,-4966.5665 2093.5412,-4911.5631 2179.7498,-5019.0016 2257.7111,-5116.1619 2175.0991,-7143.2493 2215.7498,-7261.0016 2229.1177,-7299.7244 2261.14,-7335.8699 2282.2317,-7356.6865"/>
<polygon fill="#ff0098" stroke="#ff0098" points="2280.0849,-7359.4779 2289.7184,-7363.8876 2284.9374,-7354.4328 2280.0849,-7359.4779"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge579" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0072" stroke-dasharray="5,2" d="M916.6465,-4923.0016C944.4684,-4923.0016 1136.1331,-4959.9916 1163.6646,-4964.0016 1238.8203,-4974.9481 1325.6706,-4985.5154 1382.2487,-4992.122"/>
<polygon fill="#ff0072" stroke="#ff0072" points="1382.1136,-4995.6298 1392.4511,-4993.3087 1382.9225,-4988.6767 1382.1136,-4995.6298"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge604" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M635.3996,-2956.2164C642.7709,-2958.8592 649.5364,-2962.9067 654.4731,-2969.0016 719.2447,-3048.9689 617.0023,-4748.945 690.4731,-4821.0016 731.5075,-4861.2461 777.395,-4859.8067 819.7932,-4821.0016 886.6089,-4759.8484 797.1135,-4483.9998 855.7932,-4415.0016 972.3022,-4278.0053 1068.0416,-4315.0016 1247.8813,-4315.0016 1247.8813,-4315.0016 1247.8813,-4315.0016 1442.684,-4315.0016 1788.7424,-4315.0016 1975.6547,-4286.5349 2179.7498,-4566.0016 2241.9162,-4651.1259 2199.1946,-6358.9019 2215.7498,-6463.0016 2231.8435,-6564.1996 2275.3352,-6679.5034 2293.7604,-6725.4968"/>
<polygon fill="#ff004c" stroke="#ff004c" points="2290.5881,-6726.9879 2297.585,-6734.9436 2297.0765,-6724.361 2290.5881,-6726.9879"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.9269,-2964.3487C588.8084,-3119.4774 621.7753,-4820.8001 690.4731,-5318.0016 701.4854,-5397.7027 831.0728,-5946.4351 855.7932,-6023.0016 965.2393,-6361.9889 969.2559,-6464.5119 1163.6646,-6763.0016 1418.1226,-7153.6896 1607.8831,-7151.1794 1878.2922,-7531.0016 1954.4656,-7637.9962 1940.9243,-7686.87 2025.9177,-7787.0016 2040.9973,-7804.767 2061.5623,-7821.3152 2077.6339,-7832.9896"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2075.8556,-7836.0193 2086.0368,-7838.9507 2079.9058,-7830.31 2075.8556,-7836.0193"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge78" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1070.5822,-2459.0016C1091.7923,-2441.4647 1103.7631,-2448.6446 1127.6646,-2435.0016 1225.9952,-2378.8744 1250.512,-2361.5056 1332.0981,-2283.0016 1426.6638,-2192.0084 1445.0904,-2162.6034 1517.2698,-2053.0016 1536.0779,-2024.4422 1532.7974,-2012.3926 1553.2698,-1985.0016 1641.2002,-1867.3556 1889.9047,-1578.4345 2025.9177,-1523.0016 2089.2312,-1497.1978 2112.6369,-1509.9521 2179.7498,-1523.0016 2246.6957,-1536.0187 2708.6114,-1697.9196 2748.8254,-1753.0016 2780.4925,-1796.3766 2780.7196,-2181.4541 2784.8254,-2235.0016 2811.7962,-2586.7506 2846.0623,-3015.6247 2854.0056,-3114.8327"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2850.5175,-3115.1221 2854.8048,-3124.8107 2857.4951,-3114.5632 2850.5175,-3115.1221"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge113" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-5228.0016C760.9288,-5267.3917 803.0632,-5253.873 819.7932,-5290.0016 874.9889,-5409.1971 817.5274,-5754.3439 855.7932,-5880.0016 923.7403,-6103.1274 980.0497,-6161.17 1163.6646,-6305.0016 1401.197,-6491.0687 1479.5685,-6513.8136 1751.2896,-6645.0016 1758.7233,-6648.5907 1766.8143,-6652.0779 1774.6541,-6655.2528"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1773.4447,-6658.5382 1784.0313,-6658.9566 1776.0163,-6652.0277 1773.4447,-6658.5382"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge164" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1070.5822,-2649.0016C1109.2775,-2637.7622 1212.3281,-2629.9653 1247.8813,-2611.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-2953.0016C840.7745,-2942.5039 797.2965,-2850.4269 855.7932,-2787.0016 932.7202,-2703.5932 961.6187,-2680.651 1070.5822,-2649.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1442.684,-2457.0016C1489.6888,-2414.5023 1497.3938,-2396.8935 1553.2698,-2367.0016 1561.002,-2362.8651 1569.5229,-2359.2999 1578.0465,-2356.2642"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1579.2556,-2359.5504 1587.6293,-2353.0594 1577.0355,-2352.9118 1579.2556,-2359.5504"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1247.8813,-2611.0016C1317.317,-2573.9653 1301.755,-2523.3288 1368.0981,-2481.0016 1397.4553,-2462.2717 1416.8535,-2480.3562 1442.684,-2457.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M635.5588,-2955.9975C669.4001,-2957.2983 715.1045,-2957.6233 755.1332,-2953.0016"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge198" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M916.6465,-2649.0016C964.6525,-2628.9464 951.513,-2594.0735 977.4998,-2549.0016 994.1893,-2520.055 988.7067,-2505.4014 1013.4998,-2483.0016 1033.9208,-2464.5519 1049.372,-2476.5385 1070.5822,-2459.0016"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1247.8813,-2269.0016C1273.1581,-2239.407 1306.2108,-2274.0637 1332.0981,-2245.0016 1397.9995,-2171.0185 1303.908,-2100.4742 1368.0981,-2025.0016 1371.4949,-2021.0078 1375.5503,-2017.6496 1379.9903,-2014.8262"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1381.7738,-2017.8413 1388.9309,-2010.0293 1378.4643,-2011.673 1381.7738,-2017.8413"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1070.5822,-2459.0016C1091.7923,-2441.4647 1106.1102,-2452.1136 1127.6646,-2435.0016 1199.0079,-2378.3622 1188.7206,-2338.2684 1247.8813,-2269.0016"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M593.7153,-2941.736C623.6151,-2900.3485 733.413,-2754.8625 855.7932,-2673.0016 879.9587,-2656.8372 889.82,-2660.2088 916.6465,-2649.0016"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge176" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M755.1332,-2269.0016C767.8996,-2241.1331 793.1785,-2260.21 819.7932,-2245.0016 882.1682,-2209.3589 1001.3634,-2060.2321 1070.5822,-2041.0016"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge183" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataglobalconstants.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M588.3063,-2941.9847C598.2425,-2900.6024 636.1377,-2751.0012 690.4731,-2637.0016 704.7668,-2607.0125 726.3621,-2575.1696 740.604,-2555.4344"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="743.498,-2557.4064 746.5775,-2547.269 737.8483,-2553.2733 743.498,-2557.4064"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge257" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M916.6465,-3409.0016C943.5713,-3419.9703 951.5329,-3419.9256 977.4998,-3433.0016 1143.3591,-3516.523 1205.0747,-3518.5387 1332.0981,-3654.0016 1355.2208,-3678.6605 1340.919,-3700.9017 1368.0981,-3721.0016 1507.696,-3824.239 1579.1749,-3774.1533 1751.2896,-3797.0016 1906.5332,-3817.6103 1952.6912,-3776.4763 2102.8337,-3821.0016"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge231" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1070.5822,-2837.0016C1093.2615,-2818.4438 1102.7755,-2819.4704 1127.6646,-2804.0016 1143.9968,-2793.851 1145.8634,-2787.2747 1163.6646,-2780.0016 1171.5863,-2776.765 1180.1981,-2774.1751 1188.7904,-2772.1048"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1189.8067,-2775.4652 1198.8255,-2769.9054 1188.308,-2768.6275 1189.8067,-2775.4652"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M916.6465,-3029.0016C943.7693,-3001.5218 957.6985,-3000.1483 977.4998,-2967.0016 1005.1836,-2920.6596 974.1939,-2888.002 1013.4998,-2851.0016 1032.5201,-2833.0969 1050.3658,-2853.544 1070.5822,-2837.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-2953.0016C833.8775,-2943.3493 860.9171,-3085.4646 916.6465,-3029.0016"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge426" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1442.684,-2039.0016C1458.9412,-2008.9037 1494.2548,-2045.3096 1517.2698,-2020.0016 1587.1772,-1943.129 1515.1101,-1885.6468 1553.2698,-1789.0016 1610.7217,-1643.4958 1645.5796,-1613.3189 1751.2896,-1498.0016 1814.4715,-1429.0775 1830.899,-1407.2871 1914.2922,-1365.0016 2245.4238,-1197.0975 2405.6951,-1186.2218 2748.8254,-1328.0016 2749.5823,-1328.3143 2926.2372,-1482.2572 2926.5784,-1483.0016 2962.5074,-1561.3982 2953.8326,-7606.2087 2962.5784,-7692.0016 2978.5608,-7848.7835 3025.3529,-8033.561 3041.6756,-8094.9845"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3038.3858,-8096.23 3044.3545,-8104.9835 3045.1473,-8094.4184 3038.3858,-8096.23"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge399" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-3143.0016C1113.0751,-3383.1511 2423.9162,-2479.0257 2669.874,-2833.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M635.5892,-2959.4382C642.3373,-2961.7445 648.8596,-2964.8439 654.4731,-2969.0016 726.2674,-3022.1758 683.6727,-3089.3796 755.1332,-3143.0016"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge367" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.9549,-2964.4413C589.2162,-3120.5316 626.2173,-4822.7829 690.4731,-4904.0016 709.0574,-4927.4919 727.7362,-4910.8948 755.1332,-4923.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2102.8337,-4638.0016C2127.4878,-4662.4864 2157.2657,-4625.5103 2179.7498,-4652.0016 2218.3468,-4697.4776 2209.5013,-6739.6825 2215.7498,-6799.0016 2233.0195,-6962.9506 2280.4772,-7156.6577 2296.6832,-7219.897"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2293.3621,-7221.0347 2299.251,-7229.8422 2300.1398,-7219.2847 2293.3621,-7221.0347"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-4923.0016C782.5301,-4935.1085 793.0542,-4917.4995 819.7932,-4904.0016 1023.8384,-4800.9996 1019.3122,-4619.0016 1247.8813,-4619.0016 1247.8813,-4619.0016 1247.8813,-4619.0016 1442.684,-4619.0016 1516.0643,-4619.0016 2050.7676,-4586.2929 2102.8337,-4638.0016"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2149.5889,-7859.1097C2160.2904,-7862.7725 2171.0603,-7867.8833 2179.7498,-7875.0016 2204.9959,-7895.683 2190.1686,-7918.7361 2215.7498,-7939.0016 2222.6895,-7944.4993 2230.7928,-7948.788 2239.2046,-7952.1336"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2238.1924,-7955.4881 2248.7872,-7955.5244 2240.5275,-7948.889 2238.1924,-7955.4881"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge264" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#0cff00" stroke-dasharray="5,2" d="M2302.1917,-7925.0016C2389.3304,-7923.7582 2359.8166,-7831.2469 2388.6335,-7749.0016 2633.9629,-7048.8155 2658.5553,-6855.4107 2748.8254,-6119.0016 2758.0216,-6043.9811 2740.3529,-4820.1149 2784.8254,-4759.0016 2787.1095,-4755.8629 2789.8198,-4753.1161 2792.8266,-4750.7125"/>
<polygon fill="#0cff00" stroke="#0cff00" points="2794.9317,-4753.518 2801.3887,-4745.1181 2791.1028,-4747.658 2794.9317,-4753.518"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge465" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M2489.7781,-6525.0016C2496.6806,-6472.4093 2537.3868,-6475.0625 2554.9226,-6425.0016 2609.8361,-6268.2355 2558.0073,-6215.8134 2590.9226,-6053.0016 2608.7422,-5964.8589 2645.3685,-5863.8434 2661.7007,-5820.9815"/>
<polygon fill="#3200ff" stroke="#3200ff" points="2665.0701,-5821.9706 2665.3919,-5811.3806 2658.5364,-5819.4586 2665.0701,-5821.9706"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge509" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M2489.7781,-6525.0016C2496.6806,-6472.4093 2539.3439,-6475.7056 2554.9226,-6425.0016 2586.1744,-6323.2867 2543.8692,-4605.4405 2590.9226,-4510.0016 2600.8936,-4489.7773 2620.7669,-4473.9754 2638.0793,-4463.2557"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="2639.9813,-4466.1977 2646.8331,-4458.1167 2636.4374,-4460.1611 2639.9813,-4466.1977"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M2302.1917,-7925.0016C2389.3288,-7926.3539 2365.4311,-7833.0037 2388.6335,-7749.0016 2533.9636,-7222.8496 2418.7464,-7066.2144 2489.7781,-6525.0016"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M2138.6339,-7861.0357C2151.6513,-7865.206 2166.4327,-7870.1258 2179.7498,-7875.0016 2234.9474,-7895.2113 2243.4177,-7924.0895 2302.1917,-7925.0016"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge556" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M2122.0499,-7838.9377C2139.5415,-7827.9148 2164.8423,-7809.4258 2179.7498,-7787.0016 2224.5446,-7719.6199 2281.3141,-7470.7329 2297.6232,-7396.2164"/>
<polygon fill="#ff0098" stroke="#ff0098" points="2301.1036,-7396.6825 2299.8079,-7386.1672 2294.2634,-7395.1954 2301.1036,-7396.6825"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge585" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M2106.7193,-7838.8143C2119.8492,-7800.4305 2162.6953,-7670.314 2179.7498,-7559.0016 2193.0234,-7472.3657 2161.497,-6839.8392 2215.7498,-6771.0016 2218.2882,-6767.7808 2221.2149,-6764.9577 2224.4235,-6762.4845"/>
<polygon fill="#ff004c" stroke="#ff004c" points="2226.3951,-6765.3781 2232.9197,-6757.0306 2222.6136,-6759.4873 2226.3951,-6765.3781"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge406" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2302.1917,-7925.0016C2340.5301,-7916.2005 2362.7889,-7914.3477 2388.6335,-7944.0016 2454.9829,-8020.1301 2389.5585,-8302.3046 2424.6335,-8397.0016 2468.1965,-8514.6147 2479.1192,-8568.1635 2590.9226,-8625.0016 2728.2006,-8694.7903 2827.4673,-8656.8689 2926.5784,-8539.0016 2980.1026,-8475.3482 3029.9817,-8213.8508 3043.6792,-8137.206"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3047.1388,-8137.7413 3045.4338,-8127.2845 3040.2458,-8136.5222 3047.1388,-8137.7413"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge378" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2302.1917,-7925.0016C2341.5226,-7925.612 2362.1934,-7914.8774 2388.6335,-7944.0016 2478.602,-8043.1032 2343.8185,-8136.304 2424.6335,-8243.0016 2495.9081,-8337.1033 2553.3545,-8363.9328 2669.874,-8345.0016"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1634.2797,-7585.0016C1690.8071,-7570.1937 1841.8324,-7637.3365 1878.2922,-7683.0016 1941.4799,-7762.1427 1837.2327,-7842.2915 1914.2922,-7908.0016 1939.8677,-7929.8103 1956.4231,-7910.8 1989.9177,-7908.0016 2040.6314,-7903.7647 2058.4268,-7864.1448 2102.8337,-7889.0016"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge50" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff4c00" stroke-dasharray="5,2" d="M1634.2797,-7585.0016C1695.5298,-7577.0026 1697.3463,-7629.9069 1751.2896,-7660.0016 1805.9739,-7690.5098 1840.5154,-7671.0613 1878.2922,-7721.0016 1934.6273,-7795.4755 1848.8856,-7861.3535 1914.2922,-7928.0016 2037.2823,-8053.3261 2190.5059,-8138.4973 2302.1917,-8003.0016"/>
<path fill="none" stroke="#ff4c00" stroke-dasharray="5,2" d="M2302.1917,-8003.0016C2325.6476,-7971.4244 2363.6631,-8014.3953 2388.6335,-7984.0016 2418.7582,-7947.3344 2420.6349,-6323.2878 2424.6335,-6276.0016 2438.2916,-6114.4876 2473.6405,-5921.9178 2485.6868,-5859.0041"/>
<polygon fill="#ff4c00" stroke="#ff4c00" points="2489.1381,-5859.5906 2487.5949,-5849.1088 2482.2647,-5858.2652 2489.1381,-5859.5906"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge270" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#0cff00" stroke-dasharray="5,2" d="M1319.9563,-7557.0099C1324.1879,-7558.7161 1328.2731,-7560.6988 1332.0981,-7563.0016 1354.0411,-7576.2117 1350.3764,-7589.51 1368.0981,-7608.0016 1371.3511,-7611.3959 1876.0991,-8048.8432 1878.2922,-8053.0016 1942.1734,-8174.1263 1849.6769,-8238.267 1914.2922,-8359.0016 1945.0319,-8416.4391 1965.9762,-8428.4867 2025.9177,-8454.0016 2174.4494,-8517.2262 2249.7726,-8555.3221 2388.6335,-8473.0016 2672.3488,-8304.8076 2553.9188,-8086.7428 2590.9226,-7759.0016 2648.4578,-7249.4147 2708.6963,-7127.2538 2748.8254,-6616.0016 2752.8627,-6564.5668 2754.6159,-4800.8254 2784.8254,-4759.0016 2787.0984,-4755.8549 2789.8002,-4753.1019 2792.8005,-4750.6936"/>
<polygon fill="#0cff00" stroke="#0cff00" points="2794.905,-4753.4991 2801.3503,-4745.0902 2791.0679,-4747.6444 2794.905,-4753.4991"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge288" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#00ff19" stroke-dasharray="5,2" d="M1249.267,-7535.9668C1257.9818,-7466.2351 1305.6979,-7079.4969 1332.0981,-6763.0016 1337.6959,-6695.8935 1331.9637,-6214.827 1368.0981,-6158.0016 1408.5794,-6094.3404 1463.8737,-6130.2966 1517.2698,-6077.0016 1540.9189,-6053.3973 1530.413,-6035.374 1553.2698,-6011.0016 1589.1282,-5972.7656 1900.7307,-5769.4182 1952.105,-5759.0016"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge471" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M1442.684,-7594.0016C1473.9485,-7603.2148 1862.8218,-7958.3132 1878.2922,-7987.0016 1925.3189,-8074.2082 1838.7881,-8142.8485 1914.2922,-8207.0016 2075.4644,-8343.9437 2238.9528,-8318.4181 2388.6335,-8169.0016 2722.9417,-7835.2835 2512.822,-6518.8664 2590.9226,-6053.0016 2605.8224,-5964.1255 2644.1339,-5863.1584 2661.3144,-5820.6194"/>
<polygon fill="#3200ff" stroke="#3200ff" points="2664.5682,-5821.9093 2665.1082,-5811.3282 2658.0876,-5819.2631 2664.5682,-5821.9093"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge518" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1442.684,-7594.0016C1564.0393,-7631.5928 1608.3483,-7611.4176 1715.2896,-7680.0016 1760.7144,-7709.1337 1851.4959,-7813.1609 1878.2922,-7860.0016 1904.8865,-7906.4891 1892.8088,-7925.9424 1914.2922,-7975.0016 1954.1955,-8066.124 1939.8053,-8119.2 2025.9177,-8169.0016 2177.2257,-8256.5079 2300.7414,-8168.0858 2388.6335,-8017.0016 2430.1832,-7945.5789 2549.5646,-6621.4569 2554.9226,-6539.0016 2562.2331,-6426.4989 2541.1225,-4611.1463 2590.9226,-4510.0016 2600.8829,-4489.7721 2620.7563,-4473.9702 2638.0714,-4463.2518"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="2639.9737,-4466.1936 2646.8268,-4458.1136 2636.4307,-4460.1564 2639.9737,-4466.1936"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge593" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M1299.9328,-7558.0781C1339.3853,-7566.8305 1394.7959,-7579.8897 1442.684,-7594.0016"/>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M1634.2797,-7585.0016C1682.2632,-7573.3897 1690.4194,-7551.6482 1715.2896,-7509.0016 1749.3923,-7450.5233 1716.4101,-7419.02 1751.2896,-7361.0016 1882.5856,-7142.6041 2055.9575,-7202.7382 2179.7498,-6980.0016 2225.539,-6897.6141 2152.8983,-6841.2444 2215.7498,-6771.0016 2218.6796,-6767.7273 2222.009,-6764.8706 2225.6148,-6762.3794"/>
<polygon fill="#ff004c" stroke="#ff004c" points="2227.6029,-6765.2715 2234.4721,-6757.2053 2224.072,-6759.2273 2227.6029,-6765.2715"/>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M1442.684,-7594.0016C1524.4549,-7618.0983 1549.7499,-7596.0408 1634.2797,-7585.0016"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge196" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1249.4835,-7535.9821C1259.5213,-7466.3434 1313.9088,-7080.0747 1332.0981,-6763.0016 1335.8671,-6697.3022 1329.4616,-2078.273 1368.0981,-2025.0016 1371.2741,-2020.6226 1375.2528,-2017.0003 1379.7098,-2014.0052"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1381.7292,-2016.8879 1388.7852,-2008.9846 1378.3407,-2010.7627 1381.7292,-2016.8879"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge414" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2855.7019,-9542.0016C2951.2561,-9429.3333 3033.8825,-8307.1989 3045.8777,-8137.4632"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3049.3825,-8137.5161 3046.592,-8127.2954 3042.3997,-8137.0255 3049.3825,-8137.5161"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2669.874,-9485.0016C2704.6587,-9492.7487 2714.5666,-9489.1871 2748.8254,-9499.0016 2798.0465,-9513.1025 2822.5847,-9581.0503 2855.7019,-9542.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1442.684,-7983.0016C1557.3573,-8078.4879 1615.7865,-8067.7957 1715.2896,-8179.0016 1737.0512,-8203.3227 1731.0935,-8217.3656 1751.2896,-8243.0016 1798.9701,-8303.5252 1844.735,-8291.6442 1878.2922,-8361.0016 1922.3704,-8452.1042 1890.4097,-8716.6543 1914.2922,-8815.0016 1944.5473,-8939.5906 1942.9399,-8983.2649 2025.9177,-9081.0016 2039.5844,-9097.0991 2649.2625,-9480.4111 2669.874,-9485.0016"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge385" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1442.684,-7983.0016C1542.0441,-8055.0381 1603.6173,-7976.0997 1715.2896,-8027.0016 1726.021,-8031.8932 1872.8453,-8152.5411 1878.2922,-8163.0016 1921.9656,-8246.8733 1844.6563,-8523.0276 1914.2922,-8587.0016 1976.1271,-8643.8088 2626.7958,-8645.0771 2669.874,-8573.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1319.6877,-7554.444C1324.1946,-7556.7338 1328.3976,-7559.5505 1332.0981,-7563.0016 1349.7438,-7579.4582 1424.1419,-7967.562 1442.684,-7983.0016"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge502" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1249.2975,-7535.9693C1258.1986,-7466.2528 1306.8545,-7079.5912 1332.0981,-6763.0016 1338.2002,-6686.4736 1331.7129,-6140.6026 1368.0981,-6073.0016 1407.1393,-6000.4661 1463.691,-6025.571 1517.2698,-5963.0016 1539.7678,-5936.7284 1533.0459,-5922.063 1553.2698,-5894.0016 1627.3344,-5791.2339 1641.8946,-5752.8727 1751.2896,-5689.0016 1801.6536,-5659.5961 1840.8133,-5700.6844 1878.2922,-5656.0016 1943.1889,-5578.631 1853.3589,-5283.5306 1914.2922,-5203.0016 1925.1054,-5188.711 1939.4906,-5201.7305 1952.105,-5189.0016"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1445.5071,-1173.015C1462.6877,-1240.0368 1552.4851,-1590.3198 1553.2698,-1593.0016 1617.9184,-1813.9562 1665.1621,-1860.3071 1715.2896,-2085.0016 1747.9955,-2231.6047 1863.6617,-3277.5088 1878.2922,-3427.0016 1899.3024,-3641.6813 1890.2093,-3696.6449 1914.2922,-3911.0016 1923.5882,-3993.7433 1984.9019,-4579.5426 2025.9177,-4652.0016 2069.5919,-4729.1571 2141.504,-4699.0162 2179.7498,-4779.0016 2217.6179,-4858.1972 2162.6014,-7869.1361 2215.7498,-7939.0016 2221.7167,-7946.8454 2229.9922,-7952.3415 2239.0761,-7956.1707"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2238.1774,-7959.5649 2248.7722,-7959.5862 2240.5032,-7952.9625 2238.1774,-7959.5649"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge56" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff4c00" stroke-dasharray="5,2" d="M1517.3173,-1163.2134C1576.0146,-1167.5852 1657.2909,-1181.5449 1715.2896,-1223.0016 1907.7596,-1360.5769 1889.4971,-1464.7882 1989.9177,-1679.0016 2009.9679,-1721.7719 1994.9183,-1743.3597 2025.9177,-1779.0016 2076.6257,-1837.3037 2135.9308,-1796.3594 2179.7498,-1860.0016 2255.6553,-1970.2459 2147.5995,-2043.8018 2215.7498,-2159.0016 2263.8948,-2240.385 2344.9682,-2199.1295 2388.6335,-2283.0016 2429.0679,-2360.6678 2417.1264,-5347.7628 2424.6335,-5435.0016 2437.3065,-5582.2701 2472.5675,-5757.0584 2485.2012,-5816.7837"/>
<polygon fill="#ff4c00" stroke="#ff4c00" points="2481.8412,-5817.8093 2487.3499,-5826.8594 2488.6872,-5816.3493 2481.8412,-5817.8093"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge278" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#0cff00" stroke-dasharray="5,2" d="M1634.2797,-1123.0016C1741.3839,-1105.6024 1775.8949,-1079.1013 1878.2922,-1115.0016 2152.3314,-1211.0791 2201.5897,-1300.8689 2388.6335,-1523.0016 2509.0145,-1665.9656 2709.1642,-2100.3619 2748.8254,-2283.0016 2780.0554,-2426.8153 2778.2059,-3459.9851 2784.8254,-3607.0016 2804.9453,-4053.856 2845.5019,-4599.4162 2854.0838,-4712.775"/>
<polygon fill="#0cff00" stroke="#0cff00" points="2850.6057,-4713.1972 2854.8528,-4722.9036 2857.5856,-4712.6673 2850.6057,-4713.1972"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge476" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M1634.2797,-1123.0016C1671.0051,-1115.17 1680.5129,-1132.8355 1715.2896,-1147.0016 1732.0445,-1153.8266 1735.0285,-1158.0714 1751.2896,-1166.0016 1806.899,-1193.1212 1832.8819,-1180.9803 1878.2922,-1223.0016 1902.8163,-1245.6955 1895.1421,-1261.6207 1914.2922,-1289.0016 1943.4638,-1330.7111 1968.3476,-1328.8996 1989.9177,-1375.0016 2034.1377,-1469.5135 1977.1631,-1514.7472 2025.9177,-1607.0016 2069.6754,-1689.8007 2120.6193,-1678.3792 2179.7498,-1751.0016 2207.864,-1785.5308 2374.7228,-2050.7031 2388.6335,-2093.0016 2446.0574,-2267.6103 2384.3722,-2325.6564 2424.6335,-2505.0016 2461.1731,-2667.7679 2524.3282,-2693.0139 2554.9226,-2857.0016 2605.9134,-3130.3145 2564.3366,-5082.2469 2590.9226,-5359.0016 2606.604,-5522.2417 2650.0088,-5715.7293 2664.8343,-5778.9132"/>
<polygon fill="#3200ff" stroke="#3200ff" points="2661.4766,-5779.9236 2667.1834,-5788.8501 2668.2888,-5778.3131 2661.4766,-5779.9236"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge525" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1634.2797,-1123.0016C1743.253,-1097.5943 1785.5064,-1122.4596 1878.2922,-1185.0016 1947.7933,-1231.8486 1955.9252,-1260.3886 1989.9177,-1337.0016 2022.2986,-1409.9824 1987.5641,-1442.9751 2025.9177,-1513.0016 2079.8726,-1611.5131 2322.7812,-1774.012 2388.6335,-1865.0016 2487.7264,-2001.9203 2512.7932,-2043.3213 2554.9226,-2207.0016 2562.2382,-2235.4241 2657.7983,-4198.4751 2668.8367,-4425.6401"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="2665.3537,-4426.0773 2669.3349,-4435.8956 2672.3454,-4425.7376 2665.3537,-4426.0773"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge547" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1444.0389,-1173.0438C1452.7337,-1244.4921 1500.8466,-1648.8566 1517.2698,-1980.0016 1520.2977,-2041.0536 1526.1875,-6326.2014 1553.2698,-6381.0016 1563.3526,-6401.404 1583.5421,-6417.1311 1601.2422,-6427.7689"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="1599.7817,-6430.9647 1610.2046,-6432.8658 1603.2422,-6424.8799 1599.7817,-6430.9647"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge564" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M1448.1478,-1173.3794C1461.3438,-1201.1685 1495.4699,-1274.9155 1517.2698,-1339.0016 1537.5443,-1398.6036 1525.1575,-1419.6709 1553.2698,-1476.0016 1605.127,-1579.9118 1670.3849,-1573.9032 1715.2896,-1681.0016 1764.8276,-1799.1507 1730.4991,-1840.5857 1751.2896,-1967.0016 1797.2181,-2246.2693 1833.3551,-2311.5727 1878.2922,-2591.0016 1966.6946,-3140.707 1942.1572,-3284.5698 2025.9177,-3835.0016 2082.1615,-4204.607 2142.8425,-4289.9675 2179.7498,-4662.0016 2194.0051,-4805.699 2168.7782,-7124.4519 2215.7498,-7261.0016 2229.075,-7299.7391 2261.1096,-7335.8804 2282.2155,-7356.6921"/>
<polygon fill="#ff0098" stroke="#ff0098" points="2280.0719,-7359.4863 2289.7076,-7363.8913 2284.922,-7354.4388 2280.0719,-7359.4863"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge598" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M1451.3786,-1173.296C1488.5353,-1222.0701 1635.7138,-1420.5024 1715.2896,-1605.0016 1825.7478,-1861.1028 1818.5171,-1938.5759 1878.2922,-2211.0016 1961.7837,-2591.5144 1950.9373,-2692.7206 2025.9177,-3075.0016 2086.7257,-3385.0255 2143.2631,-3455.1846 2179.7498,-3769.0016 2248.8956,-4363.7155 2123.3755,-5871.4505 2215.7498,-6463.0016 2231.5594,-6564.2444 2275.2098,-6679.5231 2293.7189,-6725.5033"/>
<polygon fill="#ff004c" stroke="#ff004c" points="2290.5507,-6727.0038 2297.5615,-6734.9474 2297.0345,-6724.3656 2290.5507,-6727.0038"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge68" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1634.2797,-1123.0016C1698.409,-1109.1494 1691.996,-1061.0859 1751.2896,-1033.0016 1848.3463,-987.0309 1885.0719,-971.7493 1989.9177,-995.0016 2364.6052,-1078.0985 2555.8182,-1075.2728 2748.8254,-1407.0016 2795.1356,-1486.5966 2779.2138,-2143.0858 2784.8254,-2235.0016 2806.3236,-2587.1274 2844.7298,-3015.7165 2853.7623,-3114.8494"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2850.2778,-3115.1797 2854.673,-3124.8198 2857.2487,-3114.5428 2850.2778,-3115.1797"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1491.3118,-1150.9895C1529.9224,-1142.516 1585.3609,-1130.9485 1634.2797,-1123.0016"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge107" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1446.1299,-1173.2541C1457.8272,-1211.847 1496.4439,-1342.5563 1517.2698,-1453.0016 1541.6629,-1582.3645 1527.3426,-1617.9374 1553.2698,-1747.0016 1605.5617,-2007.3081 1677.8482,-2059.1479 1715.2896,-2322.0016 1723.7568,-2381.4453 1717.2856,-6595.5144 1751.2896,-6645.0016 1753.464,-6648.1661 1756.1054,-6650.93 1759.0609,-6653.3441"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1757.2446,-6656.3393 1767.5122,-6658.952 1761.1149,-6650.5066 1757.2446,-6656.3393"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge210" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M632.539,-1281.5773C666.5983,-1282.2727 713.7931,-1282.3049 755.1332,-1279.0016"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M755.1332,-1279.0016C950.8321,-1263.3644 971.0655,-1149.0567 1163.6646,-1111.0016 1237.1041,-1096.4909 1268.3087,-1071.8247 1332.0981,-1111.0016 1362.2464,-1129.5174 1340.2093,-1160.2309 1368.0981,-1182.0016 1421.6991,-1223.8438 1451.7875,-1197.6736 1517.2698,-1216.0016 1606.605,-1241.0059 1654.4751,-1211.9474 1715.2896,-1282.0016 1773.6371,-1349.2142 1717.5948,-1396.6206 1751.2896,-1479.0016 1822.8411,-1653.9397 1921.9705,-1654.6323 1989.9177,-1831.0016 2031.2232,-1938.2175 1969.2233,-1987.066 2025.9177,-2087.0016 2047.5835,-2125.192 2077.031,-2113.4751 2102.8337,-2149.0016"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M2102.8337,-2149.0016C2124.0971,-2177.8157 2155.0335,-2147.0884 2179.7498,-2173.0016 2223.4986,-2218.869 2172.0076,-2265.1278 2215.7498,-2311.0016 2223.8058,-2319.4502 2234.4604,-2325.2693 2245.5285,-2329.2734"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2244.7173,-2332.6871 2255.3066,-2332.3455 2246.8154,-2326.009 2244.7173,-2332.6871"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge328" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00d8ff" stroke-dasharray="5,2" d="M755.1332,-1279.0016C828.7453,-1273.1197 844.615,-1301.7289 916.6465,-1318.0016"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge485" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#5900ff" stroke-dasharray="5,2" d="M589.2341,-1291.0977C601.2757,-1329.7456 640.8713,-1462.2291 654.4731,-1575.0016 665.2708,-1664.525 654.9647,-4738.1151 690.4731,-4821.0016 698.5216,-4839.7889 715.1488,-4855.7834 729.5262,-4866.9554"/>
<polygon fill="#5900ff" stroke="#5900ff" points="727.5277,-4869.8305 737.6496,-4872.9607 731.6889,-4864.2016 727.5277,-4869.8305"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M755.1332,-1203.0016C883.2774,-1117.0478 917.4791,-1077.1965 1070.5822,-1058.0016"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge173" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M598.7129,-1291.2446C649.13,-1335.0586 836.0208,-1499.2413 977.4998,-1647.0016 1080.0036,-1754.0565 1192.3063,-1892.3922 1232.5148,-1942.6646"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1229.9869,-1945.1081 1238.9599,-1950.7416 1235.4584,-1940.7421 1229.9869,-1945.1081"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge225" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M592.3996,-1291.1742C622.2509,-1340.9984 746.741,-1547.7205 855.7932,-1713.0016 972.1575,-1889.3651 1057.4364,-1903.721 1127.6646,-2103.0016 1204.9583,-2322.3317 1093.4335,-2403.309 1163.6646,-2625.0016 1178.4522,-2671.6805 1211.8913,-2718.9481 1231.8994,-2744.5559"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1229.3965,-2747.0314 1238.3638,-2752.6739 1234.8724,-2742.6709 1229.3965,-2747.0314"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge393" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2489.7781,-1535.0016C2501.9323,-1563.3624 2536.6739,-1534.121 2554.9226,-1559.0016 2604.3961,-1626.4546 2576.3912,-2228.6222 2590.9226,-2311.0016 2631.9945,-2543.8402 2712.0293,-2585.4492 2748.8254,-2819.0016 2776.7023,-2995.9414 2780.7648,-5863.9254 2784.8254,-6043.0016 2804.0581,-6891.1781 2847.9197,-7933.9236 2854.7894,-8094.7578"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2851.2947,-8094.958 2855.2193,-8104.7991 2858.2883,-8094.6585 2851.2947,-8094.958"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-1203.0016C814.8433,-1161.4891 798.9089,-1119.309 855.7932,-1074.0016 960.1126,-990.9129 1042.6659,-1049.7708 1127.6646,-947.0016 1169.1601,-896.8306 1120.1696,-853.4495 1163.6646,-805.0016 1271.0509,-685.3867 1357.2447,-713.786 1517.2698,-729.0016 1606.482,-737.4841 1629.965,-739.6062 1715.2896,-767.0016 1931.693,-836.483 2007.0563,-833.2345 2179.7498,-981.0016 2307.1051,-1089.9746 2324.4,-1140.1838 2388.6335,-1295.0016 2419.5646,-1369.5525 2385.5953,-1402.3575 2424.6335,-1473.0016 2443.9657,-1507.9853 2474.1465,-1498.2151 2489.7781,-1535.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M615.5546,-1268.9283C650.2547,-1255.4933 708.707,-1231.1187 755.1332,-1203.0016"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge356" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-1279.0016C855.4561,-1277.2564 879.7017,-1262.4354 977.4998,-1240.0016 1061.3496,-1220.7674 1078.4628,-1198.8936 1163.6646,-1187.0016 1237.8052,-1176.6535 1264.1576,-1155.569 1332.0981,-1187.0016 1360.9418,-1200.3461 1503.5414,-1376.3387 1517.2698,-1405.0016 1554.019,-1481.7286 1508.1328,-1520.8893 1553.2698,-1593.0016 1600.9536,-1669.1828 1672.5401,-1634.9459 1715.2896,-1714.0016 1776.6093,-1827.3991 1723.56,-2167.1041 1751.2896,-2293.0016 1784.7365,-2444.8575 1847.3855,-2466.6085 1878.2922,-2619.0016 1892.1451,-2687.3064 1876.8624,-3814.21 1914.2922,-3873.0016 1934.4938,-3904.7325 1960.331,-3887.7727 1989.9177,-3911.0016 2092.2937,-3991.3784 2133.9752,-4012.1576 2179.7498,-4134.0016 2231.823,-4272.6119 2200.4785,-6651.7222 2215.7498,-6799.0016 2232.7524,-6962.9785 2280.383,-7156.6676 2296.6582,-7219.8996"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2293.3388,-7221.0426 2299.2373,-7229.8436 2300.1146,-7219.2852 2293.3388,-7221.0426"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge331" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00d8ff" stroke-dasharray="5,2" d="M238.8212,-1229.949C267.9606,-1209.5057 335.0444,-1167.5353 399.0839,-1164.0016"/>
<path fill="none" stroke="#00d8ff" stroke-dasharray="5,2" d="M399.0839,-1164.0016C586.1111,-1153.6814 643.5001,-1125.7053 819.7932,-1189.0016 925.3845,-1226.9131 1019.5368,-1329.5124 1055.3004,-1372.0881"/>
<polygon fill="#00d8ff" stroke="#00d8ff" points="1052.7718,-1374.5221 1061.8453,-1379.9922 1058.1633,-1370.0577 1052.7718,-1374.5221"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1164.0016C472.1264,-1159.9711 540.457,-1227.0587 570.1548,-1260.9874"/>
<polygon fill="#ff0000" stroke="#ff0000" points="567.6984,-1263.5007 576.8521,-1268.8354 573.0231,-1258.9567 567.6984,-1263.5007"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M278.8078,-1241.0016C295.1003,-1241.0016 313.1505,-1241.0016 330.2066,-1241.0016"/>
<polygon fill="#00ffff" stroke="#00ffff" points="330.6733,-1244.5017 340.6733,-1241.0016 330.6733,-1237.5017 330.6733,-1244.5017"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge326" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00d8ff" stroke-dasharray="5,2" d="M916.6465,-1318.0016C964.3566,-1329.6366 1014.9309,-1356.8856 1044.5859,-1374.6013"/>
<polygon fill="#00d8ff" stroke="#00d8ff" points="1043.0853,-1377.785 1053.4489,-1379.9863 1046.7201,-1371.8026 1043.0853,-1377.785"/>
<path fill="none" stroke="#00d8ff" stroke-dasharray="5,2" d="M457.5864,-1236.3456C540.1083,-1231.5567 694.6009,-1229.1585 819.7932,-1265.0016 866.9673,-1278.5078 868.9741,-1306.3758 916.6465,-1318.0016"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M452.0668,-1252.0731C476.1254,-1257.1005 504.613,-1263.0534 529.0936,-1268.1689"/>
<polygon fill="#ff0000" stroke="#ff0000" points="528.4574,-1271.6115 538.9619,-1270.231 529.8893,-1264.7595 528.4574,-1271.6115"/>
</g>
<!-- sourcefile~heatrecovery.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge89" class="edge">
<title>sourcefile~heatrecovery.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ff7200" stroke-dasharray="5,2" d="M2903.5739,-3136.0016C2918.9605,-3136.0016 2936.5694,-3136.0016 2954.0659,-3136.0016"/>
<polygon fill="#ff7200" stroke="#ff7200" points="2954.337,-3139.5017 2964.3369,-3136.0016 2954.3369,-3132.5017 2954.337,-3139.5017"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge122" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M1851.6165,-6658.9908C1860.7864,-6655.3336 1870.2788,-6650.7017 1878.2922,-6645.0016 1960.3829,-6586.6088 1942.9344,-6530.1187 2025.9177,-6473.0016 2166.9811,-6375.9083 2230.2165,-6408.0402 2388.6335,-6343.0016 2412.3393,-6333.2692 2438.5662,-6321.0384 2458.3722,-6311.4935"/>
<polygon fill="#ffe500" stroke="#ffe500" points="2460.0704,-6314.5599 2467.5401,-6307.0463 2457.0152,-6308.2617 2460.0704,-6314.5599"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge208" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1861.9951,-6658.9004C1868.3862,-6655.4506 1874.1565,-6650.9287 1878.2922,-6645.0016 1928.6621,-6572.8152 1909.3873,-5148.8876 1914.2922,-5061.0016 1945.4716,-4502.3339 1949.3124,-4361.2699 2025.9177,-3807.0016 2108.2535,-3211.2711 2267.9227,-2490.2889 2297.439,-2359.0194"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2300.8988,-2359.5869 2299.683,-2349.0621 2294.0701,-2358.0479 2300.8988,-2359.5869"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge513" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1877.4172,-6668.0033C1911.473,-6665.3852 1953.8786,-6659.6008 1989.9177,-6647.0016 2100.5187,-6608.3357 2108.1295,-6557.3213 2215.7498,-6511.0016 2288.9973,-6479.4759 2318.5513,-6501.0482 2388.6335,-6463.0016 2475.3259,-6415.9377 2513.4954,-6405.5246 2554.9226,-6316.0016 2639.213,-6133.8527 2502.0683,-4689.9683 2590.9226,-4510.0016 2600.9051,-4489.783 2620.7783,-4473.981 2638.0878,-4463.2599"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="2639.9893,-4466.2022 2646.8399,-4458.1201 2636.4445,-4460.1661 2639.9893,-4466.2022"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge588" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M2102.8337,-6747.0016C2136.2496,-6750.1307 2172.954,-6750.7458 2205.6613,-6750.3025"/>
<polygon fill="#ff004c" stroke="#ff004c" points="2205.7363,-6753.8019 2215.6754,-6750.1326 2205.6174,-6746.8029 2205.7363,-6753.8019"/>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M1848.2512,-6681.1168C1858.1936,-6684.9603 1868.9251,-6689.6626 1878.2922,-6695.0016 1895.9023,-6705.0389 1895.5742,-6715.2236 1914.2922,-6723.0016 1992.298,-6755.4158 2018.7293,-6739.1259 2102.8337,-6747.0016"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge240" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1861.9064,-6658.838C1868.3085,-6655.3959 1874.1055,-6650.8928 1878.2922,-6645.0016 1936.2677,-6563.4244 1898.9694,-5843.9016 1914.2922,-5745.0016 1933.7654,-5619.313 1965.2661,-5593.7779 1989.9177,-5469.0016 2002.5897,-5404.8612 1984.0239,-5227.196 2025.9177,-5177.0016 2048.8641,-5149.5089 2091.9037,-5187.1032 2102.8337,-5153.0016"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge410" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2855.7019,-8525.0016C2997.5661,-8434.5459 3036.2691,-8208.4216 3045.0824,-8137.577"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3048.606,-8137.5775 3046.289,-8127.2391 3041.6532,-8136.7659 3048.606,-8137.5775"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2102.8337,-6747.0016C2138.2954,-6751.9873 2148.6777,-6753.1996 2179.7498,-6771.0016 2193.3613,-6778.8 2381.9415,-6946.8134 2388.6335,-6961.0016 2458.6781,-7109.5067 2400.4572,-7536.5962 2424.6335,-7699.0016 2469.1742,-7998.2051 2412.9968,-8114.3611 2590.9226,-8359.0016 2672.618,-8471.3294 2738.5888,-8599.6755 2855.7019,-8525.0016"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge380" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2669.874,-8345.0016C2706.2447,-8340.2872 2720.6023,-8344.4218 2748.8254,-8321.0016 2808.9347,-8271.1217 2839.4179,-8178.6104 2850.5813,-8137.1091"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2854.01,-8137.8293 2853.1186,-8127.2721 2847.2319,-8136.081 2854.01,-8137.8293"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2302.1917,-6785.0016C2331.011,-6812.5554 2363.352,-6778.1697 2388.6335,-6809.0016 2423.1077,-6851.0443 2416.4144,-7243.2569 2424.6335,-7297.0016 2442.7123,-7415.2174 2551.276,-8360.3746 2669.874,-8345.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2102.8337,-6747.0016C2108.4163,-6747.7865 2297.9914,-6781.2415 2302.1917,-6785.0016"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge142" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#f2ff00" stroke-dasharray="5,2" d="M1255.1995,-10156.2867C1271.7795,-10180.6747 1314.9309,-10237.801 1368.0981,-10259.0016 1429.6812,-10283.558 1467.2319,-10302.4953 1517.2698,-10259.0016 1560.6284,-10221.3137 1527.1588,-10054.1735 1553.2698,-10003.0016 1626.6332,-9859.2254 1725.6573,-9885.5712 1814.7909,-9751.0016"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge297" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1254.5954,-10133.7416C1272.7344,-10103.3528 1324.3088,-10017.1597 1368.0981,-9946.0016 1400.8115,-9892.842 1410.4582,-9880.4582 1442.684,-9827.0016"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1442.684,-9827.0016C1460.6625,-9797.1784 1494.0878,-9828.9871 1517.2698,-9803.0016 1571.5809,-9742.1222 1526.6727,-9700.1288 1553.2698,-9623.0016 1623.9669,-9417.9917 1760.2938,-9191.391 1802.2163,-9123.96"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1805.3668,-9125.5229 1807.6975,-9115.1876 1799.4303,-9121.8136 1805.3668,-9125.5229"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge310" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ffb2" stroke-dasharray="5,2" d="M1252.042,-10133.883C1266.3188,-10095.1451 1313.4608,-9962.2575 1332.0981,-9848.0016 1386.8244,-9512.5035 1345.932,-9423.2104 1368.0981,-9084.0016 1390.8584,-8735.7018 1431.0949,-8311.9348 1440.621,-8213.2401"/>
<polygon fill="#00ffb2" stroke="#00ffb2" points="1444.1255,-8213.3613 1441.6051,-8203.0707 1437.1581,-8212.687 1444.1255,-8213.3613"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge479" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M1253.26,-10156.3301C1278.5638,-10208.2968 1391.3479,-10425.5799 1553.2698,-10525.0016 1693.0029,-10610.7992 1751.2026,-10584.0214 1914.2922,-10601.0016 1947.7229,-10604.4823 1961.0154,-10618.159 1989.9177,-10601.0016 2018.6497,-10583.9453 2009.784,-10564.2616 2025.9177,-10535.0016 2093.7267,-10412.0241 2139.7719,-10393.6245 2179.7498,-10259.0016 2245.9512,-10036.0726 2143.8724,-9958.1659 2215.7498,-9737.0016 2260.4878,-9599.3441 2341.2093,-9597.7569 2388.6335,-9461.0016 2437.2621,-9320.7736 2367.8394,-9266.1259 2424.6335,-9129.0016 2459.9898,-9043.6373 2522.9312,-9053.6831 2554.9226,-8967.0016 2601.4164,-8841.0257 2586.2188,-7893.201 2590.9226,-7759.0016 2618.927,-6960.0333 2662.0025,-5978.1333 2668.9218,-5821.5028"/>
<polygon fill="#3200ff" stroke="#3200ff" points="2672.4272,-5821.455 2669.3725,-5811.3101 2665.434,-5821.1456 2672.4272,-5821.455"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge422" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1248.8166,-10156.1357C1253.332,-10203.8138 1276.5734,-10393.6642 1368.0981,-10511.0016 1491.9833,-10669.8262 1557.7989,-10697.0181 1751.2896,-10753.0016 1805.5112,-10768.6898 1822.2915,-10760.0744 1878.2922,-10753.0016 2110.6183,-10723.6592 2169.5044,-10704.5776 2388.6335,-10622.0016 2573.3998,-10552.3748 2602.8083,-10497.5277 2784.8254,-10421.0016 2815.4836,-10408.1119 2838.2568,-10425.3166 2855.7019,-10397.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2855.7019,-10397.0016C2936.666,-10252.4418 2905.5696,-10195.353 2926.5784,-10031.0016 2951.8152,-9833.5742 3035.2061,-8335.8054 3046.1771,-8137.629"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3049.6877,-8137.5316 3046.7455,-8127.3535 3042.6984,-8137.1449 3049.6877,-8137.5316"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge395" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1250.1514,-10156.1885C1258.9596,-10197.389 1294.12,-10343.1364 1368.0981,-10437.0016 1430.9799,-10516.7875 1460.0219,-10530.6936 1553.2698,-10571.0016 1809.1421,-10681.6068 1948.6838,-10756.9268 2179.7498,-10601.0016 2345.3444,-10489.257 2308.3221,-10385.9183 2388.6335,-10203.0016 2409.2972,-10155.9382 2744.7107,-9216.5382 2748.8254,-9196.0016 2808.7185,-8897.0781 2749.8355,-8813.8516 2784.8254,-8511.0016 2801.465,-8366.9808 2837.8832,-8196.1092 2850.932,-8137.1955"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2854.3922,-8137.759 2853.1522,-8127.237 2847.56,-8136.2357 2854.3922,-8137.759"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge499" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1442.684,-9827.0016C1461.5814,-9797.7521 1492.3776,-9827.3538 1517.2698,-9803.0016 1552.2337,-9768.7961 1524.2164,-9738.3513 1553.2698,-9699.0016 1659.6169,-9554.9659 1796.1762,-9620.1021 1878.2922,-9461.0016 1910.6297,-9398.3475 1910.1653,-6993.3878 1914.2922,-6923.0016 1933.4361,-6596.4974 1967.5059,-6517.2978 1989.9177,-6191.0016 1993.9249,-6132.6604 1990.7431,-5185.7188 2025.9177,-5139.0016 2029.651,-5134.0433 2034.3882,-5130.0519 2039.6714,-5126.8414"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2041.6416,-5129.7679 2048.9972,-5122.1426 2038.4918,-5123.5166 2041.6416,-5129.7679"/>
</g>
<!-- sourcefile~runtimelanguageprocessor.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge203" class="edge">
<title>sourcefile~runtimelanguageprocessor.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1640.9454,-2330.9193C1654.9957,-2307.4832 1688.5581,-2251.0966 1715.2896,-2203.0016 1731.9024,-2173.1119 1724.9524,-2156.813 1751.2896,-2135.0016 1823.2305,-2075.4231 1865.8822,-2037.0747 1952.105,-2073.0016"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1952.105,-2073.0016C2016.2124,-2087.2424 1975.1428,-2159.3547 2025.9177,-2201.0016 2053.6057,-2223.712 2073.9169,-2203.8781 2102.8337,-2225.0016"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge205" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1490.6354,-1988.9331C1595.301,-1967.8358 1846.3254,-1934.3379 1989.9177,-2059.0016 2039.0821,-2101.6851 1981.1432,-2153.7337 2025.9177,-2201.0016 2050.5445,-2226.9998 2073.9169,-2203.8781 2102.8337,-2225.0016"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M2102.8337,-2225.0016C2132.7702,-2244.6534 2151.7609,-2226.6632 2179.7498,-2249.0016 2204.6541,-2268.8783 2190.8483,-2291.1213 2215.7498,-2311.0016 2224.4984,-2317.9862 2235.0676,-2323.1741 2245.7678,-2327.0245"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2244.991,-2330.4517 2255.5828,-2330.1978 2247.1445,-2323.7912 2244.991,-2330.4517"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge544" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1496.5787,-2008.9875C1504.6808,-2012.6696 1512.0556,-2017.8174 1517.2698,-2025.0016 1588.3457,-2122.9313 1499.6545,-6272.5239 1553.2698,-6381.0016 1563.3535,-6401.4036 1583.5429,-6417.1306 1601.2428,-6427.7686"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="1599.7823,-6430.9644 1610.2051,-6432.8655 1603.2428,-6424.8795 1599.7823,-6430.9644"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge153" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1496.6598,-2009.8436C1504.5448,-2013.4412 1511.8262,-2018.3387 1517.2698,-2025.0016 1600.0008,-2126.2629 1469.3254,-2216.7439 1553.2698,-2317.0016 1556.0336,-2320.3025 1559.2234,-2323.1755 1562.7058,-2325.6753"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1560.9284,-2328.6906 1571.2996,-2330.8564 1564.5427,-2322.6958 1560.9284,-2328.6906"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge213" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M633.8817,-1878.8963C755.8801,-1851.4054 1087.3395,-1780.6953 1368.0981,-1757.0016 1434.1618,-1751.4264 1451.3014,-1750.3934 1517.2698,-1757.0016 1713.4658,-1776.655 1815.6674,-1702.6502 1952.105,-1845.0016"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge489" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#5900ff" stroke-dasharray="5,2" d="M589.9264,-1901.2919C602.7148,-1936.2659 641.0694,-2046.159 654.4731,-2141.0016 675.31,-2288.4388 631.6774,-4684.199 690.4731,-4821.0016 698.5436,-4839.7795 715.1703,-4855.7742 729.5421,-4866.9486"/>
<polygon fill="#5900ff" stroke="#5900ff" points="727.5409,-4869.8218 737.6617,-4872.9555 731.7041,-4864.1943 727.5409,-4869.8218"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge161" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M654.5545,-1886.5787C847.9848,-1878.4676 1390.5503,-1866.5331 1517.2698,-1980.0016 1543.9473,-2003.8895 1609.397,-2247.0911 1628.7832,-2320.8857"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1625.4753,-2322.0705 1631.3931,-2330.8585 1632.2472,-2320.2982 1625.4753,-2322.0705"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge314" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ffb2" stroke-dasharray="5,2" d="M755.1332,-1813.0016C787.5068,-1818.5465 1311.4866,-1916.429 1332.0981,-1942.0016 1384.8733,-2007.4796 1352.5761,-7914.3478 1368.0981,-7997.0016 1380.6412,-8063.7926 1414.819,-8137.3468 1432.2133,-8171.931"/>
<polygon fill="#00ffb2" stroke="#00ffb2" points="1429.1732,-8173.6738 1436.8368,-8180.9895 1435.4081,-8170.4914 1429.1732,-8173.6738"/>
<path fill="none" stroke="#00ffb2" stroke-dasharray="5,2" d="M463.935,-1804.9378C535.9588,-1797.8366 655.2499,-1791.6119 755.1332,-1813.0016"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge453" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0c00ff" stroke-dasharray="5,2" d="M585.7192,-2003.0016C707.226,-2074.4513 738.8382,-2101.6099 819.7932,-2217.0016 924.8116,-2366.6928 929.2394,-2420.6291 977.4998,-2597.0016 1007.5918,-2706.976 990.8309,-2739.2607 1013.4998,-2851.0016 1028.1057,-2922.9981 1052.5227,-3006.7084 1064.1059,-3044.9727"/>
<polygon fill="#0c00ff" stroke="#0c00ff" points="1060.8747,-3046.3763 1067.1392,-3054.9207 1067.5704,-3044.3347 1060.8747,-3046.3763"/>
<path fill="none" stroke="#0c00ff" stroke-dasharray="5,2" d="M407.1508,-1824.0134C431.0221,-1855.9019 504.7234,-1949.4466 585.7192,-2003.0016"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge612" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0026" stroke-dasharray="5,2" d="M405.8451,-1824.0222C422.0259,-1851.004 462.9669,-1922.9996 480.9653,-1989.0016 524.433,-2148.4022 499.4661,-2194.7099 516.9653,-2359.0016 540.8106,-2582.8727 573.5961,-2853.7239 583.0623,-2931.2987"/>
<polygon fill="#ff0026" stroke="#ff0026" points="579.6443,-2932.1834 584.3314,-2941.6851 586.5926,-2931.3343 579.6443,-2932.1834"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge160" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M916.6465,-1699.0016C1028.1755,-1707.3269 1052.9018,-1731.5209 1163.6646,-1747.0016 1194.4816,-1751.3088 1421.0338,-1748.6518 1442.684,-1771.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M425.066,-1801.9063C500.1368,-1771.0255 724.2564,-1687.1008 916.6465,-1699.0016"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge191" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M916.6465,-1699.0016C944.2195,-1702.1521 953.4057,-1699.2295 977.4998,-1713.0016 997.6975,-1724.5466 994.7895,-1737.1755 1013.4998,-1751.0016 1140.6144,-1844.9345 1199.413,-1823.117 1332.0981,-1909.0016 1366.5232,-1931.2843 1402.4916,-1962.6265 1423.726,-1982.1061"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1421.395,-1984.7178 1431.109,-1988.9474 1426.1529,-1979.5833 1421.395,-1984.7178"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge180" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M755.1332,-1813.0016C814.2841,-1823.1329 804.7131,-1871.5009 855.7932,-1903.0016 905.2854,-1933.5231 934.1618,-1912.2349 977.4998,-1951.0016 1002.9869,-1973.8004 987.9239,-1996.3023 1013.4998,-2019.0016 1033.8348,-2037.0495 1044.2068,-2047.6031 1070.5822,-2041.0016"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1070.5822,-2041.0016C1116.9785,-2029.389 1119.7463,-2005.9399 1163.6646,-1987.0016 1173.2164,-1982.8827 1183.6562,-1979.184 1193.833,-1975.974"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1194.9195,-1979.302 1203.4719,-1973.0484 1192.8864,-1972.6037 1194.9195,-1979.302"/>
</g>
<!-- sourcefile~datastringglobals.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node55" class="node">
<title>sourcefile~datastringglobals.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~EfferentGraph_node55"><a xlink:href="../sourcefile/datastringglobals.f90.html" xlink:title="DataStringGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="281.0645,-1919.007 166.6166,-1919.007 166.6166,-1896.9962 281.0645,-1896.9962 281.0645,-1919.007"/>
<text text-anchor="middle" x="223.8406" y="-1904.8516" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataStringGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge448" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0c00ff" stroke-dasharray="5,2" d="M399.0839,-2003.0016C480.4179,-2019.2902 516.5276,-1957.2516 585.7192,-2003.0016"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge490" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#5900ff" stroke-dasharray="5,2" d="M399.0839,-2343.0016C413.6869,-2384.8691 459.2142,-2361.3619 480.9653,-2400.0016 512.2579,-2455.5913 512.0428,-2909.3996 516.9653,-2973.0016 549.4428,-3392.6276 436.8349,-4523.1319 690.4731,-4859.0016 695.901,-4866.1893 703.681,-4871.311 711.9741,-4874.9605"/>
<polygon fill="#5900ff" stroke="#5900ff" points="710.8645,-4878.2819 721.4573,-4878.4869 713.3043,-4871.7209 710.8645,-4878.2819"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge611" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0026" stroke-dasharray="5,2" d="M228.845,-1919.2769C250.6926,-1968.7236 339.2889,-2171.5664 399.0839,-2343.0016"/>
<path fill="none" stroke="#ff0026" stroke-dasharray="5,2" d="M399.0839,-2343.0016C413.6869,-2384.8691 456.8532,-2362.7895 480.9653,-2400.0016 540.0746,-2491.2248 575.5631,-2841.5681 583.8423,-2931.7387"/>
<polygon fill="#ff0026" stroke="#ff0026" points="580.3692,-2932.1956 584.755,-2941.84 587.3408,-2931.5656 580.3692,-2932.1956"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge185" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M225.2033,-1896.6893C231.9077,-1843.1265 263.2577,-1615.9021 317.2024,-1575.0016 436.6495,-1484.4376 505.4753,-1558.5977 654.4731,-1575.0016 800.6802,-1591.0983 839.1082,-1597.1683 977.4998,-1647.0016 1143.9785,-1706.9488 1200.9172,-1709.2565 1332.0981,-1828.0016 1381.684,-1872.8868 1418.18,-1944.864 1433.9964,-1979.746"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1430.8154,-1981.2068 1438.0684,-1988.9298 1437.2146,-1978.3694 1430.8154,-1981.2068"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge151" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M244.2862,-1896.918C275.2837,-1880.1141 334.3129,-1848.1142 369.8431,-1828.8531"/>
<polygon fill="#ff0000" stroke="#ff0000" points="371.6452,-1831.8575 378.7685,-1824.0146 368.3091,-1825.7035 371.6452,-1831.8575"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge171" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-2003.0016C450.8166,-2013.362 464.2975,-1992.1182 516.9653,-1989.0016 577.9732,-1985.3915 596.6665,-1969.1677 654.4731,-1989.0016 673.6458,-1995.5799 672.7653,-2007.1377 690.4731,-2017.0016 717.2523,-2031.9185 724.5004,-2039.873 755.1332,-2041.0016"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M237.7418,-1919.0562C266.0503,-1940.7283 333.2903,-1987.9924 399.0839,-2003.0016"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M755.1332,-2041.0016C895.3289,-2042.036 934.5779,-2075.0422 1070.5822,-2041.0016"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge605" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0026" stroke-dasharray="5,2" d="M452.0668,-2925.0731C475.1698,-2929.9008 502.3569,-2935.5819 526.158,-2940.5555"/>
<polygon fill="#ff0026" stroke="#ff0026" points="525.6249,-2944.0196 536.1294,-2942.6391 527.0567,-2937.1676 525.6249,-2944.0196"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge186" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1070.5822,-2421.0016C1101.762,-2400.2468 1108.4494,-2391.1531 1127.6646,-2359.0016 1152.7574,-2317.0154 1128.1293,-2288.6132 1163.6646,-2255.0016 1191.9398,-2228.257 1220.4729,-2258.6338 1247.8813,-2231.0016"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M406.1751,-2902.9504C435.4774,-2858.1511 552.0995,-2688.2152 690.4731,-2599.0016 741.3796,-2566.1807 768.035,-2587.4621 819.7932,-2556.0016 838.8622,-2544.4108 837.5049,-2533.7889 855.7932,-2521.0016 919.5583,-2476.4168 942.5685,-2476.979 1013.4998,-2445.0016 1038.5891,-2433.6908 1047.6724,-2436.2514 1070.5822,-2421.0016"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge606" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0026" stroke-dasharray="5,2" d="M403.6973,-2509.2489C428.3555,-2569.3631 544.6886,-2852.9727 577.2383,-2932.3258"/>
<polygon fill="#ff0026" stroke="#ff0026" points="574.0667,-2933.8166 581.0999,-2941.7402 580.543,-2931.16 574.0667,-2933.8166"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge188" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M435.3762,-2486.9739C449.599,-2482.6383 466.0533,-2477.6054 480.9653,-2473.0016 647.7167,-2421.5208 683.9983,-2386.7068 855.7932,-2356.0016 949.8889,-2339.1837 978.9142,-2372.0908 1070.5822,-2345.0016"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1247.8813,-2231.0016C1275.2898,-2203.3694 1305.7336,-2235.6315 1332.0981,-2207.0016 1387.9543,-2146.346 1313.6454,-2086.9202 1368.0981,-2025.0016 1371.5056,-2021.127 1375.5318,-2017.8515 1379.9199,-2015.0827"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1381.5757,-2018.1664 1388.7371,-2010.3584 1378.2696,-2011.9962 1381.5757,-2018.1664"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1070.5822,-2345.0016C1096.3095,-2335.2283 1107.2435,-2339.4514 1127.6646,-2321.0016 1152.4576,-2298.6019 1137.5689,-2275.8693 1163.6646,-2255.0016 1194.0609,-2230.6948 1220.4729,-2258.6338 1247.8813,-2231.0016"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge286" class="edge">
<title>sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#00ff19" stroke-dasharray="5,2" d="M1287.2341,-1950.9505C1345.6365,-1937.1935 1455.0346,-1921.9974 1517.2698,-1980.0016 1602.9313,-2059.8396 1485.0286,-2145.8431 1553.2698,-2241.0016 1600.1863,-2306.4241 1671.9487,-2254.1574 1715.2896,-2322.0016 1751.465,-2378.6293 1746.873,-3463.9505 1751.2896,-3531.0016 1798.1538,-4242.4831 1813.4048,-4421.1519 1914.2922,-5127.0016 1933.6671,-5262.5562 1935.6939,-5629.9963 2025.9177,-5733.0016 2028.9129,-5736.4211 2032.3807,-5739.3756 2036.1536,-5741.9279"/>
<polygon fill="#00ff19" stroke="#00ff19" points="2034.4181,-5744.9673 2044.8357,-5746.8975 2037.8956,-5738.8921 2034.4181,-5744.9673"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge193" class="edge">
<title>sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1304.488,-1973.0438C1327.7837,-1977.5881 1354.8793,-1982.8736 1378.8752,-1987.5545"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1378.4641,-1991.0402 1388.9492,-1989.5196 1379.8044,-1984.1697 1378.4641,-1991.0402"/>
</g>
<!-- sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge194" class="edge">
<title>sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M799.3358,-2524.8849C806.8843,-2521.4156 814.1103,-2516.891 819.7932,-2511.0016 853.7573,-2475.8031 820.3151,-2440.6735 855.7932,-2407.0016 927.8613,-2338.6025 975.2508,-2373.0051 1070.5822,-2345.0016"/>
</g>
<!-- sourcefile~dataroomair.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge174" class="edge">
<title>sourcefile~dataroomair.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M445.1015,-2414.2093C458.4932,-2410.2954 471.9324,-2403.7895 480.9653,-2393.0016 553.5979,-2306.2577 448.5032,-2231.0735 516.9653,-2141.0016 586.4363,-2049.6024 641.0268,-2028.3615 755.1332,-2041.0016"/>
</g>
<!-- sourcefile~refrigeratedcase.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge268" class="edge">
<title>sourcefile~refrigeratedcase.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#0cff00" stroke-dasharray="5,2" d="M2669.874,-4524.0016C2700.0082,-4556.9032 2717.9189,-4553.8244 2748.8254,-4586.0016 2788.6454,-4627.4587 2825.6881,-4684.4605 2843.9014,-4714.1717"/>
<polygon fill="#0cff00" stroke="#0cff00" points="2840.957,-4716.0664 2849.1328,-4722.8049 2846.9437,-4712.4387 2840.957,-4716.0664"/>
<path fill="none" stroke="#0cff00" stroke-dasharray="5,2" d="M2336.6179,-3908.0734C2353.9326,-3915.0301 2374.2393,-3925.4768 2388.6335,-3940.0016 2507.6043,-4060.052 2501.3744,-4121.6934 2554.9226,-4282.0016 2581.4613,-4361.4509 2545.8026,-4396.4277 2590.9226,-4467.0016 2614.2348,-4503.4652 2640.643,-4492.0861 2669.874,-4524.0016"/>
</g>
<!-- sourcefile~refrigeratedcase.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge382" class="edge">
<title>sourcefile~refrigeratedcase.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2304.7146,-3908.2236C2315.3639,-3955.7069 2357.5216,-4144.8379 2388.6335,-4301.0016 2485.416,-4786.7933 2450.8079,-4921.893 2590.9226,-5397.0016 2643.0044,-5573.6034 2708.9352,-5600.2533 2748.8254,-5780.0016 2801.7516,-6018.491 2849.6324,-7873.526 2855.169,-8094.5043"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2851.6769,-8094.8683 2855.4253,-8104.7779 2858.6747,-8094.6937 2851.6769,-8094.8683"/>
</g>
<!-- sourcefile~watermanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge468" class="edge">
<title>sourcefile~watermanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M1634.2797,-2799.0016C1870.7404,-2767.1876 1869.0908,-3013.1472 2102.8337,-3061.0016"/>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M2102.8337,-3061.0016C2137.2196,-3065.9954 2149.7074,-3057.5436 2179.7498,-3075.0016 2304.6433,-3147.5789 2337.0969,-3189.0578 2388.6335,-3324.0016 2433.7687,-3442.1837 2410.4963,-4336.2863 2424.6335,-4462.0016 2458.4849,-4763.0238 2502.339,-4832.681 2554.9226,-5131.0016 2572.7309,-5232.0328 2573.8823,-5257.838 2590.9226,-5359.0016 2618.1621,-5520.715 2654.0866,-5715.1907 2665.9133,-5778.7706"/>
<polygon fill="#3200ff" stroke="#3200ff" points="2662.5041,-5779.5817 2667.7759,-5788.7719 2669.3858,-5778.3001 2662.5041,-5779.5817"/>
</g>
<!-- sourcefile~watermanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge512" class="edge">
<title>sourcefile~watermanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1634.2797,-2799.0016C1669.0828,-2784.9007 1682.4681,-2793.2458 1715.2896,-2775.0016 1734.0004,-2764.6009 1731.2797,-2750.6093 1751.2896,-2743.0016 1804.0505,-2722.9419 1822.187,-2736.8115 1878.2922,-2743.0016 2109.2989,-2768.4887 2178.402,-2757.924 2388.6335,-2857.0016 2406.9691,-2865.6428 2406.9137,-2875.1593 2424.6335,-2885.0016 2451.6074,-2899.984 2471.6034,-2884.0668 2489.7781,-2909.0016"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1294.1438,-2775.0169C1366.8116,-2790.7849 1512.0365,-2816.0985 1634.2797,-2799.0016"/>
</g>
<!-- sourcefile~watermanager.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge589" class="edge">
<title>sourcefile~watermanager.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M1257.5049,-2775.2964C1276.0184,-2797.8103 1316.1689,-2850.6322 1332.0981,-2903.0016 1382.9159,-3070.0717 1286.6716,-3533.52 1368.0981,-3688.0016 1581.2821,-4092.4522 1980.6461,-3908.4371 2179.7498,-4320.0016 2231.6045,-4427.1898 2197.1765,-6345.3867 2215.7498,-6463.0016 2231.7333,-6564.2171 2275.2866,-6679.5111 2293.7443,-6725.4993"/>
<polygon fill="#ff004c" stroke="#ff004c" points="2290.5736,-6726.9941 2297.5759,-6734.9451 2297.0602,-6724.3628 2290.5736,-6726.9941"/>
</g>
<!-- sourcefile~watermanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge241" class="edge">
<title>sourcefile~watermanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1261.6279,-2775.2219C1365.6806,-2860.3449 2029.3451,-3406.7229 2179.7498,-3617.0016 2241.8759,-3703.8594 2282.0002,-3827.2235 2296.3154,-3875.9954"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2292.9889,-3877.0918 2299.1189,-3885.7332 2299.7156,-3875.1552 2292.9889,-3877.0918"/>
</g>
<!-- sourcefile~watermanager.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge409" class="edge">
<title>sourcefile~watermanager.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1261.8828,-2752.9359C1336.573,-2693.781 1685.8055,-2415.5647 1715.2896,-2362.0016 1768.3623,-2265.5855 1723.2127,-2223.4182 1751.2896,-2117.0016 1837.3914,-1790.659 1788.5526,-1648.9408 2025.9177,-1409.0016 2089.8322,-1344.394 2126.512,-1350.2013 2215.7498,-1333.0016 2450.6213,-1287.7323 2541.2841,-1288.0876 2748.8254,-1407.0016 2769.5779,-1418.8921 2766.9419,-1431.1199 2784.8254,-1447.0016 2813.6501,-1472.5996 2833.7519,-1465.3107 2855.7019,-1497.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2855.7019,-1497.0016C3043.8729,-1752.2648 2909.7692,-1890.3235 2926.5784,-2207.0016 2958.8826,-2815.6024 2900.5383,-7085.71 2962.5784,-7692.0016 2978.6208,-7848.7773 3025.3745,-8033.5587 3041.6814,-8094.9839"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3038.3912,-8096.2282 3044.3577,-8104.9832 3045.1532,-8094.4183 3038.3912,-8096.2282"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge469" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M1247.8813,-1429.0016C1595.7572,-1419.4026 1779.5329,-1401.787 1989.9177,-1679.0016 2050.0796,-1758.2742 1974.1345,-1815.0187 2025.9177,-1900.0016 2070.1978,-1972.6708 2132.5326,-1943.2056 2179.7498,-2014.0016 2216.593,-2069.2434 2168.1677,-2112.687 2215.7498,-2159.0016 2272.1246,-2213.8748 2337.8323,-2136.9314 2388.6335,-2197.0016 2492.9408,-2320.3403 2324.5429,-2796.2171 2424.6335,-2923.0016 2462.0092,-2970.3453 2518.3699,-2913.0196 2554.9226,-2961.0016 2595.2928,-3013.9949 2584.5316,-5292.6903 2590.9226,-5359.0016 2606.6549,-5522.2368 2650.0267,-5715.7275 2664.839,-5778.9127"/>
<polygon fill="#3200ff" stroke="#3200ff" points="2661.4811,-5779.9222 2667.1861,-5788.8499 2668.2937,-5778.3131 2661.4811,-5779.9222"/>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M1095.2213,-1467.9203C1128.9171,-1453.7339 1191.6211,-1430.7608 1247.8813,-1429.0016"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge516" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1247.8813,-1315.0016C1286.476,-1271.565 1303.6896,-1265.6893 1332.0981,-1215.0016 1356.8353,-1170.8646 1327.6184,-1137.356 1368.0981,-1107.0016 1478.7081,-1024.059 1873.023,-1053.1796 1989.9177,-1127.0016 2103.1474,-1198.509 2108.3907,-1247.6784 2179.7498,-1361.0016 2199.6655,-1392.6292 2191.2426,-1408.7821 2215.7498,-1437.0016 2276.0992,-1506.4928 2335.606,-1475.7743 2388.6335,-1551.0016 2427.3874,-1605.9796 2405.1028,-1633.6355 2424.6335,-1698.0016 2449.2155,-1779.0145 2466.221,-1795.6848 2489.7781,-1877.0016"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge591" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M1109.8395,-1482.8542C1200.7694,-1494.1454 1425.0818,-1536.1358 1517.2698,-1681.0016 1592.4479,-1799.1378 1488.4719,-1869.8681 1553.2698,-1994.0016 1597.7143,-2079.1442 1667.936,-2053.4419 1715.2896,-2137.0016 1758.526,-2213.2963 1731.8857,-2245.4811 1751.2896,-2331.0016 1913.5138,-3045.9909 2078.5587,-3197.8565 2179.7498,-3924.0016 2257.6316,-4482.8801 2128.4619,-5905.5148 2215.7498,-6463.0016 2231.6007,-6564.2379 2275.228,-6679.5203 2293.7249,-6725.5024"/>
<polygon fill="#ff004c" stroke="#ff004c" points="2290.5561,-6727.0015 2297.5649,-6734.9468 2297.0406,-6724.365 2290.5561,-6727.0015"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge243" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1247.8813,-1429.0016C1315.0864,-1426.2372 1481.6568,-1509.9413 1517.2698,-1567.0016 1604.7488,-1707.1636 1461.3606,-1799.7038 1553.2698,-1937.0016 1598.6201,-2004.7478 1663.7136,-1959.8659 1715.2896,-2023.0016 1792.3951,-2117.389 1975.0593,-2964.2421 2025.9177,-3075.0016 2078.4753,-3189.4615 2131.8374,-3196.5208 2179.7498,-3313.0016 2265.5754,-3521.6546 2293.9888,-3797.9628 2300.5587,-3875.7986"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2297.0738,-3876.1278 2301.3737,-3885.8108 2304.0507,-3875.5597 2297.0738,-3876.1278"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge228" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1072.3651,-1490.0312C1080.2518,-1539.2528 1112.2891,-1743.8476 1127.6646,-1913.0016 1142.0056,-2070.7755 1117.2067,-2473.5422 1163.6646,-2625.0016 1178.0236,-2671.8141 1211.6152,-2719.0342 1231.766,-2744.5975"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1229.2862,-2747.0991 1238.2794,-2752.7002 1234.742,-2742.7134 1229.2862,-2747.0991"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge412" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1084.3263,-1467.8913C1115.2972,-1442.5258 1192.1801,-1377.6909 1247.8813,-1315.0016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1247.8813,-1315.0016C1286.476,-1271.565 1306.1271,-1266.9804 1332.0981,-1215.0016 1363.9018,-1151.3491 1323.1916,-1114.1968 1368.0981,-1059.0016 1611.1052,-760.3183 1807.7121,-656.7437 2179.7498,-756.0016 2327.273,-795.3601 2643.3296,-1030.6257 2748.8254,-1141.0016 2847.0702,-1243.791 2884.9105,-1271.055 2926.5784,-1407.0016 2977.7401,-1573.9232 2944.8788,-7518.3149 2962.5784,-7692.0016 2978.5553,-7848.784 3025.3509,-8033.5612 3041.6751,-8094.9845"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3038.3853,-8096.2302 3044.3542,-8104.9836 3045.1468,-8094.4184 3038.3853,-8096.2302"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge296" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1477.6065,-9092.9777C1515.716,-9081.9587 1578.7211,-9066.6847 1634.2797,-9067.0016"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge548" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1443.8555,-9092.9381C1451.7621,-9017.7859 1497.606,-8574.331 1517.2698,-8212.0016 1534.6042,-7892.5938 1510.7816,-7090.0451 1553.2698,-6773.0016 1569.1719,-6654.3416 1610.9912,-6516.4109 1627.4678,-6464.8491"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="1630.8428,-6465.7869 1630.5806,-6455.1953 1624.1806,-6463.6387 1630.8428,-6465.7869"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge332" class="edge">
<title>sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00d8ff" stroke-dasharray="5,2" d="M457.2614,-1424.8839C465.4708,-1422.237 473.61,-1418.9859 480.9653,-1415.0016 536.4929,-1384.923 525.5033,-1338.0296 585.7192,-1319.0016"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge336" class="edge">
<title>sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00d8ff" stroke-dasharray="5,2" d="M585.7192,-1319.0016C728.5288,-1283.8192 773.1824,-1285.5915 916.6465,-1318.0016"/>
<path fill="none" stroke="#00d8ff" stroke-dasharray="5,2" d="M439.9143,-1383.9068C453.1611,-1379.9447 467.8249,-1375.1696 480.9653,-1370.0016 529.1544,-1351.0496 536.3439,-1334.604 585.7192,-1319.0016"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge346" class="edge">
<title>sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M1254.9991,-2089.0182C1272.0045,-2116.0051 1314.8589,-2188.1059 1332.0981,-2255.0016 1398.3217,-2511.9774 1348.0327,-2586.3896 1368.0981,-2851.0016 1392.1347,-3167.9827 1430.9522,-3553.2556 1440.5071,-3646.8027"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1437.0466,-3647.3677 1441.5468,-3656.9593 1444.0102,-3646.6549 1437.0466,-3647.3677"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge527" class="edge">
<title>sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1315.0256,-2066.9712C1321.5946,-2063.4587 1327.5111,-2058.9015 1332.0981,-2053.0016 1394.2767,-1973.0281 1301.5331,-1218.3628 1368.0981,-1142.0016 1405.4001,-1099.2101 1825.3323,-1094.5614 1878.2922,-1115.0016 1938.8007,-1138.3553 1955.9212,-1153.7667 1989.9177,-1209.0016 2026.3074,-1268.1247 1991.9068,-1300.4788 2025.9177,-1361.0016 2073.0045,-1444.7931 2112.5043,-1444.3268 2179.7498,-1513.0016 2196.0263,-1529.6241 2198.9169,-1534.9426 2215.7498,-1551.0016 2289.1433,-1621.0212 2324.1197,-1621.7245 2388.6335,-1700.0016 2446.2585,-1769.9201 2464.1244,-1790.1044 2489.7781,-1877.0016"/>
</g>
<!-- sourcefile~packagedthermalstoragecoil.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge430" class="edge">
<title>sourcefile~packagedthermalstoragecoil.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M3049.7245,-8104.9692C3060.5459,-8053.8967 3106.1211,-7835.215 3132.1655,-7654.0016 3186.7213,-7274.4107 3224.0089,-6807.3987 3231.9925,-6703.2443"/>
<polygon fill="#0019ff" stroke="#0019ff" points="3235.4967,-6703.3213 3232.7662,-6693.0844 3228.5169,-6702.7897 3235.4967,-6703.3213"/>
</g>
<!-- sourcefile~plantwaterthermaltank.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge427" class="edge">
<title>sourcefile~plantwaterthermaltank.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2926.5282,-8116.0016C2934.9594,-8116.0016 2943.6683,-8116.0016 2952.368,-8116.0016"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2952.5595,-8119.5017 2962.5594,-8116.0016 2952.5594,-8112.5017 2952.5595,-8119.5017"/>
</g>
<!-- sourcefile~plantsolarcollectors.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge375" class="edge">
<title>sourcefile~plantsolarcollectors.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2314.5169,-7252.168C2334.396,-7271.0676 2372.8979,-7311.5653 2388.6335,-7355.0016 2447.4326,-7517.3092 2349.5705,-7975.5454 2424.6335,-8131.0016 2487.5342,-8261.2694 2526.5918,-8364.9113 2669.874,-8345.0016"/>
</g>
<!-- sourcefile~standardratings.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~EfferentGraph_edge515" class="edge">
<title>sourcefile~standardratings.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M2106.8896,-5102.7908C2120.0048,-5066.0062 2161.4741,-4945.4175 2179.7498,-4842.0016 2189.1342,-4788.8981 2176.2292,-4394.6918 2215.7498,-4358.0016 2326.224,-4255.4393 2412.2845,-4309.2373 2554.9226,-4358.0016 2595.3703,-4371.8296 2632.6117,-4406.3148 2653.1861,-4428.0723"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="2650.8785,-4430.7332 2660.2273,-4435.7183 2656.0277,-4425.9913 2650.8785,-4430.7332"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefilehvacunitarysystemf90EfferentGraph = svgPanZoom('#sourcefilehvacunitarysystemf90EfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <h3>Files Dependent On This One</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~hvacunitarysystem.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilehvacunitarysystemf90AfferentGraph" width="641pt" height="168pt"
 viewBox="0.00 0.00 641.00 167.71" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph" class="graph" transform="scale(.2986 .2986) rotate(0) translate(4 557.6435)">
<title>sourcefile~~hvacunitarysystem.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-557.6435 2142.6572,-557.6435 2142.6572,4 -4,4"/>
<!-- sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~hvacunitarysystem.f90</title>
<polygon fill="none" stroke="#000000" points="126.266,-311.3989 -.0887,-311.3989 -.0887,-289.388 126.266,-289.388 126.266,-311.3989"/>
<text text-anchor="middle" x="63.0886" y="-297.2435" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">HVACUnitarySystem.f90</text>
</g>
<!-- sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~simairservingzones.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node2"><a xlink:href="../sourcefile/simairservingzones.f90.html" xlink:title="SimAirServingZones.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1023.3826,-137.3989 897.9555,-137.3989 897.9555,-115.388 1023.3826,-115.388 1023.3826,-137.3989"/>
<text text-anchor="middle" x="960.6691" y="-123.2435" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SimAirServingZones.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge61" class="edge">
<title>sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M118.7325,-289.3789C143.5689,-283.1738 172.6687,-274.0715 197.0676,-261.3935"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M197.0676,-261.3935C276.3072,-220.2195 197.8599,-128.7149 267.958,-73.3935 472.2442,87.8292 824.2483,-60.3634 929.8517,-110.9293"/>
<polygon fill="#ff0000" stroke="#ff0000" points="928.4842,-114.1559 939.0096,-115.3673 931.5369,-107.8566 928.4842,-114.1559"/>
</g>
<!-- sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~zoneequipmentmanager.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node3"><a xlink:href="../sourcefile/zoneequipmentmanager.f90.html" xlink:title="Zoneequipmentmanager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1032.5169,-389.3989 888.8212,-389.3989 888.8212,-367.388 1032.5169,-367.388 1032.5169,-389.3989"/>
<text text-anchor="middle" x="960.6691" y="-375.2435" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Zoneequipmentmanager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge62" class="edge">
<title>sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M562.325,-301.3935C684.1811,-318.3062 825.1824,-347.9829 902.4837,-365.1345"/>
<polygon fill="#ff0000" stroke="#ff0000" points="901.9812,-368.6083 912.503,-367.3667 903.5034,-361.7758 901.9812,-368.6083"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M197.0676,-261.3935C269.4498,-223.603 481.3952,-290.5453 562.325,-301.3935"/>
</g>
<!-- sourcefile~outdoorairunit.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~outdoorairunit.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node4"><a xlink:href="../sourcefile/outdoorairunit.f90.html" xlink:title="OutdoorAirUnit.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="819.7031,-553.3989 720.7866,-553.3989 720.7866,-531.388 819.7031,-531.388 819.7031,-553.3989"/>
<text text-anchor="middle" x="770.2449" y="-539.2435" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutdoorAirUnit.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~outdoorairunit.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge63" class="edge">
<title>sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~outdoorairunit.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M80.261,-311.542C114.6842,-333.5053 195.0829,-382.8825 267.958,-413.3935 421.2028,-477.5533 614.4969,-516.243 710.4847,-532.8456"/>
<polygon fill="#ff0000" stroke="#ff0000" points="710.1361,-536.3367 720.5831,-534.5726 711.3162,-529.4369 710.1361,-536.3367"/>
</g>
<!-- sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~mixedair.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node5"><a xlink:href="../sourcefile/mixedair.f90.html" xlink:title="MixedAir.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="231.8487,-311.3989 162.2865,-311.3989 162.2865,-289.388 231.8487,-289.388 231.8487,-311.3989"/>
<text text-anchor="middle" x="197.0676" y="-297.2435" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">MixedAir.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge64" class="edge">
<title>sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M126.5469,-300.3935C135.2022,-300.3935 143.9363,-300.3935 152.1691,-300.3935"/>
<polygon fill="#ff0000" stroke="#ff0000" points="152.2856,-303.8936 162.2855,-300.3935 152.2855,-296.8936 152.2856,-303.8936"/>
</g>
<!-- sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~sizingmanager.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node6"><a xlink:href="../sourcefile/sizingmanager.f90.html" xlink:title="SizingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1850.6217,-214.3989 1751.6642,-214.3989 1751.6642,-192.388 1850.6217,-192.388 1850.6217,-214.3989"/>
<text text-anchor="middle" x="1801.1429" y="-200.2435" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SizingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simairservingzones.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~simairservingzones.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1023.4778,-120.3556C1086.8402,-114.7922 1187.5114,-107.3935 1274.7902,-107.3935 1274.7902,-107.3935 1274.7902,-107.3935 1465.804,-107.3935 1581.6788,-107.3935 1711.6805,-161.0271 1769.9533,-188.1173"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1768.4658,-191.2854 1779.0038,-192.381 1771.4491,-184.9529 1768.4658,-191.2854"/>
</g>
<!-- sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~hvacmanager.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node7"><a xlink:href="../sourcefile/hvacmanager.f90.html" xlink:title="HVACManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1167.0112,-233.3989 1068.4531,-233.3989 1068.4531,-211.388 1167.0112,-211.388 1167.0112,-233.3989"/>
<text text-anchor="middle" x="1117.7322" y="-219.2435" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simairservingzones.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~simairservingzones.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M978.6862,-137.4059C1006.1145,-154.1706 1058.532,-186.2092 1090.5874,-205.8021"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1089.0836,-208.9849 1099.4414,-211.2138 1092.7343,-203.0122 1089.0836,-208.9849"/>
</g>
<!-- sourcefile~zoneequipmentmanager.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge14" class="edge">
<title>sourcefile~zoneequipmentmanager.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M980.9118,-367.3851C1019.309,-346.0174 1104.4772,-296.2643 1167.1216,-242.3935 1185.256,-226.7988 1181.2729,-212.124 1203.1216,-202.3935 1297.8874,-160.1883 1609.1142,-184.4847 1741.1085,-197.1764"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1741.1381,-200.6957 1751.43,-198.1804 1741.8159,-193.7286 1741.1381,-200.6957"/>
</g>
<!-- sourcefile~zoneequipmentmanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge15" class="edge">
<title>sourcefile~zoneequipmentmanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M983.5186,-367.3167C998.4157,-359.4173 1017.7306,-347.8397 1032.3428,-334.3935 1052.2282,-316.0948 1052.0045,-306.9186 1068.3428,-285.3935 1079.6758,-270.4626 1092.7764,-253.7772 1102.6364,-241.3305"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1105.405,-243.4721 1108.8832,-233.4644 1099.9233,-239.1188 1105.405,-243.4721"/>
</g>
<!-- sourcefile~outdoorairunit.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge16" class="edge">
<title>sourcefile~outdoorairunit.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M819.9648,-538.3839C832.031,-535.2551 844.0242,-530.0265 852.9954,-521.3935 893.731,-482.1932 848.9817,-439.3303 888.9954,-399.3935 890.6358,-397.7561 892.3967,-396.2451 894.253,-394.8506"/>
<polygon fill="#00ffff" stroke="#00ffff" points="896.2855,-397.7082 902.9273,-389.4537 892.5876,-391.7647 896.2855,-397.7082"/>
</g>
<!-- sourcefile~generalroutines.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node14" class="node">
<title>sourcefile~generalroutines.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node14"><a xlink:href="../sourcefile/generalroutines.f90.html" xlink:title="GeneralRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1014.9793,-532.3989 906.3588,-532.3989 906.3588,-510.388 1014.9793,-510.388 1014.9793,-532.3989"/>
<text text-anchor="middle" x="960.6691" y="-518.2435" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">GeneralRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~outdoorairunit.f90&#45;&gt;sourcefile~generalroutines.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge17" class="edge">
<title>sourcefile~outdoorairunit.f90&#45;&gt;sourcefile~generalroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M819.7795,-536.9308C843.1214,-534.3566 871.2634,-531.2531 896.2389,-528.4988"/>
<polygon fill="#00ffff" stroke="#00ffff" points="896.8049,-531.9577 906.361,-527.3826 896.0375,-524.9999 896.8049,-531.9577"/>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge57" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M562.325,-145.3935C654.5159,-151.7359 677.9214,-141.4225 770.2449,-145.3935"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M352.5568,-87.3935C438.0491,-42.1448 465.8246,-138.7546 562.325,-145.3935"/>
</g>
<!-- sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~simulationmanager.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node8"><a xlink:href="../sourcefile/simulationmanager.f90.html" xlink:title="SimulationManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2006.2398,-272.3989 1886.4294,-272.3989 1886.4294,-250.388 2006.2398,-250.388 2006.2398,-272.3989"/>
<text text-anchor="middle" x="1946.3346" y="-258.2435" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SimulationManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge53" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M770.2449,-67.3935C994.2156,-78.4626 1050.546,-69.3935 1274.7902,-69.3935 1274.7902,-69.3935 1274.7902,-69.3935 1465.804,-69.3935 1618.6232,-69.3935 1666.9347,-72.3054 1801.1429,-145.3935"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M217.6942,-289.254C223.0302,-285.4883 228.2971,-280.834 231.958,-275.3935 270.2331,-218.5124 224.207,-178.1788 267.958,-125.3935 294.2613,-93.6587 316.1264,-106.675 352.5568,-87.3935"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M352.5568,-87.3935C377.5123,-74.1852 445.2814,-51.8955 473.1555,-47.3935 551.4032,-34.7554 572.5083,-40.7885 651.4944,-47.3935 654.8278,-47.6722 766.9063,-67.1845 770.2449,-67.3935"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1801.1429,-145.3935C1852.4625,-171.5508 1902.8167,-217.6411 1928.5928,-243.1407"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1926.2385,-245.7367 1935.777,-250.3485 1931.1964,-240.795 1926.2385,-245.7367"/>
</g>
<!-- sourcefile~hvacstandaloneerv.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node15" class="node">
<title>sourcefile~hvacstandaloneerv.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node15"><a xlink:href="../sourcefile/hvacstandaloneerv.f90.html" xlink:title="HVACStandAloneERV.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="836.3928,-389.3989 704.0969,-389.3989 704.0969,-367.388 836.3928,-367.388 836.3928,-389.3989"/>
<text text-anchor="middle" x="770.2449" y="-375.2435" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACStandAloneERV.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacstandaloneerv.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge51" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacstandaloneerv.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M210.094,-311.4295C255.6193,-348.7826 412.9689,-467.7386 562.325,-460.3935"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M562.325,-460.3935C623.9466,-466.1009 629.3821,-420.6719 687.4944,-399.3935 694.7362,-396.7418 702.4526,-394.3006 710.1515,-392.0937"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="711.1427,-395.4511 719.8571,-389.4255 709.2871,-388.7015 711.1427,-395.4511"/>
</g>
<!-- sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node16" class="node">
<title>sourcefile~hvaccontrollers.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node16"><a xlink:href="../sourcefile/hvaccontrollers.f90.html" xlink:title="HVACControllers.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="616.5044,-78.3989 508.1455,-78.3989 508.1455,-56.388 616.5044,-56.388 616.5044,-78.3989"/>
<text text-anchor="middle" x="562.325" y="-64.2435" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACControllers.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge52" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~hvaccontrollers.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M352.5568,-87.3935C397.0087,-63.8663 454.2133,-59.8406 497.6539,-61.1559"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="497.689,-64.6601 507.8226,-61.568 497.9725,-57.6659 497.689,-64.6601"/>
</g>
<!-- sourcefile~packagedterminalheatpump.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node17" class="node">
<title>sourcefile~packagedterminalheatpump.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node17"><a xlink:href="../sourcefile/packagedterminalheatpump.f90.html" xlink:title="PackagedTerminalHeatPump.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="852.7466,-430.3989 687.7431,-430.3989 687.7431,-408.388 852.7466,-408.388 852.7466,-430.3989"/>
<text text-anchor="middle" x="770.2449" y="-416.2435" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PackagedTerminalHeatPump.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~packagedterminalheatpump.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge54" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~packagedterminalheatpump.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M562.325,-460.3935C577.0995,-461.7619 655.8129,-445.1259 712.0183,-432.6325"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="712.8826,-436.0258 721.8802,-430.4317 711.3579,-429.1939 712.8826,-436.0258"/>
</g>
<!-- sourcefile~airflownetworkbalancemanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node18" class="node">
<title>sourcefile~airflownetworkbalancemanager.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node18"><a xlink:href="../sourcefile/airflownetworkbalancemanager.f90.html" xlink:title="AirflowNetworkBalanceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="651.6641,-232.3989 472.9858,-232.3989 472.9858,-210.388 651.6641,-210.388 651.6641,-232.3989"/>
<text text-anchor="middle" x="562.325" y="-218.2435" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">AirflowNetworkBalanceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~airflownetworkbalancemanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge55" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~airflownetworkbalancemanager.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M231.9365,-290.596C243.3763,-287.5028 256.1762,-284.1704 267.958,-281.3935 344.5004,-263.3529 432.9929,-245.7498 492.8071,-234.3269"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="493.7229,-237.7155 502.8922,-232.4076 492.4142,-230.8389 493.7229,-237.7155"/>
</g>
<!-- sourcefile~hvacvariablerefrigerantflow.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node19" class="node">
<title>sourcefile~hvacvariablerefrigerantflow.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node19"><a xlink:href="../sourcefile/hvacvariablerefrigerantflow.f90.html" xlink:title="HVACVariableRefrigerantFlow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="437.2544,-312.3989 267.8591,-312.3989 267.8591,-290.388 437.2544,-290.388 437.2544,-312.3989"/>
<text text-anchor="middle" x="352.5568" y="-298.2435" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACVariableRefrigerantFlow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacvariablerefrigerantflow.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge56" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacvariablerefrigerantflow.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M231.9624,-300.6179C239.9187,-300.669 248.7457,-300.7258 257.9015,-300.7847"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="257.9177,-304.2848 267.94,-300.8493 257.9628,-297.2849 257.9177,-304.2848"/>
</g>
<!-- sourcefile~hvacunitarybypassvav.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node20" class="node">
<title>sourcefile~hvacunitarybypassvav.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node20"><a xlink:href="../sourcefile/hvacunitarybypassvav.f90.html" xlink:title="HVACUnitaryBypassVAV.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="424.6579,-156.3989 280.4557,-156.3989 280.4557,-134.388 424.6579,-134.388 424.6579,-156.3989"/>
<text text-anchor="middle" x="352.5568" y="-142.2435" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACUnitaryBypassVAV.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacunitarybypassvav.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge58" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacunitarybypassvav.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M215.7447,-289.3508C221.4011,-285.423 227.3336,-280.6548 231.958,-275.3935 254.2747,-250.0029 245.8753,-233.9878 267.958,-208.3935 283.9516,-189.8566 306.3136,-173.4986 324.0301,-162.0995"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="326.1914,-164.8759 332.813,-156.6052 322.4789,-158.9415 326.1914,-164.8759"/>
</g>
<!-- sourcefile~fancoilunits.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node21" class="node">
<title>sourcefile~fancoilunits.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node21"><a xlink:href="../sourcefile/fancoilunits.f90.html" xlink:title="FanCoilUnits.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="814.8626,-512.3989 725.6271,-512.3989 725.6271,-490.388 814.8626,-490.388 814.8626,-512.3989"/>
<text text-anchor="middle" x="770.2449" y="-498.2435" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">FanCoilUnits.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~fancoilunits.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge59" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~fancoilunits.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M562.325,-460.3935C615.7999,-465.3464 675.8894,-477.9803 717.6658,-487.926"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="717.0701,-491.3827 727.6121,-490.3255 718.7118,-484.5779 717.0701,-491.3827"/>
</g>
<!-- sourcefile~windowac.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node22" class="node">
<title>sourcefile~windowac.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node22"><a xlink:href="../sourcefile/windowac.f90.html" xlink:title="WindowAC.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="811.1907,-471.3989 729.2991,-471.3989 729.2991,-449.388 811.1907,-449.388 811.1907,-471.3989"/>
<text text-anchor="middle" x="770.2449" y="-457.2435" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WindowAC.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~windowac.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge60" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~windowac.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M562.325,-460.3935C615.7858,-465.345 677.311,-464.5429 719.4833,-463.0014"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="719.65,-466.4976 729.5049,-462.6078 719.3752,-459.503 719.65,-466.4976"/>
</g>
<!-- sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1828.7941,-214.4393C1851.4564,-223.4923 1883.7525,-236.3937 1908.7586,-246.3829"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1907.7069,-249.7317 1918.2918,-250.1911 1910.3037,-243.2311 1907.7069,-249.7317"/>
</g>
<!-- sourcefile~hvacmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~hvacmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1130.8479,-211.1882C1146.7485,-198.3719 1174.9324,-178.0455 1203.1216,-169.3935 1330.268,-130.3686 1681.9981,-86.2862 1801.1429,-145.3935"/>
</g>
<!-- sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node11" class="node">
<title>sourcefile~heatbalanceairmanager.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node11"><a xlink:href="../sourcefile/heatbalanceairmanager.f90.html" xlink:title="HeatBalanceAirManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1346.6277,-233.3989 1202.9526,-233.3989 1202.9526,-211.388 1346.6277,-211.388 1346.6277,-233.3989"/>
<text text-anchor="middle" x="1274.7902" y="-219.2435" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceAirManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacmanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~hvacmanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1167.4263,-222.3935C1175.5651,-222.3935 1184.1837,-222.3935 1192.8579,-222.3935"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1193.0406,-225.8936 1203.0406,-222.3935 1193.0406,-218.8936 1193.0406,-225.8936"/>
</g>
<!-- sourcefile~energyplus.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~energyplus.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node9"><a xlink:href="../sourcefile/energyplus.f90.html" xlink:title="EnergyPlus.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2132.0556,-272.3989 2048.6385,-272.3989 2048.6385,-250.388 2132.0556,-250.388 2132.0556,-272.3989"/>
<text text-anchor="middle" x="2090.347" y="-258.2435" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EnergyPlus.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2006.1577,-261.3935C2016.8223,-261.3935 2027.8542,-261.3935 2038.2805,-261.3935"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2038.469,-264.8936 2048.469,-261.3935 2038.4689,-257.8936 2038.469,-264.8936"/>
</g>
<!-- sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node10" class="node">
<title>sourcefile~utilityroutines.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node10"><a xlink:href="../sourcefile/utilityroutines.f90.html" xlink:title="UtilityRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2138.4682,-349.3989 2042.2259,-349.3989 2042.2259,-327.388 2138.4682,-327.388 2138.4682,-349.3989"/>
<text text-anchor="middle" x="2090.347" y="-335.2435" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">UtilityRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1966.9681,-272.4257C1991.5644,-285.5767 2032.8476,-307.6499 2060.8194,-322.6057"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2059.2829,-325.7531 2069.7518,-327.3817 2062.5835,-319.58 2059.2829,-325.7531"/>
</g>
<!-- sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1312.0538,-233.4732C1350.2443,-244.0029 1411.551,-258.6314 1465.804,-261.3935"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1465.804,-261.3935C1547.7411,-265.565 1568.4716,-257.0781 1650.4014,-261.3935"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node12" class="node">
<title>sourcefile~heatbalancesurfacemanager.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node12"><a xlink:href="../sourcefile/heatbalancesurfacemanager.f90.html" xlink:title="HeatBalanceSurfaceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1548.9947,-233.3989 1382.6132,-233.3989 1382.6132,-211.388 1548.9947,-211.388 1548.9947,-233.3989"/>
<text text-anchor="middle" x="1465.804" y="-219.2435" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceSurfaceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1346.4601,-222.3935C1354.9058,-222.3935 1363.6173,-222.3935 1372.3065,-222.3935"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1372.4795,-225.8936 1382.4795,-222.3935 1372.4794,-218.8936 1372.4795,-225.8936"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1650.4014,-261.3935C1717.3049,-264.9173 1734.2852,-257.087 1801.1429,-261.3935"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1501.7869,-233.4718C1538.6717,-244.0006 1597.9014,-258.6282 1650.4014,-261.3935"/>
</g>
<!-- sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node13" class="node">
<title>sourcefile~heatbalancemanager.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node13"><a xlink:href="../sourcefile/heatbalancemanager.f90.html" xlink:title="HeatBalanceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1715.4067,-233.3989 1585.396,-233.3989 1585.396,-211.388 1715.4067,-211.388 1715.4067,-233.3989"/>
<text text-anchor="middle" x="1650.4014" y="-219.2435" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1549.1916,-222.3935C1557.9132,-222.3935 1566.7419,-222.3935 1575.3623,-222.3935"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1575.3674,-225.8936 1585.3674,-222.3935 1575.3674,-218.8936 1575.3674,-225.8936"/>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1715.6421,-214.1703C1724.1275,-213.1008 1732.7873,-212.0093 1741.1808,-210.9513"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1741.7735,-214.4044 1751.2573,-209.6812 1740.8981,-207.4593 1741.7735,-214.4044"/>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1679.6073,-233.462C1709.5874,-243.983 1757.8461,-258.6046 1801.1429,-261.3935"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1801.1429,-261.3935C1825.6846,-262.9742 1852.608,-263.3501 1876.5334,-263.2099"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1876.6196,-266.7094 1886.5879,-263.1202 1876.5571,-259.7097 1876.6196,-266.7094"/>
</g>
<!-- sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge22" class="edge">
<title>sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M836.5787,-378.3935C850.1391,-378.3935 864.5628,-378.3935 878.5981,-378.3935"/>
<polygon fill="#ff0000" stroke="#ff0000" points="878.7314,-381.8936 888.7314,-378.3935 878.7314,-374.8936 878.7314,-381.8936"/>
</g>
<!-- sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge23" class="edge">
<title>sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M809.2848,-367.3054C861.6516,-351.6886 956.7959,-320.6802 1032.3428,-281.3935 1055.2136,-269.4999 1079.1894,-252.4738 1095.8926,-239.766"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1098.1462,-242.4478 1103.9199,-233.5644 1093.8666,-236.9083 1098.1462,-242.4478"/>
</g>
<!-- sourcefile~systemreports.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node23" class="node">
<title>sourcefile~systemreports.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node23"><a xlink:href="../sourcefile/systemreports.f90.html" xlink:title="SystemReports.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1011.4554,-430.3989 909.8828,-430.3989 909.8828,-408.388 1011.4554,-408.388 1011.4554,-430.3989"/>
<text text-anchor="middle" x="960.6691" y="-416.2435" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SystemReports.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~systemreports.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge21" class="edge">
<title>sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~systemreports.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M821.5256,-389.4346C845.7405,-394.6483 874.811,-400.9075 900.1042,-406.3533"/>
<polygon fill="#ff0000" stroke="#ff0000" points="899.4442,-409.7913 909.9569,-408.4747 900.9176,-402.9482 899.4442,-409.7913"/>
</g>
<!-- sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge25" class="edge">
<title>sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M770.2449,-145.3935C809.066,-147.0632 852.1607,-143.2417 887.5214,-138.5978"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="888.3197,-142.0214 897.7554,-137.203 887.3743,-135.0855 888.3197,-142.0214"/>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M580.1252,-78.4976C615.0626,-99.2649 695.7124,-142.1877 770.2449,-145.3935"/>
</g>
<!-- sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge27" class="edge">
<title>sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M616.6461,-65.9282C658.6188,-65.1506 718.148,-64.8187 770.2449,-67.3935"/>
</g>
<!-- sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node24" class="node">
<title>sourcefile~hvacfurnace.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node24"><a xlink:href="../sourcefile/hvacfurnace.f90.html" xlink:title="HVACFurnace.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="818.6765,-117.3989 721.8132,-117.3989 721.8132,-95.388 818.6765,-95.388 818.6765,-117.3989"/>
<text text-anchor="middle" x="770.2449" y="-103.2435" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACFurnace.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge26" class="edge">
<title>sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M616.6819,-77.5893C645.9774,-83.0843 682.1371,-89.8669 712.0076,-95.4698"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="711.4037,-98.9174 721.8775,-97.3211 712.6942,-92.0374 711.4037,-98.9174"/>
</g>
<!-- sourcefile~packagedterminalheatpump.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge29" class="edge">
<title>sourcefile~packagedterminalheatpump.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M821.5256,-408.3523C845.546,-403.1805 874.3443,-396.9799 899.494,-391.565"/>
<polygon fill="#7fff00" stroke="#7fff00" points="900.2576,-394.9809 909.2968,-389.4544 898.7841,-388.1377 900.2576,-394.9809"/>
</g>
<!-- sourcefile~packagedterminalheatpump.f90&#45;&gt;sourcefile~systemreports.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge28" class="edge">
<title>sourcefile~packagedterminalheatpump.f90&#45;&gt;sourcefile~systemreports.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M852.9369,-419.3935C868.6764,-419.3935 884.8804,-419.3935 899.7879,-419.3935"/>
<polygon fill="#7fff00" stroke="#7fff00" points="899.8798,-422.8936 909.8797,-419.3935 899.8797,-415.8936 899.8798,-422.8936"/>
</g>
<!-- sourcefile~airflownetworkbalancemanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge39" class="edge">
<title>sourcefile~airflownetworkbalancemanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M960.6691,-221.3935C992.8243,-223.0544 1028.7311,-223.3959 1058.088,-223.2817"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="1058.2021,-226.7812 1068.1818,-223.2238 1058.1618,-219.7813 1058.2021,-226.7812"/>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M622.5975,-210.3665C643.115,-207.1142 666.2345,-203.9978 687.4944,-202.3935 760.8418,-196.8583 779.7197,-195.9779 852.9954,-202.3935 901.4045,-206.6318 912.1394,-218.8868 960.6691,-221.3935"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node25" class="node">
<title>sourcefile~systemavailabilitymanager.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node25"><a xlink:href="../sourcefile/systemavailabilitymanager.f90.html" xlink:title="SystemAvailabilityManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="847.5511,-233.3989 692.9386,-233.3989 692.9386,-211.388 847.5511,-211.388 847.5511,-233.3989"/>
<text text-anchor="middle" x="770.2449" y="-219.2435" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SystemAvailabilityManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~airflownetworkbalancemanager.f90&#45;&gt;sourcefile~systemavailabilitymanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge38" class="edge">
<title>sourcefile~airflownetworkbalancemanager.f90&#45;&gt;sourcefile~systemavailabilitymanager.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M651.7084,-221.8234C661.9444,-221.8726 672.3729,-221.9227 682.586,-221.9719"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="682.6956,-225.4723 692.7123,-222.0206 682.7293,-218.4724 682.6956,-225.4723"/>
</g>
<!-- sourcefile~hvacvariablerefrigerantflow.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge43" class="edge">
<title>sourcefile~hvacvariablerefrigerantflow.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M437.3829,-296.1045C475.7134,-295.0701 521.4731,-295.7235 562.325,-301.3935"/>
</g>
<!-- sourcefile~plantloopequipment.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node27" class="node">
<title>sourcefile~plantloopequipment.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node27"><a xlink:href="../sourcefile/plantloopequipment.f90.html" xlink:title="PlantLoopEquipment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="625.8276,-273.3989 498.8223,-273.3989 498.8223,-251.388 625.8276,-251.388 625.8276,-273.3989"/>
<text text-anchor="middle" x="562.325" y="-259.2435" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantLoopEquipment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacvariablerefrigerantflow.f90&#45;&gt;sourcefile~plantloopequipment.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge44" class="edge">
<title>sourcefile~hvacvariablerefrigerantflow.f90&#45;&gt;sourcefile~plantloopequipment.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M411.8268,-290.374C437.0727,-285.6803 466.6976,-280.1724 492.9553,-275.2906"/>
<polygon fill="#00ffff" stroke="#00ffff" points="493.6461,-278.7223 502.8378,-273.4533 492.3665,-271.8402 493.6461,-278.7223"/>
</g>
<!-- sourcefile~hvacunitarybypassvav.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge45" class="edge">
<title>sourcefile~hvacunitarybypassvav.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M424.9667,-142.948C465.4239,-142.1953 516.728,-142.2565 562.325,-145.3935"/>
</g>
<!-- sourcefile~fancoilunits.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge47" class="edge">
<title>sourcefile~fancoilunits.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M814.922,-497.5981C828.3579,-494.5919 842.3441,-489.3749 852.9954,-480.3935 883.1127,-454.9977 859.3464,-425.3345 888.9954,-399.3935 891.002,-397.6378 893.1486,-396.0287 895.3999,-394.5539"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="897.4703,-397.4086 904.5269,-389.5058 894.0822,-391.2831 897.4703,-397.4086"/>
</g>
<!-- sourcefile~fancoilunits.f90&#45;&gt;sourcefile~generalroutines.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge48" class="edge">
<title>sourcefile~fancoilunits.f90&#45;&gt;sourcefile~generalroutines.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M814.8909,-506.0826C839.1624,-508.6318 869.61,-511.8297 896.3934,-514.6427"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="896.1475,-518.136 906.4584,-515.6998 896.8787,-511.1743 896.1475,-518.136"/>
</g>
<!-- sourcefile~fancoilunits.f90&#45;&gt;sourcefile~systemreports.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge46" class="edge">
<title>sourcefile~fancoilunits.f90&#45;&gt;sourcefile~systemreports.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M815.1757,-492.3055C827.6399,-489.1653 841.0298,-485.2002 852.9954,-480.3935 882.825,-468.4104 914.5677,-449.5968 935.7971,-436.0306"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="937.7284,-438.9498 944.2155,-430.5731 933.9205,-433.0761 937.7284,-438.9498"/>
</g>
<!-- sourcefile~windowac.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge50" class="edge">
<title>sourcefile~windowac.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M811.2675,-454.9448C825.213,-451.8377 840.4343,-446.9786 852.9954,-439.3935 873.4695,-427.0299 868.7502,-412.1285 888.9954,-399.3935 892.5761,-397.141 896.4083,-395.1216 900.3696,-393.3124"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="901.8575,-396.4854 909.7897,-389.4618 899.2088,-390.0059 901.8575,-396.4854"/>
</g>
<!-- sourcefile~windowac.f90&#45;&gt;sourcefile~systemreports.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge49" class="edge">
<title>sourcefile~windowac.f90&#45;&gt;sourcefile~systemreports.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M811.0956,-451.5979C836.9035,-446.0413 870.725,-438.7592 899.6771,-432.5256"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="900.6544,-435.8954 909.6936,-430.3689 899.1809,-429.0523 900.6544,-435.8954"/>
</g>
<!-- sourcefile~systemreports.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge20" class="edge">
<title>sourcefile~systemreports.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1011.5618,-410.2932C1019.0731,-407.3673 1026.3037,-403.5013 1032.3428,-398.3935 1081.2218,-357.0515 1104.4152,-281.1685 1113.2479,-244.0263"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1116.7627,-244.3484 1115.5405,-233.8243 1109.933,-242.8135 1116.7627,-244.3484"/>
</g>
<!-- sourcefile~systemreports.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge18" class="edge">
<title>sourcefile~systemreports.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1009.0742,-408.3472C1070.516,-395.3135 1179.9367,-375.3935 1274.7902,-375.3935 1274.7902,-375.3935 1274.7902,-375.3935 1465.804,-375.3935 1614.8435,-375.3935 1654.703,-403.1088 1801.1429,-375.3935"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1801.1429,-375.3935C1858.4373,-362.7698 1908.0345,-309.9062 1931.6453,-280.808"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1934.6675,-282.6284 1938.1183,-272.6113 1929.1739,-278.2901 1934.6675,-282.6284"/>
</g>
<!-- sourcefile~systemreports.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge19" class="edge">
<title>sourcefile~systemreports.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1801.1429,-375.3935C1864.1611,-361.5086 1882.0543,-381.0604 1946.3346,-375.3935"/>
</g>
<!-- sourcefile~hvacfurnace.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge24" class="edge">
<title>sourcefile~hvacfurnace.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M818.7896,-111.4921C839.7148,-113.6898 864.6353,-116.3072 887.7089,-118.7305"/>
<polygon fill="#ff0000" stroke="#ff0000" points="887.5011,-122.2279 897.812,-119.7917 888.2323,-115.2662 887.5011,-122.2279"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge35" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M792.0889,-211.381C825.8614,-194.3551 890.8826,-161.5755 929.5574,-142.078"/>
<polygon fill="#ff0000" stroke="#ff0000" points="931.4334,-145.0519 938.7873,-137.4249 928.2822,-138.8013 931.4334,-145.0519"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge33" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M787.5023,-233.5577C804.5686,-244.8121 831.2154,-262.965 852.9954,-280.3935 885.7207,-306.5804 921.2259,-339.9588 942.1802,-360.226"/>
<polygon fill="#ff0000" stroke="#ff0000" points="939.8538,-362.8458 949.4625,-367.3093 944.7345,-357.8279 939.8538,-362.8458"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge34" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M847.6542,-219.9946C882.2535,-219.4357 923.5258,-219.4749 960.6691,-221.3935"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge37" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M847.7449,-211.4957C861.4636,-209.8834 875.6316,-208.4213 888.9954,-207.3935 1012.2629,-197.9127 1044.0109,-191.0562 1167.1216,-202.3935 1183.0401,-203.8594 1200.1168,-206.5199 1215.8736,-209.4321"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1215.5324,-212.9303 1226.0121,-211.3722 1216.8481,-206.055 1215.5324,-212.9303"/>
</g>
<!-- sourcefile~plantmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node26" class="node">
<title>sourcefile~plantmanager.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node26"><a xlink:href="../sourcefile/plantmanager.f90.html" xlink:title="PlantManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1007.9828,-272.3989 913.3553,-272.3989 913.3553,-250.388 1007.9828,-250.388 1007.9828,-272.3989"/>
<text text-anchor="middle" x="960.6691" y="-258.2435" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~plantmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge36" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~plantmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M824.0493,-233.4129C848.9051,-238.5035 878.4368,-244.5518 903.6736,-249.7205"/>
<polygon fill="#ff0000" stroke="#ff0000" points="902.9767,-253.1503 913.4756,-251.728 904.3812,-246.2926 902.9767,-253.1503"/>
</g>
<!-- sourcefile~plantmanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge32" class="edge">
<title>sourcefile~plantmanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1005.2569,-250.3219C1023.4061,-245.8154 1044.5504,-240.5651 1063.576,-235.8409"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1064.4431,-239.2319 1073.3049,-233.4251 1062.7561,-232.4382 1064.4431,-239.2319"/>
</g>
<!-- sourcefile~plantmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge30" class="edge">
<title>sourcefile~plantmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1008.0663,-259.7882C1097.5853,-257.1128 1297.6434,-252.8322 1465.804,-261.3935"/>
</g>
<!-- sourcefile~plantmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge31" class="edge">
<title>sourcefile~plantmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M987.4503,-272.4445C1041.0318,-293.5229 1165.6594,-337.3935 1274.7902,-337.3935 1274.7902,-337.3935 1274.7902,-337.3935 1650.4014,-337.3935 1740.0299,-337.3935 1761.7868,-349.5724 1850.6323,-361.3935 1893.2439,-367.063 1903.4267,-378.0003 1946.3346,-375.3935"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1946.3346,-375.3935C1981.9882,-372.2502 2021.266,-361.6582 2049.7835,-352.608"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2050.968,-355.9034 2059.3981,-349.4859 2048.806,-349.2456 2050.968,-355.9034"/>
</g>
<!-- sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge41" class="edge">
<title>sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M625.8842,-262.2339C702.3519,-262.0419 829.6079,-261.7225 903.2352,-261.5376"/>
<polygon fill="#ff0000" stroke="#ff0000" points="903.2664,-265.0377 913.2575,-261.5125 903.2487,-258.0377 903.2664,-265.0377"/>
</g>
<!-- sourcefile~plantloopsolver.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node28" class="node">
<title>sourcefile~plantloopsolver.f90</title>
<g id="a_sourcefile~~hvacunitarysystem.f90~~AfferentGraph_node28"><a xlink:href="../sourcefile/plantloopsolver.f90.html" xlink:title="PlantLoopSolver.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="823.2373,-311.3989 717.2524,-311.3989 717.2524,-289.388 823.2373,-289.388 823.2373,-311.3989"/>
<text text-anchor="middle" x="770.2449" y="-297.2435" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantLoopSolver.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantloopsolver.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge42" class="edge">
<title>sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantloopsolver.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M622.7433,-273.4357C649.2164,-278.274 680.2873,-283.9526 707.0674,-288.847"/>
<polygon fill="#ff0000" stroke="#ff0000" points="706.6362,-292.3261 717.1025,-290.681 707.8948,-285.4401 706.6362,-292.3261"/>
</g>
<!-- sourcefile~plantloopsolver.f90&#45;&gt;sourcefile~plantmanager.f90 -->
<g id="sourcefile~~hvacunitarysystem.f90~~AfferentGraph_edge40" class="edge">
<title>sourcefile~plantloopsolver.f90&#45;&gt;sourcefile~plantmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M823.2886,-289.5298C848.2568,-284.4162 878.0733,-278.3096 903.5384,-273.0942"/>
<polygon fill="#ff0000" stroke="#ff0000" points="904.3335,-276.5041 913.4278,-271.0687 902.9289,-269.6464 904.3335,-276.5041"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefilehvacunitarysystemf90AfferentGraph = svgPanZoom('#sourcefilehvacunitarysystemf90AfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <br>

    <section class="visible-xs visible-sm hidden-md">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/hvacunitarysystem.html">HVACUnitarySystem</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html#src">HVACUnitarySystem.f90</a>
  </div>
</div>


    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">MODULE </span><span class="n">HVACUnitarySystem</span>
<a name="ln-2"></a>  <span class="c">! Module containing the Unitary System simulation routines</span>
<a name="ln-3"></a>  <span class="c">! AirloopHVAC:UnitarySystem</span>
<a name="ln-4"></a>  <span class="c">! Unitary System allows any coil type with fan and coils optional</span>
<a name="ln-5"></a>  <span class="c">! Unitary System model can be placed anywhere in the simulation:</span>
<a name="ln-6"></a>  <span class="c">!   (air loops, outside air systems, Outdoor air units, zone equipment)</span>
<a name="ln-7"></a>  <span class="c">!   ( not fully tested for all configurations)</span>
<a name="ln-8"></a>  <span class="c">!</span>
<a name="ln-9"></a>  <span class="c">! Routine calling order:</span>
<a name="ln-10"></a>  <span class="c">!</span>
<a name="ln-11"></a>  <span class="c">!  SimUnitarySystem</span>
<a name="ln-12"></a>  <span class="c">!    GetUnitarySystemInput</span>
<a name="ln-13"></a>  <span class="c">!    InitUnitarySystems</span>
<a name="ln-14"></a>  <span class="c">!    IF(SetPointBased Control)THEN</span>
<a name="ln-15"></a>  <span class="c">!      ControlUnitarySystemToSP   ----&gt;  SimFan (if exists and blowthru)</span>
<a name="ln-16"></a>  <span class="c">!                                        UpdateUnitarySystemControl (cooling coil if exists)</span>
<a name="ln-17"></a>  <span class="c">!                                        ControlCoolingSystem ---&gt; Sim*CoolingCoil</span>
<a name="ln-18"></a>  <span class="c">!                                        CalcUnitaryCoolingSystem</span>
<a name="ln-19"></a>  <span class="c">!                                        UpdateUnitarySystemControl (heating coil if exists)</span>
<a name="ln-20"></a>  <span class="c">!                                        ControlHeatingSystem ---&gt; Sim*HeatingCoil</span>
<a name="ln-21"></a>  <span class="c">!                                        CalcUnitaryHeatingSystem</span>
<a name="ln-22"></a>  <span class="c">!                                        SimFan (if exists and drawthru)</span>
<a name="ln-23"></a>  <span class="c">!                                        UpdateUnitarySystemControl (supp heating coil if exists)</span>
<a name="ln-24"></a>  <span class="c">!                                        ControlSuppHeatingSystem ---&gt; Sim*HeatingCoil</span>
<a name="ln-25"></a>  <span class="c">!                                        CalcUnitarySuppSystemToSP</span>
<a name="ln-26"></a>  <span class="c">!    ELSEIF(LoadBased Control)THEN</span>
<a name="ln-27"></a>  <span class="c">!      ControlUnitarySystemToLoad ----&gt;  UpdateUnitarySystemControl</span>
<a name="ln-28"></a>  <span class="c">!                                        ControlUnitarySystemOutput ---&gt; CalcUnitarySystemToLoad(PLR)</span>
<a name="ln-29"></a>  <span class="c">!                                        CalcUnitarySystemToLoad(FinalPLR w/ supp heater operating)</span>
<a name="ln-30"></a>  <span class="c">!    END IF</span>
<a name="ln-31"></a>  <span class="c">!</span>
<a name="ln-32"></a>  <span class="c">!  ReportUnitarySystem(UnitarySysNum)</span>
<a name="ln-33"></a>  <span class="c">!</span>
<a name="ln-34"></a>  <span class="c">! MODULE INFORMATION:</span>
<a name="ln-35"></a>  <span class="c">!       AUTHOR         Richard Raustad, FSEC</span>
<a name="ln-36"></a>  <span class="c">!       DATE WRITTEN   February 2013</span>
<a name="ln-37"></a>  <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-38"></a>
<a name="ln-39"></a>  <span class="c">! PURPOSE OF THIS MODULE:</span>
<a name="ln-40"></a>  <span class="c">! To encapsulate the data and algorithms required to</span>
<a name="ln-41"></a>  <span class="c">! manage the Unitary System Component</span>
<a name="ln-42"></a>
<a name="ln-43"></a>  <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-44"></a>  <span class="c">! Calculates the part-load ratio of the HVAC system to meet the zone sensible load.</span>
<a name="ln-45"></a>  <span class="c">! IF humidity control is specified and the latent capacity at the sensible PLR is insufficient to meet the latent load,</span>
<a name="ln-46"></a>  <span class="c">! enable multimode operation and calculate a part-load ratio to meet the zone sensible load (MultiMode dehumidification control)</span>
<a name="ln-47"></a>  <span class="c">! or the zone latent load (CoolReheat dehumidification control).</span>
<a name="ln-48"></a>  <span class="c">!</span>
<a name="ln-49"></a>  <span class="c">! Subroutines:</span>
<a name="ln-50"></a>  <span class="c">!</span>
<a name="ln-51"></a>  <span class="c">! SimUnitarySystem - Top level simulate routine CALLed by other modules. Each child object is simulated a final time after</span>
<a name="ln-52"></a>  <span class="c">!                    the part-load ratio for child components has been determined.</span>
<a name="ln-53"></a>  <span class="c">!</span>
<a name="ln-54"></a>  <span class="c">!  Note: A supplemental heater augments the heating capacity for both air-to-air and water-to-air heat pump systems.</span>
<a name="ln-55"></a>  <span class="c">!        The supplemental heating coil may be present even if the system is not a heat pump.</span>
<a name="ln-56"></a>  <span class="c">!        The supplemental heating coil is used in the unitarysystem to meet the sensible load when the</span>
<a name="ln-57"></a>  <span class="c">!        primary heating coil is unable to meet the zone load.</span>
<a name="ln-58"></a>  <span class="c">!</span>
<a name="ln-59"></a>  <span class="c">!</span>
<a name="ln-60"></a>  <span class="c">! Dehumidificaiton control options:</span>
<a name="ln-61"></a>  <span class="c">!</span>
<a name="ln-62"></a>  <span class="c">! Dehumidification Control NONE:   If a HX assisted cooling coil is selected, the HX is always active (cooling).</span>
<a name="ln-63"></a>  <span class="c">!</span>
<a name="ln-64"></a>  <span class="c">! Dehumidification Control COOLREHEAT: For cooling operation, the sensible capacity is calculated to</span>
<a name="ln-65"></a>  <span class="c">!                                      meet the thermostat setpoint. If a HX assisted cooling coil is selected,</span>
<a name="ln-66"></a>  <span class="c">!                                      the HX is always active. If the latent load is not met by operating the</span>
<a name="ln-67"></a>  <span class="c">!                                      system at the sensible PLR, a new PLR is calculated to meet the humidistat</span>
<a name="ln-68"></a>  <span class="c">!                                      setpoint. The supplemental heating coil load is then calculated to meet the</span>
<a name="ln-69"></a>  <span class="c">!                                      HEATING setpoint temperature.</span>
<a name="ln-70"></a>  <span class="c">!</span>
<a name="ln-71"></a>  <span class="c">! Dehumidification Control MULTIMODE: For cooling operation, the sensible capacity is calculated to</span>
<a name="ln-72"></a>  <span class="c">!                                     meet the thermostat setpoint. If a HX assisted cooling coil is selected,</span>
<a name="ln-73"></a>  <span class="c">!                                     the HX is off for this calculation. If the latent load is not met by operating</span>
<a name="ln-74"></a>  <span class="c">!                                     the system at the sensible PLR, a new PLR is calculated with the HX operating</span>
<a name="ln-75"></a>  <span class="c">!                                     and the target is the zone SENSIBLE load (thermostat setpoint). Humidity is not</span>
<a name="ln-76"></a>  <span class="c">!                                     controlled in this mode. No reheat coil is needed in this configuration.</span>
<a name="ln-77"></a>  <span class="c">!</span>
<a name="ln-78"></a>  <span class="c">!</span>
<a name="ln-79"></a>  <span class="c">! REFERENCES:</span>
<a name="ln-80"></a>
<a name="ln-81"></a>  <span class="c">! OTHER NOTES:  This module is intended to allow any configuration of coil types and location. All possible configurations</span>
<a name="ln-82"></a>  <span class="c">!               have not been fully tested, however, the methodology is to treat all configurations the same. No special</span>
<a name="ln-83"></a>  <span class="c">!               treatment is desired (e.g., IF coiltype == X THEN do this ELSE do something else). DX coils have not been</span>
<a name="ln-84"></a>  <span class="c">!               included as supplemental heating coils, however, there is no reason other than the DX coil module may not</span>
<a name="ln-85"></a>  <span class="c">!               allow a heating only DX system.</span>
<a name="ln-86"></a>  <span class="c">!</span>
<a name="ln-87"></a>  <span class="c">! USE STATEMENTS:</span>
<a name="ln-88"></a>  <span class="c">! Use statements for data only modules</span>
<a name="ln-89"></a><span class="k">USE </span><span class="n">DataPrecisionGlobals</span>
<a name="ln-90"></a><span class="k">USE </span><span class="n">DataLoopNode</span>
<a name="ln-91"></a><span class="k">USE </span><span class="n">DataAirloop</span>
<a name="ln-92"></a><span class="k">USE </span><span class="n">DataGlobals</span>
<a name="ln-93"></a><span class="k">USE </span><span class="n">DataHVACGlobals</span>
<a name="ln-94"></a><span class="k">USE </span><span class="n">DataInterfaces</span>
<a name="ln-95"></a><span class="k">USE </span><span class="n">DataSizing</span>
<a name="ln-96"></a><span class="k">USE </span><span class="n">DataZoneEquipment</span>
<a name="ln-97"></a><span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">StdBaroPress</span><span class="p">,</span><span class="n">EnvironmentName</span><span class="p">,</span><span class="n">CurMnDy</span><span class="p">,</span><span class="n">OutDryBulbTemp</span><span class="p">,</span><span class="n">OutHumRat</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="n">OutWetBulbTemp</span><span class="p">,</span><span class="n">StdRhoAir</span>
<a name="ln-98"></a>
<a name="ln-99"></a>  <span class="c">! Use statements for access to subroutines in other modules</span>
<a name="ln-100"></a><span class="k">USE </span><span class="n">VariableSpeedCoils</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span><span class="n">MaxSpedLevels</span>
<a name="ln-101"></a><span class="k">USE </span><span class="n">ScheduleManager</span>
<a name="ln-102"></a>
<a name="ln-103"></a><span class="k">IMPLICIT NONE</span>         <span class="c">! Enforce explicit typing of all variables</span>
<a name="ln-104"></a>
<a name="ln-105"></a><span class="k">PRIVATE</span> <span class="c">! Everything private unless explicitly made public</span>
<a name="ln-106"></a>
<a name="ln-107"></a>  <span class="c">!MODULE PARAMETER DEFINITIONS</span>
<a name="ln-108"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">MinAirMassFlow</span> <span class="o">=</span> <span class="mf">0.001d0</span>
<a name="ln-109"></a>
<a name="ln-110"></a><span class="c">! Last mode of operation</span>
<a name="ln-111"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CoolingMode</span> <span class="o">=</span> <span class="mi">1</span> <span class="c">! last compressor operating mode was in cooling</span>
<a name="ln-112"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HeatingMode</span> <span class="o">=</span> <span class="mi">2</span> <span class="c">! last compressor operating mode was in heating</span>
<a name="ln-113"></a>
<a name="ln-114"></a><span class="c">! Compressor operation</span>
<a name="ln-115"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">On</span>  <span class="o">=</span> <span class="mi">1</span>              <span class="c">! normal compressor operation</span>
<a name="ln-116"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Off</span> <span class="o">=</span> <span class="mi">0</span>              <span class="c">! signal DXCoil that compressor shouldn&#39;t run</span>
<a name="ln-117"></a>
<a name="ln-118"></a><span class="c">! Dehumidification control modes (DehumidControlMode)</span>
<a name="ln-119"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DehumidControl_None</span>       <span class="o">=</span> <span class="mi">0</span>
<a name="ln-120"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DehumidControl_Multimode</span>  <span class="o">=</span> <span class="mi">1</span>
<a name="ln-121"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DehumidControl_CoolReheat</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-122"></a>
<a name="ln-123"></a><span class="c">! Coil type for SimWater and SimSteamCoil</span>
<a name="ln-124"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CoolingCoil</span>               <span class="o">=</span> <span class="mi">0</span>
<a name="ln-125"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HeatingCoil</span>               <span class="o">=</span> <span class="mi">1</span>
<a name="ln-126"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">SuppHeatCoil</span>              <span class="o">=</span> <span class="mi">2</span>
<a name="ln-127"></a>
<a name="ln-128"></a><span class="c">! Supply Air Sizing Option</span>
<a name="ln-129"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="k">None</span>                            <span class="o">=</span> <span class="mi">1</span>
<a name="ln-130"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">SupplyAirFlowRate</span>               <span class="o">=</span> <span class="mi">2</span>
<a name="ln-131"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">FlowPerFloorArea</span>                <span class="o">=</span> <span class="mi">3</span>
<a name="ln-132"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">FractionOfAutosizedCoolingValue</span> <span class="o">=</span> <span class="mi">4</span>
<a name="ln-133"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">FractionOfAutosizedHeatingValue</span> <span class="o">=</span> <span class="mi">5</span>
<a name="ln-134"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">FlowPerCoolingCapacity</span>          <span class="o">=</span> <span class="mi">6</span>
<a name="ln-135"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">FlowPerHeatingCapacity</span>          <span class="o">=</span> <span class="mi">7</span>
<a name="ln-136"></a>
<a name="ln-137"></a><span class="c">! Airflow control for contant fan mode</span>
<a name="ln-138"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">UseCompressorOnFlow</span>  <span class="o">=</span> <span class="mi">1</span> <span class="c">! set compressor OFF air flow rate equal to compressor ON air flow rate</span>
<a name="ln-139"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">UseCompressorOffFlow</span> <span class="o">=</span> <span class="mi">2</span> <span class="c">! set compressor OFF air flow rate equal to user defined value</span>
<a name="ln-140"></a>
<a name="ln-141"></a><span class="c">! System Control Type</span>
<a name="ln-142"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">LoadBased</span>     <span class="o">=</span> <span class="mi">1</span> <span class="c">! control system based on zone load</span>
<a name="ln-143"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">SetPointBased</span> <span class="o">=</span> <span class="mi">2</span> <span class="c">! control system based on coil set point manager</span>
<a name="ln-144"></a>
<a name="ln-145"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Blank</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
<a name="ln-146"></a>
<a name="ln-147"></a>  <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-148"></a><span class="k">TYPE </span><span class="n">DesignSpecMSHPData</span>
<a name="ln-149"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Name</span> <span class="o">=</span><span class="s1">&#39; &#39;</span>                    <span class="c">! Name of the design specification MSHP</span>
<a name="ln-150"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">NumOfSpeedCooling</span>         <span class="o">=</span> <span class="mi">0</span>                    <span class="c">! The number of speeds for cooling</span>
<a name="ln-151"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">NumOfSpeedHeating</span>         <span class="o">=</span> <span class="mi">0</span>                    <span class="c">! The number of speeds for heating</span>
<a name="ln-152"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">CoolingVolFlowRatio</span>  <span class="c">! The ratio of flow to max for this speed</span>
<a name="ln-153"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">HeatingVolFlowRatio</span>  <span class="c">! The ratio of flow to max for this speed</span>
<a name="ln-154"></a><span class="k">END TYPE </span><span class="n">DesignSpecMSHPData</span>
<a name="ln-155"></a>
<a name="ln-156"></a><span class="k">TYPE </span><span class="n">UnitarySystemData</span>
<a name="ln-157"></a><span class="c">! HVAC system specific data</span>
<a name="ln-158"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UnitarySystemType</span>  <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">! Type of Unitary System</span>
<a name="ln-159"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">UnitarySystemType_Num</span>                <span class="o">=</span> <span class="mi">0</span>       <span class="c">! integer type of Unitary System</span>
<a name="ln-160"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Name</span>               <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">! Name of the Unitary System</span>
<a name="ln-161"></a>  <span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">HeatPump</span>                             <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! TRUE if both cooling and heating coils are DX</span>
<a name="ln-162"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">SysAvailSchedPtr</span>                     <span class="o">=</span> <span class="mi">0</span>       <span class="c">! System Availability schedule</span>
<a name="ln-163"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">UnitarySystemInletNodeNum</span>            <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Parent inlet node number</span>
<a name="ln-164"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">UnitarySystemOutletNodeNum</span>           <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Parent outlet node number</span>
<a name="ln-165"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">CondenserType</span>                        <span class="o">=</span> <span class="mi">0</span>       <span class="c">! type of condenser (AirCooled, EvapCooled, WaterCooled)</span>
<a name="ln-166"></a>  <span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">AirLoopEquipment</span>                     <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>  <span class="c">! identifies that this system is part of an air loop</span>
<a name="ln-167"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">ControlZoneNum</span>                       <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Index to controlled zone</span>
<a name="ln-168"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">ZoneSequenceCoolingNum</span>               <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Index to cooling sequence/priority for this zone</span>
<a name="ln-169"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">ZoneSequenceHeatingNum</span>               <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Index to heating sequence/priority for this zone</span>
<a name="ln-170"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">NodeNumofControlledZone</span>              <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Node number of controlled zone</span>
<a name="ln-171"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">ZoneInletNode</span>                        <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Zone inlet node number in the controlled zone</span>
<a name="ln-172"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ControlZoneMassFlowFrac</span>              <span class="o">=</span> <span class="mf">0.0d0</span>   <span class="c">! Fraction of flow to control zone</span>
<a name="ln-173"></a>  <span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">Humidistat</span>                           <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! Set to True if dehumidification control mode is set to</span>
<a name="ln-174"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">DesignMaxOutletTemp</span>                  <span class="o">=</span> <span class="mi">8</span><span class="mf">0.0d0</span>  <span class="c">! Maximum supply air temperature from heater [C]</span>
<a name="ln-175"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">CondenserNodeNum</span>                     <span class="o">=</span> <span class="mi">0</span>       <span class="c">! index to condenser air inlet node</span>
<a name="ln-176"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">DehumidControlType_Num</span>               <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Set to Dehumid Control None, CoolReheat or MultiMode</span>
<a name="ln-177"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">AirFlowControl</span>                       <span class="o">=</span> <span class="mi">1</span>       <span class="c">! UseCompressorOnFlow or UseCompressorOffFlow</span>
<a name="ln-178"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">ControlType</span>                          <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Setpoint or Load based control</span>
<a name="ln-179"></a>  <span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">RequestAutosize</span>                      <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! determines if inputs need autosizing</span>
<a name="ln-180"></a>  <span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">RunOnSensibleLoad</span>                    <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>  <span class="c">! logical determines if this system will run to</span>
<a name="ln-181"></a>  <span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">RunOnLatentLoad</span>                      <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! logical determines if this system will run to</span>
<a name="ln-182"></a>  <span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">RunOnLatentOnlyWithSensible</span>          <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! allow latent dehumidification only if sensible load exists</span>
<a name="ln-183"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">DehumidificationMode</span>                 <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Dehumidification mode for multimode coil,</span>
<a name="ln-184"></a>                                                               <span class="c">! 0=normal, 1+=enhanced dehumidification mode</span>
<a name="ln-185"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">FanOpMode</span>                            <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Fan operating mode (see parameter above)</span>
<a name="ln-186"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">LastMode</span>                             <span class="o">=</span> <span class="mi">0</span>       <span class="c">! last mode of operation, coolingmode or heatingmode</span>
<a name="ln-187"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">AncillaryOnPower</span>                    <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Ancillary On-Cycle Electric Power [W]</span>
<a name="ln-188"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">AncillaryOffPower</span>                   <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Ancillary Off-Cycle Electric Power [W]</span>
<a name="ln-189"></a>
<a name="ln-190"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DesignSpecMultispeedHPType</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">! Object type for specifying multispeed flow rates</span>
<a name="ln-191"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DesignSpecMultispeedHPName</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">! Object name for specifying multispeed flow rates</span>
<a name="ln-192"></a>
<a name="ln-193"></a><span class="c">! Cooling coil specific data</span>
<a name="ln-194"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolingCoilName</span>   <span class="o">=</span> <span class="s1">&#39; &#39;</span>      <span class="c">! coil name (eliminate after blank is accepted in CALL)</span>
<a name="ln-195"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">CoolingCoilType_Num</span>                 <span class="o">=</span> <span class="mi">0</span>        <span class="c">! numeric coil type</span>
<a name="ln-196"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">CoolingCoilIndex</span>                    <span class="o">=</span> <span class="mi">0</span>        <span class="c">! index to specific cooling coil</span>
<a name="ln-197"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">DesignCoolingCapacity</span>               <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! cooling coil capacity (W)</span>
<a name="ln-198"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">CoolingCoilAvailSchPtr</span>              <span class="o">=</span> <span class="mi">0</span>        <span class="c">! cooling coil availability schedule index</span>
<a name="ln-199"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">ActualDXCoilIndexForHXAssisted</span>      <span class="o">=</span> <span class="mi">0</span>        <span class="c">! index to DX coil used in HX assisted object</span>
<a name="ln-200"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">DOASDXCoolingCoilMinTout</span>            <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! DOAS DX Cooling coil outlet air minimum temperature</span>
<a name="ln-201"></a>  <span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">ISHundredPercentDOASDXCoil</span>          <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>  <span class="c">! logical determines if this system will run as 100% DOAS</span>
<a name="ln-202"></a>  <span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">CoolCoilExists</span>                      <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>  <span class="c">! True if a cooling coil is specified in the unitary system</span>
<a name="ln-203"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">FrostControlStatus</span>                  <span class="o">=</span> <span class="mi">0</span>        <span class="c">! DOAS coil system frost control status</span>
<a name="ln-204"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">CoolCoilInletNodeNum</span>                <span class="o">=</span> <span class="mi">0</span>        <span class="c">! Cooling coil air inlet node number</span>
<a name="ln-205"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">CoolCoilOutletNodeNum</span>               <span class="o">=</span> <span class="mi">0</span>        <span class="c">! Cooling coil air outlet node number</span>
<a name="ln-206"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">CoolCoilFluidOutletNodeNum</span>          <span class="o">=</span> <span class="mi">0</span>        <span class="c">! Cooling coil fluid outlet node number (from Plant Loop data)</span>
<a name="ln-207"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">CoolCoilLoopNum</span>                     <span class="o">=</span> <span class="mi">0</span>        <span class="c">! Plant loop num of chilled water coil</span>
<a name="ln-208"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">CoolCoilLoopSide</span>                    <span class="o">=</span> <span class="mi">0</span>        <span class="c">! Supply side or demand side</span>
<a name="ln-209"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">CoolCoilBranchNum</span>                   <span class="o">=</span> <span class="mi">0</span>        <span class="c">! Branch of number of the cooling coil in the plant loop</span>
<a name="ln-210"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">CoolCoilCompNum</span>                     <span class="o">=</span> <span class="mi">0</span>        <span class="c">! Comp num of the cooling coil in the plant loop</span>
<a name="ln-211"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">CoolCoilFluidInletNode</span>              <span class="o">=</span> <span class="mi">0</span>        <span class="c">! Cooling coil fluid inlet node</span>
<a name="ln-212"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">MaxCoolCoilFluidFlow</span>                <span class="o">=</span> <span class="n">Autosize</span> <span class="c">! Maximum cooling coil fluid flow for chilled water coil</span>
<a name="ln-213"></a>  <span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">CoolingCoilUpStream</span>                 <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>   <span class="c">! Set to true when coolign coil is upstream in the unitary system</span>
<a name="ln-214"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CoolCompPartLoadRatio</span>               <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Unitary system compressor part load ratio in cooling</span>
<a name="ln-215"></a>
<a name="ln-216"></a><span class="c">! Heating coil specific data</span>
<a name="ln-217"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatingCoilName</span>   <span class="o">=</span><span class="s1">&#39; &#39;</span>       <span class="c">! coil name (eliminate after blank is accepted in CALL)</span>
<a name="ln-218"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">HeatingCoilType_Num</span>                 <span class="o">=</span> <span class="mi">0</span>        <span class="c">! numeric coil type</span>
<a name="ln-219"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">HeatingCoilIndex</span>                    <span class="o">=</span> <span class="mi">0</span>        <span class="c">! index to specific heating coil</span>
<a name="ln-220"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">DesignHeatingCapacity</span>               <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! heating coil capacity (W)</span>
<a name="ln-221"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">HeatingSizingRatio</span>                  <span class="o">=</span> <span class="mf">1.0d0</span>    <span class="c">! ratio of heating coil to cooling coil size</span>
<a name="ln-222"></a>  <span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">DXHeatingCoil</span>                       <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>  <span class="c">! specifies if heating coil is DX</span>
<a name="ln-223"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">HeatCoilInletNodeNum</span>                <span class="o">=</span> <span class="mi">0</span>        <span class="c">! Heating coil air inlet node number</span>
<a name="ln-224"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">HeatCoilOutletNodeNum</span>               <span class="o">=</span> <span class="mi">0</span>        <span class="c">! Heating coil air outlet node number</span>
<a name="ln-225"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">HeatCoilFluidOutletNodeNum</span>          <span class="o">=</span> <span class="mi">0</span>        <span class="c">! Heating coil fluid outlet node number (from Plant Loop data)</span>
<a name="ln-226"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">HeatingCoilPLFCurveIndex</span>            <span class="o">=</span> <span class="mi">0</span>        <span class="c">! PLF curve index (not used yet?)</span>
<a name="ln-227"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">HeatingCoilAvailSchPtr</span>              <span class="o">=</span> <span class="mi">0</span>        <span class="c">! heating coil availability schedule index</span>
<a name="ln-228"></a>  <span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">HeatCoilExists</span>                      <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>  <span class="c">! True if a heating coil is specified in the unitary system</span>
<a name="ln-229"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">HeatCoilLoopNum</span>                     <span class="o">=</span> <span class="mi">0</span>        <span class="c">! Plant loop num of hot water or steam coil</span>
<a name="ln-230"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">HeatCoilLoopSide</span>                    <span class="o">=</span> <span class="mi">0</span>        <span class="c">! Supply side or demand side</span>
<a name="ln-231"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">HeatCoilBranchNum</span>                   <span class="o">=</span> <span class="mi">0</span>        <span class="c">! Branch of number of the heating coil in the plant loop</span>
<a name="ln-232"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">HeatCoilCompNum</span>                     <span class="o">=</span> <span class="mi">0</span>        <span class="c">! Comp num of the heating coil in the plant loop</span>
<a name="ln-233"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">HeatCoilFluidInletNode</span>              <span class="o">=</span> <span class="mi">0</span>        <span class="c">! Heating coil fluid inlet node</span>
<a name="ln-234"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">MaxHeatCoilFluidFlow</span>                <span class="o">=</span> <span class="n">Autosize</span> <span class="c">! Maximum heating coil fluid flow for hot water or steam coil</span>
<a name="ln-235"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">HeatCompPartLoadRatio</span>               <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Unitary system compressor part load ratio in heating</span>
<a name="ln-236"></a>
<a name="ln-237"></a><span class="c">! Supplemental heating coil specific data</span>
<a name="ln-238"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SuppHeatCoilName</span>  <span class="o">=</span> <span class="s1">&#39; &#39;</span>      <span class="c">! coil name (eliminate after blank is accepted in CALL)</span>
<a name="ln-239"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">SuppHeatCoilType_Num</span>                <span class="o">=</span> <span class="mi">0</span>        <span class="c">! numeric coil type</span>
<a name="ln-240"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">SuppHeatCoilIndex</span>                   <span class="o">=</span> <span class="mi">0</span>        <span class="c">! index to specific supplemental heating coil</span>
<a name="ln-241"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">DesignSuppHeatingCapacity</span>           <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! supplemental heating coil capacity (W)</span>
<a name="ln-242"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">SuppCoilFluidInletNode</span>              <span class="o">=</span> <span class="mi">0</span>        <span class="c">! supplemental heating coil water/steam inlet node</span>
<a name="ln-243"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">SuppCoilFluidOutletNodeNum</span>          <span class="o">=</span> <span class="mi">0</span>        <span class="c">! Supplemental coil fluid outlet node number (from Plant Loop data)</span>
<a name="ln-244"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">SuppCoilAirInletNode</span>                <span class="o">=</span> <span class="mi">0</span>        <span class="c">! supplemental heating coil air inlet node</span>
<a name="ln-245"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">SuppCoilAirOutletNode</span>               <span class="o">=</span> <span class="mi">0</span>        <span class="c">! supplemental heating coil air outlet node</span>
<a name="ln-246"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">SuppCoilAvailSchPtr</span>                 <span class="o">=</span> <span class="mi">0</span>        <span class="c">! supplemental heating coil availability schedule index</span>
<a name="ln-247"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">MaxSuppCoilFluidFlow</span>                <span class="o">=</span> <span class="n">Autosize</span> <span class="c">! supplemental heating coil maximum water/steam flow rate (m3/s)</span>
<a name="ln-248"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">MaxOATSuppHeat</span>                      <span class="o">=</span> <span class="mi">2</span><span class="mf">1.0d0</span>   <span class="c">! Maximum outdoor dry-bulb temperature for supplemental coil [C]</span>
<a name="ln-249"></a>  <span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">SuppCoilExists</span>                      <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>  <span class="c">! True if a supp coil is specified in the unitary system</span>
<a name="ln-250"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">SuppCoilLoopNum</span>                     <span class="o">=</span> <span class="mi">0</span>        <span class="c">! Plant loop num of supplemental coil</span>
<a name="ln-251"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">SuppCoilLoopSide</span>                    <span class="o">=</span> <span class="mi">0</span>        <span class="c">! Supply side or demand side</span>
<a name="ln-252"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">SuppCoilBranchNum</span>                   <span class="o">=</span> <span class="mi">0</span>        <span class="c">! Branch of number of the supplemental coil in the plant loop</span>
<a name="ln-253"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">SuppCoilCompNum</span>                     <span class="o">=</span> <span class="mi">0</span>        <span class="c">! Comp num of the supplemental coil in the plant loop</span>
<a name="ln-254"></a>
<a name="ln-255"></a><span class="c">! fan specific data</span>
<a name="ln-256"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">FanType_Num</span>                         <span class="o">=</span> <span class="mi">0</span>        <span class="c">! Fan type num i.e. OnOff, ConstVol, VAV</span>
<a name="ln-257"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">FanIndex</span>                            <span class="o">=</span> <span class="mi">0</span>        <span class="c">! index of fan of a particular type</span>
<a name="ln-258"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ActualFanVolFlowRate</span>                <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Actual or design fan volume flow rate</span>
<a name="ln-259"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">FanOpModeSchedPtr</span>                   <span class="o">=</span> <span class="mi">0</span>        <span class="c">! fan operating mode schedule pointer</span>
<a name="ln-260"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">FanAvailSchedPtr</span>                    <span class="o">=</span> <span class="mi">0</span>        <span class="c">! fan availability schedule pointer</span>
<a name="ln-261"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">FanPlace</span>                            <span class="o">=</span> <span class="mi">0</span>        <span class="c">! Blow through or DrawThrough Fan</span>
<a name="ln-262"></a>  <span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">FanExists</span>                           <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>  <span class="c">! True if a fan is specified in the unitary system</span>
<a name="ln-263"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">FanDelayTime</span>                        <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Fan delay time, time delay for the HP&#39;s fan to</span>
<a name="ln-264"></a>                                                               <span class="c">! shut off after compressor cycle off [s]</span>
<a name="ln-265"></a><span class="c">! air flow variables</span>
<a name="ln-266"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">MaxCoolAirVolFlow</span>                   <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Maximum coil air volumetric flow for cooling [m3/s]</span>
<a name="ln-267"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">MaxHeatAirVolFlow</span>                   <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Maximum coil air volumetric flow for heating [m3/s]</span>
<a name="ln-268"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">MaxNoCoolHeatAirVolFlow</span>             <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Maximum coil air volumetric flow for no cooling or heating [m3/s]</span>
<a name="ln-269"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">DesignFanVolFlowRate</span>                <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Design fan volume flow rate [m3/s]</span>
<a name="ln-270"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">DesignMassFlowRate</span>                  <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Design mass flow rate [m3/s]</span>
<a name="ln-271"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">MaxCoolAirMassFlow</span>                  <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Maximum coil air mass flow for cooling [kg/s]</span>
<a name="ln-272"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">MaxHeatAirMassFlow</span>                  <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Maximum coil air mass flow for heating [kg/s]</span>
<a name="ln-273"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">MaxNoCoolHeatAirMassFlow</span>            <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Maximum coil air mass flow for no cooling or heating [kg/s]</span>
<a name="ln-274"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">CoolingSAFMethod</span>                    <span class="o">=</span> <span class="mi">0</span>        <span class="c">! Supply air flow method for cooling</span>
<a name="ln-275"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">HeatingSAFMethod</span>                    <span class="o">=</span> <span class="mi">0</span>        <span class="c">! Supply air flow method for heating</span>
<a name="ln-276"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">NoCoolHeatSAFMethod</span>                 <span class="o">=</span> <span class="mi">0</span>        <span class="c">! Supply air flow method for no cooling or heating</span>
<a name="ln-277"></a>
<a name="ln-278"></a><span class="c">! Heat pump related specific data</span>
<a name="ln-279"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">MinOATCompressor</span>                    <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Minimum outdoor temperature below which compressor if off</span>
<a name="ln-280"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">MaxONOFFCyclesperHour</span>               <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Maximum cycling rate of unitary system [cycles/hr]</span>
<a name="ln-281"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">HPTimeConstant</span>                      <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Heat pump time constant [s]</span>
<a name="ln-282"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">OnCyclePowerFraction</span>                <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Fraction of on-cycle power use [~]</span>
<a name="ln-283"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">DesignHRWaterVolumeFlow</span>             <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Design water volume flow rate through heat recovery loop [m3/s]</span>
<a name="ln-284"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">WSHPRuntimeFrac</span>                     <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Runtime fraction of water source heat pump</span>
<a name="ln-285"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">HeatingCoilSensDemand</span>               <span class="o">=</span> <span class="mf">0.0d0</span>         <span class="c">! Sensible demand on Heating Coil [W]</span>
<a name="ln-286"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CoolingCoilSensDemand</span>               <span class="o">=</span> <span class="mf">0.0d0</span>         <span class="c">! Sensible demand on Cooling Coil [W]</span>
<a name="ln-287"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CoolingCoilLatentDemand</span>             <span class="o">=</span> <span class="mf">0.0d0</span>         <span class="c">! Latent demand on Cooling Coil [W]</span>
<a name="ln-288"></a>
<a name="ln-289"></a><span class="c">! Heat recovery related specific data</span>
<a name="ln-290"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">HeatRecoveryInletNodeNum</span>            <span class="o">=</span> <span class="mi">0</span>        <span class="c">! Node number on heat recovery water inlet</span>
<a name="ln-291"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">HeatRecoveryOutletNodeNum</span>           <span class="o">=</span> <span class="mi">0</span>        <span class="c">! Node number on heat recovery water outlet</span>
<a name="ln-292"></a>  <span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">HeatRecActive</span>                       <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>  <span class="c">! True when entered Heat Rec Vol Flow Rate &gt; 0</span>
<a name="ln-293"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">DesignHeatRecMassFlowRate</span>           <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Design water mass flow rate through heat recovery loop [kg/s]</span>
<a name="ln-294"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">MaxHROutletWaterTemp</span>                <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Maximum outlet water temperature for heat recovery [C]</span>
<a name="ln-295"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">HRLoopNum</span>                           <span class="o">=</span> <span class="mi">0</span>        <span class="c">! plant loop number for heat recovery</span>
<a name="ln-296"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">HRLoopSideNum</span>                       <span class="o">=</span> <span class="mi">0</span>        <span class="c">! Plant loop side (supply or demand) for heat recovery</span>
<a name="ln-297"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">HRBranchNum</span>                         <span class="o">=</span> <span class="mi">0</span>        <span class="c">! plant loop branch for heat recovery</span>
<a name="ln-298"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">HRCompNum</span>                           <span class="o">=</span> <span class="mi">0</span>        <span class="c">! plant loop component for heat recovery</span>
<a name="ln-299"></a>
<a name="ln-300"></a><span class="c">! set point based control varibles</span>
<a name="ln-301"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">SystemHeatControlNodeNum</span>            <span class="o">=</span> <span class="mi">0</span>        <span class="c">! the node number of the node with the setpoint</span>
<a name="ln-302"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">SystemCoolControlNodeNum</span>            <span class="o">=</span> <span class="mi">0</span>        <span class="c">! the node number of the node with the setpoint</span>
<a name="ln-303"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">SuppHeatControlNodeNum</span>              <span class="o">=</span> <span class="mi">0</span>        <span class="c">! the node number of the node with the setpoint</span>
<a name="ln-304"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">DesiredOutletTemp</span>                   <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! the setpoint temperature at the unit outlet node</span>
<a name="ln-305"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">DesiredOutletHumRat</span>                 <span class="o">=</span> <span class="mf">1.0d0</span>    <span class="c">! the setpoint humidity ratio at the unit outlet node</span>
<a name="ln-306"></a>
<a name="ln-307"></a><span class="c">! operational system variables</span>
<a name="ln-308"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CoolingPartLoadFrac</span>                 <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! part load cooling fraction for current timestep</span>
<a name="ln-309"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">HeatingPartLoadFrac</span>                 <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! part load heating fraction for current timestep</span>
<a name="ln-310"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">SuppHeatPartLoadFrac</span>                <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! part load supp heating fraction for current timestep</span>
<a name="ln-311"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">SupHeaterLoad</span>                       <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Supplemental Heat Load for current timestep</span>
<a name="ln-312"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">SenLoadLoss</span>                         <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Air distribution system sensible loss [W]</span>
<a name="ln-313"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">LatLoadLoss</span>                         <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Air distribution system latent loss [W]</span>
<a name="ln-314"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">SensibleLoadMet</span>                     <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! System sensible load [W]</span>
<a name="ln-315"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">LatentLoadMet</span>                       <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! System latent load [W]</span>
<a name="ln-316"></a>  <span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">InitHeatPump</span>                        <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>   <span class="c">! Heat pump initialization flag (for error reporting)</span>
<a name="ln-317"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">WaterCyclingMode</span>                    <span class="o">=</span> <span class="mi">0</span>        <span class="c">! Heat Pump Coil water flow mode; See def in DataHVACGlobals,</span>
<a name="ln-318"></a>                                                               <span class="c">! 1=water cycling, 2=water constant, 3=water constant on demand</span>
<a name="ln-319"></a>
<a name="ln-320"></a><span class="c">! start of additional varibles for variable speed water source heat pump</span>
<a name="ln-321"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">HeatCoolMode</span>                         <span class="o">=</span> <span class="mi">0</span>        <span class="c">! System operating mode (0 = floating, 1 = cooling, 2 = heating)</span>
<a name="ln-322"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NumOfSpeedCooling</span>                    <span class="o">=</span> <span class="mi">0</span>        <span class="c">! The number of speeds for cooling</span>
<a name="ln-323"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NumOfSpeedHeating</span>                    <span class="o">=</span> <span class="mi">0</span>        <span class="c">! The number of speeds for heating</span>
<a name="ln-324"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IdleSpeedRatio</span>                       <span class="o">=</span> <span class="mi">0</span>        <span class="c">! idle air fan ratio</span>
<a name="ln-325"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IdleVolumeAirRate</span>                    <span class="o">=</span> <span class="mi">0</span>        <span class="c">! idle air flow rate [m3/s]</span>
<a name="ln-326"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IdleMassFlowRate</span>                     <span class="o">=</span> <span class="mi">0</span>        <span class="c">! idle air flow rate [kg/s]</span>
<a name="ln-327"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">CheckFanFlow</span>                         <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>   <span class="c">! Supply airflow check</span>
<a name="ln-328"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">HeatVolumeFlowRate</span>   <span class="c">! Supply air volume flow rate during heating operation</span>
<a name="ln-329"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">HeatMassFlowRate</span>     <span class="c">! Supply air mass flow rate during heating operation</span>
<a name="ln-330"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">CoolVolumeFlowRate</span>   <span class="c">! Supply air volume flow rate during cooling operation</span>
<a name="ln-331"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">CoolMassFlowRate</span>     <span class="c">! Supply air mass flow rate during cooling operation</span>
<a name="ln-332"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">MSHeatingSpeedRatio</span>  <span class="c">! Fan speed ratio in heating mode</span>
<a name="ln-333"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">MSCoolingSpeedRatio</span>  <span class="c">! Fan speed ratio in cooling mode</span>
<a name="ln-334"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NoHeatCoolSpeedRatio</span>                 <span class="o">=</span> <span class="mf">1.0d0</span>    <span class="c">! Fan speed ratio when no cooling or heating</span>
<a name="ln-335"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">DesignSpecMSHPIndex</span>                  <span class="o">=</span> <span class="mi">0</span>        <span class="c">! Index to design specification multispeed heat pump object</span>
<a name="ln-336"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">MultiSpeedCoolingCoil</span>                <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>  <span class="c">! TRUE when cooling coil multispeed</span>
<a name="ln-337"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">MultiSpeedHeatingCoil</span>                <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>  <span class="c">! TRUE when heating coil multispeed</span>
<a name="ln-338"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">VarSpeedCoolingCoil</span>                  <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>  <span class="c">! TRUE when cooling coil variable speed</span>
<a name="ln-339"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">VarSpeedHeatingCoil</span>                  <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>  <span class="c">! TRUE when heating coil variable speed</span>
<a name="ln-340"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingSpeedNum</span>                      <span class="o">=</span> <span class="mi">0</span>        <span class="c">! speed number for multispeed cooling coils types</span>
<a name="ln-341"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">HeatingSpeedNum</span>                      <span class="o">=</span> <span class="mi">0</span>        <span class="c">! speed number for multispeed heating coils types</span>
<a name="ln-342"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolingSpeedRatio</span>                    <span class="o">=</span> <span class="mf">1.0d0</span>    <span class="c">! current compressor speed ratio (variable speed)</span>
<a name="ln-343"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolingFanSpeedRatio</span>                 <span class="o">=</span> <span class="mf">1.0d0</span>    <span class="c">! current fan speed ratio</span>
<a name="ln-344"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatingSpeedRatio</span>                    <span class="o">=</span> <span class="mf">1.0d0</span>    <span class="c">! current compressor speed ratio (variable speed)</span>
<a name="ln-345"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatingFanSpeedRatio</span>                 <span class="o">=</span> <span class="mf">1.0d0</span>    <span class="c">! current fan speed ratio</span>
<a name="ln-346"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolingCycRatio</span>                      <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! cycling part load ratio (variable speed)</span>
<a name="ln-347"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatingCycRatio</span>                      <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! cycling part load ratio (variable speed)</span>
<a name="ln-348"></a> <span class="c">! end of additional variables for variable speed water source heat pump</span>
<a name="ln-349"></a>
<a name="ln-350"></a><span class="c">! Report Varibles</span>
<a name="ln-351"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">PartLoadFrac</span>                     <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! part load fraction for current time step (single speed)</span>
<a name="ln-352"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FanPartLoadRatio</span>                 <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Unitary system fan part load ratio</span>
<a name="ln-353"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CompPartLoadRatio</span>                <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Unitary system compressor part load ratio</span>
<a name="ln-354"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ElecPower</span>                        <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Unitary System Electric Power</span>
<a name="ln-355"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ElecPowerConsumption</span>             <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Electricity power comsumption: CondenserFan+CCHeater+Defrost+aux</span>
<a name="ln-356"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TotCoolEnergyRate</span>                <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Unitary System Total Cooling Rate [W]</span>
<a name="ln-357"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SensCoolEnergyRate</span>               <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Unitary System Sensible Cooling Rate [W]</span>
<a name="ln-358"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">LatCoolEnergyRate</span>                <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Unitary System Latent Cooling Rate [W]</span>
<a name="ln-359"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TotHeatEnergyRate</span>                <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Unitary System Total Heating Rate [W]</span>
<a name="ln-360"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SensHeatEnergyRate</span>               <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Unitary System Sensible Heating Rate [W]</span>
<a name="ln-361"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">LatHeatEnergyRate</span>                <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Unitary System Latent Heating Rate [W]</span>
<a name="ln-362"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TotalAuxElecPower</span>                <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Unitary System Ancillary Electric Power [W]</span>
<a name="ln-363"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeatingAuxElecConsumption</span>        <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Unitary System Heating Ancillary Electric Energy [J]</span>
<a name="ln-364"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CoolingAuxElecConsumption</span>        <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Unitary System Cooling Ancillary Electric Energy [J]</span>
<a name="ln-365"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeatRecoveryRate</span>                 <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Unitary System Heat Recovery Rate [W]</span>
<a name="ln-366"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeatRecoveryEnergy</span>               <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Unitary System Heat Recovery Energy [J]</span>
<a name="ln-367"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeatRecoveryInletTemp</span>            <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Unitary System Heat Recovery Inlet Temperature [C]</span>
<a name="ln-368"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeatRecoveryOutletTemp</span>           <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Unitary System Heat Recovery Outlet Temperature [C]</span>
<a name="ln-369"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeatRecoveryMassFlowRate</span>         <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Unitary System Heat Recovery Fluid Mass Flow Rate [kg/s]</span>
<a name="ln-370"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DehumidInducedHeatingDemandRate</span>  <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Unitary System</span>
<a name="ln-371"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">EMSSensibleZoneLoadValue</span>         <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Value EMS is directing to use</span>
<a name="ln-372"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">EMSMoistureZoneLoadValue</span>         <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Value EMS is directing to use</span>
<a name="ln-373"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">SpeedNum</span>                         <span class="o">=</span> <span class="mi">0</span>         <span class="c">! speed number of active multi- or variable-speed coil</span>
<a name="ln-374"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SpeedRatio</span>                       <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! current compressor speed ratio (variable speed)</span>
<a name="ln-375"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CycRatio</span>                         <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! cycling part load ratio (variable speed)</span>
<a name="ln-376"></a>
<a name="ln-377"></a><span class="c">! Warning message variables</span>
<a name="ln-378"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">HXAssistedSensPLRIter</span>                <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in HX Assisted calculations</span>
<a name="ln-379"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">HXAssistedSensPLRIterIndex</span>           <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in HX Assisted calculations</span>
<a name="ln-380"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">HXAssistedSensPLRFail</span>                <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in HX Assisted calculations</span>
<a name="ln-381"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">HXAssistedSensPLRFailIndex</span>           <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in HX Assisted calculations</span>
<a name="ln-382"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">HXAssistedSensPLRFail2</span>               <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in HX Assisted calculations</span>
<a name="ln-383"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">HXAssistedSensPLRFailIndex2</span>          <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in HX Assisted calculations</span>
<a name="ln-384"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">HXAssistedLatPLRIter</span>                 <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in HX Assisted calculations</span>
<a name="ln-385"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">HXAssistedLatPLRIterIndex</span>            <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in HX Assisted calculations</span>
<a name="ln-386"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">HXAssistedLatPLRFail</span>                 <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in HX Assisted calculations</span>
<a name="ln-387"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">HXAssistedLatPLRFailIndex</span>            <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in HX Assisted calculations</span>
<a name="ln-388"></a>
<a name="ln-389"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">HXAssistedCRLatPLRIter</span>               <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in HX Assisted calculations</span>
<a name="ln-390"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">HXAssistedCRLatPLRIterIndex</span>          <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in HX Assisted calculations</span>
<a name="ln-391"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">HXAssistedCRLatPLRFail</span>               <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in HX Assisted calculations</span>
<a name="ln-392"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">HXAssistedCRLatPLRFailIndex</span>          <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in HX Assisted calculations</span>
<a name="ln-393"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">HXAssistedCRLatPLRFail2</span>              <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in HX Assisted calculations</span>
<a name="ln-394"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">HXAssistedCRLatPLRFailIndex2</span>         <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in HX Assisted calculations</span>
<a name="ln-395"></a>
<a name="ln-396"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">SensPLRIter</span>                          <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in cool coil calculations</span>
<a name="ln-397"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">SensPLRIterIndex</span>                     <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in cool coil calculations</span>
<a name="ln-398"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">SensPLRFail</span>                          <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in cool coil calculations</span>
<a name="ln-399"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">SensPLRFailIndex</span>                     <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in cool coil calculations</span>
<a name="ln-400"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">LatPLRIter</span>                           <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in cool coil calculations</span>
<a name="ln-401"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">LatPLRIterIndex</span>                      <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in cool coil calculations</span>
<a name="ln-402"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">LatPLRFail</span>                           <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in cool coil calculations</span>
<a name="ln-403"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">LatPLRFailIndex</span>                      <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in cool coil calculations</span>
<a name="ln-404"></a>
<a name="ln-405"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">HeatCoilSensPLRIter</span>                  <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in heat coil calculations</span>
<a name="ln-406"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">HeatCoilSensPLRIterIndex</span>             <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in heat coil calculations</span>
<a name="ln-407"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">HeatCoilSensPLRFail</span>                  <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in heat coil calculations</span>
<a name="ln-408"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">HeatCoilSensPLRFailIndex</span>             <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in heat coil calculations</span>
<a name="ln-409"></a>
<a name="ln-410"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">SuppHeatCoilSensPLRIter</span>              <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in supp heat coil calculations</span>
<a name="ln-411"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">SuppHeatCoilSensPLRIterIndex</span>         <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in supp heat coil calculations</span>
<a name="ln-412"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">SuppHeatCoilSensPLRFail</span>              <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in supp heat coil calculations</span>
<a name="ln-413"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">SuppHeatCoilSensPLRFailIndex</span>         <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in supp heat coil calculations</span>
<a name="ln-414"></a>
<a name="ln-415"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">DXCoilSensPLRIter</span>                    <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in DXCoil calculations</span>
<a name="ln-416"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">DXCoilSensPLRIterIndex</span>               <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in DXCoil calculations</span>
<a name="ln-417"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">DXCoilSensPLRFail</span>                    <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in DXCoil calculations</span>
<a name="ln-418"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">DXCoilSensPLRFailIndex</span>               <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in DXCoil calculations</span>
<a name="ln-419"></a>
<a name="ln-420"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">MSpdSensPLRIter</span>                      <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in MultiSpeed calculations</span>
<a name="ln-421"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">MSpdSensPLRIterIndex</span>                 <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in MultiSpeed calculations</span>
<a name="ln-422"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">MSpdCycSensPLRIter</span>                   <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in MultiSpeed calculations</span>
<a name="ln-423"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">MSpdCycSensPLRIterIndex</span>              <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in MultiSpeed calculations</span>
<a name="ln-424"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">MSpdLatPLRIter</span>                       <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in MultiSpeed calculations</span>
<a name="ln-425"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">MSpdLatPLRIterIndex</span>                  <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in MultiSpeed calculations</span>
<a name="ln-426"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">MSpdCycLatPLRIter</span>                    <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in MultiSpeed calculations</span>
<a name="ln-427"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">MSpdCycLatPLRIterIndex</span>               <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in MultiSpeed calculations</span>
<a name="ln-428"></a>
<a name="ln-429"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">MaxIterIndex</span>                         <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in PLR calculations for sensible load</span>
<a name="ln-430"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">RegulaFalsIFailedIndex</span>               <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in PLR calculations for sensible load</span>
<a name="ln-431"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">LatMaxIterIndex</span>                      <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in PLR calculations for moisture load</span>
<a name="ln-432"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">LatRegulaFalsIFailedIndex</span>            <span class="o">=</span> <span class="mi">0</span>     <span class="c">! used in PLR calculations for moisture load</span>
<a name="ln-433"></a>
<a name="ln-434"></a><span class="c">! EMS variables</span>
<a name="ln-435"></a>  <span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">DesignFanVolFlowRateEMSOverrideOn</span>       <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! If true, then EMS is calling to override autosize fan flow</span>
<a name="ln-436"></a>  <span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">MaxHeatAirVolFlowEMSOverrideOn</span>          <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! If true, then EMS is calling to override autosize fan flow</span>
<a name="ln-437"></a>  <span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">MaxCoolAirVolFlowEMSOverrideOn</span>          <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! If true, then EMS is calling to override autosize fan flow</span>
<a name="ln-438"></a>  <span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">MaxNoCoolHeatAirVolFlowEMSOverrideOn</span>    <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! If true, then EMS is calling to override autosize fan flow</span>
<a name="ln-439"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DesignFanVolFlowRateEMSOverrideValue</span>    <span class="o">=</span> <span class="mf">0.0d0</span>   <span class="c">! EMS value for override of fan flow rate autosize [m3/s]</span>
<a name="ln-440"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MaxHeatAirVolFlowEMSOverrideValue</span>       <span class="o">=</span> <span class="mf">0.0d0</span>   <span class="c">! EMS value for override of fan flow rate autosize [m3/s]</span>
<a name="ln-441"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MaxCoolAirVolFlowEMSOverrideValue</span>       <span class="o">=</span> <span class="mf">0.0d0</span>   <span class="c">! EMS value for override of fan flow rate autosize [m3/s]</span>
<a name="ln-442"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MaxNoCoolHeatAirVolFlowEMSOverrideValue</span> <span class="o">=</span> <span class="mf">0.0d0</span>   <span class="c">! EMS value for override of fan flow rate autosize [m3/s]</span>
<a name="ln-443"></a>  <span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">EMSOverrideSensZoneLoadRequest</span>          <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! If true, then EMS is calling to override zone load</span>
<a name="ln-444"></a>  <span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">EMSOverrideMoistZoneLoadRequest</span>         <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! If true, then EMS is calling to override zone load</span>
<a name="ln-445"></a>
<a name="ln-446"></a><span class="c">! Staged thermostat control</span>
<a name="ln-447"></a>  <span class="kt">Integer</span>      <span class="kd">::</span> <span class="n">StageNum</span>                             <span class="o">=</span> <span class="mi">0</span>     <span class="c">! Stage number specified by staged thermostat</span>
<a name="ln-448"></a>  <span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">Staged</span>                               <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>  <span class="c">! Using Staged thermostat</span>
<a name="ln-449"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">CoolCountAvail</span>                       <span class="o">=</span> <span class="mi">0</span>     <span class="c">! Counter used to minimize the occurrence of output warnings</span>
<a name="ln-450"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">CoolIndexAvail</span>                       <span class="o">=</span> <span class="mi">0</span>     <span class="c">! Index used to minimize the occurrence of output warnings</span>
<a name="ln-451"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">HeatCountAvail</span>                       <span class="o">=</span> <span class="mi">0</span>     <span class="c">! Counter used to minimize the occurrence of output warnings</span>
<a name="ln-452"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">HeatIndexAvail</span>                       <span class="o">=</span> <span class="mi">0</span>     <span class="c">! Index used to minimize the occurrence of output warnings</span>
<a name="ln-453"></a>
<a name="ln-454"></a><span class="k">END TYPE </span><span class="n">UnitarySystemData</span>
<a name="ln-455"></a>
<a name="ln-456"></a><span class="c">!MODULE VARIABLE DECLARATIONS:</span>
<a name="ln-457"></a><span class="kt">LOGICAL</span><span class="p">,</span><span class="k">SAVE</span> <span class="kd">::</span> <span class="n">GetInputFlag</span>              <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>     <span class="c">! Flag to get input only once</span>
<a name="ln-458"></a><span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">EconomizerFlag</span>            <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>    <span class="c">! holds air loop economizer status</span>
<a name="ln-459"></a><span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">HeatingLoad</span>               <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>    <span class="c">! True when zone needs heating</span>
<a name="ln-460"></a><span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">CoolingLoad</span>               <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>    <span class="c">! True when zone needs cooling</span>
<a name="ln-461"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MoistureLoad</span>              <span class="o">=</span> <span class="mf">0.0d0</span>      <span class="c">! Dehumidification Load (W)</span>
<a name="ln-462"></a><span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">SuppHeatingCoilFlag</span>       <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>    <span class="c">! set to TRUE when simulating supplemental heating coil</span>
<a name="ln-463"></a><span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">NumUnitarySystem</span>          <span class="o">=</span> <span class="mi">0</span>          <span class="c">! The Number of Unitary Systems found in the Input</span>
<a name="ln-464"></a><span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">NumDesignSpecMultiSpeedHP</span> <span class="o">=</span> <span class="mi">0</span>          <span class="c">! The number of design specification objects for MSHP</span>
<a name="ln-465"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CompOnMassFlow</span>            <span class="o">=</span> <span class="mf">0.0d0</span>      <span class="c">! Supply air mass flow rate w/ compressor ON [kg/s]</span>
<a name="ln-466"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CompOffMassFlow</span>           <span class="o">=</span> <span class="mf">0.0d0</span>      <span class="c">! Supply air mass flow rate w/ compressor OFF [kg/s]</span>
<a name="ln-467"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CompOnFlowRatio</span>           <span class="o">=</span> <span class="mf">0.0d0</span>      <span class="c">! fan flow ratio when coil on</span>
<a name="ln-468"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CompOffFlowRatio</span>          <span class="o">=</span> <span class="mf">0.0d0</span>      <span class="c">! fan flow ratio when coil off</span>
<a name="ln-469"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FanSpeedRatio</span>             <span class="o">=</span> <span class="mf">0.0d0</span>      <span class="c">! ratio of air flow ratio passed to fan object</span>
<a name="ln-470"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CoolHeatPLRRat</span>            <span class="o">=</span> <span class="mf">1.0d0</span>      <span class="c">! ratio of cooling to heating PLR, used for cycling fan RH control</span>
<a name="ln-471"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">OnOffAirFlowRatioSave</span>     <span class="o">=</span> <span class="mf">0.0d0</span>      <span class="c">! Saves the OnOffAirFlowRatio calculated in RegulaFalsi calls.</span>
<a name="ln-472"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QToCoolSetPt</span>              <span class="o">=</span> <span class="mf">0.0d0</span>      <span class="c">! load to cooling set point {W}</span>
<a name="ln-473"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QToHeatSetPt</span>              <span class="o">=</span> <span class="mf">0.0d0</span>      <span class="c">! load to heating set point {W}</span>
<a name="ln-474"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TempSteamIn</span>               <span class="o">=</span> <span class="mi">10</span><span class="mf">0.0d0</span>    <span class="c">!  steam coil steam inlet temperature</span>
<a name="ln-475"></a>
<a name="ln-476"></a><span class="c">! Allocatable types</span>
<a name="ln-477"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">DesignSpecMSHPData</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">DesignSpecMSHP</span>
<a name="ln-478"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">UnitarySystemData</span><span class="p">),</span>  <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">UnitarySystem</span>
<a name="ln-479"></a><span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>                   <span class="kd">::</span> <span class="n">CheckEquipName</span>
<a name="ln-480"></a><span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>   <span class="kd">::</span> <span class="n">MultiOrVarSpeedHeatCoil</span>
<a name="ln-481"></a><span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>   <span class="kd">::</span> <span class="n">MultiOrVarSpeedCoolCoil</span>
<a name="ln-482"></a>
<a name="ln-483"></a><span class="c">! Subroutine Specifications for the Module</span>
<a name="ln-484"></a>          <span class="c">! Driver/Manager Routines</span>
<a name="ln-485"></a><span class="k">PUBLIC  </span><span class="n">SimUnitarySystem</span>
<a name="ln-486"></a>
<a name="ln-487"></a>          <span class="c">! Initialization routines</span>
<a name="ln-488"></a><span class="k">PRIVATE </span><span class="n">InitUnitarySystems</span>
<a name="ln-489"></a><span class="k">PRIVATE </span><span class="n">UpdateUnitarySystemControl</span>
<a name="ln-490"></a><span class="k">PRIVATE </span><span class="n">InitLoadBasedControl</span>
<a name="ln-491"></a><span class="k">PRIVATE </span><span class="n">SizeUnitarySystem</span>
<a name="ln-492"></a>
<a name="ln-493"></a>          <span class="c">! Get Input routines</span>
<a name="ln-494"></a><span class="k">PRIVATE </span><span class="n">GetUnitarySystemInput</span>
<a name="ln-495"></a>
<a name="ln-496"></a>          <span class="c">! Control routines to find PLR, check convergence and update nodes</span>
<a name="ln-497"></a><span class="k">PRIVATE </span><span class="n">ControlUnitarySystemtoSP</span>   <span class="c">! simulates set point based control</span>
<a name="ln-498"></a><span class="k">PRIVATE </span><span class="n">ControlUnitarySystemtoLoad</span> <span class="c">! simulates load based control</span>
<a name="ln-499"></a><span class="k">PRIVATE </span><span class="n">ControlUnitarySystemOutput</span> <span class="c">! simulate system to find operating output</span>
<a name="ln-500"></a><span class="k">PRIVATE </span><span class="n">ControlCoolingSystem</span>       <span class="c">! control cooling system to set point</span>
<a name="ln-501"></a><span class="k">PRIVATE </span><span class="n">ControlHeatingSystem</span>       <span class="c">! control heating system to set point</span>
<a name="ln-502"></a><span class="k">PRIVATE </span><span class="n">ControlSuppHeatSystem</span>      <span class="c">! control supplemental heating system to set point</span>
<a name="ln-503"></a>
<a name="ln-504"></a>          <span class="c">! Calc routines to simulate each child component in order</span>
<a name="ln-505"></a>
<a name="ln-506"></a>          <span class="c">! set point based calc routine</span>
<a name="ln-507"></a><span class="k">PRIVATE </span><span class="n">CalcUnitarySuppSystemtoSP</span>
<a name="ln-508"></a>          <span class="c">! Load based calc routine</span>
<a name="ln-509"></a><span class="k">PRIVATE </span><span class="n">CalcUnitarySystemToLoad</span>
<a name="ln-510"></a>
<a name="ln-511"></a><span class="k">PRIVATE </span><span class="n">CalcUnitaryCoolingSystem</span>
<a name="ln-512"></a><span class="k">PRIVATE </span><span class="n">CalcUnitaryHeatingSystem</span>
<a name="ln-513"></a><span class="k">PRIVATE </span><span class="n">CalcUnitarySuppHeatingSystem</span>
<a name="ln-514"></a><span class="k">PRIVATE </span><span class="n">CalcPassiveSystem</span>
<a name="ln-515"></a>
<a name="ln-516"></a>          <span class="c">! Airflow control routines</span>
<a name="ln-517"></a><span class="k">PRIVATE </span><span class="n">SetOnOffMassFlowRate</span>  <span class="c">! sets CompOnMassFlow and CompOffMassFlow</span>
<a name="ln-518"></a><span class="k">PRIVATE </span><span class="n">SetAverageAirFlow</span>     <span class="c">! sets inlet node mass flow rate based on PLR</span>
<a name="ln-519"></a>
<a name="ln-520"></a><span class="k">PRIVATE </span><span class="n">SetSpeedVariables</span> <span class="c">! sets speed ratio, cycling ratio, RTF etc for different models</span>
<a name="ln-521"></a>
<a name="ln-522"></a>          <span class="c">! Verify set point exists for SetPointBased control</span>
<a name="ln-523"></a><span class="k">PRIVATE </span><span class="n">CheckNodeSetPoint</span>
<a name="ln-524"></a>          <span class="c">! Heat recovery subroutine</span>
<a name="ln-525"></a><span class="k">PRIVATE </span><span class="n">UnitarySystemHeatRecovery</span>
<a name="ln-526"></a>          <span class="c">! Reporting routines for module</span>
<a name="ln-527"></a><span class="k">PRIVATE </span><span class="n">ReportUnitarySystem</span>
<a name="ln-528"></a>
<a name="ln-529"></a>          <span class="c">! RegulaFalsi routines</span>
<a name="ln-530"></a><span class="c">! ** RAR I&#39;d rather see a SELECT CASE in 1 or 2 generic routines instead of one for each coil type</span>
<a name="ln-531"></a><span class="k">PRIVATE </span><span class="n">DXCoilVarSpeedResidual</span>         <span class="c">! converges on outlet air set point temperature</span>
<a name="ln-532"></a><span class="k">PRIVATE </span><span class="n">DXCoilVarSpeedHumRatResidual</span>   <span class="c">! converges on outlet air set point humidity ratio</span>
<a name="ln-533"></a><span class="k">PRIVATE </span><span class="n">DXCoilCyclingResidual</span>          <span class="c">! converges on outlet air set point temperature</span>
<a name="ln-534"></a><span class="k">PRIVATE </span><span class="n">DXCoilCyclingHumRatResidual</span>    <span class="c">! converges on outlet air set point humidity ratio</span>
<a name="ln-535"></a><span class="k">PRIVATE </span><span class="n">DOE2DXCoilResidual</span>             <span class="c">! converges on outlet air set point temperature</span>
<a name="ln-536"></a><span class="k">PRIVATE </span><span class="n">DOE2DXCoilHumRatResidual</span>       <span class="c">! converges on outlet air set point humidity ratio</span>
<a name="ln-537"></a><span class="k">PRIVATE </span><span class="n">DXHeatingCoilResidual</span>          <span class="c">! converges on outlet air set point temperature</span>
<a name="ln-538"></a><span class="k">PRIVATE </span><span class="n">HeatingCoilVarSpeedResidual</span>    <span class="c">! converges on outlet air set point temperature</span>
<a name="ln-539"></a><span class="k">PRIVATE </span><span class="n">HeatingCoilVarSpeedCycResidual</span> <span class="c">! converges on outlet air set point temperature</span>
<a name="ln-540"></a><span class="k">PRIVATE </span><span class="n">MultiModeDXCoilResidual</span>        <span class="c">! converges on outlet air set point temperature</span>
<a name="ln-541"></a><span class="k">PRIVATE </span><span class="n">MultiModeDXCoilHumRatResidual</span>  <span class="c">! converges on outlet air set point humidity ratio</span>
<a name="ln-542"></a><span class="k">PRIVATE </span><span class="n">HXAssistedCoolCoilTempResidual</span> <span class="c">! converges on outlet air set point temperature</span>
<a name="ln-543"></a><span class="k">PRIVATE </span><span class="n">HXAssistedCoolCoilHRResidual</span>   <span class="c">! converges on outlet air set point humidity ratio</span>
<a name="ln-544"></a><span class="k">PRIVATE </span><span class="n">HotWaterHeatingCoilResidual</span>    <span class="c">! converges on outlet air set point temperature</span>
<a name="ln-545"></a><span class="k">PRIVATE </span><span class="n">GasElecHeatingCoilResidual</span>     <span class="c">! converges on outlet air set point temperature</span>
<a name="ln-546"></a><span class="k">PRIVATE </span><span class="n">SteamHeatingCoilResidual</span>       <span class="c">! converges on outlet air set point temperature</span>
<a name="ln-547"></a><span class="k">PRIVATE </span><span class="n">CoolWaterTempResidual</span>          <span class="c">! converges on outlet air set point temperature</span>
<a name="ln-548"></a><span class="k">PRIVATE </span><span class="n">CoolWaterHumRatResidual</span>        <span class="c">! converges on outlet air set point temperature</span>
<a name="ln-549"></a>
<a name="ln-550"></a><span class="k">PRIVATE </span><span class="n">CalcUnitarySystemLoadResidual</span>  <span class="c">! converges on load to be met</span>
<a name="ln-551"></a>
<a name="ln-552"></a><span class="k">PRIVATE </span><span class="n">CoolWatertoAirHPTempResidual</span>   <span class="c">! converges on outlet air set point temperature</span>
<a name="ln-553"></a><span class="k">PRIVATE </span><span class="n">HeatWatertoAirHPTempResidual</span>   <span class="c">! converges on outlet air set point temperature</span>
<a name="ln-554"></a><span class="k">PRIVATE </span><span class="n">HeatPumpRunFrac</span>                <span class="c">! calculates RTF based on PLR</span>
<a name="ln-555"></a><span class="k">PRIVATE </span><span class="n">SimMultiSpeedCoils</span>             <span class="c">! simulates multispeed coil types</span>
<a name="ln-556"></a><span class="k">PRIVATE </span><span class="n">SimWaterCoils</span>                  <span class="c">! simulates water coils</span>
<a name="ln-557"></a><span class="k">PRIVATE </span><span class="n">SimSteamCoils</span>                  <span class="c">! simulates steam coils</span>
<a name="ln-558"></a><span class="k">PRIVATE </span><span class="n">FrostControlSetPointLimit</span>      <span class="c">! frost control routine for 100% OA DX coils</span>
<a name="ln-559"></a><span class="k">PRIVATE </span><span class="n">GetUnitarySystemDXCoolingCoilIndex</span> <span class="c">! finds cool coil index in other UnitarySystem objects</span>
<a name="ln-560"></a><span class="k">PUBLIC  </span><span class="n">CheckUnitarySysCoilInOASysExists</span>   <span class="c">! check if UnitarySystem is on OA system</span>
<a name="ln-561"></a><span class="k">PUBLIC  </span><span class="n">GetUnitarySystemOAHeatCoolCoil</span>     <span class="c">! Logical returns if coil is in OA system</span>
<a name="ln-562"></a>
<a name="ln-563"></a><span class="k">CONTAINS</span>
<a name="ln-564"></a>
<a name="ln-565"></a><span class="c">! MODULE SUBROUTINES:</span>
<a name="ln-566"></a><span class="c">!*************************************************************************</span>
<a name="ln-567"></a><span class="k">SUBROUTINE </span><span class="n">SimUnitarySystem</span><span class="p">(</span><span class="n">UnitarySystemName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">AirLoopNum</span><span class="p">,</span><span class="n">CompIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-568"></a>                            <span class="n">HeatActive</span><span class="p">,</span><span class="n">CoolActive</span><span class="p">,</span><span class="n">OAUnitNum</span><span class="p">,</span><span class="n">OAUCoilOutTemp</span><span class="p">,</span><span class="n">ZoneEquipment</span><span class="p">)</span>
<a name="ln-569"></a>
<a name="ln-570"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-571"></a>          <span class="c">!       AUTHOR         Richard Raustad, FSEC</span>
<a name="ln-572"></a>          <span class="c">!       DATE WRITTEN   February 2013</span>
<a name="ln-573"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-574"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-575"></a>
<a name="ln-576"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-577"></a>          <span class="c">! This subroutine manages unitary system component simulation.</span>
<a name="ln-578"></a>
<a name="ln-579"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-580"></a>          <span class="c">! na</span>
<a name="ln-581"></a>
<a name="ln-582"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-583"></a>          <span class="c">! na</span>
<a name="ln-584"></a>
<a name="ln-585"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-586"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>          <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-587"></a>  <span class="k">USE </span><span class="n">DataAirLoop</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">AirLoopControlInfo</span>
<a name="ln-588"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>   <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-589"></a>
<a name="ln-590"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-591"></a>
<a name="ln-592"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-593"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">UnitarySystemName</span>  <span class="c">! Name of Unitary System object</span>
<a name="ln-594"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">FirstHVACIteration</span> <span class="c">! True when first HVAC iteration</span>
<a name="ln-595"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">AirLoopNum</span>         <span class="c">! Primary air loop number</span>
<a name="ln-596"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">CompIndex</span>          <span class="c">! Index to Unitary System object</span>
<a name="ln-597"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">),</span>   <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">HeatActive</span>         <span class="c">! True if heat coil active</span>
<a name="ln-598"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">),</span>   <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">CoolActive</span>         <span class="c">! True if cool coil active</span>
<a name="ln-599"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span>    <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">OAUnitNum</span>          <span class="c">! If the system is an equipment of OutdoorAirUnit</span>
<a name="ln-600"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span>    <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">OAUCoilOutTemp</span>     <span class="c">! the coil inlet temperature of OutdoorAirUnit</span>
<a name="ln-601"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span>    <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">ZoneEquipment</span>      <span class="c">! TRUE if called as zone equipment</span>
<a name="ln-602"></a>
<a name="ln-603"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-604"></a>          <span class="c">! na</span>
<a name="ln-605"></a>
<a name="ln-606"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-607"></a>          <span class="c">! na</span>
<a name="ln-608"></a>
<a name="ln-609"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-610"></a>          <span class="c">! na</span>
<a name="ln-611"></a>
<a name="ln-612"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-613"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">UnitarySysNum</span>         <span class="c">! Index to AirloopHVAC:UnitarySystem object</span>
<a name="ln-614"></a>  <span class="kt">LOGICAL</span>       <span class="kd">::</span> <span class="n">HXUnitOn</span>              <span class="c">! Flag to control HX for HXAssisted Cooling Coil</span>
<a name="ln-615"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">CompOn</span>                <span class="c">! Determines if compressor is on or off</span>
<a name="ln-616"></a>
<a name="ln-617"></a>  <span class="c">! Obtains and Allocates unitary system related parameters from input file</span>
<a name="ln-618"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetInputFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-619"></a>    <span class="c">! Get the unitary system input</span>
<a name="ln-620"></a>    <span class="k">CALL </span><span class="n">GetUnitarySystemInput</span>
<a name="ln-621"></a>    <span class="n">GetInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-622"></a>  <span class="k">END IF</span>
<a name="ln-623"></a>
<a name="ln-624"></a>  <span class="c">! Find the correct unitary system Number</span>
<a name="ln-625"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CompIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-626"></a><span class="k">    </span><span class="n">UnitarySysNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">UnitarySystemName</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumUnitarySystem</span><span class="p">)</span>
<a name="ln-627"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySysNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-628"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimDXCoolingSystem: DXUnit not found=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystemName</span><span class="p">))</span>
<a name="ln-629"></a>    <span class="k">END IF</span>
<a name="ln-630"></a><span class="k">    </span><span class="n">CompIndex</span><span class="o">=</span><span class="n">UnitarySysNum</span>
<a name="ln-631"></a>  <span class="k">ELSE</span>
<a name="ln-632"></a><span class="k">    </span><span class="n">UnitarySysNum</span><span class="o">=</span><span class="n">CompIndex</span>
<a name="ln-633"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySysNum</span> <span class="o">&gt;</span> <span class="n">NumUnitarySystem</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">UnitarySysNum</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-634"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimUnitarySystem:  Invalid CompIndex passed=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-635"></a>                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-636"></a>                          <span class="s1">&#39;, Number of Unit Systems=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumUnitarySystem</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-637"></a>                          <span class="s1">&#39;, Unitary System name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystemName</span><span class="p">))</span>
<a name="ln-638"></a>    <span class="k">END IF</span>
<a name="ln-639"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">CheckEquipName</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-640"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">UnitarySystemName</span> <span class="o">/=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-641"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimUnitarySystem: Invalid CompIndex passed=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-642"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-643"></a>                            <span class="s1">&#39;, Unitary System name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystemName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, stored Unit Name for that index=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-644"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-645"></a>      <span class="k">END IF</span>
<a name="ln-646"></a><span class="k">      </span><span class="n">CheckEquipName</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-647"></a>    <span class="k">END IF</span>
<a name="ln-648"></a><span class="k">  END IF</span>
<a name="ln-649"></a>
<a name="ln-650"></a><span class="k">  IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">HeatActive</span><span class="p">))</span><span class="n">HeatActive</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-651"></a>  <span class="k">IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">CoolActive</span><span class="p">))</span><span class="n">CoolActive</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-652"></a>
<a name="ln-653"></a>  <span class="n">FanSpeedRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-654"></a>  <span class="k">IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">ZoneEquipment</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-655"></a><span class="k">    CALL </span><span class="n">InitUnitarySystems</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">OAUnitNUm</span><span class="p">,</span><span class="n">OAUCoilOutTemp</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-656"></a>  <span class="k">ELSE</span>
<a name="ln-657"></a><span class="k">    CALL </span><span class="n">InitUnitarySystems</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">AirLoopNum</span><span class="p">,</span><span class="n">OAUnitNUm</span><span class="p">,</span><span class="n">OAUCoilOutTemp</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-658"></a>  <span class="k">END IF</span>
<a name="ln-659"></a>
<a name="ln-660"></a>
<a name="ln-661"></a><span class="k">  </span><span class="n">HXUnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-662"></a>  <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlType</span><span class="p">)</span>
<a name="ln-663"></a>    <span class="k">CASE</span><span class="p">(</span><span class="n">SetPointBased</span><span class="p">)</span>
<a name="ln-664"></a>      <span class="n">CompOn</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-665"></a>      <span class="k">IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">ZoneEquipment</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-666"></a><span class="k">        CALL </span><span class="n">ControlUnitarySystemtoSP</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">OAUCoilOutTemp</span><span class="p">,</span><span class="n">HXUnitOn</span><span class="p">)</span>
<a name="ln-667"></a>      <span class="k">ELSE</span>
<a name="ln-668"></a><span class="k">        CALL </span><span class="n">ControlUnitarySystemtoSP</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">AirLoopNum</span><span class="p">,</span><span class="n">OAUCoilOutTemp</span><span class="p">,</span><span class="n">HXUnitOn</span><span class="p">)</span>
<a name="ln-669"></a>      <span class="k">END IF</span>
<a name="ln-670"></a><span class="k">    CASE</span><span class="p">(</span><span class="n">LoadBased</span><span class="p">)</span>
<a name="ln-671"></a>      <span class="k">IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">ZoneEquipment</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-672"></a><span class="k">        CALL </span><span class="n">ControlUnitarySystemtoLoad</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">CompOn</span><span class="p">,</span><span class="n">OAUCoilOutTemp</span><span class="p">,</span><span class="n">HXUnitOn</span><span class="p">)</span>
<a name="ln-673"></a>      <span class="k">ELSE</span>
<a name="ln-674"></a><span class="k">        CALL </span><span class="n">ControlUnitarySystemtoLoad</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">AirLoopNum</span><span class="p">,</span><span class="n">CompOn</span><span class="p">,</span><span class="n">OAUCoilOutTemp</span><span class="p">,</span><span class="n">HXUnitOn</span><span class="p">)</span>
<a name="ln-675"></a>      <span class="k">END IF</span>
<a name="ln-676"></a><span class="k">  END SELECT</span>
<a name="ln-677"></a>
<a name="ln-678"></a>  <span class="c">! Report the current output</span>
<a name="ln-679"></a>  <span class="k">IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">ZoneEquipment</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-680"></a><span class="k">    CALL </span><span class="n">ReportUnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-681"></a>  <span class="k">ELSE</span>
<a name="ln-682"></a><span class="k">    CALL </span><span class="n">ReportUnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">AirLoopNum</span><span class="p">)</span>
<a name="ln-683"></a>  <span class="k">END IF</span>
<a name="ln-684"></a>
<a name="ln-685"></a><span class="k">  IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">CoolActive</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-686"></a><span class="k">    IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingPartLoadFrac</span><span class="o">*</span><span class="kt">REAL</span><span class="p">(</span><span class="n">CompOn</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="n">CoolActive</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-687"></a>  <span class="k">END IF</span>
<a name="ln-688"></a><span class="k">  IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">HeatActive</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-689"></a><span class="k">    IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingPartLoadFrac</span><span class="o">*</span><span class="kt">REAL</span><span class="p">(</span><span class="n">CompOn</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-690"></a>     <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatPartLoadFrac</span><span class="o">*</span><span class="kt">REAL</span><span class="p">(</span><span class="n">CompOn</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="n">HeatActive</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-691"></a>  <span class="k">END IF</span>
<a name="ln-692"></a>
<a name="ln-693"></a>  <span class="c">! set econo lockout flag</span>
<a name="ln-694"></a>  <span class="c">! If the sysem is not an equipment of Outdoor air unit</span>
<a name="ln-695"></a><span class="c">!  IF (AirLoopNum /=-1 .AND. ALLOCATED(AirLoopControlInfo) .AND. UnitarySystem(UnitarySysNum)%AirLoopEquipment) THEN</span>
<a name="ln-696"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">AirLoopNum</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">AirLoopControlInfo</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">AirLoopEquipment</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-697"></a>
<a name="ln-698"></a><span class="k">    IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCompPartLoadRatio</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-699"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SpeedRatio</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-700"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CycRatio</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-701"></a>          <span class="n">AirLoopControlInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">CanLockoutEconoWithCompressor</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-702"></a><span class="k">            </span><span class="n">AirLoopControlInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">ReqstEconoLockoutWithCompressor</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-703"></a>    <span class="k">ELSE</span>
<a name="ln-704"></a><span class="k">      </span><span class="n">AirLoopControlInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">ReqstEconoLockoutWithCompressor</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-705"></a>    <span class="k">END IF</span>
<a name="ln-706"></a>
<a name="ln-707"></a><span class="k">    IF</span> <span class="p">((</span><span class="n">HeatActive</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-708"></a>       <span class="p">(</span><span class="n">AirLoopControlInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">CanLockoutEconoWithCompressor</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-709"></a>        <span class="n">AirLoopControlInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">CanLockoutEconoWithHeating</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-710"></a><span class="k">      </span><span class="n">AirLoopControlInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">ReqstEconoLockoutWithHeating</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-711"></a>    <span class="k">ELSE</span>
<a name="ln-712"></a><span class="k">      </span><span class="n">AirLoopControlInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">ReqstEconoLockoutWithHeating</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-713"></a>    <span class="k">END IF</span>
<a name="ln-714"></a>
<a name="ln-715"></a><span class="k">  END IF</span>
<a name="ln-716"></a>
<a name="ln-717"></a>  <span class="c">! Calculate heat recovery</span>
<a name="ln-718"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatRecActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-719"></a><span class="k">    CALL </span><span class="n">UnitarySystemHeatRecovery</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)</span>
<a name="ln-720"></a>  <span class="k">END IF</span>
<a name="ln-721"></a>
<a name="ln-722"></a>  <span class="c">! Coils should have been sized by now. Set this flag to false in case other equipment is downstream of Unitary System.</span>
<a name="ln-723"></a><span class="c">! can&#39;t do this since there are other checks that need this flag (e.g., HVACManager, line 3577)</span>
<a name="ln-724"></a><span class="c">!  AirLoopControlInfo(AirLoopNum)%UnitarySys = .FALSE.</span>
<a name="ln-725"></a>
<a name="ln-726"></a>  <span class="k">RETURN</span>
<a name="ln-727"></a>
<a name="ln-728"></a><span class="k">END SUBROUTINE </span><span class="n">SimUnitarySystem</span>
<a name="ln-729"></a>
<a name="ln-730"></a><span class="c">! Beginning of Initialization subroutines for the Module</span>
<a name="ln-731"></a><span class="c">! *****************************************************************************</span>
<a name="ln-732"></a>
<a name="ln-733"></a><span class="k">SUBROUTINE </span><span class="n">InitUnitarySystems</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">AirLoopNum</span><span class="p">,</span><span class="n">OAUnitNum</span><span class="p">,</span><span class="n">OAUCoilOutTemp</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-734"></a>
<a name="ln-735"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-736"></a>          <span class="c">!       AUTHOR         Richard Raustad, FSEC</span>
<a name="ln-737"></a>          <span class="c">!       DATE WRITTEN   February 2013</span>
<a name="ln-738"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-739"></a>
<a name="ln-740"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-741"></a>          <span class="c">! This subroutine is for initializations of the unitary systems.</span>
<a name="ln-742"></a>
<a name="ln-743"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-744"></a>          <span class="c">! Uses the status flags to trigger initializations.</span>
<a name="ln-745"></a>
<a name="ln-746"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-747"></a>          <span class="c">! na</span>
<a name="ln-748"></a>
<a name="ln-749"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-750"></a>  <span class="k">USE </span><span class="n">DataAirLoop</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">AirLoopControlInfo</span>
<a name="ln-751"></a>  <span class="k">USE </span><span class="n">DataAirflowNetwork</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">AirflowNetworkUnitarySystem</span>
<a name="ln-752"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">ScanPlantLoopsForObject</span><span class="p">,</span> <span class="n">TypeOf_UnitarySystemRecovery</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-753"></a>                             <span class="n">PlantLoop</span><span class="p">,</span> <span class="n">TypeOf_CoilSteamAirHeating</span><span class="p">,</span> <span class="n">TypeOf_CoilWaterSimpleHeating</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-754"></a>                             <span class="n">TypeOf_CoilWaterCooling</span><span class="p">,</span> <span class="n">TypeOf_CoilWaterDetailedFlatCooling</span>
<a name="ln-755"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetDensityGlycol</span><span class="p">,</span> <span class="n">GetSatDensityRefrig</span>
<a name="ln-756"></a>  <span class="k">USE </span><span class="n">HeatingCoils</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateHeatingCoilComponents</span><span class="p">,</span> <span class="n">GetHeatingCoilCapacity</span><span class="o">=&gt;</span><span class="n">GetCoilCapacity</span>
<a name="ln-757"></a>  <span class="k">USE </span><span class="n">WaterCoils</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCoilMaxWaterFlowRate</span><span class="p">,</span> <span class="n">SimulateWaterCoilComponents</span><span class="p">,</span> <span class="n">SetCoilDesFlow</span>
<a name="ln-758"></a>  <span class="k">USE </span><span class="n">HVACHXAssistedCoolingCoil</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetHXDXCoilName</span><span class="p">,</span><span class="n">GetHXDXCoilIndex</span><span class="p">,</span> <span class="n">GetCoilObjectTypeNum</span>
<a name="ln-759"></a>  <span class="k">USE </span><span class="n">SteamCoils</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCoilMaxSteamFlowRate</span><span class="p">,</span> <span class="n">SimulateSteamCoilComponents</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-760"></a>                             <span class="n">GetSteamCoilCapacity</span><span class="o">=&gt;</span><span class="n">GetCoilCapacity</span>
<a name="ln-761"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">SetComponentFlowRate</span><span class="p">,</span> <span class="n">InitComponentNodes</span>
<a name="ln-762"></a>
<a name="ln-763"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-764"></a>
<a name="ln-765"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-766"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">UnitarySysNum</span>       <span class="c">! number of the current DX Sys being simulated</span>
<a name="ln-767"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">AirLoopNum</span>          <span class="c">! number of the current air loop being simulated</span>
<a name="ln-768"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">OPTIONAL</span>  <span class="kd">::</span> <span class="n">OAUnitNum</span>           <span class="c">! number of the current Outdoor air unit being simulated</span>
<a name="ln-769"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">OAUCoilOutTemp</span>      <span class="c">! the coil inlet temperature of OutdoorAirUnit</span>
<a name="ln-770"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">FirstHVACIteration</span>  <span class="c">! True when first HVAC iteration</span>
<a name="ln-771"></a>
<a name="ln-772"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-773"></a>          <span class="c">! na</span>
<a name="ln-774"></a>
<a name="ln-775"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-776"></a>          <span class="c">! na</span>
<a name="ln-777"></a>
<a name="ln-778"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-779"></a>          <span class="c">! na</span>
<a name="ln-780"></a>
<a name="ln-781"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-782"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyEnvrnFlag</span>              <span class="c">! environment flag</span>
<a name="ln-783"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyPlantScanFlag</span>          <span class="c">! used for finding on heat recovery plant loop</span>
<a name="ln-784"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MySuppCoilPlantScanFlag</span>  <span class="c">! used for finding on heat recovery plant loop</span>
<a name="ln-785"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MySetPointCheckFlag</span>      <span class="c">! tests for set point</span>
<a name="ln-786"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MySizingCheckFlag</span>        <span class="c">! tests for sizing</span>
<a name="ln-787"></a>  <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">SAVE</span>                             <span class="kd">::</span> <span class="n">MyOneTimeFlag</span>  <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>  <span class="c">! one time flag</span>
<a name="ln-788"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolingCoilType</span>    <span class="o">=</span><span class="s1">&#39; &#39;</span>    <span class="c">! Coil:Cooling:Water or Coil:Cooling:Water:DetailedGeometry</span>
<a name="ln-789"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolingCoilName</span>    <span class="o">=</span><span class="s1">&#39; &#39;</span>    <span class="c">! Coil:Cooling:Water or Coil:Cooling:Water:DetailedGeometry</span>
<a name="ln-790"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatingCoilType</span>    <span class="o">=</span><span class="s1">&#39; &#39;</span>    <span class="c">! Coil:Heating:Water or Coil:Heating:Steam</span>
<a name="ln-791"></a>  <span class="kt">LOGICAL</span>             <span class="kd">::</span> <span class="n">errFlag</span>                 <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>   <span class="c">! error flag for mining functions</span>
<a name="ln-792"></a>  <span class="kt">LOGICAL</span>             <span class="kd">::</span> <span class="n">ErrorsFound</span>             <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>   <span class="c">! error flag for mining functions</span>
<a name="ln-793"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">ControlNode</span>                         <span class="c">! control node number</span>
<a name="ln-794"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">OutdoorAirUnitNum</span>                   <span class="c">! &quot;ONLY&quot; for ZoneHVAC:OutdoorAirUnit</span>
<a name="ln-795"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">SteamIndex</span>              <span class="o">=</span> <span class="mi">0</span>         <span class="c">! index of steam quality for steam heating coil</span>
<a name="ln-796"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">TypeOfCoilWaterCooling</span>  <span class="o">=</span> <span class="mi">0</span>         <span class="c">! Used for simple water cool coil or detailed geometry</span>
<a name="ln-797"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">TypeOfCoilWaterHeating</span>  <span class="o">=</span> <span class="mi">0</span>         <span class="c">! Used for simple water heat coil or steam coil</span>
<a name="ln-798"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">OAUCoilOutletTemp</span>       <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! &quot;ONLY&quot; for zoneHVAC:OutdoorAirUnit [C]</span>
<a name="ln-799"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">mdot</span>                    <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! local temporary for mass flow rate (kg/s)</span>
<a name="ln-800"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">SteamDensity</span>            <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! density of steam at 100C, used for steam heating coils [kg/m3]</span>
<a name="ln-801"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">CoilMaxVolFlowRate</span>      <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! coil fluid maximum volume flow rate [m3/s]</span>
<a name="ln-802"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">QACTUAL</span>                 <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! coil actual capacity [W]</span>
<a name="ln-803"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">rho</span>                     <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! local fluid density [kg/m3]</span>
<a name="ln-804"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">mdotHR</span>                  <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! heat recovery mass flow rate [kg/s]</span>
<a name="ln-805"></a><span class="c">!  REAL(r64)           :: SaveMassFlow            = 0.0d0     ! saves node flow rate when checking heat coil capacity [m3/s]</span>
<a name="ln-806"></a>
<a name="ln-807"></a><span class="k">IF</span> <span class="p">(</span><span class="n">MyOneTimeFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-808"></a>
<a name="ln-809"></a><span class="k">  ALLOCATE</span><span class="p">(</span><span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">NumUnitarySystem</span><span class="p">))</span>
<a name="ln-810"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">NumUnitarySystem</span><span class="p">))</span>
<a name="ln-811"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MySuppCoilPlantScanFlag</span><span class="p">(</span><span class="n">NumUnitarySystem</span><span class="p">))</span>
<a name="ln-812"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MySetPointCheckFlag</span><span class="p">(</span><span class="n">NumUnitarySystem</span><span class="p">))</span>
<a name="ln-813"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MySizingCheckFlag</span><span class="p">(</span><span class="n">NumUnitarySystem</span><span class="p">))</span>
<a name="ln-814"></a>
<a name="ln-815"></a>  <span class="n">MyEnvrnFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-816"></a>  <span class="n">MyPlantScanFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-817"></a>  <span class="n">MySuppCoilPlantScanFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-818"></a>  <span class="n">MySetPointCheckFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-819"></a>  <span class="n">MySizingCheckFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-820"></a>
<a name="ln-821"></a>  <span class="n">MyOneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-822"></a>  <span class="n">AirflowNetworkUnitarySystem</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-823"></a><span class="k">END IF</span>
<a name="ln-824"></a>
<a name="ln-825"></a><span class="k">IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SysSizingCalc</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MySizingCheckFlag</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-826"></a><span class="k">  IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanExists</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-827"></a>     <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilExists</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-828"></a>      <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilExists</span><span class="p">)))</span> <span class="p">&amp;</span>
<a name="ln-829"></a>        <span class="n">AirLoopControlInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">UnitarySys</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-830"></a>  <span class="n">AirLoopControlInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">UnitarySysSimulating</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-831"></a>  <span class="k">CALL </span><span class="n">SizeUnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">AirLoopNum</span><span class="p">)</span>
<a name="ln-832"></a>  <span class="n">MySizingCheckFlag</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-833"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">AirLoopNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-834"></a><span class="k">    </span><span class="n">AirLoopControlInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">FanOpMode</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span>
<a name="ln-835"></a>    <span class="n">AirLoopControlInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">CycFanSchedPtr</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpModeSchedPtr</span>
<a name="ln-836"></a>  <span class="k">END IF</span>
<a name="ln-837"></a><span class="k">END IF</span>
<a name="ln-838"></a>
<a name="ln-839"></a><span class="k">IF</span> <span class="p">(</span><span class="n">AirLoopNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! This DX system is component of ZoneHVAC:OutdoorAirUnit</span>
<a name="ln-840"></a>   <span class="n">OutdoorAirUnitNum</span><span class="o">=</span><span class="n">OAUnitNum</span>
<a name="ln-841"></a>   <span class="n">OAUCoilOutletTemp</span><span class="o">=</span><span class="n">OAUCoilOutTemp</span>
<a name="ln-842"></a><span class="k">END IF</span>
<a name="ln-843"></a>
<a name="ln-844"></a>  <span class="c">! Scan hot water and steam heating coil plant components for one time initializations</span>
<a name="ln-845"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-846"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatRecActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-847"></a><span class="k">      </span><span class="n">errFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-848"></a>      <span class="k">CALL </span><span class="n">ScanPlantLoopsForObject</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-849"></a>                                   <span class="n">TypeOf_UnitarySystemRecovery</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-850"></a>                                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-851"></a>                                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HRLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-852"></a>                                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HRBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-853"></a>                                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HRCompNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-854"></a>                                   <span class="n">errFlag</span><span class="o">=</span><span class="n">errFlag</span><span class="p">)</span>
<a name="ln-855"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">errFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-856"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;InitUnitarySystems: Program terminated for previous conditions.&#39;</span><span class="p">)</span>
<a name="ln-857"></a>      <span class="k">END IF</span>
<a name="ln-858"></a><span class="k">    END IF</span>
<a name="ln-859"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_CoolingWater</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-860"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_CoolingWaterDetailed</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-861"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilWater_CoolingHXAssisted</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-862"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_CoolingWater</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-863"></a><span class="k">          </span><span class="n">TypeOfCoilWaterCooling</span> <span class="o">=</span> <span class="n">TypeOf_CoilWaterCooling</span>
<a name="ln-864"></a>          <span class="n">CoolingCoilType</span> <span class="o">=</span> <span class="s1">&#39;Coil:Cooling:Water&#39;</span>
<a name="ln-865"></a>          <span class="n">CoolingCoilName</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilName</span>
<a name="ln-866"></a>        <span class="k">ELSE IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_CoolingWaterDetailed</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-867"></a><span class="k">          </span><span class="n">TypeOfCoilWaterCooling</span> <span class="o">=</span> <span class="n">TypeOf_CoilWaterDetailedFlatCooling</span>
<a name="ln-868"></a>          <span class="n">CoolingCoilType</span> <span class="o">=</span> <span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span>
<a name="ln-869"></a>          <span class="n">CoolingCoilName</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilName</span>
<a name="ln-870"></a>        <span class="k">ELSE</span>
<a name="ln-871"></a><span class="k">          </span><span class="n">TypeOfCoilWaterCooling</span> <span class="o">=</span> <span class="n">GetCoilObjectTypeNum</span><span class="p">(</span><span class="n">cAllCoilTypes</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-872"></a>                                                        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">,.</span><span class="n">TRUE</span><span class="p">.)</span>
<a name="ln-873"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">TypeOfCoilWaterCooling</span> <span class="o">==</span> <span class="n">Coil_CoolingWater</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-874"></a><span class="k">            </span><span class="n">TypeOfCoilWaterCooling</span> <span class="o">=</span> <span class="n">TypeOf_CoilWaterCooling</span>
<a name="ln-875"></a>            <span class="n">CoolingCoilType</span> <span class="o">=</span> <span class="s1">&#39;Coil:Cooling:Water&#39;</span>
<a name="ln-876"></a>          <span class="k">ELSE IF</span><span class="p">(</span><span class="n">TypeOfCoilWaterCooling</span> <span class="o">==</span> <span class="n">Coil_CoolingWaterDetailed</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-877"></a><span class="k">            </span><span class="n">TypeOfCoilWaterCooling</span> <span class="o">=</span> <span class="n">TypeOf_CoilWaterDetailedFlatCooling</span>
<a name="ln-878"></a>            <span class="n">CoolingCoilType</span> <span class="o">=</span> <span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span>
<a name="ln-879"></a>          <span class="k">END IF</span>
<a name="ln-880"></a><span class="k">          </span><span class="n">CoolingCoilName</span> <span class="o">=</span> <span class="n">GetHXDXCoilName</span><span class="p">(</span><span class="n">cAllCoilTypes</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-881"></a>                                            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-882"></a>        <span class="k">END IF</span>
<a name="ln-883"></a><span class="k">        </span><span class="n">errFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-884"></a>        <span class="k">CALL </span><span class="n">ScanPlantLoopsForObject</span><span class="p">(</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">CoolingCoilName</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-885"></a>                                      <span class="n">TypeOfCoilWaterCooling</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-886"></a>                                      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-887"></a>                                      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilLoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-888"></a>                                      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-889"></a>                                      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilCompNum</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-890"></a>                                      <span class="n">errFlag</span><span class="o">=</span><span class="n">errFlag</span><span class="p">)</span>
<a name="ln-891"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">errFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-892"></a><span class="k">          CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;InitUnitarySystem: Program terminated for previous conditions.&#39;</span><span class="p">)</span>
<a name="ln-893"></a>        <span class="k">END IF</span>
<a name="ln-894"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolCoilFluidFlow</span> <span class="o">=</span> <span class="n">GetCoilMaxWaterFlowRate</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-895"></a>                                                   <span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-896"></a>
<a name="ln-897"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolCoilFluidFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-898"></a><span class="k">            </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-899"></a>                                   <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-900"></a>                                   <span class="n">PlantLoop</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-901"></a>                                   <span class="s1">&#39;InitUnitarySystem&#39;</span><span class="p">)</span>
<a name="ln-902"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolCoilFluidFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolCoilFluidFlow</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-903"></a>        <span class="k">END IF</span>
<a name="ln-904"></a>        <span class="c">! fill outlet node for coil</span>
<a name="ln-905"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilFluidOutletNodeNum</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-906"></a>            <span class="n">PlantLoop</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilLoopNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilLoopSide</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-907"></a>            <span class="p">%</span><span class="n">Branch</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilBranchNum</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilCompNum</span><span class="p">)%</span><span class="n">NodeNumOut</span>
<a name="ln-908"></a>
<a name="ln-909"></a>    <span class="k">END IF</span>
<a name="ln-910"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWater</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-911"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingSteam</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-912"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWater</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-913"></a><span class="k">          </span><span class="n">TypeOfCoilWaterHeating</span> <span class="o">=</span> <span class="n">TypeOf_CoilWaterSimpleHeating</span>
<a name="ln-914"></a>          <span class="n">HeatingCoilType</span> <span class="o">=</span> <span class="s1">&#39;Coil:Heating:Water&#39;</span>
<a name="ln-915"></a>          <span class="k">CALL </span><span class="n">SetCoilDesFlow</span><span class="p">(</span><span class="n">CALLCoilTypes</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-916"></a>                              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-917"></a>                              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span><span class="p">,&amp;</span>
<a name="ln-918"></a>                              <span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-919"></a>        <span class="k">ELSE</span>
<a name="ln-920"></a><span class="k">          </span><span class="n">TypeOfCoilWaterHeating</span> <span class="o">=</span> <span class="n">TypeOf_CoilSteamAirHeating</span>
<a name="ln-921"></a>          <span class="n">HeatingCoilType</span> <span class="o">=</span> <span class="s1">&#39;Coil:Heating:Steam&#39;</span>
<a name="ln-922"></a>        <span class="k">END IF</span>
<a name="ln-923"></a><span class="k">        </span><span class="n">errFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-924"></a>        <span class="k">CALL </span><span class="n">ScanPlantLoopsForObject</span><span class="p">(</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-925"></a>                                      <span class="n">TypeOfCoilWaterHeating</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-926"></a>                                      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-927"></a>                                      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilLoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-928"></a>                                      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-929"></a>                                      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilCompNum</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-930"></a>                                      <span class="n">errFlag</span><span class="o">=</span><span class="n">errFlag</span><span class="p">)</span>
<a name="ln-931"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">errFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-932"></a><span class="k">          CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;InitUnitarySystem: Program terminated for previous conditions.&#39;</span><span class="p">)</span>
<a name="ln-933"></a>        <span class="k">END IF</span>
<a name="ln-934"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWater</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-935"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="o">=</span> <span class="n">GetCoilMaxWaterFlowRate</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-936"></a>                                                     <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-937"></a>
<a name="ln-938"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-939"></a><span class="k">              </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-940"></a>                                     <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-941"></a>                                     <span class="n">PlantLoop</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-942"></a>                                     <span class="s1">&#39;InitUnitarySystem&#39;</span><span class="p">)</span>
<a name="ln-943"></a>              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="o">=</span> <span class="n">GetCoilMaxWaterFlowRate</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-944"></a>                                      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-945"></a>          <span class="k">END IF</span>
<a name="ln-946"></a><span class="k">        ELSE</span>
<a name="ln-947"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-948"></a>             <span class="n">GetCoilMaxSteamFlowRate</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-949"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-950"></a><span class="k">            </span><span class="n">SteamIndex</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! Function GetSatDensityRefrig will look up steam index if 0 is passed</span>
<a name="ln-951"></a>            <span class="n">SteamDensity</span><span class="o">=</span><span class="n">GetSatDensityRefrig</span><span class="p">(</span><span class="s1">&#39;STEAM&#39;</span><span class="p">,</span><span class="n">TempSteamIn</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">SteamIndex</span><span class="p">,</span><span class="s1">&#39;InitUnitarySystem&#39;</span><span class="p">)</span>
<a name="ln-952"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="o">*</span> <span class="n">SteamDensity</span>
<a name="ln-953"></a>          <span class="k">END IF</span>
<a name="ln-954"></a><span class="k">        END IF</span>
<a name="ln-955"></a>        <span class="c">! fill outlet node for coil</span>
<a name="ln-956"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilFluidOutletNodeNum</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-957"></a>            <span class="n">PlantLoop</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilLoopNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilLoopSide</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-958"></a>            <span class="p">%</span><span class="n">Branch</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilBranchNum</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilCompNum</span><span class="p">)%</span><span class="n">NodeNumOut</span>
<a name="ln-959"></a>    <span class="k">END IF</span>
<a name="ln-960"></a>
<a name="ln-961"></a><span class="k">    </span><span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-962"></a>
<a name="ln-963"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">AnyPlantInModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-964"></a><span class="k">    </span><span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-965"></a>  <span class="k">END IF</span>
<a name="ln-966"></a>
<a name="ln-967"></a>  <span class="c">! Scan Supplemental hot water and steam heating coil plant components for one time initializations</span>
<a name="ln-968"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MySuppCoilPlantScanFlag</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-969"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWater</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-970"></a><span class="k">        </span><span class="n">errFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-971"></a>        <span class="k">CALL </span><span class="n">ScanPlantLoopsForObject</span><span class="p">(</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-972"></a>                                      <span class="n">TypeOf_CoilWaterSimpleHeating</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-973"></a>                                      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-974"></a>                                      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilLoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-975"></a>                                      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-976"></a>                                      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilCompNum</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-977"></a>                                      <span class="n">errFlag</span><span class="o">=</span><span class="n">errFlag</span><span class="p">)</span>
<a name="ln-978"></a>        <span class="k">CALL </span><span class="n">SetCoilDesFlow</span><span class="p">(</span><span class="n">CALLCoilTypes</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType_Num</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-979"></a>                            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-980"></a>                            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span><span class="p">,&amp;</span>
<a name="ln-981"></a>                            <span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-982"></a>
<a name="ln-983"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">errFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-984"></a><span class="k">          CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;InitUnitarySystems: Program terminated for previous conditions.&#39;</span><span class="p">)</span>
<a name="ln-985"></a>        <span class="k">END IF</span>
<a name="ln-986"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">=</span> <span class="n">GetCoilMaxWaterFlowRate</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-987"></a>                                                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-988"></a>
<a name="ln-989"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-990"></a><span class="k">            </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-991"></a>                                   <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-992"></a>                                   <span class="n">PlantLoop</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-993"></a>                                   <span class="s1">&#39;InitUnitarySystems&#39;</span><span class="p">)</span>
<a name="ln-994"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">=</span> <span class="n">GetCoilMaxWaterFlowRate</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-995"></a>                                    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-996"></a>        <span class="k">END IF</span>
<a name="ln-997"></a>        <span class="c">! fill outlet node for coil</span>
<a name="ln-998"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilFluidOutletNodeNum</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-999"></a>            <span class="n">PlantLoop</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilLoopNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilLoopSide</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1000"></a>            <span class="p">%</span><span class="n">Branch</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilBranchNum</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilCompNum</span><span class="p">)%</span><span class="n">NodeNumOut</span>
<a name="ln-1001"></a>
<a name="ln-1002"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingSteam</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1003"></a><span class="k">        </span><span class="n">errFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1004"></a>        <span class="k">CALL </span><span class="n">ScanPlantLoopsForObject</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1005"></a>                                     <span class="n">TypeOf_CoilSteamAirHeating</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1006"></a>                                     <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1007"></a>                                     <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilLoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1008"></a>                                     <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1009"></a>                                     <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilCompNum</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1010"></a>                                     <span class="n">errFlag</span><span class="o">=</span><span class="n">errFlag</span><span class="p">)</span>
<a name="ln-1011"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">errFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1012"></a><span class="k">          CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;InitUnitarySystems: Program terminated for previous conditions.&#39;</span><span class="p">)</span>
<a name="ln-1013"></a>        <span class="k">END IF</span>
<a name="ln-1014"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-1015"></a>           <span class="n">GetCoilMaxSteamFlowRate</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-1016"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1017"></a><span class="k">          </span><span class="n">SteamIndex</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! Function GetSatDensityRefrig will look up steam index if 0 is passed</span>
<a name="ln-1018"></a>          <span class="n">SteamDensity</span><span class="o">=</span><span class="n">GetSatDensityRefrig</span><span class="p">(</span><span class="s1">&#39;STEAM&#39;</span><span class="p">,</span><span class="n">TempSteamIn</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">SteamIndex</span><span class="p">,</span><span class="s1">&#39;InitUnitarySystems&#39;</span><span class="p">)</span>
<a name="ln-1019"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">*</span> <span class="n">SteamDensity</span>
<a name="ln-1020"></a>        <span class="k">END IF</span>
<a name="ln-1021"></a>
<a name="ln-1022"></a>      <span class="c">! fill outlet node for coil</span>
<a name="ln-1023"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilFluidOutletNodeNum</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-1024"></a>            <span class="n">PlantLoop</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilLoopNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilLoopSide</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1025"></a>            <span class="p">%</span><span class="n">Branch</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilBranchNum</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilCompNum</span><span class="p">)%</span><span class="n">NodeNumOut</span>
<a name="ln-1026"></a>    <span class="k">END IF</span>
<a name="ln-1027"></a>
<a name="ln-1028"></a><span class="k">    </span><span class="n">MySuppCoilPlantScanFlag</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1029"></a>
<a name="ln-1030"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">MySuppCoilPlantScanFlag</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">AnyPlantInModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1031"></a><span class="k">    </span><span class="n">MySuppCoilPlantScanFlag</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1032"></a>  <span class="k">END IF</span>
<a name="ln-1033"></a>
<a name="ln-1034"></a><span class="c">! do the Begin Environment initializations</span>
<a name="ln-1035"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">BeginEnvrnFlag</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1036"></a><span class="k">    </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignMassFlowRate</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="o">*</span> <span class="n">StdRhoAir</span>
<a name="ln-1037"></a>    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirMassFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">*</span> <span class="n">StdRhoAir</span>
<a name="ln-1038"></a>    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirMassFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">*</span>  <span class="n">StdRhoAir</span>
<a name="ln-1039"></a>    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirMassFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">*</span> <span class="n">StdRhoAir</span>
<a name="ln-1040"></a>    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SenLoadLoss</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1041"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Humidistat</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1042"></a><span class="k">      </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">LatLoadLoss</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1043"></a>    <span class="k">END IF</span>
<a name="ln-1044"></a>
<a name="ln-1045"></a><span class="k">    IF</span> <span class="p">((</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatRecActive</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">))</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1046"></a>
<a name="ln-1047"></a><span class="k">      </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1048"></a>                             <span class="mi">6</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1049"></a>                             <span class="n">PlantLoop</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1050"></a>                             <span class="s1">&#39;InitUnitarySystems&#39;</span><span class="p">)</span>
<a name="ln-1051"></a>
<a name="ln-1052"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatRecMassFlowRate</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHRWaterVolumeFlow</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-1053"></a>
<a name="ln-1054"></a>      <span class="k">CALL </span><span class="n">InitComponentNodes</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatRecMassFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1055"></a>                              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatRecoveryInletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1056"></a>                              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatRecoveryOutletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1057"></a>                              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1058"></a>                              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HRLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1059"></a>                              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HRBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1060"></a>                              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HRCompNum</span> <span class="p">)</span>
<a name="ln-1061"></a>    <span class="k">END IF</span>
<a name="ln-1062"></a><span class="c">!   set fluid-side hardware limits</span>
<a name="ln-1063"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilFluidInletNode</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1064"></a>
<a name="ln-1065"></a><span class="k">      IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolCoilFluidFlow</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1066"></a>          <span class="c">! If water coil max water flow rate is autosized, simulate once in order to mine max flow rate</span>
<a name="ln-1067"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_CoolingWater</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1068"></a><span class="k">            </span><span class="n">CoolingCoilType</span> <span class="o">=</span> <span class="s1">&#39;Coil:Cooling:Water&#39;</span>
<a name="ln-1069"></a>        <span class="k">ELSE</span>
<a name="ln-1070"></a><span class="k">            </span><span class="n">CoolingCoilType</span> <span class="o">=</span> <span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span>
<a name="ln-1071"></a>        <span class="k">END IF</span>
<a name="ln-1072"></a><span class="k">        CALL </span><span class="n">SimulateWaterCoilComponents</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1073"></a>                                         <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">)</span>
<a name="ln-1074"></a>        <span class="n">CoilMaxVolFlowRate</span> <span class="o">=</span> <span class="n">GetCoilMaxWaterFlowRate</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1075"></a>                                                     <span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-1076"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">CoilMaxVolFlowRate</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Autosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1077"></a><span class="k">          </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilLoopNum</span><span class="p">)%</span><span class="n">fluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1078"></a>                                 <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1079"></a>                                 <span class="n">PlantLoop</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilLoopNum</span><span class="p">)%</span><span class="n">fluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1080"></a>                                 <span class="s1">&#39;InitUnitarySystem&#39;</span><span class="p">)</span>
<a name="ln-1081"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolCoilFluidFlow</span> <span class="o">=</span> <span class="n">CoilMaxVolFlowRate</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-1082"></a>        <span class="k">END IF</span>
<a name="ln-1083"></a><span class="k">      END IF</span>
<a name="ln-1084"></a>
<a name="ln-1085"></a><span class="k">      CALL </span><span class="n">InitComponentNodes</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolCoilFluidFlow</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1086"></a>                                    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilFluidInletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1087"></a>                                    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilFluidOutletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1088"></a>                                    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1089"></a>                                    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilLoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1090"></a>                                    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1091"></a>                                    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilCompNum</span> <span class="p">)</span>
<a name="ln-1092"></a>    <span class="k">END IF</span>
<a name="ln-1093"></a><span class="k">    IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilFluidInletNode</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1094"></a>
<a name="ln-1095"></a><span class="k">        IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1096"></a>            <span class="c">! IF water coil max water flow rate is autosized, simulate once in order to mine max flow rate</span>
<a name="ln-1097"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWater</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1098"></a><span class="k">                CALL </span><span class="n">SimulateWaterCoilComponents</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1099"></a>                                                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">)</span>
<a name="ln-1100"></a>                <span class="n">CoilMaxVolFlowRate</span> <span class="o">=</span> <span class="n">GetCoilMaxWaterFlowRate</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1101"></a>                                                             <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-1102"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">CoilMaxVolFlowRate</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Autosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1103"></a><span class="k">                    </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilLoopNum</span><span class="p">)%</span><span class="n">fluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1104"></a>                                            <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1105"></a>                                            <span class="n">PlantLoop</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilLoopNum</span><span class="p">)%</span><span class="n">fluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1106"></a>                                            <span class="s1">&#39;InitUnitarySystems&#39;</span><span class="p">)</span>
<a name="ln-1107"></a>                    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="o">=</span> <span class="n">CoilMaxVolFlowRate</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-1108"></a>                <span class="k">END IF</span>
<a name="ln-1109"></a><span class="k">            END IF</span>
<a name="ln-1110"></a>            <span class="c">! If steam coil max steam flow rate is autosized, simulate once in order to mine max flow rate</span>
<a name="ln-1111"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingSteam</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1112"></a><span class="k">                CALL </span><span class="n">SimulateSteamCoilComponents</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1113"></a>                                                <span class="n">FirstHVACIteration</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-1114"></a>                                                <span class="mf">1.0d0</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">!QCoilReq, simulate any load &gt; 0 to get max capacity</span>
<a name="ln-1115"></a>                                                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span> <span class="n">QActual</span><span class="p">)</span>
<a name="ln-1116"></a>                <span class="n">CoilMaxVolFlowRate</span> <span class="o">=</span> <span class="n">GetCoilMaxSteamFlowRate</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-1117"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">CoilMaxVolFlowRate</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Autosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1118"></a><span class="k">                   </span><span class="n">SteamIndex</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! Function GetSatDensityRefrig will look up steam index if 0 is passed</span>
<a name="ln-1119"></a>                   <span class="n">SteamDensity</span><span class="o">=</span><span class="n">GetSatDensityRefrig</span><span class="p">(</span><span class="s1">&#39;STEAM&#39;</span><span class="p">,</span><span class="n">TempSteamIn</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">SteamIndex</span><span class="p">,</span><span class="s1">&#39;InitUnitarySystems&#39;</span><span class="p">)</span>
<a name="ln-1120"></a>                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="o">=</span> <span class="n">CoilMaxVolFlowRate</span> <span class="o">*</span> <span class="n">SteamDensity</span>
<a name="ln-1121"></a>                <span class="k">END IF</span>
<a name="ln-1122"></a><span class="k">            END IF</span>
<a name="ln-1123"></a><span class="k">        END IF</span>
<a name="ln-1124"></a>
<a name="ln-1125"></a><span class="k">        CALL </span><span class="n">InitComponentNodes</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1126"></a>                                        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilFluidInletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1127"></a>                                        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilFluidOutletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1128"></a>                                        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1129"></a>                                        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilLoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1130"></a>                                        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1131"></a>                                        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilCompNum</span> <span class="p">)</span>
<a name="ln-1132"></a>    <span class="k">END IF</span>
<a name="ln-1133"></a><span class="k">    IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilFluidInletNode</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1134"></a><span class="k">        IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1135"></a><span class="k">            IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWater</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1136"></a>                <span class="c">! If water coil max water flow rate is autosized, simulate once in order to mine max flow rate</span>
<a name="ln-1137"></a>                <span class="k">CALL </span><span class="n">SimulateWaterCoilComponents</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1138"></a>                                                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">)</span>
<a name="ln-1139"></a>                <span class="n">CoilMaxVolFlowRate</span> <span class="o">=</span> <span class="n">GetCoilMaxWaterFlowRate</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1140"></a>                                                            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-1141"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">CoilMaxVolFlowRate</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Autosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1142"></a><span class="k">                    </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilLoopNum</span><span class="p">)%</span><span class="n">fluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1143"></a>                                        <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1144"></a>                                        <span class="n">PlantLoop</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilLoopNum</span><span class="p">)%</span><span class="n">fluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1145"></a>                                        <span class="s1">&#39;InitUnitarySystems&#39;</span><span class="p">)</span>
<a name="ln-1146"></a>                    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">=</span> <span class="n">CoilMaxVolFlowRate</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-1147"></a>                <span class="k">END IF</span>
<a name="ln-1148"></a><span class="k">            END IF</span>
<a name="ln-1149"></a><span class="k">            IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingSteam</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1150"></a><span class="k">                CALL </span><span class="n">SimulateSteamCoilComponents</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1151"></a>                                                <span class="n">FirstHVACIteration</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-1152"></a>                                                <span class="mf">1.0d0</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">!QCoilReq, simulate any load &gt; 0 to get max capacity</span>
<a name="ln-1153"></a>                                                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span> <span class="n">QActual</span><span class="p">)</span>
<a name="ln-1154"></a>                <span class="n">CoilMaxVolFlowRate</span> <span class="o">=</span> <span class="n">GetCoilMaxSteamFlowRate</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-1155"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">CoilMaxVolFlowRate</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Autosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1156"></a><span class="k">                  </span><span class="n">SteamIndex</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! Function GetSatDensityRefrig will look up steam index if 0 is passed</span>
<a name="ln-1157"></a>                  <span class="n">SteamDensity</span><span class="o">=</span><span class="n">GetSatDensityRefrig</span><span class="p">(</span><span class="s1">&#39;STEAM&#39;</span><span class="p">,</span><span class="n">TempSteamIn</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">SteamIndex</span><span class="p">,</span><span class="s1">&#39;InitUnitarySystems&#39;</span><span class="p">)</span>
<a name="ln-1158"></a>                  <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">=</span> <span class="n">CoilMaxVolFlowRate</span> <span class="o">*</span> <span class="n">SteamDensity</span>
<a name="ln-1159"></a>                <span class="k">END IF</span>
<a name="ln-1160"></a><span class="k">            END IF</span>
<a name="ln-1161"></a><span class="k">            CALL </span><span class="n">InitComponentNodes</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1162"></a>                                        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilFluidInletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1163"></a>                                        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilFluidOutletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1164"></a>                                        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1165"></a>                                        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilLoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1166"></a>                                        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1167"></a>                                        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilCompNum</span> <span class="p">)</span>
<a name="ln-1168"></a>        <span class="k">END IF</span>
<a name="ln-1169"></a><span class="k">    END IF</span>
<a name="ln-1170"></a><span class="k">    IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingGas</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1171"></a>       <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingElectric</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1172"></a><span class="k">      CALL </span><span class="n">SimulateHeatingCoilComponents</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1173"></a>                                <span class="n">CompIndex</span><span class="o">=</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1174"></a>                                <span class="n">QCoilReq</span><span class="o">=</span><span class="mf">1.0d0</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1175"></a>                                <span class="n">FanOpMode</span><span class="o">=</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1176"></a>                                <span class="n">PartLoadRatio</span><span class="o">=</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-1177"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-1178"></a>             <span class="n">GetHeatingCoilCapacity</span><span class="p">(</span><span class="n">CALLCoilTypes</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1179"></a>                                    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1180"></a>    <span class="k">END IF</span>
<a name="ln-1181"></a><span class="k">    </span><span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1182"></a>  <span class="k">END IF</span>
<a name="ln-1183"></a>
<a name="ln-1184"></a><span class="k">  IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">BeginEnvrnFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1185"></a><span class="k">    </span><span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1186"></a>  <span class="k">END IF</span>
<a name="ln-1187"></a>
<a name="ln-1188"></a>  <span class="c">!Init maximum available Heat Recovery flow rate</span>
<a name="ln-1189"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatRecActive</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">))</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1190"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SysAvailSchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1191"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1192"></a><span class="k">        </span><span class="n">mdotHR</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatRecMassFlowRate</span>
<a name="ln-1193"></a>      <span class="k">ELSE</span>
<a name="ln-1194"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatRecoveryMassFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1195"></a><span class="k">          </span><span class="n">mdotHR</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatRecoveryMassFlowRate</span>
<a name="ln-1196"></a>        <span class="k">ELSE</span>
<a name="ln-1197"></a><span class="k">          </span><span class="n">mdotHR</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatRecMassFlowRate</span>
<a name="ln-1198"></a>        <span class="k">END IF</span>
<a name="ln-1199"></a><span class="k">      END IF</span>
<a name="ln-1200"></a><span class="k">    ELSE</span>
<a name="ln-1201"></a><span class="k">      </span><span class="n">mdotHR</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1202"></a>    <span class="k">END IF</span>
<a name="ln-1203"></a>
<a name="ln-1204"></a><span class="k">    </span><span class="n">mdotHR</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatRecoveryOutletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span><span class="p">,</span><span class="n">mdotHR</span><span class="p">)</span>
<a name="ln-1205"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatRecoveryInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">mdotHR</span>
<a name="ln-1206"></a>  <span class="k">END IF</span>
<a name="ln-1207"></a>
<a name="ln-1208"></a>  <span class="c">! get operating capacity of water and steam coil</span>
<a name="ln-1209"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">FirstHVACIteration</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">==</span> <span class="n">DehumidControl_CoolReheat</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1210"></a><span class="k">    IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_CoolingWater</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1211"></a>       <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_CoolingWaterDetailed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1212"></a>      <span class="c">!     set air-side and steam-side mass flow rates</span>
<a name="ln-1213"></a>      <span class="n">mdot</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilFluidOutletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1214"></a>             <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolCoilFluidFlow</span><span class="p">)</span>
<a name="ln-1215"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilFluidInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">mdot</span>
<a name="ln-1216"></a>      <span class="c">!     simulate water coil to find operating capacity</span>
<a name="ln-1217"></a>      <span class="k">CALL </span><span class="n">SimulateWaterCoilComponents</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1218"></a>                                                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="n">QActual</span><span class="p">)</span>
<a name="ln-1219"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignCoolingCapacity</span> <span class="o">=</span> <span class="n">QActual</span>
<a name="ln-1220"></a>    <span class="k">END IF</span> <span class="c">! from IF(UnitarySystem(UnitarySysNum)%CoolingCoilType_Num == Coil_CoolingWater .OR. Coil_CoolingWaterDetailed</span>
<a name="ln-1221"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWater</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1222"></a>      <span class="c">!     set air-side and steam-side mass flow rates</span>
<a name="ln-1223"></a>      <span class="n">mdot</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilFluidOutletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1224"></a>             <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span><span class="p">)</span>
<a name="ln-1225"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilFluidInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">mdot</span>
<a name="ln-1226"></a>      <span class="c">!     simulate water coil to find operating capacity</span>
<a name="ln-1227"></a><span class="c">!      SaveMassFlow = Node(UnitarySystem(UnitarySysNum)%HeatCoilInletNodeNum)%MassFlowRate</span>
<a name="ln-1228"></a><span class="c">!      Node(UnitarySystem(UnitarySysNum)%HeatCoilInletNodeNum)%MassFlowRate = UnitarySystem(UnitarySysNum)%MaxHeatAirMassFlow</span>
<a name="ln-1229"></a>      <span class="k">CALL </span><span class="n">SimulateWaterCoilComponents</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1230"></a>                                                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span> <span class="n">QActual</span><span class="p">)</span>
<a name="ln-1231"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">=</span> <span class="n">QActual</span>
<a name="ln-1232"></a><span class="c">!      Node(UnitarySystem(UnitarySysNum)%HeatCoilInletNodeNum)%MassFlowRate = SaveMassFlow</span>
<a name="ln-1233"></a>    <span class="k">END IF</span> <span class="c">! from IF(UnitarySystem(UnitarySysNum)%HeatingCoilType_Num == Coil_HeatingWater) THEN</span>
<a name="ln-1234"></a>
<a name="ln-1235"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingSteam</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1236"></a>
<a name="ln-1237"></a>      <span class="c">!     set air-side and steam-side mass flow rates</span>
<a name="ln-1238"></a>      <span class="n">mdot</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilFluidOutletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1239"></a>             <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span><span class="p">)</span>
<a name="ln-1240"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilFluidInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">mdot</span>
<a name="ln-1241"></a>
<a name="ln-1242"></a><span class="c">!     simulate steam coil to find operating capacity</span>
<a name="ln-1243"></a>      <span class="k">CALL </span><span class="n">SimulateSteamCoilComponents</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1244"></a>                                       <span class="n">FirstHVACIteration</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-1245"></a>                                       <span class="mf">1.0d0</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">!QCoilReq, simulate any load &gt; 0 to get max capacity of steam coil</span>
<a name="ln-1246"></a>                                       <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span> <span class="n">QActual</span><span class="p">)</span>
<a name="ln-1247"></a>
<a name="ln-1248"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1249"></a>             <span class="n">GetSteamCoilCapacity</span><span class="p">(</span><span class="n">CALLCoilTypes</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1250"></a>                                                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-1251"></a>    <span class="k">END IF</span> <span class="c">! from IF(UnitarySystem(UnitarySysNum)%HeatingCoilType_Num == Coil_HeatingSteam) THEN</span>
<a name="ln-1252"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWater</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1253"></a>      <span class="c">!     set air-side and steam-side mass flow rates</span>
<a name="ln-1254"></a>      <span class="n">mdot</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilFluidOutletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1255"></a>             <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span><span class="p">)</span>
<a name="ln-1256"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilFluidInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">mdot</span>
<a name="ln-1257"></a><span class="c">!      SaveMassFlow = Node(UnitarySystem(UnitarySysNum)%SuppCoilAirInletNode)%MassFlowRate</span>
<a name="ln-1258"></a><span class="c">!      Node(UnitarySystem(UnitarySysNum)%SuppCoilAirInletNode)%MassFlowRate = UnitarySystem(UnitarySysNum)%MaxHeatAirMassFlow</span>
<a name="ln-1259"></a>      <span class="c">!     simulate water coil to find operating capacity</span>
<a name="ln-1260"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">mdot</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1261"></a><span class="c">!        Node(UnitarySystem(UnitarySysNum)%SuppCoilAirInletNode)%MassFlowRate = &amp;</span>
<a name="ln-1262"></a><span class="c">!          UnitarySystem(UnitarySysNum)%MaxHeatAirMassFlow</span>
<a name="ln-1263"></a>        <span class="k">CALL </span><span class="n">SimulateWaterCoilComponents</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1264"></a>                                                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span> <span class="n">QActual</span><span class="p">)</span>
<a name="ln-1265"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span> <span class="o">=</span> <span class="n">QActual</span>
<a name="ln-1266"></a>      <span class="k">ELSE</span>
<a name="ln-1267"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1268"></a>      <span class="k">END IF</span>
<a name="ln-1269"></a><span class="c">!      Node(UnitarySystem(UnitarySysNum)%SuppCoilAirInletNode)%MassFlowRate = SaveMassFlow</span>
<a name="ln-1270"></a>
<a name="ln-1271"></a>    <span class="k">END IF</span> <span class="c">! from IF(UnitarySystem(UnitarySysNum)%SuppHeatCoilType_Num == Coil_HeatingWater) THEN</span>
<a name="ln-1272"></a>
<a name="ln-1273"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingSteam</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1274"></a>
<a name="ln-1275"></a>      <span class="c">!     set air-side and steam-side mass flow rates</span>
<a name="ln-1276"></a>      <span class="n">mdot</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilFluidOutletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1277"></a>             <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span><span class="p">)</span>
<a name="ln-1278"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilFluidInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">mdot</span>
<a name="ln-1279"></a>
<a name="ln-1280"></a><span class="c">!     simulate steam coil to find operating capacity</span>
<a name="ln-1281"></a>      <span class="k">CALL </span><span class="n">SimulateSteamCoilComponents</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1282"></a>                                       <span class="n">FirstHVACIteration</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-1283"></a>                                       <span class="mf">1.0d0</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">!QCoilReq, simulate any load &gt; 0 to get max capacity of steam coil</span>
<a name="ln-1284"></a>                                       <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span> <span class="n">QActual</span><span class="p">)</span>
<a name="ln-1285"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span> <span class="o">=</span> <span class="n">GetSteamCoilCapacity</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Steam&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1286"></a>                                                      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-1287"></a>
<a name="ln-1288"></a>    <span class="k">END IF</span> <span class="c">! from IF(UnitarySystem(UnitarySysNum)%SuppHeatCoilType_Num == Coil_HeatingSteam) THEN</span>
<a name="ln-1289"></a><span class="k">END IF</span> <span class="c">! from IF( FirstHVACIteration ) THEN</span>
<a name="ln-1290"></a>
<a name="ln-1291"></a><span class="k">IF</span><span class="p">(</span><span class="n">MySetPointCheckFlag</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-1292"></a><span class="k">  IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SysSizingCalc</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DOSetPointTest</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1293"></a>
<a name="ln-1294"></a><span class="k">    IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1295"></a><span class="k">      </span><span class="n">ControlNode</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SystemCoolControlNodeNum</span>
<a name="ln-1296"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ControlNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1297"></a><span class="k">        CALL </span><span class="n">CheckNodeSetPoint</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">AirLoopNum</span><span class="p">,</span> <span class="n">ControlNode</span><span class="p">,</span> <span class="n">CoolingCoil</span><span class="p">,</span><span class="n">OAUCoilOutTemp</span><span class="p">)</span>
<a name="ln-1298"></a>      <span class="k">END IF</span>
<a name="ln-1299"></a><span class="k">    END IF</span>
<a name="ln-1300"></a>
<a name="ln-1301"></a><span class="k">    IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1302"></a><span class="k">      </span><span class="n">ControlNode</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SystemHeatControlNodeNum</span>
<a name="ln-1303"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ControlNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1304"></a><span class="k">        CALL </span><span class="n">CheckNodeSetPoint</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">AirLoopNum</span><span class="p">,</span> <span class="n">ControlNode</span><span class="p">,</span><span class="n">HeatingCoil</span><span class="p">,</span><span class="n">OAUCoilOutTemp</span><span class="p">)</span>
<a name="ln-1305"></a>      <span class="k">END IF</span>
<a name="ln-1306"></a><span class="k">    END IF</span>
<a name="ln-1307"></a>
<a name="ln-1308"></a><span class="k">    IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1309"></a><span class="k">      </span><span class="n">ControlNode</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatControlNodeNum</span>
<a name="ln-1310"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ControlNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1311"></a><span class="k">        CALL </span><span class="n">CheckNodeSetPoint</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">AirLoopNum</span><span class="p">,</span> <span class="n">ControlNode</span><span class="p">,</span><span class="n">SuppHeatCoil</span><span class="p">,</span><span class="n">OAUCoilOutTemp</span><span class="p">)</span>
<a name="ln-1312"></a>      <span class="k">END IF</span>
<a name="ln-1313"></a><span class="k">    END IF</span>
<a name="ln-1314"></a>
<a name="ln-1315"></a><span class="k">    </span><span class="n">MySetPointCheckFlag</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1316"></a>  <span class="k">END IF</span>
<a name="ln-1317"></a><span class="k">END IF</span>
<a name="ln-1318"></a>
<a name="ln-1319"></a><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingPartLoadFrac</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1320"></a><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingPartLoadFrac</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1321"></a><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatPartLoadFrac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1322"></a><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCycRatio</span>      <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1323"></a><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1324"></a><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedNum</span>      <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1325"></a><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCycRatio</span>      <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1326"></a><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1327"></a><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedNum</span>      <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1328"></a><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilSensDemand</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1329"></a><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilSensDemand</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1330"></a><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilLatentDemand</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1331"></a><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DehumidInducedHeatingDemandRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1332"></a>
<a name="ln-1333"></a><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">InitHeatPump</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1334"></a>
<a name="ln-1335"></a><span class="k">RETURN</span>
<a name="ln-1336"></a><span class="k">END SUBROUTINE </span><span class="n">InitUnitarySystems</span>
<a name="ln-1337"></a>
<a name="ln-1338"></a><span class="k">SUBROUTINE </span><span class="n">CheckNodeSetPoint</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">AirLoopNum</span><span class="p">,</span> <span class="n">ControlNode</span><span class="p">,</span> <span class="n">CoilType</span><span class="p">,</span><span class="n">OAUCoilOutTemp</span><span class="p">)</span>
<a name="ln-1339"></a>
<a name="ln-1340"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1341"></a>          <span class="c">!       AUTHOR         Richard Raustad</span>
<a name="ln-1342"></a>          <span class="c">!       DATE WRITTEN   March 2013</span>
<a name="ln-1343"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1344"></a>
<a name="ln-1345"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1346"></a>          <span class="c">! This subroutine checks for proper set point at control node.</span>
<a name="ln-1347"></a>
<a name="ln-1348"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1349"></a>          <span class="c">! Uses the control node to test for set point.</span>
<a name="ln-1350"></a>
<a name="ln-1351"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1352"></a>          <span class="c">! na</span>
<a name="ln-1353"></a>
<a name="ln-1354"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1355"></a>  <span class="k">USE </span><span class="n">EMSManager</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">iTemperatureSetpoint</span><span class="p">,</span> <span class="n">CheckIfNodeSetpointManagedByEMS</span><span class="p">,</span> <span class="n">iHumidityRatioMaxSetpoint</span>
<a name="ln-1356"></a>
<a name="ln-1357"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1358"></a>
<a name="ln-1359"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1360"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UnitarySysNum</span>               <span class="c">! number of the current DX Sys being simulated</span>
<a name="ln-1361"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirLoopNum</span>                  <span class="c">! number of the current air loop being simulated</span>
<a name="ln-1362"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ControlNode</span>                 <span class="c">! Node to test for set point</span>
<a name="ln-1363"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilType</span>                    <span class="c">! True if cooling coil, then test for HumRatMax set point</span>
<a name="ln-1364"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">OAUCoilOutTemp</span>   <span class="c">! the coil inlet temperature of OutdoorAirUnit</span>
<a name="ln-1365"></a>
<a name="ln-1366"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1367"></a>          <span class="c">! na</span>
<a name="ln-1368"></a>
<a name="ln-1369"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-1370"></a>          <span class="c">! na</span>
<a name="ln-1371"></a>
<a name="ln-1372"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-1373"></a>          <span class="c">! na</span>
<a name="ln-1374"></a>
<a name="ln-1375"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1376"></a>          <span class="c">! na</span>
<a name="ln-1377"></a>
<a name="ln-1378"></a><span class="k">IF</span> <span class="p">(</span><span class="n">AirLoopNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>                           <span class="c">! Outdoor Air Unit</span>
<a name="ln-1379"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">ControlNode</span><span class="p">)%</span><span class="n">TempSetPoint</span> <span class="o">=</span> <span class="n">OAUCoilOutTemp</span>     <span class="c">! Set the coil outlet temperature</span>
<a name="ln-1380"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ISHundredPercentDOASDXCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1381"></a><span class="k">    CALL </span><span class="n">FrostControlSetPointLimit</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesiredOutletTemp</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">ControlNode</span><span class="p">)%</span><span class="n">HumRatMax</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1382"></a>                                   <span class="n">OutBaroPress</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DOASDXCoolingCoilMinTout</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1383"></a>  <span class="k">END IF</span>
<a name="ln-1384"></a><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">AirLoopNum</span> <span class="o">/=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Not an Outdoor air unit</span>
<a name="ln-1385"></a>
<a name="ln-1386"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">ControlNode</span><span class="p">)%</span><span class="n">TempSetPoint</span> <span class="o">==</span> <span class="n">SensedNodeFlagValue</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1387"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlType</span> <span class="o">==</span> <span class="n">SetPointBased</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1388"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">AnyEnergyManagementSystemInModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1389"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1390"></a>                       <span class="s1">&#39;: Missing temperature setpoint for unitary system = &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1391"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  use a Setpoint Manager to establish a setpoint at the coil control node.&#39;</span><span class="p">)</span>
<a name="ln-1392"></a>      <span class="n">SetPointErrorFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1393"></a>    <span class="k">ELSE</span>
<a name="ln-1394"></a><span class="k">      CALL </span><span class="n">CheckIfNodeSetpointManagedByEMS</span><span class="p">(</span><span class="n">ControlNode</span><span class="p">,</span><span class="n">iTemperatureSetpoint</span><span class="p">,</span> <span class="n">SetpointErrorFlag</span><span class="p">)</span>
<a name="ln-1395"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SetpointErrorFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1396"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1397"></a>                       <span class="s1">&#39;: Missing temperature setpoint for unitary system = &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1398"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  use a Setpoint Manager to establish a setpoint at the coil control node.&#39;</span><span class="p">)</span>
<a name="ln-1399"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  or use an EMS actuator to establish a temperature setpoint at the coil control node.&#39;</span><span class="p">)</span>
<a name="ln-1400"></a>      <span class="k">END IF</span>
<a name="ln-1401"></a><span class="k">    END IF</span>
<a name="ln-1402"></a><span class="k">  END IF</span>
<a name="ln-1403"></a><span class="k">  IF</span> <span class="p">((</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">DehumidControl_None</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1404"></a>      <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">ControlNode</span><span class="p">)%</span><span class="n">HumRatMax</span> <span class="o">==</span> <span class="n">SensedNodeFlagValue</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1405"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlType</span> <span class="o">==</span> <span class="n">SetPointBased</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">CoilType</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CoolingCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1406"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">AnyEnergyManagementSystemInModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1407"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1408"></a>                       <span class="s1">&#39;: Missing humidity ratio setpoint (HUMRATMAX) for unitary system = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1409"></a>                                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1410"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  use a Setpoint Manager to establish a setpoint at the coil control node.&#39;</span><span class="p">)</span>
<a name="ln-1411"></a>      <span class="n">SetPointErrorFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1412"></a>    <span class="k">ELSE</span>
<a name="ln-1413"></a><span class="k">      CALL </span><span class="n">CheckIfNodeSetpointManagedByEMS</span><span class="p">(</span><span class="n">ControlNode</span><span class="p">,</span><span class="n">iHumidityRatioMaxSetpoint</span><span class="p">,</span> <span class="n">SetpointErrorFlag</span><span class="p">)</span>
<a name="ln-1414"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SetpointErrorFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1415"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1416"></a>                       <span class="s1">&#39;: Missing maximum humidity ratio setpoint (HUMRATMAX) for unitary system = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1417"></a>                                 <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1418"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  use a Setpoint Manager to establish a setpoint at the coil control node.&#39;</span><span class="p">)</span>
<a name="ln-1419"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  or use an EMS actuator to establish a maximum humidity ratio setpoint.&#39;</span><span class="p">)</span>
<a name="ln-1420"></a>      <span class="k">END IF</span>
<a name="ln-1421"></a><span class="k">    END IF</span>
<a name="ln-1422"></a>
<a name="ln-1423"></a><span class="k">  END IF</span>
<a name="ln-1424"></a><span class="k">END IF</span>
<a name="ln-1425"></a>
<a name="ln-1426"></a>
<a name="ln-1427"></a><span class="k">RETURN</span>
<a name="ln-1428"></a><span class="k">END SUBROUTINE </span><span class="n">CheckNodeSetPoint</span>
<a name="ln-1429"></a>
<a name="ln-1430"></a><span class="k">SUBROUTINE </span><span class="n">UpdateUnitarySystemControl</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">AirLoopNum</span><span class="p">,</span><span class="n">OutNode</span><span class="p">,</span><span class="n">ControlNode</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1431"></a>                                    <span class="n">OAUCoilOutletTemp</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">ZoneLoad</span><span class="p">,</span><span class="n">MaxOutletTemp</span><span class="p">)</span>
<a name="ln-1432"></a>
<a name="ln-1433"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1434"></a>          <span class="c">!       AUTHOR         Richard Raustad, FSEC</span>
<a name="ln-1435"></a>          <span class="c">!       DATE WRITTEN   February 2013</span>
<a name="ln-1436"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1437"></a>
<a name="ln-1438"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1439"></a>          <span class="c">! This subroutine is for sizing unitary systems.</span>
<a name="ln-1440"></a>
<a name="ln-1441"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1442"></a>          <span class="c">! Either CALL the coil model to get the size or size coil.</span>
<a name="ln-1443"></a>          <span class="c">! Current method is to use same methodology as is used in coil objects.</span>
<a name="ln-1444"></a>          <span class="c">! Future changes will include a common sizing algorithm and push the calculated</span>
<a name="ln-1445"></a>          <span class="c">! size to the coil object prior to first call (so the coil will not autosize).</span>
<a name="ln-1446"></a>
<a name="ln-1447"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1448"></a>          <span class="c">! na</span>
<a name="ln-1449"></a>
<a name="ln-1450"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1451"></a>  <span class="k">USE </span><span class="n">DataAirLoop</span><span class="p">,</span>           <span class="n">ONLY</span><span class="p">:</span> <span class="n">AirLoopControlInfo</span>
<a name="ln-1452"></a>  <span class="k">USE </span><span class="n">Psychrometrics</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">PsyHfgAirFnWTdb</span>
<a name="ln-1453"></a>  <span class="k">USE </span><span class="n">DataHeatBalFanSys</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">TempControlType</span>
<a name="ln-1454"></a>  <span class="k">USE </span><span class="n">DataZoneEnergyDemands</span>
<a name="ln-1455"></a>
<a name="ln-1456"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1457"></a>
<a name="ln-1458"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1459"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">UnitarySysNum</span>                <span class="c">! number of the current DX Sys being simulated</span>
<a name="ln-1460"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">AirLoopNum</span>                   <span class="c">! number of the current air loop being simulated</span>
<a name="ln-1461"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">OutNode</span>                      <span class="c">! coil outlet node number</span>
<a name="ln-1462"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">ControlNode</span>                  <span class="c">! control node number</span>
<a name="ln-1463"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">FirstHVACIteration</span>
<a name="ln-1464"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OAUCoilOutletTemp</span>            <span class="c">! &quot;ONLY&quot; for zoneHVAC:OutdoorAirUnit</span>
<a name="ln-1465"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>
<a name="ln-1466"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">INOUT</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">ZoneLoad</span>
<a name="ln-1467"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">OPTIONAL</span>    <span class="kd">::</span> <span class="n">MaxOutletTemp</span>   <span class="c">! limits heating coil outlet temp [C]</span>
<a name="ln-1468"></a>
<a name="ln-1469"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1470"></a>          <span class="c">! na</span>
<a name="ln-1471"></a>
<a name="ln-1472"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-1473"></a>          <span class="c">! na</span>
<a name="ln-1474"></a>
<a name="ln-1475"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-1476"></a>          <span class="c">! na</span>
<a name="ln-1477"></a>
<a name="ln-1478"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1479"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ControlType</span>
<a name="ln-1480"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">H2OHtOfVap</span>                  <span class="c">! Heat of vaporization of air</span>
<a name="ln-1481"></a>
<a name="ln-1482"></a><span class="n">ControlType</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlType</span>
<a name="ln-1483"></a><span class="c">! These initializations are done every iteration</span>
<a name="ln-1484"></a>
<a name="ln-1485"></a><span class="k">SELECT CASE</span><span class="p">(</span><span class="n">ControlType</span><span class="p">)</span>
<a name="ln-1486"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">LoadBased</span><span class="p">)</span>
<a name="ln-1487"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">AirLoopNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! This IF-THEN routine is just for ZoneHVAC:OutdoorAirUnit</span>
<a name="ln-1488"></a>      <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1489"></a>                            <span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1490"></a>      <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;...Load based control is not allowed when used with ZoneHVAC:OutdoorAirUnit&#39;</span><span class="p">)</span>
<a name="ln-1491"></a>    <span class="k">END IF</span>
<a name="ln-1492"></a>
<a name="ln-1493"></a>  <span class="c">! here we need to deal with sequenced zone equip</span>
<a name="ln-1494"></a>    <span class="n">HeatingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1495"></a>    <span class="n">CoolingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1496"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ZoneSequenceCoolingNum</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ZoneSequenceHeatingNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1497"></a><span class="k">      </span><span class="n">QToCoolSetPt</span> <span class="o">=</span> <span class="n">ZoneSysEnergyDemand</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)%&amp;</span>
<a name="ln-1498"></a>                  <span class="n">SequencedOutputRequiredToCoolingSP</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ZoneSequenceCoolingNum</span><span class="p">)</span>
<a name="ln-1499"></a>      <span class="n">QToHeatSetPt</span> <span class="o">=</span> <span class="n">ZoneSysEnergyDemand</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)%&amp;</span>
<a name="ln-1500"></a>                  <span class="n">SequencedOutputRequiredToHeatingSP</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ZoneSequenceHeatingNum</span><span class="p">)</span>
<a name="ln-1501"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">QToHeatSetPt</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">QToCoolSetPt</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1502"></a>          <span class="n">TempControlType</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">SingleCoolingSetPoint</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1503"></a><span class="k">        </span><span class="n">ZoneLoad</span> <span class="o">=</span> <span class="n">QToHeatSetPt</span>
<a name="ln-1504"></a>        <span class="n">HeatingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1505"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">QToHeatSetPt</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">QToCoolSetPt</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1506"></a>          <span class="n">TempControlType</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">SingleCoolingSetPoint</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1507"></a><span class="k">        </span><span class="n">ZoneLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1508"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">QToHeatSetPt</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">QToCoolSetPt</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1509"></a>          <span class="n">TempControlType</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">SingleHeatingSetPoint</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1510"></a><span class="k">        </span><span class="n">ZoneLoad</span> <span class="o">=</span> <span class="n">QToCoolSetPt</span>
<a name="ln-1511"></a>        <span class="n">CoolingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1512"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">QToHeatSetPt</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">QToCoolSetPt</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1513"></a>          <span class="n">TempControlType</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">SingleHeatingSetPoint</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1514"></a><span class="k">        </span><span class="n">ZoneLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1515"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">QToHeatSetPt</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">QToCoolSetPt</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1516"></a><span class="k">        </span><span class="n">ZoneLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1517"></a>      <span class="k">END IF</span>
<a name="ln-1518"></a><span class="k">      </span><span class="n">MoistureLoad</span> <span class="o">=</span> <span class="n">ZoneSysMoistureDemand</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)%</span> <span class="p">&amp;</span>
<a name="ln-1519"></a>                     <span class="n">SequencedOutputRequiredToDehumidSP</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ZoneSequenceCoolingNum</span><span class="p">)</span>
<a name="ln-1520"></a>    <span class="k">ELSE</span>
<a name="ln-1521"></a><span class="k">      </span><span class="n">ZoneLoad</span><span class="o">=</span> <span class="n">ZoneSysEnergyDemand</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)%</span><span class="n">RemainingOutputRequired</span>
<a name="ln-1522"></a>      <span class="n">QToCoolSetPt</span><span class="o">=</span><span class="n">ZoneSysEnergyDemand</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)%</span><span class="n">OutputRequiredToCoolingSP</span>
<a name="ln-1523"></a>      <span class="n">QToHeatSetPt</span><span class="o">=</span><span class="n">ZoneSysEnergyDemand</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)%</span><span class="n">OutputRequiredToHeatingSP</span>
<a name="ln-1524"></a>      <span class="n">MoistureLoad</span> <span class="o">=</span> <span class="n">ZoneSysMoistureDemand</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)%</span><span class="n">OutputRequiredToDehumidIFyingSP</span>
<a name="ln-1525"></a>    <span class="k">END IF</span>
<a name="ln-1526"></a>
<a name="ln-1527"></a><span class="k">    IF</span> <span class="p">(</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">DehumidControl_None</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1528"></a><span class="k">      </span><span class="n">H2OHtOfVap</span> <span class="o">=</span> <span class="n">PsyHfgAirFnWTdb</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NodeNumofControlledZone</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">,&amp;</span>
<a name="ln-1529"></a>                        <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NodeNumofControlledZone</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="s1">&#39;UpdateUnitarySystemControl&#39;</span><span class="p">)</span>
<a name="ln-1530"></a>
<a name="ln-1531"></a>      <span class="c">! positive MoistureLoad means no dehumidification load</span>
<a name="ln-1532"></a>      <span class="n">MoistureLoad</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">MoistureLoad</span> <span class="o">*</span> <span class="n">H2OHtOfVap</span><span class="p">)</span>
<a name="ln-1533"></a>    <span class="k">ELSE</span>
<a name="ln-1534"></a><span class="k">      </span><span class="n">MoistureLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1535"></a>    <span class="k">END IF</span>
<a name="ln-1536"></a>
<a name="ln-1537"></a><span class="k">    CALL </span><span class="n">InitLoadBasedControl</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">AirLoopNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">ZoneLoad</span><span class="p">)</span>
<a name="ln-1538"></a>
<a name="ln-1539"></a>    <span class="c">! EMS override point</span>
<a name="ln-1540"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">EMSOverrideSensZoneLoadRequest</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1541"></a>      <span class="n">ZoneLoad</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">EMSSensibleZoneLoadValue</span>
<a name="ln-1542"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">EMSOverrideMoistZoneLoadRequest</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1543"></a>      <span class="n">MoistureLoad</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">EMSMoistureZoneLoadValue</span>
<a name="ln-1544"></a>
<a name="ln-1545"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">SetPointBased</span><span class="p">)</span>
<a name="ln-1546"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">AirLoopNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! This IF-THEN routine is just for ZoneHVAC:OutdoorAIRUNIT</span>
<a name="ln-1547"></a>
<a name="ln-1548"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ControlNode</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1549"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesiredOutletTemp</span> <span class="o">=</span> <span class="n">OAUCoilOutletTemp</span>
<a name="ln-1550"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesiredOutletHumRat</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-1551"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">ControlNode</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">OutNode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1552"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesiredOutletTemp</span> <span class="o">=</span><span class="n">OAUCoilOutletTemp</span>
<a name="ln-1553"></a>      <span class="k">END IF</span>
<a name="ln-1554"></a>      <span class="c">! If the unitary system is an equipment of Outdoor Air Unit, the desired coil outlet humidity level is set to zero</span>
<a name="ln-1555"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesiredOutletHumRat</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-1556"></a>
<a name="ln-1557"></a>    <span class="k">ELSE</span> <span class="c">! Not Outdoor Air Unit or zone equipment</span>
<a name="ln-1558"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">AirLoopNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="n">EconomizerFlag</span> <span class="o">=</span> <span class="n">AirLoopControlInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">EconoActive</span>
<a name="ln-1559"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ControlNode</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1560"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesiredOutletTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1561"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesiredOutletHumRat</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-1562"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">ControlNode</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">OutNode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1563"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ISHundredPercentDOASDXCoil</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RunOnSensibleLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1564"></a><span class="k">          CALL </span><span class="n">FrostControlSetPointLimit</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">Node</span><span class="p">(</span><span class="n">ControlNode</span><span class="p">)%</span><span class="n">TempSetPoint</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">ControlNode</span><span class="p">)%</span><span class="n">HumRatMax</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1565"></a>                                         <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DOASDXCoolingCoilMinTout</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1566"></a>        <span class="k">END IF</span>
<a name="ln-1567"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesiredOutletTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">ControlNode</span><span class="p">)%</span><span class="n">TempSetPoint</span>
<a name="ln-1568"></a>        <span class="c">!  IF HumRatMax is zero, then there is no request from SetpointManager:SingleZone:Humidity:Maximum</span>
<a name="ln-1569"></a>        <span class="k">IF</span> <span class="p">((</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">DehumidControl_None</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1570"></a>            <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">ControlNode</span><span class="p">)%</span><span class="n">HumRatMax</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1571"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ISHundredPercentDOASDXCoil</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RunOnLatentLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1572"></a><span class="k">            CALL </span><span class="n">FrostControlSetPointLimit</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">ControlNode</span><span class="p">)%</span><span class="n">TempSetPoint</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">ControlNode</span><span class="p">)%</span><span class="n">HumRatMax</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1573"></a>                                           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DOASDXCoolingCoilMinTout</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1574"></a>          <span class="k">END IF</span>
<a name="ln-1575"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesiredOutletHumRat</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">ControlNode</span><span class="p">)%</span><span class="n">HumRatMax</span>
<a name="ln-1576"></a>        <span class="k">ELSE</span>
<a name="ln-1577"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesiredOutletHumRat</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-1578"></a>        <span class="k">END IF</span>
<a name="ln-1579"></a><span class="k">      ELSE</span>
<a name="ln-1580"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ISHundredPercentDOASDXCoil</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RunOnSensibleLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1581"></a><span class="k">          CALL </span><span class="n">FrostControlSetPointLimit</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">ControlNode</span><span class="p">)%</span><span class="n">TempSetPoint</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">ControlNode</span><span class="p">)%</span><span class="n">HumRatMax</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1582"></a>                                         <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DOASDXCoolingCoilMinTout</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1583"></a>        <span class="k">END IF</span>
<a name="ln-1584"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesiredOutletTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">ControlNode</span><span class="p">)%</span><span class="n">TempSetPoint</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-1585"></a>          <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">ControlNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">-</span> <span class="n">Node</span><span class="p">(</span><span class="n">OutNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">)</span>
<a name="ln-1586"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">DehumidControl_None</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1587"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ISHundredPercentDOASDXCoil</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RunOnLatentLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1588"></a><span class="k">            CALL </span><span class="n">FrostControlSetPointLimit</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">ControlNode</span><span class="p">)%</span><span class="n">TempSetPoint</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">ControlNode</span><span class="p">)%</span><span class="n">HumRatMax</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1589"></a>                                           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DOASDXCoolingCoilMinTout</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1590"></a>          <span class="k">END IF</span>
<a name="ln-1591"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesiredOutletHumRat</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">ControlNode</span><span class="p">)%</span><span class="n">HumRatMax</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-1592"></a>            <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">ControlNode</span><span class="p">)%</span><span class="n">HumRat</span> <span class="o">-</span> <span class="n">Node</span><span class="p">(</span><span class="n">OutNode</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">)</span>
<a name="ln-1593"></a>        <span class="k">ELSE</span>
<a name="ln-1594"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesiredOutletHumRat</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-1595"></a>        <span class="k">END IF</span>
<a name="ln-1596"></a><span class="k">      END IF</span>
<a name="ln-1597"></a><span class="k">    END IF</span>
<a name="ln-1598"></a><span class="k">    IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">MaxOutletTemp</span><span class="p">))</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesiredOutletTemp</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1599"></a>        <span class="nb">MIN</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesiredOutletTemp</span><span class="p">,</span><span class="n">MaxOutletTemp</span><span class="p">)</span>
<a name="ln-1600"></a>
<a name="ln-1601"></a>  <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1602"></a>
<a name="ln-1603"></a><span class="k">END SELECT</span>
<a name="ln-1604"></a>
<a name="ln-1605"></a><span class="k">RETURN</span>
<a name="ln-1606"></a><span class="k">END SUBROUTINE </span><span class="n">UpdateUnitarySystemControl</span>
<a name="ln-1607"></a>
<a name="ln-1608"></a><span class="k">SUBROUTINE </span><span class="n">InitLoadBasedControl</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">AirLoopNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">ZoneLoad</span><span class="p">)</span>
<a name="ln-1609"></a>
<a name="ln-1610"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1611"></a>          <span class="c">!       AUTHOR         Richard Raustad, FSEC</span>
<a name="ln-1612"></a>          <span class="c">!       DATE WRITTEN   February 2013</span>
<a name="ln-1613"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1614"></a>
<a name="ln-1615"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1616"></a>          <span class="c">! This subroutine is for initializations of the load controlled Unitary Systems.</span>
<a name="ln-1617"></a>
<a name="ln-1618"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1619"></a>          <span class="c">! Initialize mass flow rates and speed ratios. Calculate loads and adjust if necessary when using constant fan.</span>
<a name="ln-1620"></a>
<a name="ln-1621"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1622"></a>          <span class="c">! na</span>
<a name="ln-1623"></a>
<a name="ln-1624"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1625"></a>  <span class="k">USE </span><span class="n">DataAirLoop</span><span class="p">,</span>           <span class="n">ONLY</span><span class="p">:</span> <span class="n">AirLoopControlInfo</span><span class="p">,</span> <span class="n">AirToZoneNodeInfo</span>
<a name="ln-1626"></a>  <span class="k">USE </span><span class="n">Fans</span><span class="p">,</span>                  <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetFanDesignVolumeFlowRate</span><span class="p">,</span> <span class="n">GetFanSpeedRatioCurveIndex</span>
<a name="ln-1627"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>               <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span><span class="p">,</span> <span class="n">TrimSigDigits</span>
<a name="ln-1628"></a>  <span class="k">USE </span><span class="n">DataHeatBalance</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">Zone</span>
<a name="ln-1629"></a>  <span class="k">USE </span><span class="n">DataHeatBalFanSys</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">TempControlType</span>
<a name="ln-1630"></a>  <span class="k">USE </span><span class="n">DataAirflowNetwork</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateAirflowNetwork</span><span class="p">,</span> <span class="n">AirflowNetworkControlMultizone</span><span class="p">,</span> <span class="n">AirflowNetworkFanActivated</span>
<a name="ln-1631"></a>  <span class="k">USE </span><span class="n">Psychrometrics</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">PsyHFnTdbW</span>
<a name="ln-1632"></a>  <span class="k">USE </span><span class="n">ReportSizingManager</span><span class="p">,</span>   <span class="n">ONLY</span><span class="p">:</span> <span class="n">ReportSizingOutput</span>
<a name="ln-1633"></a>  <span class="k">USE </span><span class="n">WaterCoils</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCoilMaxWaterFlowRate</span><span class="p">,</span> <span class="n">SimulateWaterCoilComponents</span>
<a name="ln-1634"></a>  <span class="k">USE </span><span class="n">SteamCoils</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCoilMaxSteamFlowRate</span><span class="p">,</span> <span class="n">SimulateSteamCoilComponents</span>
<a name="ln-1635"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>             <span class="n">ONLY</span><span class="p">:</span> <span class="n">PlantLoop</span>
<a name="ln-1636"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetDensityGlycol</span><span class="p">,</span> <span class="n">GetSatDensityRefrig</span>
<a name="ln-1637"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">SetComponentFlowRate</span><span class="p">,</span> <span class="n">InitComponentNodes</span>
<a name="ln-1638"></a>  <span class="k">USE </span><span class="n">DataZoneEnergyDemands</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ZoneSysEnergyDemand</span><span class="p">,</span> <span class="n">CurDeadbandOrSetback</span><span class="p">,</span> <span class="n">SetBack</span>
<a name="ln-1639"></a>  <span class="k">USE </span><span class="n">DataZoneControls</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">StageZoneLogic</span>
<a name="ln-1640"></a>  <span class="k">USE </span><span class="n">BranchInputManager</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">CheckSystemBranchFlow</span>
<a name="ln-1641"></a>
<a name="ln-1642"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1643"></a>
<a name="ln-1644"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1645"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">UnitarySysNum</span>       <span class="c">! number of the current DX Sys being simulated</span>
<a name="ln-1646"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">AirLoopNum</span>          <span class="c">! number of the current air loop being simulated</span>
<a name="ln-1647"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">FirstHVACIteration</span>
<a name="ln-1648"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>
<a name="ln-1649"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ZoneLoad</span>
<a name="ln-1650"></a>
<a name="ln-1651"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1652"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Small5WLoad</span> <span class="o">=</span> <span class="mf">5.0d0</span>
<a name="ln-1653"></a>
<a name="ln-1654"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-1655"></a>          <span class="c">! na</span>
<a name="ln-1656"></a>
<a name="ln-1657"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-1658"></a>          <span class="c">! na</span>
<a name="ln-1659"></a>
<a name="ln-1660"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1661"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyEnvrnFlag</span>             <span class="c">! environment flag</span>
<a name="ln-1662"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyFanFlag</span>               <span class="c">! used for sizing fan inputs one time</span>
<a name="ln-1663"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyCheckFlag</span>             <span class="c">! Used to obtain the zone inlet node number</span>
<a name="ln-1664"></a>                                                                     <span class="c">! in the controlled zone</span>
<a name="ln-1665"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyFlowFracFlag</span>          <span class="c">! Used for calculatig flow fraction once</span>
<a name="ln-1666"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyStagedFlag</span>            <span class="c">! used for finding on staged thermostat</span>
<a name="ln-1667"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span>                 <span class="kd">::</span> <span class="n">MyOneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>  <span class="c">! one time allocation flag</span>
<a name="ln-1668"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span>                 <span class="kd">::</span> <span class="n">MyAirLoopPass</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>  <span class="c">! one time allocation flag</span>
<a name="ln-1669"></a>  <span class="kt">INTEGER</span>                       <span class="kd">::</span> <span class="n">AirLoopPass</span>   <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Number of air loop pass</span>
<a name="ln-1670"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">FanType</span>                 <span class="c">! used in warning messages</span>
<a name="ln-1671"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">FanName</span>                 <span class="c">! used in warning messages</span>
<a name="ln-1672"></a>  <span class="kt">LOGICAL</span>                       <span class="kd">::</span> <span class="n">ErrFlag</span>                 <span class="c">! error flag for mining functions</span>
<a name="ln-1673"></a>  <span class="kt">LOGICAL</span>                       <span class="kd">::</span> <span class="n">ErrorsFound</span>             <span class="c">! error flag for mining functions</span>
<a name="ln-1674"></a>  <span class="kt">INTEGER</span>                       <span class="kd">::</span> <span class="n">ZoneInNode</span>              <span class="c">! Zone inlet node number in the controlled zone</span>
<a name="ln-1675"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">MinHumRat</span>               <span class="c">! Minimum humidity ratio for sensible capacity calculation (kg/kg)</span>
<a name="ln-1676"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">DeltaMassRate</span>           <span class="c">! DIFference of mass flow rate between</span>
<a name="ln-1677"></a>                                                           <span class="c">! inlet node and system outlet node</span>
<a name="ln-1678"></a>  <span class="kt">INTEGER</span>                       <span class="kd">::</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span>                   <span class="c">! index to get the zone inlet node</span>
<a name="ln-1679"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">MassFlowRate</span>            <span class="c">! mass flow rate to calculate loss</span>
<a name="ln-1680"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">MaxTemp</span>                 <span class="c">! Maximum temperature used in latent loss calculation</span>
<a name="ln-1681"></a>  <span class="kt">INTEGER</span>                       <span class="kd">::</span> <span class="n">EquipNum</span>              <span class="o">=</span> <span class="mi">0</span>                    <span class="c">! local DO loop index for zone equipment</span>
<a name="ln-1682"></a>  <span class="kt">INTEGER</span>                       <span class="kd">::</span> <span class="n">ZoneInSysIndex</span>        <span class="o">=</span> <span class="mi">0</span>                    <span class="c">! number of zone inlet nodes counter in an airloop</span>
<a name="ln-1683"></a>  <span class="kt">INTEGER</span>                       <span class="kd">::</span> <span class="n">NumAirLoopZones</span>       <span class="o">=</span> <span class="mi">0</span>                    <span class="c">! number of zone inlet nodes in an air loop</span>
<a name="ln-1684"></a>  <span class="kt">INTEGER</span>                       <span class="kd">::</span> <span class="n">ZoneInletNodeNum</span>      <span class="o">=</span> <span class="mi">0</span>                    <span class="c">! zone inlet nodes node number</span>
<a name="ln-1685"></a>  <span class="kt">LOGICAL</span>                       <span class="kd">::</span> <span class="n">FlowFracFlagReady</span>     <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>               <span class="c">! one time flag for calculating flow fraction</span>
<a name="ln-1686"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">SumOfMassFlowRateMax</span>  <span class="o">=</span> <span class="mf">0.0d0</span>                <span class="c">! the sum of zone inlet mass flow rates</span>
<a name="ln-1687"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">CntrlZoneTerminalUnitMassFlowRateMax</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Maximum mass flow rate through controlled zone</span>
<a name="ln-1688"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">rho</span>
<a name="ln-1689"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">QZnReq</span>
<a name="ln-1690"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">QActual</span>
<a name="ln-1691"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">CoilMaxVolFlowRate</span>
<a name="ln-1692"></a>  <span class="kt">INTEGER</span>                       <span class="kd">::</span> <span class="n">SteamIndex</span>
<a name="ln-1693"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">SteamDensity</span>
<a name="ln-1694"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">SensOutputOff</span>
<a name="ln-1695"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">LatOutputOff</span>
<a name="ln-1696"></a>  <span class="kt">LOGICAL</span>                       <span class="kd">::</span> <span class="n">HXUnitOn</span>
<a name="ln-1697"></a>
<a name="ln-1698"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MyOneTimeFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1699"></a>
<a name="ln-1700"></a>    <span class="c">! initialize the environment and sizing flags</span>
<a name="ln-1701"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">NumUnitarySystem</span><span class="p">))</span>
<a name="ln-1702"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MyFanFlag</span><span class="p">(</span><span class="n">NumUnitarySystem</span><span class="p">))</span>
<a name="ln-1703"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MyCheckFlag</span><span class="p">(</span><span class="n">NumUnitarySystem</span><span class="p">))</span>
<a name="ln-1704"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MyFlowFracFlag</span><span class="p">(</span><span class="n">NumUnitarySystem</span><span class="p">))</span>
<a name="ln-1705"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MyStagedFlag</span><span class="p">(</span><span class="n">NumUnitarySystem</span><span class="p">))</span>
<a name="ln-1706"></a>
<a name="ln-1707"></a>    <span class="n">MyEnvrnFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1708"></a>    <span class="n">MyFanFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1709"></a>    <span class="n">MyCheckFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1710"></a>    <span class="n">MyFlowFracFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1711"></a>    <span class="n">MyOneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1712"></a>    <span class="n">MyStagedFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1713"></a>
<a name="ln-1714"></a>  <span class="k">END IF</span>
<a name="ln-1715"></a>
<a name="ln-1716"></a><span class="c">! do the Begin Environment initializations</span>
<a name="ln-1717"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">BeginEnvrnFlag</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1718"></a>
<a name="ln-1719"></a><span class="c">!   set fluid-side hardware limits</span>
<a name="ln-1720"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilFluidInletNode</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1721"></a>
<a name="ln-1722"></a><span class="k">        IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1723"></a>            <span class="c">! IF water coil max water flow rate is autosized, simulate once in order to mine max flow rate</span>
<a name="ln-1724"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWater</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1725"></a><span class="k">                CALL </span><span class="n">SimulateWaterCoilComponents</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1726"></a>                                                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">)</span>
<a name="ln-1727"></a>                <span class="n">CoilMaxVolFlowRate</span> <span class="o">=</span> <span class="n">GetCoilMaxWaterFlowRate</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1728"></a>                                                             <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-1729"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">CoilMaxVolFlowRate</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Autosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1730"></a><span class="k">                    </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilLoopNum</span><span class="p">)%</span><span class="n">fluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1731"></a>                                            <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1732"></a>                                            <span class="n">PlantLoop</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilLoopNum</span><span class="p">)%</span><span class="n">fluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1733"></a>                                            <span class="s1">&#39;InitUnitarySystems&#39;</span><span class="p">)</span>
<a name="ln-1734"></a>                    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="o">=</span> <span class="n">CoilMaxVolFlowRate</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-1735"></a>                <span class="k">END IF</span>
<a name="ln-1736"></a><span class="k">            END IF</span>
<a name="ln-1737"></a>            <span class="c">! IF steam coil max steam flow rate is autosized, simulate once in order to mine max flow rate</span>
<a name="ln-1738"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingSteam</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1739"></a><span class="k">                CALL </span><span class="n">SimulateSteamCoilComponents</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1740"></a>                                                <span class="n">FirstHVACIteration</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-1741"></a>                                                <span class="mf">1.0d0</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">!QCoilReq, simulate any load &gt; 0 to get max capacity</span>
<a name="ln-1742"></a>                                                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span> <span class="n">QActual</span><span class="p">)</span>
<a name="ln-1743"></a>                <span class="n">CoilMaxVolFlowRate</span> <span class="o">=</span> <span class="n">GetCoilMaxSteamFlowRate</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-1744"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">CoilMaxVolFlowRate</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Autosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1745"></a><span class="k">                   </span><span class="n">SteamIndex</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! Function GetSatDensityRefrig will look up steam index if 0 is passed</span>
<a name="ln-1746"></a>                   <span class="n">SteamDensity</span><span class="o">=</span><span class="n">GetSatDensityRefrig</span><span class="p">(</span><span class="s1">&#39;STEAM&#39;</span><span class="p">,</span><span class="n">TempSteamIn</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">SteamIndex</span><span class="p">,</span><span class="s1">&#39;InitUnitarySystems&#39;</span><span class="p">)</span>
<a name="ln-1747"></a>                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="o">=</span> <span class="n">CoilMaxVolFlowRate</span> <span class="o">*</span> <span class="n">SteamDensity</span>
<a name="ln-1748"></a>                <span class="k">END IF</span>
<a name="ln-1749"></a><span class="k">            END IF</span>
<a name="ln-1750"></a><span class="k">        END IF</span>
<a name="ln-1751"></a>
<a name="ln-1752"></a><span class="k">        CALL </span><span class="n">InitComponentNodes</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1753"></a>                                        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilFluidInletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1754"></a>                                        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilFluidOutletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1755"></a>                                        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1756"></a>                                        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilLoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1757"></a>                                        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1758"></a>                                        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilCompNum</span> <span class="p">)</span>
<a name="ln-1759"></a>    <span class="k">END IF</span>
<a name="ln-1760"></a><span class="k">    IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilFluidInletNode</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1761"></a><span class="k">        IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1762"></a><span class="k">            IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWater</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1763"></a>                <span class="c">! IF water coil max water flow rate is autosized, simulate once in order to mine max flow rate</span>
<a name="ln-1764"></a>                <span class="k">CALL </span><span class="n">SimulateWaterCoilComponents</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1765"></a>                                                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">)</span>
<a name="ln-1766"></a>                <span class="n">CoilMaxVolFlowRate</span> <span class="o">=</span> <span class="n">GetCoilMaxWaterFlowRate</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1767"></a>                                                            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-1768"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">CoilMaxVolFlowRate</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Autosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1769"></a><span class="k">                    </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilLoopNum</span><span class="p">)%</span><span class="n">fluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1770"></a>                                        <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1771"></a>                                        <span class="n">PlantLoop</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilLoopNum</span><span class="p">)%</span><span class="n">fluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1772"></a>                                        <span class="s1">&#39;InitUnitarySystems&#39;</span><span class="p">)</span>
<a name="ln-1773"></a>                    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">=</span> <span class="n">CoilMaxVolFlowRate</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-1774"></a>                <span class="k">END IF</span>
<a name="ln-1775"></a><span class="k">            END IF</span>
<a name="ln-1776"></a><span class="k">            IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingSteam</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1777"></a><span class="k">                CALL </span><span class="n">SimulateSteamCoilComponents</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1778"></a>                                                <span class="n">FirstHVACIteration</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-1779"></a>                                                <span class="mf">1.0d0</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">!QCoilReq, simulate any load &gt; 0 to get max capacity</span>
<a name="ln-1780"></a>                                                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span> <span class="n">QActual</span><span class="p">)</span>
<a name="ln-1781"></a>                <span class="n">CoilMaxVolFlowRate</span> <span class="o">=</span> <span class="n">GetCoilMaxSteamFlowRate</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-1782"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">CoilMaxVolFlowRate</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Autosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1783"></a><span class="k">                </span><span class="n">SteamIndex</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! Function GetSatDensityRefrig will look up steam index if 0 is passed</span>
<a name="ln-1784"></a>                <span class="n">SteamDensity</span><span class="o">=</span><span class="n">GetSatDensityRefrig</span><span class="p">(</span><span class="s1">&#39;STEAM&#39;</span><span class="p">,</span><span class="n">TempSteamIn</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">SteamIndex</span><span class="p">,</span><span class="s1">&#39;InitUnitarySystems&#39;</span><span class="p">)</span>
<a name="ln-1785"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">=</span> <span class="n">CoilMaxVolFlowRate</span> <span class="o">*</span> <span class="n">SteamDensity</span>
<a name="ln-1786"></a>                <span class="k">END IF</span>
<a name="ln-1787"></a><span class="k">            END IF</span>
<a name="ln-1788"></a><span class="k">            CALL </span><span class="n">InitComponentNodes</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1789"></a>                                        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilFluidInletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1790"></a>                                        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilFluidOutletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1791"></a>                                        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1792"></a>                                        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilLoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1793"></a>                                        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1794"></a>                                        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilCompNum</span> <span class="p">)</span>
<a name="ln-1795"></a>        <span class="k">END IF</span>
<a name="ln-1796"></a><span class="k">    END IF</span>
<a name="ln-1797"></a><span class="k">    </span><span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1798"></a>  <span class="k">END IF</span>
<a name="ln-1799"></a>
<a name="ln-1800"></a><span class="k">  IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">BeginEnvrnFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1801"></a><span class="k">    </span><span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1802"></a>  <span class="k">END IF</span>
<a name="ln-1803"></a>
<a name="ln-1804"></a><span class="k">  IF</span><span class="p">(</span><span class="n">MyFanFlag</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-1805"></a><span class="k">    IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ActualFanVolFlowRate</span> <span class="o">/=</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1806"></a><span class="k">      IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ActualFanVolFlowRate</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1807"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingFanSpeedRatio</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1808"></a>                  <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span><span class="o">/</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ActualFanVolFlowRate</span>
<a name="ln-1809"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingFanSpeedRatio</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1810"></a>                  <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span><span class="o">/</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ActualFanVolFlowRate</span>
<a name="ln-1811"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NoHeatCoolSpeedRatio</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1812"></a>                  <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span><span class="o">/</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ActualFanVolFlowRate</span>
<a name="ln-1813"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1814"></a><span class="k">          IF</span><span class="p">(</span><span class="n">GetFanSpeedRatioCurveIndex</span><span class="p">(</span><span class="n">FanType</span><span class="p">,</span><span class="n">FanName</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanIndex</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1815"></a><span class="k">            IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ActualFanVolFlowRate</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1816"></a>               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ActualFanVolFlowRate</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1817"></a>               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ActualFanVolFlowRate</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1818"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1819"></a>                                <span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1820"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...For fan type and name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">FanType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">FanName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1821"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Fan power ratio function of speed ratio curve has no impact IF fan volumetric &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1822"></a>                                 <span class="s1">&#39;flow rate is the same as the unitary system volumetric flow rate.&#39;</span><span class="p">)</span>
<a name="ln-1823"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Fan volumetric flow rate            = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1824"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ActualFanVolFlowRate</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; m3/s.&#39;</span><span class="p">)</span>
<a name="ln-1825"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Unitary system volumetric flow rate = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1826"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; m3/s.&#39;</span><span class="p">)</span>
<a name="ln-1827"></a>            <span class="k">END IF</span>
<a name="ln-1828"></a><span class="k">          END IF</span>
<a name="ln-1829"></a><span class="k">        ELSE</span>
<a name="ln-1830"></a><span class="k">          CALL </span><span class="n">CheckSystemBranchFlow</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">),</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1831"></a>                               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ActualFanVolFlowRate</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1832"></a>        <span class="k">END IF</span>
<a name="ln-1833"></a><span class="k">      END IF</span>
<a name="ln-1834"></a><span class="k">      </span><span class="n">MyFanFlag</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1835"></a>    <span class="k">ELSE</span>
<a name="ln-1836"></a><span class="k">      IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1837"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ActualFanVolFlowRate</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1838"></a>          <span class="n">GetFanDesignVolumeFlowRate</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">Blank</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanIndex</span><span class="p">)</span>
<a name="ln-1839"></a>      <span class="k">ELSE</span>
<a name="ln-1840"></a><span class="k">        CALL </span><span class="n">CheckSystemBranchFlow</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">),</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1841"></a>                               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ActualFanVolFlowRate</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1842"></a>      <span class="k">END IF</span>
<a name="ln-1843"></a><span class="k">    END IF</span>
<a name="ln-1844"></a><span class="k">  END IF</span>
<a name="ln-1845"></a>
<a name="ln-1846"></a>  <span class="c">! Get the zone inlet node</span>
<a name="ln-1847"></a>  <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MyCheckFlag</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1848"></a><span class="k">    DO </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-1849"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">AirLoopEquipment</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1850"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">AirLoopNum</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">AirLoopNum</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1851"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">ActualZoneNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1852"></a><span class="k">          DO </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">NumInletNodes</span>
<a name="ln-1853"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ZoneInletNode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1854"></a><span class="k">              DO </span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">NumInletNodes</span>
<a name="ln-1855"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">InletNode</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">AirDistUnitCool</span><span class="p">(</span><span class="n">k</span><span class="p">)%</span><span class="n">OutNode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1856"></a><span class="k">                  </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ZoneInletNode</span> <span class="o">=</span> <span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">InletNode</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<a name="ln-1857"></a>                  <span class="k">EXIT</span>
<a name="ln-1858"></a><span class="k">                </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">InletNode</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">AirDistUnitHeat</span><span class="p">(</span><span class="n">k</span><span class="p">)%</span><span class="n">OutNode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1859"></a><span class="k">                  </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ZoneInletNode</span> <span class="o">=</span> <span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">InletNode</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<a name="ln-1860"></a>                  <span class="k">EXIT</span>
<a name="ln-1861"></a><span class="k">                END IF</span>
<a name="ln-1862"></a><span class="k">              END DO</span>
<a name="ln-1863"></a><span class="k">            END IF</span>
<a name="ln-1864"></a><span class="k">          END DO</span>
<a name="ln-1865"></a>          <span class="c">!setup unitary system zone equipment sequence information based on finding an air terminal</span>
<a name="ln-1866"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">EquipListIndex</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1867"></a><span class="k">            DO </span><span class="n">EquipNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">NumOfEquipTypes</span>
<a name="ln-1868"></a>              <span class="k">IF</span> <span class="p">((</span><span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">EquipType_Num</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)</span> <span class="o">==</span> <span class="n">AirDistUnit_Num</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1869"></a>                  <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">EquipType_Num</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)</span> <span class="o">==</span> <span class="n">DirectAir_Num</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1870"></a><span class="k">                </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ZoneSequenceCoolingNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1871"></a>                         <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">CoolingPriority</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)</span>
<a name="ln-1872"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ZoneSequenceHeatingNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1873"></a>                         <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">HeatingPriority</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)</span>
<a name="ln-1874"></a>              <span class="k">END IF</span>
<a name="ln-1875"></a><span class="k">            END DO</span>
<a name="ln-1876"></a><span class="k">          END IF</span>
<a name="ln-1877"></a><span class="k">        END IF</span>
<a name="ln-1878"></a><span class="k">      END IF</span>
<a name="ln-1879"></a><span class="k">    END DO</span>
<a name="ln-1880"></a><span class="k">    </span><span class="n">MyCheckFlag</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1881"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ZoneInletNode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1882"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1883"></a>                             <span class="s1">&#39;&quot;: The zone inlet node in the controlled zone (&#39;</span> <span class="p">&amp;</span>
<a name="ln-1884"></a>                            <span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="o">//</span><span class="s1">&#39;) is not found.&#39;</span><span class="p">)</span>
<a name="ln-1885"></a>      <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Subroutine InitLoadBasedControl: &#39;</span><span class="o">//</span><span class="s1">&#39;Errors found in getting &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1886"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; input.  &#39;</span><span class="o">//</span><span class="s1">&#39;Preceding condition(s) causes termination.&#39;</span><span class="p">)</span>
<a name="ln-1887"></a>    <span class="k">END IF</span>
<a name="ln-1888"></a><span class="k">  END IF</span>
<a name="ln-1889"></a>
<a name="ln-1890"></a>  <span class="c">! Find the number of zones (zone Inlet Nodes) attached to an air loop from the air loop number</span>
<a name="ln-1891"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">MyFlowFracFlag</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-1892"></a><span class="k">    IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">AirLoopEquipment</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1893"></a><span class="k">      IF</span><span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">AirToZoneNodeInfo</span><span class="p">))</span><span class="n">NumAirLoopZones</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1894"></a>        <span class="n">AirToZoneNodeInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">NumZonesCooled</span> <span class="o">+</span> <span class="n">AirToZoneNodeInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">NumZonesHeated</span>
<a name="ln-1895"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">AirToZoneNodeInfo</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MyFlowFracFlag</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1896"></a><span class="k">        </span><span class="n">FlowFracFlagReady</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1897"></a>        <span class="n">ZonesLoop</span><span class="p">:</span> <span class="k">DO </span><span class="n">ZoneInSysIndex</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumAirLoopZones</span>
<a name="ln-1898"></a>          <span class="c">! zone inlet nodes for cooling</span>
<a name="ln-1899"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">AirToZoneNodeInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">NumZonesCooled</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1900"></a><span class="k">            IF</span><span class="p">(</span> <span class="n">AirToZoneNodeInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">TermUnitCoolInletNodes</span><span class="p">(</span><span class="n">ZoneInSysIndex</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">999</span> <span class="p">)</span><span class="k">THEN</span>
<a name="ln-1901"></a>              <span class="c">! the data structure for the zones inlet nodes has not been filled</span>
<a name="ln-1902"></a>              <span class="n">FlowFracFlagReady</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1903"></a>            <span class="k">END IF</span>
<a name="ln-1904"></a><span class="k">          END IF</span>
<a name="ln-1905"></a>          <span class="c">! zone inlet nodes for heating</span>
<a name="ln-1906"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">AirToZoneNodeInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">NumZonesHeated</span>  <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1907"></a><span class="k">            IF</span><span class="p">(</span> <span class="n">AirToZoneNodeInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">TermUnitHeatInletNodes</span><span class="p">(</span><span class="n">ZoneInSysIndex</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">999</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1908"></a>              <span class="c">! the data structure for the zones inlet nodes has not been filled</span>
<a name="ln-1909"></a>              <span class="n">FlowFracFlagReady</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1910"></a>            <span class="k">END IF</span>
<a name="ln-1911"></a><span class="k">          END IF</span>
<a name="ln-1912"></a><span class="k">        END DO </span><span class="n">ZonesLoop</span>
<a name="ln-1913"></a>      <span class="k">END IF</span>
<a name="ln-1914"></a><span class="k">      IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">AirToZoneNodeInfo</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">FlowFracFlagReady</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1915"></a><span class="k">        </span><span class="n">SumOfMassFlowRateMax</span> <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! initialize the sum of the maximum flows</span>
<a name="ln-1916"></a>        <span class="k">DO </span><span class="n">ZoneInSysIndex</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumAirLoopZones</span>
<a name="ln-1917"></a>          <span class="n">ZoneInletNodeNum</span> <span class="o">=</span> <span class="n">AirToZoneNodeInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">TermUnitCoolInletNodes</span><span class="p">(</span><span class="n">ZoneInSysIndex</span><span class="p">)</span>
<a name="ln-1918"></a>          <span class="n">SumOfMassFlowRateMax</span> <span class="o">=</span> <span class="n">SumOfMassFlowRateMax</span> <span class="o">+</span> <span class="n">Node</span><span class="p">(</span><span class="n">ZoneInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRateMax</span>
<a name="ln-1919"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">AirToZoneNodeInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">CoolCtrlZoneNums</span><span class="p">(</span><span class="n">ZoneInSysIndex</span><span class="p">)</span> <span class="o">==</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span> <span class="p">)</span><span class="k">THEN</span>
<a name="ln-1920"></a><span class="k">            </span><span class="n">CntrlZoneTerminalUnitMassFlowRateMax</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">ZoneInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRateMax</span>
<a name="ln-1921"></a>          <span class="k">END IF</span>
<a name="ln-1922"></a><span class="k">        END DO</span>
<a name="ln-1923"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SumOfMassFlowRateMax</span> <span class="o">/=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MyFlowFracFlag</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1924"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">CntrlZoneTerminalUnitMassFlowRateMax</span> <span class="o">&gt;=</span> <span class="n">SmallAirVolFlow</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1925"></a><span class="k">              </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneMassFlowFrac</span> <span class="o">=</span> <span class="n">CntrlZoneTerminalUnitMassFlowRateMax</span><span class="o">/</span><span class="n">SumOfMassFlowRateMax</span>
<a name="ln-1926"></a>          <span class="k">ELSE</span>
<a name="ln-1927"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1928"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1929"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; The Fraction of Supply Air Flow That Goes Through the Controlling Zone is set to 1.&#39;</span><span class="p">)</span>
<a name="ln-1930"></a>          <span class="k">END IF</span>
<a name="ln-1931"></a><span class="k">          CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1932"></a>                                  <span class="s1">&#39;Fraction of Supply Air Flow That Goes Through the Controlling Zone&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1933"></a>                                  <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneMassFlowFrac</span><span class="p">)</span>
<a name="ln-1934"></a>          <span class="n">MyFlowFracFlag</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1935"></a>        <span class="k">END IF</span>
<a name="ln-1936"></a><span class="k">      END IF</span>
<a name="ln-1937"></a><span class="k">    ELSE</span>
<a name="ln-1938"></a><span class="k">      </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneMassFlowFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-1939"></a>    <span class="k">END IF</span>
<a name="ln-1940"></a><span class="k">  END IF</span> <span class="c">! IF(MyFlowFracFlag(UnitarySysNum))THEN</span>
<a name="ln-1941"></a>
<a name="ln-1942"></a><span class="c">! What type of logic is this? Is the point to go through the main IF once? or every other time?</span>
<a name="ln-1943"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">BeginEnvrnFlag</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">MyAirLoopPass</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1944"></a><span class="k">    </span><span class="n">AirLoopPass</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1945"></a>    <span class="n">MyAirLoopPass</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1946"></a>  <span class="k">END IF</span>
<a name="ln-1947"></a><span class="k">  IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">BeginEnvrnFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1948"></a><span class="k">    </span><span class="n">MyAirLoopPass</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1949"></a>  <span class="k">END IF</span>
<a name="ln-1950"></a>
<a name="ln-1951"></a><span class="k">  </span><span class="n">AirLoopPass</span> <span class="o">=</span> <span class="n">AirLoopPass</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1952"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">AirLoopPass</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="n">AirLoopPass</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1953"></a>
<a name="ln-1954"></a>  <span class="c">! reset duct losses from previous iteration</span>
<a name="ln-1955"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1956"></a><span class="k">    </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SenLoadLoss</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1957"></a>    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">LatLoadLoss</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1958"></a>  <span class="k">END IF</span>
<a name="ln-1959"></a>
<a name="ln-1960"></a>  <span class="c">! Calcuate air distribution losses</span>
<a name="ln-1961"></a><span class="c">!  IF (.NOT. FirstHVACIteration .AND. AirLoopPass .EQ. 1 .AND. AirflowNetworkFanActivated) THEN</span>
<a name="ln-1962"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FirstHVACIteration</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">AirflowNetworkFanActivated</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1963"></a><span class="k">    </span><span class="n">ZoneInNode</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ZoneInletNode</span>
<a name="ln-1964"></a>    <span class="n">MinHumRat</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">ZoneInNode</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-1965"></a>    <span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">ZoneInNode</span><span class="p">)%</span><span class="n">MassFlowrate</span><span class="o">/</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneMassFlowFrac</span>
<a name="ln-1966"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemOutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1967"></a>       <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NodeNumofControlledZone</span><span class="p">)%</span><span class="n">Temp</span> <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1968"></a>      <span class="n">MinHumRat</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemOutletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-1969"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SimulateAirflowNetwork</span> <span class="o">&gt;</span> <span class="n">AirflowNetworkControlMultizone</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1970"></a><span class="k">      </span><span class="n">DeltaMassRate</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemOutletNodeNum</span><span class="p">)%</span><span class="n">MassFlowrate</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-1971"></a>                    <span class="n">Node</span><span class="p">(</span><span class="n">ZoneInNode</span><span class="p">)%</span><span class="n">MassFlowrate</span><span class="o">/</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneMassFlowFrac</span>
<a name="ln-1972"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaMassRate</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">DeltaMassRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1973"></a>    <span class="k">ELSE</span>
<a name="ln-1974"></a><span class="k">      </span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemOutletNodeNum</span><span class="p">)%</span><span class="n">MassFlowrate</span>
<a name="ln-1975"></a>      <span class="n">DeltaMassRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1976"></a>    <span class="k">END IF</span>
<a name="ln-1977"></a><span class="k">    </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SenLoadLoss</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1978"></a>       <span class="n">MassFlowRate</span> <span class="o">*</span> <span class="p">(</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemOutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">MinHumRat</span><span class="p">)</span><span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-1979"></a>       <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneInNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">MinHumRat</span><span class="p">))</span> <span class="o">+</span> <span class="n">DeltaMassRate</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-1980"></a>      <span class="p">(</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemOutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">MinHumRat</span><span class="p">)</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-1981"></a>       <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NodeNumofControlledZone</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">MinHumRat</span><span class="p">))</span>
<a name="ln-1982"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SensibleLoadMet</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1983"></a><span class="k">      IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SenLoadLoss</span><span class="o">/</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SensibleLoadMet</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.001d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1984"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SenLoadLoss</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1985"></a>    <span class="k">END IF</span>
<a name="ln-1986"></a><span class="k">    IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Humidistat</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1987"></a><span class="k">      </span><span class="n">MaxTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NodeNumofControlledZone</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-1988"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">LatLoadLoss</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1989"></a>        <span class="n">MassFlowRate</span><span class="o">*</span><span class="p">(</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">MaxTemp</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemOutletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">)</span><span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-1990"></a>        <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">MaxTemp</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneInNode</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">))</span> <span class="o">+</span> <span class="n">DeltaMassRate</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-1991"></a>        <span class="p">(</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">MaxTemp</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemOutletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">)</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-1992"></a>        <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">MaxTemp</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NodeNumofControlledZone</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">))</span>
<a name="ln-1993"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">LatentLoadMet</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1994"></a><span class="k">        IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">LatLoadLoss</span><span class="o">/</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">LatentLoadMet</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.001d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1995"></a>             <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">LatLoadLoss</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1996"></a>      <span class="k">END IF</span>
<a name="ln-1997"></a><span class="k">    END IF</span>
<a name="ln-1998"></a><span class="k">  END IF</span>
<a name="ln-1999"></a>
<a name="ln-2000"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpModeSchedPtr</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2001"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpModeSchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2002"></a><span class="k">      </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span> <span class="o">=</span> <span class="n">CycFanCycCoil</span>
<a name="ln-2003"></a>    <span class="k">ELSE</span>
<a name="ln-2004"></a><span class="k">      </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span> <span class="o">=</span> <span class="n">ContFanCycCoil</span>
<a name="ln-2005"></a>      <span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2006"></a>    <span class="k">END IF</span>
<a name="ln-2007"></a><span class="k">  END IF</span>
<a name="ln-2008"></a>
<a name="ln-2009"></a><span class="c">!  OpMode = UnitarySystem(UnitarySysNum)%FanOpMode</span>
<a name="ln-2010"></a>  <span class="k">IF</span><span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">AirLoopControlInfo</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">AirLoopEquipment</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2011"></a><span class="k">    </span><span class="n">EconomizerFlag</span> <span class="o">=</span> <span class="n">AirLoopControlInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">EconoActive</span>
<a name="ln-2012"></a>  <span class="k">ELSE</span>
<a name="ln-2013"></a><span class="k">    </span><span class="n">EconomizerFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2014"></a>  <span class="k">END IF</span>
<a name="ln-2015"></a>
<a name="ln-2016"></a><span class="c">! System load calculation for cycling fan systems</span>
<a name="ln-2017"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneMassFlowFrac</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2018"></a><span class="k">    </span><span class="n">QZnReq</span> <span class="o">=</span> <span class="n">ZoneLoad</span><span class="o">/</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneMassFlowFrac</span>
<a name="ln-2019"></a>    <span class="n">MoistureLoad</span> <span class="o">=</span> <span class="n">MoistureLoad</span><span class="o">/</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneMassFlowFrac</span>
<a name="ln-2020"></a>    <span class="n">QToCoolSetPt</span><span class="o">=</span><span class="n">QToCoolSetPt</span><span class="o">/</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneMassFlowFrac</span>
<a name="ln-2021"></a>    <span class="n">QToHeatSetPt</span><span class="o">=</span><span class="n">QToHeatSetPt</span><span class="o">/</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneMassFlowFrac</span>
<a name="ln-2022"></a>    <span class="n">ZoneLoad</span> <span class="o">=</span> <span class="n">QZnReq</span>
<a name="ln-2023"></a>  <span class="k">ELSE</span>
<a name="ln-2024"></a><span class="k">    </span><span class="n">QZnReq</span> <span class="o">=</span> <span class="n">ZoneLoad</span>
<a name="ln-2025"></a>    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneMassFlowFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2026"></a>  <span class="k">END IF</span>
<a name="ln-2027"></a>
<a name="ln-2028"></a><span class="k">  </span><span class="n">CoolingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2029"></a>  <span class="n">HeatingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2030"></a>
<a name="ln-2031"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">QZnReq</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span>  <span class="n">Small5WLoad</span><span class="o">/</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneMassFlowFrac</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2032"></a>     <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">CurDeadbandOrSetback</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-2033"></a><span class="k">    IF</span><span class="p">(</span><span class="n">TempControlType</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">SingleCoolingSetPoint</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2034"></a><span class="k">      </span><span class="n">HeatingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2035"></a>    <span class="k">END IF</span>
<a name="ln-2036"></a><span class="k">  </span><span class="n">ELSEIF</span><span class="p">(</span><span class="n">QZnReq</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="o">-</span><span class="n">Small5WLoad</span><span class="o">/</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneMassFlowFrac</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2037"></a>     <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">CurDeadbandOrSetback</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-2038"></a><span class="k">    IF</span><span class="p">(</span><span class="n">TempControlType</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">SingleHeatingSetPoint</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2039"></a><span class="k">      </span><span class="n">CoolingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2040"></a>    <span class="k">END IF</span>
<a name="ln-2041"></a><span class="k">  END IF</span>
<a name="ln-2042"></a>
<a name="ln-2043"></a><span class="c">! System load calculation for constant fan systems</span>
<a name="ln-2044"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span> <span class="o">==</span> <span class="n">ContFanCycCoil</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2045"></a><span class="k">    </span><span class="n">HXUnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2046"></a>    <span class="k">CALL </span><span class="n">CalcUnitarySystemToLoad</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2047"></a>                                 <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SensOutputOff</span><span class="p">,</span><span class="n">LatOutputOff</span><span class="p">,</span><span class="n">HXUnitOn</span><span class="p">)</span>
<a name="ln-2048"></a>    <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">TempControlType</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">))</span>
<a name="ln-2049"></a>    <span class="k">CASE</span><span class="p">(</span><span class="n">SingleHeatingSetPoint</span><span class="p">)</span>
<a name="ln-2050"></a>      <span class="n">CoolingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2051"></a>      <span class="c">! No heating load and constant fan pushes zone below heating set point</span>
<a name="ln-2052"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">SensOutputOff</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">QToHeatSetPt</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2053"></a>         <span class="n">SensOutputOff</span><span class="o">-</span><span class="n">QToHeatSetPt</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="o">-</span><span class="n">SmallLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2054"></a><span class="k">        </span><span class="n">HeatingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2055"></a>        <span class="n">CoolingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2056"></a>        <span class="n">ZoneLoad</span> <span class="o">=</span> <span class="n">QToHeatSetPt</span>
<a name="ln-2057"></a>      <span class="k">END IF</span>
<a name="ln-2058"></a><span class="k">    CASE</span><span class="p">(</span><span class="n">SingleCoolingSetPoint</span><span class="p">)</span>
<a name="ln-2059"></a>      <span class="n">HeatingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2060"></a>      <span class="c">! No heating load and constant fan pushes zone above cooling set point</span>
<a name="ln-2061"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">SensOutputOff</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">QToCoolSetPt</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2062"></a>         <span class="n">SensOutputOff</span><span class="o">-</span><span class="n">QToCoolSetPt</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SmallLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2063"></a><span class="k">        </span><span class="n">HeatingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2064"></a>        <span class="n">CoolingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2065"></a>        <span class="n">ZoneLoad</span> <span class="o">=</span> <span class="n">QToCoolSetPt</span>
<a name="ln-2066"></a>      <span class="k">END IF</span>
<a name="ln-2067"></a><span class="k">    CASE</span><span class="p">(</span><span class="n">SingleHeatCoolSetPoint</span><span class="p">)</span>
<a name="ln-2068"></a>      <span class="c">! zone temp above cooling and heating set point temps</span>
<a name="ln-2069"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">QToHeatSetPt</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">QToCoolSetPt</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2070"></a>        <span class="c">! zone pushed below heating set point</span>
<a name="ln-2071"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">SensOutputOff</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2072"></a>           <span class="n">QToHeatSetPt</span><span class="o">-</span><span class="n">SensOutputOff</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SmallLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2073"></a><span class="k">          </span><span class="n">HeatingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2074"></a>          <span class="n">CoolingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2075"></a>          <span class="n">ZoneLoad</span> <span class="o">=</span> <span class="n">QToHeatSetPt</span>
<a name="ln-2076"></a>        <span class="k">END IF</span>
<a name="ln-2077"></a>      <span class="c">! zone temp below heating set point temp</span>
<a name="ln-2078"></a>      <span class="n">ELSEIF</span><span class="p">(</span><span class="n">QToHeatSetPt</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">QToCoolSetPt</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2079"></a>        <span class="c">! zone pushed above cooling set point</span>
<a name="ln-2080"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">SensOutputOff</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2081"></a>           <span class="n">QToCoolSetPt</span><span class="o">-</span><span class="n">SensOutputOff</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SmallLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2082"></a><span class="k">          </span><span class="n">HeatingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2083"></a>          <span class="n">CoolingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2084"></a>          <span class="n">ZoneLoad</span> <span class="o">=</span> <span class="n">QToCoolSetPt</span>
<a name="ln-2085"></a>        <span class="k">END IF</span>
<a name="ln-2086"></a><span class="k">      END IF</span>
<a name="ln-2087"></a><span class="k">    CASE</span><span class="p">(</span><span class="n">DualSetPointWithDeadBand</span><span class="p">)</span>
<a name="ln-2088"></a>      <span class="c">! zone temp above cooling and heating set point temps</span>
<a name="ln-2089"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">QToHeatSetPt</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">QToCoolSetPt</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2090"></a>        <span class="c">! zone pushed into deadband</span>
<a name="ln-2091"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">SensOutputOff</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2092"></a>           <span class="n">QToCoolSetPt</span><span class="o">-</span><span class="n">SensOutputOff</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SmallLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2093"></a><span class="k">          </span><span class="n">HeatingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2094"></a>          <span class="n">CoolingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2095"></a>          <span class="n">ZoneLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2096"></a>        <span class="k">END IF</span>
<a name="ln-2097"></a>        <span class="c">! zone pushed below heating set point</span>
<a name="ln-2098"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">SensOutputOff</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2099"></a>           <span class="n">QToHeatSetPt</span><span class="o">-</span><span class="n">SensOutputOff</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SmallLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2100"></a><span class="k">          </span><span class="n">HeatingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2101"></a>          <span class="n">CoolingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2102"></a>          <span class="n">ZoneLoad</span> <span class="o">=</span> <span class="n">QToHeatSetPt</span>
<a name="ln-2103"></a>        <span class="k">END IF</span>
<a name="ln-2104"></a>      <span class="c">! zone temp below heating set point temp</span>
<a name="ln-2105"></a>      <span class="n">ELSEIF</span><span class="p">(</span><span class="n">QToHeatSetPt</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">QToCoolSetPt</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2106"></a>        <span class="c">! zone pushed into deadband</span>
<a name="ln-2107"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">SensOutputOff</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2108"></a>           <span class="n">SensOutputOff</span><span class="o">-</span><span class="n">QToHeatSetPt</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SmallLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2109"></a><span class="k">          </span><span class="n">HeatingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2110"></a>          <span class="n">CoolingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2111"></a>          <span class="n">ZoneLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2112"></a>        <span class="k">END IF</span>
<a name="ln-2113"></a>        <span class="c">! zone pushed above cooling set point</span>
<a name="ln-2114"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">SensOutputOff</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2115"></a>           <span class="n">SensOutputOff</span><span class="o">-</span><span class="n">QToCoolSetPt</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SmallLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2116"></a><span class="k">          </span><span class="n">HeatingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2117"></a>          <span class="n">CoolingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2118"></a>          <span class="n">ZoneLoad</span> <span class="o">=</span> <span class="n">QToCoolSetPt</span>
<a name="ln-2119"></a>        <span class="k">END IF</span>
<a name="ln-2120"></a>      <span class="c">! zone temp between set point temps</span>
<a name="ln-2121"></a>      <span class="n">ELSEIF</span><span class="p">(</span><span class="n">QToHeatSetPt</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">QToCoolSetPt</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2122"></a>        <span class="c">! zone pushed below heating set point</span>
<a name="ln-2123"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">SensOutputOff</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2124"></a>           <span class="n">SensOutputOff</span><span class="o">-</span><span class="n">QToHeatSetPt</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="o">-</span><span class="n">SmallLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2125"></a><span class="k">          </span><span class="n">HeatingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2126"></a>          <span class="n">CoolingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2127"></a>          <span class="n">ZoneLoad</span> <span class="o">=</span> <span class="n">QToHeatSetPt</span>
<a name="ln-2128"></a>        <span class="c">! zone pushed above cooling set point</span>
<a name="ln-2129"></a>        <span class="n">ELSEIF</span><span class="p">(</span><span class="n">SensOutputOff</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2130"></a>                <span class="n">SensOutputOff</span><span class="o">-</span><span class="n">QToCoolSetPt</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SmallLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2131"></a><span class="k">          </span><span class="n">HeatingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2132"></a>          <span class="n">CoolingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2133"></a>          <span class="n">ZoneLoad</span> <span class="o">=</span> <span class="n">QToCoolSetPt</span>
<a name="ln-2134"></a>        <span class="k">END IF</span>
<a name="ln-2135"></a><span class="k">      END IF</span>
<a name="ln-2136"></a><span class="k">    CASE </span><span class="n">DEFAULT</span>
<a name="ln-2137"></a>    <span class="k">END SELECT</span>
<a name="ln-2138"></a>
<a name="ln-2139"></a>    <span class="c">! IF small loads to meet, just shut down unit</span>
<a name="ln-2140"></a>    <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">ZoneLoad</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">Small5WLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2141"></a><span class="k">      </span><span class="n">ZoneLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2142"></a>      <span class="n">CoolingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2143"></a>      <span class="n">HeatingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2144"></a>    <span class="k">END IF</span>
<a name="ln-2145"></a>
<a name="ln-2146"></a><span class="k">  END IF</span>
<a name="ln-2147"></a>
<a name="ln-2148"></a>  <span class="c">! Determine the staged status</span>
<a name="ln-2149"></a>  <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">StageZoneLogic</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>  <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignSpecMSHPIndex</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2150"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">StageZoneLogic</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2151"></a><span class="k">      </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Staged</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2152"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">StageNum</span> <span class="o">=</span> <span class="n">ZoneSysEnergyDemand</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)%</span><span class="n">StageNum</span>
<a name="ln-2153"></a>    <span class="k">ELSE</span>
<a name="ln-2154"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">MyStagedFlag</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2155"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;ZoneControl:Thermostat:StagedDualSetpoint is found, but is not applied to &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2156"></a>             <span class="s1">&#39;this AirLoopHVAC:UnitarySystem object with UnitarySystemPerformance:HeatPump:Multispeed type = &#39;</span><span class="p">)</span>
<a name="ln-2157"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="o">//</span><span class="s1">&#39;. Please make correction. Simulation continues...&#39;</span><span class="p">)</span>
<a name="ln-2158"></a>        <span class="n">MyStagedFlag</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2159"></a>      <span class="k">END IF</span>
<a name="ln-2160"></a><span class="k">    END IF</span>
<a name="ln-2161"></a><span class="k">  END IF</span>
<a name="ln-2162"></a>
<a name="ln-2163"></a>  <span class="c">! Staged control</span>
<a name="ln-2164"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Staged</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2165"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">StageNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2166"></a><span class="k">      </span><span class="n">HeatingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2167"></a>      <span class="n">CoolingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2168"></a>      <span class="n">QZnReq</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2169"></a>    <span class="k">ELSE</span>
<a name="ln-2170"></a><span class="k">      </span><span class="n">QZnReq</span> <span class="o">=</span> <span class="n">ZoneSysEnergyDemand</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)%</span><span class="n">RemainingOutputRequired</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-2171"></a>               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneMassFlowFrac</span>
<a name="ln-2172"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">StageNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2173"></a><span class="k">        </span><span class="n">HeatingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2174"></a>        <span class="n">CoolingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2175"></a>      <span class="k">ELSE</span>
<a name="ln-2176"></a><span class="k">        </span><span class="n">HeatingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2177"></a>        <span class="n">CoolingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2178"></a>      <span class="k">END IF</span>
<a name="ln-2179"></a><span class="k">    END IF</span>
<a name="ln-2180"></a><span class="k">  END IF</span>
<a name="ln-2181"></a>
<a name="ln-2182"></a><span class="k">  IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">==</span> <span class="n">DehumidControl_MultiMode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2183"></a><span class="k">    IF</span><span class="p">(</span><span class="n">HeatingLoad</span><span class="p">)</span><span class="n">MoistureLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2184"></a>  <span class="k">END IF</span>
<a name="ln-2185"></a>
<a name="ln-2186"></a>  <span class="c">! Check load control</span>
<a name="ln-2187"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RunOnLatentOnlyWithSensible</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ZoneLoad</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="n">MoistureLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2188"></a>  <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RunOnSensibleLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2189"></a><span class="k">    </span><span class="n">ZoneLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2190"></a>    <span class="n">CoolingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2191"></a>    <span class="n">HeatingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2192"></a>  <span class="k">END IF</span>
<a name="ln-2193"></a><span class="k">  IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RunOnLatentLoad</span><span class="p">)</span><span class="n">MoistureLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2194"></a>
<a name="ln-2195"></a>  <span class="c">! Testing heat pump air to air with RH control with CoolReheat dehumidifaction control showed that when there was heating</span>
<a name="ln-2196"></a>  <span class="c">! and moisture load, the cooling coil was turning on to meet the moisture load and reheat was then turning on to meet both</span>
<a name="ln-2197"></a>  <span class="c">! heating load and excess cooling load caused by cooling coil. Adding the logic below caused the zone temperature,</span>
<a name="ln-2198"></a>  <span class="c">! relative humidity, cooling/heating rate to line up for both the orignal and new file with unitary system object.</span>
<a name="ln-2199"></a>
<a name="ln-2200"></a>   <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2201"></a><span class="k">     IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">==</span> <span class="n">DehumidControl_CoolReheat</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2202"></a><span class="k">       IF</span> <span class="p">(</span><span class="n">MoistureLoad</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatPump</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2203"></a><span class="k">         </span><span class="n">HeatingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2204"></a>         <span class="n">CoolingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2205"></a>       <span class="k">END IF</span>
<a name="ln-2206"></a><span class="k">     END IF</span>
<a name="ln-2207"></a><span class="k">   END IF</span>
<a name="ln-2208"></a>
<a name="ln-2209"></a><span class="k">RETURN</span>
<a name="ln-2210"></a><span class="k">END SUBROUTINE </span><span class="n">InitLoadBasedControl</span>
<a name="ln-2211"></a>
<a name="ln-2212"></a><span class="c">! End of Initialization subroutines for the Module</span>
<a name="ln-2213"></a><span class="c">! *****************************************************************************</span>
<a name="ln-2214"></a>
<a name="ln-2215"></a><span class="k">SUBROUTINE </span><span class="n">SizeUnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">AirLoopNum</span><span class="p">)</span>
<a name="ln-2216"></a>
<a name="ln-2217"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2218"></a>          <span class="c">!       AUTHOR         Richard Raustad, FSEC</span>
<a name="ln-2219"></a>          <span class="c">!       DATE WRITTEN   February 2013</span>
<a name="ln-2220"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-2221"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2222"></a>
<a name="ln-2223"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2224"></a>          <span class="c">! This subroutine is for sizing unitary system components for which nominal cpacities</span>
<a name="ln-2225"></a>          <span class="c">! and flow rates have not been specified in the input. Coil sizing is preformed in the coil module.</span>
<a name="ln-2226"></a>          <span class="c">! Future modifications will size coils here and &quot;push&quot; this info to the specific coil.</span>
<a name="ln-2227"></a>
<a name="ln-2228"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2229"></a>          <span class="c">! Obtains heating capacities and flow rates from the zone or system sizing arrays.</span>
<a name="ln-2230"></a>          <span class="c">!</span>
<a name="ln-2231"></a>          <span class="c">! NOTE: In UNITARYSYSTEM:HEATPUMP:AIRTOAIR we are sizing the heating capacity to be</span>
<a name="ln-2232"></a>          <span class="c">! equal to the cooling capacity.  Thus the cooling and</span>
<a name="ln-2233"></a>          <span class="c">! and heating capacities of a DX heat pump system will be identical. In real life the ARI</span>
<a name="ln-2234"></a>          <span class="c">! heating and cooling capacities are close but not identical.</span>
<a name="ln-2235"></a>
<a name="ln-2236"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2237"></a>          <span class="c">! na</span>
<a name="ln-2238"></a>
<a name="ln-2239"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2240"></a>  <span class="k">USE </span><span class="n">BranchInputManager</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">CheckSystemBranchFlow</span><span class="p">,</span> <span class="n">GetAirBranchIndex</span><span class="p">,</span> <span class="n">GetBranchFanTypeName</span><span class="p">,</span> <span class="n">GetBranchFlow</span>
<a name="ln-2241"></a>  <span class="k">USE </span><span class="n">DataAirSystems</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">PrimaryAirSystem</span>
<a name="ln-2242"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span>              <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurveValue</span>
<a name="ln-2243"></a>  <span class="k">USE </span><span class="n">DXCoils</span><span class="p">,</span>                   <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimDXCoil</span><span class="p">,</span> <span class="n">SimDXCoilMultiSpeed</span><span class="p">,</span> <span class="n">GetCoilCapacityByIndexType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2244"></a>                                       <span class="n">GetDXCoilCapFTCurveIndex</span> <span class="c">!, SetDXCoolingCoilData</span>
<a name="ln-2245"></a>  <span class="k">USE </span><span class="n">Fans</span><span class="p">,</span>                      <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetFanDesignVolumeFlowRate</span>
<a name="ln-2246"></a>  <span class="k">USE </span><span class="n">HVACHXAssistedCoolingCoil</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimHXAssistedCoolingCoil</span><span class="p">,</span><span class="n">GetCoilCapacity</span><span class="p">,</span><span class="n">GetHXDXCoilName</span><span class="p">,</span><span class="n">GetCoilObjectTypeNum</span>
<a name="ln-2247"></a>  <span class="k">USE </span><span class="n">ReportSizingManager</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">ReportSizingOutput</span>
<a name="ln-2248"></a>  <span class="k">USE </span><span class="n">VariableSpeedCoils</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimVariableSpeedCoils</span><span class="p">,</span> <span class="n">VarSpeedCoil</span><span class="p">,</span> <span class="n">GetCoilCapacityVariableSpeed</span>
<a name="ln-2249"></a>  <span class="k">USE </span><span class="n">WatertoAirHeatPump</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimWaterToAirHP</span><span class="p">,</span><span class="n">GetWAHPCoilCapacity</span><span class="o">=&gt;</span><span class="n">GetCoilCapacity</span>
<a name="ln-2250"></a>  <span class="k">USE </span><span class="n">WatertoAirHeatPumpSimple</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimWatertoAirHPSimple</span><span class="p">,</span><span class="n">GetSimpleCoilCapacity</span><span class="o">=&gt;</span><span class="n">GetCoilCapacity</span>
<a name="ln-2251"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">RegisterPlantCompDesignFlow</span>
<a name="ln-2252"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">SameString</span><span class="p">,</span> <span class="n">FindItemInList</span><span class="p">,</span><span class="n">MakeUPPERCase</span>
<a name="ln-2253"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>                   <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-2254"></a>  <span class="k">USE </span><span class="n">WaterCoils</span><span class="p">,</span>                <span class="n">ONLY</span><span class="p">:</span> <span class="n">SetCoilDesFlow</span><span class="p">,</span><span class="n">GetWaterCoilCapacity</span>
<a name="ln-2255"></a>  <span class="k">USE </span><span class="n">Psychrometrics</span>
<a name="ln-2256"></a>  <span class="k">USE </span><span class="n">HVACDXSystem</span><span class="p">,</span>              <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCoolingCoilTypeNameAndIndex</span>
<a name="ln-2257"></a>  <span class="k">USE </span><span class="n">EMSManager</span><span class="p">,</span>                <span class="n">ONLY</span><span class="p">:</span> <span class="n">ManageEMS</span>
<a name="ln-2258"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>               <span class="n">ONLY</span><span class="p">:</span> <span class="n">emsCallFromUnitarySystemSizing</span>
<a name="ln-2259"></a>
<a name="ln-2260"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2261"></a>
<a name="ln-2262"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2263"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UnitarySysNum</span>
<a name="ln-2264"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FirstHVACIteration</span>
<a name="ln-2265"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirLoopNum</span> <span class="c">! does this need to be optional?</span>
<a name="ln-2266"></a>
<a name="ln-2267"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2268"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>  <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;SizeUnitarySystem&#39;</span>
<a name="ln-2269"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>    <span class="n">MaxRatedVolFlowPerRatedTotCap1</span> <span class="o">=</span> <span class="mf">0.00006041d0</span> <span class="c">! m3/s per watt = 450 cfm/ton</span>
<a name="ln-2270"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>    <span class="n">MinRatedVolFlowPerRatedTotCap1</span> <span class="o">=</span> <span class="mf">0.00004027d0</span> <span class="c">! m3/s per watt = 300 cfm/ton</span>
<a name="ln-2271"></a>
<a name="ln-2272"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2273"></a>          <span class="c">! na</span>
<a name="ln-2274"></a>
<a name="ln-2275"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2276"></a>          <span class="c">! na</span>
<a name="ln-2277"></a>
<a name="ln-2278"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2279"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ThisCtrlZoneNum</span>    <span class="c">! the controlled zone number of the control zone !!!</span>
<a name="ln-2280"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">Iter</span>               <span class="c">! iteration count</span>
<a name="ln-2281"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MulSpeedFlowScale</span>  <span class="c">! variable speed air flow scaling factor</span>
<a name="ln-2282"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">MSHPIndex</span>          <span class="c">! Index to design Specification object</span>
<a name="ln-2283"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">BranchNum</span>          <span class="c">! Index to branch on air loop</span>
<a name="ln-2284"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CompNum</span>            <span class="c">! Index to component on branch</span>
<a name="ln-2285"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BranchFlow</span>         <span class="c">! branch flow rate [m3/s]</span>
<a name="ln-2286"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BranchFanFlow</span>      <span class="c">! branch fan flow rate [m3/s]</span>
<a name="ln-2287"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">ErrFound</span>           <span class="c">! logical error flag</span>
<a name="ln-2288"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FanType</span>  <span class="c">! fan type</span>
<a name="ln-2289"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FanName</span>  <span class="c">! fan name</span>
<a name="ln-2290"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">DXHeatCoilBranch</span>   <span class="c">! branch where DX heating coil is located</span>
<a name="ln-2291"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">DXHeatCoilCompNum</span>  <span class="c">! comp number of DX heating coil on branch</span>
<a name="ln-2292"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolUnitarySystemNum</span> <span class="c">! index to unitary system with DX cooling coil</span>
<a name="ln-2293"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolCoilIndex</span>      <span class="c">! index to DX cooling coil</span>
<a name="ln-2294"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolCoilType</span>       <span class="c">! type of DX cooling coil</span>
<a name="ln-2295"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolCoilName</span> <span class="c">! name of DX cooling coil</span>
<a name="ln-2296"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhoair</span>             <span class="c">! air density [kg/m3]</span>
<a name="ln-2297"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CpAirStd</span>           <span class="c">! air specific heat [J/kg-k]</span>
<a name="ln-2298"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MixTemp</span>            <span class="c">! mixed air temp used for sizing [C]</span>
<a name="ln-2299"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MixHumRat</span>          <span class="c">! mixed air humidity ratio used for sizing [kg/kg]</span>
<a name="ln-2300"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MixEnth</span>            <span class="c">! mixed air enthalpy used for sizing [J/kg]</span>
<a name="ln-2301"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MixWetBulb</span>         <span class="c">! mixed air wet bulb temp used for sizing [C]</span>
<a name="ln-2302"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SupTemp</span>            <span class="c">! supply air temp used for sizing [C]</span>
<a name="ln-2303"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SupHumRat</span>          <span class="c">! supply air humidity ratio used for sizing [kg/kg]</span>
<a name="ln-2304"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SupEnth</span>            <span class="c">! supply air enthalpy used for sizing [J/kg]</span>
<a name="ln-2305"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutTemp</span>            <span class="c">! outdoor air temp used for sizing [C]</span>
<a name="ln-2306"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutAirFrac</span>         <span class="c">! fraction of outdoor air flow</span>
<a name="ln-2307"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">VolFlowRate</span>        <span class="c">! volumetric flow rate [m3/s]</span>
<a name="ln-2308"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolCapAtPeak</span>      <span class="c">! cooling capacity at peak [W]</span>
<a name="ln-2309"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatCapAtPeak</span>      <span class="c">! heating capacity at peak [W]</span>
<a name="ln-2310"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">TimeStepNumAtMax</span>   <span class="c">! time step at peak</span>
<a name="ln-2311"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">DDNum</span>              <span class="c">! design day index at peak</span>
<a name="ln-2312"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapTempModFac</span>   <span class="c">! capacity modifier used for sizing</span>
<a name="ln-2313"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedVolFlowPerRatedTotCap</span> <span class="c">!Rated Air Volume Flow Rate divided by Rated Total Capacity[m3/s-W)</span>
<a name="ln-2314"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SystemType</span> <span class="c">! type of air loop equipment</span>
<a name="ln-2315"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>  <span class="c">! used to pass to cooling coil for sizing</span>
<a name="ln-2316"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartLoadRatio</span>      <span class="c">! used to pass to cooling coil for sizing</span>
<a name="ln-2317"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CapFTCurve</span>         <span class="c">! index to DX coil Capacity as a function of Temperature curve</span>
<a name="ln-2318"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">TempCoolingLoad</span>    <span class="c">! size cooling coils with a cooling load, save actual load</span>
<a name="ln-2319"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">TempHeatingLoad</span>    <span class="c">! save actual load</span>
<a name="ln-2320"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SysCoolingFlow</span>     <span class="c">! individually sized cooling flow rate [m3/s]</span>
<a name="ln-2321"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SysHeatingFlow</span>     <span class="c">! individually sized heating flow rate [m3/s]</span>
<a name="ln-2322"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HXCoilName</span>         <span class="c">! cooling coil name in HXAssisted parent</span>
<a name="ln-2323"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ActualCoolCoilType</span> <span class="c">! cooling coil type in HXAssisted parent</span>
<a name="ln-2324"></a>
<a name="ln-2325"></a>  <span class="k">CALL </span><span class="n">ManageEMS</span><span class="p">(</span><span class="n">emsCallFromUnitarySystemSizing</span><span class="p">)</span> <span class="c">! calling point</span>
<a name="ln-2326"></a>
<a name="ln-2327"></a>  <span class="n">ThisCtrlZoneNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2328"></a>  <span class="n">DXCoolCap</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2329"></a>  <span class="n">UnitaryHeatCap</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2330"></a>  <span class="n">SuppHeatCap</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2331"></a>  <span class="n">TempCoolingLoad</span> <span class="o">=</span> <span class="n">CoolingLoad</span>
<a name="ln-2332"></a>  <span class="n">TempHeatingLoad</span> <span class="o">=</span> <span class="n">HeatingLoad</span>
<a name="ln-2333"></a>  <span class="n">CoolingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2334"></a>  <span class="n">HeatingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2335"></a>  <span class="n">ZoneCoolingOnlyFan</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2336"></a>  <span class="n">ZoneHeatingOnlyFan</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2337"></a>  <span class="n">SysCoolingFlow</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2338"></a>  <span class="n">SysHeatingFlow</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2339"></a>  <span class="n">CoolCapAtPeak</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2340"></a>  <span class="n">HeatCapAtPeak</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2341"></a>
<a name="ln-2342"></a><span class="c">!  IF(UnitarySystem(UnitarySysNum)%CoolCoilExists)THEN</span>
<a name="ln-2343"></a><span class="c">!    IF(</span>
<a name="ln-2344"></a><span class="c">!    UnitarySystem(UnitarySysNum)%DesignCoolingCapacity =    &amp;</span>
<a name="ln-2345"></a><span class="c">!     GetWaterHXAssistedCoilCapacity(CoolingCoilType,CoolingCoilName,ErrFlag)</span>
<a name="ln-2346"></a><span class="c">!    IF(UnitarySystem(UnitarySysNum)%DesignCoolingCapacity == Autosize) &amp;</span>
<a name="ln-2347"></a><span class="c">!        UnitarySystem(UnitarySysNum)%RequestAutosize = .TRUE.</span>
<a name="ln-2348"></a><span class="c">!    IF (ErrFlag) THEN</span>
<a name="ln-2349"></a><span class="c">!      CALL ShowContinueError(&#39;Occurs in &#39;//TRIM(CurrentModuleObject)//&#39; = &#39;//TRIM(UnitarySystem(UnitarySysNum)%Name))</span>
<a name="ln-2350"></a><span class="c">!      ErrorsFound=.TRUE.</span>
<a name="ln-2351"></a><span class="c">!    END IF</span>
<a name="ln-2352"></a><span class="c">!  END IF</span>
<a name="ln-2353"></a>
<a name="ln-2354"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RequestAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2355"></a><span class="k">    CALL </span><span class="n">CheckSysSizing</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2356"></a>  <span class="k">ELSE IF</span><span class="p">(</span><span class="n">CurZoneEqNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2357"></a><span class="k">    CALL </span><span class="n">CheckZoneSizing</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2358"></a>  <span class="k">END IF</span>
<a name="ln-2359"></a>
<a name="ln-2360"></a><span class="k">  IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">/=</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2361"></a>    <span class="n">SysCoolingFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span>
<a name="ln-2362"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">/=</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2363"></a>    <span class="n">SysHeatingFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span>
<a name="ln-2364"></a>
<a name="ln-2365"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RequestAutosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2366"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2367"></a><span class="c">!    CALL CheckSysSizing(UnitarySystem(UnitarySysNum)%UnitarySystemType, UnitarySystem(UnitarySysNum)%Name)</span>
<a name="ln-2368"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilExists</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2369"></a><span class="k">      SELECT CASE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSAFMethod</span><span class="p">)</span>
<a name="ln-2370"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">SupplyAirFlowRate</span><span class="p">,</span> <span class="k">None</span><span class="p">)</span>
<a name="ln-2371"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2372"></a><span class="k">            </span><span class="n">SysCoolingFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span>
<a name="ln-2373"></a>          <span class="k">ELSE</span>
<a name="ln-2374"></a><span class="k">            </span><span class="n">SysCoolingFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span>
<a name="ln-2375"></a>          <span class="k">END IF</span>
<a name="ln-2376"></a><span class="k">          </span><span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2377"></a>          <span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">AirVolFlow</span> <span class="o">=</span> <span class="n">SysCoolingFlow</span>
<a name="ln-2378"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">FlowPerFloorArea</span><span class="p">)</span>
<a name="ln-2379"></a>          <span class="n">SysCoolingFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span>
<a name="ln-2380"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">=</span> <span class="n">Autosize</span>
<a name="ln-2381"></a>          <span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2382"></a>          <span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">AirVolFlow</span> <span class="o">=</span> <span class="n">SysCoolingFlow</span>
<a name="ln-2383"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">FractionOfAutosizedCoolingValue</span><span class="p">)</span>
<a name="ln-2384"></a>          <span class="n">SysCoolingFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-2385"></a>                           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span>
<a name="ln-2386"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">=</span> <span class="n">Autosize</span>
<a name="ln-2387"></a>          <span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2388"></a>          <span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">AirVolFlow</span> <span class="o">=</span> <span class="n">SysCoolingFlow</span>
<a name="ln-2389"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">FlowPerCoolingCapacity</span><span class="p">)</span>
<a name="ln-2390"></a>          <span class="n">VolFlowRate</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span>
<a name="ln-2391"></a>          <span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolOutTemp</span>
<a name="ln-2392"></a>          <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolOutHumRat</span>
<a name="ln-2393"></a>          <span class="n">SupTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolTemp</span>
<a name="ln-2394"></a>          <span class="n">SupHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolHumRat</span>
<a name="ln-2395"></a>          <span class="n">OutTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolOutTemp</span>
<a name="ln-2396"></a>          <span class="n">rhoair</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-2397"></a>          <span class="n">MixEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-2398"></a>          <span class="n">MixWetBulb</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-2399"></a>          <span class="n">SupEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">SupTemp</span><span class="p">,</span><span class="n">SupHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-2400"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingSingleSpeed</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2401"></a>             <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_MultiSpeedCooling</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2402"></a>             <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoSpeed</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2403"></a>             <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoStageWHumControl</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2404"></a><span class="k">              </span><span class="n">CapFTCurve</span> <span class="o">=</span> <span class="n">GetDXCoilCapFTCurveIndex</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span><span class="n">ErrFound</span><span class="p">)</span>
<a name="ln-2405"></a>            <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">CapFTCurve</span><span class="p">,</span><span class="n">MixWetBulb</span><span class="p">,</span><span class="n">OutTemp</span><span class="p">)</span>
<a name="ln-2406"></a>          <span class="k">ELSE</span>
<a name="ln-2407"></a><span class="k">            </span><span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2408"></a>          <span class="k">END IF</span>
<a name="ln-2409"></a><span class="k">          </span><span class="n">CoolCapAtPeak</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="p">(</span><span class="n">rhoair</span> <span class="o">*</span> <span class="n">VolFlowRate</span> <span class="o">*</span> <span class="p">(</span><span class="n">MixEnth</span><span class="o">-</span><span class="n">SupEnth</span><span class="p">)))</span>
<a name="ln-2410"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">TotCapTempModFac</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2411"></a><span class="k">            </span><span class="n">CoolCapAtPeak</span> <span class="o">=</span> <span class="n">CoolCapAtPeak</span> <span class="o">/</span> <span class="n">TotCapTempModFac</span>
<a name="ln-2412"></a>          <span class="k">END IF</span>
<a name="ln-2413"></a><span class="k">          </span><span class="n">SysCoolingFlow</span> <span class="o">=</span> <span class="n">CoolCapAtPeak</span> <span class="o">*</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span>
<a name="ln-2414"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">=</span> <span class="n">Autosize</span>
<a name="ln-2415"></a>          <span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2416"></a>          <span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">AirVolFlow</span> <span class="o">=</span> <span class="n">SysCoolingFlow</span>
<a name="ln-2417"></a>          <span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">Capacity</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2418"></a>          <span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">DesCoolingLoad</span> <span class="o">=</span> <span class="n">CoolCapAtPeak</span>
<a name="ln-2419"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2420"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2421"></a><span class="k">            </span><span class="n">SysCoolingFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span>
<a name="ln-2422"></a>          <span class="k">ELSE</span>
<a name="ln-2423"></a><span class="k">            </span><span class="n">SysCoolingFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span>
<a name="ln-2424"></a>          <span class="k">END IF</span>
<a name="ln-2425"></a><span class="k">      END SELECT</span>
<a name="ln-2426"></a><span class="k">    ELSE IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2427"></a><span class="k">      SELECT CASE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSAFMethod</span><span class="p">)</span>
<a name="ln-2428"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">SupplyAirFlowRate</span><span class="p">,</span> <span class="k">None</span><span class="p">)</span>
<a name="ln-2429"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2430"></a><span class="k">            </span><span class="n">SysHeatingFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span>
<a name="ln-2431"></a>          <span class="k">ELSE</span>
<a name="ln-2432"></a><span class="k">            </span><span class="n">SysHeatingFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span>
<a name="ln-2433"></a>          <span class="k">END IF</span>
<a name="ln-2434"></a><span class="k">          </span><span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2435"></a>          <span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">AirVolFlow</span> <span class="o">=</span> <span class="n">SysHeatingFlow</span>
<a name="ln-2436"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">FlowPerFloorArea</span><span class="p">)</span>
<a name="ln-2437"></a>          <span class="n">SysHeatingFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span>
<a name="ln-2438"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">=</span> <span class="n">Autosize</span>
<a name="ln-2439"></a>          <span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2440"></a>          <span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">AirVolFlow</span> <span class="o">=</span> <span class="n">SysHeatingFlow</span>
<a name="ln-2441"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">FractionOfAutosizedCoolingValue</span><span class="p">)</span>
<a name="ln-2442"></a>          <span class="n">SysHeatingFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-2443"></a>                           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span>
<a name="ln-2444"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">=</span> <span class="n">Autosize</span>
<a name="ln-2445"></a>          <span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2446"></a>          <span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">AirVolFlow</span> <span class="o">=</span> <span class="n">SysHeatingFlow</span>
<a name="ln-2447"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">FlowPerHeatingCapacity</span><span class="p">)</span>
<a name="ln-2448"></a>          <span class="n">VolFlowRate</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span>
<a name="ln-2449"></a>          <span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatOutTemp</span>
<a name="ln-2450"></a>          <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatOutHumRat</span>
<a name="ln-2451"></a>          <span class="n">SupTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolTemp</span>
<a name="ln-2452"></a>          <span class="n">SupHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolHumRat</span>
<a name="ln-2453"></a>          <span class="n">OutTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatOutTemp</span>
<a name="ln-2454"></a>          <span class="n">rhoair</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-2455"></a>          <span class="n">MixEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-2456"></a>          <span class="n">MixWetBulb</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-2457"></a>          <span class="n">SupEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">SupTemp</span><span class="p">,</span><span class="n">SupHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-2458"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_MultiSpeedHeating</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2459"></a>             <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_HeatingEmpirical</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2460"></a><span class="k">              </span><span class="n">CapFTCurve</span> <span class="o">=</span> <span class="n">GetDXCoilCapFTCurveIndex</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span><span class="n">ErrFound</span><span class="p">)</span>
<a name="ln-2461"></a>            <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">CapFTCurve</span><span class="p">,</span><span class="n">MixWetBulb</span><span class="p">,</span><span class="n">OutTemp</span><span class="p">)</span>
<a name="ln-2462"></a>          <span class="k">ELSE</span>
<a name="ln-2463"></a><span class="k">            </span><span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2464"></a>          <span class="k">END IF</span>
<a name="ln-2465"></a><span class="k">          </span><span class="n">HeatCapAtPeak</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="p">(</span><span class="n">rhoair</span> <span class="o">*</span> <span class="n">VolFlowRate</span> <span class="o">*</span> <span class="p">(</span><span class="n">SupEnth</span><span class="o">-</span><span class="n">MixEnth</span><span class="p">)))</span>
<a name="ln-2466"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">TotCapTempModFac</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2467"></a><span class="k">            </span><span class="n">HeatCapAtPeak</span> <span class="o">=</span> <span class="n">HeatCapAtPeak</span> <span class="o">/</span> <span class="n">TotCapTempModFac</span>
<a name="ln-2468"></a>          <span class="k">END IF</span>
<a name="ln-2469"></a><span class="k">          </span><span class="n">SysHeatingFlow</span> <span class="o">=</span> <span class="n">HeatCapAtPeak</span> <span class="o">*</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span>
<a name="ln-2470"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">=</span> <span class="n">Autosize</span>
<a name="ln-2471"></a>          <span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2472"></a>          <span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">AirVolFlow</span> <span class="o">=</span> <span class="n">SysCoolingFlow</span>
<a name="ln-2473"></a>          <span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">Capacity</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2474"></a>          <span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">DesCoolingLoad</span> <span class="o">=</span> <span class="n">HeatCapAtPeak</span>
<a name="ln-2475"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2476"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2477"></a><span class="k">            </span><span class="n">SysHeatingFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span>
<a name="ln-2478"></a>          <span class="k">ELSE</span>
<a name="ln-2479"></a><span class="k">            </span><span class="n">SysHeatingFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span>
<a name="ln-2480"></a>          <span class="k">END IF</span>
<a name="ln-2481"></a><span class="k">          </span><span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2482"></a>          <span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">AirVolFlow</span> <span class="o">=</span> <span class="n">SysCoolingFlow</span>
<a name="ln-2483"></a>      <span class="k">END SELECT</span>
<a name="ln-2484"></a><span class="k">    ELSE</span> <span class="c">! Cooling and Heating coil are present</span>
<a name="ln-2485"></a>      <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSAFMethod</span><span class="p">)</span>
<a name="ln-2486"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">SupplyAirFlowRate</span><span class="p">,</span> <span class="k">None</span><span class="p">)</span>
<a name="ln-2487"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2488"></a><span class="k">            </span><span class="n">SysCoolingFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span>
<a name="ln-2489"></a>          <span class="k">ELSE</span>
<a name="ln-2490"></a><span class="k">            </span><span class="n">SysCoolingFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span>
<a name="ln-2491"></a>          <span class="k">END IF</span>
<a name="ln-2492"></a><span class="k">          </span><span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2493"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">FlowPerFloorArea</span><span class="p">)</span>
<a name="ln-2494"></a>          <span class="n">SysCoolingFlow</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2495"></a>                               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span><span class="p">)</span>
<a name="ln-2496"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">=</span> <span class="n">Autosize</span>
<a name="ln-2497"></a>          <span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2498"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">FractionOfAutosizedCoolingValue</span><span class="p">)</span>
<a name="ln-2499"></a>          <span class="n">SysCoolingFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-2500"></a>              <span class="nb">MAX</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span><span class="p">)</span>
<a name="ln-2501"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">=</span> <span class="n">SysCoolingFlow</span>
<a name="ln-2502"></a>          <span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2503"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">FlowPerCoolingCapacity</span><span class="p">)</span>
<a name="ln-2504"></a>          <span class="n">VolFlowRate</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span>
<a name="ln-2505"></a>          <span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolOutTemp</span>
<a name="ln-2506"></a>          <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolOutHumRat</span>
<a name="ln-2507"></a>          <span class="n">SupTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolTemp</span>
<a name="ln-2508"></a>          <span class="n">SupHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolHumRat</span>
<a name="ln-2509"></a>          <span class="n">OutTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolOutTemp</span>
<a name="ln-2510"></a>          <span class="n">rhoair</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-2511"></a>          <span class="n">MixEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-2512"></a>          <span class="n">MixWetBulb</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-2513"></a>          <span class="n">SupEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">SupTemp</span><span class="p">,</span><span class="n">SupHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-2514"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingSingleSpeed</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2515"></a>             <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_MultiSpeedCooling</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2516"></a>             <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoSpeed</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2517"></a>             <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoStageWHumControl</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2518"></a><span class="k">              </span><span class="n">CapFTCurve</span> <span class="o">=</span> <span class="n">GetDXCoilCapFTCurveIndex</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span><span class="n">ErrFound</span><span class="p">)</span>
<a name="ln-2519"></a>            <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">CapFTCurve</span><span class="p">,</span><span class="n">MixWetBulb</span><span class="p">,</span><span class="n">OutTemp</span><span class="p">)</span>
<a name="ln-2520"></a>          <span class="k">ELSE</span>
<a name="ln-2521"></a><span class="k">            </span><span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2522"></a>          <span class="k">END IF</span>
<a name="ln-2523"></a><span class="k">          </span><span class="n">CoolCapAtPeak</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="p">(</span><span class="n">rhoair</span> <span class="o">*</span> <span class="n">VolFlowRate</span> <span class="o">*</span> <span class="p">(</span><span class="n">MixEnth</span><span class="o">-</span><span class="n">SupEnth</span><span class="p">)))</span>
<a name="ln-2524"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">TotCapTempModFac</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2525"></a><span class="k">            </span><span class="n">CoolCapAtPeak</span> <span class="o">=</span> <span class="n">CoolCapAtPeak</span> <span class="o">/</span> <span class="n">TotCapTempModFac</span>
<a name="ln-2526"></a>          <span class="k">END IF</span>
<a name="ln-2527"></a><span class="k">          </span><span class="n">SysCoolingFlow</span> <span class="o">=</span> <span class="n">CoolCapAtPeak</span> <span class="o">*</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span>
<a name="ln-2528"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">=</span> <span class="n">Autosize</span>
<a name="ln-2529"></a>          <span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2530"></a>          <span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">Capacity</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2531"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2532"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2533"></a><span class="k">            </span><span class="n">SysCoolingFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span>
<a name="ln-2534"></a>          <span class="k">ELSE</span>
<a name="ln-2535"></a><span class="k">            </span><span class="n">SysCoolingFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span>
<a name="ln-2536"></a>          <span class="k">END IF</span>
<a name="ln-2537"></a><span class="k">          </span><span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2538"></a>      <span class="k">END SELECT</span>
<a name="ln-2539"></a><span class="k">      SELECT CASE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSAFMethod</span><span class="p">)</span>
<a name="ln-2540"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">SupplyAirFlowRate</span><span class="p">,</span> <span class="k">None</span><span class="p">)</span>
<a name="ln-2541"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2542"></a><span class="k">            </span><span class="n">SysHeatingFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span>
<a name="ln-2543"></a>          <span class="k">ELSE</span>
<a name="ln-2544"></a><span class="k">            </span><span class="n">SysHeatingFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span>
<a name="ln-2545"></a>          <span class="k">END IF</span>
<a name="ln-2546"></a><span class="k">          </span><span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2547"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">FlowPerFloorArea</span><span class="p">)</span>
<a name="ln-2548"></a>          <span class="n">SysHeatingFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span>
<a name="ln-2549"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">=</span> <span class="n">Autosize</span>
<a name="ln-2550"></a>          <span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2551"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">FractionOfAutosizedCoolingValue</span><span class="p">)</span>
<a name="ln-2552"></a>          <span class="n">SysHeatingFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-2553"></a>              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span>
<a name="ln-2554"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">=</span> <span class="n">SysHeatingFlow</span>
<a name="ln-2555"></a>          <span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2556"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">FlowPerHeatingCapacity</span><span class="p">)</span>
<a name="ln-2557"></a>          <span class="n">VolFlowRate</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span>
<a name="ln-2558"></a>          <span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatOutTemp</span>
<a name="ln-2559"></a>          <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatOutHumRat</span>
<a name="ln-2560"></a>          <span class="n">SupTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolTemp</span>
<a name="ln-2561"></a>          <span class="n">SupHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolHumRat</span>
<a name="ln-2562"></a>          <span class="n">OutTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatOutTemp</span>
<a name="ln-2563"></a>          <span class="n">rhoair</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-2564"></a>          <span class="n">MixEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-2565"></a>          <span class="n">MixWetBulb</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-2566"></a>          <span class="n">SupEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">SupTemp</span><span class="p">,</span><span class="n">SupHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-2567"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_MultiSpeedHeating</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2568"></a>             <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_HeatingEmpirical</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2569"></a><span class="k">              </span><span class="n">CapFTCurve</span> <span class="o">=</span> <span class="n">GetDXCoilCapFTCurveIndex</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span><span class="n">ErrFound</span><span class="p">)</span>
<a name="ln-2570"></a>            <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">CapFTCurve</span><span class="p">,</span><span class="n">MixWetBulb</span><span class="p">,</span><span class="n">OutTemp</span><span class="p">)</span>
<a name="ln-2571"></a>          <span class="k">ELSE</span>
<a name="ln-2572"></a><span class="k">            </span><span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2573"></a>          <span class="k">END IF</span>
<a name="ln-2574"></a><span class="k">          </span><span class="n">HeatCapAtPeak</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="p">(</span><span class="n">rhoair</span> <span class="o">*</span> <span class="n">VolFlowRate</span> <span class="o">*</span> <span class="p">(</span><span class="n">SupEnth</span><span class="o">-</span><span class="n">MixEnth</span><span class="p">)))</span>
<a name="ln-2575"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">TotCapTempModFac</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2576"></a><span class="k">            </span><span class="n">HeatCapAtPeak</span> <span class="o">=</span> <span class="n">HeatCapAtPeak</span> <span class="o">/</span> <span class="n">TotCapTempModFac</span>
<a name="ln-2577"></a>          <span class="k">END IF</span>
<a name="ln-2578"></a><span class="k">          </span><span class="n">SysHeatingFlow</span> <span class="o">=</span> <span class="n">HeatCapAtPeak</span> <span class="o">*</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span>
<a name="ln-2579"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">=</span> <span class="n">Autosize</span>
<a name="ln-2580"></a>          <span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2581"></a>          <span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">Capacity</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2582"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2583"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2584"></a><span class="k">            </span><span class="n">SysHeatingFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span>
<a name="ln-2585"></a>          <span class="k">ELSE</span>
<a name="ln-2586"></a><span class="k">            </span><span class="n">SysHeatingFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span>
<a name="ln-2587"></a>          <span class="k">END IF</span>
<a name="ln-2588"></a><span class="k">          </span><span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2589"></a>      <span class="k">END SELECT</span>
<a name="ln-2590"></a><span class="k">      </span><span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">AirVolFlow</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">SysCoolingFlow</span><span class="p">,</span><span class="n">SysHeatingFlow</span><span class="p">)</span>
<a name="ln-2591"></a>      <span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">DesHeatingLoad</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">CoolCapAtPeak</span><span class="p">,</span><span class="n">HeatCapAtPeak</span><span class="p">)</span>
<a name="ln-2592"></a>    <span class="k">END IF</span>
<a name="ln-2593"></a><span class="k">  ELSE</span>
<a name="ln-2594"></a>
<a name="ln-2595"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2596"></a>
<a name="ln-2597"></a><span class="c">!      CALL CheckSysSizing(UnitarySystem(UnitarySysNum)%UnitarySystemType, UnitarySystem(UnitarySysNum)%Name)</span>
<a name="ln-2598"></a>
<a name="ln-2599"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilExists</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2600"></a><span class="k">        SELECT CASE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSAFMethod</span><span class="p">)</span>
<a name="ln-2601"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">SupplyAirFlowRate</span><span class="p">,</span> <span class="k">None</span><span class="p">)</span>
<a name="ln-2602"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2603"></a><span class="k">              </span><span class="n">SysCoolingFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-2604"></a>            <span class="k">ELSE</span>
<a name="ln-2605"></a><span class="k">              </span><span class="n">SysCoolingFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span>
<a name="ln-2606"></a>            <span class="k">END IF</span>
<a name="ln-2607"></a><span class="k">            </span><span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2608"></a>            <span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">AirVolFlow</span> <span class="o">=</span> <span class="n">SysCoolingFlow</span>
<a name="ln-2609"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">FlowPerFloorArea</span><span class="p">)</span>
<a name="ln-2610"></a>            <span class="n">SysCoolingFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span>
<a name="ln-2611"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">=</span> <span class="n">Autosize</span>
<a name="ln-2612"></a>            <span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2613"></a>            <span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">AirVolFlow</span> <span class="o">=</span> <span class="n">SysCoolingFlow</span>
<a name="ln-2614"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">FractionOfAutosizedCoolingValue</span><span class="p">)</span>
<a name="ln-2615"></a>            <span class="n">SysCoolingFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-2616"></a>                             <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span>
<a name="ln-2617"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">=</span> <span class="n">Autosize</span>
<a name="ln-2618"></a>            <span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2619"></a>            <span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">AirVolFlow</span> <span class="o">=</span> <span class="n">SysCoolingFlow</span>
<a name="ln-2620"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">FlowPerCoolingCapacity</span><span class="p">)</span>
<a name="ln-2621"></a>            <span class="n">VolFlowRate</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-2622"></a>            <span class="n">SupTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolSupTemp</span>
<a name="ln-2623"></a>            <span class="n">SupHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolSupHumRat</span>
<a name="ln-2624"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">NumOACoolCoils</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! there is no precooling of the OA stream</span>
<a name="ln-2625"></a>              <span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolMixTemp</span>
<a name="ln-2626"></a>              <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolMixHumRat</span>
<a name="ln-2627"></a>            <span class="k">ELSE</span> <span class="c">! there is precooling of OA stream</span>
<a name="ln-2628"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">VolFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2629"></a><span class="k">                </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span> <span class="o">/</span> <span class="n">VolFlowRate</span>
<a name="ln-2630"></a>              <span class="k">ELSE</span>
<a name="ln-2631"></a><span class="k">                </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2632"></a>              <span class="k">END IF</span>
<a name="ln-2633"></a><span class="k">              </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">OutAirFrac</span><span class="p">))</span>
<a name="ln-2634"></a>              <span class="n">MixTemp</span> <span class="o">=</span> <span class="n">OutAirFrac</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolTemp</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2635"></a>                          <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">OutAirFrac</span><span class="p">)</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolRetTemp</span>
<a name="ln-2636"></a>              <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">OutAirFrac</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolHumRat</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2637"></a>                            <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">OutAirFrac</span><span class="p">)</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolRetHumRat</span>
<a name="ln-2638"></a>            <span class="k">END IF</span>
<a name="ln-2639"></a><span class="k">            </span><span class="n">OutTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolOutTemp</span>
<a name="ln-2640"></a>            <span class="n">rhoair</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-2641"></a>            <span class="n">MixEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-2642"></a>            <span class="n">MixWetBulb</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-2643"></a>            <span class="n">SupEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">SupTemp</span><span class="p">,</span><span class="n">SupHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-2644"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingSingleSpeed</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2645"></a>               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_MultiSpeedCooling</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2646"></a>               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoSpeed</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2647"></a>               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoStageWHumControl</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2648"></a><span class="k">                </span><span class="n">CapFTCurve</span> <span class="o">=</span> <span class="n">GetDXCoilCapFTCurveIndex</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span><span class="n">ErrFound</span><span class="p">)</span>
<a name="ln-2649"></a>              <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">CapFTCurve</span><span class="p">,</span><span class="n">MixWetBulb</span><span class="p">,</span><span class="n">OutTemp</span><span class="p">)</span>
<a name="ln-2650"></a>            <span class="k">ELSE</span>
<a name="ln-2651"></a><span class="k">              </span><span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2652"></a>            <span class="k">END IF</span>
<a name="ln-2653"></a><span class="k">            </span><span class="n">CoolCapAtPeak</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="p">(</span><span class="n">rhoair</span> <span class="o">*</span> <span class="n">VolFlowRate</span> <span class="o">*</span> <span class="p">(</span><span class="n">MixEnth</span><span class="o">-</span><span class="n">SupEnth</span><span class="p">)))</span>
<a name="ln-2654"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">TotCapTempModFac</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2655"></a><span class="k">              </span><span class="n">CoolCapAtPeak</span> <span class="o">=</span> <span class="n">CoolCapAtPeak</span> <span class="o">/</span> <span class="n">TotCapTempModFac</span>
<a name="ln-2656"></a>            <span class="k">END IF</span>
<a name="ln-2657"></a><span class="k">            </span><span class="n">SysCoolingFlow</span> <span class="o">=</span> <span class="n">CoolCapAtPeak</span> <span class="o">*</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span>
<a name="ln-2658"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">=</span> <span class="n">Autosize</span>
<a name="ln-2659"></a>            <span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2660"></a>            <span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">AirVolFlow</span> <span class="o">=</span> <span class="n">SysCoolingFlow</span>
<a name="ln-2661"></a>            <span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">Capacity</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2662"></a>            <span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesCoolingLoad</span> <span class="o">=</span> <span class="n">CoolCapAtPeak</span>
<a name="ln-2663"></a>          <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2664"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2665"></a><span class="k">              </span><span class="n">SysCoolingFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-2666"></a>            <span class="k">ELSE</span>
<a name="ln-2667"></a><span class="k">              </span><span class="n">SysCoolingFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span>
<a name="ln-2668"></a>            <span class="k">END IF</span>
<a name="ln-2669"></a><span class="k">            </span><span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2670"></a>            <span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">AirVolFlow</span> <span class="o">=</span> <span class="n">SysCoolingFlow</span>
<a name="ln-2671"></a>        <span class="k">END SELECT</span>
<a name="ln-2672"></a><span class="k">      ELSE IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2673"></a><span class="k">        SELECT CASE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSAFMethod</span><span class="p">)</span>
<a name="ln-2674"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">SupplyAirFlowRate</span><span class="p">)</span>
<a name="ln-2675"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2676"></a><span class="k">              </span><span class="n">SysHeatingFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-2677"></a>            <span class="k">ELSE</span>
<a name="ln-2678"></a><span class="k">              </span><span class="n">SysHeatingFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span>
<a name="ln-2679"></a>            <span class="k">END IF</span>
<a name="ln-2680"></a><span class="k">            </span><span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2681"></a>            <span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">AirVolFlow</span> <span class="o">=</span> <span class="n">SysHeatingFlow</span>
<a name="ln-2682"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">FlowPerFloorArea</span><span class="p">)</span>
<a name="ln-2683"></a>            <span class="n">SysHeatingFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span>
<a name="ln-2684"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">=</span> <span class="n">Autosize</span>
<a name="ln-2685"></a>            <span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2686"></a>            <span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">AirVolFlow</span> <span class="o">=</span> <span class="n">SysHeatingFlow</span>
<a name="ln-2687"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">FractionOfAutosizedCoolingValue</span><span class="p">)</span>
<a name="ln-2688"></a>            <span class="n">SysHeatingFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-2689"></a>                             <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span>
<a name="ln-2690"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">=</span> <span class="n">Autosize</span>
<a name="ln-2691"></a>            <span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2692"></a>            <span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">AirVolFlow</span> <span class="o">=</span> <span class="n">SysHeatingFlow</span>
<a name="ln-2693"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">FlowPerHeatingCapacity</span><span class="p">)</span>
<a name="ln-2694"></a>            <span class="n">VolFlowRate</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-2695"></a>            <span class="n">SupTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatSupTemp</span>
<a name="ln-2696"></a>            <span class="n">SupHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatSupHumRat</span>
<a name="ln-2697"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">NumOACoolCoils</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! there is no precooling of the OA stream</span>
<a name="ln-2698"></a>              <span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatMixTemp</span>
<a name="ln-2699"></a>              <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatMixHumRat</span>
<a name="ln-2700"></a>            <span class="k">ELSE</span> <span class="c">! there is precooling of OA stream</span>
<a name="ln-2701"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">VolFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2702"></a><span class="k">                </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span> <span class="o">/</span> <span class="n">VolFlowRate</span>
<a name="ln-2703"></a>              <span class="k">ELSE</span>
<a name="ln-2704"></a><span class="k">                </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2705"></a>              <span class="k">END IF</span>
<a name="ln-2706"></a><span class="k">              </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">OutAirFrac</span><span class="p">))</span>
<a name="ln-2707"></a>              <span class="n">MixTemp</span> <span class="o">=</span> <span class="n">OutAirFrac</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolTemp</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2708"></a>                          <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">OutAirFrac</span><span class="p">)</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatRetTemp</span>
<a name="ln-2709"></a>              <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">OutAirFrac</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolHumRat</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2710"></a>                            <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">OutAirFrac</span><span class="p">)</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatRetHumRat</span>
<a name="ln-2711"></a>            <span class="k">END IF</span>
<a name="ln-2712"></a><span class="k">            </span><span class="n">OutTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatOutTemp</span>
<a name="ln-2713"></a>            <span class="n">rhoair</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-2714"></a>            <span class="n">MixEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-2715"></a>            <span class="n">MixWetBulb</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-2716"></a>            <span class="n">SupEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">SupTemp</span><span class="p">,</span><span class="n">SupHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-2717"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_MultiSpeedHeating</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2718"></a>               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_HeatingEmpirical</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2719"></a><span class="k">                </span><span class="n">CapFTCurve</span> <span class="o">=</span> <span class="n">GetDXCoilCapFTCurveIndex</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span><span class="n">ErrFound</span><span class="p">)</span>
<a name="ln-2720"></a>              <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">CapFTCurve</span><span class="p">,</span><span class="n">MixWetBulb</span><span class="p">,</span><span class="n">OutTemp</span><span class="p">)</span>
<a name="ln-2721"></a>            <span class="k">ELSE</span>
<a name="ln-2722"></a><span class="k">              </span><span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2723"></a>            <span class="k">END IF</span>
<a name="ln-2724"></a><span class="k">            </span><span class="n">HeatCapAtPeak</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="p">(</span><span class="n">rhoair</span> <span class="o">*</span> <span class="n">VolFlowRate</span> <span class="o">*</span> <span class="p">(</span><span class="n">SupEnth</span><span class="o">-</span><span class="n">MixEnth</span><span class="p">)))</span>
<a name="ln-2725"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">TotCapTempModFac</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2726"></a><span class="k">              </span><span class="n">HeatCapAtPeak</span> <span class="o">=</span> <span class="n">HeatCapAtPeak</span> <span class="o">/</span> <span class="n">TotCapTempModFac</span>
<a name="ln-2727"></a>            <span class="k">END IF</span>
<a name="ln-2728"></a><span class="k">            </span><span class="n">SysHeatingFlow</span> <span class="o">=</span> <span class="n">HeatCapAtPeak</span> <span class="o">*</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span>
<a name="ln-2729"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">=</span> <span class="n">Autosize</span>
<a name="ln-2730"></a>            <span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2731"></a>            <span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">AirVolFlow</span> <span class="o">=</span> <span class="n">SysHeatingFlow</span>
<a name="ln-2732"></a>            <span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">Capacity</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2733"></a>            <span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesHeatingLoad</span> <span class="o">=</span> <span class="n">HeatCapAtPeak</span>
<a name="ln-2734"></a>          <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2735"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2736"></a><span class="k">              </span><span class="n">SysHeatingFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-2737"></a>            <span class="k">ELSE</span>
<a name="ln-2738"></a><span class="k">              </span><span class="n">SysHeatingFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span>
<a name="ln-2739"></a>            <span class="k">END IF</span>
<a name="ln-2740"></a><span class="k">            </span><span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2741"></a>            <span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">AirVolFlow</span> <span class="o">=</span> <span class="n">SysHeatingFlow</span>
<a name="ln-2742"></a>        <span class="k">END SELECT</span>
<a name="ln-2743"></a><span class="k">      ELSE</span> <span class="c">! Cooling and Heating coil are present</span>
<a name="ln-2744"></a>        <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSAFMethod</span><span class="p">)</span>
<a name="ln-2745"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">SupplyAirFlowRate</span><span class="p">,</span> <span class="k">None</span><span class="p">)</span>
<a name="ln-2746"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2747"></a><span class="k">              </span><span class="n">SysCoolingFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-2748"></a>            <span class="k">ELSE</span>
<a name="ln-2749"></a><span class="k">              </span><span class="n">SysCoolingFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span>
<a name="ln-2750"></a>            <span class="k">END IF</span>
<a name="ln-2751"></a><span class="k">            </span><span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2752"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">FlowPerFloorArea</span><span class="p">)</span>
<a name="ln-2753"></a>            <span class="n">SysCoolingFlow</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2754"></a>                                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span><span class="p">)</span>
<a name="ln-2755"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">=</span> <span class="n">Autosize</span>
<a name="ln-2756"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">=</span> <span class="n">Autosize</span>
<a name="ln-2757"></a>            <span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2758"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">FractionOfAutosizedCoolingValue</span><span class="p">)</span>
<a name="ln-2759"></a>            <span class="n">SysCoolingFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-2760"></a>                <span class="nb">MAX</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span><span class="p">)</span>
<a name="ln-2761"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">=</span> <span class="n">Autosize</span>
<a name="ln-2762"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">=</span> <span class="n">Autosize</span>
<a name="ln-2763"></a>            <span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2764"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">FlowPerCoolingCapacity</span><span class="p">)</span>
<a name="ln-2765"></a>            <span class="n">VolFlowRate</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-2766"></a>            <span class="n">SupTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolSupTemp</span>
<a name="ln-2767"></a>            <span class="n">SupHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolSupHumRat</span>
<a name="ln-2768"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">NumOACoolCoils</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! there is no precooling of the OA stream</span>
<a name="ln-2769"></a>              <span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolMixTemp</span>
<a name="ln-2770"></a>              <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolMixHumRat</span>
<a name="ln-2771"></a>            <span class="k">ELSE</span> <span class="c">! there is precooling of OA stream</span>
<a name="ln-2772"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">VolFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2773"></a><span class="k">                </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span> <span class="o">/</span> <span class="n">VolFlowRate</span>
<a name="ln-2774"></a>              <span class="k">ELSE</span>
<a name="ln-2775"></a><span class="k">                </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2776"></a>              <span class="k">END IF</span>
<a name="ln-2777"></a><span class="k">              </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">OutAirFrac</span><span class="p">))</span>
<a name="ln-2778"></a>              <span class="n">MixTemp</span> <span class="o">=</span> <span class="n">OutAirFrac</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolTemp</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2779"></a>                          <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">OutAirFrac</span><span class="p">)</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolRetTemp</span>
<a name="ln-2780"></a>              <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">OutAirFrac</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolHumRat</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2781"></a>                            <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">OutAirFrac</span><span class="p">)</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolRetHumRat</span>
<a name="ln-2782"></a>            <span class="k">END IF</span>
<a name="ln-2783"></a><span class="k">            </span><span class="n">OutTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolOutTemp</span>
<a name="ln-2784"></a>            <span class="n">rhoair</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-2785"></a>            <span class="n">MixEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-2786"></a>            <span class="n">MixWetBulb</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-2787"></a>            <span class="n">SupEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">SupTemp</span><span class="p">,</span><span class="n">SupHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-2788"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingSingleSpeed</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2789"></a>               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_MultiSpeedCooling</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2790"></a>               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoSpeed</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2791"></a>               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoStageWHumControl</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2792"></a><span class="k">              </span><span class="n">CapFTCurve</span> <span class="o">=</span> <span class="n">GetDXCoilCapFTCurveIndex</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span><span class="n">ErrFound</span><span class="p">)</span>
<a name="ln-2793"></a>              <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">CapFTCurve</span><span class="p">,</span><span class="n">MixWetBulb</span><span class="p">,</span><span class="n">OutTemp</span><span class="p">)</span>
<a name="ln-2794"></a>            <span class="k">ELSE</span>
<a name="ln-2795"></a><span class="k">              </span><span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2796"></a>            <span class="k">END IF</span>
<a name="ln-2797"></a><span class="k">            </span><span class="n">CoolCapAtPeak</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="p">(</span><span class="n">rhoair</span> <span class="o">*</span> <span class="n">VolFlowRate</span> <span class="o">*</span> <span class="p">(</span><span class="n">MixEnth</span><span class="o">-</span><span class="n">SupEnth</span><span class="p">)))</span>
<a name="ln-2798"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">TotCapTempModFac</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2799"></a><span class="k">              </span><span class="n">CoolCapAtPeak</span> <span class="o">=</span> <span class="n">CoolCapAtPeak</span> <span class="o">/</span> <span class="n">TotCapTempModFac</span>
<a name="ln-2800"></a>            <span class="k">END IF</span>
<a name="ln-2801"></a><span class="k">            </span><span class="n">SysCoolingFlow</span> <span class="o">=</span> <span class="n">CoolCapAtPeak</span> <span class="o">*</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span>
<a name="ln-2802"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">=</span> <span class="n">Autosize</span>
<a name="ln-2803"></a>            <span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2804"></a>            <span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">Capacity</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2805"></a>          <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2806"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2807"></a><span class="k">              </span><span class="n">SysCoolingFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-2808"></a>            <span class="k">ELSE</span>
<a name="ln-2809"></a><span class="k">              </span><span class="n">SysCoolingFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span>
<a name="ln-2810"></a>            <span class="k">END IF</span>
<a name="ln-2811"></a><span class="k">            </span><span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2812"></a>        <span class="k">END SELECT</span>
<a name="ln-2813"></a><span class="k">        SELECT CASE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSAFMethod</span><span class="p">)</span>
<a name="ln-2814"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">SupplyAirFlowRate</span><span class="p">)</span>
<a name="ln-2815"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2816"></a><span class="k">              </span><span class="n">SysHeatingFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-2817"></a>            <span class="k">ELSE</span>
<a name="ln-2818"></a><span class="k">              </span><span class="n">SysHeatingFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span>
<a name="ln-2819"></a>            <span class="k">END IF</span>
<a name="ln-2820"></a><span class="k">            </span><span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2821"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">FlowPerFloorArea</span><span class="p">)</span>
<a name="ln-2822"></a>            <span class="n">SysHeatingFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span>
<a name="ln-2823"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">=</span> <span class="n">Autosize</span>
<a name="ln-2824"></a>            <span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2825"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">FractionOfAutosizedCoolingValue</span><span class="p">)</span>
<a name="ln-2826"></a>            <span class="n">SysHeatingFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-2827"></a>                             <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span>
<a name="ln-2828"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">=</span> <span class="n">Autosize</span>
<a name="ln-2829"></a>            <span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2830"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">FlowPerHeatingCapacity</span><span class="p">)</span>
<a name="ln-2831"></a>            <span class="n">VolFlowRate</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-2832"></a>            <span class="n">SupTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatSupTemp</span>
<a name="ln-2833"></a>            <span class="n">SupHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatSupHumRat</span>
<a name="ln-2834"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">NumOACoolCoils</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! there is no precooling of the OA stream</span>
<a name="ln-2835"></a>              <span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatMixTemp</span>
<a name="ln-2836"></a>              <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatMixHumRat</span>
<a name="ln-2837"></a>            <span class="k">ELSE</span> <span class="c">! there is precooling of OA stream</span>
<a name="ln-2838"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">VolFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2839"></a><span class="k">                </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span> <span class="o">/</span> <span class="n">VolFlowRate</span>
<a name="ln-2840"></a>              <span class="k">ELSE</span>
<a name="ln-2841"></a><span class="k">                </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2842"></a>              <span class="k">END IF</span>
<a name="ln-2843"></a><span class="k">              </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">OutAirFrac</span><span class="p">))</span>
<a name="ln-2844"></a>              <span class="n">MixTemp</span> <span class="o">=</span> <span class="n">OutAirFrac</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolTemp</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2845"></a>                          <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">OutAirFrac</span><span class="p">)</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatRetTemp</span>
<a name="ln-2846"></a>              <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">OutAirFrac</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolHumRat</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2847"></a>                            <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">OutAirFrac</span><span class="p">)</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatRetHumRat</span>
<a name="ln-2848"></a>            <span class="k">END IF</span>
<a name="ln-2849"></a><span class="k">            </span><span class="n">OutTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatOutTemp</span>
<a name="ln-2850"></a>            <span class="n">rhoair</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-2851"></a>            <span class="n">MixEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-2852"></a>            <span class="n">MixWetBulb</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-2853"></a>            <span class="n">SupEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">SupTemp</span><span class="p">,</span><span class="n">SupHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-2854"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_MultiSpeedHeating</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2855"></a>               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_HeatingEmpirical</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2856"></a><span class="k">              </span><span class="n">CapFTCurve</span> <span class="o">=</span> <span class="n">GetDXCoilCapFTCurveIndex</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span><span class="n">ErrFound</span><span class="p">)</span>
<a name="ln-2857"></a>              <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">CapFTCurve</span><span class="p">,</span><span class="n">MixWetBulb</span><span class="p">,</span><span class="n">OutTemp</span><span class="p">)</span>
<a name="ln-2858"></a>            <span class="k">ELSE</span>
<a name="ln-2859"></a><span class="k">              </span><span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2860"></a>            <span class="k">END IF</span>
<a name="ln-2861"></a><span class="k">            </span><span class="n">HeatCapAtPeak</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="p">(</span><span class="n">rhoair</span> <span class="o">*</span> <span class="n">VolFlowRate</span> <span class="o">*</span> <span class="p">(</span><span class="n">SupEnth</span><span class="o">-</span><span class="n">MixEnth</span><span class="p">)))</span>
<a name="ln-2862"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">TotCapTempModFac</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2863"></a><span class="k">              </span><span class="n">HeatCapAtPeak</span> <span class="o">=</span> <span class="n">HeatCapAtPeak</span> <span class="o">/</span> <span class="n">TotCapTempModFac</span>
<a name="ln-2864"></a>            <span class="k">END IF</span>
<a name="ln-2865"></a><span class="k">            </span><span class="n">SysHeatingFlow</span> <span class="o">=</span> <span class="n">HeatCapAtPeak</span> <span class="o">*</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span>
<a name="ln-2866"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">=</span> <span class="n">Autosize</span>
<a name="ln-2867"></a>            <span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2868"></a>            <span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">Capacity</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2869"></a>          <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2870"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2871"></a><span class="k">              </span><span class="n">SysHeatingFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-2872"></a>            <span class="k">ELSE</span>
<a name="ln-2873"></a><span class="k">              </span><span class="n">SysHeatingFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span>
<a name="ln-2874"></a>            <span class="k">END IF</span>
<a name="ln-2875"></a><span class="k">            </span><span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2876"></a>        <span class="k">END SELECT</span>
<a name="ln-2877"></a><span class="k">        </span><span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">AirVolFlow</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">SysCoolingFlow</span><span class="p">,</span><span class="n">SysHeatingFlow</span><span class="p">)</span>
<a name="ln-2878"></a>        <span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesCoolingLoad</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">CoolCapAtPeak</span><span class="p">,</span><span class="n">HeatCapAtPeak</span><span class="p">)</span>
<a name="ln-2879"></a>      <span class="k">END IF</span>
<a name="ln-2880"></a><span class="k">    </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">CurZoneEqNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2881"></a>      <span class="c">! if we keep this (zone equipment) then we should probably check to see IF a cooling/heating coil is present</span>
<a name="ln-2882"></a>      <span class="c">! and use just cooling if only a cooling coil, or just heating if only a heating coil</span>
<a name="ln-2883"></a><span class="c">!      CALL CheckZoneSizing(UnitarySystem(UnitarySysNum)%UnitarySystemType, UnitarySystem(UnitarySysNum)%Name)</span>
<a name="ln-2884"></a>
<a name="ln-2885"></a>       <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilExists</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2886"></a><span class="k">         </span><span class="n">ZoneCoolingOnlyFan</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2887"></a>         <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSAFMethod</span><span class="p">)</span>
<a name="ln-2888"></a>           <span class="k">CASE</span> <span class="p">(</span><span class="n">SupplyAirFlowRate</span><span class="p">)</span>
<a name="ln-2889"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2890"></a><span class="k">              </span><span class="n">SysCoolingFlow</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolVolFlow</span>
<a name="ln-2891"></a>            <span class="k">ELSE</span>
<a name="ln-2892"></a><span class="k">              </span><span class="n">SysCoolingFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span>
<a name="ln-2893"></a>            <span class="k">END IF</span>
<a name="ln-2894"></a><span class="k">            </span><span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2895"></a>            <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirVolFlow</span> <span class="o">=</span> <span class="n">SysCoolingFlow</span>
<a name="ln-2896"></a>           <span class="k">CASE</span> <span class="p">(</span><span class="n">FlowPerFloorArea</span><span class="p">)</span>
<a name="ln-2897"></a>             <span class="n">SysCoolingFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span>
<a name="ln-2898"></a>             <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">=</span> <span class="n">Autosize</span>
<a name="ln-2899"></a>             <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2900"></a>             <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirVolFlow</span> <span class="o">=</span> <span class="n">SysCoolingFlow</span>
<a name="ln-2901"></a>           <span class="k">CASE</span> <span class="p">(</span><span class="n">FractionOfAutosizedCoolingValue</span><span class="p">)</span>
<a name="ln-2902"></a>             <span class="n">SysCoolingFlow</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolVolFlow</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-2903"></a>                              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span>
<a name="ln-2904"></a>             <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">=</span> <span class="n">Autosize</span>
<a name="ln-2905"></a>             <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2906"></a>             <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirVolFlow</span> <span class="o">=</span> <span class="n">SysCoolingFlow</span>
<a name="ln-2907"></a>           <span class="k">CASE</span> <span class="p">(</span><span class="n">FlowPerCoolingCapacity</span><span class="p">)</span>
<a name="ln-2908"></a>             <span class="n">VolFlowRate</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolVolFlow</span>
<a name="ln-2909"></a>             <span class="k">IF</span><span class="p">(</span><span class="n">ZoneEqDXCoil</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2910"></a><span class="k">               IF</span> <span class="p">(</span><span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">OAVolFlow</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2911"></a><span class="k">                 </span><span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolCoilInTemp</span>
<a name="ln-2912"></a>                 <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolCoilInHumRat</span>
<a name="ln-2913"></a>               <span class="k">ELSE</span>
<a name="ln-2914"></a><span class="k">                 </span><span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">ZoneRetTempAtCoolPeak</span>
<a name="ln-2915"></a>                 <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">ZoneHumRatAtCoolPeak</span>
<a name="ln-2916"></a>               <span class="k">END IF</span>
<a name="ln-2917"></a><span class="k">             ELSE</span>
<a name="ln-2918"></a><span class="k">               </span><span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolCoilInTemp</span>
<a name="ln-2919"></a>               <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolCoilInHumRat</span>
<a name="ln-2920"></a>             <span class="k">END IF</span>
<a name="ln-2921"></a><span class="k">             </span><span class="n">SupTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">CoolDesTemp</span>
<a name="ln-2922"></a>             <span class="n">SupHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">CoolDesHumRat</span>
<a name="ln-2923"></a>             <span class="n">TimeStepNumAtMax</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">TimeStepNumAtCoolMax</span>
<a name="ln-2924"></a>             <span class="n">DDNum</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">CoolDDNum</span>
<a name="ln-2925"></a>             <span class="k">IF</span> <span class="p">(</span><span class="n">DDNum</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">TimeStepNumAtMax</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2926"></a><span class="k">               </span><span class="n">OutTemp</span> <span class="o">=</span> <span class="n">DesDayWeath</span><span class="p">(</span><span class="n">DDNum</span><span class="p">)%</span><span class="n">Temp</span><span class="p">(</span><span class="n">TimeStepNumAtMax</span><span class="p">)</span>
<a name="ln-2927"></a>             <span class="k">ELSE</span>
<a name="ln-2928"></a><span class="k">               </span><span class="n">OutTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2929"></a>             <span class="k">END IF</span>
<a name="ln-2930"></a><span class="k">             </span><span class="n">rhoair</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-2931"></a>             <span class="n">MixEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-2932"></a>             <span class="n">MixWetBulb</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-2933"></a>             <span class="n">SupEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">SupTemp</span><span class="p">,</span><span class="n">SupHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-2934"></a>             <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingSingleSpeed</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2935"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_MultiSpeedCooling</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2936"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoSpeed</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2937"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoStageWHumControl</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2938"></a><span class="k">               </span><span class="n">CapFTCurve</span> <span class="o">=</span> <span class="n">GetDXCoilCapFTCurveIndex</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span><span class="n">ErrFound</span><span class="p">)</span>
<a name="ln-2939"></a>               <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">CapFTCurve</span><span class="p">,</span><span class="n">MixWetBulb</span><span class="p">,</span><span class="n">OutTemp</span><span class="p">)</span>
<a name="ln-2940"></a>             <span class="k">ELSE</span>
<a name="ln-2941"></a><span class="k">               </span><span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2942"></a>             <span class="k">END IF</span>
<a name="ln-2943"></a><span class="k">             </span><span class="n">CoolCapAtPeak</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="p">(</span><span class="n">rhoair</span> <span class="o">*</span> <span class="n">VolFlowRate</span> <span class="o">*</span> <span class="p">(</span><span class="n">MixEnth</span><span class="o">-</span><span class="n">SupEnth</span><span class="p">)))</span>
<a name="ln-2944"></a>             <span class="k">IF</span><span class="p">(</span><span class="n">TotCapTempModFac</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2945"></a><span class="k">               </span><span class="n">CoolCapAtPeak</span> <span class="o">=</span> <span class="n">CoolCapAtPeak</span> <span class="o">/</span> <span class="n">TotCapTempModFac</span>
<a name="ln-2946"></a>             <span class="k">END IF</span>
<a name="ln-2947"></a><span class="k">             </span><span class="n">SysCoolingFlow</span> <span class="o">=</span> <span class="n">CoolCapAtPeak</span> <span class="o">*</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span>
<a name="ln-2948"></a>             <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">=</span> <span class="n">Autosize</span>
<a name="ln-2949"></a>             <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2950"></a>             <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirVolFlow</span> <span class="o">=</span> <span class="n">SysCoolingFlow</span>
<a name="ln-2951"></a>             <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">Capacity</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2952"></a>             <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolingLoad</span> <span class="o">=</span> <span class="n">CoolCapAtPeak</span>
<a name="ln-2953"></a>           <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2954"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2955"></a><span class="k">              </span><span class="n">SysCoolingFlow</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolVolFlow</span>
<a name="ln-2956"></a>            <span class="k">ELSE</span>
<a name="ln-2957"></a><span class="k">              </span><span class="n">SysCoolingFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span>
<a name="ln-2958"></a>            <span class="k">END IF</span>
<a name="ln-2959"></a><span class="k">            </span><span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2960"></a>            <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirVolFlow</span> <span class="o">=</span> <span class="n">SysCoolingFlow</span>
<a name="ln-2961"></a>         <span class="k">END SELECT</span>
<a name="ln-2962"></a><span class="k">       ELSE IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2963"></a><span class="k">         </span><span class="n">ZoneHeatingOnlyFan</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2964"></a>        <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSAFMethod</span><span class="p">)</span>
<a name="ln-2965"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">SupplyAirFlowRate</span><span class="p">)</span>
<a name="ln-2966"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2967"></a><span class="k">              </span><span class="n">SysHeatingFlow</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatVolFlow</span>
<a name="ln-2968"></a>            <span class="k">ELSE</span>
<a name="ln-2969"></a><span class="k">              </span><span class="n">SysHeatingFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span>
<a name="ln-2970"></a>            <span class="k">END IF</span>
<a name="ln-2971"></a><span class="k">            </span><span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2972"></a>            <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirVolFlow</span> <span class="o">=</span> <span class="n">SysHeatingFlow</span>
<a name="ln-2973"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">FlowPerFloorArea</span><span class="p">)</span>
<a name="ln-2974"></a>            <span class="n">SysHeatingFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span>
<a name="ln-2975"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">=</span> <span class="n">Autosize</span>
<a name="ln-2976"></a>            <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2977"></a>            <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirVolFlow</span> <span class="o">=</span> <span class="n">SysHeatingFlow</span>
<a name="ln-2978"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">FractionOfAutosizedCoolingValue</span><span class="p">)</span>
<a name="ln-2979"></a>            <span class="n">SysHeatingFlow</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatVolFlow</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-2980"></a>                             <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span>
<a name="ln-2981"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">=</span> <span class="n">Autosize</span>
<a name="ln-2982"></a>            <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2983"></a>            <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirVolFlow</span> <span class="o">=</span> <span class="n">SysHeatingFlow</span>
<a name="ln-2984"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">FlowPerHeatingCapacity</span><span class="p">)</span>
<a name="ln-2985"></a>            <span class="n">VolFlowRate</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatVolFlow</span>
<a name="ln-2986"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ZoneEqDXCoil</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2987"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">OAVolFlow</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2988"></a><span class="k">                </span><span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatCoilInTemp</span>
<a name="ln-2989"></a>                <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatCoilInHumRat</span>
<a name="ln-2990"></a>              <span class="k">ELSE</span>
<a name="ln-2991"></a><span class="k">                </span><span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">ZoneRetTempAtHeatPeak</span>
<a name="ln-2992"></a>                <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">ZoneHumRatAtHeatPeak</span>
<a name="ln-2993"></a>              <span class="k">END IF</span>
<a name="ln-2994"></a><span class="k">            ELSE</span>
<a name="ln-2995"></a><span class="k">              </span><span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatCoilInTemp</span>
<a name="ln-2996"></a>              <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatCoilInHumRat</span>
<a name="ln-2997"></a>            <span class="k">END IF</span>
<a name="ln-2998"></a><span class="k">            </span><span class="n">SupTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">HeatDesTemp</span>
<a name="ln-2999"></a>            <span class="n">SupHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">HeatDesHumRat</span>
<a name="ln-3000"></a>            <span class="n">TimeStepNumAtMax</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">TimeStepNumAtHeatMax</span>
<a name="ln-3001"></a>            <span class="n">DDNum</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">HeatDDNum</span>
<a name="ln-3002"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DDNum</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">TimeStepNumAtMax</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3003"></a><span class="k">              </span><span class="n">OutTemp</span> <span class="o">=</span> <span class="n">DesDayWeath</span><span class="p">(</span><span class="n">DDNum</span><span class="p">)%</span><span class="n">Temp</span><span class="p">(</span><span class="n">TimeStepNumAtMax</span><span class="p">)</span>
<a name="ln-3004"></a>            <span class="k">ELSE</span>
<a name="ln-3005"></a><span class="k">              </span><span class="n">OutTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3006"></a>            <span class="k">END IF</span>
<a name="ln-3007"></a><span class="k">            </span><span class="n">rhoair</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-3008"></a>            <span class="n">MixEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-3009"></a>            <span class="n">MixWetBulb</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-3010"></a>            <span class="n">SupEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">SupTemp</span><span class="p">,</span><span class="n">SupHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-3011"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_MultiSpeedHeating</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3012"></a>               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_HeatingEmpirical</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3013"></a><span class="k">              </span><span class="n">CapFTCurve</span> <span class="o">=</span> <span class="n">GetDXCoilCapFTCurveIndex</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span><span class="n">ErrFound</span><span class="p">)</span>
<a name="ln-3014"></a>              <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">CapFTCurve</span><span class="p">,</span><span class="n">MixWetBulb</span><span class="p">,</span><span class="n">OutTemp</span><span class="p">)</span>
<a name="ln-3015"></a>            <span class="k">ELSE</span>
<a name="ln-3016"></a><span class="k">              </span><span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-3017"></a>            <span class="k">END IF</span>
<a name="ln-3018"></a><span class="k">            </span><span class="n">HeatCapAtPeak</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="p">(</span><span class="n">rhoair</span> <span class="o">*</span> <span class="n">VolFlowRate</span> <span class="o">*</span> <span class="p">(</span><span class="n">SupEnth</span><span class="o">-</span><span class="n">MixEnth</span><span class="p">)))</span>
<a name="ln-3019"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">TotCapTempModFac</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3020"></a><span class="k">              </span><span class="n">HeatCapAtPeak</span> <span class="o">=</span> <span class="n">HeatCapAtPeak</span> <span class="o">/</span> <span class="n">TotCapTempModFac</span>
<a name="ln-3021"></a>            <span class="k">END IF</span>
<a name="ln-3022"></a><span class="k">            </span><span class="n">SysHeatingFlow</span> <span class="o">=</span> <span class="n">HeatCapAtPeak</span> <span class="o">*</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span>
<a name="ln-3023"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">=</span> <span class="n">Autosize</span>
<a name="ln-3024"></a>            <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3025"></a>            <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirVolFlow</span> <span class="o">=</span> <span class="n">SysHeatingFlow</span>
<a name="ln-3026"></a>            <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">Capacity</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3027"></a>            <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatingLoad</span> <span class="o">=</span> <span class="n">HeatCapAtPeak</span>
<a name="ln-3028"></a>          <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-3029"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3030"></a><span class="k">              </span><span class="n">SysHeatingFlow</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatVolFlow</span>
<a name="ln-3031"></a>            <span class="k">ELSE</span>
<a name="ln-3032"></a><span class="k">              </span><span class="n">SysHeatingFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span>
<a name="ln-3033"></a>            <span class="k">END IF</span>
<a name="ln-3034"></a><span class="k">            </span><span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3035"></a>            <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirVolFlow</span> <span class="o">=</span> <span class="n">SysHeatingFlow</span>
<a name="ln-3036"></a>        <span class="k">END SELECT</span>
<a name="ln-3037"></a><span class="k">      ELSE</span>
<a name="ln-3038"></a><span class="k">        SELECT CASE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSAFMethod</span><span class="p">)</span>
<a name="ln-3039"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">SupplyAirFlowRate</span><span class="p">,</span> <span class="k">None</span><span class="p">)</span>
<a name="ln-3040"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3041"></a><span class="k">              </span><span class="n">SysCoolingFlow</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolVolFlow</span>
<a name="ln-3042"></a>            <span class="k">ELSE</span>
<a name="ln-3043"></a><span class="k">              </span><span class="n">SysCoolingFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span>
<a name="ln-3044"></a>            <span class="k">END IF</span>
<a name="ln-3045"></a><span class="k">            </span><span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3046"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">FlowPerFloorArea</span><span class="p">)</span>
<a name="ln-3047"></a>            <span class="n">SysCoolingFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span>
<a name="ln-3048"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">=</span> <span class="n">Autosize</span> <span class="c">! allow reporting for sizing</span>
<a name="ln-3049"></a>            <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3050"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">FractionOfAutosizedCoolingValue</span><span class="p">)</span>
<a name="ln-3051"></a>            <span class="n">SysCoolingFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">*</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolVolFlow</span>
<a name="ln-3052"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">=</span> <span class="n">Autosize</span>
<a name="ln-3053"></a>            <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3054"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">FlowPerCoolingCapacity</span><span class="p">)</span>
<a name="ln-3055"></a>            <span class="n">VolFlowRate</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolVolFlow</span>
<a name="ln-3056"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ZoneEqDXCoil</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3057"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">OAVolFlow</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3058"></a><span class="k">                </span><span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolCoilInTemp</span>
<a name="ln-3059"></a>                <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolCoilInHumRat</span>
<a name="ln-3060"></a>              <span class="k">ELSE</span>
<a name="ln-3061"></a><span class="k">                </span><span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">ZoneRetTempAtCoolPeak</span>
<a name="ln-3062"></a>                <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">ZoneHumRatAtCoolPeak</span>
<a name="ln-3063"></a>              <span class="k">END IF</span>
<a name="ln-3064"></a><span class="k">            ELSE</span>
<a name="ln-3065"></a><span class="k">              </span><span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolCoilInTemp</span>
<a name="ln-3066"></a>              <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolCoilInHumRat</span>
<a name="ln-3067"></a>            <span class="k">END IF</span>
<a name="ln-3068"></a><span class="k">            </span><span class="n">SupTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">CoolDesTemp</span>
<a name="ln-3069"></a>            <span class="n">SupHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">CoolDesHumRat</span>
<a name="ln-3070"></a>            <span class="n">TimeStepNumAtMax</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">TimeStepNumAtCoolMax</span>
<a name="ln-3071"></a>            <span class="n">DDNum</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">CoolDDNum</span>
<a name="ln-3072"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DDNum</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">TimeStepNumAtMax</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3073"></a><span class="k">              </span><span class="n">OutTemp</span> <span class="o">=</span> <span class="n">DesDayWeath</span><span class="p">(</span><span class="n">DDNum</span><span class="p">)%</span><span class="n">Temp</span><span class="p">(</span><span class="n">TimeStepNumAtMax</span><span class="p">)</span>
<a name="ln-3074"></a>            <span class="k">ELSE</span>
<a name="ln-3075"></a><span class="k">              </span><span class="n">OutTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3076"></a>            <span class="k">END IF</span>
<a name="ln-3077"></a><span class="k">            </span><span class="n">rhoair</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-3078"></a>            <span class="n">MixEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-3079"></a>            <span class="n">MixWetBulb</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-3080"></a>            <span class="n">SupEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">SupTemp</span><span class="p">,</span><span class="n">SupHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-3081"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingSingleSpeed</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3082"></a>               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_MultiSpeedCooling</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3083"></a>               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoSpeed</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3084"></a>               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoStageWHumControl</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3085"></a><span class="k">              </span><span class="n">CapFTCurve</span> <span class="o">=</span> <span class="n">GetDXCoilCapFTCurveIndex</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span><span class="n">ErrFound</span><span class="p">)</span>
<a name="ln-3086"></a>              <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">CapFTCurve</span><span class="p">,</span><span class="n">MixWetBulb</span><span class="p">,</span><span class="n">OutTemp</span><span class="p">)</span>
<a name="ln-3087"></a>            <span class="k">ELSE</span>
<a name="ln-3088"></a><span class="k">              </span><span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-3089"></a>            <span class="k">END IF</span>
<a name="ln-3090"></a><span class="k">            </span><span class="n">CoolCapAtPeak</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="p">(</span><span class="n">rhoair</span> <span class="o">*</span> <span class="n">VolFlowRate</span> <span class="o">*</span> <span class="p">(</span><span class="n">MixEnth</span><span class="o">-</span><span class="n">SupEnth</span><span class="p">)))</span>
<a name="ln-3091"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">TotCapTempModFac</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3092"></a><span class="k">              </span><span class="n">CoolCapAtPeak</span> <span class="o">=</span> <span class="n">CoolCapAtPeak</span> <span class="o">/</span> <span class="n">TotCapTempModFac</span>
<a name="ln-3093"></a>            <span class="k">END IF</span>
<a name="ln-3094"></a><span class="k">            </span><span class="n">SysCoolingFlow</span> <span class="o">=</span> <span class="n">CoolCapAtPeak</span> <span class="o">*</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span>
<a name="ln-3095"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">=</span> <span class="n">Autosize</span>
<a name="ln-3096"></a>            <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3097"></a>            <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">Capacity</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3098"></a>          <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-3099"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3100"></a><span class="k">              </span><span class="n">SysCoolingFlow</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolVolFlow</span>
<a name="ln-3101"></a>            <span class="k">ELSE</span>
<a name="ln-3102"></a><span class="k">              </span><span class="n">SysCoolingFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span>
<a name="ln-3103"></a>            <span class="k">END IF</span>
<a name="ln-3104"></a><span class="k">            </span><span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3105"></a>        <span class="k">END SELECT</span>
<a name="ln-3106"></a><span class="k">        SELECT CASE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSAFMethod</span><span class="p">)</span>
<a name="ln-3107"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">SupplyAirFlowRate</span><span class="p">)</span>
<a name="ln-3108"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3109"></a><span class="k">              </span><span class="n">SysHeatingFlow</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatVolFlow</span>
<a name="ln-3110"></a>            <span class="k">ELSE</span>
<a name="ln-3111"></a><span class="k">              </span><span class="n">SysHeatingFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span>
<a name="ln-3112"></a>            <span class="k">END IF</span>
<a name="ln-3113"></a><span class="k">            </span><span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3114"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">FlowPerFloorArea</span><span class="p">)</span>
<a name="ln-3115"></a>            <span class="n">SysHeatingFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span>
<a name="ln-3116"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">=</span> <span class="n">Autosize</span>
<a name="ln-3117"></a>            <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3118"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">FractionOfAutosizedCoolingValue</span><span class="p">)</span>
<a name="ln-3119"></a>            <span class="n">SysHeatingFlow</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatVolFlow</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-3120"></a>                             <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span>
<a name="ln-3121"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">=</span> <span class="n">Autosize</span>
<a name="ln-3122"></a>            <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3123"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">FlowPerHeatingCapacity</span><span class="p">)</span>
<a name="ln-3124"></a>            <span class="n">VolFlowRate</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatVolFlow</span>
<a name="ln-3125"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ZoneEqDXCoil</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3126"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">OAVolFlow</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3127"></a><span class="k">                </span><span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatCoilInTemp</span>
<a name="ln-3128"></a>                <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatCoilInHumRat</span>
<a name="ln-3129"></a>              <span class="k">ELSE</span>
<a name="ln-3130"></a><span class="k">                </span><span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">ZoneRetTempAtHeatPeak</span>
<a name="ln-3131"></a>                <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">ZoneHumRatAtHeatPeak</span>
<a name="ln-3132"></a>              <span class="k">END IF</span>
<a name="ln-3133"></a><span class="k">            ELSE</span>
<a name="ln-3134"></a><span class="k">              </span><span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatCoilInTemp</span>
<a name="ln-3135"></a>              <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatCoilInHumRat</span>
<a name="ln-3136"></a>            <span class="k">END IF</span>
<a name="ln-3137"></a><span class="k">            </span><span class="n">SupTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">HeatDesTemp</span>
<a name="ln-3138"></a>            <span class="n">SupHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">HeatDesHumRat</span>
<a name="ln-3139"></a>            <span class="n">TimeStepNumAtMax</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">TimeStepNumAtHeatMax</span>
<a name="ln-3140"></a>            <span class="n">DDNum</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">HeatDDNum</span>
<a name="ln-3141"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DDNum</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">TimeStepNumAtMax</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3142"></a><span class="k">              </span><span class="n">OutTemp</span> <span class="o">=</span> <span class="n">DesDayWeath</span><span class="p">(</span><span class="n">DDNum</span><span class="p">)%</span><span class="n">Temp</span><span class="p">(</span><span class="n">TimeStepNumAtMax</span><span class="p">)</span>
<a name="ln-3143"></a>            <span class="k">ELSE</span>
<a name="ln-3144"></a><span class="k">              </span><span class="n">OutTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3145"></a>            <span class="k">END IF</span>
<a name="ln-3146"></a><span class="k">            </span><span class="n">rhoair</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-3147"></a>            <span class="n">MixEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-3148"></a>            <span class="n">MixWetBulb</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-3149"></a>            <span class="n">SupEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">SupTemp</span><span class="p">,</span><span class="n">SupHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-3150"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_MultiSpeedHeating</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3151"></a>               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_HeatingEmpirical</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3152"></a><span class="k">              </span><span class="n">CapFTCurve</span> <span class="o">=</span> <span class="n">GetDXCoilCapFTCurveIndex</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span><span class="n">ErrFound</span><span class="p">)</span>
<a name="ln-3153"></a>              <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">CapFTCurve</span><span class="p">,</span><span class="n">MixWetBulb</span><span class="p">,</span><span class="n">OutTemp</span><span class="p">)</span>
<a name="ln-3154"></a>            <span class="k">ELSE</span>
<a name="ln-3155"></a><span class="k">              </span><span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-3156"></a>            <span class="k">END IF</span>
<a name="ln-3157"></a><span class="k">            </span><span class="n">HeatCapAtPeak</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="p">(</span><span class="n">rhoair</span> <span class="o">*</span> <span class="n">VolFlowRate</span> <span class="o">*</span> <span class="p">(</span><span class="n">SupEnth</span><span class="o">-</span><span class="n">MixEnth</span><span class="p">)))</span>
<a name="ln-3158"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">TotCapTempModFac</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3159"></a><span class="k">              </span><span class="n">HeatCapAtPeak</span> <span class="o">=</span> <span class="n">HeatCapAtPeak</span> <span class="o">/</span> <span class="n">TotCapTempModFac</span>
<a name="ln-3160"></a>            <span class="k">END IF</span>
<a name="ln-3161"></a><span class="k">            </span><span class="n">SysHeatingFlow</span> <span class="o">=</span> <span class="n">HeatCapAtPeak</span> <span class="o">*</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span>
<a name="ln-3162"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">=</span> <span class="n">Autosize</span>
<a name="ln-3163"></a>            <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3164"></a>            <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">Capacity</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3165"></a>          <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-3166"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3167"></a><span class="k">              </span><span class="n">SysHeatingFlow</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatVolFlow</span>
<a name="ln-3168"></a>            <span class="k">ELSE</span>
<a name="ln-3169"></a><span class="k">              </span><span class="n">SysHeatingFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span>
<a name="ln-3170"></a>            <span class="k">END IF</span>
<a name="ln-3171"></a><span class="k">            </span><span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3172"></a>        <span class="k">END SELECT</span>
<a name="ln-3173"></a><span class="k">        </span><span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirVolFlow</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">SysCoolingFlow</span><span class="p">,</span><span class="n">SysHeatingFlow</span><span class="p">)</span>
<a name="ln-3174"></a>        <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolingLoad</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">CoolCapAtPeak</span><span class="p">,</span><span class="n">HeatCapAtPeak</span><span class="p">)</span>
<a name="ln-3175"></a>      <span class="k">END IF</span>
<a name="ln-3176"></a><span class="k">    END IF</span>
<a name="ln-3177"></a><span class="k">  END IF</span>
<a name="ln-3178"></a><span class="k">  END IF</span> <span class="c">! IF(UnitarySystem(UnitarySysNum)%RequestAutosize)THEN</span>
<a name="ln-3179"></a>
<a name="ln-3180"></a><span class="c">! Not sure yet how to enforce heat pump cooling/heating air flow and capacity limits.</span>
<a name="ln-3181"></a><span class="c">! Other checks are in place (e.g., DXCoolCap) to already account for heat pump DX coils but apply to all coil types.</span>
<a name="ln-3182"></a><span class="c">! This method would actually size the HP to the larger of cooling or heating but not yet ready to implement.</span>
<a name="ln-3183"></a><span class="c">!  IF(UnitarySystem(UnitarySysNum)%HeatPump .AND. UnitarySystem(UnitarySysNum)%RequestAutosize)THEN</span>
<a name="ln-3184"></a><span class="c">!    IF(UnitarySystem(UnitarySysNum)%MaxCoolAirVolFlow == Autosize .AND. &amp;</span>
<a name="ln-3185"></a><span class="c">!       UnitarySystem(UnitarySysNum)%MaxHeatAirVolFlow == Autosize)THEN</span>
<a name="ln-3186"></a><span class="c">!      IF(CurOASysNum &gt; 0)THEN</span>
<a name="ln-3187"></a><span class="c">!        IF(OASysEqSizing(CurOASysNum)%AirFlow .AND. .NOT. OASysEqSizing(CurOASysNum)%Capacity)THEN</span>
<a name="ln-3188"></a><span class="c">!          SysCoolingFlow = MAX(SysCoolingFlow,SysHeatingFlow)</span>
<a name="ln-3189"></a><span class="c">!          SysHeatingFlow = SysCoolingFlow</span>
<a name="ln-3190"></a><span class="c">!          OASysEqSizing(CurOASysNum)%AirVolFlow = SysCoolingFlow</span>
<a name="ln-3191"></a><span class="c">!        ELSE IF(OASysEqSizing(CurOASysNum)%Capacity)THEN</span>
<a name="ln-3192"></a><span class="c">!          SysCoolingFlow = MAX(SysCoolingFlow,SysHeatingFlow)</span>
<a name="ln-3193"></a><span class="c">!          SysHeatingFlow = SysCoolingFlow</span>
<a name="ln-3194"></a><span class="c">!          OASysEqSizing(CurOASysNum)%AirVolFlow = SysCoolingFlow</span>
<a name="ln-3195"></a><span class="c">!          CoolCapAtPeak = MAX(CoolCapAtPeak,HeatCapAtPeak)</span>
<a name="ln-3196"></a><span class="c">!          HeatCapAtPeak = CoolCapAtPeak</span>
<a name="ln-3197"></a><span class="c">!          OASysEqSizing(CurOASysNum)%DesCoolingLoad = CoolCapAtPeak</span>
<a name="ln-3198"></a><span class="c">!          OASysEqSizing(CurOASysNum)%DesHeatingLoad = CoolCapAtPeak * UnitarySystem(UnitarySysNum)%HeatingSizingRatio</span>
<a name="ln-3199"></a><span class="c">!        END IF</span>
<a name="ln-3200"></a><span class="c">!      ELSE IF(CurSysNum &gt; 0)THEN</span>
<a name="ln-3201"></a><span class="c">!        IF(UnitarySysEqSizing(CurSysNum)%AirFlow .AND. .NOT. UnitarySysEqSizing(CurSysNum)%Capacity)THEN</span>
<a name="ln-3202"></a><span class="c">!          SysCoolingFlow = MAX(SysCoolingFlow,SysHeatingFlow)</span>
<a name="ln-3203"></a><span class="c">!          SysHeatingFlow = SysCoolingFlow</span>
<a name="ln-3204"></a><span class="c">!          UnitarySysEqSizing(CurSysNum)%AirVolFlow = SysCoolingFlow</span>
<a name="ln-3205"></a><span class="c">!        ELSE IF(UnitarySysEqSizing(CurSysNum)%Capacity)THEN</span>
<a name="ln-3206"></a><span class="c">!          SysCoolingFlow = MAX(SysCoolingFlow,SysHeatingFlow)</span>
<a name="ln-3207"></a><span class="c">!          SysHeatingFlow = SysCoolingFlow</span>
<a name="ln-3208"></a><span class="c">!          UnitarySysEqSizing(CurSysNum)%AirVolFlow = SysCoolingFlow</span>
<a name="ln-3209"></a><span class="c">!          CoolCapAtPeak = MAX(CoolCapAtPeak,HeatCapAtPeak)</span>
<a name="ln-3210"></a><span class="c">!          HeatCapAtPeak = CoolCapAtPeak</span>
<a name="ln-3211"></a><span class="c">!          UnitarySysEqSizing(CurSysNum)%DesCoolingLoad = CoolCapAtPeak</span>
<a name="ln-3212"></a><span class="c">!          UnitarySysEqSizing(CurSysNum)%DesHeatingLoad = CoolCapAtPeak * UnitarySystem(UnitarySysNum)%HeatingSizingRatio</span>
<a name="ln-3213"></a><span class="c">!        END IF</span>
<a name="ln-3214"></a><span class="c">!      ELSE IF(CurZoneEqNum &gt; 0)THEN</span>
<a name="ln-3215"></a><span class="c">!        IF(ZoneEqSizing(CurZoneEqNum)%AirFlow .AND. .NOT. ZoneEqSizing(CurZoneEqNum)%Capacity)THEN</span>
<a name="ln-3216"></a><span class="c">!          SysCoolingFlow = MAX(SysCoolingFlow,SysHeatingFlow)</span>
<a name="ln-3217"></a><span class="c">!          SysHeatingFlow = SysCoolingFlow</span>
<a name="ln-3218"></a><span class="c">!          ZoneEqSizing(CurZoneEqNum)%AirVolFlow = SysCoolingFlow</span>
<a name="ln-3219"></a><span class="c">!        ELSE IF(ZoneEqSizing(CurZoneEqNum)%Capacity)THEN</span>
<a name="ln-3220"></a><span class="c">!          SysCoolingFlow = MAX(SysCoolingFlow,SysHeatingFlow)</span>
<a name="ln-3221"></a><span class="c">!          SysHeatingFlow = SysCoolingFlow</span>
<a name="ln-3222"></a><span class="c">!          ZoneEqSizing(CurZoneEqNum)%AirVolFlow = SysCoolingFlow</span>
<a name="ln-3223"></a><span class="c">!          CoolCapAtPeak = MAX(CoolCapAtPeak,HeatCapAtPeak)</span>
<a name="ln-3224"></a><span class="c">!          HeatCapAtPeak = CoolCapAtPeak</span>
<a name="ln-3225"></a><span class="c">!          ZoneEqSizing(CurZoneEqNum)%DesCoolingLoad = CoolCapAtPeak</span>
<a name="ln-3226"></a><span class="c">!          ZoneEqSizing(CurZoneEqNum)%DesHeatingLoad = CoolCapAtPeak * UnitarySystem(UnitarySysNum)%HeatingSizingRatio</span>
<a name="ln-3227"></a><span class="c">!        END IF</span>
<a name="ln-3228"></a><span class="c">!      END IF</span>
<a name="ln-3229"></a><span class="c">!    END IF</span>
<a name="ln-3230"></a><span class="c">!  END IF</span>
<a name="ln-3231"></a>
<a name="ln-3232"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="o">==</span> <span class="n">AutoSize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3233"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanExists</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3234"></a>
<a name="ln-3235"></a><span class="k">    </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">SysCoolingFlow</span><span class="p">,</span><span class="n">SysHeatingFlow</span><span class="p">)</span>
<a name="ln-3236"></a>
<a name="ln-3237"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRateEMSOverrideOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3238"></a><span class="k">      </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRateEMSOverrideValue</span>
<a name="ln-3239"></a>    <span class="k">END IF</span>
<a name="ln-3240"></a>
<a name="ln-3241"></a><span class="k">    IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="o">&lt;</span> <span class="n">SmallAirVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3242"></a><span class="k">      </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3243"></a>    <span class="k">END IF</span>
<a name="ln-3244"></a>
<a name="ln-3245"></a><span class="k">    CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3246"></a>                            <span class="s1">&#39;Supply Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3247"></a>                             <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span><span class="p">)</span>
<a name="ln-3248"></a>
<a name="ln-3249"></a>  <span class="k">END IF</span>
<a name="ln-3250"></a>
<a name="ln-3251"></a>  <span class="c">! not sure what to do if UnitarySystem has only 1 coil type and flow needs to occur when present coil is off</span>
<a name="ln-3252"></a>  <span class="c">! how does constant fan operating mode pertain here?</span>
<a name="ln-3253"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3254"></a><span class="k">    </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">=</span> <span class="n">SysHeatingFlow</span>
<a name="ln-3255"></a>  <span class="k">ELSE IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilExists</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3256"></a><span class="k">    </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">=</span> <span class="n">SysCoolingFlow</span>
<a name="ln-3257"></a>  <span class="k">END IF</span>
<a name="ln-3258"></a>
<a name="ln-3259"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">==</span> <span class="n">AutoSize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3260"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3261"></a>
<a name="ln-3262"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3263"></a><span class="k">      IF</span><span class="p">(</span><span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">AirFlow</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3264"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">=</span> <span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">AirVolFlow</span>
<a name="ln-3265"></a>      <span class="k">ELSE</span>
<a name="ln-3266"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span>
<a name="ln-3267"></a>      <span class="k">END IF</span>
<a name="ln-3268"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">&lt;</span> <span class="n">SmallAirVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3269"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3270"></a>      <span class="k">END IF</span>
<a name="ln-3271"></a><span class="k">    ELSE</span>
<a name="ln-3272"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3273"></a>
<a name="ln-3274"></a><span class="k">        IF</span><span class="p">(</span><span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">AirFlow</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3275"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">=</span> <span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">AirVolFlow</span>
<a name="ln-3276"></a>        <span class="k">ELSE</span>
<a name="ln-3277"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-3278"></a>        <span class="k">END IF</span>
<a name="ln-3279"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span> <span class="o">&lt;</span> <span class="n">SmallAirVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3280"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3281"></a>        <span class="k">END IF</span>
<a name="ln-3282"></a>
<a name="ln-3283"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlowEMSOverrideOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3284"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlowEMSOverrideValue</span>
<a name="ln-3285"></a>        <span class="k">END IF</span>
<a name="ln-3286"></a>
<a name="ln-3287"></a><span class="k">      </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">CurZoneEqNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3288"></a>        <span class="c">! if we keep this (zone equipment) then we should probably check to see if a cooling/heating coil is present</span>
<a name="ln-3289"></a>        <span class="c">! and use just cooling if only a cooling coil, or just heating if only a heating coil</span>
<a name="ln-3290"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirFlow</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3291"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">=</span> <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirVolFlow</span>
<a name="ln-3292"></a>        <span class="k">ELSE</span>
<a name="ln-3293"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-3294"></a>                 <span class="nb">MAX</span><span class="p">(</span><span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolVolFlow</span><span class="p">,</span><span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatVolFlow</span><span class="p">)</span>
<a name="ln-3295"></a>        <span class="k">END IF</span>
<a name="ln-3296"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">&lt;</span> <span class="n">SmallAirVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3297"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3298"></a>        <span class="k">END IF</span>
<a name="ln-3299"></a>
<a name="ln-3300"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlowEMSOverrideOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3301"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlowEMSOverrideValue</span>
<a name="ln-3302"></a>        <span class="k">END IF</span>
<a name="ln-3303"></a>
<a name="ln-3304"></a><span class="k">      END IF</span>
<a name="ln-3305"></a><span class="k">    END IF</span>
<a name="ln-3306"></a>
<a name="ln-3307"></a><span class="k">    CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3308"></a>                            <span class="s1">&#39;Supply Air Flow Rate During Heating Operation [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3309"></a>                            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span><span class="p">)</span>
<a name="ln-3310"></a>  <span class="k">END IF</span>
<a name="ln-3311"></a>
<a name="ln-3312"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">==</span> <span class="n">AutoSize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3313"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilExists</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3314"></a>
<a name="ln-3315"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3316"></a><span class="k">      IF</span><span class="p">(</span><span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">AirFlow</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3317"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">=</span> <span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">AirVolFlow</span>
<a name="ln-3318"></a>      <span class="k">ELSE</span>
<a name="ln-3319"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span>
<a name="ln-3320"></a>      <span class="k">END IF</span>
<a name="ln-3321"></a><span class="k">    ELSE</span>
<a name="ln-3322"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3323"></a>
<a name="ln-3324"></a><span class="k">        IF</span><span class="p">(</span><span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">AirFlow</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3325"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">=</span> <span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">AirVolFlow</span>
<a name="ln-3326"></a>        <span class="k">ELSE</span>
<a name="ln-3327"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-3328"></a>        <span class="k">END IF</span>
<a name="ln-3329"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">&lt;</span> <span class="n">SmallAirVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3330"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3331"></a>        <span class="k">END IF</span>
<a name="ln-3332"></a>
<a name="ln-3333"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlowEMSOverrideOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3334"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlowEMSOverrideValue</span>
<a name="ln-3335"></a>        <span class="k">END IF</span>
<a name="ln-3336"></a>
<a name="ln-3337"></a><span class="k">      </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">CurZoneEqNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3338"></a>        <span class="c">! if we keep this (zone equipment) then we should probably check to see if a cooling/heating coil is present</span>
<a name="ln-3339"></a>        <span class="c">! and use just cooling if only a cooling coil, or just heating if only a heating coil</span>
<a name="ln-3340"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirFlow</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3341"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">=</span> <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirVolFlow</span>
<a name="ln-3342"></a>        <span class="k">ELSE</span>
<a name="ln-3343"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-3344"></a>                 <span class="nb">MAX</span><span class="p">(</span><span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolVolFlow</span><span class="p">,</span><span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatVolFlow</span><span class="p">)</span>
<a name="ln-3345"></a>        <span class="k">END IF</span>
<a name="ln-3346"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">&lt;</span> <span class="n">SmallAirVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3347"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3348"></a>        <span class="k">END IF</span>
<a name="ln-3349"></a>
<a name="ln-3350"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlowEMSOverrideOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3351"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlowEMSOverrideValue</span>
<a name="ln-3352"></a>        <span class="k">END IF</span>
<a name="ln-3353"></a>
<a name="ln-3354"></a><span class="k">      END IF</span>
<a name="ln-3355"></a><span class="k">    END IF</span>
<a name="ln-3356"></a>
<a name="ln-3357"></a><span class="k">    CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3358"></a>                            <span class="s1">&#39;Supply Air Flow Rate During Cooling Operation [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3359"></a>                             <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span><span class="p">)</span>
<a name="ln-3360"></a>
<a name="ln-3361"></a>  <span class="k">END IF</span>
<a name="ln-3362"></a>
<a name="ln-3363"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">==</span> <span class="n">AutoSize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3364"></a>      <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilExists</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3365"></a>       <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilExists</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-3366"></a>
<a name="ln-3367"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3368"></a><span class="k">      IF</span><span class="p">(</span><span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">AirFlow</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3369"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">=</span> <span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">AirVolFlow</span>
<a name="ln-3370"></a>      <span class="k">ELSE</span>
<a name="ln-3371"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span>
<a name="ln-3372"></a>      <span class="k">END IF</span>
<a name="ln-3373"></a><span class="k">    ELSE</span>
<a name="ln-3374"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3375"></a>
<a name="ln-3376"></a><span class="k">        IF</span><span class="p">(</span><span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">AirFlow</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3377"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">=</span> <span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">AirVolFlow</span>
<a name="ln-3378"></a>        <span class="k">ELSE</span>
<a name="ln-3379"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-3380"></a>        <span class="k">END IF</span>
<a name="ln-3381"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">&lt;</span> <span class="n">SmallAirVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3382"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3383"></a>        <span class="k">END IF</span>
<a name="ln-3384"></a>
<a name="ln-3385"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlowEMSOverrideOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3386"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span><span class="o">=</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlowEMSOverrideValue</span>
<a name="ln-3387"></a>        <span class="k">END IF</span>
<a name="ln-3388"></a>
<a name="ln-3389"></a><span class="k">        CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3390"></a>                               <span class="s1">&#39;Supply Air Flow Rate When No Cooling or Heating is Needed [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3391"></a>                                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span><span class="p">)</span>
<a name="ln-3392"></a>
<a name="ln-3393"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">CurZoneEqNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3394"></a>        <span class="c">! if we keep this (zone equipment) then we should probably check to see if a cooling/heating coil is present</span>
<a name="ln-3395"></a>        <span class="c">! and use just cooling if only a cooling coil, or just heating if only a heating coil</span>
<a name="ln-3396"></a><span class="c">!        CALL CheckZoneSizing(UnitarySystem(UnitarySysNum)%UnitarySystemType, UnitarySystem(UnitarySysNum)%Name)</span>
<a name="ln-3397"></a><span class="c">!  would use this to size cooling or heating only systems except for the case where dual UnitarySystems are on the branch</span>
<a name="ln-3398"></a><span class="c">!  and each has only 1 cooling or heating coil ??? How to handle?</span>
<a name="ln-3399"></a><span class="c">!  Use same logic for other flow rates in this sizing module.</span>
<a name="ln-3400"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilExists</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3401"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-3402"></a>                 <span class="nb">MAX</span><span class="p">(</span><span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolVolFlow</span><span class="p">,</span><span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatVolFlow</span><span class="p">)</span>
<a name="ln-3403"></a>        <span class="k">ELSE IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3404"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-3405"></a>                 <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolVolFlow</span>
<a name="ln-3406"></a>        <span class="k">ELSE IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3407"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-3408"></a>                 <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatVolFlow</span>
<a name="ln-3409"></a>        <span class="k">ELSE</span>
<a name="ln-3410"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! ?</span>
<a name="ln-3411"></a>        <span class="k">END IF</span>
<a name="ln-3412"></a>
<a name="ln-3413"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">&lt;</span> <span class="n">SmallAirVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3414"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3415"></a>        <span class="k">END IF</span>
<a name="ln-3416"></a>
<a name="ln-3417"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlowEMSOverrideOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3418"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span><span class="o">=</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlowEMSOverrideValue</span>
<a name="ln-3419"></a>        <span class="k">END IF</span>
<a name="ln-3420"></a>
<a name="ln-3421"></a><span class="k">        CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3422"></a>                               <span class="s1">&#39;Supply Air Flow Rate When No Cooling or Heating is Needed [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3423"></a>                                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span><span class="p">)</span>
<a name="ln-3424"></a>
<a name="ln-3425"></a>      <span class="k">END IF</span>
<a name="ln-3426"></a><span class="k">    END IF</span>
<a name="ln-3427"></a><span class="k">  ELSE IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilExists</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3428"></a><span class="k">    SELECT CASE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NoCoolHeatSAFMethod</span><span class="p">)</span>
<a name="ln-3429"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">SupplyAirFlowRate</span><span class="p">)</span>
<a name="ln-3430"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3431"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3432"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span>
<a name="ln-3433"></a>          <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3434"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-3435"></a>          <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">CurZoneEqNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3436"></a><span class="k">            IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilExists</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3437"></a><span class="k">              </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3438"></a>                <span class="nb">MAX</span><span class="p">(</span><span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolVolFlow</span><span class="p">,</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatVolFlow</span><span class="p">)</span>
<a name="ln-3439"></a>            <span class="k">ELSE IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3440"></a><span class="k">              </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolVolFlow</span>
<a name="ln-3441"></a>            <span class="k">ELSE IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3442"></a><span class="k">              </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatVolFlow</span>
<a name="ln-3443"></a>            <span class="k">ELSE</span>
<a name="ln-3444"></a>              <span class="c">! just guessing here what this should be</span>
<a name="ln-3445"></a>              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3446"></a>            <span class="k">END IF</span>
<a name="ln-3447"></a><span class="k">          END IF</span>
<a name="ln-3448"></a><span class="k">        END IF</span>
<a name="ln-3449"></a><span class="k">      CASE</span> <span class="p">(</span><span class="n">FlowPerFloorArea</span><span class="p">)</span>
<a name="ln-3450"></a>        <span class="c">! already calculated in GetInput</span>
<a name="ln-3451"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">FractionOfAutosizedCoolingValue</span><span class="p">,</span> <span class="n">FractionOfAutosizedHeatingValue</span><span class="p">)</span>
<a name="ln-3452"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3453"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3454"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">*</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span>
<a name="ln-3455"></a>        <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3456"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3457"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">*</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-3458"></a>        <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">CurZoneEqNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3459"></a><span class="k">          IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NoCoolHeatSAFMethod</span> <span class="o">==</span> <span class="n">FractionOfAutosizedCoolingValue</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3460"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3461"></a>              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">*</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolVolFlow</span>
<a name="ln-3462"></a>          <span class="k">ELSE</span>
<a name="ln-3463"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3464"></a>              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">*</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatVolFlow</span>
<a name="ln-3465"></a>          <span class="k">END IF</span>
<a name="ln-3466"></a><span class="k">        END IF</span>
<a name="ln-3467"></a><span class="k">      CASE</span> <span class="p">(</span><span class="n">FlowPerCoolingCapacity</span><span class="p">)</span> <span class="c">! these aren&#39;t going to work if the user doesn&#39;t choose the same method for all cases</span>
<a name="ln-3468"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">DXCoolCap</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3469"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3470"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-3471"></a>              <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolingLoad</span>
<a name="ln-3472"></a>        <span class="k">ELSE</span>
<a name="ln-3473"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3474"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">*</span> <span class="n">DXCoolCap</span>
<a name="ln-3475"></a>        <span class="k">END IF</span>
<a name="ln-3476"></a><span class="k">      CASE</span> <span class="p">(</span><span class="n">FlowPerHeatingCapacity</span><span class="p">)</span>
<a name="ln-3477"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3478"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-3479"></a>            <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatingLoad</span>
<a name="ln-3480"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="k">None</span><span class="p">)</span>
<a name="ln-3481"></a>        <span class="c">! what does this mean?</span>
<a name="ln-3482"></a>      <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-3483"></a>      <span class="c">! wait for CR&#39;s</span>
<a name="ln-3484"></a>    <span class="k">END SELECT</span>
<a name="ln-3485"></a>
<a name="ln-3486"></a><span class="k">  ELSE</span>
<a name="ln-3487"></a><span class="k">    </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3488"></a>  <span class="k">END IF</span>
<a name="ln-3489"></a>
<a name="ln-3490"></a>
<a name="ln-3491"></a><span class="k">  SELECT CASE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span><span class="p">)</span>
<a name="ln-3492"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">CoilDX_CoolingSingleSpeed</span><span class="p">)</span>
<a name="ln-3493"></a>    <span class="k">CALL </span><span class="n">SimDXCoil</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">On</span><span class="p">,.</span><span class="n">TRUE</span><span class="p">.,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-3494"></a>    <span class="n">DXCoolCap</span> <span class="o">=</span> <span class="n">GetCoilCapacityByIndexType</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3495"></a>                                           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span><span class="p">,</span><span class="n">ErrFound</span><span class="p">)</span>
<a name="ln-3496"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">CoilDX_CoolingHXAssisted</span><span class="p">,</span><span class="n">CoilWater_CoolingHXAssisted</span><span class="p">)</span>
<a name="ln-3497"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">SysCoolingFlow</span>
<a name="ln-3498"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilWater_CoolingHXAssisted</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3499"></a><span class="k">      </span><span class="n">HXCoilName</span> <span class="o">=</span> <span class="n">GetHXDXCoilName</span><span class="p">(</span><span class="n">cAllCoilTypes</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3500"></a>                                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFound</span><span class="p">)</span>
<a name="ln-3501"></a>      <span class="n">ActualCoolCoilType</span> <span class="o">=</span> <span class="n">GetCoilObjectTypeNum</span><span class="p">(</span><span class="n">cAllCoilTypes</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3502"></a>                           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFound</span><span class="p">,.</span><span class="n">TRUE</span><span class="p">.)</span>
<a name="ln-3503"></a>      <span class="k">CALL </span><span class="n">SetCoilDesFlow</span><span class="p">(</span><span class="n">cAllCoilTypes</span><span class="p">(</span><span class="n">ActualCoolCoilType</span><span class="p">),</span><span class="n">HXCoilName</span><span class="p">,</span><span class="n">SysCoolingFlow</span><span class="p">,</span><span class="n">ErrFound</span><span class="p">)</span>
<a name="ln-3504"></a>    <span class="k">END IF</span>
<a name="ln-3505"></a><span class="k">    CALL </span><span class="n">SimHXAssistedCoolingCoil</span><span class="p">(</span><span class="n">Blank</span><span class="p">,.</span><span class="n">TRUE</span><span class="p">.,</span><span class="n">On</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3506"></a>                                  <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3507"></a>                                  <span class="n">HXUnitEnable</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span> <span class="n">OnOffAFR</span> <span class="o">=</span> <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">EconomizerFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.)</span>
<a name="ln-3508"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilWater_CoolingHXAssisted</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3509"></a><span class="k">      </span><span class="n">DXCoolCap</span> <span class="o">=</span> <span class="n">GetWaterCoilCapacity</span><span class="p">(</span><span class="n">MakeUPPERCase</span><span class="p">(</span><span class="n">cAllCoilTypes</span><span class="p">(</span><span class="n">ActualCoolCoilType</span><span class="p">)),</span><span class="n">HXCoilName</span><span class="p">,</span><span class="n">ErrFound</span><span class="p">)</span>
<a name="ln-3510"></a>    <span class="k">ELSE</span>
<a name="ln-3511"></a><span class="k">      </span><span class="n">DXCoolCap</span> <span class="o">=</span> <span class="n">GetCoilCapacity</span><span class="p">(</span><span class="n">cAllCoilTypes</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3512"></a>                                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFound</span><span class="p">)</span>
<a name="ln-3513"></a>    <span class="k">END IF</span>
<a name="ln-3514"></a><span class="k">  CASE</span><span class="p">(</span><span class="n">Coil_CoolingWaterDetailed</span><span class="p">)</span>
<a name="ln-3515"></a>    <span class="k">CALL </span><span class="n">SetCoilDesFlow</span><span class="p">(</span><span class="n">cAllCoilTypes</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3516"></a>                        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">SysCoolingFlow</span><span class="p">,</span><span class="n">ErrFound</span><span class="p">)</span>
<a name="ln-3517"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">Coil_CoolingWaterToAirHPSimple</span><span class="p">)</span>
<a name="ln-3518"></a>    <span class="k">CALL </span><span class="n">SimWatertoAirHPSimple</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3519"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3520"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilSensDemand</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilLatentDemand</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3521"></a>           <span class="mi">0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3522"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3523"></a>           <span class="mi">0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-3524"></a>    <span class="n">DXCoolCap</span> <span class="o">=</span> <span class="n">GetSimpleCoilCapacity</span><span class="p">(</span><span class="n">cAllCoilTypes</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3525"></a>                                      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFound</span><span class="p">)</span>
<a name="ln-3526"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">Coil_CoolingWaterToAirHP</span><span class="p">)</span>
<a name="ln-3527"></a>    <span class="k">CALL </span><span class="n">SimWatertoAirHP</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3528"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirMassFlow</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,&amp;</span>
<a name="ln-3529"></a>           <span class="n">FirstHVACIteration</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,&amp;</span>
<a name="ln-3530"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3531"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3532"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3533"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">InitHeatPump</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3534"></a>           <span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-3535"></a>    <span class="n">DXCoolCap</span> <span class="o">=</span> <span class="n">GetWAHPCoilCapacity</span><span class="p">(</span><span class="n">cAllCoilTypes</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3536"></a>                                    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFound</span><span class="p">)</span>
<a name="ln-3537"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">Coil_CoolingWaterToAirHPVSEquationFit</span><span class="p">,</span> <span class="n">Coil_CoolingAirToAirVariableSpeed</span><span class="p">)</span>
<a name="ln-3538"></a>
<a name="ln-3539"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3540"></a><span class="k">      IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-3541"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span><span class="p">))</span>
<a name="ln-3542"></a>
<a name="ln-3543"></a>      <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-3544"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span><span class="p">))</span>
<a name="ln-3545"></a>
<a name="ln-3546"></a>      <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSCoolingSpeedRatio</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-3547"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSCoolingSpeedRatio</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span><span class="p">))</span>
<a name="ln-3548"></a>    <span class="k">END IF</span>
<a name="ln-3549"></a>
<a name="ln-3550"></a><span class="k">    CALL </span><span class="n">SimVariableSpeedCoils</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,&amp;</span>
<a name="ln-3551"></a>           <span class="mi">0</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3552"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,&amp;</span>
<a name="ln-3553"></a>           <span class="mi">0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span> <span class="p">)</span>     <span class="c">!conduct the sizing operation in the VS WSHP</span>
<a name="ln-3554"></a>    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">)%</span><span class="n">NumOfSpeeds</span>
<a name="ln-3555"></a>    <span class="n">DXCoolCap</span> <span class="o">=</span> <span class="n">GetCoilCapacityVariableSpeed</span><span class="p">(</span><span class="n">cAllCoilTypes</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3556"></a>                                      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFound</span><span class="p">)</span>
<a name="ln-3557"></a>    <span class="n">MulSpeedFlowScale</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-3558"></a>       <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span>  <span class="p">&amp;</span>
<a name="ln-3559"></a>          <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">)%</span><span class="n">NormSpedLevel</span><span class="p">)</span>
<a name="ln-3560"></a>    <span class="k">DO </span><span class="n">Iter</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span>
<a name="ln-3561"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">Iter</span><span class="p">)</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-3562"></a>         <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Iter</span><span class="p">)</span> <span class="o">*</span> <span class="n">MulSpeedFlowScale</span>
<a name="ln-3563"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">Iter</span><span class="p">)</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">Iter</span><span class="p">)</span><span class="o">*</span> <span class="n">StdRhoAir</span>
<a name="ln-3564"></a><span class="c">! it seems the ratio should reference the actual flow rates, not the fan flow ???</span>
<a name="ln-3565"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3566"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSCoolingSpeedRatio</span><span class="p">(</span><span class="n">Iter</span><span class="p">)</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">Iter</span><span class="p">)</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-3567"></a><span class="c">!             UnitarySystem(UnitarySysNum)%CoolVolumeFlowRate(UnitarySystem(UnitarySysNum)%NumOfSpeedCooling)</span>
<a name="ln-3568"></a>              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span>
<a name="ln-3569"></a>      <span class="k">ELSE</span>
<a name="ln-3570"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSCoolingSpeedRatio</span><span class="p">(</span><span class="n">Iter</span><span class="p">)</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">Iter</span><span class="p">)</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-3571"></a>             <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span><span class="p">)</span>
<a name="ln-3572"></a>      <span class="k">END IF</span>
<a name="ln-3573"></a><span class="k">    END DO</span>
<a name="ln-3574"></a>
<a name="ln-3575"></a><span class="k">    </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleVolumeAirRate</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3576"></a>    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleMassFlowRate</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3577"></a>    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleSpeedRatio</span>    <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSCoolingSpeedRatio</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3578"></a>
<a name="ln-3579"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">CoilDX_MultiSpeedCooling</span><span class="p">)</span>
<a name="ln-3580"></a>
<a name="ln-3581"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3582"></a><span class="k">      IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-3583"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span><span class="p">))</span>
<a name="ln-3584"></a>
<a name="ln-3585"></a>      <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-3586"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span><span class="p">))</span>
<a name="ln-3587"></a>
<a name="ln-3588"></a>      <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSCoolingSpeedRatio</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-3589"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSCoolingSpeedRatio</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span><span class="p">))</span>
<a name="ln-3590"></a>    <span class="k">END IF</span>
<a name="ln-3591"></a>
<a name="ln-3592"></a><span class="k">    </span><span class="n">OnOffAirFlowRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-3593"></a>    <span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-3594"></a>    <span class="k">CALL </span><span class="n">SetOnOffMassFlowRate</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-3595"></a>    <span class="k">CALL </span><span class="n">SimDXCoilMultiSpeed</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<a name="ln-3596"></a>    <span class="n">DXCoolCap</span> <span class="o">=</span> <span class="n">GetCoilCapacityByIndexType</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3597"></a>                                           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span><span class="p">,</span><span class="n">ErrFound</span><span class="p">)</span>
<a name="ln-3598"></a>
<a name="ln-3599"></a>    <span class="n">MSHPIndex</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignSpecMSHPIndex</span>
<a name="ln-3600"></a>
<a name="ln-3601"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">MSHPIndex</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3602"></a><span class="k">      DO </span><span class="n">Iter</span> <span class="o">=</span> <span class="n">DesignSpecMSHP</span><span class="p">(</span><span class="n">MSHPIndex</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span><span class="p">,</span> <span class="mi">1</span> <span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="c">! use reverse order since we divide by CoolVolumeFlowRate(max)</span>
<a name="ln-3603"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">DesignSpecMSHP</span><span class="p">(</span><span class="n">MSHPIndex</span><span class="p">)%</span><span class="n">CoolingVolFlowRatio</span><span class="p">(</span><span class="n">Iter</span><span class="p">)</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-3604"></a>             <span class="n">DesignSpecMSHP</span><span class="p">(</span><span class="n">MSHPIndex</span><span class="p">)%</span><span class="n">CoolingVolFlowRatio</span><span class="p">(</span><span class="n">Iter</span><span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3605"></a>               <span class="kt">REAL</span><span class="p">(</span><span class="n">Iter</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">DesignSpecMSHP</span><span class="p">(</span><span class="n">MSHPIndex</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-3606"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">Iter</span><span class="p">)</span> <span class="o">=</span>   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-3607"></a>                                                           <span class="n">DesignSpecMSHP</span><span class="p">(</span><span class="n">MSHPIndex</span><span class="p">)%</span><span class="n">CoolingVolFlowRatio</span><span class="p">(</span><span class="n">Iter</span><span class="p">)</span>
<a name="ln-3608"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">Iter</span><span class="p">)</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">Iter</span><span class="p">)</span><span class="o">*</span> <span class="n">StdRhoAir</span>
<a name="ln-3609"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSCoolingSpeedRatio</span><span class="p">(</span><span class="n">Iter</span><span class="p">)</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">Iter</span><span class="p">)</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-3610"></a>                              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">DesignSpecMSHP</span><span class="p">(</span><span class="n">MSHPIndex</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span><span class="p">)</span>
<a name="ln-3611"></a>
<a name="ln-3612"></a>      <span class="k">END DO</span>
<a name="ln-3613"></a><span class="k">      </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleVolumeAirRate</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3614"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleMassFlowRate</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3615"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleSpeedRatio</span>   <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSCoolingSpeedRatio</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3616"></a>    <span class="k">END IF</span>
<a name="ln-3617"></a>
<a name="ln-3618"></a><span class="k">  CASE </span><span class="n">DEFAULT</span>
<a name="ln-3619"></a>  <span class="k">END SELECT</span>
<a name="ln-3620"></a>
<a name="ln-3621"></a>
<a name="ln-3622"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_MultiSpeedHeating</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3623"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingElectric_MultiStage</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3624"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingGas_MultiStage</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3625"></a>
<a name="ln-3626"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3627"></a><span class="k">      IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-3628"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span><span class="p">))</span>
<a name="ln-3629"></a>
<a name="ln-3630"></a>      <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-3631"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span><span class="p">))</span>
<a name="ln-3632"></a>
<a name="ln-3633"></a>      <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSHeatingSpeedRatio</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-3634"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSHeatingSpeedRatio</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span><span class="p">))</span>
<a name="ln-3635"></a>    <span class="k">END IF</span>
<a name="ln-3636"></a>
<a name="ln-3637"></a><span class="k">    </span><span class="n">MSHPIndex</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignSpecMSHPIndex</span>
<a name="ln-3638"></a>
<a name="ln-3639"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">MSHPIndex</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3640"></a><span class="k">      DO </span><span class="n">Iter</span> <span class="o">=</span> <span class="n">DesignSpecMSHP</span><span class="p">(</span><span class="n">MSHPIndex</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span><span class="p">,</span> <span class="mi">1</span> <span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="c">! use reverse order since we divide by HeatVolumeFlowRate(max)</span>
<a name="ln-3641"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">DesignSpecMSHP</span><span class="p">(</span><span class="n">MSHPIndex</span><span class="p">)%</span><span class="n">HeatingVolFlowRatio</span><span class="p">(</span><span class="n">Iter</span><span class="p">)</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-3642"></a>             <span class="n">DesignSpecMSHP</span><span class="p">(</span><span class="n">MSHPIndex</span><span class="p">)%</span><span class="n">HeatingVolFlowRatio</span><span class="p">(</span><span class="n">Iter</span><span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3643"></a>                <span class="kt">REAL</span><span class="p">(</span><span class="n">Iter</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">DesignSpecMSHP</span><span class="p">(</span><span class="n">MSHPIndex</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-3644"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">Iter</span><span class="p">)</span> <span class="o">=</span>   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-3645"></a>                                                                  <span class="n">DesignSpecMSHP</span><span class="p">(</span><span class="n">MSHPIndex</span><span class="p">)%</span><span class="n">HeatingVolFlowRatio</span><span class="p">(</span><span class="n">Iter</span><span class="p">)</span>
<a name="ln-3646"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="n">Iter</span><span class="p">)</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">Iter</span><span class="p">)</span><span class="o">*</span> <span class="n">StdRhoAir</span>
<a name="ln-3647"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSHeatingSpeedRatio</span><span class="p">(</span><span class="n">Iter</span><span class="p">)</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">Iter</span><span class="p">)</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-3648"></a>                                      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">DesignSpecMSHP</span><span class="p">(</span><span class="n">MSHPIndex</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span><span class="p">)</span>
<a name="ln-3649"></a>      <span class="k">END DO</span>
<a name="ln-3650"></a><span class="k">      </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleVolumeAirRate</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3651"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleMassFlowRate</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3652"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleSpeedRatio</span>   <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSHeatingSpeedRatio</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3653"></a>    <span class="k">END IF</span>
<a name="ln-3654"></a><span class="k">  </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWaterToAirHPVSEquationFit</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3655"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3656"></a><span class="k">    CALL </span><span class="n">SimVariableSpeedCoils</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,&amp;</span>
<a name="ln-3657"></a>           <span class="mi">0</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3658"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,&amp;</span>
<a name="ln-3659"></a>           <span class="mi">0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span> <span class="p">)</span> <span class="c">!conduct the sizing operation in the VS WSHP</span>
<a name="ln-3660"></a>
<a name="ln-3661"></a>    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">)%</span><span class="n">NumOfSpeeds</span>
<a name="ln-3662"></a>
<a name="ln-3663"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3664"></a><span class="k">      IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-3665"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span><span class="p">))</span>
<a name="ln-3666"></a>
<a name="ln-3667"></a>      <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-3668"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span><span class="p">))</span>
<a name="ln-3669"></a>
<a name="ln-3670"></a>      <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSHeatingSpeedRatio</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-3671"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSHeatingSpeedRatio</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span><span class="p">))</span>
<a name="ln-3672"></a>    <span class="k">END IF</span>
<a name="ln-3673"></a>
<a name="ln-3674"></a><span class="k">    </span><span class="n">MulSpeedFlowScale</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-3675"></a>                        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span>  <span class="p">&amp;</span>
<a name="ln-3676"></a>                           <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">)%</span><span class="n">NormSpedLevel</span><span class="p">)</span>
<a name="ln-3677"></a>    <span class="k">DO </span><span class="n">Iter</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span>
<a name="ln-3678"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">Iter</span><span class="p">)</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-3679"></a>         <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Iter</span><span class="p">)</span> <span class="o">*</span> <span class="n">MulSpeedFlowScale</span>
<a name="ln-3680"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="n">Iter</span><span class="p">)</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">Iter</span><span class="p">)</span><span class="o">*</span> <span class="n">StdRhoAir</span>
<a name="ln-3681"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3682"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSHeatingSpeedRatio</span><span class="p">(</span><span class="n">Iter</span><span class="p">)</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">Iter</span><span class="p">)</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-3683"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span>
<a name="ln-3684"></a>      <span class="k">ELSE</span>
<a name="ln-3685"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSHeatingSpeedRatio</span><span class="p">(</span><span class="n">Iter</span><span class="p">)</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">Iter</span><span class="p">)</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-3686"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span><span class="p">)</span>
<a name="ln-3687"></a>      <span class="k">END IF</span>
<a name="ln-3688"></a>
<a name="ln-3689"></a><span class="k">    END DO</span>
<a name="ln-3690"></a>
<a name="ln-3691"></a><span class="k">    IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3692"></a><span class="k">      IF</span><span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-3693"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleVolumeAirRate</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3694"></a>          <span class="nb">MIN</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleVolumeAirRate</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-3695"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleMassFlowRate</span>  <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3696"></a>          <span class="nb">MIN</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleMassFlowRate</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-3697"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleSpeedRatio</span>    <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3698"></a>          <span class="nb">MIN</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleSpeedRatio</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSHeatingSpeedRatio</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-3699"></a>      <span class="k">ELSE</span>
<a name="ln-3700"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleVolumeAirRate</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3701"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleMassFlowRate</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3702"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleSpeedRatio</span>    <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSHeatingSpeedRatio</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3703"></a>      <span class="k">END IF</span>
<a name="ln-3704"></a><span class="k">    ELSE</span>
<a name="ln-3705"></a><span class="k">      </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleVolumeAirRate</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3706"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleMassFlowRate</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3707"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleSpeedRatio</span>    <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSHeatingSpeedRatio</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3708"></a>    <span class="k">END IF</span>
<a name="ln-3709"></a><span class="k">  END IF</span>
<a name="ln-3710"></a>
<a name="ln-3711"></a><span class="k">  IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilExists</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3712"></a><span class="k">    IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SysSizingRunDone</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3713"></a><span class="k">      </span><span class="n">BranchNum</span> <span class="o">=</span> <span class="n">GetAirBranchIndex</span><span class="p">(</span><span class="s1">&#39;AirloopHVAC:UnitarySystem&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-3714"></a>      <span class="n">FanType</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
<a name="ln-3715"></a>      <span class="n">FanName</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
<a name="ln-3716"></a>      <span class="n">BranchFanFlow</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3717"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">BranchNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">CALL </span><span class="n">GetBranchFanTypeName</span><span class="p">(</span><span class="n">BranchNum</span><span class="p">,</span> <span class="n">FanType</span><span class="p">,</span> <span class="n">FanName</span><span class="p">,</span> <span class="n">ErrFound</span><span class="p">)</span>
<a name="ln-3718"></a>      <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">ErrFound</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">BranchNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="n">BranchFanFlow</span> <span class="o">=</span> <span class="n">GetFanDesignVolumeFlowRate</span><span class="p">(</span><span class="n">FanType</span><span class="p">,</span><span class="n">FanName</span><span class="p">,</span><span class="n">ErrFound</span><span class="p">)</span>
<a name="ln-3719"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">BranchNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="n">BranchFlow</span> <span class="o">=</span> <span class="n">GetBranchFlow</span><span class="p">(</span><span class="n">BranchNum</span><span class="p">)</span>
<a name="ln-3720"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">BranchFanFlow</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3721"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">=</span> <span class="n">BranchFanFlow</span>
<a name="ln-3722"></a>      <span class="n">ELSEIF</span><span class="p">(</span><span class="n">BranchFlow</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3723"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">=</span> <span class="n">BranchFlow</span>
<a name="ln-3724"></a>      <span class="n">ELSEIF</span><span class="p">(</span><span class="n">BranchFlow</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3725"></a>        <span class="c">! what do I do?</span>
<a name="ln-3726"></a>      <span class="k">END IF</span>
<a name="ln-3727"></a><span class="k">    END IF</span>
<a name="ln-3728"></a><span class="k">  END IF</span>
<a name="ln-3729"></a>
<a name="ln-3730"></a>    <span class="c">!Change the Volume Flow Rates to Mass Flow Rates</span>
<a name="ln-3731"></a>    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignMassFlowRate</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="o">*</span> <span class="n">StdRhoAir</span>
<a name="ln-3732"></a>    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirMassFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">*</span> <span class="n">StdRhoAir</span>
<a name="ln-3733"></a>    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirMassFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span><span class="o">*</span> <span class="n">StdRhoAir</span>
<a name="ln-3734"></a>    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirMassFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span><span class="o">*</span> <span class="n">StdRhoAir</span>
<a name="ln-3735"></a>
<a name="ln-3736"></a>    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SenLoadLoss</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3737"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Humidistat</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3738"></a><span class="k">      </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">LatLoadLoss</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3739"></a>    <span class="k">END IF</span>
<a name="ln-3740"></a>
<a name="ln-3741"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3742"></a>
<a name="ln-3743"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3744"></a><span class="k">      IF</span><span class="p">(</span><span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">Capacity</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3745"></a><span class="k">        IF</span><span class="p">(</span><span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">DesHeatingLoad</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3746"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">=</span> <span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">DesHeatingLoad</span>
<a name="ln-3747"></a>        <span class="k">ELSE</span>
<a name="ln-3748"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">=</span> <span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">DesCoolingLoad</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-3749"></a>                                                               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSizingRatio</span>
<a name="ln-3750"></a>        <span class="k">END IF</span>
<a name="ln-3751"></a><span class="k">      ELSE</span>
<a name="ln-3752"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">DXCoolCap</span> <span class="o">&gt;=</span> <span class="n">SmallLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3753"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">=</span> <span class="n">DXCoolCap</span> <span class="o">*</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSizingRatio</span>
<a name="ln-3754"></a>        <span class="k">ELSE</span>
<a name="ln-3755"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3756"></a>        <span class="k">END IF</span>
<a name="ln-3757"></a><span class="k">      END IF</span>
<a name="ln-3758"></a><span class="k">    ELSE IF</span> <span class="p">(</span><span class="n">CurZoneEqNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3759"></a><span class="k">      IF</span><span class="p">(</span><span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">Capacity</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3760"></a><span class="k">        IF</span><span class="p">(</span><span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatingLoad</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3761"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">=</span> <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatingLoad</span>
<a name="ln-3762"></a>        <span class="k">ELSE</span>
<a name="ln-3763"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">=</span> <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolingLoad</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-3764"></a>                                                               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSizingRatio</span>
<a name="ln-3765"></a>        <span class="k">END IF</span>
<a name="ln-3766"></a><span class="k">      ELSE</span>
<a name="ln-3767"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">DXCoolCap</span> <span class="o">&gt;=</span> <span class="n">SmallLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3768"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">=</span> <span class="n">DXCoolCap</span> <span class="o">*</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSizingRatio</span>
<a name="ln-3769"></a>        <span class="k">ELSE</span>
<a name="ln-3770"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3771"></a>        <span class="k">END IF</span>
<a name="ln-3772"></a><span class="k">      END IF</span>
<a name="ln-3773"></a><span class="k">    ELSE IF</span><span class="p">(</span><span class="n">DXCoolCap</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatPump</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3774"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">DXCoolCap</span> <span class="o">&gt;=</span> <span class="n">SmallLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3775"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">=</span> <span class="n">DXCoolCap</span> <span class="o">*</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSizingRatio</span>
<a name="ln-3776"></a>      <span class="k">ELSE</span>
<a name="ln-3777"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3778"></a>      <span class="k">END IF</span>
<a name="ln-3779"></a><span class="k">    ELSE IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3780"></a>
<a name="ln-3781"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3782"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_MultiSpeedHeating</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3783"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWaterToAirHPSimple</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3784"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWaterToAirHP</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3785"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWaterToAirHPVSEquationFit</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3786"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_HeatingEmpirical</span><span class="p">)</span>  <span class="k">THEN</span>
<a name="ln-3787"></a>        <span class="c">! for now, find the associated DX cooling coil to identically size heating coil</span>
<a name="ln-3788"></a>        <span class="n">DXHeatCoilBranch</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3789"></a>        <span class="n">DXHeatCoilCompNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3790"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DXHeatingCoil</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3791"></a><span class="k">          </span><span class="n">BRANCHLoop</span><span class="p">:</span> <span class="k">DO </span><span class="n">BranchNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">NumBranches</span>
<a name="ln-3792"></a>            <span class="k">DO </span><span class="n">CompNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">BranchNum</span><span class="p">)%</span><span class="n">TotalComponents</span>
<a name="ln-3793"></a>              <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">BranchNum</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">TypeOf</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3794"></a>                           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">))</span> <span class="k">CYCLE</span>
<a name="ln-3795"></a><span class="k">              IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">BranchNum</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3796"></a>                           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span> <span class="k">CYCLE</span>
<a name="ln-3797"></a><span class="k">              </span><span class="n">DXHeatCoilBranch</span> <span class="o">=</span> <span class="n">BranchNum</span>
<a name="ln-3798"></a>              <span class="n">DXHeatCoilCompNum</span> <span class="o">=</span> <span class="n">CompNum</span>
<a name="ln-3799"></a>              <span class="k">EXIT </span><span class="n">BRANCHLoop</span>
<a name="ln-3800"></a>            <span class="k">END DO</span>
<a name="ln-3801"></a><span class="k">          END DO </span><span class="n">BRANCHLoop</span>
<a name="ln-3802"></a>        <span class="k">END IF</span>
<a name="ln-3803"></a><span class="k">        IF</span><span class="p">(</span><span class="n">DXHeatCoilCompNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3804"></a><span class="k">          DO </span><span class="n">CompNum</span> <span class="o">=</span> <span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">DXHeatCoilBranch</span><span class="p">)%</span><span class="n">TotalComponents</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-3805"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">BranchNum</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">TypeOf</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3806"></a>                        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3807"></a><span class="k">              IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">BranchNum</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3808"></a>                        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span><span class="k">CYCLE</span>
<a name="ln-3809"></a><span class="k">              </span><span class="n">CoolCoilIndex</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3810"></a>                <span class="n">GetUnitarySystemDXCoolingCoilIndex</span><span class="p">(</span><span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">DXHeatCoilBranch</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-3811"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">CoolCoilIndex</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3812"></a><span class="k">                </span><span class="n">CoolUnitarySystemNum</span> <span class="o">=</span> <span class="n">FinditemInList</span><span class="p">(</span><span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">DXHeatCoilBranch</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3813"></a>                                                    <span class="n">UnitarySystem</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumUnitarySystem</span><span class="p">)</span>
<a name="ln-3814"></a>                <span class="n">CoolCoilType</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">CoolUnitarySystemNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span>
<a name="ln-3815"></a>                <span class="n">DXCoolCap</span> <span class="o">=</span> <span class="n">GetCoilCapacityByIndexType</span><span class="p">(</span><span class="n">CoolCoilIndex</span><span class="p">,</span><span class="n">CoolCoilType</span><span class="p">,</span><span class="n">ErrFound</span><span class="p">)</span>
<a name="ln-3816"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">=</span> <span class="n">DXCoolCap</span><span class="o">*</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSizingRatio</span>
<a name="ln-3817"></a>                <span class="k">EXIT</span>
<a name="ln-3818"></a><span class="k">              END IF</span>
<a name="ln-3819"></a><span class="k">            ELSE IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">BranchNum</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">TypeOf</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3820"></a>                        <span class="s1">&#39;CoilSystem:Cooling:DX&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-3821"></a><span class="k">              </span><span class="n">CoolCoilType</span>  <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3822"></a>              <span class="n">CoolCoilIndex</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3823"></a>              <span class="n">CoolCoilName</span> <span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-3824"></a>              <span class="k">CALL </span><span class="n">GetCoolingCoilTypeNameAndIndex</span><span class="p">(</span><span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">BranchNum</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3825"></a>                                              <span class="n">CoolCoilType</span><span class="p">,</span><span class="n">CoolCoilIndex</span><span class="p">,</span><span class="n">CoolCoilName</span><span class="p">,</span><span class="n">ErrFound</span><span class="p">)</span>
<a name="ln-3826"></a>              <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">CoolCoilType</span><span class="p">)</span>
<a name="ln-3827"></a>                <span class="k">CASE</span><span class="p">(</span><span class="n">CoilDX_CoolingSingleSpeed</span><span class="p">,</span><span class="n">CoilDX_CoolingTwoSpeed</span><span class="p">,</span><span class="n">CoilDX_CoolingTwoStageWHumControl</span><span class="p">)</span>
<a name="ln-3828"></a>                  <span class="n">DXCoolCap</span> <span class="o">=</span> <span class="n">GetCoilCapacityByIndexType</span><span class="p">(</span><span class="n">CoolCoilIndex</span><span class="p">,</span><span class="n">CoolCoilType</span><span class="p">,</span><span class="n">ErrFound</span><span class="p">)</span>
<a name="ln-3829"></a>                <span class="k">CASE</span><span class="p">(</span><span class="n">CoilDX_CoolingHXAssisted</span><span class="p">)</span>
<a name="ln-3830"></a>                  <span class="n">DXCoolCap</span> <span class="o">=</span> <span class="n">GetCoilCapacity</span><span class="p">(</span><span class="n">cAllCoilTypes</span><span class="p">(</span><span class="n">CoolCoilType</span><span class="p">),</span> <span class="n">CoolCoilName</span><span class="p">,</span><span class="n">ErrFound</span><span class="p">)</span>
<a name="ln-3831"></a>                <span class="k">CASE</span><span class="p">(</span><span class="n">Coil_CoolingAirToAirVariableSpeed</span><span class="p">)</span>
<a name="ln-3832"></a>                  <span class="n">DXCoolCap</span> <span class="o">=</span> <span class="n">GetCoilCapacityByIndexType</span><span class="p">(</span><span class="n">CoolCoilIndex</span><span class="p">,</span><span class="n">CoolCoilType</span><span class="p">,</span><span class="n">ErrFound</span><span class="p">)</span>
<a name="ln-3833"></a>                <span class="c">! the following CASE&#39;s are not allowed in CoilSystem:Cooling:DX</span>
<a name="ln-3834"></a>                <span class="k">CASE</span><span class="p">(</span><span class="n">Coil_CoolingWaterToAirHPSimple</span><span class="p">)</span>
<a name="ln-3835"></a>                  <span class="n">DXCoolCap</span> <span class="o">=</span> <span class="n">GetSimpleCoilCapacity</span><span class="p">(</span><span class="n">cAllCoilTypes</span><span class="p">(</span><span class="n">CoolCoilType</span><span class="p">),</span> <span class="n">CoolCoilName</span><span class="p">,</span><span class="n">ErrFound</span><span class="p">)</span>
<a name="ln-3836"></a>                <span class="k">CASE</span><span class="p">(</span><span class="n">Coil_CoolingWaterToAirHP</span><span class="p">)</span>
<a name="ln-3837"></a>                  <span class="n">DXCoolCap</span> <span class="o">=</span> <span class="n">GetWAHPCoilCapacity</span><span class="p">(</span><span class="n">cAllCoilTypes</span><span class="p">(</span><span class="n">CoolCoilType</span><span class="p">),</span> <span class="n">CoolCoilName</span><span class="p">,</span><span class="n">ErrFound</span><span class="p">)</span>
<a name="ln-3838"></a>                <span class="k">CASE</span><span class="p">(</span><span class="n">Coil_CoolingWaterToAirHPVSEquationFit</span><span class="p">)</span>
<a name="ln-3839"></a>                  <span class="n">DXCoolCap</span> <span class="o">=</span> <span class="n">GetCoilCapacityVariableSpeed</span><span class="p">(</span><span class="n">cAllCoilTypes</span><span class="p">(</span><span class="n">CoolCoilType</span><span class="p">),</span> <span class="n">CoolCoilName</span><span class="p">,</span><span class="n">ErrFound</span><span class="p">)</span>
<a name="ln-3840"></a>                <span class="k">CASE</span><span class="p">(</span><span class="n">CoilDX_MultiSpeedCooling</span><span class="p">)</span>
<a name="ln-3841"></a>                  <span class="n">DXCoolCap</span> <span class="o">=</span> <span class="n">GetCoilCapacityByIndexType</span><span class="p">(</span><span class="n">CoolCoilIndex</span><span class="p">,</span><span class="n">CoolCoilType</span><span class="p">,</span><span class="n">ErrFound</span><span class="p">)</span>
<a name="ln-3842"></a>                <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-3843"></a>              <span class="k">END SELECT</span>
<a name="ln-3844"></a>
<a name="ln-3845"></a><span class="k">              </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span> <span class="o">=</span> <span class="n">CoolCoilIndex</span>
<a name="ln-3846"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3847"></a><span class="k">                IF</span> <span class="p">(</span><span class="n">DXCoolCap</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3848"></a>                   <span class="n">DXCoolCap</span><span class="o">*</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSizingRatio</span>
<a name="ln-3849"></a><span class="c">!                EXIT - don&#39;t exit, see if there is a UnitarySystem on the branch more upstream of the CoilSystem</span>
<a name="ln-3850"></a>              <span class="k">END IF</span>
<a name="ln-3851"></a><span class="k">            END IF</span>
<a name="ln-3852"></a><span class="k">          END DO</span>
<a name="ln-3853"></a><span class="k">          IF</span><span class="p">(</span><span class="n">DXCoolCap</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3854"></a><span class="k">            IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3855"></a><span class="k">              </span><span class="n">VolFlowRate</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span>
<a name="ln-3856"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">VolFlowRate</span> <span class="o">&gt;=</span> <span class="n">SmallAirVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3857"></a><span class="k">                IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! coil is in the OA stream</span>
<a name="ln-3858"></a>                  <span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatOutTemp</span>
<a name="ln-3859"></a>                  <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatOutHumRat</span>
<a name="ln-3860"></a>                  <span class="n">SupTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolTemp</span>
<a name="ln-3861"></a>                  <span class="n">SupHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolHumRat</span>
<a name="ln-3862"></a>                  <span class="n">OutTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatOutTemp</span>
<a name="ln-3863"></a>                <span class="k">ELSE IF</span><span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span> <span class="c">! coil is on the main air loop</span>
<a name="ln-3864"></a>                  <span class="n">SupTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatSupTemp</span>
<a name="ln-3865"></a>                  <span class="n">SupHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatSupHumRat</span>
<a name="ln-3866"></a>                  <span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatMixTemp</span>
<a name="ln-3867"></a>                  <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatMixHumRat</span>
<a name="ln-3868"></a>                  <span class="n">OutTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatOutTemp</span>
<a name="ln-3869"></a>                <span class="k">ELSE</span> <span class="c">! coil is zone equipment</span>
<a name="ln-3870"></a>                  <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">OAVolFlow</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3871"></a><span class="k">                    </span><span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatCoilInTemp</span>
<a name="ln-3872"></a>                    <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatCoilInHumRat</span>
<a name="ln-3873"></a>                  <span class="k">ELSE</span>
<a name="ln-3874"></a><span class="k">                    </span><span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">ZoneRetTempAtCoolPeak</span>
<a name="ln-3875"></a>                    <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">ZoneHumRatAtCoolPeak</span>
<a name="ln-3876"></a>                  <span class="k">END IF</span>
<a name="ln-3877"></a><span class="k">                  </span><span class="n">SupTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">HeatDesTemp</span>
<a name="ln-3878"></a>                  <span class="n">SupHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">HeatDesHumRat</span>
<a name="ln-3879"></a>                  <span class="n">TimeStepNumAtMax</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">TimeStepNumAtCoolMax</span>
<a name="ln-3880"></a>                  <span class="n">DDNum</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">CoolDDNum</span>
<a name="ln-3881"></a>                  <span class="k">IF</span> <span class="p">(</span><span class="n">DDNum</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">TimeStepNumAtMax</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3882"></a><span class="k">                    </span><span class="n">OutTemp</span> <span class="o">=</span> <span class="n">DesDayWeath</span><span class="p">(</span><span class="n">DDNum</span><span class="p">)%</span><span class="n">Temp</span><span class="p">(</span><span class="n">TimeStepNumAtMax</span><span class="p">)</span>
<a name="ln-3883"></a>                  <span class="k">ELSE</span>
<a name="ln-3884"></a><span class="k">                    </span><span class="n">OutTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3885"></a>                  <span class="n">ENDIF</span>
<a name="ln-3886"></a>                <span class="k">END IF</span>
<a name="ln-3887"></a><span class="k">                </span><span class="n">rhoair</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-3888"></a>                <span class="n">MixEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-3889"></a>                <span class="n">MixWetBulb</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-3890"></a>                <span class="n">SupEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">SupTemp</span><span class="p">,</span><span class="n">SupHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-3891"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_MultiSpeedHeating</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3892"></a>                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_HeatingEmpirical</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3893"></a><span class="k">                  </span><span class="n">CapFTCurve</span> <span class="o">=</span> <span class="n">GetDXCoilCapFTCurveIndex</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span><span class="n">ErrFound</span><span class="p">)</span>
<a name="ln-3894"></a>                  <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">CapFTCurve</span><span class="p">,</span><span class="n">MixWetBulb</span><span class="p">,</span><span class="n">OutTemp</span><span class="p">)</span>
<a name="ln-3895"></a>                <span class="k">ELSE</span>
<a name="ln-3896"></a><span class="k">                  </span><span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-3897"></a>                <span class="k">END IF</span>
<a name="ln-3898"></a><span class="k">                </span><span class="n">HeatCapAtPeak</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="p">(</span><span class="n">rhoair</span> <span class="o">*</span> <span class="n">VolFlowRate</span> <span class="o">*</span> <span class="p">(</span><span class="n">SupEnth</span><span class="o">-</span><span class="n">MixEnth</span><span class="p">)))</span>
<a name="ln-3899"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">TotCapTempModFac</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3900"></a><span class="k">                  </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">=</span> <span class="n">HeatCapAtPeak</span> <span class="o">/</span> <span class="n">TotCapTempModFac</span>
<a name="ln-3901"></a>                <span class="k">ELSE</span>
<a name="ln-3902"></a><span class="k">                  </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">=</span> <span class="n">HeatCapAtPeak</span>
<a name="ln-3903"></a>                <span class="k">END IF</span>
<a name="ln-3904"></a><span class="k">                IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3905"></a><span class="k">                  </span><span class="n">RatedVolFlowPerRatedTotCap</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">/</span>   <span class="p">&amp;</span>
<a name="ln-3906"></a>                     <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span>
<a name="ln-3907"></a>                <span class="k">ELSE</span>
<a name="ln-3908"></a><span class="k">                  </span><span class="n">RatedVolFlowPerRatedTotCap</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3909"></a>                <span class="k">END IF</span>
<a name="ln-3910"></a>                <span class="c">! check capacity to make sure design volume flow per total capacity is within range</span>
<a name="ln-3911"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">RatedVolFlowPerRatedTotCap</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">MinRatedVolFlowPerRatedTotCap1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3912"></a><span class="k">                  </span><span class="n">HeatCapAtPeak</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="p">&amp;</span>
<a name="ln-3913"></a>                                                   <span class="o">/</span> <span class="n">MinRatedVolFlowPerRatedTotCap1</span>
<a name="ln-3914"></a>                  <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">=</span> <span class="n">HeatCapAtPeak</span>
<a name="ln-3915"></a>                  <span class="n">DXCoolCap</span> <span class="o">=</span> <span class="n">HeatCapAtPeak</span>
<a name="ln-3916"></a>                <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">RatedVolFlowPerRatedTotCap</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">MaxRatedVolFlowPerRatedTotCap1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3917"></a><span class="k">                  </span><span class="n">HeatCapAtPeak</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="p">&amp;</span>
<a name="ln-3918"></a>                                                    <span class="o">/</span> <span class="n">MaxRatedVolFlowPerRatedTotCap1</span>
<a name="ln-3919"></a>                  <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">=</span> <span class="n">HeatCapAtPeak</span>
<a name="ln-3920"></a>                  <span class="n">DXCoolCap</span> <span class="o">=</span> <span class="n">HeatCapAtPeak</span>
<a name="ln-3921"></a>                <span class="k">END IF</span>
<a name="ln-3922"></a><span class="k">              END IF</span> <span class="c">! IF (VolFlowRate &gt;= SmallAirVolFlow) THEN</span>
<a name="ln-3923"></a>            <span class="k">END IF</span> <span class="c">! IF(UnitarySystem(UnitarySysNum)%DesignHeatingCapacity == Autosize)THEN</span>
<a name="ln-3924"></a>          <span class="k">END IF</span> <span class="c">! IF(DXCoolCap == 0.0d0)THEN</span>
<a name="ln-3925"></a>        <span class="k">ELSE</span>
<a name="ln-3926"></a><span class="k">          IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3927"></a><span class="k">            </span><span class="n">VolFlowRate</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span>
<a name="ln-3928"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">VolFlowRate</span> <span class="o">&gt;=</span> <span class="n">SmallAirVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3929"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! coil is in the OA stream</span>
<a name="ln-3930"></a>                <span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatOutTemp</span>
<a name="ln-3931"></a>                <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatOutHumRat</span>
<a name="ln-3932"></a>                <span class="n">SupTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolTemp</span>
<a name="ln-3933"></a>                <span class="n">SupHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolHumRat</span>
<a name="ln-3934"></a>                <span class="n">OutTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatOutTemp</span>
<a name="ln-3935"></a>              <span class="k">ELSE IF</span><span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span> <span class="c">! coil is on the main air loop</span>
<a name="ln-3936"></a>                <span class="n">SupTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatSupTemp</span>
<a name="ln-3937"></a>                <span class="n">SupHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatSupHumRat</span>
<a name="ln-3938"></a>                <span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatMixTemp</span>
<a name="ln-3939"></a>                <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatMixHumRat</span>
<a name="ln-3940"></a>                <span class="n">OutTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatOutTemp</span>
<a name="ln-3941"></a>              <span class="k">ELSE</span> <span class="c">! coil is zone equipment</span>
<a name="ln-3942"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">OAVolFlow</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3943"></a><span class="k">                  </span><span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatCoilInTemp</span>
<a name="ln-3944"></a>                  <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatCoilInHumRat</span>
<a name="ln-3945"></a>                <span class="k">ELSE</span>
<a name="ln-3946"></a><span class="k">                  </span><span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">ZoneRetTempAtCoolPeak</span>
<a name="ln-3947"></a>                  <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">ZoneHumRatAtCoolPeak</span>
<a name="ln-3948"></a>                <span class="k">END IF</span>
<a name="ln-3949"></a><span class="k">                </span><span class="n">SupTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">HeatDesTemp</span>
<a name="ln-3950"></a>                <span class="n">SupHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">HeatDesHumRat</span>
<a name="ln-3951"></a>                <span class="n">TimeStepNumAtMax</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">TimeStepNumAtHeatMax</span>
<a name="ln-3952"></a>                <span class="n">DDNum</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">HeatDDNum</span>
<a name="ln-3953"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">DDNum</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">TimeStepNumAtMax</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3954"></a><span class="k">                  </span><span class="n">OutTemp</span> <span class="o">=</span> <span class="n">DesDayWeath</span><span class="p">(</span><span class="n">DDNum</span><span class="p">)%</span><span class="n">Temp</span><span class="p">(</span><span class="n">TimeStepNumAtMax</span><span class="p">)</span>
<a name="ln-3955"></a>                <span class="k">ELSE</span>
<a name="ln-3956"></a><span class="k">                  </span><span class="n">OutTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3957"></a>                <span class="n">ENDIF</span>
<a name="ln-3958"></a>              <span class="k">END IF</span>
<a name="ln-3959"></a><span class="k">              </span><span class="n">rhoair</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-3960"></a>              <span class="n">MixEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-3961"></a>              <span class="n">MixWetBulb</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-3962"></a>              <span class="n">SupEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">SupTemp</span><span class="p">,</span><span class="n">SupHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-3963"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_MultiSpeedHeating</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3964"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_HeatingEmpirical</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3965"></a><span class="k">                </span><span class="n">CapFTCurve</span> <span class="o">=</span> <span class="n">GetDXCoilCapFTCurveIndex</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span><span class="n">ErrFound</span><span class="p">)</span>
<a name="ln-3966"></a>                <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">CapFTCurve</span><span class="p">,</span><span class="n">MixWetBulb</span><span class="p">,</span><span class="n">OutTemp</span><span class="p">)</span>
<a name="ln-3967"></a>              <span class="k">ELSE</span>
<a name="ln-3968"></a><span class="k">                </span><span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-3969"></a>              <span class="k">END IF</span>
<a name="ln-3970"></a><span class="k">              </span><span class="n">HeatCapAtPeak</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="p">(</span><span class="n">rhoair</span> <span class="o">*</span> <span class="n">VolFlowRate</span> <span class="o">*</span> <span class="p">(</span><span class="n">SupEnth</span><span class="o">-</span><span class="n">MixEnth</span><span class="p">)))</span>
<a name="ln-3971"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">TotCapTempModFac</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3972"></a><span class="k">                </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">=</span> <span class="n">HeatCapAtPeak</span> <span class="o">/</span> <span class="n">TotCapTempModFac</span>
<a name="ln-3973"></a>              <span class="k">ELSE</span>
<a name="ln-3974"></a><span class="k">                </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">=</span> <span class="n">HeatCapAtPeak</span>
<a name="ln-3975"></a>              <span class="k">END IF</span>
<a name="ln-3976"></a><span class="k">              </span><span class="n">DXCoolCap</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span>
<a name="ln-3977"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3978"></a><span class="k">                </span><span class="n">RatedVolFlowPerRatedTotCap</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">/</span>   <span class="p">&amp;</span>
<a name="ln-3979"></a>                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span>
<a name="ln-3980"></a>              <span class="k">ELSE</span>
<a name="ln-3981"></a><span class="k">                </span><span class="n">RatedVolFlowPerRatedTotCap</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3982"></a>              <span class="k">END IF</span>
<a name="ln-3983"></a>              <span class="c">! check capacity to make sure design volume flow per total capacity is within range</span>
<a name="ln-3984"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">RatedVolFlowPerRatedTotCap</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">MinRatedVolFlowPerRatedTotCap1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3985"></a><span class="k">                </span><span class="n">HeatCapAtPeak</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="p">&amp;</span>
<a name="ln-3986"></a>                                                 <span class="o">/</span> <span class="n">MinRatedVolFlowPerRatedTotCap1</span>
<a name="ln-3987"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">=</span> <span class="n">HeatCapAtPeak</span>
<a name="ln-3988"></a>                <span class="n">DXCoolCap</span> <span class="o">=</span> <span class="n">HeatCapAtPeak</span>
<a name="ln-3989"></a>              <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">RatedVolFlowPerRatedTotCap</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">MaxRatedVolFlowPerRatedTotCap1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3990"></a><span class="k">                </span><span class="n">HeatCapAtPeak</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="p">&amp;</span>
<a name="ln-3991"></a>                                                  <span class="o">/</span> <span class="n">MaxRatedVolFlowPerRatedTotCap1</span>
<a name="ln-3992"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">=</span> <span class="n">HeatCapAtPeak</span>
<a name="ln-3993"></a>                <span class="n">DXCoolCap</span> <span class="o">=</span> <span class="n">HeatCapAtPeak</span>
<a name="ln-3994"></a>              <span class="k">END IF</span>
<a name="ln-3995"></a><span class="k">            END IF</span> <span class="c">! IF (VolFlowRate &gt;= SmallAirVolFlow) THEN</span>
<a name="ln-3996"></a>          <span class="k">END IF</span> <span class="c">! IF(UnitarySystem(UnitarySysNum)%DesignHeatingCapacity == Autosize)THEN</span>
<a name="ln-3997"></a>        <span class="k">END IF</span> <span class="c">! IF(DXHeatCoilCompNum .GT. 0)THEN</span>
<a name="ln-3998"></a>
<a name="ln-3999"></a>      <span class="k">ELSE</span> <span class="c">! else not a HP heating coil</span>
<a name="ln-4000"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4001"></a><span class="k">          IF</span><span class="p">(</span><span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">Capacity</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4002"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">=</span> <span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">DesHeatingLoad</span>
<a name="ln-4003"></a>        <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4004"></a><span class="k">          IF</span><span class="p">(</span><span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">Capacity</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4005"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">=</span> <span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesHeatingLoad</span>
<a name="ln-4006"></a>        <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">CurZoneEqNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4007"></a><span class="k">          IF</span><span class="p">(</span><span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">Capacity</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4008"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">=</span> <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatingLoad</span>
<a name="ln-4009"></a>        <span class="k">END IF</span>
<a name="ln-4010"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4011"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4012"></a><span class="k">            IF</span><span class="p">(</span><span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">AirFlow</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4013"></a><span class="k">              </span><span class="n">VolFlowRate</span> <span class="o">=</span> <span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">AirVolFlow</span>
<a name="ln-4014"></a>            <span class="k">ELSE</span>
<a name="ln-4015"></a><span class="k">              </span><span class="n">VolFlowRate</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span>
<a name="ln-4016"></a>            <span class="k">END IF</span>
<a name="ln-4017"></a><span class="k">          ELSE</span>
<a name="ln-4018"></a><span class="k">            IF</span><span class="p">(</span><span class="n">CurZoneEqNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4019"></a><span class="k">              IF</span><span class="p">(</span><span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirFlow</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4020"></a><span class="k">                </span><span class="n">VolFlowRate</span> <span class="o">=</span> <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirVolFlow</span>
<a name="ln-4021"></a>              <span class="k">ELSE</span>
<a name="ln-4022"></a><span class="k">                </span><span class="n">VolFlowRate</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatVolFlow</span>
<a name="ln-4023"></a>              <span class="k">END IF</span>
<a name="ln-4024"></a><span class="k">            ELSE</span>
<a name="ln-4025"></a><span class="k">              IF</span><span class="p">(</span><span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">AirFlow</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4026"></a><span class="k">                </span><span class="n">VolFlowRate</span> <span class="o">=</span> <span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">AirVolFlow</span>
<a name="ln-4027"></a>              <span class="k">ELSE</span>
<a name="ln-4028"></a><span class="k">                SELECT CASE</span><span class="p">(</span><span class="n">CurDuctType</span><span class="p">)</span>
<a name="ln-4029"></a>                  <span class="k">CASE</span><span class="p">(</span><span class="n">Main</span><span class="p">)</span>
<a name="ln-4030"></a>                    <span class="n">VolFlowRate</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">SysAirMinFlowRat</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-4031"></a>                  <span class="k">CASE</span><span class="p">(</span><span class="n">Cooling</span><span class="p">)</span>
<a name="ln-4032"></a>                    <span class="n">VolFlowRate</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">SysAirMinFlowRat</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesCoolVolFlow</span>
<a name="ln-4033"></a>                  <span class="k">CASE</span><span class="p">(</span><span class="n">Heating</span><span class="p">)</span>
<a name="ln-4034"></a>                    <span class="n">VolFlowRate</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesHeatVolFlow</span>
<a name="ln-4035"></a>                  <span class="k">CASE</span><span class="p">(</span><span class="n">Other</span><span class="p">)</span>
<a name="ln-4036"></a>                    <span class="n">VolFlowRate</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-4037"></a>                  <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-4038"></a>                    <span class="n">VolFlowRate</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-4039"></a>                <span class="k">END SELECT</span>
<a name="ln-4040"></a><span class="k">              END IF</span>
<a name="ln-4041"></a><span class="k">            END IF</span>
<a name="ln-4042"></a><span class="k">          END IF</span>
<a name="ln-4043"></a>          <span class="c">! get the outside air fraction</span>
<a name="ln-4044"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4045"></a><span class="k">            </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4046"></a>          <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4047"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatOAOption</span> <span class="o">==</span> <span class="n">MinOA</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4048"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">VolFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4049"></a><span class="k">                </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span> <span class="o">/</span> <span class="n">VolFlowRate</span>
<a name="ln-4050"></a>              <span class="k">ELSE</span>
<a name="ln-4051"></a><span class="k">                </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4052"></a>              <span class="k">END IF</span>
<a name="ln-4053"></a><span class="k">            ELSE</span>
<a name="ln-4054"></a><span class="k">              </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4055"></a>            <span class="k">END IF</span>
<a name="ln-4056"></a><span class="k">            </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">OutAirFrac</span><span class="p">))</span>
<a name="ln-4057"></a>          <span class="k">ELSE</span>
<a name="ln-4058"></a><span class="k">            </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4059"></a>          <span class="k">END IF</span>
<a name="ln-4060"></a>          <span class="c">! coil inlet temperature</span>
<a name="ln-4061"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">CurZoneEqNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4062"></a><span class="k">            </span><span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatCoilInTemp</span>
<a name="ln-4063"></a>            <span class="n">CpAirStd</span> <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mi">2</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-4064"></a>            <span class="n">HeatCapAtPeak</span> <span class="o">=</span> <span class="n">CpAirStd</span><span class="o">*</span><span class="n">StdRhoAir</span><span class="o">*</span><span class="n">VolFlowRate</span><span class="o">*</span><span class="p">(</span><span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">HeatDesTemp</span> <span class="o">-</span> <span class="n">MixTemp</span><span class="p">)</span>
<a name="ln-4065"></a>            <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">Capacity</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4066"></a>            <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatingLoad</span> <span class="o">=</span> <span class="n">HeatCapAtPeak</span>
<a name="ln-4067"></a>          <span class="k">ELSE</span>
<a name="ln-4068"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">NumOAHeatCoils</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4069"></a><span class="k">              </span><span class="n">MixTemp</span> <span class="o">=</span> <span class="n">OutAirFrac</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PreheatTemp</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4070"></a>                         <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">OutAirFrac</span><span class="p">)</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatRetTemp</span>
<a name="ln-4071"></a>            <span class="k">ELSE</span>
<a name="ln-4072"></a><span class="k">              </span><span class="n">MixTemp</span> <span class="o">=</span> <span class="n">OutAirFrac</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatOutTemp</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4073"></a>                         <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">OutAirFrac</span><span class="p">)</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatRetTemp</span>
<a name="ln-4074"></a>            <span class="k">END IF</span>
<a name="ln-4075"></a>            <span class="c">! coil load</span>
<a name="ln-4076"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4077"></a><span class="k">              IF</span><span class="p">(</span><span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">Capacity</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4078"></a><span class="k">                </span><span class="n">HeatCapAtPeak</span> <span class="o">=</span> <span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">DesHeatingLoad</span>
<a name="ln-4079"></a>              <span class="k">ELSE</span>
<a name="ln-4080"></a><span class="k">                </span><span class="n">CpAirStd</span> <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mi">2</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-4081"></a>                <span class="n">HeatCapAtPeak</span> <span class="o">=</span> <span class="n">CpAirStd</span><span class="o">*</span><span class="n">StdRhoAir</span><span class="o">*</span><span class="n">VolFlowRate</span><span class="o">*</span><span class="p">(</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PreheatTemp</span> <span class="o">-</span> <span class="n">MixTemp</span><span class="p">)</span>
<a name="ln-4082"></a>              <span class="k">END IF</span>
<a name="ln-4083"></a><span class="k">            ELSE</span>
<a name="ln-4084"></a><span class="k">              IF</span><span class="p">(</span><span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">Capacity</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4085"></a><span class="k">                </span><span class="n">HeatCapAtPeak</span> <span class="o">=</span> <span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesHeatingLoad</span>
<a name="ln-4086"></a>              <span class="k">ELSE</span>
<a name="ln-4087"></a><span class="k">                </span><span class="n">CpAirStd</span> <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mi">2</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-4088"></a>                <span class="n">HeatCapAtPeak</span> <span class="o">=</span> <span class="n">CpAirStd</span><span class="o">*</span><span class="n">StdRhoAir</span><span class="o">*</span><span class="n">VolFlowRate</span><span class="o">*</span><span class="p">(</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatSupTemp</span> <span class="o">-</span> <span class="n">MixTemp</span><span class="p">)</span>
<a name="ln-4089"></a>              <span class="k">END IF</span>
<a name="ln-4090"></a><span class="k">            END IF</span>
<a name="ln-4091"></a><span class="k">            </span><span class="n">UnitaryHeatCap</span> <span class="o">=</span> <span class="n">HeatCapAtPeak</span>
<a name="ln-4092"></a>          <span class="k">END IF</span>
<a name="ln-4093"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">=</span> <span class="n">HeatCapAtPeak</span>
<a name="ln-4094"></a>        <span class="k">END IF</span>
<a name="ln-4095"></a><span class="k">      END IF</span>
<a name="ln-4096"></a>
<a name="ln-4097"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">&lt;</span> <span class="n">SmallLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4098"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4099"></a>      <span class="k">END IF</span>
<a name="ln-4100"></a>
<a name="ln-4101"></a><span class="k">    END IF</span>
<a name="ln-4102"></a>
<a name="ln-4103"></a><span class="k">    CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4104"></a>                            <span class="s1">&#39;Nominal Heating Capacity [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4105"></a>                            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span><span class="p">)</span>
<a name="ln-4106"></a>
<a name="ln-4107"></a>  <span class="k">END IF</span>
<a name="ln-4108"></a>
<a name="ln-4109"></a><span class="k">  </span><span class="n">UnitaryHeatCap</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span>
<a name="ln-4110"></a>
<a name="ln-4111"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignCoolingCapacity</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4112"></a>
<a name="ln-4113"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4114"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">DXCoolCap</span> <span class="o">&gt;=</span> <span class="n">SmallLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4115"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignCoolingCapacity</span> <span class="o">=</span> <span class="n">DXCoolCap</span>
<a name="ln-4116"></a>      <span class="k">ELSE</span>
<a name="ln-4117"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignCoolingCapacity</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4118"></a>      <span class="k">END IF</span>
<a name="ln-4119"></a><span class="k">    ELSE IF</span> <span class="p">(</span><span class="n">CurZoneEqNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4120"></a>
<a name="ln-4121"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">DXCoolCap</span> <span class="o">&gt;=</span> <span class="n">SmallLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4122"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignCoolingCapacity</span> <span class="o">=</span> <span class="n">DXCoolCap</span>
<a name="ln-4123"></a>      <span class="k">ELSE</span>
<a name="ln-4124"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignCoolingCapacity</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4125"></a>      <span class="k">END IF</span>
<a name="ln-4126"></a><span class="k">    ELSE IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4127"></a>
<a name="ln-4128"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">DXCoolCap</span> <span class="o">&gt;=</span> <span class="n">SmallLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4129"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignCoolingCapacity</span> <span class="o">=</span> <span class="n">DXCoolCap</span>
<a name="ln-4130"></a>      <span class="k">ELSE</span>
<a name="ln-4131"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignCoolingCapacity</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4132"></a>      <span class="k">END IF</span>
<a name="ln-4133"></a><span class="k">    END IF</span>
<a name="ln-4134"></a>
<a name="ln-4135"></a><span class="k">    CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4136"></a>                            <span class="s1">&#39;Nominal Cooling Capacity [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4137"></a>                            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesigncoolingCapacity</span><span class="p">)</span>
<a name="ln-4138"></a>
<a name="ln-4139"></a>  <span class="k">END IF</span>
<a name="ln-4140"></a>
<a name="ln-4141"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignMaxOutletTemp</span> <span class="o">==</span> <span class="n">AutoSize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4142"></a>      <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilExists</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4143"></a>
<a name="ln-4144"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4145"></a><span class="k">      </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignMaxOutletTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatSupTemp</span>
<a name="ln-4146"></a>    <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">CurZoneEqNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4147"></a><span class="k">      </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignMaxOutletTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">HeatDesTemp</span>
<a name="ln-4148"></a>    <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4149"></a><span class="k">      </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignMaxOutletTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatSupTemp</span>
<a name="ln-4150"></a>    <span class="k">END IF</span>
<a name="ln-4151"></a>
<a name="ln-4152"></a><span class="k">    CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4153"></a>                            <span class="s1">&#39;Maximum Supply Air Temperature from Unitary Heater [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4154"></a>                            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignMaxOutletTemp</span><span class="p">)</span>
<a name="ln-4155"></a>
<a name="ln-4156"></a>  <span class="k">END IF</span>
<a name="ln-4157"></a>
<a name="ln-4158"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4159"></a>
<a name="ln-4160"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4161"></a><span class="k">      </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatCap</span>
<a name="ln-4162"></a>    <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">CurZoneEqNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4163"></a><span class="k">      </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatLoad</span>
<a name="ln-4164"></a>    <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4165"></a>
<a name="ln-4166"></a>      <span class="c">! set the supplemental heating capacity to the actual heating load</span>
<a name="ln-4167"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatCap</span>
<a name="ln-4168"></a>      <span class="c">! If reheat needed for humidity control, make sure supplemental heating is at least as big</span>
<a name="ln-4169"></a>      <span class="c">! as the cooling capacity</span>
<a name="ln-4170"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Humidistat</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4171"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">==</span> <span class="n">DehumidControl_CoolReheat</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4172"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4173"></a>                                                            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignCoolingCapacity</span><span class="p">)</span>
<a name="ln-4174"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span> <span class="o">&lt;</span> <span class="n">SmallLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4175"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4176"></a>        <span class="k">END IF</span>
<a name="ln-4177"></a><span class="k">      END IF</span>
<a name="ln-4178"></a>
<a name="ln-4179"></a><span class="k">    END IF</span>
<a name="ln-4180"></a>
<a name="ln-4181"></a><span class="k">    CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4182"></a>                            <span class="s1">&#39;Supplemental Heating Coil Nominal Capacity [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4183"></a>                            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span><span class="p">)</span>
<a name="ln-4184"></a>
<a name="ln-4185"></a>  <span class="k">END IF</span>
<a name="ln-4186"></a>
<a name="ln-4187"></a><span class="k">  </span><span class="n">SuppHeatCap</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span>
<a name="ln-4188"></a>
<a name="ln-4189"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatRecActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4190"></a><span class="k">    CALL </span><span class="n">RegisterPlantCompDesignFlow</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatRecoveryInletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4191"></a>                              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHRWaterVolumeFlow</span> <span class="p">)</span>
<a name="ln-4192"></a>  <span class="k">END IF</span>
<a name="ln-4193"></a>
<a name="ln-4194"></a><span class="k">  IF</span><span class="p">(</span><span class="n">CurOASysNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">CurZoneEqNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4195"></a><span class="k">    </span><span class="n">BranchFlow</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4196"></a>    <span class="n">SystemType</span> <span class="o">=</span> <span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType_Num</span><span class="p">)</span>
<a name="ln-4197"></a>    <span class="n">ErrFound</span>  <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4198"></a>    <span class="c">! check branch flow rate vs system flow rate. Branch must match system of OA system is present</span>
<a name="ln-4199"></a>    <span class="k">CALL </span><span class="n">CheckSystemBranchFlow</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SystemType</span><span class="p">),</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4200"></a>                               <span class="n">BranchFlow</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span><span class="p">,</span><span class="n">ErrFound</span><span class="p">)</span>
<a name="ln-4201"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">ErrFound</span><span class="p">)</span><span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SystemType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4202"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4203"></a><span class="k">      IF</span><span class="p">(</span><span class="n">BranchFlow</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4204"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="o">=</span> <span class="n">BranchFlow</span>
<a name="ln-4205"></a>      <span class="k">ELSE</span>
<a name="ln-4206"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4207"></a>                                                                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span><span class="p">)</span>
<a name="ln-4208"></a>      <span class="k">END IF</span>
<a name="ln-4209"></a><span class="k">      </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignMassFlowRate</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="o">*</span> <span class="n">StdRhoAir</span>
<a name="ln-4210"></a>    <span class="k">END IF</span>
<a name="ln-4211"></a><span class="k">  END IF</span>
<a name="ln-4212"></a>
<a name="ln-4213"></a><span class="k">  </span><span class="n">CoolingLoad</span> <span class="o">=</span> <span class="n">TempCoolingLoad</span>
<a name="ln-4214"></a>  <span class="n">HeatingLoad</span> <span class="o">=</span> <span class="n">TempHeatingLoad</span>
<a name="ln-4215"></a>
<a name="ln-4216"></a>  <span class="k">RETURN</span>
<a name="ln-4217"></a>
<a name="ln-4218"></a><span class="k">END SUBROUTINE </span><span class="n">SizeUnitarySystem</span>
<a name="ln-4219"></a>
<a name="ln-4220"></a>
<a name="ln-4221"></a><span class="c">! Get Input Section of the Module</span>
<a name="ln-4222"></a><span class="c">!******************************************************************************</span>
<a name="ln-4223"></a><span class="k">SUBROUTINE </span><span class="n">GetUnitarySystemInput</span>
<a name="ln-4224"></a>
<a name="ln-4225"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4226"></a>          <span class="c">!       AUTHOR         Richard Raustad</span>
<a name="ln-4227"></a>          <span class="c">!       DATE WRITTEN   February 2013</span>
<a name="ln-4228"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4229"></a>
<a name="ln-4230"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4231"></a>          <span class="c">! Obtains input data for system and stores it in System data structures</span>
<a name="ln-4232"></a>
<a name="ln-4233"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4234"></a>          <span class="c">! Uses &quot;Get&quot; routines to read in data.</span>
<a name="ln-4235"></a>
<a name="ln-4236"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4237"></a>
<a name="ln-4238"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4239"></a>    <span class="k">USE </span><span class="n">InputProcessor</span>
<a name="ln-4240"></a>    <span class="k">USE </span><span class="n">NodeInputManager</span><span class="p">,</span>           <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetOnlySingleNode</span>
<a name="ln-4241"></a>    <span class="k">USE </span><span class="n">DataHeatBalance</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">Zone</span>
<a name="ln-4242"></a>    <span class="k">USE </span><span class="n">BranchNodeConnections</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">SetUpCompSets</span><span class="p">,</span> <span class="n">TestCompSet</span>
<a name="ln-4243"></a>    <span class="k">USE </span><span class="n">HVACHXAssistedCoolingCoil</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetHXDXCoilName</span>
<a name="ln-4244"></a>    <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-4245"></a>    <span class="k">USE </span><span class="n">General</span><span class="p">,</span>                    <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-4246"></a>    <span class="k">USE </span><span class="n">DataHVACControllers</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">ControllerTypes</span><span class="p">,</span> <span class="n">ControllerSimple_Type</span>
<a name="ln-4247"></a>    <span class="k">USE </span><span class="n">DXCoils</span><span class="p">,</span>                    <span class="n">ONLY</span><span class="p">:</span> <span class="n">SetCoilSystemCoolingData</span><span class="p">,</span> <span class="n">GetDXCoilAvailSchPtr</span><span class="p">,</span><span class="n">SetDXCoolingCoilData</span>
<a name="ln-4248"></a>    <span class="k">USE </span><span class="n">DataAirSystems</span><span class="p">,</span>             <span class="n">ONLY</span><span class="p">:</span> <span class="n">PrimaryAirSystem</span>
<a name="ln-4249"></a>    <span class="k">USE </span><span class="n">DataZoneControls</span><span class="p">,</span>           <span class="n">ONLY</span><span class="p">:</span> <span class="n">TempControlledZone</span><span class="p">,</span> <span class="n">NumTempControlledZones</span><span class="p">,</span> <span class="n">HumidityControlZone</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-4250"></a>                                          <span class="n">NumHumidityControlZones</span><span class="p">,</span> <span class="n">ComfortControlledZone</span><span class="p">,</span> <span class="n">NumComfortControlledZones</span>
<a name="ln-4251"></a>    <span class="k">USE </span><span class="n">WaterToAirHeatPumpSimple</span><span class="p">,</span>   <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetWtoAHPSimpleCoilCapacity</span><span class="o">=&gt;</span><span class="n">GetCoilCapacity</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4252"></a>                                          <span class="n">GetWtoAHPSimpleCoilInletNode</span><span class="o">=&gt;</span><span class="n">GetCoilInletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4253"></a>                                          <span class="n">GetWtoAHPSimpleCoilOutletNode</span><span class="o">=&gt;</span><span class="n">GetCoilOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4254"></a>                                          <span class="n">GetWtoAHPSimpleCoilIndex</span><span class="o">=&gt;</span><span class="n">GetCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4255"></a>                                          <span class="n">SetSimpleWSHPData</span><span class="p">,</span> <span class="n">GetWtoAHPSimpleCoilAirFlow</span><span class="o">=&gt;</span><span class="n">GetCoilAirFlowRate</span>
<a name="ln-4256"></a>    <span class="k">USE </span><span class="n">VariableSpeedCoils</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCoilCapacityVariableSpeed</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4257"></a>                                          <span class="n">GetCoilInletNodeVariableSpeed</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4258"></a>                                          <span class="n">GetCoilOutletNodeVariableSpeed</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4259"></a>                                          <span class="n">GetCoilIndexVariableSpeed</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4260"></a>                                          <span class="n">GetCoilAirFlowRateVariableSpeed</span><span class="p">,&amp;</span>
<a name="ln-4261"></a>                                          <span class="n">SetVarSpeedCoilData</span><span class="p">,</span> <span class="n">GetVSCoilCondenserInletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4262"></a>                                          <span class="n">GetVSCoilMinOATCompressor</span><span class="p">,</span> <span class="n">GetVSCoilNumOfSpeeds</span>
<a name="ln-4263"></a>    <span class="k">USE </span><span class="n">WaterToAirHeatPump</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetWtoAHPCoilCapacity</span><span class="o">=&gt;</span><span class="n">GetCoilCapacity</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4264"></a>                                          <span class="n">GetWtoAHPCoilInletNode</span><span class="o">=&gt;</span><span class="n">GetCoilInletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4265"></a>                                          <span class="n">GetWtoAHPCoilOutletNode</span><span class="o">=&gt;</span><span class="n">GetCoilOutletNode</span><span class="p">,</span><span class="n">GetWtoAHPCoilIndex</span><span class="o">=&gt;</span><span class="n">GetCoilIndex</span>
<a name="ln-4266"></a>    <span class="k">USE </span><span class="n">HeatingCoils</span><span class="p">,</span>               <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetHeatingCoilCapacity</span><span class="o">=&gt;</span><span class="n">GetCoilCapacity</span><span class="p">,</span><span class="n">GetHeatingCoilInletNode</span><span class="o">=&gt;</span><span class="n">GetCoilInletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4267"></a>                                          <span class="n">GetHeatingCoilOutletNode</span><span class="o">=&gt;</span><span class="n">GetCoilOutletNode</span><span class="p">,</span> <span class="n">GetHeatingCoilIndex</span><span class="o">=&gt;</span><span class="n">GetCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4268"></a>                                          <span class="n">GetHeatingCoilTypeNum</span><span class="p">,</span> <span class="n">GetHeatingCoilPLFCurveIndex</span><span class="p">,</span> <span class="n">GetCoilAvailScheduleIndex</span>
<a name="ln-4269"></a>    <span class="k">USE </span><span class="n">DXCoils</span><span class="p">,</span>                    <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetDXCoilCapacity</span><span class="o">=&gt;</span><span class="n">GetCoilCapacity</span><span class="p">,</span><span class="n">GetMinOATDXCoilCompressor</span><span class="o">=&gt;</span><span class="n">GetMinOATCompressor</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4270"></a>                                          <span class="n">GetDXCoilInletNode</span><span class="o">=&gt;</span><span class="n">GetCoilInletNode</span><span class="p">,</span> <span class="n">GetDXCoilOutletNode</span><span class="o">=&gt;</span><span class="n">GetCoilOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4271"></a>                                          <span class="n">GetDXCoilCondenserInletNode</span><span class="o">=&gt;</span><span class="n">GetCoilCondenserInletNode</span><span class="p">,</span><span class="n">GetDXCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4272"></a>                                          <span class="n">GetDXCoilTypeNum</span><span class="o">=&gt;</span><span class="n">GetCoilTypeNum</span><span class="p">,</span><span class="n">SetDXCoolingCoilData</span><span class="p">,</span><span class="n">GetDXCoilAirFlow</span><span class="p">,</span><span class="n">SetDXCoilTypeData</span>
<a name="ln-4273"></a>    <span class="k">USE </span><span class="n">HVACHXAssistedCoolingCoil</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetDXHXAsstdCoilCapacity</span><span class="o">=&gt;</span><span class="n">GetCoilCapacity</span><span class="p">,</span><span class="n">GetDXHXAsstdCoilInletNode</span><span class="o">=&gt;</span><span class="n">GetCoilInletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4274"></a>                                          <span class="n">GetDXHXAsstdCoilOutletNode</span><span class="o">=&gt;</span><span class="n">GetCoilOutletNode</span><span class="p">,</span><span class="n">GetHXDXCoilName</span><span class="p">,</span><span class="n">GetHXDXCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4275"></a>                                          <span class="n">GetHXAssistedCoilTypeNum</span><span class="o">=&gt;</span><span class="n">GetCoilGroupTypeNum</span><span class="p">,</span> <span class="n">GetActualDXCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4276"></a>                                          <span class="n">GetWaterHXAssistedCoilCapacity</span><span class="o">=&gt;</span><span class="n">GetCoilCapacity</span><span class="p">,</span> <span class="n">GetHXCoilAirFlowRate</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-4277"></a>                                          <span class="n">GetCoilObjectTypeNum</span>
<a name="ln-4278"></a>    <span class="k">USE </span><span class="n">WaterCoils</span><span class="p">,</span>                 <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCoilWaterInletNode</span><span class="p">,</span> <span class="n">GetCoilWaterOutletNode</span><span class="p">,</span> <span class="n">GetCoilMaxWaterFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4279"></a>                                          <span class="n">GetWaterCoilInletNode</span><span class="o">=&gt;</span><span class="n">GetCoilInletNode</span><span class="p">,</span><span class="n">GetWaterCoilOutletNode</span><span class="o">=&gt;</span><span class="n">GetCoilOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4280"></a>                                          <span class="n">GetWaterCoilAvailScheduleIndex</span><span class="p">,</span> <span class="n">GetWaterCoilIndex</span>
<a name="ln-4281"></a>    <span class="k">USE </span><span class="n">SteamCoils</span><span class="p">,</span>                 <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetSteamCoilAirInletNode</span><span class="o">=&gt;</span><span class="n">GetCoilAirInletNode</span><span class="p">,</span> <span class="n">GetSteamCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4282"></a>                                          <span class="n">GetSteamCoilAirOutletNode</span><span class="o">=&gt;</span><span class="n">GetCoilAirOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4283"></a>                                          <span class="n">GetSteamCoilSteamInletNode</span><span class="o">=&gt;</span><span class="n">GetCoilSteamInletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4284"></a>                                          <span class="n">GetCoilMaxSteamFlowRate</span><span class="o">=&gt;</span><span class="n">GetCoilMaxSteamFlowRate</span><span class="p">,</span> <span class="n">ZoneLoadControl</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4285"></a>                                          <span class="n">GetSteamCoilAvailScheduleIndex</span>
<a name="ln-4286"></a>    <span class="k">USE </span><span class="n">Fans</span><span class="p">,</span>                       <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetFanDesignVolumeFlowRate</span><span class="p">,</span><span class="n">GetFanInletNode</span><span class="p">,</span><span class="n">GetFanOutletNode</span><span class="p">,</span><span class="n">GetFanIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4287"></a>                                          <span class="n">GetFanAvailSchPtr</span><span class="p">,</span> <span class="n">GetFanType</span><span class="p">,</span> <span class="n">GetFanIndex</span>
<a name="ln-4288"></a>    <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetSatDensityRefrig</span>
<a name="ln-4289"></a>    <span class="k">USE </span><span class="n">EMSManager</span><span class="p">,</span>                 <span class="n">ONLY</span><span class="p">:</span> <span class="n">ManageEMS</span>
<a name="ln-4290"></a>    <span class="k">USE </span><span class="n">SetPointManager</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">NodeHasSPMCtrlVarType</span><span class="p">,</span> <span class="n">iCtrlVarType_Temp</span><span class="p">,</span> <span class="n">iCtrlVarType_HumRat</span>
<a name="ln-4291"></a>
<a name="ln-4292"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4293"></a>
<a name="ln-4294"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4295"></a>          <span class="c">! na</span>
<a name="ln-4296"></a>
<a name="ln-4297"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4298"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;GetUnitarySystemInput: &#39;</span> <span class="c">! include trailing blank space</span>
<a name="ln-4299"></a>
<a name="ln-4300"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-4301"></a>          <span class="c">! na</span>
<a name="ln-4302"></a>
<a name="ln-4303"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-4304"></a>          <span class="c">! na</span>
<a name="ln-4305"></a>
<a name="ln-4306"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4307"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">Alphas</span>         <span class="c">! Alpha input items for object</span>
<a name="ln-4308"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">cAlphaFields</span>   <span class="c">! Alpha field names</span>
<a name="ln-4309"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">cNumericFields</span> <span class="c">! Numeric field names</span>
<a name="ln-4310"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CurrentModuleObject</span> <span class="c">! for ease in getting objects</span>
<a name="ln-4311"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolingCoilType</span>     <span class="c">! Used in mining function calls</span>
<a name="ln-4312"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolingCoilName</span>     <span class="c">! Used in mining function calls</span>
<a name="ln-4313"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatingCoilType</span>     <span class="c">! Used in mining function calls</span>
<a name="ln-4314"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatingCoilName</span>     <span class="c">! Used in mining function calls</span>
<a name="ln-4315"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">HeatingSizingRatio</span>  <span class="c">! Used to size DX heating coil wrt DX cooling coil</span>
<a name="ln-4316"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SuppHeatCoilType</span>    <span class="c">! Used in mining function calls</span>
<a name="ln-4317"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SuppHeatCoilName</span>    <span class="c">! Used in mining function calls</span>
<a name="ln-4318"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FanType</span>             <span class="c">! Used in mining function calls</span>
<a name="ln-4319"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FanName</span>             <span class="c">! Used in mining function calls</span>
<a name="ln-4320"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">FanIndex</span>            <span class="c">! Used in mining function calls</span>
<a name="ln-4321"></a>    <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>   <span class="kd">::</span> <span class="n">lAlphaBlanks</span>      <span class="c">! Logical array, alpha field input BLANK = .true.</span>
<a name="ln-4322"></a>    <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>   <span class="kd">::</span> <span class="n">lNumericBlanks</span>    <span class="c">! Logical array, numeric field input BLANK = .true.</span>
<a name="ln-4323"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">Numbers</span>     <span class="c">! Numeric input items for object</span>
<a name="ln-4324"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">FanVolFlowRate</span>                        <span class="c">! Fan Max Flow Rate from Fan object (for comparisons to validity)</span>
<a name="ln-4325"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">SteamDensity</span>                          <span class="c">! steam density</span>
<a name="ln-4326"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">TotalFloorAreaOnAirLoop</span>               <span class="c">! AirloopHVAC total floor area served</span>
<a name="ln-4327"></a>    <span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>                 <span class="c">! If errors detected in input</span>
<a name="ln-4328"></a>    <span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">IsNotOK</span>                               <span class="c">! Flag to verify name</span>
<a name="ln-4329"></a>    <span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">IsBlank</span>                               <span class="c">! Flag for blank name</span>
<a name="ln-4330"></a>    <span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">AirNodeFound</span>                          <span class="c">! used in error checking</span>
<a name="ln-4331"></a>    <span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">AirLoopFound</span>                          <span class="c">! used in error checking</span>
<a name="ln-4332"></a>    <span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">ErrFlag</span>                               <span class="c">! Mining function error flag</span>
<a name="ln-4333"></a>    <span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">PrintMessage</span>                          <span class="c">! flag to print or not print message</span>
<a name="ln-4334"></a>    <span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">InletNodeNotControlled</span>                <span class="c">! True if using controller on water coil</span>
<a name="ln-4335"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">UnitarySysNum</span>                         <span class="c">! The Unitary System object currently loading</span>
<a name="ln-4336"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">DesignSpecNum</span>                         <span class="c">! The design Specification object (multispeed coils) currently loading</span>
<a name="ln-4337"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">NumAlphas</span>                             <span class="c">! The number of alpha arguments in each object</span>
<a name="ln-4338"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">NumNumbers</span>                            <span class="c">! The number of numeric arguments in each object</span>
<a name="ln-4339"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">IOStatus</span>                              <span class="c">! The status of the GetObjectItem call</span>
<a name="ln-4340"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">TotalArgs</span><span class="o">=</span><span class="mi">0</span>                           <span class="c">! Total number of alpha and numeric arguments (max) for a</span>
<a name="ln-4341"></a>                                                        <span class="c">! certain object in the input file</span>
<a name="ln-4342"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">FanInletNode</span>                          <span class="c">! Used for node checking warning messages</span>
<a name="ln-4343"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">FanOutletNode</span>                         <span class="c">! Used for node checking warning messages</span>
<a name="ln-4344"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">CoolingCoilInletNode</span>                  <span class="c">! Used for node checking warning messages</span>
<a name="ln-4345"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">CoolingCoilOutletNode</span>                 <span class="c">! Used for node checking warning messages</span>
<a name="ln-4346"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">HeatingCoilInletNode</span>                  <span class="c">! Used for node checking warning messages</span>
<a name="ln-4347"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">HeatingCoilOutletNode</span>                 <span class="c">! Used for node checking warning messages</span>
<a name="ln-4348"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">SupHeatCoilInletNode</span>                  <span class="c">! Used for node checking warning messages</span>
<a name="ln-4349"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">SupHeatCoilOutletNode</span>                 <span class="c">! Used for node checking warning messages</span>
<a name="ln-4350"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">TotalZonesOnAirLoop</span>                   <span class="c">! number of zones connected to air loop</span>
<a name="ln-4351"></a>    <span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">ZoneEquipmentFound</span>                    <span class="c">! TRUE if Unitary System found connected to zone exhaust node</span>
<a name="ln-4352"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">ActualCoolCoilType</span>                    <span class="c">! Coil type number for HX assisted coils</span>
<a name="ln-4353"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">ControlledZoneNum</span>                     <span class="c">! loop counter</span>
<a name="ln-4354"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">ZoneExhNum</span>                            <span class="c">! loop counter</span>
<a name="ln-4355"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">EquipNum</span>                              <span class="c">! loop counter</span>
<a name="ln-4356"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">ZoneInletNum</span>                          <span class="c">! loop counter</span>
<a name="ln-4357"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">AirLoopNumber</span>                         <span class="c">! loop counter</span>
<a name="ln-4358"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">BranchNum</span>                             <span class="c">! loop counter</span>
<a name="ln-4359"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">CompNum</span>                               <span class="c">! loop counter</span>
<a name="ln-4360"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">OACompNum</span>                             <span class="c">! loop counter</span>
<a name="ln-4361"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">TstatZoneNum</span>                          <span class="c">! loop counter</span>
<a name="ln-4362"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">HeatingCoilPLFCurveIndex</span>              <span class="c">! index of heating coil PLF curve</span>
<a name="ln-4363"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">SteamIndex</span>                            <span class="c">! steam index</span>
<a name="ln-4364"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">DXCoilIndex</span>                           <span class="c">! index to DX coil</span>
<a name="ln-4365"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">HSTATZoneNum</span>                          <span class="c">! zone index where humidistat is located</span>
<a name="ln-4366"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">TempAlphas</span>                            <span class="c">! temp alpha array</span>
<a name="ln-4367"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">TempNumbers</span>                           <span class="c">! temp number array</span>
<a name="ln-4368"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="nb">Index</span>                                 <span class="c">! index to multispeed coil speed data</span>
<a name="ln-4369"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">SpeedNum</span>                              <span class="c">! multispeed coil speed</span>
<a name="ln-4370"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">NumOfSpeedCooling</span>                     <span class="c">! number of cooling speeds for multispeed coil</span>
<a name="ln-4371"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">NumOfSpeedHeating</span>                     <span class="c">! number of heating speeds for multispeed coil</span>
<a name="ln-4372"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">StartingSpeedRatioInput</span>               <span class="c">! field where speed ratio inputs start</span>
<a name="ln-4373"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">MaxSpeedNum</span>                           <span class="c">! maximum number of numeric inputs in design specification object</span>
<a name="ln-4374"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">OASysNum</span>                              <span class="c">! loop counter index to outside air system</span>
<a name="ln-4375"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">AirLoopNum</span>                            <span class="c">! loop counter index to primary air system</span>
<a name="ln-4376"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">HXCoilName</span>        <span class="c">! Cooling coil name within HX assembly</span>
<a name="ln-4377"></a>
<a name="ln-4378"></a>    <span class="c">! local integer representation of input field numbers (i.e., alpha=A1 or numeric=N1)</span>
<a name="ln-4379"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iNameAlphaNum</span>                         <span class="c">! get input index to unitary system name</span>
<a name="ln-4380"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iControlTypeAlphaNum</span>                  <span class="c">! get input index to unitary system control type</span>
<a name="ln-4381"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iControlZoneAlphaNum</span>                  <span class="c">! get input index to unitary system control zone</span>
<a name="ln-4382"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iDehumidControlAlphaNum</span>               <span class="c">! get input index to unitary system dehumidification control</span>
<a name="ln-4383"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iSysAvailSchedAlphaNum</span>                <span class="c">! get input index to unitary system avail schedule</span>
<a name="ln-4384"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iFanTypeAlphaNum</span>                      <span class="c">! get input index to unitary system fan type</span>
<a name="ln-4385"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iFanNameAlphaNum</span>                      <span class="c">! get input index to unitary system fan name</span>
<a name="ln-4386"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iFanPlaceAlphaNum</span>                     <span class="c">! get input index to unitary system fan placement</span>
<a name="ln-4387"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iFanSchedAlphaNum</span>                     <span class="c">! get input index to unitary system fan mode op schedule</span>
<a name="ln-4388"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iHeatingCoilTypeAlphaNum</span>              <span class="c">! get input index to unitary system heating coil type</span>
<a name="ln-4389"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iHeatingCoilNameAlphaNum</span>              <span class="c">! get input index to unitary system heating coil name</span>
<a name="ln-4390"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iHeatingCoilSizeRatioNumericNum</span>       <span class="c">! get input index to unitary system heating coil sizing ratio</span>
<a name="ln-4391"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iCoolingCoilTypeAlphaNum</span>              <span class="c">! get input index to unitary system cooling coil type</span>
<a name="ln-4392"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iCoolingCoilNameAlphaNum</span>              <span class="c">! get input index to unitary system cooling coil name</span>
<a name="ln-4393"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iDOASDXCoilAlphaNum</span>                   <span class="c">! get input index to unitary system DX coil DOAS specified</span>
<a name="ln-4394"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iRunOnLatentLoadAlphaNum</span>              <span class="c">! get input index to unitary system run on latent load</span>
<a name="ln-4395"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iSuppHeatCoilTypeAlphaNum</span>             <span class="c">! get input index to unitary system supp heat coil type</span>
<a name="ln-4396"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iSuppHeatCoilNameAlphaNum</span>             <span class="c">! get input index to unitary system supp heat coil name</span>
<a name="ln-4397"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iHeatSAFMAlphaNum</span>                     <span class="c">! get input index to unitary system heat supp air flow method</span>
<a name="ln-4398"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iCoolSAFMAlphaNum</span>                     <span class="c">! get input index to unitary system cool supp air flow method</span>
<a name="ln-4399"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iMaxCoolAirVolFlowNumericNum</span>          <span class="c">! get input index to unitary system cool supply air flow</span>
<a name="ln-4400"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iMaxHeatAirVolFlowNumericNum</span>          <span class="c">! get input index to unitary system heat supply air flow</span>
<a name="ln-4401"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iNoCoolHeatSAFMAlphaNum</span>               <span class="c">! get input index to unitary system no cool/heat supply air flow</span>
<a name="ln-4402"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iMaxNoCoolHeatAirVolFlowNumericNum</span>    <span class="c">! get input index to unitary system no cool/heat supply air flow</span>
<a name="ln-4403"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iDesignSpecMSHPTypeAlphaNum</span>           <span class="c">! get input index to unitary system MSHP coil type</span>
<a name="ln-4404"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iDesignSpecMSHPNameAlphaNum</span>           <span class="c">! get input index to unitary system MSHP coil name</span>
<a name="ln-4405"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iAirInletNodeNameAlphaNum</span>             <span class="c">! get input index to unitary system air inlet node</span>
<a name="ln-4406"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iAirOutletNodeNameAlphaNum</span>            <span class="c">! get input index to unitary system air outlet node</span>
<a name="ln-4407"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iDOASDXMinTempNumericNum</span>              <span class="c">! get input index to unitary system DOAS DX coil min outlet temp</span>
<a name="ln-4408"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iCoolFlowPerFloorAreaNumericNum</span>       <span class="c">! get input index to unitary system cool flow per floor area</span>
<a name="ln-4409"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iCoolFlowPerFracCoolNumericNum</span>        <span class="c">! get input index to unitary system cool flow per fraction cool</span>
<a name="ln-4410"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iCoolFlowPerCoolCapNumericNum</span>         <span class="c">! get input index to unitary system cool flow per cooling cap</span>
<a name="ln-4411"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iHeatFlowPerFloorAreaNumericNum</span>       <span class="c">! get input index to unitary system heat flow per floor area</span>
<a name="ln-4412"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iHeatFlowPerFracCoolNumericNum</span>        <span class="c">! get input index to unitary system heat flow per fraction heat</span>
<a name="ln-4413"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iHeatFlowPerHeatCapNumericNum</span>         <span class="c">! get input index to unitary system heat flow per heating cap</span>
<a name="ln-4414"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iNoCoolHeatFlowPerFloorAreaNumericNum</span> <span class="c">! get input index to unitary system no cool/heat FPA</span>
<a name="ln-4415"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iNoCoolHeatFlowPerFracCoolNumericNum</span>  <span class="c">! get input index to unitary system no cool/heat FPFC</span>
<a name="ln-4416"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iNoCoolHeatFlowPerFracHeatNumericNum</span>  <span class="c">! get input index to unitary system no cool/heat FPFH</span>
<a name="ln-4417"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iNoCoolHeatFlowPerCoolCapNumericNum</span>   <span class="c">! get input index to unitary system no cool/heat FPCC</span>
<a name="ln-4418"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iNoCoolHeatFlowPerHeatCapNumericNum</span>   <span class="c">! get input index to unitary system no cool/heat FPHC</span>
<a name="ln-4419"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iDesignMaxOutletTempNumericNum</span>        <span class="c">! get input index to unitary system design max outlet temp</span>
<a name="ln-4420"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iMaxOATSuppHeatNumericNum</span>             <span class="c">! get input index to unitary system maximum OAT for supp operation</span>
<a name="ln-4421"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iCondenserNodeAlphaNum</span>                <span class="c">! get input index to unitary system condenser node</span>
<a name="ln-4422"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iMaxONOFFCycPerHourNumericNum</span>         <span class="c">! get input index to unitary system WSHP max cycle per hour</span>
<a name="ln-4423"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iHPTimeConstantNumericNum</span>             <span class="c">! get input index to unitary system WSHP time constant</span>
<a name="ln-4424"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iOnCyclePowerFracNumericNum</span>           <span class="c">! get input index to unitary system WSHP on cycle power</span>
<a name="ln-4425"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iFanDelayTimeNumericNum</span>               <span class="c">! get input index to unitary system WSHP off cycle power</span>
<a name="ln-4426"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iAncillaryOnPowerNumericNum</span>           <span class="c">! get input index to unitary system ancillary on power</span>
<a name="ln-4427"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iAncillaryOffPowerNumericNum</span>          <span class="c">! get input index to unitary system ancillary off power</span>
<a name="ln-4428"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iDesignHRWaterVolFlowNumericNum</span>       <span class="c">! get input index to unitary system design HR water flow</span>
<a name="ln-4429"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iMaxHROutletWaterTempNumericNum</span>       <span class="c">! get input index to unitary system max HR outlet temp</span>
<a name="ln-4430"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iHRWaterInletNodeAlphaNum</span>             <span class="c">! get input index to unitary system HR water inlet node</span>
<a name="ln-4431"></a>    <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">iHRWaterOutletNodeAlphaNum</span>            <span class="c">! get input index to unitary system HR water outlet node</span>
<a name="ln-4432"></a>
<a name="ln-4433"></a>    <span class="n">CurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;AirloopHVAC:UnitarySystem&#39;</span>
<a name="ln-4434"></a>    <span class="n">NumUnitarySystem</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-4435"></a>
<a name="ln-4436"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">NumUnitarySystem</span><span class="p">))</span>
<a name="ln-4437"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">CheckEquipName</span><span class="p">(</span><span class="n">NumUnitarySystem</span><span class="p">))</span>
<a name="ln-4438"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MultiOrVarSpeedHeatCoil</span><span class="p">(</span><span class="n">NumUnitarySystem</span><span class="p">))</span>
<a name="ln-4439"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MultiOrVarSpeedCoolCoil</span><span class="p">(</span><span class="n">NumUnitarySystem</span><span class="p">))</span>
<a name="ln-4440"></a>    <span class="n">CheckEquipName</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4441"></a>    <span class="n">MultiOrVarSpeedHeatCoil</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4442"></a>    <span class="n">MultiOrVarSpeedCoolCoil</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4443"></a>
<a name="ln-4444"></a>
<a name="ln-4445"></a>    <span class="k">CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">TotalArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">)</span>
<a name="ln-4446"></a>    <span class="n">TempAlphas</span> <span class="o">=</span> <span class="n">NumAlphas</span>
<a name="ln-4447"></a>    <span class="n">TempNumbers</span> <span class="o">=</span> <span class="n">NumNumbers</span>
<a name="ln-4448"></a>
<a name="ln-4449"></a>    <span class="n">CurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;UnitarySystemPerformance:HeatPump:Multispeed&#39;</span>
<a name="ln-4450"></a>    <span class="n">NumDesignSpecMultiSpeedHP</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-4451"></a>    <span class="k">CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">TotalArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">)</span>
<a name="ln-4452"></a>
<a name="ln-4453"></a>    <span class="n">NumAlphas</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">TempAlphas</span><span class="p">,</span> <span class="n">NumAlphas</span><span class="p">)</span>
<a name="ln-4454"></a>    <span class="n">NumNumbers</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">TempNumbers</span><span class="p">,</span> <span class="n">NumNumbers</span><span class="p">)</span>
<a name="ln-4455"></a>
<a name="ln-4456"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">NumAlphas</span><span class="p">))</span>
<a name="ln-4457"></a>    <span class="n">Alphas</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-4458"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">NumAlphas</span><span class="p">))</span>
<a name="ln-4459"></a>    <span class="n">cAlphaFields</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-4460"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">NumNumbers</span><span class="p">))</span>
<a name="ln-4461"></a>    <span class="n">cNumericFields</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-4462"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="n">NumNumbers</span><span class="p">))</span>
<a name="ln-4463"></a>    <span class="n">Numbers</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4464"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">NumAlphas</span><span class="p">))</span>
<a name="ln-4465"></a>    <span class="n">lAlphaBlanks</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4466"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">lNumericBlanks</span><span class="p">(</span><span class="n">NumNumbers</span><span class="p">))</span>
<a name="ln-4467"></a>    <span class="n">lNumericBlanks</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4468"></a>
<a name="ln-4469"></a>      <span class="c">! Get the data for the DesignSpecification object</span>
<a name="ln-4470"></a>      <span class="n">CurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;UnitarySystemPerformance:HeatPump:Multispeed&#39;</span>
<a name="ln-4471"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DesignSpecMSHP</span><span class="p">(</span><span class="n">NumDesignSpecMultiSpeedHP</span><span class="p">))</span>
<a name="ln-4472"></a>
<a name="ln-4473"></a>      <span class="k">DO </span><span class="n">DesignSpecNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumDesignSpecMultiSpeedHP</span>
<a name="ln-4474"></a>
<a name="ln-4475"></a>        <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">DesignSpecNum</span><span class="p">,</span><span class="n">Alphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">Numbers</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">IOStatus</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4476"></a>                           <span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericBlanks</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4477"></a>                           <span class="n">AlphaFieldNames</span><span class="o">=</span><span class="n">cAlphaFields</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFields</span><span class="p">)</span>
<a name="ln-4478"></a>
<a name="ln-4479"></a>        <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4480"></a>        <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4481"></a>        <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">DesignSpecMSHP</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">DesignSpecNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-4482"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4483"></a><span class="k">          </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4484"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-4485"></a>        <span class="k">END IF</span>
<a name="ln-4486"></a>
<a name="ln-4487"></a><span class="k">        </span><span class="n">DesignSpecMSHP</span><span class="p">(</span><span class="n">DesignSpecNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4488"></a>
<a name="ln-4489"></a>        <span class="n">DesignSpecMSHP</span><span class="p">(</span><span class="n">DesignSpecNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4490"></a>        <span class="n">NumOfSpeedHeating</span> <span class="o">=</span> <span class="n">DesignSpecMSHP</span><span class="p">(</span><span class="n">DesignSpecNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span>
<a name="ln-4491"></a>
<a name="ln-4492"></a>        <span class="n">DesignSpecMSHP</span><span class="p">(</span><span class="n">DesignSpecNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4493"></a>        <span class="n">NumOfSpeedCooling</span> <span class="o">=</span> <span class="n">DesignSpecMSHP</span><span class="p">(</span><span class="n">DesignSpecNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span>
<a name="ln-4494"></a>
<a name="ln-4495"></a>        <span class="c">! initialize number of speeds (MIN = 4 or greater of cooling and heating speeds x 2)</span>
<a name="ln-4496"></a>        <span class="n">MaxSpeedNum</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! set to 0 so we know if the inputs are valid</span>
<a name="ln-4497"></a>
<a name="ln-4498"></a>        <span class="k">IF</span><span class="p">(</span><span class="nb">MOD</span><span class="p">(</span><span class="kt">REAL</span><span class="p">(</span><span class="n">NumNumbers</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">r64</span><span class="p">),</span><span class="mf">2.0d0</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4499"></a>          <span class="c">! check that the number of numeric speed input fields match the number of speeds</span>
<a name="ln-4500"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DesignSpecMSHP</span><span class="p">(</span><span class="n">DesignSpecNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4501"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal number of entries in Supply Air Flow Rate fields.&#39;</span><span class="p">)</span>
<a name="ln-4502"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..number of required Supply Air Flow Rate fields = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4503"></a>               <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="nb">MAX</span><span class="p">(</span><span class="n">NumOfSpeedCooling</span><span class="p">,</span><span class="n">NumOfSpeedHeating</span><span class="p">)),</span><span class="mi">0</span><span class="p">)))</span>
<a name="ln-4504"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..number of actual Supply Air Flow Rate fields   = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">((</span><span class="n">NumNumbers</span><span class="o">-</span><span class="mi">2</span><span class="p">),</span><span class="mi">0</span><span class="p">)))</span>
<a name="ln-4505"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4506"></a>        <span class="k">ELSE</span>
<a name="ln-4507"></a><span class="k">          </span><span class="n">MaxSpeedNum</span> <span class="o">=</span> <span class="p">(</span><span class="n">NumNumbers</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="c">! Extensible fields included (&gt;4) for cooling and heating</span>
<a name="ln-4508"></a>        <span class="k">END IF</span>
<a name="ln-4509"></a>
<a name="ln-4510"></a><span class="k">        IF</span><span class="p">(</span><span class="n">MaxSpeedNum</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">NumOfSpeedHeating</span><span class="p">,</span><span class="n">NumOfSpeedCooling</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-4511"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DesignSpecMSHP</span><span class="p">(</span><span class="n">DesignSpecNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4512"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal number of entries in Supply Air Flow Rate fields.&#39;</span><span class="p">)</span>
<a name="ln-4513"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..number of required Supply Air Flow Rate fields = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4514"></a>               <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="nb">MAX</span><span class="p">(</span><span class="n">NumOfSpeedCooling</span><span class="p">,</span><span class="n">NumOfSpeedHeating</span><span class="p">)),</span><span class="mi">0</span><span class="p">)))</span>
<a name="ln-4515"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..number of actual Supply Air Flow Rate fields   = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">((</span><span class="n">NumNumbers</span><span class="o">-</span><span class="mi">2</span><span class="p">),</span><span class="mi">0</span><span class="p">)))</span>
<a name="ln-4516"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4517"></a>        <span class="k">END IF</span>
<a name="ln-4518"></a>
<a name="ln-4519"></a><span class="k">        </span><span class="n">StartingSpeedRatioInput</span> <span class="o">=</span> <span class="mi">3</span> <span class="c">! start the index counter at the first input for heating (e.g. 3+0*2)</span>
<a name="ln-4520"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">NumOfSpeedHeating</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MaxSpeedNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4521"></a><span class="k">          ALLOCATE</span><span class="p">(</span><span class="n">DesignSpecMSHP</span><span class="p">(</span><span class="n">DesignSpecNum</span><span class="p">)%</span><span class="n">HeatingVolFlowRatio</span><span class="p">(</span><span class="n">MaxSpeedNum</span><span class="p">))</span>
<a name="ln-4522"></a>          <span class="k">DO </span><span class="n">SpeedNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumOfSpeedHeating</span>
<a name="ln-4523"></a>            <span class="n">DesignSpecMSHP</span><span class="p">(</span><span class="n">DesignSpecNum</span><span class="p">)%</span><span class="n">HeatingVolFlowRatio</span><span class="p">(</span><span class="n">SpeedNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="n">StartingSpeedRatioInput</span><span class="o">+</span><span class="p">((</span><span class="n">SpeedNum</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-4524"></a>          <span class="k">END DO</span>
<a name="ln-4525"></a><span class="k">        END IF</span>
<a name="ln-4526"></a>
<a name="ln-4527"></a><span class="k">        </span><span class="n">StartingSpeedRatioInput</span> <span class="o">=</span> <span class="mi">4</span> <span class="c">! start the index counter at the first input for heating (e.g. 4+0*2)</span>
<a name="ln-4528"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">NumOfSpeedCooling</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MaxSpeedNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4529"></a><span class="k">          ALLOCATE</span><span class="p">(</span><span class="n">DesignSpecMSHP</span><span class="p">(</span><span class="n">DesignSpecNum</span><span class="p">)%</span><span class="n">CoolingVolFlowRatio</span><span class="p">(</span><span class="n">MaxSpeedNum</span><span class="p">))</span>
<a name="ln-4530"></a>          <span class="k">DO </span><span class="n">SpeedNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumOfSpeedCooling</span>
<a name="ln-4531"></a>            <span class="n">DesignSpecMSHP</span><span class="p">(</span><span class="n">DesignSpecNum</span><span class="p">)%</span><span class="n">CoolingVolFlowRatio</span><span class="p">(</span><span class="n">SpeedNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="n">StartingSpeedRatioInput</span><span class="o">+</span><span class="p">((</span><span class="n">SpeedNum</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-4532"></a>          <span class="k">END DO</span>
<a name="ln-4533"></a><span class="k">        END IF</span>
<a name="ln-4534"></a>
<a name="ln-4535"></a><span class="k">      END DO</span>
<a name="ln-4536"></a>
<a name="ln-4537"></a>      <span class="c">! AirLoopHVAC:UnitarySystem,</span>
<a name="ln-4538"></a>      <span class="n">iNameAlphaNum</span>                   <span class="o">=</span> <span class="mi">1</span>  <span class="c">! A1,  \field Name - \required-field</span>
<a name="ln-4539"></a>      <span class="n">iControlTypeAlphaNum</span>            <span class="o">=</span> <span class="mi">2</span>  <span class="c">! A2,  \field Control Type</span>
<a name="ln-4540"></a>      <span class="n">iControlZoneAlphaNum</span>            <span class="o">=</span> <span class="mi">3</span>  <span class="c">! A3,  \field Controlling Zone or Thermostat Location</span>
<a name="ln-4541"></a>      <span class="n">iDehumidControlAlphaNum</span>         <span class="o">=</span> <span class="mi">4</span>  <span class="c">! A4,  \field dehumidification Control Type</span>
<a name="ln-4542"></a>      <span class="n">iSysAvailSchedAlphaNum</span>          <span class="o">=</span> <span class="mi">5</span>  <span class="c">! A5,  \field Availability Schedule Name</span>
<a name="ln-4543"></a>      <span class="n">iAirInletNodeNameAlphaNum</span>       <span class="o">=</span> <span class="mi">6</span>  <span class="c">! A6,  \field Air Inlet Node Name - \required-field</span>
<a name="ln-4544"></a>      <span class="n">iAirOutletNodeNameAlphaNum</span>      <span class="o">=</span> <span class="mi">7</span>  <span class="c">! A7,  \field Air Outlet Node Name - \required-field</span>
<a name="ln-4545"></a>      <span class="n">iFanTypeAlphaNum</span>                <span class="o">=</span> <span class="mi">8</span>  <span class="c">! A8,  \field Supply Fan Object Type</span>
<a name="ln-4546"></a>      <span class="n">iFanNameAlphaNum</span>                <span class="o">=</span> <span class="mi">9</span>  <span class="c">! A9,  \field Supply Fan Name</span>
<a name="ln-4547"></a>      <span class="n">iFanPlaceAlphaNum</span>               <span class="o">=</span> <span class="mi">10</span> <span class="c">! A10, \field Fan Placement</span>
<a name="ln-4548"></a>      <span class="n">iFanSchedAlphaNum</span>               <span class="o">=</span> <span class="mi">11</span> <span class="c">! A11, \field Supply Air Fan Operating Mode Schedule Name</span>
<a name="ln-4549"></a>      <span class="n">iHeatingCoilTypeAlphaNum</span>        <span class="o">=</span> <span class="mi">12</span> <span class="c">! A12, \field Heating Coil Object Type</span>
<a name="ln-4550"></a>      <span class="n">iHeatingCoilNameAlphaNum</span>        <span class="o">=</span> <span class="mi">13</span> <span class="c">! A13, \field Heating Coil Name</span>
<a name="ln-4551"></a>      <span class="n">iHeatingCoilSizeRatioNumericNum</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c">! N1,  \field DX Heating Coil Sizing Ratio</span>
<a name="ln-4552"></a>      <span class="n">iCoolingCoilTypeAlphaNum</span>        <span class="o">=</span> <span class="mi">14</span> <span class="c">! A14, \field Cooling Coil Object Type</span>
<a name="ln-4553"></a>      <span class="n">iCoolingCoilNameAlphaNum</span>        <span class="o">=</span> <span class="mi">15</span> <span class="c">! A15, \field Cooling Coil Name</span>
<a name="ln-4554"></a>      <span class="n">iDOASDXCoilAlphaNum</span>             <span class="o">=</span> <span class="mi">16</span> <span class="c">! A16, \field Use DOAS DX Cooling Coil</span>
<a name="ln-4555"></a>      <span class="n">iDOASDXMinTempNumericNum</span>        <span class="o">=</span> <span class="mi">2</span>  <span class="c">! N2 , \field DOAS DX Cooling Coil Leaving Minimum Air Temperature</span>
<a name="ln-4556"></a>      <span class="n">iRunOnLatentLoadAlphaNum</span>        <span class="o">=</span> <span class="mi">17</span> <span class="c">! A17, \field Run on Latent Load</span>
<a name="ln-4557"></a>      <span class="n">iSuppHeatCoilTypeAlphaNum</span>       <span class="o">=</span> <span class="mi">18</span> <span class="c">! A18, \field Supplemental Heating Coil Object Type</span>
<a name="ln-4558"></a>      <span class="n">iSuppHeatCoilNameAlphaNum</span>       <span class="o">=</span> <span class="mi">19</span> <span class="c">! A19, \field Supplemental Heating Coil Name</span>
<a name="ln-4559"></a>      <span class="n">iCoolSAFMAlphaNum</span>               <span class="o">=</span> <span class="mi">20</span> <span class="c">! A20, \field Supply air Flow Rate Method During Cooling Operation</span>
<a name="ln-4560"></a>      <span class="n">iMaxCoolAirVolFlowNumericNum</span>    <span class="o">=</span> <span class="mi">3</span>  <span class="c">! N3,  \field Supply Air Flow Rate During Cooling Operation</span>
<a name="ln-4561"></a>      <span class="n">iCoolFlowPerFloorAreaNumericNum</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c">! N4,  \field Supply Air Flow Rate Per Floor Area During Cooling Operation</span>
<a name="ln-4562"></a>      <span class="n">iCoolFlowPerFracCoolNumericNum</span>  <span class="o">=</span> <span class="mi">5</span>  <span class="c">! N5,  \field Fraction of Autosized Design Cooling Supply Air Flow Rate</span>
<a name="ln-4563"></a>      <span class="n">iCoolFlowPerCoolCapNumericNum</span>   <span class="o">=</span> <span class="mi">6</span>  <span class="c">! N6,  \field Design Supply Air Flow Rate Per Unit of Capacity During Cooling Operation</span>
<a name="ln-4564"></a>      <span class="n">iHeatSAFMAlphaNum</span>               <span class="o">=</span> <span class="mi">21</span> <span class="c">! A21, \field Supply air Flow Rate Method During Heating Operation</span>
<a name="ln-4565"></a>      <span class="n">iMaxHeatAirVolFlowNumericNum</span>    <span class="o">=</span> <span class="mi">7</span>  <span class="c">! N7,  \field Supply Air Flow Rate During Heating Operation</span>
<a name="ln-4566"></a>      <span class="n">iHeatFlowPerFloorAreaNumericNum</span> <span class="o">=</span> <span class="mi">8</span>  <span class="c">! N8,  \field Supply Air Flow Rate Per Floor Area during Heating Operation</span>
<a name="ln-4567"></a>      <span class="n">iHeatFlowPerFracCoolNumericNum</span>  <span class="o">=</span> <span class="mi">9</span>  <span class="c">! N9,  \field Fraction of Autosized Design Heating Supply Air Flow Rate</span>
<a name="ln-4568"></a>      <span class="n">iHeatFlowPerHeatCapNumericNum</span>   <span class="o">=</span> <span class="mi">10</span> <span class="c">! N10, \field Design Supply Air Flow Rate Per Unit of Capacity During Heating Operation</span>
<a name="ln-4569"></a>      <span class="n">iNoCoolHeatSAFMAlphaNum</span>         <span class="o">=</span> <span class="mi">22</span> <span class="c">! A22, \field Supply air Flow Rate Method When No Cooling or Heating is Required</span>
<a name="ln-4570"></a>      <span class="n">iMaxNoCoolHeatAirVolFlowNumericNum</span> <span class="o">=</span> <span class="mi">11</span> <span class="c">! N11, \field Supply Air Flow Rate When No Cooling or Heating is Required</span>
<a name="ln-4571"></a>      <span class="n">iNoCoolHeatFlowPerFloorAreaNumericNum</span> <span class="o">=</span> <span class="mi">12</span> <span class="c">! N12, \field Supply Air Flow Rate Per Floor Area When No Cooling/Heating is Req</span>
<a name="ln-4572"></a>      <span class="n">iNoCoolHeatFlowPerFracCoolNumericNum</span> <span class="o">=</span> <span class="mi">13</span> <span class="c">! N13, \field Fraction of Autosized Design Cooling Supply Air Flow Rate</span>
<a name="ln-4573"></a>      <span class="n">iNoCoolHeatFlowPerFracHeatNumericNum</span> <span class="o">=</span> <span class="mi">14</span> <span class="c">! N14, \field Fraction of Autosized Design Heating Supply Air Flow Rate</span>
<a name="ln-4574"></a>      <span class="n">iNoCoolHeatFlowPerCoolCapNumericNum</span> <span class="o">=</span> <span class="mi">15</span> <span class="c">! N15, \field Design Supply Air Flow Rate Per Unit of Capacity During Cooling Op</span>
<a name="ln-4575"></a>      <span class="n">iNoCoolHeatFlowPerHeatCapNumericNum</span> <span class="o">=</span> <span class="mi">16</span> <span class="c">! N16, \field Design Supply Air Flow Rate Per Unit of Capacity During Heating Op</span>
<a name="ln-4576"></a>      <span class="n">iDesignMaxOutletTempNumericNum</span>  <span class="o">=</span> <span class="mi">17</span> <span class="c">! N17, \field Maximum Supply Air Temperature</span>
<a name="ln-4577"></a>      <span class="n">iMaxOATSuppHeatNumericNum</span>       <span class="o">=</span> <span class="mi">18</span> <span class="c">! N18, \field Maximum Outdoor Dry-Bulb Temperature for Supplemental Heater Op</span>
<a name="ln-4578"></a>      <span class="n">iCondenserNodeAlphaNum</span>          <span class="o">=</span> <span class="mi">23</span> <span class="c">! A23, \field Outdoor Dry-Bulb Temperature Sensor Node Name</span>
<a name="ln-4579"></a>      <span class="n">iMaxONOFFCycPerHourNumericNum</span>   <span class="o">=</span> <span class="mi">19</span> <span class="c">! N19, \field Maximum Cycling Rate</span>
<a name="ln-4580"></a>      <span class="n">iHPTimeConstantNumericNum</span>       <span class="o">=</span> <span class="mi">20</span> <span class="c">! N20, \field Heat Pump Time Constant</span>
<a name="ln-4581"></a>      <span class="n">iOnCyclePowerFracNumericNum</span>     <span class="o">=</span> <span class="mi">21</span> <span class="c">! N21, \field Fraction of On-Cycle Power Use</span>
<a name="ln-4582"></a>      <span class="n">iFanDelayTimeNumericNum</span>         <span class="o">=</span> <span class="mi">22</span> <span class="c">! N22, \field Heat Pump Fan Delay Time</span>
<a name="ln-4583"></a>      <span class="n">iAncillaryOnPowerNumericNum</span>     <span class="o">=</span> <span class="mi">23</span> <span class="c">! N23, \field Ancilliary On-Cycle Electric Power</span>
<a name="ln-4584"></a>      <span class="n">iAncillaryOffPowerNumericNum</span>    <span class="o">=</span> <span class="mi">24</span> <span class="c">! N24, \field Ancilliary Off-Cycle Electric Power</span>
<a name="ln-4585"></a>      <span class="n">iDesignHRWaterVolFlowNumericNum</span> <span class="o">=</span> <span class="mi">25</span> <span class="c">! N25, \field Design Heat Recovery Water Flow Rate</span>
<a name="ln-4586"></a>      <span class="n">iMaxHROutletWaterTempNumericNum</span> <span class="o">=</span> <span class="mi">26</span> <span class="c">! N26, \field Maximum Temperature for Heat Recovery</span>
<a name="ln-4587"></a>      <span class="n">iHRWaterInletNodeAlphaNum</span>       <span class="o">=</span> <span class="mi">24</span> <span class="c">! A24, \field Heat Recovery Water Inlet Node Name</span>
<a name="ln-4588"></a>      <span class="n">iHRWaterOutletNodeAlphaNum</span>      <span class="o">=</span> <span class="mi">25</span> <span class="c">! A25, \field Heat Recovery Water Outlet Node Name</span>
<a name="ln-4589"></a>
<a name="ln-4590"></a>      <span class="n">iDesignSpecMSHPTypeAlphaNum</span>     <span class="o">=</span> <span class="mi">26</span> <span class="c">! A26, \field design Specification Multispeed Heat Pump Object Type</span>
<a name="ln-4591"></a>      <span class="n">iDesignSpecMSHPNameAlphaNum</span>     <span class="o">=</span> <span class="mi">27</span> <span class="c">! A27; \field design Specification Multispeed Heat Pump Object Name</span>
<a name="ln-4592"></a>
<a name="ln-4593"></a>
<a name="ln-4594"></a>      <span class="c">! Get the data for the Unitary System</span>
<a name="ln-4595"></a>      <span class="n">CurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;AirloopHVAC:UnitarySystem&#39;</span>
<a name="ln-4596"></a>      <span class="k">DO </span><span class="n">UnitarySysNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>  <span class="n">NumUnitarySystem</span>
<a name="ln-4597"></a>
<a name="ln-4598"></a>        <span class="n">FanInletNode</span>          <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4599"></a>        <span class="n">FanOutletNode</span>         <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4600"></a>        <span class="n">FanVolFlowRate</span>        <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4601"></a>        <span class="n">CoolingCoilInletNode</span>  <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4602"></a>        <span class="n">CoolingCoilOutletNode</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4603"></a>        <span class="n">HeatingCoilInletNode</span>  <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4604"></a>        <span class="n">HeatingCoilOutletNode</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4605"></a>        <span class="n">SupHeatCoilInletNode</span>  <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4606"></a>        <span class="n">SupHeatCoilOutletNode</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4607"></a>
<a name="ln-4608"></a>        <span class="n">CurrentModuleObject</span>  <span class="o">=</span> <span class="s1">&#39;AirLoopHVAC:UnitarySystem&#39;</span>
<a name="ln-4609"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span> <span class="o">=</span> <span class="n">CurrentModuleObject</span>
<a name="ln-4610"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType_Num</span> <span class="o">=</span> <span class="n">UnitarySystem_AnyCoilType</span>
<a name="ln-4611"></a>
<a name="ln-4612"></a>        <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">Alphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">Numbers</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">IOStatus</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4613"></a>                           <span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericBlanks</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4614"></a>                           <span class="n">AlphaFieldNames</span><span class="o">=</span><span class="n">cAlphaFields</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFields</span><span class="p">)</span>
<a name="ln-4615"></a>
<a name="ln-4616"></a>        <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4617"></a>        <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4618"></a>        <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iNameAlphaNum</span><span class="p">),</span><span class="n">UnitarySystem</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">UnitarySysNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4619"></a>                        <span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-4620"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4621"></a><span class="k">          </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4622"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">Alphas</span><span class="p">(</span><span class="n">iNameAlphaNum</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-4623"></a>        <span class="k">END IF</span>
<a name="ln-4624"></a>
<a name="ln-4625"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span>            <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="n">iNameAlphaNum</span><span class="p">)</span>
<a name="ln-4626"></a>
<a name="ln-4627"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iControlTypeAlphaNum</span><span class="p">),</span><span class="s1">&#39;Load&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-4628"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlType</span> <span class="o">=</span> <span class="n">LoadBased</span>
<a name="ln-4629"></a>        <span class="n">ELSEIF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iControlTypeAlphaNum</span><span class="p">),</span><span class="s1">&#39;SetPoint&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-4630"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlType</span> <span class="o">=</span> <span class="n">SetPointBased</span>
<a name="ln-4631"></a>        <span class="k">ELSE</span>
<a name="ln-4632"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4633"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iControlTypeAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iControlTypeAlphaNum</span><span class="p">)))</span>
<a name="ln-4634"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4635"></a>        <span class="k">END IF</span>
<a name="ln-4636"></a>
<a name="ln-4637"></a>         <span class="c">!Get the Controlling Zone or Location of the Thermostat</span>
<a name="ln-4638"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iControlZoneAlphaNum</span><span class="p">),</span><span class="n">Zone</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumOfZones</span><span class="p">)</span>
<a name="ln-4639"></a>
<a name="ln-4640"></a>        <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">iDehumidControlAlphaNum</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-4641"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iDehumidControlAlphaNum</span><span class="p">),</span><span class="s1">&#39;None&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4642"></a>              <span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iDehumidControlAlphaNum</span><span class="p">),</span><span class="s1">&#39;Multimode&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4643"></a>              <span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iDehumidControlAlphaNum</span><span class="p">),</span><span class="s1">&#39;CoolReheat&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-4644"></a><span class="k">            </span><span class="n">AirNodeFound</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4645"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iDehumidControlAlphaNum</span><span class="p">),</span><span class="s1">&#39;Multimode&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-4646"></a><span class="k">              </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">=</span> <span class="n">DehumidControl_Multimode</span>
<a name="ln-4647"></a>              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Humidistat</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4648"></a>            <span class="k">END IF</span>
<a name="ln-4649"></a><span class="k">            IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iDehumidControlAlphaNum</span><span class="p">),</span><span class="s1">&#39;CoolReheat&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-4650"></a><span class="k">              </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">=</span> <span class="n">DehumidControl_CoolReheat</span>
<a name="ln-4651"></a>              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Humidistat</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4652"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">iSuppHeatCoilNameAlphaNum</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-4653"></a><span class="k">              END IF</span>
<a name="ln-4654"></a><span class="k">            END IF</span>
<a name="ln-4655"></a><span class="k">            IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iDehumidControlAlphaNum</span><span class="p">),</span><span class="s1">&#39;None&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-4656"></a><span class="k">              </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">=</span> <span class="n">DehumidControl_None</span>
<a name="ln-4657"></a>              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Humidistat</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4658"></a>            <span class="k">END IF</span>
<a name="ln-4659"></a><span class="k">            IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Humidistat</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4660"></a>               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlType</span> <span class="o">==</span> <span class="n">LoadBased</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4661"></a><span class="k">              DO </span><span class="n">HstatZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumHumidityControlZones</span>
<a name="ln-4662"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">HumidityControlZone</span><span class="p">(</span><span class="n">HstatZoneNum</span><span class="p">)%</span><span class="n">ActualZoneNum</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)</span><span class="k">CYCLE</span>
<a name="ln-4663"></a><span class="k">                </span><span class="n">AirNodeFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4664"></a>              <span class="k">END DO</span>
<a name="ln-4665"></a><span class="k">              IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">AirNodeFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4666"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4667"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Did not find Air Node (Zone with Humidistat).&#39;</span><span class="p">)</span>
<a name="ln-4668"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;specified &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iControlZoneAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4669"></a>                                       <span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iControlZoneAlphaNum</span><span class="p">)))</span>
<a name="ln-4670"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4671"></a>             <span class="k">END IF</span>
<a name="ln-4672"></a><span class="k">            END IF</span>
<a name="ln-4673"></a><span class="k">          ELSE</span> <span class="c">! invalid input</span>
<a name="ln-4674"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4675"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iDehumidControlAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4676"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iDehumidControlAlphaNum</span><span class="p">)))</span>
<a name="ln-4677"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Humidistat</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4678"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4679"></a>          <span class="k">END IF</span>
<a name="ln-4680"></a><span class="k">        END IF</span>
<a name="ln-4681"></a>
<a name="ln-4682"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">iSysAvailSchedAlphaNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4683"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SysAvailSchedPtr</span>        <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-4684"></a>        <span class="k">ELSE</span>
<a name="ln-4685"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SysAvailSchedPtr</span>        <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iSysAvailSchedAlphaNum</span><span class="p">))</span>
<a name="ln-4686"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SysAvailSchedPtr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4687"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4688"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iSysAvailSchedAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4689"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iSysAvailSchedAlphaNum</span><span class="p">)))</span>
<a name="ln-4690"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4691"></a>          <span class="k">END IF</span>
<a name="ln-4692"></a><span class="k">        END IF</span>
<a name="ln-4693"></a>
<a name="ln-4694"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemInletNodeNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4695"></a>            <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iAirInletNodeNameAlphaNum</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iNameAlphaNum</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4696"></a>                     <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsParent</span><span class="p">)</span>
<a name="ln-4697"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemOutletNodeNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4698"></a>            <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iAirOutletNodeNameAlphaNum</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iNameAlphaNum</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4699"></a>                     <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsParent</span><span class="p">)</span>
<a name="ln-4700"></a>
<a name="ln-4701"></a>         <span class="c">!Get fan data</span>
<a name="ln-4702"></a>        <span class="n">FanType</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="n">iFanTypeAlphaNum</span><span class="p">)</span>
<a name="ln-4703"></a>        <span class="n">FanName</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="n">iFanNameAlphaNum</span><span class="p">)</span>
<a name="ln-4704"></a>
<a name="ln-4705"></a>        <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">iFanTypeAlphaNum</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-4706"></a><span class="k">          </span><span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4707"></a>          <span class="k">CALL </span><span class="n">GetFanType</span><span class="p">(</span><span class="n">FanName</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanType_Num</span><span class="p">,</span> <span class="n">IsNotOK</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-4708"></a>               <span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iNameAlphaNum</span><span class="p">))</span>
<a name="ln-4709"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4710"></a><span class="k">            </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4711"></a>          <span class="k">END IF</span>
<a name="ln-4712"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanExists</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4713"></a>        <span class="k">END IF</span>
<a name="ln-4714"></a>
<a name="ln-4715"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanType_Num</span> <span class="o">==</span> <span class="n">FanType_SimpleOnOff</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4716"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanType_Num</span> <span class="o">==</span> <span class="n">FanType_SimpleConstVolume</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4717"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanType_Num</span> <span class="o">==</span> <span class="n">FanType_SimpleVAV</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4718"></a><span class="k">          </span><span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4719"></a>          <span class="k">CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">FanType</span><span class="p">,</span><span class="n">FanName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-4720"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4721"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4722"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4723"></a>
<a name="ln-4724"></a>          <span class="k">ELSE</span> <span class="c">! mine data from fan object</span>
<a name="ln-4725"></a>
<a name="ln-4726"></a>            <span class="c">! Get the fan index</span>
<a name="ln-4727"></a>            <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4728"></a>            <span class="k">CALL </span><span class="n">GetFanIndex</span><span class="p">(</span><span class="n">FanName</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanIndex</span><span class="p">,</span> <span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4729"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4730"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4731"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4732"></a>            <span class="k">END IF</span>
<a name="ln-4733"></a>
<a name="ln-4734"></a>            <span class="c">! Get the Design Fan Volume Flow Rate</span>
<a name="ln-4735"></a>            <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4736"></a>            <span class="n">FanVolFlowRate</span> <span class="o">=</span> <span class="n">GetFanDesignVolumeFlowRate</span><span class="p">(</span><span class="n">FanType</span><span class="p">,</span><span class="n">FanName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4737"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">FanVolFlowRate</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RequestAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4738"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ActualFanVolFlowRate</span> <span class="o">=</span> <span class="n">FanVolFlowRate</span>
<a name="ln-4739"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="o">=</span> <span class="n">FanVolFlowRate</span>
<a name="ln-4740"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4741"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4742"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4743"></a>            <span class="k">END IF</span>
<a name="ln-4744"></a>
<a name="ln-4745"></a>            <span class="c">! Get the Fan Inlet Node</span>
<a name="ln-4746"></a>            <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4747"></a>            <span class="n">FanInletNode</span> <span class="o">=</span> <span class="n">GetFanInletNode</span><span class="p">(</span><span class="n">FanType</span><span class="p">,</span><span class="n">FanName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4748"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4749"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4750"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4751"></a>            <span class="k">END IF</span>
<a name="ln-4752"></a>
<a name="ln-4753"></a>            <span class="c">! Get the Fan Outlet Node</span>
<a name="ln-4754"></a>            <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4755"></a>            <span class="n">FanOutletNode</span> <span class="o">=</span> <span class="n">GetFanOutletNode</span><span class="p">(</span><span class="n">FanType</span><span class="p">,</span><span class="n">FanName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4756"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4757"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4758"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4759"></a>            <span class="k">END IF</span>
<a name="ln-4760"></a>
<a name="ln-4761"></a>            <span class="c">! Get the fan&#39;s availability schedule</span>
<a name="ln-4762"></a>            <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4763"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanAvailSchedPtr</span> <span class="o">=</span> <span class="n">GetFanAvailSchPtr</span><span class="p">(</span><span class="n">FanType</span><span class="p">,</span><span class="n">FanName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4764"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4765"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4766"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4767"></a>            <span class="k">END IF</span>
<a name="ln-4768"></a>
<a name="ln-4769"></a><span class="k">          END IF</span> <span class="c">! IF (IsNotOK) THEN</span>
<a name="ln-4770"></a>
<a name="ln-4771"></a>        <span class="n">ELSEIF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4772"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4773"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iFanTypeAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iFanTypeAlphaNum</span><span class="p">)))</span>
<a name="ln-4774"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4775"></a>        <span class="k">END IF</span> <span class="c">! IF (UnitarySystem(UnitarySysNum)%FanType_Num...</span>
<a name="ln-4776"></a>
<a name="ln-4777"></a>        <span class="c">! Add fan to component sets array</span>
<a name="ln-4778"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanExists</span><span class="p">)</span><span class="k">CALL </span><span class="n">SetUpCompSets</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span> <span class="n">Alphas</span><span class="p">(</span><span class="n">iNameAlphaNum</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4779"></a>                           <span class="n">Alphas</span><span class="p">(</span><span class="n">iFanTypeAlphaNum</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iFanNameAlphaNum</span><span class="p">),</span><span class="n">NodeID</span><span class="p">(</span><span class="n">FanInletNode</span><span class="p">),</span><span class="n">NodeID</span><span class="p">(</span><span class="n">FanOutletNode</span><span class="p">))</span>
<a name="ln-4780"></a>
<a name="ln-4781"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iFanPlaceAlphaNum</span><span class="p">),</span><span class="s1">&#39;BlowThrough&#39;</span><span class="p">)</span> <span class="p">)</span>      <span class="p">&amp;</span>
<a name="ln-4782"></a>               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="o">=</span> <span class="n">BlowThru</span>
<a name="ln-4783"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iFanPlaceAlphaNum</span><span class="p">),</span><span class="s1">&#39;DrawThrough&#39;</span><span class="p">)</span> <span class="p">)</span>      <span class="p">&amp;</span>
<a name="ln-4784"></a>              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="o">=</span> <span class="n">DrawThru</span>
<a name="ln-4785"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanExists</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4786"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4787"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iFanPlaceAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iFanPlaceAlphaNum</span><span class="p">)))</span>
<a name="ln-4788"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4789"></a>        <span class="k">END IF</span>
<a name="ln-4790"></a>
<a name="ln-4791"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpModeSchedPtr</span>     <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iFanSchedAlphaNum</span><span class="p">))</span>
<a name="ln-4792"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">iFanSchedAlphaNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpModeSchedPtr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4793"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4794"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iFanSchedAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iFanSchedAlphaNum</span><span class="p">)))</span>
<a name="ln-4795"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4796"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">iFanSchedAlphaNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4797"></a><span class="k">          IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlType</span> <span class="o">==</span> <span class="n">SetPointBased</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4798"></a>            <span class="c">! Fan operating mode must be constant fan so that the coil outlet temp is proportional to PLR</span>
<a name="ln-4799"></a>            <span class="c">! Cycling fan always outputs the full load outlet air temp so should not be used with set point based control</span>
<a name="ln-4800"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span> <span class="o">=</span> <span class="n">ContFanCycCoil</span>
<a name="ln-4801"></a>          <span class="k">ELSE</span>
<a name="ln-4802"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span> <span class="o">=</span> <span class="n">CycFanCycCoil</span>
<a name="ln-4803"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanType_Num</span> <span class="o">/=</span> <span class="n">FanType_SimpleOnOff</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4804"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4805"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iFanTypeAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iFanTypeAlphaNum</span><span class="p">)))</span>
<a name="ln-4806"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Fan type must be Fan:OnOff when &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4807"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iFanSchedAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = Blank.&#39;</span><span class="p">)</span>
<a name="ln-4808"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4809"></a>            <span class="k">END IF</span>
<a name="ln-4810"></a><span class="k">          END IF</span>
<a name="ln-4811"></a><span class="k">        ELSE IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">iFanSchedAlphaNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpModeSchedPtr</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4812"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlType</span> <span class="o">==</span> <span class="n">SetPointBased</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4813"></a><span class="k">          IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">CheckScheduleValueMinMax</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpModeSchedPtr</span><span class="p">,</span><span class="s1">&#39;&gt;&#39;</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="s1">&#39;&lt;=&#39;</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4814"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4815"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iFanTypeAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iFanTypeAlphaNum</span><span class="p">)))</span>
<a name="ln-4816"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Fan operating mode must be continuous (fan operating mode schedule values &gt; 0).&#39;</span><span class="p">)</span>
<a name="ln-4817"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Error found in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iFanSchedAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iFanSchedAlphaNum</span><span class="p">)))</span>
<a name="ln-4818"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...schedule values must be (&gt;0., &lt;=1.)&#39;</span><span class="p">)</span>
<a name="ln-4819"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4820"></a>          <span class="k">END IF</span>
<a name="ln-4821"></a><span class="k">        END IF</span>
<a name="ln-4822"></a>
<a name="ln-4823"></a>        <span class="c">! Check fan&#39;s schedule for cycling fan operation IF constant volume fan is used</span>
<a name="ln-4824"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpModeSchedPtr</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4825"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanType_Num</span> <span class="o">==</span> <span class="n">FanType_SimpleConstVolume</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4826"></a><span class="k">          IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">CheckScheduleValueMinMax</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpModeSchedPtr</span><span class="p">,</span><span class="s1">&#39;&gt;&#39;</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="s1">&#39;&lt;=&#39;</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4827"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4828"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iFanTypeAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iFanTypeAlphaNum</span><span class="p">)))</span>
<a name="ln-4829"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Fan operating mode must be continuous (fan operating mode schedule values &gt; 0).&#39;</span><span class="p">)</span>
<a name="ln-4830"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Error found in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iFanSchedAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4831"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iFanSchedAlphaNum</span><span class="p">)))</span>
<a name="ln-4832"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...schedule values must be (&gt;0., &lt;=1.)&#39;</span><span class="p">)</span>
<a name="ln-4833"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4834"></a>          <span class="k">END IF</span>
<a name="ln-4835"></a><span class="k">        END IF</span>
<a name="ln-4836"></a>
<a name="ln-4837"></a>            <span class="c">!Get coil data</span>
<a name="ln-4838"></a>        <span class="n">HeatingCoilType</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="n">iHeatingCoilTypeAlphaNum</span><span class="p">)</span>
<a name="ln-4839"></a>        <span class="n">HeatingCoilName</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="n">iHeatingCoilNameAlphaNum</span><span class="p">)</span>
<a name="ln-4840"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">NumNumbers</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="p">(</span><span class="n">iHeatingCoilSizeRatioNumericNum</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-4841"></a><span class="k">          </span><span class="n">HeatingSizingRatio</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="n">iHeatingCoilSizeRatioNumericNum</span><span class="p">)</span>
<a name="ln-4842"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSizingRatio</span> <span class="o">=</span> <span class="n">HeatingSizingRatio</span>
<a name="ln-4843"></a>        <span class="k">ELSE</span>
<a name="ln-4844"></a><span class="k">          </span><span class="n">HeatingSizingRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4845"></a>        <span class="k">END IF</span>
<a name="ln-4846"></a><span class="k">        </span><span class="n">HeatingCoilPLFCurveIndex</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4847"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilName</span> <span class="o">=</span> <span class="n">HeatingCoilName</span>
<a name="ln-4848"></a>        <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">iHeatingCoilTypeAlphaNum</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-4849"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4850"></a>          <span class="n">PrintMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4851"></a>        <span class="k">END IF</span>
<a name="ln-4852"></a>
<a name="ln-4853"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span> <span class="s1">&#39;Coil:Heating:DX:VariableSpeed&#39;</span><span class="p">)</span> <span class="p">)</span><span class="k">THEN</span>
<a name="ln-4854"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">=</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span>
<a name="ln-4855"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:DX:MultiSpeed&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4856"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">=</span> <span class="n">CoilDX_MultiSpeedHeating</span>
<a name="ln-4857"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4858"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">=</span> <span class="n">Coil_HeatingWater</span>
<a name="ln-4859"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:Steam&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4860"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">=</span> <span class="n">Coil_HeatingSteam</span>
<a name="ln-4861"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:WaterToAirHeatPump:EquationFit&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4862"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">=</span> <span class="n">Coil_HeatingWaterToAirHPSimple</span>
<a name="ln-4863"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:WaterToAirHeatPump:ParameterEstimation&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4864"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">=</span> <span class="n">Coil_HeatingWaterToAirHP</span>
<a name="ln-4865"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:WaterToAirHeatPump:VariableSpeedEquationFit&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4866"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">=</span> <span class="n">Coil_HeatingWaterToAirHPVSEquationFit</span>
<a name="ln-4867"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:Electric:MultiStage&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4868"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">=</span> <span class="n">Coil_HeatingElectric_MultiStage</span>
<a name="ln-4869"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:Gas:MultiStage&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4870"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">=</span> <span class="n">Coil_HeatingGas_MultiStage</span>
<a name="ln-4871"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:Gas&#39;</span><span class="p">)</span>          <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4872"></a>                <span class="n">SameString</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:Electric&#39;</span><span class="p">)</span>     <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4873"></a>                <span class="n">SameString</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:Desuperheater&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4874"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">=</span> <span class="n">GetHeatingCoilTypeNum</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4875"></a>        <span class="k">ELSE IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4876"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4877"></a>                 <span class="n">GetDXCoilTypeNum</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">,</span><span class="n">PrintMessage</span><span class="p">)</span>
<a name="ln-4878"></a>        <span class="k">END IF</span>
<a name="ln-4879"></a>
<a name="ln-4880"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_HeatingEmpirical</span><span class="p">)</span>  <span class="k">THEN</span>
<a name="ln-4881"></a>
<a name="ln-4882"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DXHeatingCoil</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4883"></a>          <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4884"></a>
<a name="ln-4885"></a>          <span class="k">CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4886"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-4887"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4888"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4889"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4890"></a>
<a name="ln-4891"></a>          <span class="k">ELSE</span> <span class="c">! mine data from DX heating coil</span>
<a name="ln-4892"></a>
<a name="ln-4893"></a>            <span class="c">! Get DX heating coil index</span>
<a name="ln-4894"></a>            <span class="k">CALL </span><span class="n">GetDXCoilIndex</span><span class="p">(</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4895"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4896"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4897"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4898"></a>              <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4899"></a>            <span class="k">END IF</span>
<a name="ln-4900"></a>
<a name="ln-4901"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilAvailSchPtr</span> <span class="o">=</span> <span class="n">GetDXCoilAvailSchPtr</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4902"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4903"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4904"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4905"></a>              <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4906"></a>            <span class="k">END IF</span>
<a name="ln-4907"></a>
<a name="ln-4908"></a>            <span class="c">! Get DX heating coil capacity</span>
<a name="ln-4909"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">=</span>    <span class="p">&amp;</span>
<a name="ln-4910"></a>               <span class="n">GetDXCoilCapacity</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4911"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4912"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RequestAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4913"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4914"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4915"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4916"></a>              <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4917"></a>            <span class="k">END IF</span>
<a name="ln-4918"></a>
<a name="ln-4919"></a>            <span class="c">! Get DX coil air flow rate.</span>
<a name="ln-4920"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span>   <span class="o">=</span> <span class="n">GetDXCoilAirFlow</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4921"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4922"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RequestAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4923"></a>            <span class="c">! Get the Heating Coil Nodes</span>
<a name="ln-4924"></a>            <span class="n">HeatingCoilInletNode</span> <span class="o">=</span> <span class="n">GetDXCoilInletNode</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4925"></a>            <span class="n">HeatingCoilOutletNode</span> <span class="o">=</span> <span class="n">GetDXCoilOutletNode</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4926"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4927"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4928"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4929"></a>              <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4930"></a>            <span class="k">END IF</span>
<a name="ln-4931"></a>
<a name="ln-4932"></a><span class="k">            CALL </span><span class="n">SetDXCoolingCoilData</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4933"></a>                                      <span class="n">HeatSizeRatio</span><span class="o">=</span><span class="n">HeatingSizingRatio</span><span class="p">)</span>
<a name="ln-4934"></a>          <span class="k">END IF</span>
<a name="ln-4935"></a>
<a name="ln-4936"></a><span class="k">        </span><span class="n">ELSEIF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4937"></a>               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWaterToAirHPVSEquationFit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4938"></a>
<a name="ln-4939"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DXHeatingCoil</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4940"></a>
<a name="ln-4941"></a>          <span class="k">CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4942"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-4943"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4944"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4945"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4946"></a>          <span class="k">ELSE</span>
<a name="ln-4947"></a>
<a name="ln-4948"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span> <span class="o">=</span> <span class="n">GetCoilIndexVariableSpeed</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span> <span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4949"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4950"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4951"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4952"></a>              <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4953"></a>            <span class="k">END IF</span>
<a name="ln-4954"></a>
<a name="ln-4955"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span> <span class="o">=</span> <span class="n">GetVSCoilNumOfSpeeds</span><span class="p">(</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4956"></a>
<a name="ln-4957"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilAvailSchPtr</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-4958"></a>
<a name="ln-4959"></a>            <span class="n">HeatingCoilInletNode</span><span class="o">=</span><span class="n">GetCoilInletNodeVariableSpeed</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span> <span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4960"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4961"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4962"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4963"></a>              <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4964"></a>            <span class="k">END IF</span>
<a name="ln-4965"></a>
<a name="ln-4966"></a><span class="k">            </span><span class="n">HeatingCoilOutletNode</span><span class="o">=</span><span class="n">GetCoilOutletNodeVariableSpeed</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span> <span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4967"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4968"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4969"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4970"></a>              <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4971"></a>            <span class="k">END IF</span>
<a name="ln-4972"></a>
<a name="ln-4973"></a><span class="k">          END IF</span>
<a name="ln-4974"></a><span class="k">        </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_MultiSpeedHeating</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4975"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DXHeatingCoil</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4976"></a>          <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4977"></a>          <span class="k">CALL </span><span class="n">GetDXCoilIndex</span><span class="p">(</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4978"></a>                              <span class="n">ErrFlag</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">))</span>
<a name="ln-4979"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4980"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4981"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4982"></a>            <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4983"></a>          <span class="k">END IF</span>
<a name="ln-4984"></a>
<a name="ln-4985"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilAvailSchPtr</span> <span class="o">=</span> <span class="n">GetDXCoilAvailSchPtr</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4986"></a>
<a name="ln-4987"></a>          <span class="n">HeatingCoilInletNode</span> <span class="o">=</span> <span class="n">GetDXCoilInletNode</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4988"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4989"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4990"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4991"></a>            <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4992"></a>          <span class="k">END IF</span>
<a name="ln-4993"></a><span class="k">          </span><span class="n">HeatingCoilOutletNode</span> <span class="o">=</span> <span class="n">GetDXCoilOutletNode</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4994"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4995"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4996"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4997"></a>            <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4998"></a>          <span class="k">END IF</span>
<a name="ln-4999"></a>
<a name="ln-5000"></a><span class="c">!            IF(UnitarySystem(UnitarySysNum)%MaxHeatAirVolFlow == Autosize) &amp;</span>
<a name="ln-5001"></a><span class="c">!                 UnitarySystem(UnitarySysNum)%RequestAutosize = .TRUE.</span>
<a name="ln-5002"></a><span class="c">!            IF(UnitarySystem(UnitarySysNum)%DesignHeatingCapacity == Autosize) &amp;</span>
<a name="ln-5003"></a><span class="c">!                 UnitarySystem(UnitarySysNum)%RequestAutosize = .TRUE.</span>
<a name="ln-5004"></a>
<a name="ln-5005"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingElectric_MultiStage</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5006"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingGas_MultiStage</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5007"></a>
<a name="ln-5008"></a><span class="k">          </span><span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5009"></a>          <span class="k">CALL </span><span class="n">GetHeatingCoilIndex</span><span class="p">(</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span> <span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5010"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5011"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5012"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5013"></a>            <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5014"></a>          <span class="k">END IF</span>
<a name="ln-5015"></a><span class="k">          </span><span class="n">HeatingCoilInletNode</span> <span class="o">=</span> <span class="n">GetHeatingCoilInletNode</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5016"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5017"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5018"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5019"></a>            <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5020"></a>          <span class="k">END IF</span>
<a name="ln-5021"></a><span class="k">          </span><span class="n">HeatingCoilOutletNode</span> <span class="o">=</span> <span class="n">GetHeatingCoilOutletNode</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5022"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5023"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5024"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5025"></a>            <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5026"></a>          <span class="k">END IF</span>
<a name="ln-5027"></a>
<a name="ln-5028"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">=</span>    <span class="p">&amp;</span>
<a name="ln-5029"></a>            <span class="n">GetHeatingCoilCapacity</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5030"></a>
<a name="ln-5031"></a><span class="c">!            IF(UnitarySystem(UnitarySysNum)%MaxHeatAirVolFlow == Autosize) &amp;</span>
<a name="ln-5032"></a><span class="c">!                 UnitarySystem(UnitarySysNum)%RequestAutosize = .TRUE.</span>
<a name="ln-5033"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5034"></a>               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RequestAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5035"></a>
<a name="ln-5036"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingGas</span>          <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5037"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingElectric</span>     <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5038"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingDesuperheater</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5039"></a><span class="k">            </span><span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5040"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5041"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5042"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5043"></a>              <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5044"></a>            <span class="k">ELSE</span>
<a name="ln-5045"></a>
<a name="ln-5046"></a><span class="k">              CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5047"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-5048"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5049"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5050"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5051"></a>
<a name="ln-5052"></a>              <span class="k">ELSE</span> <span class="c">! mine data from heating coil</span>
<a name="ln-5053"></a>
<a name="ln-5054"></a>                <span class="c">! Get heating coil index</span>
<a name="ln-5055"></a>                <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5056"></a>                <span class="k">CALL </span><span class="n">GetHeatingCoilIndex</span><span class="p">(</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5057"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5058"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5059"></a>                  <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5060"></a>                  <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5061"></a>                <span class="k">END IF</span>
<a name="ln-5062"></a>
<a name="ln-5063"></a>                <span class="c">! Get the design heating capacity</span>
<a name="ln-5064"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-5065"></a>                   <span class="n">GetHeatingCoilCapacity</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5066"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5067"></a>                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RequestAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5068"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5069"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5070"></a>                  <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5071"></a>                  <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5072"></a>                <span class="k">END IF</span>
<a name="ln-5073"></a>
<a name="ln-5074"></a><span class="k">                </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilAvailSchPtr</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5075"></a>                       <span class="n">GetCoilAvailScheduleIndex</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5076"></a>
<a name="ln-5077"></a>                <span class="c">! Get the Heating Coil Inlet Node</span>
<a name="ln-5078"></a>                <span class="n">HeatingCoilInletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5079"></a>                       <span class="n">GetHeatingCoilInletNode</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5080"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5081"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5082"></a>                  <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5083"></a>                  <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5084"></a>                <span class="k">END IF</span>
<a name="ln-5085"></a>
<a name="ln-5086"></a>                <span class="c">! Get the Heating Coil Outlet Node</span>
<a name="ln-5087"></a>                <span class="n">HeatingCoilOutletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5088"></a>                       <span class="n">GetHeatingCoilOutletNode</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5089"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5090"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5091"></a>                  <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5092"></a>                  <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5093"></a>                <span class="k">END IF</span>
<a name="ln-5094"></a>
<a name="ln-5095"></a>                <span class="c">! Get the Heating Coil PLF Curve Index</span>
<a name="ln-5096"></a>                <span class="n">HeatingCoilPLFCurveIndex</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5097"></a>                       <span class="n">GetHeatingCoilPLFCurveIndex</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5098"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5099"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5100"></a>                  <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5101"></a>                  <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5102"></a>                <span class="k">END IF</span>
<a name="ln-5103"></a>               <span class="c">! These heating coil types do not have an air flow input field</span>
<a name="ln-5104"></a>               <span class="k">IF</span><span class="p">(</span><span class="n">NumNumbers</span> <span class="o">&lt;</span> <span class="n">iMaxHeatAirVolFlowNumericNum</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5105"></a><span class="k">                 </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">=</span> <span class="n">Autosize</span>
<a name="ln-5106"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RequestAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5107"></a>               <span class="k">END IF</span>
<a name="ln-5108"></a><span class="k">              END IF</span> <span class="c">! IF (IsNotOK) THEN</span>
<a name="ln-5109"></a>
<a name="ln-5110"></a>            <span class="k">END IF</span>
<a name="ln-5111"></a>
<a name="ln-5112"></a><span class="k">        </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWater</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5113"></a><span class="k">            CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-5114"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5115"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5116"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5117"></a>            <span class="k">ELSE</span> <span class="c">! mine data from heating coil object</span>
<a name="ln-5118"></a>
<a name="ln-5119"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5120"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilAvailSchPtr</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5121"></a>                       <span class="n">GetWaterCoilAvailScheduleIndex</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5122"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5123"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5124"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5125"></a>                  <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5126"></a>                <span class="k">END IF</span>
<a name="ln-5127"></a>
<a name="ln-5128"></a><span class="k">                </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span> <span class="o">=</span> <span class="n">GetWaterCoilIndex</span><span class="p">(</span><span class="s1">&#39;COIL:HEATING:WATER&#39;</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5129"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5130"></a><span class="k">                  CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5131"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iHeatingCoilNameAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span> <span class="p">&amp;</span>
<a name="ln-5132"></a>                                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HeatingCoilName</span><span class="p">))</span>
<a name="ln-5133"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5134"></a>                  <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5135"></a>                <span class="k">END IF</span>
<a name="ln-5136"></a>
<a name="ln-5137"></a>                <span class="c">! Get the Heating Coil water Inlet or control Node number</span>
<a name="ln-5138"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilFluidInletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5139"></a>                    <span class="n">GetCoilWaterInletNode</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5140"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5141"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5142"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5143"></a>                  <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5144"></a>                <span class="k">END IF</span>
<a name="ln-5145"></a>
<a name="ln-5146"></a>                <span class="c">! Get the Heating Coil hot water max volume flow rate</span>
<a name="ln-5147"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="o">=</span> <span class="n">GetCoilMaxWaterFlowRate</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5148"></a>                                                           <span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5149"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5150"></a>                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RequestAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5151"></a>
<a name="ln-5152"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5153"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5154"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5155"></a>                  <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5156"></a>                <span class="k">END IF</span>
<a name="ln-5157"></a>
<a name="ln-5158"></a>                <span class="c">! Get the Heating Coil Inlet Node</span>
<a name="ln-5159"></a>                <span class="n">HeatingCoilInletNode</span> <span class="o">=</span>  <span class="n">GetWaterCoilInletNode</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5160"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5161"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5162"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5163"></a>                  <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5164"></a>                <span class="k">END IF</span>
<a name="ln-5165"></a>
<a name="ln-5166"></a>                <span class="c">! Get the Heating Coil Outlet Node</span>
<a name="ln-5167"></a>                <span class="n">HeatingCoilOutletNode</span> <span class="o">=</span> <span class="n">GetWaterCoilOutletNode</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5168"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5169"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5170"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5171"></a>                  <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5172"></a>                <span class="k">END IF</span>
<a name="ln-5173"></a>
<a name="ln-5174"></a><span class="k">            END IF</span>
<a name="ln-5175"></a>
<a name="ln-5176"></a><span class="k">        </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingSteam</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5177"></a><span class="k">            CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-5178"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5179"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5180"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5181"></a>            <span class="k">ELSE</span> <span class="c">! mine data from heating coil object</span>
<a name="ln-5182"></a>
<a name="ln-5183"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5184"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilAvailSchPtr</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5185"></a>                       <span class="n">GetSteamCoilAvailScheduleIndex</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5186"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5187"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5188"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5189"></a>                  <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5190"></a>                <span class="k">END IF</span>
<a name="ln-5191"></a>
<a name="ln-5192"></a><span class="k">                </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span> <span class="o">=</span> <span class="n">GetSteamCoilIndex</span><span class="p">(</span><span class="s1">&#39;COIL:HEATING:STEAM&#39;</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5193"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5194"></a><span class="k">                  CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5195"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iHeatingCoilNameAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span> <span class="p">&amp;</span>
<a name="ln-5196"></a>                                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HeatingCoilName</span><span class="p">))</span>
<a name="ln-5197"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5198"></a>                  <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5199"></a>                <span class="k">END IF</span>
<a name="ln-5200"></a>
<a name="ln-5201"></a>                <span class="c">! Get the Heating Coil steam inlet node number</span>
<a name="ln-5202"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5203"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilFluidInletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5204"></a>                    <span class="n">GetSteamCoilSteamInletNode</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Steam&#39;</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5205"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5206"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5207"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5208"></a>                  <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5209"></a>                <span class="k">END IF</span>
<a name="ln-5210"></a>
<a name="ln-5211"></a>                <span class="c">! Get the Heating Coil steam max volume flow rate</span>
<a name="ln-5212"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5213"></a>                    <span class="n">GetCoilMaxSteamFlowRate</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5214"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5215"></a>                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RequestAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5216"></a>
<a name="ln-5217"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5218"></a><span class="k">                  </span><span class="n">SteamIndex</span> <span class="o">=</span> <span class="mi">0</span>      <span class="c">! Function GetSatDensityRefrig will look up steam index if 0 is passed</span>
<a name="ln-5219"></a>                  <span class="n">SteamDensity</span><span class="o">=</span><span class="n">GetSatDensityRefrig</span><span class="p">(</span><span class="s2">&quot;STEAM&quot;</span><span class="p">,</span><span class="n">TempSteamIn</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">SteamIndex</span><span class="p">,</span><span class="s1">&#39;GetAirLoopHVACHeatCoolInput&#39;</span><span class="p">)</span>
<a name="ln-5220"></a>                  <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5221"></a>                                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="o">*</span> <span class="n">SteamDensity</span>
<a name="ln-5222"></a>                  <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5223"></a>                <span class="k">END IF</span>
<a name="ln-5224"></a>
<a name="ln-5225"></a>                <span class="c">! Get the Heating Coil Inlet Node</span>
<a name="ln-5226"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5227"></a>                <span class="n">HeatingCoilInletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5228"></a>                         <span class="n">GetSteamCoilAirInletNode</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5229"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5230"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5231"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5232"></a>                  <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5233"></a>                <span class="k">END IF</span>
<a name="ln-5234"></a>
<a name="ln-5235"></a>                <span class="c">! Get the Heating Coil Outlet Node</span>
<a name="ln-5236"></a>                <span class="n">HeatingCoilOutletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5237"></a>                         <span class="n">GetSteamCoilAirOutletNode</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5238"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5239"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5240"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5241"></a>                  <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5242"></a>                <span class="k">END IF</span>
<a name="ln-5243"></a>
<a name="ln-5244"></a><span class="k">               IF</span><span class="p">(</span><span class="n">NumNumbers</span> <span class="o">&lt;</span> <span class="n">iMaxHeatAirVolFlowNumericNum</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5245"></a><span class="k">                 </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">=</span> <span class="n">Autosize</span>
<a name="ln-5246"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RequestAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5247"></a>               <span class="k">END IF</span>
<a name="ln-5248"></a>
<a name="ln-5249"></a><span class="k">            END IF</span>
<a name="ln-5250"></a>
<a name="ln-5251"></a><span class="k">        </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWaterToAirHPSimple</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5252"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DXHeatingCoil</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5253"></a>            <span class="k">CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-5254"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5255"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5256"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5257"></a>            <span class="k">ELSE</span> <span class="c">! mine data from heating coil object</span>
<a name="ln-5258"></a>
<a name="ln-5259"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5260"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilAvailSchPtr</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-5261"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5262"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5263"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5264"></a>                  <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5265"></a>                <span class="k">END IF</span>
<a name="ln-5266"></a>
<a name="ln-5267"></a><span class="k">                </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span> <span class="o">=</span> <span class="n">GetWtoAHPSimpleCoilIndex</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5268"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5269"></a><span class="k">                  CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5270"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iHeatingCoilNameAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span> <span class="p">&amp;</span>
<a name="ln-5271"></a>                                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HeatingCoilName</span><span class="p">))</span>
<a name="ln-5272"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5273"></a>                  <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5274"></a>                <span class="k">END IF</span>
<a name="ln-5275"></a>
<a name="ln-5276"></a>                <span class="c">! Get the Heating Coil Inlet Node</span>
<a name="ln-5277"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5278"></a>                <span class="n">HeatingCoilInletNode</span> <span class="o">=</span> <span class="n">GetWtoAHPSimpleCoilInletNode</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span> <span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5279"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5280"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5281"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5282"></a>                  <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5283"></a>                <span class="k">END IF</span>
<a name="ln-5284"></a>
<a name="ln-5285"></a>                <span class="c">! Get the Heating Coil Outlet Node</span>
<a name="ln-5286"></a>                <span class="n">HeatingCoilOutletNode</span> <span class="o">=</span> <span class="n">GetWtoAHPSimpleCoilOutletNode</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span> <span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5287"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5288"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5289"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5290"></a>                  <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5291"></a>                <span class="k">END IF</span>
<a name="ln-5292"></a>
<a name="ln-5293"></a><span class="c">!                IF(UnitarySystem(UnitarySysNum)%MaxHeatCoilFluidFlow == Autosize) &amp;</span>
<a name="ln-5294"></a><span class="c">!                   UnitarySystem(UnitarySysNum)%RequestAutosize = .TRUE.</span>
<a name="ln-5295"></a><span class="c">!                IF(UnitarySystem(UnitarySysNum)%DesignHeatingCapacity == Autosize) &amp;</span>
<a name="ln-5296"></a><span class="c">!                   UnitarySystem(UnitarySysNum)%RequestAutosize = .TRUE.</span>
<a name="ln-5297"></a><span class="c">!                IF(UnitarySystem(UnitarySysNum)%MaxHeatCoilFluidFlow == Autosize) &amp;</span>
<a name="ln-5298"></a><span class="c">!                   UnitarySystem(UnitarySysNum)%RequestAutosize = .TRUE.</span>
<a name="ln-5299"></a>            <span class="k">END IF</span>
<a name="ln-5300"></a>
<a name="ln-5301"></a><span class="k">        </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWaterToAirHP</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5302"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DXHeatingCoil</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5303"></a>            <span class="k">CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-5304"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5305"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5306"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5307"></a>            <span class="k">ELSE</span> <span class="c">! mine data from heating coil object</span>
<a name="ln-5308"></a>
<a name="ln-5309"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5310"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilAvailSchPtr</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-5311"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5312"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5313"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5314"></a>                  <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5315"></a>                <span class="k">END IF</span>
<a name="ln-5316"></a>
<a name="ln-5317"></a><span class="k">                </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span> <span class="o">=</span>  <span class="n">GetWtoAHPCoilIndex</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span> <span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5318"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5319"></a><span class="k">                  CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5320"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iHeatingCoilNameAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span> <span class="p">&amp;</span>
<a name="ln-5321"></a>                                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HeatingCoilName</span><span class="p">))</span>
<a name="ln-5322"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5323"></a>                  <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5324"></a>                <span class="k">END IF</span>
<a name="ln-5325"></a>
<a name="ln-5326"></a>                <span class="c">! Get the Heating Coil Inlet Node</span>
<a name="ln-5327"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5328"></a>                <span class="n">HeatingCoilInletNode</span> <span class="o">=</span> <span class="n">GetWtoAHPCoilInletNode</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span> <span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5329"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5330"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5331"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5332"></a>                  <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5333"></a>                <span class="k">END IF</span>
<a name="ln-5334"></a>
<a name="ln-5335"></a>                <span class="c">! Get the Heating Coil Outlet Node</span>
<a name="ln-5336"></a>                <span class="n">HeatingCoilOutletNode</span> <span class="o">=</span> <span class="n">GetWtoAHPCoilOutletNode</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span> <span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5337"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5338"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5339"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5340"></a>                  <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5341"></a>                <span class="k">END IF</span>
<a name="ln-5342"></a>
<a name="ln-5343"></a><span class="c">!                IF(UnitarySystem(UnitarySysNum)%MaxHeatCoilFluidFlow == Autosize) &amp;</span>
<a name="ln-5344"></a><span class="c">!                   UnitarySystem(UnitarySysNum)%RequestAutosize = .TRUE.</span>
<a name="ln-5345"></a><span class="c">!                IF(UnitarySystem(UnitarySysNum)%DesignHeatingCapacity == Autosize) &amp;</span>
<a name="ln-5346"></a><span class="c">!                   UnitarySystem(UnitarySysNum)%RequestAutosize = .TRUE.</span>
<a name="ln-5347"></a><span class="c">!                IF(UnitarySystem(UnitarySysNum)%MaxHeatCoilFluidFlow == Autosize) &amp;</span>
<a name="ln-5348"></a><span class="c">!                   UnitarySystem(UnitarySysNum)%RequestAutosize = .TRUE.</span>
<a name="ln-5349"></a>
<a name="ln-5350"></a>            <span class="k">END IF</span>
<a name="ln-5351"></a>
<a name="ln-5352"></a><span class="k">        </span><span class="n">ELSEIF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5353"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5354"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iHeatingCoilTypeAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5355"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iHeatingCoilTypeAlphaNum</span><span class="p">)))</span>
<a name="ln-5356"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5357"></a>        <span class="k">END IF</span> <span class="c">! IF (UnitarySystem(UnitarySysNum)%HeatingCoilType_Num == Coil_HeatingGas .OR. &amp;, etc.</span>
<a name="ln-5358"></a>
<a name="ln-5359"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_MultiSpeedHeating</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5360"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingElectric_MultiStage</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5361"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingGas_MultiStage</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5362"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MultiSpeedHeatingCoil</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5363"></a>        <span class="n">ELSEIF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWaterToAirHPVSEquationFit</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5364"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5365"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">VarSpeedHeatingCoil</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5366"></a>        <span class="k">END IF</span>
<a name="ln-5367"></a>
<a name="ln-5368"></a>        <span class="c">! coil outlet node set point has priority, IF not exist, then use system outlet node</span>
<a name="ln-5369"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">NodeHasSPMCtrlVarType</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemOutletNodeNum</span><span class="p">,</span> <span class="n">iCtrlVarType_Temp</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-5370"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SystemHeatControlNodeNum</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemOutletNodeNum</span>
<a name="ln-5371"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">NodeHasSPMCtrlVarType</span><span class="p">(</span><span class="n">HeatingCoilOutletNode</span><span class="p">,</span> <span class="n">iCtrlVarType_Temp</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-5372"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SystemHeatControlNodeNum</span> <span class="o">=</span> <span class="n">HeatingCoilOutletNode</span>
<a name="ln-5373"></a>
<a name="ln-5374"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilInletNodeNum</span>  <span class="o">=</span> <span class="n">HeatingCoilInletNode</span>
<a name="ln-5375"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilOutletNodeNum</span> <span class="o">=</span> <span class="n">HeatingCoilOutletNode</span>
<a name="ln-5376"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilName</span>       <span class="o">=</span> <span class="n">HeatingCoilName</span>
<a name="ln-5377"></a>
<a name="ln-5378"></a>        <span class="c">! Add heating coil to component sets array</span>
<a name="ln-5379"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5380"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">CoilDX_MultiSpeedHeating</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5381"></a><span class="k">            CALL </span><span class="n">SetUpCompSets</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span> <span class="n">Alphas</span><span class="p">(</span><span class="n">iNameAlphaNum</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-5382"></a>                               <span class="n">Alphas</span><span class="p">(</span><span class="n">iHeatingCoilTypeAlphaNum</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iHeatingCoilNameAlphaNum</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-5383"></a>                               <span class="n">NodeID</span><span class="p">(</span><span class="n">HeatingCoilInletNode</span><span class="p">),</span> <span class="n">NodeID</span><span class="p">(</span><span class="n">HeatingCoilOutletNode</span><span class="p">))</span>
<a name="ln-5384"></a>          <span class="k">ELSE</span>
<a name="ln-5385"></a><span class="k">            CALL </span><span class="n">SetUpCompSets</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span> <span class="n">Alphas</span><span class="p">(</span><span class="n">iNameAlphaNum</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-5386"></a>                               <span class="n">Alphas</span><span class="p">(</span><span class="n">iHeatingCoilTypeAlphaNum</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iHeatingCoilNameAlphaNum</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-5387"></a>                               <span class="s1">&#39;UNDEFINED&#39;</span><span class="p">,</span> <span class="s1">&#39;UNDEFINED&#39;</span><span class="p">)</span>
<a name="ln-5388"></a>          <span class="k">END IF</span>
<a name="ln-5389"></a><span class="k">        END IF</span>
<a name="ln-5390"></a>        <span class="c">! Get Cooling Coil Information IF available</span>
<a name="ln-5391"></a>        <span class="n">CoolingCoilType</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="n">iCoolingCoilTypeAlphaNum</span><span class="p">)</span>
<a name="ln-5392"></a>        <span class="n">CoolingCoilName</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="n">iCoolingCoilNameAlphaNum</span><span class="p">)</span>
<a name="ln-5393"></a>        <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">iCoolingCoilTypeAlphaNum</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-5394"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilExists</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5395"></a>
<a name="ln-5396"></a><span class="c">!       Find the type of coil. do not print message since this may not be the correct coil type.</span>
<a name="ln-5397"></a>        <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5398"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span> <span class="s1">&#39;Coil:Cooling:DX:VariableSpeed&#39;</span><span class="p">)</span> <span class="p">)</span><span class="k">THEN</span>
<a name="ln-5399"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">=</span> <span class="n">Coil_CoolingAirToAirVariableSpeed</span>
<a name="ln-5400"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Cooling:DX:MultiSpeed&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5401"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">=</span> <span class="n">CoilDX_MultiSpeedCooling</span>
<a name="ln-5402"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5403"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">=</span> <span class="n">Coil_CoolingWater</span>
<a name="ln-5404"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5405"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">=</span> <span class="n">Coil_CoolingWaterDetailed</span>
<a name="ln-5406"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Cooling:DX:TwoStageWithHumidityControlMode&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5407"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">=</span> <span class="n">CoilDX_CoolingTwoStageWHumControl</span>
<a name="ln-5408"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="s1">&#39;CoilSystem:Cooling:DX:HeatExchangerAssisted&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5409"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5410"></a>                 <span class="n">GetHXAssistedCoilTypeNum</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">,</span><span class="n">PrintMessage</span><span class="p">)</span>
<a name="ln-5411"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="s1">&#39;CoilSystem:Cooling:Water:HeatExchangerAssisted&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5412"></a>          <span class="c">! why use a mining function, why not just set it using the integer representation?</span>
<a name="ln-5413"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5414"></a>                 <span class="n">GetHXAssistedCoilTypeNum</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">,</span><span class="n">PrintMessage</span><span class="p">)</span>
<a name="ln-5415"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Cooling:WaterToAirHeatPump:EquationFit&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5416"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">=</span> <span class="n">Coil_CoolingWaterToAirHPSimple</span>
<a name="ln-5417"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Cooling:WaterToAirHeatPump:ParameterEstimation&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5418"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">=</span> <span class="n">Coil_CoolingWaterToAirHP</span>
<a name="ln-5419"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Cooling:WaterToAirHeatPump:VariableSpeedEquationFit&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5420"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">=</span> <span class="n">Coil_CoolingWaterToAirHPVSEquationFit</span>
<a name="ln-5421"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Cooling:DX:SingleSpeed&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5422"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5423"></a>                 <span class="n">GetDXCoilTypeNum</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">,</span><span class="n">PrintMessage</span><span class="p">)</span>
<a name="ln-5424"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Cooling:DX:TwoSpeed&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5425"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5426"></a>                 <span class="n">GetDXCoilTypeNum</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">,</span><span class="n">PrintMessage</span><span class="p">)</span>
<a name="ln-5427"></a>        <span class="k">ELSE</span>
<a name="ln-5428"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5429"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iCoolingCoilTypeAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5430"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iCoolingCoilTypeAlphaNum</span><span class="p">)))</span>
<a name="ln-5431"></a>        <span class="k">END IF</span>
<a name="ln-5432"></a>
<a name="ln-5433"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingSingleSpeed</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5434"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoSpeed</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5435"></a><span class="k">          CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5436"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-5437"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5438"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5439"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5440"></a>
<a name="ln-5441"></a>          <span class="k">ELSE</span> <span class="c">! mine data from DX cooling coil</span>
<a name="ln-5442"></a>
<a name="ln-5443"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoSpeed</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5444"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-5445"></a>
<a name="ln-5446"></a>            <span class="c">! Get DX cooling coil index</span>
<a name="ln-5447"></a>            <span class="k">CALL </span><span class="n">GetDXCoilIndex</span><span class="p">(</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">)</span>
<a name="ln-5448"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5449"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5450"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5451"></a>            <span class="k">END IF</span>
<a name="ln-5452"></a>
<a name="ln-5453"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilAvailSchPtr</span> <span class="o">=</span> <span class="n">GetDXCoilAvailSchPtr</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5454"></a>
<a name="ln-5455"></a>            <span class="c">! Get DX cooling coil capacity</span>
<a name="ln-5456"></a>            <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5457"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignCoolingCapacity</span> <span class="o">=</span>    <span class="p">&amp;</span>
<a name="ln-5458"></a>                 <span class="n">GetDXCoilCapacity</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5459"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignCoolingCapacity</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5460"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RequestAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5461"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5462"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5463"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5464"></a>            <span class="k">END IF</span>
<a name="ln-5465"></a>
<a name="ln-5466"></a>            <span class="c">! Get DX coil air flow rate. Latter fields will overwrite this IF input field is present</span>
<a name="ln-5467"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span>   <span class="o">=</span> <span class="n">GetDXCoilAirFlow</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5468"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5469"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RequestAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5470"></a>
<a name="ln-5471"></a>            <span class="c">! Get the Cooling Coil Nodes</span>
<a name="ln-5472"></a>            <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5473"></a>            <span class="n">CoolingCoilInletNode</span> <span class="o">=</span> <span class="n">GetDXCoilInletNode</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5474"></a>            <span class="n">CoolingCoilOutletNode</span> <span class="o">=</span> <span class="n">GetDXCoilOutletNode</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5475"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5476"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5477"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5478"></a>            <span class="k">END IF</span>
<a name="ln-5479"></a>
<a name="ln-5480"></a>            <span class="c">! Get Outdoor condenser node from DX coil object</span>
<a name="ln-5481"></a>            <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5482"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CondenserNodeNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5483"></a>                    <span class="n">GetDXCoilCondenserInletNode</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5484"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5485"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5486"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5487"></a>            <span class="k">END IF</span>
<a name="ln-5488"></a>
<a name="ln-5489"></a><span class="k">            IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5490"></a><span class="k">              </span><span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5491"></a>              <span class="k">CALL </span><span class="n">GetFanIndex</span><span class="p">(</span><span class="n">FanName</span><span class="p">,</span><span class="n">FanIndex</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">,</span><span class="n">CurrentModuleObject</span><span class="p">)</span>
<a name="ln-5492"></a>              <span class="k">CALL </span><span class="n">SetDXCoolingCoilData</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5493"></a>                                        <span class="n">SupplyFanName</span><span class="o">=</span><span class="n">FanName</span><span class="p">)</span>
<a name="ln-5494"></a>              <span class="k">CALL </span><span class="n">SetDXCoolingCoilData</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5495"></a>                                        <span class="n">SupplyFanIndex</span><span class="o">=</span><span class="n">FanIndex</span><span class="p">)</span>
<a name="ln-5496"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5497"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5498"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5499"></a>              <span class="k">END IF</span>
<a name="ln-5500"></a><span class="k">            END IF</span>
<a name="ln-5501"></a><span class="k">            IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5502"></a><span class="k">              IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5503"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWaterToAirHPVSEquationFit</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5504"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWaterToAirHPSimple</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5505"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_MultiSpeedHeating</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5506"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_HeatingEmpirical</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5507"></a><span class="k">                </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatPump</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5508"></a>              <span class="k">END IF</span>
<a name="ln-5509"></a><span class="k">            END IF</span>
<a name="ln-5510"></a>
<a name="ln-5511"></a><span class="k">          END IF</span> <span class="c">! IF (IsNotOK) THEN</span>
<a name="ln-5512"></a>
<a name="ln-5513"></a>          <span class="c">! Push heating coil PLF curve index to DX coil</span>
<a name="ln-5514"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">HeatingCoilPLFCurveIndex</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5515"></a><span class="k">            CALL </span><span class="n">SetDXCoolingCoilData</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5516"></a>                                      <span class="n">HeatingCoilPLFCurvePTR</span><span class="o">=</span><span class="n">HeatingCoilPLFCurveIndex</span><span class="p">)</span>
<a name="ln-5517"></a>          <span class="k">END IF</span>
<a name="ln-5518"></a>
<a name="ln-5519"></a><span class="k">        </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoStageWHumControl</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5520"></a><span class="k">          CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5521"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-5522"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5523"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5524"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5525"></a>
<a name="ln-5526"></a>          <span class="k">ELSE</span> <span class="c">! mine data from DX cooling coil</span>
<a name="ln-5527"></a>
<a name="ln-5528"></a>            <span class="c">! Get DX cooling coil index</span>
<a name="ln-5529"></a>            <span class="k">CALL </span><span class="n">GetDXCoilIndex</span><span class="p">(</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">)</span>
<a name="ln-5530"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5531"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5532"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5533"></a>            <span class="k">END IF</span>
<a name="ln-5534"></a>
<a name="ln-5535"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilAvailSchPtr</span> <span class="o">=</span> <span class="n">GetDXCoilAvailSchPtr</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5536"></a>
<a name="ln-5537"></a>            <span class="c">! Get DX cooling coil capacity</span>
<a name="ln-5538"></a>            <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5539"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignCoolingCapacity</span> <span class="o">=</span>    <span class="p">&amp;</span>
<a name="ln-5540"></a>                 <span class="n">GetDXCoilCapacity</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5541"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignCoolingCapacity</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5542"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RequestAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5543"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5544"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5545"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5546"></a>            <span class="k">END IF</span>
<a name="ln-5547"></a>
<a name="ln-5548"></a>            <span class="c">! Get DX coil air flow rate. Later fields will overwrite this IF input field is present</span>
<a name="ln-5549"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span>   <span class="o">=</span> <span class="n">GetDXCoilAirFlow</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5550"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5551"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RequestAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5552"></a>
<a name="ln-5553"></a>            <span class="c">! Get the Cooling Coil Nodes</span>
<a name="ln-5554"></a>            <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5555"></a>            <span class="n">CoolingCoilInletNode</span> <span class="o">=</span> <span class="n">GetDXCoilInletNode</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5556"></a>            <span class="n">CoolingCoilOutletNode</span> <span class="o">=</span> <span class="n">GetDXCoilOutletNode</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5557"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5558"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5559"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5560"></a>            <span class="k">END IF</span>
<a name="ln-5561"></a>
<a name="ln-5562"></a>            <span class="c">! Get Outdoor condenser node from DX coil object</span>
<a name="ln-5563"></a>            <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5564"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CondenserNodeNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5565"></a>                    <span class="n">GetDXCoilCondenserInletNode</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5566"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5567"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5568"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5569"></a>            <span class="k">END IF</span>
<a name="ln-5570"></a>
<a name="ln-5571"></a><span class="k">          END IF</span> <span class="c">! IF (IsNotOK) THEN</span>
<a name="ln-5572"></a>
<a name="ln-5573"></a>          <span class="c">! Push heating coil PLF curve index to DX coil</span>
<a name="ln-5574"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">HeatingCoilPLFCurveIndex</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5575"></a><span class="k">            CALL </span><span class="n">SetDXCoolingCoilData</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5576"></a>                                      <span class="n">HeatingCoilPLFCurvePTR</span><span class="o">=</span><span class="n">HeatingCoilPLFCurveIndex</span><span class="p">)</span>
<a name="ln-5577"></a>          <span class="k">END IF</span>
<a name="ln-5578"></a>
<a name="ln-5579"></a><span class="k">            IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5580"></a><span class="k">              IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5581"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWaterToAirHPVSEquationFit</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5582"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWaterToAirHPSimple</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5583"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_MultiSpeedHeating</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5584"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_HeatingEmpirical</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5585"></a><span class="k">                </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatPump</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5586"></a>              <span class="k">END IF</span>
<a name="ln-5587"></a><span class="k">            END IF</span>
<a name="ln-5588"></a>
<a name="ln-5589"></a><span class="k">        </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingHXAssisted</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5590"></a><span class="k">          CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5591"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-5592"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5593"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5594"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5595"></a>
<a name="ln-5596"></a>          <span class="k">ELSE</span> <span class="c">! mine data from heat exchanger assisted cooling coil</span>
<a name="ln-5597"></a>
<a name="ln-5598"></a>            <span class="c">! Get DX heat exchanger assisted cooling coil index</span>
<a name="ln-5599"></a>            <span class="k">CALL </span><span class="n">GetHXDXCoilIndex</span><span class="p">(</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">)</span>
<a name="ln-5600"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5601"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5602"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5603"></a>            <span class="k">END IF</span>
<a name="ln-5604"></a>
<a name="ln-5605"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilAvailSchPtr</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5606"></a>              <span class="n">GetDXCoilAvailSchPtr</span><span class="p">(</span><span class="n">CALLCoilTypes</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-5607"></a>                                   <span class="n">GetHXDXCoilName</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">),</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5608"></a>
<a name="ln-5609"></a>            <span class="c">! Get DX cooling coil capacity</span>
<a name="ln-5610"></a>            <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5611"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignCoolingCapacity</span> <span class="o">=</span>    <span class="p">&amp;</span>
<a name="ln-5612"></a>               <span class="n">GetDXHXAsstdCoilCapacity</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5613"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignCoolingCapacity</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5614"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RequestAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5615"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5616"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5617"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5618"></a>            <span class="k">END IF</span>
<a name="ln-5619"></a>
<a name="ln-5620"></a>            <span class="c">! Get the Cooling Coil Nodes</span>
<a name="ln-5621"></a>            <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5622"></a>            <span class="n">CoolingCoilInletNode</span> <span class="o">=</span> <span class="n">GetDXHXAsstdCoilInletNode</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5623"></a>            <span class="n">CoolingCoilOutletNode</span> <span class="o">=</span> <span class="n">GetDXHXAsstdCoilOutletNode</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5624"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5625"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5626"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5627"></a>            <span class="k">END IF</span>
<a name="ln-5628"></a>
<a name="ln-5629"></a>            <span class="c">! Get Outdoor condenser node from heat exchanger assisted DX coil object</span>
<a name="ln-5630"></a>            <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5631"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CondenserNodeNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5632"></a>                <span class="n">GetDXCoilCondenserInletNode</span><span class="p">(</span><span class="s1">&#39;COIL:COOLING:DX:SINGLESPEED&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5633"></a>                <span class="n">GetHXDXCoilName</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">),</span> <span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5634"></a>
<a name="ln-5635"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5636"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5637"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5638"></a>            <span class="k">END IF</span>
<a name="ln-5639"></a>
<a name="ln-5640"></a>            <span class="c">! Push heating coil PLF curve index to DX coil</span>
<a name="ln-5641"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">HeatingCoilPLFCurveIndex</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5642"></a>              <span class="c">! get the actual index to the DX cooling coil object</span>
<a name="ln-5643"></a>              <span class="n">DXCoilIndex</span> <span class="o">=</span> <span class="n">GetActualDXCoilIndex</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-5644"></a>              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ActualDXCoilIndexforHXAssisted</span> <span class="o">=</span> <span class="n">DXCoilIndex</span>
<a name="ln-5645"></a>              <span class="k">CALL </span><span class="n">SetDXCoolingCoilData</span><span class="p">(</span><span class="n">DXCoilIndex</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5646"></a>                                        <span class="n">HeatingCoilPLFCurvePTR</span><span class="o">=</span><span class="n">HeatingCoilPLFCurveIndex</span><span class="p">)</span>
<a name="ln-5647"></a>            <span class="k">END IF</span>
<a name="ln-5648"></a>
<a name="ln-5649"></a><span class="k">            IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5650"></a><span class="k">              IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5651"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWaterToAirHPVSEquationFit</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5652"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWaterToAirHPSimple</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5653"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_MultiSpeedHeating</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5654"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_HeatingEmpirical</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5655"></a><span class="k">                </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatPump</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5656"></a>              <span class="k">END IF</span>
<a name="ln-5657"></a><span class="k">            END IF</span>
<a name="ln-5658"></a>
<a name="ln-5659"></a><span class="k">          END IF</span> <span class="c">! IF (IsNotOK) THEN</span>
<a name="ln-5660"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilWater_CoolingHXAssisted</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5661"></a><span class="k">          CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5662"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-5663"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5664"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5665"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5666"></a>
<a name="ln-5667"></a>          <span class="k">ELSE</span> <span class="c">! mine data from heat exchanger assisted cooling coil</span>
<a name="ln-5668"></a>
<a name="ln-5669"></a>            <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5670"></a>            <span class="n">ActualCoolCoilType</span> <span class="o">=</span> <span class="n">GetCoilObjectTypeNum</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">,.</span><span class="n">TRUE</span><span class="p">.)</span>
<a name="ln-5671"></a>            <span class="n">HXCoilName</span> <span class="o">=</span> <span class="n">GetHXDXCoilName</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5672"></a>
<a name="ln-5673"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5674"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5675"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5676"></a>            <span class="k">END IF</span>
<a name="ln-5677"></a>
<a name="ln-5678"></a>            <span class="c">! Get DX heat exchanger assisted cooling coil index</span>
<a name="ln-5679"></a>            <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5680"></a>            <span class="k">CALL </span><span class="n">GetHXDXCoilIndex</span><span class="p">(</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5681"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5682"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5683"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5684"></a>            <span class="k">END IF</span>
<a name="ln-5685"></a>
<a name="ln-5686"></a><span class="k">            </span><span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5687"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilAvailSchPtr</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5688"></a>              <span class="n">GetWaterCoilAvailScheduleIndex</span><span class="p">(</span><span class="n">cAllCoilTypes</span><span class="p">(</span><span class="n">ActualCoolCoilType</span><span class="p">),</span><span class="n">HXCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5689"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolCoilFluidFlow</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5690"></a>              <span class="n">GetCoilMaxWaterFlowRate</span><span class="p">(</span><span class="n">cAllCoilTypes</span><span class="p">(</span><span class="n">ActualCoolCoilType</span><span class="p">),</span><span class="n">HXCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5691"></a>            <span class="c">! Get the Cooling Coil water Inlet Node number</span>
<a name="ln-5692"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilFluidInletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5693"></a>              <span class="n">GetCoilWaterInletNode</span><span class="p">(</span><span class="n">cAllCoilTypes</span><span class="p">(</span><span class="n">ActualCoolCoilType</span><span class="p">),</span><span class="n">HXCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5694"></a><span class="c">!            UnitarySystem(UnitarySysNum)%CoolCoilFluidOutletNodeNum = &amp;</span>
<a name="ln-5695"></a><span class="c">!              GetCoilWaterOutletNode(cAllCoilTypes(ActualCoolCoilType),HXCoilName,ErrFlag)</span>
<a name="ln-5696"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5697"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5698"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5699"></a>            <span class="k">END IF</span>
<a name="ln-5700"></a>
<a name="ln-5701"></a>   <span class="c">! this needs to be the coil index, not the parent</span>
<a name="ln-5702"></a>   <span class="c">! CAN&#39;t do this here, we need to know the air flow rate first</span>
<a name="ln-5703"></a><span class="c">!            UnitarySystem(UnitarySysNum)%DesignCoolingCapacity =    &amp;</span>
<a name="ln-5704"></a><span class="c">!               GetDXHXAsstdCoilCapacity(CoolingCoilType,CoolingCoilName,ErrFlag)</span>
<a name="ln-5705"></a><span class="c">!            UnitarySystem(UnitarySysNum)%CoolingCoilAvailSchPtr = GetDXCoilAvailSchPtr(CoolingCoilType,CoolingCoilName,ErrFlag)</span>
<a name="ln-5706"></a>
<a name="ln-5707"></a>            <span class="c">! Get the Cooling Coil Nodes</span>
<a name="ln-5708"></a>            <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5709"></a>            <span class="n">CoolingCoilInletNode</span> <span class="o">=</span> <span class="n">GetDXHXAsstdCoilInletNode</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5710"></a>            <span class="n">CoolingCoilOutletNode</span> <span class="o">=</span> <span class="n">GetDXHXAsstdCoilOutletNode</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5711"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5712"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5713"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5714"></a>            <span class="k">END IF</span>
<a name="ln-5715"></a>
<a name="ln-5716"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">=</span> <span class="n">GetHXCoilAirFlowRate</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5717"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5718"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RequestAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5719"></a>
<a name="ln-5720"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CondenserNodeNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5721"></a>           <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5722"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5723"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5724"></a>            <span class="k">END IF</span>
<a name="ln-5725"></a>
<a name="ln-5726"></a>            <span class="c">! Push heating coil PLF curve index to DX coil</span>
<a name="ln-5727"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">HeatingCoilPLFCurveIndex</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5728"></a>              <span class="c">! get the actual index to the DX cooling coil object</span>
<a name="ln-5729"></a>              <span class="n">DXCoilIndex</span> <span class="o">=</span> <span class="n">GetActualDXCoilIndex</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-5730"></a>              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ActualDXCoilIndexforHXAssisted</span> <span class="o">=</span> <span class="n">DXCoilIndex</span>
<a name="ln-5731"></a>              <span class="k">CALL </span><span class="n">SetDXCoolingCoilData</span><span class="p">(</span><span class="n">DXCoilIndex</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5732"></a>                                        <span class="n">HeatingCoilPLFCurvePTR</span><span class="o">=</span><span class="n">HeatingCoilPLFCurveIndex</span><span class="p">)</span>
<a name="ln-5733"></a>            <span class="k">END IF</span>
<a name="ln-5734"></a>
<a name="ln-5735"></a><span class="k">            IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5736"></a><span class="k">              IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5737"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWaterToAirHPVSEquationFit</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5738"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWaterToAirHPSimple</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5739"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_MultiSpeedHeating</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5740"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_HeatingEmpirical</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5741"></a><span class="k">                </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatPump</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5742"></a>              <span class="k">END IF</span>
<a name="ln-5743"></a><span class="k">            END IF</span>
<a name="ln-5744"></a>
<a name="ln-5745"></a><span class="k">          END IF</span> <span class="c">! IF (IsNotOK) THEN</span>
<a name="ln-5746"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_CoolingAirToAirVariableSpeed</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5747"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_CoolingWaterToAirHPVSEquationFit</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5748"></a><span class="k">          CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5749"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-5750"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5751"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5752"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5753"></a>          <span class="k">ELSE</span>
<a name="ln-5754"></a><span class="k">            </span><span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5755"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span> <span class="o">=</span> <span class="n">GetCoilIndexVariableSpeed</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5756"></a>                        <span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5757"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5758"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5759"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5760"></a>              <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5761"></a>            <span class="k">END IF</span>
<a name="ln-5762"></a>
<a name="ln-5763"></a><span class="k">            </span><span class="n">CoolingCoilInletNode</span> <span class="o">=</span><span class="n">GetCoilInletNodeVariableSpeed</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5764"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5765"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5766"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5767"></a>              <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5768"></a>            <span class="k">END IF</span>
<a name="ln-5769"></a>
<a name="ln-5770"></a><span class="k">            </span><span class="n">CoolingCoilOutletNode</span> <span class="o">=</span><span class="n">GetCoilOutletNodeVariableSpeed</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5771"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5772"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5773"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5774"></a>              <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5775"></a>            <span class="k">END IF</span>
<a name="ln-5776"></a>
<a name="ln-5777"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CondenserNodeNum</span> <span class="o">=</span> <span class="n">GetVSCoilCondenserInletNode</span><span class="p">(</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5778"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5779"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5780"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5781"></a>              <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5782"></a>            <span class="k">END IF</span>
<a name="ln-5783"></a>
<a name="ln-5784"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilAvailSchPtr</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-5785"></a>
<a name="ln-5786"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span> <span class="o">=</span> <span class="n">GetVSCoilNumOfSpeeds</span><span class="p">(</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5787"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5788"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5789"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5790"></a>              <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5791"></a>            <span class="k">END IF</span>
<a name="ln-5792"></a>
<a name="ln-5793"></a><span class="k">            </span><span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5794"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignCoolingCapacity</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-5795"></a>              <span class="n">GetCoilCapacityVariableSpeed</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5796"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignCoolingCapacity</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5797"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RequestAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5798"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5799"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5800"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5801"></a>            <span class="k">END IF</span>
<a name="ln-5802"></a><span class="k">          END IF</span>
<a name="ln-5803"></a>
<a name="ln-5804"></a>          <span class="c">! why was this done?</span>
<a name="ln-5805"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_CoolingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5806"></a><span class="k">             </span><span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5807"></a>             <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span>       <span class="p">&amp;</span>
<a name="ln-5808"></a>                <span class="o">=</span> <span class="n">GetCoilAirFlowRateVariableSpeed</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5809"></a>             <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5810"></a>                  <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RequestAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5811"></a>
<a name="ln-5812"></a>             <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5813"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5814"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5815"></a>             <span class="k">END IF</span>
<a name="ln-5816"></a>
<a name="ln-5817"></a><span class="c">!            UnitarySystem(UnitarySysNum)%MaxNoCoolHeatAirVolFlow = &amp;</span>
<a name="ln-5818"></a><span class="c">!                 MIN(UnitarySystem(UnitarySysNum)%MaxHeatAirVolFlow,UnitarySystem(UnitarySysNum)%MaxCoolAirVolFlow)</span>
<a name="ln-5819"></a><span class="c">!            IF(UnitarySystem(UnitarySysNum)%FanExists)THEN</span>
<a name="ln-5820"></a><span class="c">!              IF(UnitarySystem(UnitarySysNum)%MaxHeatAirVolFlow /= Autosize .AND. &amp;</span>
<a name="ln-5821"></a><span class="c">!                 UnitarySystem(UnitarySysNum)%MaxCoolAirVolFlow /= Autosize .AND. &amp;</span>
<a name="ln-5822"></a><span class="c">!                 .NOT. UnitarySystem(UnitarySysNum)%RequestAutosize)THEN</span>
<a name="ln-5823"></a><span class="c">!                 UnitarySystem(UnitarySysNum)%DesignFanVolFlowRate = &amp;</span>
<a name="ln-5824"></a><span class="c">!                   MAX(UnitarySystem(UnitarySysNum)%MaxHeatAirVolFlow,UnitarySystem(UnitarySysNum)%MaxCoolAirVolFlow)</span>
<a name="ln-5825"></a><span class="c">!              ELSE</span>
<a name="ln-5826"></a><span class="c">!                UnitarySystem(UnitarySysNum)%DesignFanVolFlowRate = Autosize</span>
<a name="ln-5827"></a><span class="c">!              END IF</span>
<a name="ln-5828"></a><span class="c">!            END IF</span>
<a name="ln-5829"></a>          <span class="k">END IF</span>
<a name="ln-5830"></a>
<a name="ln-5831"></a><span class="k">          IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5832"></a><span class="k">            IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5833"></a>               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWaterToAirHPVSEquationFit</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5834"></a>               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWaterToAirHPSimple</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5835"></a>               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_MultiSpeedHeating</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5836"></a>               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_HeatingEmpirical</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5837"></a><span class="k">              </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatPump</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5838"></a>            <span class="k">END IF</span>
<a name="ln-5839"></a><span class="k">          END IF</span>
<a name="ln-5840"></a>
<a name="ln-5841"></a><span class="k">        </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_MultiSpeedCooling</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5842"></a><span class="k">          </span><span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5843"></a>          <span class="k">CALL </span><span class="n">GetDXCoilIndex</span><span class="p">(</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5844"></a>                              <span class="n">ErrFlag</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">))</span>
<a name="ln-5845"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5846"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5847"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5848"></a>            <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5849"></a>          <span class="k">END IF</span>
<a name="ln-5850"></a>
<a name="ln-5851"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilAvailSchPtr</span> <span class="o">=</span> <span class="n">GetDXCoilAvailSchPtr</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5852"></a>
<a name="ln-5853"></a>          <span class="n">CoolingCoilInletNode</span> <span class="o">=</span> <span class="n">GetDXCoilInletNode</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5854"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5855"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5856"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5857"></a>            <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5858"></a>          <span class="k">END IF</span>
<a name="ln-5859"></a><span class="k">          </span><span class="n">CoolingCoilOutletNode</span> <span class="o">=</span> <span class="n">GetDXCoilOutletNode</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5860"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5861"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5862"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5863"></a>            <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5864"></a>          <span class="k">END IF</span>
<a name="ln-5865"></a>
<a name="ln-5866"></a><span class="c">!          IF(UnitarySystem(UnitarySysNum)%DesignCoolingCapacity == Autosize) &amp;</span>
<a name="ln-5867"></a><span class="c">!               UnitarySystem(UnitarySysNum)%RequestAutosize = .TRUE.</span>
<a name="ln-5868"></a>
<a name="ln-5869"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5870"></a><span class="k">            IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5871"></a>               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWaterToAirHPVSEquationFit</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5872"></a>               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWaterToAirHPSimple</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5873"></a>               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_MultiSpeedHeating</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5874"></a>               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_HeatingEmpirical</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5875"></a><span class="k">              </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatPump</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5876"></a>            <span class="k">END IF</span>
<a name="ln-5877"></a><span class="k">          END IF</span>
<a name="ln-5878"></a>
<a name="ln-5879"></a><span class="k">        </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_CoolingWater</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5880"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_CoolingWaterDetailed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5881"></a>
<a name="ln-5882"></a><span class="k">          CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-5883"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5884"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5885"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5886"></a>          <span class="k">ELSE</span> <span class="c">! mine data from Cooling coil object</span>
<a name="ln-5887"></a>
<a name="ln-5888"></a>            <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5889"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilAvailSchPtr</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5890"></a>                 <span class="n">GetWaterCoilAvailScheduleIndex</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5891"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5892"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5893"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5894"></a>              <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5895"></a>            <span class="k">END IF</span>
<a name="ln-5896"></a>
<a name="ln-5897"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span> <span class="o">=</span> <span class="n">GetWaterCoilIndex</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5898"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5899"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iCoolingCoilNameAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span> <span class="p">&amp;</span>
<a name="ln-5900"></a>                              <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HeatingCoilName</span><span class="p">))</span>
<a name="ln-5901"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5902"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5903"></a>              <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5904"></a>            <span class="k">END IF</span>
<a name="ln-5905"></a>
<a name="ln-5906"></a>            <span class="c">! Get the Cooling Coil water Inlet Node number</span>
<a name="ln-5907"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilFluidInletNode</span> <span class="o">=</span> <span class="n">GetCoilWaterInletNode</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5908"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5909"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5910"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5911"></a>              <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5912"></a>            <span class="k">END IF</span>
<a name="ln-5913"></a>
<a name="ln-5914"></a><span class="k">            </span><span class="n">InletNodeNotControlled</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5915"></a>          <span class="c">!  CALL CheckCoilWaterInletNode(UnitarySystem(UnitarySysNum)%CoolCoilFluidInletNode,InletNodeNotControlled)</span>
<a name="ln-5916"></a>            <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">InletNodeNotControlled</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5917"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5918"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ControllerTypes</span><span class="p">(</span><span class="n">ControllerSimple_Type</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; found for &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5919"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoolingCoilName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.&quot;&#39;</span><span class="p">)</span>
<a name="ln-5920"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...water coil controllers are not used with &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5921"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">))</span>
<a name="ln-5922"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5923"></a>            <span class="k">END IF</span>
<a name="ln-5924"></a>
<a name="ln-5925"></a>            <span class="c">! Get the Cooling Coil chilled water max volume flow rate</span>
<a name="ln-5926"></a>            <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5927"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolCoilFluidFlow</span> <span class="o">=</span> <span class="n">GetCoilMaxWaterFlowRate</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5928"></a>                                           <span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5929"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolCoilFluidFlow</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5930"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RequestAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5931"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5932"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5933"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5934"></a>              <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5935"></a>            <span class="k">END IF</span>
<a name="ln-5936"></a>
<a name="ln-5937"></a>            <span class="c">! Get the Cooling Coil Inlet Node</span>
<a name="ln-5938"></a>            <span class="n">CoolingCoilInletNode</span> <span class="o">=</span>  <span class="n">GetWaterCoilInletNode</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5939"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5940"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5941"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5942"></a>              <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5943"></a>            <span class="k">END IF</span>
<a name="ln-5944"></a>
<a name="ln-5945"></a>            <span class="c">! Get the Cooling Coil Outlet Node</span>
<a name="ln-5946"></a>            <span class="n">CoolingCoilOutletNode</span> <span class="o">=</span> <span class="n">GetWaterCoilOutletNode</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5947"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5948"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5949"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5950"></a>              <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5951"></a>            <span class="k">END IF</span>
<a name="ln-5952"></a><span class="k">          END IF</span>
<a name="ln-5953"></a><span class="k">        </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_CoolingWaterToAirHPSimple</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5954"></a><span class="k">            CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-5955"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5956"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5957"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5958"></a>            <span class="k">ELSE</span> <span class="c">! mine data from Cooling coil object</span>
<a name="ln-5959"></a>
<a name="ln-5960"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5961"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilAvailSchPtr</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-5962"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5963"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5964"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5965"></a>                  <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5966"></a>                <span class="k">END IF</span>
<a name="ln-5967"></a>
<a name="ln-5968"></a><span class="k">                </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span> <span class="o">=</span>  <span class="n">GetWtoAHPSimpleCoilIndex</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5969"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5970"></a><span class="k">                  CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5971"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iCoolingCoilNameAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span> <span class="p">&amp;</span>
<a name="ln-5972"></a>                                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoolingCoilName</span><span class="p">))</span>
<a name="ln-5973"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5974"></a>                  <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5975"></a>                <span class="k">END IF</span>
<a name="ln-5976"></a>
<a name="ln-5977"></a>                <span class="c">! Get the Cooling Coil Inlet Node</span>
<a name="ln-5978"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5979"></a>                <span class="n">CoolingCoilInletNode</span> <span class="o">=</span> <span class="n">GetWtoAHPSimpleCoilInletNode</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span> <span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5980"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5981"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5982"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5983"></a>                  <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5984"></a>                <span class="k">END IF</span>
<a name="ln-5985"></a>
<a name="ln-5986"></a>                <span class="c">! Get the Cooling Coil Outlet Node</span>
<a name="ln-5987"></a>                <span class="n">CoolingCoilOutletNode</span> <span class="o">=</span> <span class="n">GetWtoAHPSimpleCoilOutletNode</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span> <span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-5988"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5989"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5990"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5991"></a>                  <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5992"></a>                <span class="k">END IF</span>
<a name="ln-5993"></a>
<a name="ln-5994"></a><span class="c">!                IF(UnitarySystem(UnitarySysNum)%MaxCoolCoilFluidFlow == Autosize) &amp;</span>
<a name="ln-5995"></a><span class="c">!                     UnitarySystem(UnitarySysNum)%RequestAutosize = .TRUE.</span>
<a name="ln-5996"></a>
<a name="ln-5997"></a>            <span class="k">END IF</span>
<a name="ln-5998"></a>
<a name="ln-5999"></a><span class="k">            IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6000"></a><span class="k">              IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6001"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWaterToAirHPVSEquationFit</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6002"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWaterToAirHPSimple</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6003"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_MultiSpeedHeating</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6004"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_HeatingEmpirical</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6005"></a><span class="k">                </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatPump</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6006"></a>              <span class="k">END IF</span>
<a name="ln-6007"></a><span class="k">            END IF</span>
<a name="ln-6008"></a>
<a name="ln-6009"></a><span class="k">        </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_CoolingWaterToAirHP</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6010"></a><span class="k">            CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-6011"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6012"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6013"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6014"></a>            <span class="k">ELSE</span> <span class="c">! mine data from Cooling coil object</span>
<a name="ln-6015"></a>
<a name="ln-6016"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6017"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilAvailSchPtr</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-6018"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6019"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6020"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6021"></a>                  <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6022"></a>                <span class="k">END IF</span>
<a name="ln-6023"></a>
<a name="ln-6024"></a><span class="k">                </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span> <span class="o">=</span>  <span class="n">GetWtoAHPCoilIndex</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span> <span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-6025"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6026"></a><span class="k">                  CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6027"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iCoolingCoilNameAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span> <span class="p">&amp;</span>
<a name="ln-6028"></a>                                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoolingCoilName</span><span class="p">))</span>
<a name="ln-6029"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6030"></a>                  <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6031"></a>                <span class="k">END IF</span>
<a name="ln-6032"></a>
<a name="ln-6033"></a>                <span class="c">! Get the Cooling Coil Inlet Node</span>
<a name="ln-6034"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6035"></a>                <span class="n">CoolingCoilInletNode</span> <span class="o">=</span> <span class="n">GetWtoAHPCoilInletNode</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span> <span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-6036"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6037"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6038"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6039"></a>                  <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6040"></a>                <span class="k">END IF</span>
<a name="ln-6041"></a>
<a name="ln-6042"></a>                <span class="c">! Get the Cooling Coil Outlet Node</span>
<a name="ln-6043"></a>                <span class="n">CoolingCoilOutletNode</span> <span class="o">=</span> <span class="n">GetWtoAHPCoilOutletNode</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span> <span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-6044"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6045"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6046"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6047"></a>                  <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6048"></a>                <span class="k">END IF</span>
<a name="ln-6049"></a>
<a name="ln-6050"></a><span class="c">!                IF(UnitarySystem(UnitarySysNum)%MaxCoolCoilFluidFlow == Autosize) &amp;</span>
<a name="ln-6051"></a><span class="c">!                     UnitarySystem(UnitarySysNum)%RequestAutosize = .TRUE.</span>
<a name="ln-6052"></a>
<a name="ln-6053"></a>            <span class="k">END IF</span>
<a name="ln-6054"></a>
<a name="ln-6055"></a><span class="k">            IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6056"></a><span class="k">              IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6057"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWaterToAirHPVSEquationFit</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6058"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWaterToAirHPSimple</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6059"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_MultiSpeedHeating</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6060"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_HeatingEmpirical</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6061"></a><span class="k">                </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatPump</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6062"></a>              <span class="k">END IF</span>
<a name="ln-6063"></a><span class="k">            END IF</span>
<a name="ln-6064"></a>
<a name="ln-6065"></a><span class="k">        ELSE</span> <span class="c">! IF(.NOT. lAlphaBlanks(16))THEN</span>
<a name="ln-6066"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6067"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iCoolingCoilTypeAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6068"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iCoolingCoilTypeAlphaNum</span><span class="p">)))</span>
<a name="ln-6069"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6070"></a>        <span class="k">END IF</span>
<a name="ln-6071"></a>
<a name="ln-6072"></a><span class="k">        IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_MultiSpeedCooling</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6073"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MultiSpeedCoolingCoil</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6074"></a>        <span class="n">ELSEIF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_CoolingWaterToAirHPVSEquationFit</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6075"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_CoolingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6076"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">VarSpeedCoolingCoil</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6077"></a>        <span class="k">END IF</span>
<a name="ln-6078"></a>
<a name="ln-6079"></a><span class="k">        IF</span><span class="p">(</span><span class="n">NodeHasSPMCtrlVarType</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemOutletNodeNum</span><span class="p">,</span> <span class="n">iCtrlVarType_Temp</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-6080"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SystemCoolControlNodeNum</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemOutletNodeNum</span>
<a name="ln-6081"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">NodeHasSPMCtrlVarType</span><span class="p">(</span><span class="n">CoolingCoilOutletNode</span><span class="p">,</span> <span class="n">iCtrlVarType_Temp</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-6082"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SystemCoolControlNodeNum</span> <span class="o">=</span> <span class="n">CoolingCoilOutletNode</span>
<a name="ln-6083"></a>
<a name="ln-6084"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilInletNodeNum</span>  <span class="o">=</span> <span class="n">CoolingCoilInletNode</span>
<a name="ln-6085"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilOutletNodeNum</span> <span class="o">=</span> <span class="n">CoolingCoilOutletNode</span>
<a name="ln-6086"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilName</span>       <span class="o">=</span> <span class="n">CoolingCoilName</span>
<a name="ln-6087"></a>
<a name="ln-6088"></a>        <span class="k">END IF</span>
<a name="ln-6089"></a>
<a name="ln-6090"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWaterToAirHPSimple</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6091"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_CoolingWaterToAirHPSimple</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6092"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">WaterCyclingMode</span> <span class="o">=</span> <span class="n">WaterCycling</span>
<a name="ln-6093"></a>          <span class="k">CALL </span><span class="n">SetSimpleWSHPData</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6094"></a>                                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">WaterCyclingMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6095"></a>                                 <span class="n">CompanionHeatingCoilNum</span><span class="o">=</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">)</span>
<a name="ln-6096"></a>        <span class="k">END IF</span>
<a name="ln-6097"></a>
<a name="ln-6098"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWaterToAirHPVSEquationFit</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6099"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_CoolingWaterToAirHPVSEquationFit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6100"></a><span class="k">          CALL </span><span class="n">SetVarSpeedCoilData</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6101"></a>                                <span class="n">CompanionHeatingCoilNum</span><span class="o">=</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">)</span>
<a name="ln-6102"></a>        <span class="k">END IF</span>
<a name="ln-6103"></a>
<a name="ln-6104"></a>        <span class="c">! Add cooling coil to component sets array</span>
<a name="ln-6105"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilExists</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6106"></a><span class="k">          IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">CoilDX_MultiSpeedCooling</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6107"></a><span class="k">            CALL </span><span class="n">SetUpCompSets</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span> <span class="n">Alphas</span><span class="p">(</span><span class="n">iNameAlphaNum</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-6108"></a>                               <span class="n">Alphas</span><span class="p">(</span><span class="n">iCoolingCoilTypeAlphaNum</span><span class="p">),</span> <span class="n">Alphas</span><span class="p">(</span><span class="n">iCoolingCoilNameAlphaNum</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-6109"></a>                               <span class="n">NodeID</span><span class="p">(</span><span class="n">CoolingCoilInletNode</span><span class="p">),</span> <span class="n">NodeID</span><span class="p">(</span><span class="n">CoolingCoilOutletNode</span><span class="p">))</span>
<a name="ln-6110"></a>          <span class="k">ELSE</span>
<a name="ln-6111"></a><span class="k">            CALL </span><span class="n">SetUpCompSets</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span> <span class="n">Alphas</span><span class="p">(</span><span class="n">iNameAlphaNum</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-6112"></a>                               <span class="n">Alphas</span><span class="p">(</span><span class="n">iCoolingCoilTypeAlphaNum</span><span class="p">),</span> <span class="n">Alphas</span><span class="p">(</span><span class="n">iCoolingCoilNameAlphaNum</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-6113"></a>                               <span class="s1">&#39;UNDEFINED&#39;</span><span class="p">,</span> <span class="s1">&#39;UNDEFINED&#39;</span><span class="p">)</span>
<a name="ln-6114"></a>          <span class="k">END IF</span>
<a name="ln-6115"></a><span class="k">        END IF</span>
<a name="ln-6116"></a>        <span class="c">! Run as 100% DOAS DX coil</span>
<a name="ln-6117"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">iDOASDXCoilAlphaNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">NumAlphas</span> <span class="o">&lt;</span> <span class="n">iDOASDXCoilAlphaNum</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6118"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ISHundredPercentDOASDXCoil</span><span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6119"></a>        <span class="k">ELSE</span>
<a name="ln-6120"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iDOASDXCoilAlphaNum</span><span class="p">),</span><span class="s1">&#39;Yes&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6121"></a><span class="k">              </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ISHundredPercentDOASDXCoil</span><span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6122"></a>            <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iDOASDXCoilAlphaNum</span><span class="p">),</span><span class="s1">&#39; &#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6123"></a><span class="k">              </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ISHundredPercentDOASDXCoil</span><span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6124"></a>            <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iDOASDXCoilAlphaNum</span><span class="p">),</span><span class="s1">&#39;No&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6125"></a><span class="k">              </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ISHundredPercentDOASDXCoil</span><span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6126"></a>            <span class="k">ELSE</span>
<a name="ln-6127"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6128"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid entry for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iDOASDXCoilAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; :&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6129"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iDOASDXCoilAlphaNum</span><span class="p">)))</span>
<a name="ln-6130"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Must be Yes or No.&#39;</span><span class="p">)</span>
<a name="ln-6131"></a>            <span class="k">END IF</span>
<a name="ln-6132"></a><span class="k">        END IF</span>
<a name="ln-6133"></a>
<a name="ln-6134"></a>        <span class="c">! considered as as 100% DOAS DX cooling coil</span>
<a name="ln-6135"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ISHundredPercentDOASDXCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6136"></a>           <span class="c">! set the system DX Coil application type to the child DX coil</span>
<a name="ln-6137"></a>           <span class="k">CALL </span><span class="n">SetDXCoilTypeData</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilName</span><span class="p">)</span>
<a name="ln-6138"></a>        <span class="k">END IF</span>
<a name="ln-6139"></a>        <span class="c">! DOAS DX Cooling Coil Leaving Minimum Air Temperature</span>
<a name="ln-6140"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">NumNumbers</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6141"></a><span class="k">          IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lNumericBlanks</span><span class="p">(</span><span class="n">iDOASDXMinTempNumericNum</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-6142"></a><span class="k">             </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DOASDXCoolingCoilMinTout</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="n">iDOASDXMinTempNumericNum</span><span class="p">)</span>
<a name="ln-6143"></a>          <span class="k">END IF</span>
<a name="ln-6144"></a><span class="k">        END IF</span>
<a name="ln-6145"></a>
<a name="ln-6146"></a>        <span class="c">!Get Latent Load Control flag</span>
<a name="ln-6147"></a>        <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">iRunOnLatentLoadAlphaNum</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-6148"></a><span class="k">          IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iRunOnLatentLoadAlphaNum</span><span class="p">),</span><span class="s1">&#39;SensibleOnlyLoadControl&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6149"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RunOnSensibleLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6150"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RunOnLatentLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6151"></a>          <span class="k">ELSE IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iRunOnLatentLoadAlphaNum</span><span class="p">),</span><span class="s1">&#39;LatentOnlyLoadControl&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-6152"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RunOnSensibleLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6153"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RunOnLatentLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6154"></a>          <span class="k">ELSE IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iRunOnLatentLoadAlphaNum</span><span class="p">),</span><span class="s1">&#39;LatentOrSensibleLoadControl&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-6155"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RunOnSensibleLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6156"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RunOnLatentLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6157"></a>          <span class="k">ELSE IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iRunOnLatentLoadAlphaNum</span><span class="p">),</span><span class="s1">&#39;LatentWithSensibleLoadControl&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-6158"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RunOnSensibleLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6159"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RunOnLatentLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6160"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RunOnLatentOnlyWithSensible</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6161"></a>          <span class="k">ELSE</span>
<a name="ln-6162"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6163"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid entry for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iRunOnLatentLoadAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; :&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6164"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iRunOnLatentLoadAlphaNum</span><span class="p">)))</span>
<a name="ln-6165"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Must be SensibleOnlyLoadControl, LatentOnlyLoadControl,&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6166"></a>                                   <span class="s1">&#39; LatentOrSensibleLoadControl, or LatentWithSensibleLoadControl.&#39;</span><span class="p">)</span>
<a name="ln-6167"></a>          <span class="k">END IF</span>
<a name="ln-6168"></a><span class="k">        END IF</span>
<a name="ln-6169"></a>
<a name="ln-6170"></a>        <span class="c">!Get reheat coil data if humidistat is used</span>
<a name="ln-6171"></a>        <span class="n">SuppHeatCoilType</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="n">iSuppHeatCoilTypeAlphaNum</span><span class="p">)</span>
<a name="ln-6172"></a>        <span class="n">SuppHeatCoilName</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="n">iSuppHeatCoilNameAlphaNum</span><span class="p">)</span>
<a name="ln-6173"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span> <span class="o">=</span> <span class="n">SuppHeatCoilName</span>
<a name="ln-6174"></a>        <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6175"></a>
<a name="ln-6176"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">SuppHeatCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6177"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType_Num</span> <span class="o">=</span> <span class="n">Coil_HeatingWater</span>
<a name="ln-6178"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">SuppHeatCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:Steam&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6179"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType_Num</span> <span class="o">=</span> <span class="n">Coil_HeatingSteam</span>
<a name="ln-6180"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">SuppHeatCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:Gas&#39;</span><span class="p">)</span>          <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6181"></a>                <span class="n">SameString</span><span class="p">(</span><span class="n">SuppHeatCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:Electric&#39;</span><span class="p">)</span>     <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6182"></a>                <span class="n">SameString</span><span class="p">(</span><span class="n">SuppHeatCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:DesuperHeater&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6183"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType_Num</span> <span class="o">=</span> <span class="n">GetHeatingCoilTypeNum</span><span class="p">(</span><span class="n">SuppHeatCoilType</span><span class="p">,</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-6184"></a>        <span class="k">END IF</span>
<a name="ln-6185"></a>
<a name="ln-6186"></a><span class="k">        IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">iSuppHeatCoilTypeAlphaNum</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-6187"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilExists</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6188"></a>
<a name="ln-6189"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingGas</span>          <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6190"></a>              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingElectric</span>     <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6191"></a>              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingDesuperheater</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6192"></a>
<a name="ln-6193"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType_Num</span> <span class="o">=</span> <span class="n">GetHeatingCoilTypeNum</span><span class="p">(</span><span class="n">SuppHeatCoilType</span><span class="p">,</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-6194"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6195"></a><span class="k">               CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6196"></a>               <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6197"></a>            <span class="k">ELSE</span>
<a name="ln-6198"></a>
<a name="ln-6199"></a><span class="k">              CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">SuppHeatCoilType</span><span class="p">,</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6200"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-6201"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6202"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6203"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6204"></a>
<a name="ln-6205"></a>              <span class="k">ELSE</span> <span class="c">! mine data from reheat coil</span>
<a name="ln-6206"></a>
<a name="ln-6207"></a>                <span class="c">! Get the heating coil index</span>
<a name="ln-6208"></a>                <span class="k">CALL </span><span class="n">GetHeatingCoilIndex</span><span class="p">(</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">)</span>
<a name="ln-6209"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6210"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6211"></a>                  <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6212"></a>                <span class="k">END IF</span>
<a name="ln-6213"></a>
<a name="ln-6214"></a>                <span class="c">! Get the design supplemental heating capacity</span>
<a name="ln-6215"></a>                <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6216"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-6217"></a>                    <span class="n">GetHeatingCoilCapacity</span><span class="p">(</span><span class="n">SuppHeatCoilType</span><span class="p">,</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-6218"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-6219"></a>                     <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RequestAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6220"></a>
<a name="ln-6221"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6222"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6223"></a>                  <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6224"></a>                <span class="k">END IF</span>
<a name="ln-6225"></a>
<a name="ln-6226"></a>                <span class="c">! Get the Reheat Coil Inlet Node</span>
<a name="ln-6227"></a>                <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6228"></a>                <span class="n">SupHeatCoilInletNode</span> <span class="o">=</span> <span class="n">GetHeatingCoilInletNode</span><span class="p">(</span><span class="n">SuppHeatCoilType</span><span class="p">,</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-6229"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6230"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6231"></a>                  <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6232"></a>                <span class="k">END IF</span>
<a name="ln-6233"></a>
<a name="ln-6234"></a>                <span class="c">! Get the Reheat Coil Outlet Node</span>
<a name="ln-6235"></a>                <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6236"></a>                <span class="n">SupHeatCoilOutletNode</span> <span class="o">=</span> <span class="n">GetHeatingCoilOutletNode</span><span class="p">(</span><span class="n">SuppHeatCoilType</span><span class="p">,</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-6237"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6238"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6239"></a>                  <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6240"></a>                <span class="k">END IF</span>
<a name="ln-6241"></a>
<a name="ln-6242"></a><span class="k">              END IF</span>  <span class="c">! IF (IsNotOK) THEN</span>
<a name="ln-6243"></a>            <span class="k">END IF</span>
<a name="ln-6244"></a>
<a name="ln-6245"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilAirInletNode</span> <span class="o">=</span> <span class="n">SupHeatCoilInletNode</span>
<a name="ln-6246"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilAirOutletNode</span> <span class="o">=</span> <span class="n">SupHeatCoilOutletNode</span>
<a name="ln-6247"></a>
<a name="ln-6248"></a>          <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWater</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6249"></a>
<a name="ln-6250"></a><span class="k">            CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">SuppHeatCoilType</span><span class="p">,</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-6251"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6252"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6253"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6254"></a>            <span class="k">ELSE</span> <span class="c">! mine data from heating coil object</span>
<a name="ln-6255"></a>
<a name="ln-6256"></a>                <span class="c">! Get the Heating Coil water Inlet or control Node number</span>
<a name="ln-6257"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6258"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilFluidInletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-6259"></a>                      <span class="n">GetCoilWaterInletNode</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-6260"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6261"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6262"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6263"></a>                <span class="k">END IF</span>
<a name="ln-6264"></a>
<a name="ln-6265"></a>                <span class="c">! Get the ReHeat Coil hot water max volume flow rate</span>
<a name="ln-6266"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6267"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">=</span> <span class="n">GetCoilMaxWaterFlowRate</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6268"></a>                                                           <span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-6269"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-6270"></a>                     <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RequestAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6271"></a>
<a name="ln-6272"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6273"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6274"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6275"></a>                <span class="k">END IF</span>
<a name="ln-6276"></a>
<a name="ln-6277"></a>                <span class="c">! Get the ReHeat Coil Inlet Node</span>
<a name="ln-6278"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6279"></a>                <span class="n">SupHeatCoilInletNode</span> <span class="o">=</span>  <span class="n">GetWaterCoilInletNode</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-6280"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilAirInletNode</span> <span class="o">=</span> <span class="n">SupHeatCoilInletNode</span>
<a name="ln-6281"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6282"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6283"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6284"></a>                <span class="k">END IF</span>
<a name="ln-6285"></a>
<a name="ln-6286"></a>                <span class="c">! Get the ReHeat Coil Outlet Node</span>
<a name="ln-6287"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6288"></a>                <span class="n">SupHeatCoilOutletNode</span> <span class="o">=</span> <span class="n">GetWaterCoilOutletNode</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-6289"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilAirOutletNode</span> <span class="o">=</span> <span class="n">SupHeatCoilOutletNode</span>
<a name="ln-6290"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6291"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6292"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6293"></a>                <span class="k">END IF</span>
<a name="ln-6294"></a>
<a name="ln-6295"></a><span class="c">!                IF(UnitarySystem(UnitarySysNum)%MaxSuppCoilFluidFlow == Autosize) &amp;</span>
<a name="ln-6296"></a><span class="c">!                   UnitarySystem(UnitarySysNum)%RequestAutosize = .TRUE.</span>
<a name="ln-6297"></a><span class="c">!                IF(UnitarySystem(UnitarySysNum)%DesignSuppHeatingCapacity == Autosize) &amp;</span>
<a name="ln-6298"></a><span class="c">!                   UnitarySystem(UnitarySysNum)%RequestAutosize = .TRUE.</span>
<a name="ln-6299"></a>
<a name="ln-6300"></a>            <span class="k">END IF</span>
<a name="ln-6301"></a>
<a name="ln-6302"></a><span class="k">          </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingSteam</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6303"></a>
<a name="ln-6304"></a><span class="k">            CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">SuppHeatCoilType</span><span class="p">,</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-6305"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6306"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6307"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6308"></a>            <span class="k">ELSE</span> <span class="c">! mine data from heating coil object</span>
<a name="ln-6309"></a>
<a name="ln-6310"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6311"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span> <span class="o">=</span> <span class="n">GetSTeamCoilIndex</span><span class="p">(</span><span class="s1">&#39;COIL:HEATING:STEAM&#39;</span><span class="p">,</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-6312"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6313"></a><span class="k">                    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6314"></a>                    <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iSuppHeatCoilNameAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span> <span class="p">&amp;</span>
<a name="ln-6315"></a>                                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SuppHeatCoilName</span><span class="p">))</span>
<a name="ln-6316"></a>                    <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6317"></a>                <span class="k">END IF</span>
<a name="ln-6318"></a>
<a name="ln-6319"></a>                <span class="c">! Get the Heating Coil steam inlet node number</span>
<a name="ln-6320"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6321"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilFluidInletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-6322"></a>                    <span class="n">GetSteamCoilSteamInletNode</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Steam&#39;</span><span class="p">,</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-6323"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6324"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6325"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6326"></a>                <span class="k">END IF</span>
<a name="ln-6327"></a>
<a name="ln-6328"></a>                <span class="c">! Get the Heating Coil steam max volume flow rate</span>
<a name="ln-6329"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-6330"></a>                    <span class="n">GetCoilMaxSteamFlowRate</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-6331"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-6332"></a>                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RequestAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6333"></a>
<a name="ln-6334"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6335"></a><span class="k">                   </span><span class="n">SteamIndex</span> <span class="o">=</span> <span class="mi">0</span>      <span class="c">! Function GetSatDensityRefrig will look up steam index if 0 is passed</span>
<a name="ln-6336"></a>                   <span class="n">SteamDensity</span><span class="o">=</span><span class="n">GetSatDensityRefrig</span><span class="p">(</span><span class="s2">&quot;STEAM&quot;</span><span class="p">,</span><span class="n">TempSteamIn</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">SteamIndex</span><span class="p">,</span><span class="s1">&#39;GetAirLoopHVACHeatCoolInput&#39;</span><span class="p">)</span>
<a name="ln-6337"></a>                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-6338"></a>                                <span class="n">GetCoilMaxSteamFlowRate</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="o">*</span> <span class="n">SteamDensity</span>
<a name="ln-6339"></a>                <span class="k">END IF</span>
<a name="ln-6340"></a>
<a name="ln-6341"></a>                <span class="c">! Get the Heating Coil Inlet Node</span>
<a name="ln-6342"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6343"></a>                <span class="n">SupHeatCoilInletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-6344"></a>                         <span class="n">GetSteamCoilAirInletNode</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-6345"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilAirInletNode</span> <span class="o">=</span> <span class="n">SupHeatCoilInletNode</span>
<a name="ln-6346"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6347"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6348"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6349"></a>                <span class="k">END IF</span>
<a name="ln-6350"></a>
<a name="ln-6351"></a>                <span class="c">! Get the Heating Coil Outlet Node</span>
<a name="ln-6352"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6353"></a>                <span class="n">SupHeatCoilOutletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-6354"></a>                         <span class="n">GetSteamCoilAirOutletNode</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-6355"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilAirOutletNode</span> <span class="o">=</span> <span class="n">SupHeatCoilOutletNode</span>
<a name="ln-6356"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6357"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6358"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6359"></a>                <span class="k">END IF</span>
<a name="ln-6360"></a>
<a name="ln-6361"></a><span class="c">!                IF(UnitarySystem(UnitarySysNum)%DesignSuppHeatingCapacity == Autosize) &amp;</span>
<a name="ln-6362"></a><span class="c">!                   UnitarySystem(UnitarySysNum)%RequestAutosize = .TRUE.</span>
<a name="ln-6363"></a>
<a name="ln-6364"></a>            <span class="k">END IF</span>
<a name="ln-6365"></a>
<a name="ln-6366"></a><span class="k">          ELSE</span>  <span class="c">! Illegal reheating coil type</span>
<a name="ln-6367"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6368"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iSuppHeatCoilTypeAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6369"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iSuppHeatCoilTypeAlphaNum</span><span class="p">)))</span>
<a name="ln-6370"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6371"></a>          <span class="k">END IF</span> <span class="c">! IF (UnitarySystem(UnitarySysNum)%SuppHeatCoilType_Num == Coil_HeatingGas .OR. &amp;, etc.</span>
<a name="ln-6372"></a>
<a name="ln-6373"></a>        <span class="k">END IF</span> <span class="c">! IF(.NOT. lAlphaBlanks(iSuppHeatCoilTypeAlphaNum))THEN</span>
<a name="ln-6374"></a>
<a name="ln-6375"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">NodeHasSPMCtrlVarType</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemOutletNodeNum</span><span class="p">,</span> <span class="n">iCtrlVarType_Temp</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-6376"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatControlNodeNum</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemOutletNodeNum</span>
<a name="ln-6377"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">NodeHasSPMCtrlVarType</span><span class="p">(</span><span class="n">SupHeatCoilOutletNode</span><span class="p">,</span> <span class="n">iCtrlVarType_Temp</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-6378"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatControlNodeNum</span> <span class="o">=</span> <span class="n">SupHeatCoilOutletNode</span>
<a name="ln-6379"></a>
<a name="ln-6380"></a>        <span class="c">! Add supplemental heating coil to component sets array</span>
<a name="ln-6381"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilExists</span><span class="p">)</span><span class="k">CALL </span><span class="n">SetUpCompSets</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span> <span class="n">Alphas</span><span class="p">(</span><span class="n">iNameAlphaNum</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-6382"></a>                             <span class="n">Alphas</span><span class="p">(</span><span class="n">iSuppHeatCoilTypeAlphaNum</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iSuppHeatCoilNameAlphaNum</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-6383"></a>                             <span class="n">NodeID</span><span class="p">(</span><span class="n">SupHeatCoilInletNode</span><span class="p">),</span><span class="n">NodeID</span><span class="p">(</span><span class="n">SupHeatCoilOutletNode</span><span class="p">))</span>
<a name="ln-6384"></a>
<a name="ln-6385"></a>        <span class="n">TotalZonesOnAirLoop</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-6386"></a>        <span class="n">TotalFloorAreaOnAirLoop</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6387"></a>        <span class="n">AirLoopNumber</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-6388"></a>
<a name="ln-6389"></a> <span class="c">!***... only need to do this for load based control?</span>
<a name="ln-6390"></a>        <span class="c">! Get the node number for the zone with the thermostat ! what if ControlZoneNum does = 0 if it&#39;s an OA sys?</span>
<a name="ln-6391"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span> <span class="o">&gt;</span>  <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6392"></a><span class="k">          </span><span class="n">AirNodeFound</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6393"></a>          <span class="n">AirLoopFound</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6394"></a>          <span class="k">DO </span><span class="n">ControlledZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-6395"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ControlledZoneNum</span><span class="p">)%</span><span class="n">ActualZoneNum</span> <span class="o">/=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-6396"></a><span class="c">!             Find the controlled zone number for the specified thermostat location</span>
<a name="ln-6397"></a>              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NodeNumofControlledZone</span><span class="o">=</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ControlledZoneNum</span><span class="p">)%</span><span class="n">ZoneNode</span>
<a name="ln-6398"></a><span class="c">!             Determine if system is on air loop served by the thermostat location specified</span>
<a name="ln-6399"></a>              <span class="n">AirLoopNumber</span> <span class="o">=</span> <span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ControlledZoneNum</span><span class="p">)%</span><span class="n">AirLoopNum</span>
<a name="ln-6400"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">AirLoopNumber</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6401"></a><span class="k">                DO </span><span class="n">BranchNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirLoopNumber</span><span class="p">)%</span><span class="n">NumBranches</span>
<a name="ln-6402"></a>                  <span class="k">DO </span><span class="n">CompNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirLoopNumber</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">BranchNum</span><span class="p">)%</span><span class="n">TotalComponents</span>
<a name="ln-6403"></a>                    <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirLoopNumber</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">BranchNum</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6404"></a>                             <span class="n">Alphas</span><span class="p">(</span><span class="n">iNameAlphaNum</span><span class="p">))</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6405"></a>                       <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirLoopNumber</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">BranchNum</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">TypeOf</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6406"></a>                             <span class="n">CurrentModuleObject</span><span class="p">))</span><span class="k">CYCLE</span>
<a name="ln-6407"></a><span class="k">                    </span><span class="n">AirLoopFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6408"></a>                    <span class="k">EXIT</span>
<a name="ln-6409"></a><span class="k">                  END DO</span>
<a name="ln-6410"></a><span class="k">                  IF</span><span class="p">(</span><span class="n">AirLoopFound</span><span class="p">)</span><span class="k">EXIT</span>
<a name="ln-6411"></a><span class="k">                END DO</span>
<a name="ln-6412"></a><span class="k">                DO </span><span class="n">TstatZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumTempControlledZones</span>
<a name="ln-6413"></a>                  <span class="k">IF</span><span class="p">(</span><span class="n">TempControlledZone</span><span class="p">(</span><span class="n">TstatZoneNum</span><span class="p">)%</span><span class="n">ActualZoneNum</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)</span><span class="k">CYCLE</span>
<a name="ln-6414"></a><span class="k">                  </span><span class="n">AirNodeFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6415"></a>                <span class="k">END DO</span>
<a name="ln-6416"></a><span class="k">                DO </span><span class="n">TstatZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumComfortControlledZones</span>
<a name="ln-6417"></a>                  <span class="k">IF</span><span class="p">(</span><span class="n">ComfortControlledZone</span><span class="p">(</span><span class="n">TstatZoneNum</span><span class="p">)%</span><span class="n">ActualZoneNum</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)</span><span class="k">CYCLE</span>
<a name="ln-6418"></a><span class="k">                  </span><span class="n">AirNodeFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6419"></a>                <span class="k">END DO</span>
<a name="ln-6420"></a><span class="k">              END IF</span>
<a name="ln-6421"></a><span class="k">            EXIT</span>
<a name="ln-6422"></a><span class="k">          END DO</span>
<a name="ln-6423"></a><span class="k">          IF</span><span class="p">(</span><span class="n">AirLoopNumber</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6424"></a><span class="k">            DO </span><span class="n">ControlledZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-6425"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ControlledZoneNum</span><span class="p">)%</span><span class="n">AirLoopNum</span> <span class="o">==</span> <span class="n">AirLoopNumber</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6426"></a><span class="k">                </span><span class="n">TotalZonesOnAirLoop</span> <span class="o">=</span> <span class="n">TotalZonesOnAirLoop</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-6427"></a>                <span class="n">TotalFloorAreaOnAirLoop</span> <span class="o">=</span> <span class="n">TotalFloorAreaOnAirLoop</span><span class="o">+</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ControlledZoneNum</span><span class="p">)%</span><span class="n">ActualZoneNum</span><span class="p">)%</span><span class="n">FloorArea</span>
<a name="ln-6428"></a>              <span class="k">END IF</span>
<a name="ln-6429"></a><span class="k">            END DO</span>
<a name="ln-6430"></a><span class="k">          ELSE</span>
<a name="ln-6431"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6432"></a><span class="c">!            IF(ALLOCATED(OutsideAirSys))THEN</span>
<a name="ln-6433"></a>              <span class="k">DO </span><span class="n">OASysNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumOASystems</span>
<a name="ln-6434"></a>                <span class="k">DO </span><span class="n">OACompNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">OutsideAirSys</span><span class="p">(</span><span class="n">OASysNum</span><span class="p">)%</span><span class="n">NumComponents</span>
<a name="ln-6435"></a>                  <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">OutsideAirSys</span><span class="p">(</span><span class="n">OASysNum</span><span class="p">)%</span><span class="n">ComponentName</span><span class="p">(</span><span class="n">OACompNum</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-6436"></a>                           <span class="n">Alphas</span><span class="p">(</span><span class="n">iNameAlphaNum</span><span class="p">))</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6437"></a>                     <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">OutsideAirSys</span><span class="p">(</span><span class="n">OASysNum</span><span class="p">)%</span><span class="n">ComponentType</span><span class="p">(</span><span class="n">OACompNum</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-6438"></a>                           <span class="n">CurrentModuleObject</span><span class="p">))</span><span class="k">CYCLE</span>
<a name="ln-6439"></a><span class="k">                  </span><span class="n">AirLoopFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6440"></a>                  <span class="n">AirLoopNumber</span> <span class="o">=</span> <span class="n">OASysNum</span>
<a name="ln-6441"></a>                  <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">AirLoopEquipment</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6442"></a>                  <span class="k">EXIT</span>
<a name="ln-6443"></a><span class="k">                END DO</span>
<a name="ln-6444"></a><span class="k">                IF</span><span class="p">(</span><span class="n">AirLoopFound</span><span class="p">)</span><span class="k">EXIT</span>
<a name="ln-6445"></a><span class="k">              END DO</span>
<a name="ln-6446"></a><span class="k">            END IF</span>
<a name="ln-6447"></a><span class="k">          END IF</span>
<a name="ln-6448"></a><span class="k">        ELSE</span> <span class="c">! this works IF it&#39;s zone equipment, but what IF it&#39;s air loop equipment?</span>
<a name="ln-6449"></a>          <span class="n">AirLoopScan</span><span class="p">:</span> <span class="k">DO </span><span class="n">AirLoopNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumPrimaryAirSys</span>
<a name="ln-6450"></a>            <span class="n">BranchScan</span><span class="p">:</span> <span class="k">DO </span><span class="n">BranchNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">NumBranches</span>
<a name="ln-6451"></a>              <span class="n">CompScan</span><span class="p">:</span> <span class="k">DO </span><span class="n">CompNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">BranchNum</span><span class="p">)%</span><span class="n">TotalComponents</span>
<a name="ln-6452"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">BranchNum</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="n">Alphas</span><span class="p">(</span><span class="n">iNameAlphaNum</span><span class="p">))</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6453"></a>                   <span class="n">SameString</span><span class="p">(</span><span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">BranchNum</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">TypeOf</span><span class="p">,</span> <span class="n">CurrentModuleObject</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-6454"></a><span class="k">                  </span><span class="n">AirLoopNumber</span> <span class="o">=</span> <span class="n">AirLoopNum</span>
<a name="ln-6455"></a>                  <span class="n">AirLoopFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6456"></a>                <span class="k">ELSE IF</span><span class="p">(</span><span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">OASysExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6457"></a><span class="k">                  IF</span><span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">OutsideAirSys</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-6458"></a><span class="k">                    </span><span class="n">OASysScan</span><span class="p">:</span> <span class="k">DO </span><span class="n">OASysNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumOASystems</span>
<a name="ln-6459"></a>                      <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">OutsideAirSys</span><span class="p">(</span><span class="n">OASysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6460"></a>                               <span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">BranchNum</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6461"></a>                         <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="s1">&#39;AirloopHVAC:OutdoorAirSystem&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6462"></a>                               <span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">BranchNum</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">TypeOf</span><span class="p">))</span><span class="k">CYCLE</span>
<a name="ln-6463"></a><span class="k">                      DO </span><span class="n">OACompNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">OutsideAirSys</span><span class="p">(</span><span class="n">OASysNum</span><span class="p">)%</span><span class="n">NumComponents</span>
<a name="ln-6464"></a>                        <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">OutsideAirSys</span><span class="p">(</span><span class="n">OASysNum</span><span class="p">)%</span><span class="n">ComponentName</span><span class="p">(</span><span class="n">OACompNum</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-6465"></a>                                 <span class="n">Alphas</span><span class="p">(</span><span class="n">iNameAlphaNum</span><span class="p">))</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6466"></a>                           <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">OutsideAirSys</span><span class="p">(</span><span class="n">OASysNum</span><span class="p">)%</span><span class="n">ComponentType</span><span class="p">(</span><span class="n">OACompNum</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-6467"></a>                                 <span class="n">CurrentModuleObject</span><span class="p">))</span><span class="k">CYCLE</span>
<a name="ln-6468"></a><span class="k">                        </span><span class="n">AirLoopFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6469"></a>                        <span class="n">AirLoopNumber</span> <span class="o">=</span> <span class="n">AirLoopNum</span>
<a name="ln-6470"></a>                        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">AirLoopEquipment</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6471"></a>                        <span class="k">EXIT</span>
<a name="ln-6472"></a><span class="k">                      END DO</span>
<a name="ln-6473"></a><span class="c">!                      IF(AirLoopFound)EXIT OASysScan  WHY aren&#39;t these working? I get a break here in the debugger</span>
<a name="ln-6474"></a>                    <span class="k">END DO </span><span class="n">OASysScan</span>
<a name="ln-6475"></a>                  <span class="k">END IF</span>
<a name="ln-6476"></a><span class="k">                END IF</span>
<a name="ln-6477"></a><span class="c">!                IF(AirLoopFound)EXIT CompScan</span>
<a name="ln-6478"></a>              <span class="k">END DO </span><span class="n">CompScan</span>
<a name="ln-6479"></a><span class="c">!              IF(AirLoopFound)EXIT BranchScan</span>
<a name="ln-6480"></a>            <span class="k">END DO </span><span class="n">BranchScan</span>
<a name="ln-6481"></a><span class="c">!            IF(AirLoopFound)EXIT AirLoopScan</span>
<a name="ln-6482"></a>          <span class="k">END DO </span><span class="n">AirLoopScan</span>
<a name="ln-6483"></a>          <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">AirLoopFound</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6484"></a><span class="k">            DO </span><span class="n">ControlledZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-6485"></a>              <span class="k">DO </span><span class="n">ZoneExhNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ControlledZoneNum</span><span class="p">)%</span><span class="n">NumExhaustNodes</span>
<a name="ln-6486"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ControlledZoneNum</span><span class="p">)%</span><span class="n">ExhaustNode</span><span class="p">(</span><span class="n">ZoneExhNum</span><span class="p">)</span> <span class="o">/=</span> <span class="p">&amp;</span>
<a name="ln-6487"></a>                    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemInletNodeNum</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-6488"></a><span class="c">!               Find the controlled zone number for the specified thermostat location</span>
<a name="ln-6489"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NodeNumofControlledZone</span><span class="o">=</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ControlledZoneNum</span><span class="p">)%</span><span class="n">ZoneNode</span>
<a name="ln-6490"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span> <span class="o">=</span> <span class="n">ControlledZoneNum</span>
<a name="ln-6491"></a>                <span class="n">TotalFloorAreaOnAirLoop</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ControlledZoneNum</span><span class="p">)%</span><span class="n">ActualZoneNum</span><span class="p">)%</span><span class="n">FloorArea</span>
<a name="ln-6492"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">AirLoopEquipment</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6493"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ZoneInletNode</span> <span class="o">=</span> <span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ControlledZoneNum</span><span class="p">)%</span><span class="n">ExhaustNode</span><span class="p">(</span><span class="n">ZoneExhNum</span><span class="p">)</span>
<a name="ln-6494"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ControlledZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6495"></a><span class="k">                  DO </span><span class="n">EquipNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ControlledZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">NumOfEquipTypes</span>
<a name="ln-6496"></a>                    <span class="k">IF</span> <span class="p">((</span><span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ControlledZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">EquipType_Num</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)</span> <span class="o">/=</span> <span class="p">&amp;</span>
<a name="ln-6497"></a>                         <span class="n">ZoneUnitarySystem_Num</span><span class="p">).</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6498"></a>                       <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ControlledZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">EquipName</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)</span> <span class="o">/=</span> <span class="p">&amp;</span>
<a name="ln-6499"></a>                         <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="k">CYCLE</span>
<a name="ln-6500"></a><span class="k">                      </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ZoneSequenceCoolingNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-6501"></a>                            <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ControlledZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">CoolingPriority</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)</span>
<a name="ln-6502"></a>                      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ZoneSequenceHeatingNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-6503"></a>                            <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ControlledZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">HeatingPriority</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)</span>
<a name="ln-6504"></a>                  <span class="k">END DO</span>
<a name="ln-6505"></a><span class="k">                END IF</span>
<a name="ln-6506"></a><span class="k">                EXIT</span>
<a name="ln-6507"></a><span class="k">              END DO</span>
<a name="ln-6508"></a><span class="k">              DO </span><span class="n">ZoneInletNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ControlledZoneNum</span><span class="p">)%</span><span class="n">NumInletNodes</span>
<a name="ln-6509"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ControlledZoneNum</span><span class="p">)%</span><span class="n">InletNode</span><span class="p">(</span><span class="n">ZoneInletNum</span><span class="p">)</span> <span class="o">/=</span> <span class="p">&amp;</span>
<a name="ln-6510"></a>                      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemOutletNodeNum</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-6511"></a><span class="k">                </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">AirLoopEquipment</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6512"></a>                <span class="k">EXIT</span>
<a name="ln-6513"></a><span class="k">              END DO</span>
<a name="ln-6514"></a><span class="k">            END DO</span>
<a name="ln-6515"></a><span class="k">          ELSE</span>
<a name="ln-6516"></a><span class="k">            DO </span><span class="n">ControlledZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-6517"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ControlledZoneNum</span><span class="p">)%</span><span class="n">AirLoopNum</span> <span class="o">==</span> <span class="n">AirLoopNumber</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6518"></a><span class="k">                </span><span class="n">TotalZonesOnAirLoop</span> <span class="o">=</span> <span class="n">TotalZonesOnAirLoop</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-6519"></a>                <span class="n">TotalFloorAreaOnAirLoop</span> <span class="o">=</span> <span class="n">TotalFloorAreaOnAirLoop</span><span class="o">+</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ControlledZoneNum</span><span class="p">)%</span><span class="n">ActualZoneNum</span><span class="p">)%</span><span class="n">FloorArea</span>
<a name="ln-6520"></a>              <span class="k">END IF</span>
<a name="ln-6521"></a><span class="k">            END DO</span>
<a name="ln-6522"></a><span class="k">          END IF</span>
<a name="ln-6523"></a><span class="k">        END IF</span>
<a name="ln-6524"></a>
<a name="ln-6525"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6526"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlType</span> <span class="o">==</span> <span class="n">LoadBased</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6527"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6528"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iControlZoneAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iControlZoneAlphaNum</span><span class="p">)))</span>
<a name="ln-6529"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6530"></a>        <span class="k">END IF</span>
<a name="ln-6531"></a>
<a name="ln-6532"></a>        <span class="c">! if a user connects the Unitary System as zone equipment, try to find the connection</span>
<a name="ln-6533"></a>        <span class="n">ZoneEquipmentFound</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6534"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">AirLoopEquipment</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">AirLoopFound</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6535"></a><span class="k">          IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6536"></a><span class="k">            DO </span><span class="n">ControlledZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-6537"></a>              <span class="k">DO </span><span class="n">ZoneExhNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ControlledZoneNum</span><span class="p">)%</span><span class="n">NumExhaustNodes</span>
<a name="ln-6538"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ControlledZoneNum</span><span class="p">)%</span><span class="n">ExhaustNode</span><span class="p">(</span><span class="n">ZoneExhNum</span><span class="p">)</span> <span class="o">/=</span> <span class="p">&amp;</span>
<a name="ln-6539"></a>                    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemInletNodeNum</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-6540"></a><span class="k">                IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span> <span class="o">/=</span> <span class="n">ControlledZoneNum</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6541"></a><span class="k">                  CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6542"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Did not find Air Node (Zone with Thermostat).&#39;</span><span class="p">)</span>
<a name="ln-6543"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;specified &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iControlZoneAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6544"></a>                                       <span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iControlZoneAlphaNum</span><span class="p">)))</span>
<a name="ln-6545"></a>                  <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6546"></a>                <span class="k">END IF</span>
<a name="ln-6547"></a><span class="k">                IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span> <span class="o">==</span> <span class="n">ControlledZoneNum</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6548"></a><span class="k">                  </span><span class="n">ZoneEquipmentFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6549"></a>                  <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">AirLoopEquipment</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6550"></a>                  <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ZoneInletNode</span> <span class="o">=</span> <span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ControlledZoneNum</span><span class="p">)%</span><span class="n">ExhaustNode</span><span class="p">(</span><span class="n">ZoneExhNum</span><span class="p">)</span>
<a name="ln-6551"></a>                <span class="k">END IF</span>
<a name="ln-6552"></a><span class="k">              END DO</span>
<a name="ln-6553"></a><span class="k">            END DO</span>
<a name="ln-6554"></a><span class="k">          END IF</span>
<a name="ln-6555"></a><span class="k">          IF</span><span class="p">(</span><span class="n">AirLoopNumber</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">ZoneEquipmentFound</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlType</span> <span class="o">==</span> <span class="n">LoadBased</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6556"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-6557"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Did not find an AirLoopHVAC.&#39;</span><span class="p">)</span>
<a name="ln-6558"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;specified &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iControlZoneAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6559"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iControlZoneAlphaNum</span><span class="p">)))</span>
<a name="ln-6560"></a>            <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">AirNodeFound</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">ZoneEquipmentFound</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlType</span> <span class="o">==</span> <span class="n">LoadBased</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6561"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-6562"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Did not find air node (zone with thermostat).&#39;</span><span class="p">)</span>
<a name="ln-6563"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;specified &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iControlZoneAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6564"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iControlZoneAlphaNum</span><span class="p">)))</span>
<a name="ln-6565"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Both a ZoneHVAC:EquipmentConnections object and a ZoneControl:Thermostat object&#39;</span> <span class="p">&amp;</span>
<a name="ln-6566"></a>                                <span class="o">//</span><span class="s1">&#39; must be specified for this zone.&#39;</span><span class="p">)</span>
<a name="ln-6567"></a>            <span class="k">END IF</span>
<a name="ln-6568"></a><span class="k">            IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">AirLoopFound</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">ZoneEquipmentFound</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlType</span> <span class="o">==</span> <span class="n">LoadBased</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6569"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-6570"></a>              <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Did not find correct AirLoopHVAC.&#39;</span><span class="p">)</span>
<a name="ln-6571"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;specified &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iControlZoneAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6572"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iControlZoneAlphaNum</span><span class="p">)))</span>
<a name="ln-6573"></a>            <span class="k">END IF</span>
<a name="ln-6574"></a><span class="k">            IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlType</span> <span class="o">==</span> <span class="n">LoadBased</span><span class="p">)</span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6575"></a>          <span class="k">END IF</span>
<a name="ln-6576"></a><span class="k">        END IF</span>
<a name="ln-6577"></a>
<a name="ln-6578"></a><span class="k">        IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">ZoneEquipmentFound</span><span class="p">)</span><span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iNameAlphaNum</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-6579"></a>              <span class="n">Alphas</span><span class="p">(</span><span class="n">iAirInletNodeNameAlphaNum</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iAirOutletNodeNameAlphaNum</span><span class="p">),</span><span class="s1">&#39;Air Nodes&#39;</span><span class="p">)</span>
<a name="ln-6580"></a>
<a name="ln-6581"></a>        <span class="c">! Determine supply air flow rate sizing method for cooling mode</span>
<a name="ln-6582"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iCoolSAFMAlphaNum</span><span class="p">),</span><span class="s1">&#39;SupplyAirFlowRate&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-6583"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSAFMethod</span>    <span class="o">=</span> <span class="n">SupplyAirFlowRate</span>
<a name="ln-6584"></a>
<a name="ln-6585"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lNumericBlanks</span><span class="p">(</span><span class="n">iMaxCoolAirVolFlowNumericNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6586"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span>   <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="n">iMaxCoolAirVolFlowNumericNum</span><span class="p">)</span>
<a name="ln-6587"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-6588"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RequestAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6589"></a>
<a name="ln-6590"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6591"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6592"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6593"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">iMaxCoolAirVolFlowNumericNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6594"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="n">iMaxCoolAirVolFlowNumericNum</span><span class="p">),</span><span class="mi">7</span><span class="p">)))</span>
<a name="ln-6595"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6596"></a>            <span class="k">END IF</span>
<a name="ln-6597"></a><span class="k">          ELSE</span>
<a name="ln-6598"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6599"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Input for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iCoolSAFMAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iCoolSAFMAlphaNum</span><span class="p">)))</span>
<a name="ln-6600"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Blank field not allowed for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">iMaxCoolAirVolFlowNumericNum</span><span class="p">)))</span>
<a name="ln-6601"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6602"></a>          <span class="k">END IF</span>
<a name="ln-6603"></a><span class="k">        </span><span class="n">ELSEIF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iCoolSAFMAlphaNum</span><span class="p">),</span><span class="s1">&#39;FlowPerFloorArea&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-6604"></a>
<a name="ln-6605"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSAFMethod</span>    <span class="o">=</span> <span class="n">FlowPerFloorArea</span>
<a name="ln-6606"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lNumericBlanks</span><span class="p">(</span><span class="n">iCoolFlowPerFloorAreaNumericNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6607"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span>   <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="n">iCoolFlowPerFloorAreaNumericNum</span><span class="p">)</span>
<a name="ln-6608"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6609"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6610"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6611"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Input for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iCoolSAFMAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iCoolSAFMAlphaNum</span><span class="p">)))</span>
<a name="ln-6612"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">iCoolFlowPerFloorAreaNumericNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6613"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="n">iCoolFlowPerFloorAreaNumericNum</span><span class="p">),</span><span class="mi">7</span><span class="p">)))</span>
<a name="ln-6614"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6615"></a>            <span class="c">! Autosized input is not allowed</span>
<a name="ln-6616"></a>            <span class="n">ELSEIF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6617"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6618"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Input for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iCoolSAFMAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iCoolSAFMAlphaNum</span><span class="p">)))</span>
<a name="ln-6619"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">iCoolFlowPerFloorAreaNumericNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = Autosize&#39;</span><span class="p">)</span>
<a name="ln-6620"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6621"></a>            <span class="k">ELSE</span>
<a name="ln-6622"></a><span class="k">              </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-6623"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">*</span> <span class="n">TotalFloorAreaOnAirLoop</span>
<a name="ln-6624"></a>              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RequestAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6625"></a>            <span class="k">END IF</span>
<a name="ln-6626"></a><span class="k">          ELSE</span>
<a name="ln-6627"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6628"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Input for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iCoolSAFMAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iCoolSAFMAlphaNum</span><span class="p">)))</span>
<a name="ln-6629"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Blank field not allowed for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">iCoolFlowPerFloorAreaNumericNum</span><span class="p">)))</span>
<a name="ln-6630"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6631"></a>          <span class="k">END IF</span>
<a name="ln-6632"></a><span class="k">        </span><span class="n">ELSEIF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iCoolSAFMAlphaNum</span><span class="p">),</span><span class="s1">&#39;FractionOfAutosizedCoolingValue&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-6633"></a>
<a name="ln-6634"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSAFMethod</span>  <span class="o">=</span> <span class="n">FractionOfAutosizedCoolingValue</span>
<a name="ln-6635"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lNumericBlanks</span><span class="p">(</span><span class="n">iCoolFlowPerFracCoolNumericNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6636"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="n">iCoolFlowPerFracCoolNumericNum</span><span class="p">)</span>
<a name="ln-6637"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6638"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6639"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6640"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Input for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iCoolSAFMAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iCoolSAFMAlphaNum</span><span class="p">)))</span>
<a name="ln-6641"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">iCoolFlowPerFracCoolNumericNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6642"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="n">iCoolFlowPerFracCoolNumericNum</span><span class="p">),</span><span class="mi">7</span><span class="p">)))</span>
<a name="ln-6643"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6644"></a>            <span class="c">! Autosized input is not allowed</span>
<a name="ln-6645"></a>            <span class="n">ELSEIF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6646"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6647"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Input for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iCoolSAFMAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iCoolSAFMAlphaNum</span><span class="p">)))</span>
<a name="ln-6648"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">iCoolFlowPerFracCoolNumericNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = Autosize&#39;</span><span class="p">)</span>
<a name="ln-6649"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6650"></a>            <span class="k">ELSE</span>
<a name="ln-6651"></a><span class="k">              </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RequestAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6652"></a>            <span class="k">END IF</span>
<a name="ln-6653"></a><span class="k">          ELSE</span>
<a name="ln-6654"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6655"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Input for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iCoolSAFMAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iCoolSAFMAlphaNum</span><span class="p">)))</span>
<a name="ln-6656"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Blank field not allowed for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">iCoolFlowPerFracCoolNumericNum</span><span class="p">)))</span>
<a name="ln-6657"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6658"></a>          <span class="k">END IF</span>
<a name="ln-6659"></a><span class="k">        </span><span class="n">ELSEIF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iCoolSAFMAlphaNum</span><span class="p">),</span><span class="s1">&#39;FlowPerCoolingCapacity&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-6660"></a>
<a name="ln-6661"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSAFMethod</span>  <span class="o">=</span> <span class="n">FlowPerCoolingCapacity</span>
<a name="ln-6662"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lNumericBlanks</span><span class="p">(</span><span class="n">iCoolFlowPerCoolCapNumericNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6663"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="n">iCoolFlowPerCoolCapNumericNum</span><span class="p">)</span>
<a name="ln-6664"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6665"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6666"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6667"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Input for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iCoolSAFMAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iCoolSAFMAlphaNum</span><span class="p">)))</span>
<a name="ln-6668"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">iCoolFlowPerCoolCapNumericNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6669"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="n">iCoolFlowPerCoolCapNumericNum</span><span class="p">),</span><span class="mi">7</span><span class="p">)))</span>
<a name="ln-6670"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6671"></a>            <span class="c">! Autosized input is not allowed</span>
<a name="ln-6672"></a>            <span class="n">ELSEIF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6673"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6674"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Input for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iCoolSAFMAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iCoolSAFMAlphaNum</span><span class="p">)))</span>
<a name="ln-6675"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">iCoolFlowPerCoolCapNumericNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = Autosize&#39;</span><span class="p">)</span>
<a name="ln-6676"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6677"></a>            <span class="k">ELSE</span>
<a name="ln-6678"></a><span class="k">              </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RequestAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6679"></a>            <span class="k">END IF</span>
<a name="ln-6680"></a><span class="k">          ELSE</span>
<a name="ln-6681"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6682"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Input for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iCoolSAFMAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iCoolSAFMAlphaNum</span><span class="p">)))</span>
<a name="ln-6683"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Blank field not allowed for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">iCoolFlowPerCoolCapNumericNum</span><span class="p">)))</span>
<a name="ln-6684"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6685"></a>          <span class="k">END IF</span>
<a name="ln-6686"></a><span class="k">        </span><span class="n">ELSEIF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iCoolSAFMAlphaNum</span><span class="p">),</span><span class="s1">&#39;None&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">iCoolSAFMAlphaNum</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-6687"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSAFMethod</span>  <span class="o">=</span> <span class="k">None</span>
<a name="ln-6688"></a><span class="c">!          UnitarySystem(UnitarySysNum)%RequestAutosize = .TRUE. ! ??</span>
<a name="ln-6689"></a>        <span class="k">ELSE</span>
<a name="ln-6690"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6691"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iCoolSAFMAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iCoolSAFMAlphaNum</span><span class="p">)))</span>
<a name="ln-6692"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6693"></a>        <span class="k">END IF</span>
<a name="ln-6694"></a>
<a name="ln-6695"></a>        <span class="c">! Determine supply air flow rate sizing method for heating mode</span>
<a name="ln-6696"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iHeatSAFMAlphaNum</span><span class="p">),</span><span class="s1">&#39;SupplyAirFlowRate&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-6697"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSAFMethod</span>    <span class="o">=</span> <span class="n">SupplyAirFlowRate</span>
<a name="ln-6698"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lNumericBlanks</span><span class="p">(</span><span class="n">iMaxHeatAirVolFlowNumericNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6699"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span>   <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="n">iMaxHeatAirVolFlowNumericNum</span><span class="p">)</span>
<a name="ln-6700"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-6701"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RequestAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6702"></a>
<a name="ln-6703"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6704"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6705"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6706"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">iMaxHeatAirVolFlowNumericNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6707"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="n">iMaxHeatAirVolFlowNumericNum</span><span class="p">),</span><span class="mi">7</span><span class="p">)))</span>
<a name="ln-6708"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6709"></a>            <span class="k">END IF</span>
<a name="ln-6710"></a><span class="k">          ELSE</span>
<a name="ln-6711"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6712"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Input for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iHeatSAFMAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iHeatSAFMAlphaNum</span><span class="p">)))</span>
<a name="ln-6713"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Blank field not allowed for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">iMaxHeatAirVolFlowNumericNum</span><span class="p">)))</span>
<a name="ln-6714"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6715"></a>          <span class="k">END IF</span>
<a name="ln-6716"></a><span class="k">        </span><span class="n">ELSEIF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iHeatSAFMAlphaNum</span><span class="p">),</span><span class="s1">&#39;FlowPerFloorArea&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-6717"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSAFMethod</span>    <span class="o">=</span> <span class="n">FlowPerFloorArea</span>
<a name="ln-6718"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lNumericBlanks</span><span class="p">(</span><span class="n">iHeatFlowPerFloorAreaNumericNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6719"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span>   <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="n">iHeatFlowPerFloorAreaNumericNum</span><span class="p">)</span>
<a name="ln-6720"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6721"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6722"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6723"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Input for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iHeatSAFMAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iHeatSAFMAlphaNum</span><span class="p">)))</span>
<a name="ln-6724"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">iHeatFlowPerFloorAreaNumericNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6725"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="n">iHeatFlowPerFloorAreaNumericNum</span><span class="p">),</span><span class="mi">7</span><span class="p">)))</span>
<a name="ln-6726"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6727"></a>            <span class="c">! Autosized input is not allowed</span>
<a name="ln-6728"></a>            <span class="n">ELSEIF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6729"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6730"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Input for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iHeatSAFMAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iHeatSAFMAlphaNum</span><span class="p">)))</span>
<a name="ln-6731"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">iHeatFlowPerFloorAreaNumericNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = Autosize&#39;</span><span class="p">)</span>
<a name="ln-6732"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6733"></a>            <span class="k">ELSE</span>
<a name="ln-6734"></a><span class="k">              </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-6735"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">*</span> <span class="n">TotalFloorAreaOnAirLoop</span>
<a name="ln-6736"></a>              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RequestAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6737"></a>            <span class="k">END IF</span>
<a name="ln-6738"></a><span class="k">          ELSE</span>
<a name="ln-6739"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6740"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Input for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iHeatSAFMAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iHeatSAFMAlphaNum</span><span class="p">)))</span>
<a name="ln-6741"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Blank field not allowed for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">iHeatFlowPerFloorAreaNumericNum</span><span class="p">)))</span>
<a name="ln-6742"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6743"></a>          <span class="k">END IF</span>
<a name="ln-6744"></a><span class="k">        </span><span class="n">ELSEIF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iHeatSAFMAlphaNum</span><span class="p">),</span><span class="s1">&#39;FractionOfAutosizedHeatingValue&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-6745"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSAFMethod</span>  <span class="o">=</span> <span class="n">FractionOfAutosizedHeatingValue</span>
<a name="ln-6746"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lNumericBlanks</span><span class="p">(</span><span class="n">iHeatFlowPerFracCoolNumericNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6747"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="n">iHeatFlowPerFracCoolNumericNum</span><span class="p">)</span>
<a name="ln-6748"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6749"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6750"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6751"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Input for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iHeatSAFMAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iHeatSAFMAlphaNum</span><span class="p">)))</span>
<a name="ln-6752"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">iHeatFlowPerFracCoolNumericNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6753"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="n">iHeatFlowPerFracCoolNumericNum</span><span class="p">),</span><span class="mi">7</span><span class="p">)))</span>
<a name="ln-6754"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6755"></a>            <span class="c">! Autosized input is not allowed</span>
<a name="ln-6756"></a>            <span class="n">ELSEIF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6757"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6758"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Input for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iHeatSAFMAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iHeatSAFMAlphaNum</span><span class="p">)))</span>
<a name="ln-6759"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">iHeatFlowPerFracCoolNumericNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = Autosize&#39;</span><span class="p">)</span>
<a name="ln-6760"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6761"></a>            <span class="k">ELSE</span>
<a name="ln-6762"></a><span class="k">              </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RequestAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6763"></a>            <span class="k">END IF</span>
<a name="ln-6764"></a><span class="k">          ELSE</span>
<a name="ln-6765"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6766"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Input for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iHeatSAFMAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iHeatSAFMAlphaNum</span><span class="p">)))</span>
<a name="ln-6767"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Blank field not allowed for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">iHeatFlowPerFracCoolNumericNum</span><span class="p">)))</span>
<a name="ln-6768"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6769"></a>          <span class="k">END IF</span>
<a name="ln-6770"></a><span class="k">        </span><span class="n">ELSEIF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iHeatSAFMAlphaNum</span><span class="p">),</span><span class="s1">&#39;FlowPerHeatingCapacity&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-6771"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSAFMethod</span>  <span class="o">=</span> <span class="n">FlowPerHeatingCapacity</span>
<a name="ln-6772"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lNumericBlanks</span><span class="p">(</span><span class="n">iHeatFlowPerHeatCapNumericNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6773"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="n">iHeatFlowPerHeatCapNumericNum</span><span class="p">)</span>
<a name="ln-6774"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6775"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6776"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6777"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Input for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iHeatSAFMAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iHeatSAFMAlphaNum</span><span class="p">)))</span>
<a name="ln-6778"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">iHeatFlowPerHeatCapNumericNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6779"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="n">iHeatFlowPerHeatCapNumericNum</span><span class="p">),</span><span class="mi">7</span><span class="p">)))</span>
<a name="ln-6780"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6781"></a>            <span class="c">! Autosized input is not allowed</span>
<a name="ln-6782"></a>            <span class="n">ELSEIF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6783"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6784"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Input for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iHeatSAFMAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iHeatSAFMAlphaNum</span><span class="p">)))</span>
<a name="ln-6785"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">iHeatFlowPerHeatCapNumericNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = Autosize&#39;</span><span class="p">)</span>
<a name="ln-6786"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6787"></a>            <span class="k">ELSE</span>
<a name="ln-6788"></a><span class="k">              </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RequestAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6789"></a>            <span class="k">END IF</span>
<a name="ln-6790"></a><span class="k">          ELSE</span>
<a name="ln-6791"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6792"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Input for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iHeatSAFMAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iHeatSAFMAlphaNum</span><span class="p">)))</span>
<a name="ln-6793"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Blank field not allowed for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">iHeatFlowPerHeatCapNumericNum</span><span class="p">)))</span>
<a name="ln-6794"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6795"></a>          <span class="k">END IF</span>
<a name="ln-6796"></a><span class="k">        </span><span class="n">ELSEIF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iHeatSAFMAlphaNum</span><span class="p">),</span><span class="s1">&#39;None&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">iHeatSAFMAlphaNum</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-6797"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSAFMethod</span>  <span class="o">=</span> <span class="k">None</span>
<a name="ln-6798"></a><span class="c">!          UnitarySystem(UnitarySysNum)%RequestAutosize = .TRUE. ! ??</span>
<a name="ln-6799"></a>        <span class="k">ELSE</span>
<a name="ln-6800"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6801"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iHeatSAFMAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iHeatSAFMAlphaNum</span><span class="p">)))</span>
<a name="ln-6802"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6803"></a>        <span class="k">END IF</span>
<a name="ln-6804"></a>
<a name="ln-6805"></a>        <span class="c">! Determine supply air flow rate sizing method when cooling or heating is not needed</span>
<a name="ln-6806"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iNoCoolHeatSAFMAlphaNum</span><span class="p">),</span><span class="s1">&#39;SupplyAirFlowRate&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-6807"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NoCoolHeatSAFMethod</span>    <span class="o">=</span> <span class="n">SupplyAirFlowRate</span>
<a name="ln-6808"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lNumericBlanks</span><span class="p">(</span><span class="n">iMaxNoCoolHeatAirVolFlowNumericNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6809"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="n">iMaxNoCoolHeatAirVolFlowNumericNum</span><span class="p">)</span>
<a name="ln-6810"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-6811"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RequestAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6812"></a>
<a name="ln-6813"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6814"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6815"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6816"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">iMaxNoCoolHeatAirVolFlowNumericNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6817"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="n">iMaxNoCoolHeatAirVolFlowNumericNum</span><span class="p">),</span><span class="mi">7</span><span class="p">)))</span>
<a name="ln-6818"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6819"></a>            <span class="k">END IF</span>
<a name="ln-6820"></a><span class="k">          ELSE</span>
<a name="ln-6821"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6822"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Input for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iNoCoolHeatSAFMAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6823"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iNoCoolHeatSAFMAlphaNum</span><span class="p">)))</span>
<a name="ln-6824"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Blank field not allowed for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">iMaxNoCoolHeatAirVolFlowNumericNum</span><span class="p">)))</span>
<a name="ln-6825"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6826"></a>          <span class="k">END IF</span>
<a name="ln-6827"></a><span class="k">        </span><span class="n">ELSEIF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iNoCoolHeatSAFMAlphaNum</span><span class="p">),</span><span class="s1">&#39;FlowPerFloorArea&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-6828"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NoCoolHeatSAFMethod</span>    <span class="o">=</span> <span class="n">FlowPerFloorArea</span>
<a name="ln-6829"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lNumericBlanks</span><span class="p">(</span><span class="n">iNoCoolHeatFlowPerFloorAreaNumericNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6830"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span>   <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="n">iNoCoolHeatFlowPerFloorAreaNumericNum</span><span class="p">)</span>
<a name="ln-6831"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6832"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6833"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6834"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Input for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iNoCoolHeatSAFMAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6835"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iNoCoolHeatSAFMAlphaNum</span><span class="p">)))</span>
<a name="ln-6836"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">iNoCoolHeatFlowPerFloorAreaNumericNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6837"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="n">iNoCoolHeatFlowPerFloorAreaNumericNum</span><span class="p">),</span><span class="mi">7</span><span class="p">)))</span>
<a name="ln-6838"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6839"></a>            <span class="c">! Autosized input is not allowed</span>
<a name="ln-6840"></a>            <span class="n">ELSEIF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6841"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6842"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Input for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iNoCoolHeatSAFMAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6843"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iNoCoolHeatSAFMAlphaNum</span><span class="p">)))</span>
<a name="ln-6844"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">iNoCoolHeatFlowPerFloorAreaNumericNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = Autosize&#39;</span><span class="p">)</span>
<a name="ln-6845"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6846"></a>            <span class="k">ELSE</span>
<a name="ln-6847"></a><span class="k">              </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-6848"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">*</span> <span class="n">TotalFloorAreaOnAirLoop</span>
<a name="ln-6849"></a>              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RequestAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6850"></a>            <span class="k">END IF</span>
<a name="ln-6851"></a><span class="k">          ELSE</span>
<a name="ln-6852"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6853"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Input for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iNoCoolHeatSAFMAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6854"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iNoCoolHeatSAFMAlphaNum</span><span class="p">)))</span>
<a name="ln-6855"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Blank field not allowed for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">iNoCoolHeatFlowPerFloorAreaNumericNum</span><span class="p">)))</span>
<a name="ln-6856"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6857"></a>          <span class="k">END IF</span>
<a name="ln-6858"></a><span class="k">        </span><span class="n">ELSEIF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iNoCoolHeatSAFMAlphaNum</span><span class="p">),</span><span class="s1">&#39;FractionOfAutosizedCoolingValue&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-6859"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NoCoolHeatSAFMethod</span>  <span class="o">=</span> <span class="n">FractionOfAutosizedCoolingValue</span>
<a name="ln-6860"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lNumericBlanks</span><span class="p">(</span><span class="n">iNoCoolHeatFlowPerFracCoolNumericNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6861"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="n">iNoCoolHeatFlowPerFracCoolNumericNum</span><span class="p">)</span>
<a name="ln-6862"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6863"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6864"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6865"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Input for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iNoCoolHeatSAFMAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6866"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iNoCoolHeatSAFMAlphaNum</span><span class="p">)))</span>
<a name="ln-6867"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">iNoCoolHeatFlowPerFracCoolNumericNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6868"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="n">iNoCoolHeatFlowPerFracCoolNumericNum</span><span class="p">),</span><span class="mi">7</span><span class="p">)))</span>
<a name="ln-6869"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6870"></a>            <span class="c">! Autosized input is not allowed</span>
<a name="ln-6871"></a>            <span class="n">ELSEIF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6872"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6873"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Input for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iNoCoolHeatSAFMAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6874"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iNoCoolHeatSAFMAlphaNum</span><span class="p">)))</span>
<a name="ln-6875"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">iNoCoolHeatFlowPerFracCoolNumericNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = Autosize&#39;</span><span class="p">)</span>
<a name="ln-6876"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6877"></a>            <span class="k">ELSE</span>
<a name="ln-6878"></a><span class="k">              </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RequestAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6879"></a>            <span class="k">END IF</span>
<a name="ln-6880"></a><span class="k">          ELSE</span>
<a name="ln-6881"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6882"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Input for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iNoCoolHeatSAFMAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6883"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iNoCoolHeatSAFMAlphaNum</span><span class="p">)))</span>
<a name="ln-6884"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Blank field not allowed for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">iNoCoolHeatFlowPerFracCoolNumericNum</span><span class="p">)))</span>
<a name="ln-6885"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6886"></a>          <span class="k">END IF</span>
<a name="ln-6887"></a><span class="k">        </span><span class="n">ELSEIF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iNoCoolHeatSAFMAlphaNum</span><span class="p">),</span><span class="s1">&#39;FractionOfAutosizedHeatingValue&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-6888"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NoCoolHeatSAFMethod</span>  <span class="o">=</span> <span class="n">FractionOfAutosizedHeatingValue</span>
<a name="ln-6889"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lNumericBlanks</span><span class="p">(</span><span class="n">iNoCoolHeatFlowPerFracHeatNumericNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6890"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="n">iNoCoolHeatFlowPerFracHeatNumericNum</span><span class="p">)</span>
<a name="ln-6891"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6892"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6893"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6894"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Input for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iNoCoolHeatSAFMAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6895"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iNoCoolHeatSAFMAlphaNum</span><span class="p">)))</span>
<a name="ln-6896"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">iNoCoolHeatFlowPerFracHeatNumericNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6897"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="n">iNoCoolHeatFlowPerFracHeatNumericNum</span><span class="p">),</span><span class="mi">7</span><span class="p">)))</span>
<a name="ln-6898"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6899"></a>            <span class="c">! Autosized input is not allowed</span>
<a name="ln-6900"></a>            <span class="n">ELSEIF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6901"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6902"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Input for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iNoCoolHeatSAFMAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6903"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iNoCoolHeatSAFMAlphaNum</span><span class="p">)))</span>
<a name="ln-6904"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">iNoCoolHeatFlowPerFracHeatNumericNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = Autosize&#39;</span><span class="p">)</span>
<a name="ln-6905"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6906"></a>            <span class="k">ELSE</span>
<a name="ln-6907"></a><span class="k">              </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RequestAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6908"></a>            <span class="k">END IF</span>
<a name="ln-6909"></a><span class="k">          ELSE</span>
<a name="ln-6910"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6911"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Input for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iNoCoolHeatSAFMAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6912"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iNoCoolHeatSAFMAlphaNum</span><span class="p">)))</span>
<a name="ln-6913"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Blank field not allowed for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">iNoCoolHeatFlowPerFracHeatNumericNum</span><span class="p">)))</span>
<a name="ln-6914"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6915"></a>          <span class="k">END IF</span>
<a name="ln-6916"></a><span class="k">        </span><span class="n">ELSEIF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iNoCoolHeatSAFMAlphaNum</span><span class="p">),</span><span class="s1">&#39;FlowPerCoolingCapacity&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-6917"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NoCoolHeatSAFMethod</span>  <span class="o">=</span> <span class="n">FlowPerCoolingCapacity</span>
<a name="ln-6918"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lNumericBlanks</span><span class="p">(</span><span class="n">iNoCoolHeatFlowPerCoolCapNumericNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6919"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="n">iNoCoolHeatFlowPerCoolCapNumericNum</span><span class="p">)</span>
<a name="ln-6920"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6921"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6922"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6923"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Input for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iNoCoolHeatSAFMAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6924"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iNoCoolHeatSAFMAlphaNum</span><span class="p">)))</span>
<a name="ln-6925"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">iNoCoolHeatFlowPerCoolCapNumericNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6926"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="n">iNoCoolHeatFlowPerCoolCapNumericNum</span><span class="p">),</span><span class="mi">7</span><span class="p">)))</span>
<a name="ln-6927"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6928"></a>            <span class="c">! Autosized input is not allowed</span>
<a name="ln-6929"></a>            <span class="n">ELSEIF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6930"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6931"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Input for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iNoCoolHeatSAFMAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6932"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iNoCoolHeatSAFMAlphaNum</span><span class="p">)))</span>
<a name="ln-6933"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">iNoCoolHeatFlowPerCoolCapNumericNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = Autosize&#39;</span><span class="p">)</span>
<a name="ln-6934"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6935"></a>            <span class="k">ELSE</span>
<a name="ln-6936"></a><span class="k">              </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RequestAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6937"></a>            <span class="k">END IF</span>
<a name="ln-6938"></a><span class="k">          ELSE</span>
<a name="ln-6939"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6940"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Input for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iNoCoolHeatSAFMAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6941"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iNoCoolHeatSAFMAlphaNum</span><span class="p">)))</span>
<a name="ln-6942"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Blank field not allowed for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">iNoCoolHeatFlowPerCoolCapNumericNum</span><span class="p">)))</span>
<a name="ln-6943"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6944"></a>          <span class="k">END IF</span>
<a name="ln-6945"></a><span class="k">        </span><span class="n">ELSEIF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iNoCoolHeatSAFMAlphaNum</span><span class="p">),</span><span class="s1">&#39;FlowPerHeatingCapacity&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-6946"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NoCoolHeatSAFMethod</span>  <span class="o">=</span> <span class="n">FlowPerHeatingCapacity</span>
<a name="ln-6947"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lNumericBlanks</span><span class="p">(</span><span class="n">iNoCoolHeatFlowPerHeatCapNumericNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6948"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="n">iNoCoolHeatFlowPerHeatCapNumericNum</span><span class="p">)</span>
<a name="ln-6949"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6950"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6951"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6952"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Input for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iNoCoolHeatSAFMAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6953"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iNoCoolHeatSAFMAlphaNum</span><span class="p">)))</span>
<a name="ln-6954"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">iNoCoolHeatFlowPerHeatCapNumericNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6955"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="n">iNoCoolHeatFlowPerHeatCapNumericNum</span><span class="p">),</span><span class="mi">7</span><span class="p">)))</span>
<a name="ln-6956"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6957"></a>            <span class="c">! Autosized input is not allowed</span>
<a name="ln-6958"></a>            <span class="n">ELSEIF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6959"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6960"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Input for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iNoCoolHeatSAFMAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6961"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iNoCoolHeatSAFMAlphaNum</span><span class="p">)))</span>
<a name="ln-6962"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">iNoCoolHeatFlowPerHeatCapNumericNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = Autosize&#39;</span><span class="p">)</span>
<a name="ln-6963"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6964"></a>            <span class="k">ELSE</span>
<a name="ln-6965"></a><span class="k">              </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RequestAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6966"></a>            <span class="k">END IF</span>
<a name="ln-6967"></a><span class="k">          ELSE</span>
<a name="ln-6968"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6969"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Input for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iNoCoolHeatSAFMAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6970"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iNoCoolHeatSAFMAlphaNum</span><span class="p">)))</span>
<a name="ln-6971"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Blank field not allowed for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">iNoCoolHeatFlowPerHeatCapNumericNum</span><span class="p">)))</span>
<a name="ln-6972"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6973"></a>          <span class="k">END IF</span>
<a name="ln-6974"></a><span class="k">        </span><span class="n">ELSEIF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iNoCoolHeatSAFMAlphaNum</span><span class="p">),</span><span class="s1">&#39;None&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">iNoCoolHeatSAFMAlphaNum</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-6975"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NoCoolHeatSAFMethod</span>  <span class="o">=</span> <span class="k">None</span>
<a name="ln-6976"></a><span class="c">!          UnitarySystem(UnitarySysNum)%RequestAutosize = .TRUE. ! ??</span>
<a name="ln-6977"></a>        <span class="k">ELSE</span>
<a name="ln-6978"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6979"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iNoCoolHeatSAFMAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6980"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iNoCoolHeatSAFMAlphaNum</span><span class="p">)))</span>
<a name="ln-6981"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6982"></a>        <span class="k">END IF</span>
<a name="ln-6983"></a>
<a name="ln-6984"></a><span class="c">!!       Check that the same air flow method is used if cooling and heating coil present</span>
<a name="ln-6985"></a><span class="c">!        IF(UnitarySystem(UnitarySysNum)%CoolCoilExists .AND. UnitarySystem(UnitarySysNum)%HeatCoilExists)THEN</span>
<a name="ln-6986"></a><span class="c">!          IF(UnitarySystem(UnitarySysNum)%CoolingSAFMethod /= UnitarySystem(UnitarySysNum)%HeatingSAFMethod .OR. &amp;</span>
<a name="ln-6987"></a><span class="c">!             UnitarySystem(UnitarySysNum)%CoolingSAFMethod /= UnitarySystem(UnitarySysNum)%NoCoolHeatSAFMethod)THEN</span>
<a name="ln-6988"></a><span class="c">!          CALL ShowSevereError(TRIM(CurrentModuleObject)//&#39; = &#39;//TRIM(UnitarySystem(UnitarySysNum)%Name))</span>
<a name="ln-6989"></a><span class="c">!          CALL ShowContinueError(&#39;Illegal supply air flow method.&#39;)</span>
<a name="ln-6990"></a><span class="c">!          CALL ShowContinueError(TRIM(cAlphaFields(iCoolSAFMAlphaNum))//&#39; = &#39;//TRIM(Alphas(iCoolSAFMAlphaNum)))</span>
<a name="ln-6991"></a><span class="c">!          CALL ShowContinueError(TRIM(cAlphaFields(iHeatSAFMAlphaNum))//&#39; = &#39;//TRIM(Alphas(iHeatSAFMAlphaNum)))</span>
<a name="ln-6992"></a><span class="c">!          CALL ShowContinueError(TRIM(cAlphaFields(iNoCoolHeatSAFMAlphaNum))//&#39; = &#39;//TRIM(Alphas(iNoCoolHeatSAFMAlphaNum)))</span>
<a name="ln-6993"></a><span class="c">!          CALL ShowContinueError(&#39;...Supply air flow methods must be the same when both a cooling and heating coil are present.&#39;)</span>
<a name="ln-6994"></a><span class="c">!          ErrorsFound=.TRUE.</span>
<a name="ln-6995"></a><span class="c">!          END IF</span>
<a name="ln-6996"></a><span class="c">!        END IF</span>
<a name="ln-6997"></a>
<a name="ln-6998"></a><span class="c">!       Fan operating mode (cycling or constant) schedule. IF constant fan, then set AirFlowControl</span>
<a name="ln-6999"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpModeSchedPtr</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7000"></a><span class="k">          IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">CheckScheduleValueMinMax</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpModeSchedPtr</span><span class="p">,</span><span class="s1">&#39;&gt;=&#39;</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="s1">&#39;&lt;=&#39;</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7001"></a><span class="c">!           set fan operating mode to continuous so sizing can set VS coil data</span>
<a name="ln-7002"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span> <span class="o">=</span> <span class="n">ContFanCycCoil</span>
<a name="ln-7003"></a><span class="c">!           set air flow control mode:</span>
<a name="ln-7004"></a><span class="c">!             UseCompressorOnFlow = operate at last cooling or heating air flow requested when compressor is off</span>
<a name="ln-7005"></a><span class="c">!             UseCompressorOffFlow = operate at value specified by user</span>
<a name="ln-7006"></a><span class="c">!           AirFlowControl only valid if fan opmode = ContFanCycComp</span>
<a name="ln-7007"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7008"></a><span class="k">              </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">AirFlowControl</span> <span class="o">=</span> <span class="n">UseCompressorOnFlow</span>
<a name="ln-7009"></a>            <span class="k">ELSE</span>
<a name="ln-7010"></a><span class="k">              </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">AirFlowControl</span> <span class="o">=</span> <span class="n">UseCompressorOffFlow</span>
<a name="ln-7011"></a>            <span class="k">END IF</span>
<a name="ln-7012"></a><span class="k">          END IF</span>
<a name="ln-7013"></a><span class="k">        END IF</span>
<a name="ln-7014"></a>
<a name="ln-7015"></a><span class="k">       IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">/=</span> <span class="n">CoilDX_CoolingHXAssisted</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7016"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">/=</span> <span class="n">CoilDX_CoolingTwoStageWHumControl</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7017"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">==</span> <span class="n">DehumidControl_Multimode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7018"></a><span class="k">         CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7019"></a>         <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iDehumidControlAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7020"></a>                                <span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iDehumidControlAlphaNum</span><span class="p">)))</span>
<a name="ln-7021"></a>         <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Multimode control must be used with a Heat Exchanger Assisted or Multimode Cooling Coil.&#39;</span><span class="p">)</span>
<a name="ln-7022"></a>         <span class="k">IF</span><span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">iSuppHeatCoilNameAlphaNum</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-7023"></a><span class="k">         ELSE</span>
<a name="ln-7024"></a><span class="k">           CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Dehumidification control type is assumed to be CoolReheat&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7025"></a>                                  <span class="s1">&#39; and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-7026"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">=</span> <span class="n">DehumidControl_CoolReheat</span>
<a name="ln-7027"></a>         <span class="k">END IF</span>
<a name="ln-7028"></a><span class="k">       END IF</span>
<a name="ln-7029"></a>
<a name="ln-7030"></a><span class="c">!       Check placement of cooling coil with respect to fan placement and dehumidification control type</span>
<a name="ln-7031"></a>
<a name="ln-7032"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanExists</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7033"></a><span class="k">         IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="o">==</span> <span class="n">BlowThru</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7034"></a><span class="k">           IF</span><span class="p">(</span><span class="n">FanOutletNode</span> <span class="o">==</span> <span class="n">HeatingCoilInletNode</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7035"></a>              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">/=</span> <span class="n">DehumidControl_CoolReheat</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7036"></a><span class="k">             </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilUpstream</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7037"></a>           <span class="k">END IF</span>
<a name="ln-7038"></a><span class="k">         </span><span class="n">ELSEIF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="o">==</span> <span class="n">DrawThru</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7039"></a><span class="k">           IF</span><span class="p">(</span><span class="n">HeatingCoilOutletNode</span> <span class="o">==</span> <span class="n">CoolingCoilInletNode</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7040"></a>              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">/=</span> <span class="n">DehumidControl_CoolReheat</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7041"></a><span class="k">             </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilUpstream</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7042"></a>           <span class="k">END IF</span>
<a name="ln-7043"></a><span class="k">         END IF</span>
<a name="ln-7044"></a><span class="k">       ELSE</span>
<a name="ln-7045"></a><span class="k">         IF</span><span class="p">(</span><span class="n">HeatingCoilOutletNode</span> <span class="o">==</span> <span class="n">CoolingCoilInletNode</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7046"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">/=</span> <span class="n">DehumidControl_CoolReheat</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7047"></a><span class="k">           </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilUpstream</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7048"></a>         <span class="k">END IF</span>
<a name="ln-7049"></a><span class="k">       END IF</span>
<a name="ln-7050"></a>
<a name="ln-7051"></a>       <span class="c">! check node connections</span>
<a name="ln-7052"></a>       <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">BlowThru</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7053"></a>
<a name="ln-7054"></a><span class="k">          IF</span><span class="p">(</span><span class="n">FanInletNode</span> <span class="o">/=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemInletNodeNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7055"></a><span class="k">             CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7056"></a>             <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a blow through fan is specified, the fan inlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7057"></a>                                    <span class="s1">&#39;the same as the unitary system inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-7058"></a>             <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Fan inlet node name           = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">FanInletNode</span><span class="p">)))</span>
<a name="ln-7059"></a>             <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...UnitarySystem inlet node name = &#39;</span> <span class="p">&amp;</span>
<a name="ln-7060"></a>                                    <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemInletNodeNum</span><span class="p">)))</span>
<a name="ln-7061"></a>             <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7062"></a>          <span class="k">END IF</span>
<a name="ln-7063"></a><span class="k">          IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilUpstream</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7064"></a><span class="k">            IF</span><span class="p">(</span><span class="n">FanOutletNode</span> <span class="o">/=</span> <span class="n">CoolingCoilInletNode</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7065"></a>               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilExists</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanExists</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7066"></a><span class="k">               CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7067"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a blow through fan is specified, the fan outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7068"></a>                                      <span class="s1">&#39;the same as the cooling coil inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-7069"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Fan outlet node name         = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">FanOutletNode</span><span class="p">)))</span>
<a name="ln-7070"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Cooling coil inlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">CoolingCoilInletNode</span><span class="p">)))</span>
<a name="ln-7071"></a>               <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7072"></a>            <span class="k">END IF</span>
<a name="ln-7073"></a><span class="k">            IF</span><span class="p">(</span><span class="n">CoolingCoilOutletNode</span> <span class="o">/=</span> <span class="n">HeatingCoilInletNode</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7074"></a>               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilExists</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7075"></a><span class="k">               CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7076"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The cooling coil outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7077"></a>                                      <span class="s1">&#39;the same as the heating coil inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-7078"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Cooling coil outlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">CoolingCoilOutletNode</span><span class="p">)))</span>
<a name="ln-7079"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Heating coil inlet node name  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">HeatingCoilInletNode</span><span class="p">)))</span>
<a name="ln-7080"></a>               <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7081"></a>            <span class="k">END IF</span>
<a name="ln-7082"></a><span class="k">            IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7083"></a><span class="k">              IF</span><span class="p">(</span><span class="n">SupHeatCoilOutletNode</span> <span class="o">/=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemOutletNodeNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7084"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7085"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The reheat coil outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7086"></a>                                       <span class="s1">&#39;the same as the unitary system outlet node name.&#39;</span><span class="p">)</span>
<a name="ln-7087"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Reheat coil outlet node name   = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">SupHeatCoilOutletNode</span><span class="p">)))</span>
<a name="ln-7088"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...UnitarySystem outlet node name = &#39;</span> <span class="p">&amp;</span>
<a name="ln-7089"></a>                                      <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemOutletNodeNum</span><span class="p">)))</span>
<a name="ln-7090"></a><span class="c">!                ErrorsFound=.TRUE.</span>
<a name="ln-7091"></a>              <span class="k">END IF</span>
<a name="ln-7092"></a><span class="k">            ELSE</span> <span class="c">! IF((UnitarySystem(UnitarySysNum)%Humidistat ...</span>
<a name="ln-7093"></a>              <span class="c">! Heating coil outlet node name must be the same as the Unitary system outlet node name</span>
<a name="ln-7094"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7095"></a>                  <span class="n">HeatingCoilOutletNode</span> <span class="o">/=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemOutletNodeNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7096"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7097"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a blow through fan is specified, &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-7098"></a>                               <span class="s1">&#39;the heating coil outlet node name must be the same as the unitary system outlet node name.&#39;</span><span class="p">)</span>
<a name="ln-7099"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Heating coil outlet node name  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">HeatingCoilOutletNode</span><span class="p">)))</span>
<a name="ln-7100"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Unitary system outlet node name = &#39;</span> <span class="p">&amp;</span>
<a name="ln-7101"></a>                                         <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemOutletNodeNum</span><span class="p">)))</span>
<a name="ln-7102"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7103"></a>              <span class="k">END IF</span>
<a name="ln-7104"></a><span class="k">            END IF</span>
<a name="ln-7105"></a><span class="k">          ELSE</span> <span class="c">! IF(UnitarySystem(UnitarySysNum)%CoolingCoilUpstream)THEN</span>
<a name="ln-7106"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">FanOutletNode</span> <span class="o">/=</span> <span class="n">HeatingCoilInletNode</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanExists</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7107"></a>               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7108"></a><span class="k">               CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7109"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a blow through fan is specified, the fan outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7110"></a>                                      <span class="s1">&#39;the same as the heating coil inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-7111"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Fan outlet node name         = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">FanOutletNode</span><span class="p">)))</span>
<a name="ln-7112"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Heating coil inlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">HeatingCoilInletNode</span><span class="p">)))</span>
<a name="ln-7113"></a>               <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7114"></a>            <span class="k">END IF</span>
<a name="ln-7115"></a><span class="k">            IF</span><span class="p">(</span><span class="n">HeatingCoilOutletNode</span> <span class="o">/=</span> <span class="n">CoolingCoilInletNode</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilExists</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7116"></a>               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7117"></a><span class="k">               CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7118"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The heating coil outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7119"></a>                                      <span class="s1">&#39;the same as the cooling coil inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-7120"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Heating coil outlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">HeatingCoilOutletNode</span><span class="p">)))</span>
<a name="ln-7121"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Cooling coil inlet node name  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">CoolingCoilInletNode</span><span class="p">)))</span>
<a name="ln-7122"></a>               <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7123"></a>            <span class="k">END IF</span>
<a name="ln-7124"></a><span class="k">            IF</span><span class="p">(</span><span class="n">CoolingCoilOutletNode</span> <span class="o">/=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemOutletNodeNum</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7125"></a>               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilExists</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7126"></a><span class="k">               CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7127"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a blow through fan is specified, the cooling coil outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7128"></a>                                      <span class="s1">&#39;the same as the unitary system outlet node name.&#39;</span><span class="p">)</span>
<a name="ln-7129"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Cooling coil outlet node name   = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">CoolingCoilOutletNode</span><span class="p">)))</span>
<a name="ln-7130"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...UnitarySystem outlet node name  = &#39;</span> <span class="p">&amp;</span>
<a name="ln-7131"></a>                                      <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemOutletNodeNum</span><span class="p">)))</span>
<a name="ln-7132"></a>               <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7133"></a>            <span class="k">END IF</span>
<a name="ln-7134"></a><span class="k">          END IF</span>
<a name="ln-7135"></a>
<a name="ln-7136"></a><span class="k">        ELSE</span> <span class="c">! ELSE from IF(UnitarySystem(UnitarySysNum)%FanPlace .EQ. BlowThru)THEN</span>
<a name="ln-7137"></a>
<a name="ln-7138"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilUpstream</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7139"></a><span class="k">            IF</span><span class="p">(</span><span class="n">CoolingCoilInletNode</span> <span class="o">/=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemInletNodeNum</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7140"></a>               <span class="n">CoolingCoilInletNode</span> <span class="o">/=</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanExists</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7141"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7142"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a draw through fan is specified, the cooling coil inlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7143"></a>                                     <span class="s1">&#39;the same as the unitary system inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-7144"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Cooling coil inlet node name  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">CoolingCoilInletNode</span><span class="p">)))</span>
<a name="ln-7145"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...UnitarySystem inlet node name = &#39;</span> <span class="p">&amp;</span>
<a name="ln-7146"></a>                                     <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemInletNodeNum</span><span class="p">)))</span>
<a name="ln-7147"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7148"></a>            <span class="k">END IF</span>
<a name="ln-7149"></a><span class="k">            IF</span><span class="p">(</span><span class="n">CoolingCoilOutletNode</span> <span class="o">/=</span> <span class="n">HeatingCoilInletNode</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7150"></a>               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilExists</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7151"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7152"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The cooling coil outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7153"></a>                                     <span class="s1">&#39;the same as the heating coil inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-7154"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Cooling coil outlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">CoolingCoilOutletNode</span><span class="p">)))</span>
<a name="ln-7155"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Heating coil inlet node name  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">HeatingCoilInletNode</span><span class="p">)))</span>
<a name="ln-7156"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7157"></a>            <span class="k">END IF</span>
<a name="ln-7158"></a><span class="k">            IF</span><span class="p">(</span><span class="n">HeatingCoilOutletNode</span> <span class="o">/=</span> <span class="n">FanInletNode</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7159"></a>               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanExists</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7160"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7161"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a draw through fan is specified, the heating coil outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7162"></a>                                     <span class="s1">&#39;the same as the fan inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-7163"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Heating coil outlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">HeatingCoilOutletNode</span><span class="p">)))</span>
<a name="ln-7164"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Fan inlet node name           = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">FanInletNode</span><span class="p">)))</span>
<a name="ln-7165"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7166"></a>            <span class="k">END IF</span>
<a name="ln-7167"></a><span class="k">            IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7168"></a><span class="k">              IF</span><span class="p">(</span><span class="n">FanOutletNode</span> <span class="o">/=</span> <span class="n">SupHeatCoilInletNode</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanExists</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7169"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7170"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a draw through fan is specified, the fan outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7171"></a>                                       <span class="s1">&#39;the same as the reheat coil inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-7172"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Fan outlet node name        = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">FanOutletNode</span><span class="p">)))</span>
<a name="ln-7173"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Reheat coil inlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">SupHeatCoilInletNode</span><span class="p">)))</span>
<a name="ln-7174"></a><span class="c">!                ErrorsFound=.TRUE.</span>
<a name="ln-7175"></a>              <span class="k">END IF</span>
<a name="ln-7176"></a><span class="k">              IF</span><span class="p">(</span><span class="n">SupHeatCoilOutletNode</span> <span class="o">/=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemOutletNodeNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7177"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7178"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The reheat coil outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7179"></a>                                       <span class="s1">&#39;the same as the unitary system outlet node name.&#39;</span><span class="p">)</span>
<a name="ln-7180"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Reheat coil outlet node name   = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">SupHeatCoilOutletNode</span><span class="p">)))</span>
<a name="ln-7181"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...UnitarySystem outlet node name = &#39;</span> <span class="p">&amp;</span>
<a name="ln-7182"></a>                                                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemOutletNodeNum</span><span class="p">)))</span>
<a name="ln-7183"></a>              <span class="k">END IF</span>
<a name="ln-7184"></a><span class="k">            ELSE</span>
<a name="ln-7185"></a><span class="k">              IF</span><span class="p">(</span><span class="n">FanOutletNode</span> <span class="o">/=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemOutletNodeNum</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7186"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanExists</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7187"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7188"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a draw through fan is specified, the fan outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7189"></a>                                       <span class="s1">&#39;the same as the unitary system outlet node name.&#39;</span><span class="p">)</span>
<a name="ln-7190"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Fan outlet node name        = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">FanOutletNode</span><span class="p">)))</span>
<a name="ln-7191"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Unitary system outlet node name = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7192"></a>                                       <span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemOutletNodeNum</span><span class="p">)))</span>
<a name="ln-7193"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7194"></a>              <span class="k">END IF</span>
<a name="ln-7195"></a><span class="k">            END IF</span>
<a name="ln-7196"></a><span class="k">          ELSE</span> <span class="c">! IF(UnitarySystem(UnitarySysNum)%CoolingCoilUpstream)THEN</span>
<a name="ln-7197"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">HeatingCoilInletNode</span> <span class="o">/=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemInletNodeNum</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7198"></a>               <span class="n">HeatingCoilInletNode</span> <span class="o">/=</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanExists</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7199"></a><span class="k">               CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7200"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a draw through fan is specified, the heating coil inlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7201"></a>                                      <span class="s1">&#39;the same as the unitary system inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-7202"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Heating coil inlet node name  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">HeatingCoilInletNode</span><span class="p">)))</span>
<a name="ln-7203"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...UnitarySystem inlet node name = &#39;</span> <span class="p">&amp;</span>
<a name="ln-7204"></a>                                      <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemInletNodeNum</span><span class="p">)))</span>
<a name="ln-7205"></a>               <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7206"></a>            <span class="k">END IF</span>
<a name="ln-7207"></a><span class="k">            IF</span><span class="p">(</span><span class="n">HeatingCoilOutletNode</span> <span class="o">/=</span> <span class="n">CoolingCoilInletNode</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7208"></a>               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilExists</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7209"></a><span class="k">               CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7210"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The heating coil outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7211"></a>                                      <span class="s1">&#39;the same as the cooling coil inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-7212"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Heating coil outlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">HeatingCoilOutletNode</span><span class="p">)))</span>
<a name="ln-7213"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Cooling coil inlet node name  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">CoolingCoilInletNode</span><span class="p">)))</span>
<a name="ln-7214"></a>               <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7215"></a>            <span class="k">END IF</span>
<a name="ln-7216"></a><span class="k">            IF</span><span class="p">(</span><span class="n">CoolingCoilOutletNode</span> <span class="o">/=</span> <span class="n">FanInletNode</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7217"></a>               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilExists</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanExists</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7218"></a><span class="k">               CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7219"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a draw through fan is specified, the cooling coil outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7220"></a>                                      <span class="s1">&#39;the same as the fan inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-7221"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Cooling coil outlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">CoolingCoilOutletNode</span><span class="p">)))</span>
<a name="ln-7222"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Fan inlet node name           = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">FanInletNode</span><span class="p">)))</span>
<a name="ln-7223"></a>               <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7224"></a>            <span class="k">END IF</span>
<a name="ln-7225"></a><span class="k">            IF</span><span class="p">(</span><span class="n">FanOutletNode</span> <span class="o">/=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemOutletNodeNum</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7226"></a>               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanExists</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7227"></a><span class="k">               CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7228"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a draw through fan is specified, the fan outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7229"></a>                                      <span class="s1">&#39;the same as the unitary system outlet node name.&#39;</span><span class="p">)</span>
<a name="ln-7230"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Fan outlet node name           = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">FanOutletNode</span><span class="p">)))</span>
<a name="ln-7231"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...UnitarySystem outlet node name = &#39;</span> <span class="p">&amp;</span>
<a name="ln-7232"></a>                                       <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemOutletNodeNum</span><span class="p">)))</span>
<a name="ln-7233"></a>               <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7234"></a>            <span class="k">END IF</span>
<a name="ln-7235"></a><span class="k">          END IF</span>
<a name="ln-7236"></a><span class="k">        END IF</span> <span class="c">! ELSE from IF(UnitarySystem(UnitarySysNum)%FanPlace .EQ. BlowThru)THEN</span>
<a name="ln-7237"></a>
<a name="ln-7238"></a>        <span class="c">!Set the unitary system supplemental heater max outlet temperature</span>
<a name="ln-7239"></a>        <span class="c">! this field will be 0 if the input is not specified (included) in the input file</span>
<a name="ln-7240"></a>        <span class="c">! someone may use a default other than what we intended, allow it to be used</span>
<a name="ln-7241"></a>        <span class="c">! so if this field is blank, and the input field is included, read the default, otherwise use 80</span>
<a name="ln-7242"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lNumericBlanks</span><span class="p">(</span><span class="n">iDesignMaxOutletTempNumericNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">NumNumbers</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="p">(</span><span class="n">iDesignMaxOutletTempNumericNum</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7243"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignMaxOutletTemp</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="n">iDesignMaxOutletTempNumericNum</span><span class="p">)</span>
<a name="ln-7244"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignMaxOutletTemp</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7245"></a>               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RequestAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7246"></a>        <span class="k">END IF</span>
<a name="ln-7247"></a>
<a name="ln-7248"></a>        <span class="c">!Set maximum Outdoor air temperature for supplemental heating coil operation</span>
<a name="ln-7249"></a>        <span class="c">! this field will be 0 if the input is not specified (included) in the input file</span>
<a name="ln-7250"></a>        <span class="c">! someone may use a default other than what we intended, allow it to be used</span>
<a name="ln-7251"></a>        <span class="c">! so if this field is blank, and the input field is included, read the default, otherwise use 9999</span>
<a name="ln-7252"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lNumericBlanks</span><span class="p">(</span><span class="n">iMaxOATSuppHeatNumericNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">NumNumbers</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="p">(</span><span class="n">iMaxOATSuppHeatNumericNum</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7253"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxOATSuppHeat</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="n">iMaxOATSuppHeatNumericNum</span><span class="p">)</span>
<a name="ln-7254"></a>        <span class="c">! Can&#39;t let MaxOATSuppHeat default to 21C if using cool reheat since it would shut off supp heater when dehumidifying</span>
<a name="ln-7255"></a>        <span class="c">! this may also allow supplemental heater to operate when in heating mode when it should not</span>
<a name="ln-7256"></a>        <span class="k">ELSE IF</span><span class="p">(</span><span class="n">NumNumbers</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">iMaxOATSuppHeatNumericNum</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7257"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">==</span> <span class="n">DehumidControl_CoolReheat</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7258"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxOATSuppHeat</span> <span class="o">=</span> <span class="mi">99</span><span class="mf">9.0d0</span>
<a name="ln-7259"></a>        <span class="k">END IF</span>
<a name="ln-7260"></a>
<a name="ln-7261"></a><span class="k">        IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Autosize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7262"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Autosize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7263"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Autosize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7264"></a>           <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RequestAutosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7265"></a><span class="c">!           (UnitarySystem(UnitarySysNum)%CoolingSAFMethod .LE. SupplyAirFlowRate .OR. &amp;</span>
<a name="ln-7266"></a><span class="c">!            UnitarySystem(UnitarySysNum)%HeatingSAFMethod .LE. SupplyAirFlowRate))THEN</span>
<a name="ln-7267"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7268"></a>                                                                    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7269"></a>                                                                    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span><span class="p">)</span>
<a name="ln-7270"></a>        <span class="k">ELSE</span>
<a name="ln-7271"></a><span class="k">          IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7272"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="o">=</span> <span class="n">Autosize</span>
<a name="ln-7273"></a>          <span class="k">END IF</span>
<a name="ln-7274"></a>  <span class="c">! need more of this type of warning when flow cannot be determined</span>
<a name="ln-7275"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7276"></a>             <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7277"></a><span class="k">             IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7278"></a><span class="k">               IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilExists</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7279"></a>                  <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">/=</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7280"></a><span class="k">                 IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7281"></a><span class="k">                   </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span>
<a name="ln-7282"></a>                 <span class="k">END IF</span>
<a name="ln-7283"></a><span class="k">               END IF</span>
<a name="ln-7284"></a><span class="k">             </span><span class="n">ELSEIF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7285"></a><span class="k">               </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span>
<a name="ln-7286"></a>             <span class="k">ELSE</span>
<a name="ln-7287"></a><span class="k">               IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">/=</span> <span class="n">CoilDX_HeatingEmpirical</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7288"></a>                  <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">/=</span> <span class="n">CoilDX_MultiSpeedHeating</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7289"></a>                  <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">/=</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7290"></a><span class="k">                 CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7291"></a>                 <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When non-DX heating coils are specified, the heating air flow rate must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7292"></a>                                        <span class="s1">&#39;entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iHeatSAFMAlphaNum</span><span class="p">)))</span>
<a name="ln-7293"></a>                 <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7294"></a>               <span class="k">END IF</span>
<a name="ln-7295"></a><span class="k">             END IF</span>
<a name="ln-7296"></a><span class="k">          </span><span class="n">ELSEIF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7297"></a>             <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanExists</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7298"></a>             <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7299"></a><span class="k">                 CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7300"></a>                 <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When non-DX heating coils are specified, the heating air flow rate must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7301"></a>                                        <span class="s1">&#39;entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iHeatSAFMAlphaNum</span><span class="p">)))</span>
<a name="ln-7302"></a>          <span class="k">END IF</span>
<a name="ln-7303"></a><span class="k">        END IF</span>
<a name="ln-7304"></a>
<a name="ln-7305"></a><span class="k">        IF</span><span class="p">(</span><span class="n">FanVolFlowRate</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">AutoSize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7306"></a><span class="k">          IF</span><span class="p">(</span><span class="n">FanVolFlowRate</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7307"></a>               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">AutoSize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7308"></a>               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7309"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7310"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... air flow rate = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">FanVolFlowRate</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; in fan object &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7311"></a>                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">FanName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; is less than the maximum HVAC system air flow rate in cooling mode.&#39;</span><span class="p">)</span>
<a name="ln-7312"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; The &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">iMaxCoolAirVolFlowNumericNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is reset to the&#39;</span> <span class="p">&amp;</span>
<a name="ln-7313"></a>                                 <span class="o">//</span><span class="s1">&#39; fan flow rate and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-7314"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">=</span> <span class="n">FanVolFlowRate</span>
<a name="ln-7315"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="o">=</span> <span class="n">FanVolFlowRate</span>
<a name="ln-7316"></a>          <span class="k">END IF</span>
<a name="ln-7317"></a><span class="k">          IF</span><span class="p">(</span><span class="n">FanVolFlowRate</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7318"></a>               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">AutoSize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7319"></a>               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7320"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7321"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... air flow rate = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">FanVolFlowRate</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; in fan object &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7322"></a>                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">FanName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; is less than the maximum HVAC system air flow rate in heating mode.&#39;</span><span class="p">)</span>
<a name="ln-7323"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; The &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is reset to the&#39;</span> <span class="p">&amp;</span>
<a name="ln-7324"></a>                                 <span class="o">//</span><span class="s1">&#39; fan flow rate and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-7325"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">=</span> <span class="n">FanVolFlowRate</span>
<a name="ln-7326"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="o">=</span> <span class="n">FanVolFlowRate</span>
<a name="ln-7327"></a>          <span class="k">END IF</span>
<a name="ln-7328"></a><span class="k">        END IF</span>
<a name="ln-7329"></a>
<a name="ln-7330"></a><span class="k">        IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpModeSchedPtr</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7331"></a><span class="k">          IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">CheckScheduleValueMinMax</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpModeSchedPtr</span><span class="p">,</span><span class="s1">&#39;&gt;=&#39;</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="s1">&#39;&lt;=&#39;</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7332"></a><span class="c">!           set air flow control mode:</span>
<a name="ln-7333"></a><span class="c">!             UseCompressorOnFlow = operate at last cooling or heating air flow requested when compressor is off</span>
<a name="ln-7334"></a><span class="c">!             UseCompressorOffFlow = operate at value specified by user</span>
<a name="ln-7335"></a><span class="c">!           AirFlowControl only valid IF fan opmode = ContFanCycComp</span>
<a name="ln-7336"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7337"></a><span class="k">              </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">AirFlowControl</span> <span class="o">=</span> <span class="n">UseCompressorOnFlow</span>
<a name="ln-7338"></a>            <span class="k">ELSE</span>
<a name="ln-7339"></a><span class="k">              </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">AirFlowControl</span> <span class="o">=</span> <span class="n">UseCompressorOffFlow</span>
<a name="ln-7340"></a>            <span class="k">END IF</span>
<a name="ln-7341"></a><span class="k">          END IF</span>
<a name="ln-7342"></a><span class="k">        END IF</span>
<a name="ln-7343"></a>
<a name="ln-7344"></a>        <span class="c">!Set minimum OAT for heat pump compressor operation</span>
<a name="ln-7345"></a>        <span class="c">! get from coil module</span>
<a name="ln-7346"></a>        <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7347"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7348"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MinOATCompressor</span> <span class="o">=</span> <span class="n">GetVSCoilMinOATCompressor</span><span class="p">(</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-7349"></a>        <span class="n">ELSEIF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_HeatingEmpirical</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7350"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_MultiSpeedHeating</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7351"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MinOATCompressor</span> <span class="o">=</span>    <span class="p">&amp;</span>
<a name="ln-7352"></a>               <span class="n">GetMinOATDXCoilCompressor</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-7353"></a><span class="c">!       ELSEIF  ***... make sure we catch all possbile coil types here ...***</span>
<a name="ln-7354"></a>        <span class="k">ELSE</span>
<a name="ln-7355"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MinOATCompressor</span> <span class="o">=</span> <span class="o">-</span><span class="mi">100</span><span class="mf">0.0d0</span>
<a name="ln-7356"></a>        <span class="k">END IF</span>
<a name="ln-7357"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7358"></a><span class="k">          CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7359"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7360"></a>        <span class="k">END IF</span>
<a name="ln-7361"></a>
<a name="ln-7362"></a>
<a name="ln-7363"></a><span class="c">!       Mine heatpump Outdoor condenser node from DX coil object</span>
<a name="ln-7364"></a>        <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7365"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingSingleSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7366"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CondenserNodeNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-7367"></a>            <span class="n">GetDXCoilCondenserInletNode</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-7368"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_CoolingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7369"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CondenserNodeNum</span> <span class="o">=</span> <span class="n">GetVSCoilCondenserInletNode</span><span class="p">(</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-7370"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingHXAssisted</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7371"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CondenserNodeNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-7372"></a>            <span class="n">GetDXCoilCondenserInletNode</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:DX:SingleSpeed&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7373"></a>            <span class="n">GetHXDXCoilName</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-7374"></a>            <span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-7375"></a>        <span class="k">ELSE</span>
<a name="ln-7376"></a><span class="k">          IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">iCondenserNodeAlphaNum</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-7377"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CondenserNodeNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-7378"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iCondenserNodeAlphaNum</span><span class="p">),</span><span class="n">ErrFlag</span><span class="p">,</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-7379"></a>                            <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsParent</span><span class="p">)</span>
<a name="ln-7380"></a>          <span class="k">ELSE</span>
<a name="ln-7381"></a>            <span class="c">! do nothing?</span>
<a name="ln-7382"></a>          <span class="k">END IF</span>
<a name="ln-7383"></a><span class="k">        END IF</span>
<a name="ln-7384"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7385"></a><span class="k">          CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7386"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7387"></a>        <span class="k">END IF</span>
<a name="ln-7388"></a>
<a name="ln-7389"></a>        <span class="c">!Set the heatpump cycling rate</span>
<a name="ln-7390"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="n">iMaxONOFFCycPerHourNumericNum</span><span class="p">)</span>
<a name="ln-7391"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">NumNumbers</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">iMaxONOFFCycPerHourNumericNum</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7392"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span> <span class="o">=</span> <span class="mf">2.5d0</span>
<a name="ln-7393"></a>        <span class="k">END IF</span>
<a name="ln-7394"></a>
<a name="ln-7395"></a>        <span class="c">!Set the heat pump time constant</span>
<a name="ln-7396"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="n">iHPTimeConstantNumericNum</span><span class="p">)</span>
<a name="ln-7397"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">NumNumbers</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">iHPTimeConstantNumericNum</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7398"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span> <span class="o">=</span> <span class="mi">6</span><span class="mf">0.0d0</span>
<a name="ln-7399"></a>        <span class="k">END IF</span>
<a name="ln-7400"></a>
<a name="ln-7401"></a>        <span class="c">!Set the heat pump on-cycle power use fraction</span>
<a name="ln-7402"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">OnCyclePowerFraction</span> <span class="o">=</span> <span class="n">Numbers</span> <span class="p">(</span><span class="n">iOnCyclePowerFracNumericNum</span><span class="p">)</span>
<a name="ln-7403"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">NumNumbers</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">iOnCyclePowerFracNumericNum</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7404"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">OnCyclePowerFraction</span> <span class="o">=</span> <span class="mf">0.01d0</span>
<a name="ln-7405"></a>        <span class="k">END IF</span>
<a name="ln-7406"></a>
<a name="ln-7407"></a>        <span class="c">!Set the heat pump fan delay time</span>
<a name="ln-7408"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanDelayTime</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="n">iFanDelayTimeNumericNum</span><span class="p">)</span>
<a name="ln-7409"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">NumNumbers</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">iFanDelayTimeNumericNum</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7410"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanDelayTime</span> <span class="o">=</span> <span class="mi">6</span><span class="mf">0.0d0</span>
<a name="ln-7411"></a>        <span class="k">END IF</span>
<a name="ln-7412"></a>
<a name="ln-7413"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">AncillaryOnPower</span>  <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="n">iAncillaryOnPowerNumericNum</span><span class="p">)</span>
<a name="ln-7414"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">AncillaryOffPower</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="n">iAncillaryOffPowerNumericNum</span><span class="p">)</span>
<a name="ln-7415"></a>
<a name="ln-7416"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHRWaterVolumeFlow</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="n">iDesignHRWaterVolFlowNumericNum</span><span class="p">)</span>
<a name="ln-7417"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHROutletWaterTemp</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="n">iMaxHROutletWaterTempNumericNum</span><span class="p">)</span>
<a name="ln-7418"></a>
<a name="ln-7419"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHRWaterVolumeFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7420"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatRecActive</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7421"></a>          <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7422"></a>          <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">iHRWaterInletNodeAlphaNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">iHRWaterOutletNodeAlphaNum</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-7423"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatRecoveryInletNodeNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-7424"></a>              <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iHRWaterInletNodeAlphaNum</span><span class="p">),</span><span class="n">ErrFlag</span><span class="p">,</span><span class="s1">&#39;Unitary System Heat receovery&#39;</span><span class="p">,</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iNameAlphaNum</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-7425"></a>                <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">ObjectIsParent</span><span class="p">)</span>
<a name="ln-7426"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatRecoveryOutletNodeNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-7427"></a>              <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iHRWaterOutletNodeAlphaNum</span><span class="p">),</span><span class="n">ErrFlag</span><span class="p">,</span><span class="s1">&#39;Unitary System Heat receovery&#39;</span><span class="p">,</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iNameAlphaNum</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-7428"></a>                <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">ObjectIsParent</span><span class="p">)</span>
<a name="ln-7429"></a>
<a name="ln-7430"></a>            <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iNameAlphaNum</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iHRWaterInletNodeAlphaNum</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-7431"></a>                             <span class="n">Alphas</span><span class="p">(</span><span class="n">iHRWaterOutletNodeAlphaNum</span><span class="p">),</span> <span class="s1">&#39;Unitary System Heat receovery Nodes&#39;</span><span class="p">)</span>
<a name="ln-7432"></a>
<a name="ln-7433"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7434"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7435"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7436"></a>            <span class="k">END IF</span>
<a name="ln-7437"></a><span class="k">          ELSE</span>
<a name="ln-7438"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7439"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iHRWaterInletNodeAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7440"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iHRWaterInletNodeAlphaNum</span><span class="p">)))</span>
<a name="ln-7441"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iHRWaterOutletNodeAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7442"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iHRWaterOutletNodeAlphaNum</span><span class="p">)))</span>
<a name="ln-7443"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... heat recovery nodes must be specified when &#39;</span> <span class="p">&amp;</span>
<a name="ln-7444"></a>                                   <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">iDesignHRWaterVolFlowNumericNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is greater than 0.&#39;</span><span class="p">)</span>
<a name="ln-7445"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">iDesignHRWaterVolFlowNumericNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7446"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHRWaterVolumeFlow</span><span class="p">,</span><span class="mi">7</span><span class="p">)))</span>
<a name="ln-7447"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7448"></a>          <span class="k">END IF</span>
<a name="ln-7449"></a><span class="k">        END IF</span>
<a name="ln-7450"></a>
<a name="ln-7451"></a><span class="k">        IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">iDesignSpecMSHPTypeAlphaNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">iDesignSpecMSHPNameAlphaNum</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-7452"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignSpecMultispeedHPType</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="n">iDesignSpecMSHPTypeAlphaNum</span><span class="p">)</span>
<a name="ln-7453"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignSpecMultispeedHPName</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="n">iDesignSpecMSHPNameAlphaNum</span><span class="p">)</span>
<a name="ln-7454"></a>
<a name="ln-7455"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignSpecMSHPIndex</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-7456"></a>            <span class="n">FindItemInList</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignSpecMultispeedHPName</span><span class="p">,</span><span class="n">DesignSpecMSHP</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumDesignSpecMultiSpeedHP</span><span class="p">)</span>
<a name="ln-7457"></a>          <span class="n">DesignSpecNum</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignSpecMSHPIndex</span>
<a name="ln-7458"></a>
<a name="ln-7459"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">DesignSpecNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7460"></a>
<a name="ln-7461"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_MultiSpeedHeating</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7462"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingElectric_MultiStage</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7463"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingGas_MultiStage</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7464"></a><span class="k">              </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span> <span class="o">=</span> <span class="n">DesignSpecMSHP</span><span class="p">(</span><span class="n">DesignSpecNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span>
<a name="ln-7465"></a>              <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="n">DesignSpecMSHP</span><span class="p">(</span><span class="n">DesignSpecNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span><span class="p">))</span>
<a name="ln-7466"></a>              <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">DesignSpecMSHP</span><span class="p">(</span><span class="n">DesignSpecNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span><span class="p">))</span>
<a name="ln-7467"></a>              <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSHeatingSpeedRatio</span><span class="p">(</span><span class="n">DesignSpecMSHP</span><span class="p">(</span><span class="n">DesignSpecNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span><span class="p">))</span>
<a name="ln-7468"></a>              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSHeatingSpeedRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7469"></a>            <span class="k">END IF</span>
<a name="ln-7470"></a>
<a name="ln-7471"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_MultiSpeedCooling</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7472"></a><span class="k">              </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span> <span class="o">=</span> <span class="n">DesignSpecMSHP</span><span class="p">(</span><span class="n">DesignSpecNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span>
<a name="ln-7473"></a>              <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">DesignSpecMSHP</span><span class="p">(</span><span class="n">DesignSpecNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span><span class="p">))</span>
<a name="ln-7474"></a>              <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">DesignSpecMSHP</span><span class="p">(</span><span class="n">DesignSpecNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span><span class="p">))</span>
<a name="ln-7475"></a>              <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSCoolingSpeedRatio</span><span class="p">(</span><span class="n">DesignSpecMSHP</span><span class="p">(</span><span class="n">DesignSpecNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span><span class="p">))</span>
<a name="ln-7476"></a>              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSCoolingSpeedRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7477"></a>            <span class="k">END IF</span>
<a name="ln-7478"></a><span class="k">          ELSE</span>
<a name="ln-7479"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7480"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... one or both of the following inputs are invalid.&#39;</span><span class="p">)</span>
<a name="ln-7481"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Field &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iDesignSpecMSHPTypeAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7482"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iDesignSpecMSHPTypeAlphaNum</span><span class="p">)))</span>
<a name="ln-7483"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Field &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iDesignSpecMSHPNameAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7484"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iDesignSpecMSHPNameAlphaNum</span><span class="p">)))</span>
<a name="ln-7485"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7486"></a>          <span class="k">END IF</span>
<a name="ln-7487"></a><span class="k">        </span><span class="n">ELSEIF</span><span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">iDesignSpecMSHPTypeAlphaNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">iDesignSpecMSHPNameAlphaNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7488"></a>                <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">iDesignSpecMSHPTypeAlphaNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">iDesignSpecMSHPNameAlphaNum</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-7489"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7490"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... one or both of the following inputs are invalid.&#39;</span><span class="p">)</span>
<a name="ln-7491"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Field &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iDesignSpecMSHPTypeAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7492"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iDesignSpecMSHPTypeAlphaNum</span><span class="p">)))</span>
<a name="ln-7493"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Field &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">iDesignSpecMSHPNameAlphaNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7494"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">iDesignSpecMSHPNameAlphaNum</span><span class="p">)))</span>
<a name="ln-7495"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7496"></a>        <span class="n">ELSEIF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7497"></a><span class="k">          </span><span class="n">NumOfSpeedHeating</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span>
<a name="ln-7498"></a>
<a name="ln-7499"></a>          <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="n">NumOfSpeedHeating</span><span class="p">))</span>
<a name="ln-7500"></a>          <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">NumOfSpeedHeating</span><span class="p">))</span>
<a name="ln-7501"></a>          <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSHeatingSpeedRatio</span><span class="p">(</span><span class="n">NumOfSpeedHeating</span><span class="p">))</span>
<a name="ln-7502"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSHeatingSpeedRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7503"></a>
<a name="ln-7504"></a>        <span class="n">ELSEIF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7505"></a><span class="k">          </span><span class="n">NumOfSpeedCooling</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span>
<a name="ln-7506"></a>
<a name="ln-7507"></a>          <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">NumOfSpeedCooling</span><span class="p">))</span>
<a name="ln-7508"></a>          <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">NumOfSpeedCooling</span><span class="p">))</span>
<a name="ln-7509"></a>          <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSCoolingSpeedRatio</span><span class="p">(</span><span class="n">NumOfSpeedCooling</span><span class="p">))</span>
<a name="ln-7510"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSCoolingSpeedRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7511"></a>
<a name="ln-7512"></a>        <span class="k">END IF</span>
<a name="ln-7513"></a>
<a name="ln-7514"></a><span class="k">        IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MultiSpeedCoolingCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7515"></a>
<a name="ln-7516"></a><span class="k">           </span><span class="nb">Index</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignSpecMSHPIndex</span>
<a name="ln-7517"></a>           <span class="k">IF</span><span class="p">(</span><span class="nb">Index</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7518"></a>             <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span> <span class="o">=</span> <span class="n">DesignSpecMSHP</span><span class="p">(</span><span class="nb">Index</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span>
<a name="ln-7519"></a>
<a name="ln-7520"></a>           <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7521"></a><span class="k">             CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7522"></a>             <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Cooling coil object type requires valid number of speeds for cooling to be specified&#39;</span><span class="p">)</span>
<a name="ln-7523"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7524"></a>           <span class="k">END IF</span>
<a name="ln-7525"></a><span class="k">        END IF</span>
<a name="ln-7526"></a><span class="k">        IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MultiSpeedHeatingCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7527"></a>
<a name="ln-7528"></a><span class="k">           </span><span class="nb">Index</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignSpecMSHPIndex</span>
<a name="ln-7529"></a>           <span class="k">IF</span><span class="p">(</span><span class="nb">Index</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7530"></a>             <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span> <span class="o">=</span> <span class="n">DesignSpecMSHP</span><span class="p">(</span><span class="nb">Index</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span>
<a name="ln-7531"></a>
<a name="ln-7532"></a>           <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7533"></a><span class="k">             CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7534"></a>             <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Heating coil object type requires valid number of speeds for heating to be specified&#39;</span><span class="p">)</span>
<a name="ln-7535"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7536"></a>           <span class="k">END IF</span>
<a name="ln-7537"></a><span class="k">        END IF</span>
<a name="ln-7538"></a>
<a name="ln-7539"></a>        <span class="c">! set global logicals that denote coil type</span>
<a name="ln-7540"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MultiSpeedHeatingCoil</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">VarSpeedHeatingCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7541"></a><span class="k">          </span><span class="n">MultiOrVarSpeedHeatCoil</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7542"></a>        <span class="k">END IF</span>
<a name="ln-7543"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MultiSpeedCoolingCoil</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">VarSpeedCoolingCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7544"></a><span class="k">          </span><span class="n">MultiOrVarSpeedCoolCoil</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7545"></a>        <span class="k">END IF</span>
<a name="ln-7546"></a>
<a name="ln-7547"></a><span class="k">      END DO</span>  <span class="c">!End of the Unitary System Loop</span>
<a name="ln-7548"></a>
<a name="ln-7549"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7550"></a><span class="k">          CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Errors found in input.  Program terminates.&#39;</span><span class="p">)</span>
<a name="ln-7551"></a>      <span class="k">END IF</span>
<a name="ln-7552"></a>
<a name="ln-7553"></a>      <span class="c">! Setup Report variables for the Unitary System that are not reported in the components themselves</span>
<a name="ln-7554"></a>      <span class="k">DO </span><span class="n">UnitarySysNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumUnitarySystem</span>
<a name="ln-7555"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Part Load Ratio []&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">PartLoadFrac</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7556"></a>                             <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-7557"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Total Cooling Rate [W]&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">TotCoolEnergyRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7558"></a>                             <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-7559"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Sensible Cooling Rate [W]&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SensCoolEnergyRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7560"></a>                             <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-7561"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Latent Cooling Rate [W]&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">LatCoolEnergyRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7562"></a>                             <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-7563"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Total Heating Rate [W]&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">TotHeatEnergyRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7564"></a>                             <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-7565"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Sensible Heating Rate [W]&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SensHeatEnergyRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7566"></a>                             <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-7567"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Latent Heating Rate [W]&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">LatHeatEnergyRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7568"></a>                             <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-7569"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Ancillary Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7570"></a>                              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">TotalAuxElecPower</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7571"></a>                             <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-7572"></a>
<a name="ln-7573"></a><span class="c">!        IF(UnitarySystem(UnitarySysNum)%DehumidControlType_Num .EQ. DehumidControl_CoolReheat)THEN</span>
<a name="ln-7574"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Dehumidification Induced Heating Demand Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7575"></a>                                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DehumidInducedHeatingDemandRate</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7576"></a>                                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-7577"></a><span class="c">!        END IF</span>
<a name="ln-7578"></a>
<a name="ln-7579"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7580"></a><span class="k">          CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Fan Part Load Ratio []&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanPartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7581"></a>                             <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-7582"></a>        <span class="k">END IF</span>
<a name="ln-7583"></a>
<a name="ln-7584"></a><span class="k">        CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Compressor Part Load Ratio []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7585"></a>                                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7586"></a>                                 <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-7587"></a>
<a name="ln-7588"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Frost Control Status []&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FrostControlStatus</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7589"></a>                                 <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-7590"></a>
<a name="ln-7591"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7592"></a><span class="k">          CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Heating Ancillary Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7593"></a>                  <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingAuxElecConsumption</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7594"></a>                  <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;Heating&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-7595"></a>        <span class="k">END IF</span>
<a name="ln-7596"></a>
<a name="ln-7597"></a><span class="k">        SELECT CASE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span><span class="p">)</span>
<a name="ln-7598"></a>          <span class="k">CASE</span><span class="p">(</span><span class="n">CoilDX_CoolingTwoSpeed</span><span class="p">)</span>
<a name="ln-7599"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Cycling Ratio []&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CycRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7600"></a>                                <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-7601"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Compressor Speed Ratio []&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SpeedRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7602"></a>                                <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-7603"></a>          <span class="k">CASE</span><span class="p">(</span><span class="n">CoilDX_MultiSpeedCooling</span><span class="p">)</span>
<a name="ln-7604"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Cooling Ancillary Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7605"></a>                     <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingAuxElecConsumption</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7606"></a>                     <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;Cooling&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-7607"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Electric Power [W]&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ElecPower</span><span class="p">,&amp;</span>
<a name="ln-7608"></a>                                     <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-7609"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Electric Energy [J]&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ElecPowerConsumption</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7610"></a>                                     <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-7611"></a><span class="c">!            CALL SetupOutputVariable(&#39;Unitary System Cooling Coil Cycling Ratio []&#39;,UnitarySystem(UnitarySysNum)%CoolingCycRatio, &amp;</span>
<a name="ln-7612"></a><span class="c">!                                     &#39;System&#39;,&#39;Average&#39;,UnitarySystem(UnitarySysNum)%Name)</span>
<a name="ln-7613"></a><span class="c">!            CALL SetupOutputVariable(&#39;Unitary System Cooling Coil Speed Ratio []&#39;,UnitarySystem(UnitarySysNum)%CoolingSpeedRatio, &amp;</span>
<a name="ln-7614"></a><span class="c">!                                     &#39;System&#39;,&#39;Average&#39;,UnitarySystem(UnitarySysNum)%Name)</span>
<a name="ln-7615"></a><span class="c">!            CALL SetupOutputVariable(&#39;Unitary System Cooling Coil Speed Level []&#39;,UnitarySystem(UnitarySysNum)%CoolingSpeedNum, &amp;</span>
<a name="ln-7616"></a><span class="c">!                                     &#39;System&#39;,&#39;Average&#39;,UnitarySystem(UnitarySysNum)%Name)</span>
<a name="ln-7617"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatRecActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7618"></a><span class="k">              CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Heat Recovery Rate [W]&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatRecoveryRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7619"></a>                      <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-7620"></a>              <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Heat Recovery Inlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7621"></a>                      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatRecoveryInletTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-7622"></a>              <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Heat Recovery Outlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7623"></a>                      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatRecoveryOutletTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-7624"></a>              <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Heat Recovery Fluid Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7625"></a>                      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatRecoveryMassFlowRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-7626"></a>              <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Heat Recovery Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7627"></a>                      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatRecoveryEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-7628"></a>            <span class="k">END IF</span>
<a name="ln-7629"></a><span class="k">          CASE</span> <span class="p">(</span><span class="n">Coil_CoolingAirToAirVariableSpeed</span><span class="p">,</span> <span class="n">Coil_CoolingWaterToAirHPVSEquationFit</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7630"></a>                <span class="n">Coil_CoolingWaterToAirHPSimple</span><span class="p">,</span> <span class="n">Coil_CoolingWaterToAirHP</span><span class="p">)</span>
<a name="ln-7631"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Requested Sensible Cooling Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7632"></a>                                  <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilSensDemand</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7633"></a>                                  <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-7634"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Requested Latent Cooling Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7635"></a>                                  <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilLatentDemand</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7636"></a>                                  <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-7637"></a>          <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-7638"></a>        <span class="k">END SELECT</span>
<a name="ln-7639"></a>
<a name="ln-7640"></a><span class="k">        SELECT CASE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span><span class="p">)</span>
<a name="ln-7641"></a>          <span class="k">CASE</span><span class="p">(</span><span class="n">CoilDX_MultiSpeedHeating</span><span class="p">,</span> <span class="n">Coil_HeatingElectric_MultiStage</span><span class="p">,</span> <span class="n">Coil_HeatingGas_MultiStage</span><span class="p">)</span>
<a name="ln-7642"></a><span class="c">!            CALL SetupOutputVariable(&#39;Unitary System Heating Coil Cycling Ratio []&#39;, &amp;</span>
<a name="ln-7643"></a><span class="c">!                                      UnitarySystem(UnitarySysNum)%HeatingCycRatio, &amp;</span>
<a name="ln-7644"></a><span class="c">!                                     &#39;System&#39;,&#39;Average&#39;,UnitarySystem(UnitarySysNum)%Name)</span>
<a name="ln-7645"></a><span class="c">!            CALL SetupOutputVariable(&#39;Unitary System Heating Coil Speed Ratio []&#39;, &amp;</span>
<a name="ln-7646"></a><span class="c">!                                      UnitarySystem(UnitarySysNum)%HeatingSpeedRatio, &amp;</span>
<a name="ln-7647"></a><span class="c">!                                     &#39;System&#39;,&#39;Average&#39;,UnitarySystem(UnitarySysNum)%Name)</span>
<a name="ln-7648"></a><span class="c">!            CALL SetupOutputVariable(&#39;Unitary System Heating Coil Speed Level []&#39;, &amp;</span>
<a name="ln-7649"></a><span class="c">!                                      UnitarySystem(UnitarySysNum)%HeatingSpeedNum, &amp;</span>
<a name="ln-7650"></a><span class="c">!                                     &#39;System&#39;,&#39;Average&#39;,UnitarySystem(UnitarySysNum)%Name)</span>
<a name="ln-7651"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_HeatingAirToAirVariableSpeed</span><span class="p">,</span> <span class="n">Coil_HeatingWaterToAirHPVSEquationFit</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7652"></a>                <span class="n">Coil_HeatingWaterToAirHPSimple</span><span class="p">,</span> <span class="n">Coil_HeatingWaterToAirHP</span><span class="p">)</span>
<a name="ln-7653"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Requested Heating Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7654"></a>                                      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilSensDemand</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7655"></a>                                     <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-7656"></a>          <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-7657"></a>        <span class="k">END SELECT</span>
<a name="ln-7658"></a>
<a name="ln-7659"></a><span class="k">        IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_MultiSpeedCooling</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7660"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_MultiSpeedHeating</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7661"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingElectric_MultiStage</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7662"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingGas_MultiStage</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7663"></a><span class="k">            CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System DX Coil Cycling Ratio []&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CycRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7664"></a>                                     <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-7665"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System DX Coil Speed Ratio []&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SpeedRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7666"></a>                                     <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-7667"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System DX Coil Speed Level []&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SpeedNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7668"></a>                                     <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-7669"></a>        <span class="k">END IF</span>
<a name="ln-7670"></a>
<a name="ln-7671"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">AnyEnergyManagementSystemInModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7672"></a><span class="k">          CALL </span><span class="n">SetupEMSActuator</span><span class="p">(</span><span class="s1">&#39;AirLoopHVAC:UnitarySystem&#39;</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-7673"></a>                                <span class="s1">&#39;Autosized Supply Air Flow Rate&#39;</span><span class="p">,</span> <span class="s1">&#39;[m3/s]&#39;</span><span class="p">,</span>                          <span class="p">&amp;</span>
<a name="ln-7674"></a>                                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRateEMSOverrideOn</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-7675"></a>                                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRateEMSOverrideValue</span> <span class="p">)</span>
<a name="ln-7676"></a>          <span class="k">CALL </span><span class="n">SetupEMSActuator</span><span class="p">(</span><span class="s1">&#39;AirLoopHVAC:UnitarySystem&#39;</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-7677"></a>                                <span class="s1">&#39;Autosized Supply Air Flow Rate During Cooling Operation&#39;</span><span class="p">,</span> <span class="s1">&#39;[m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7678"></a>                                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlowEMSOverrideOn</span><span class="p">,</span>      <span class="p">&amp;</span>
<a name="ln-7679"></a>                                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlowEMSOverrideValue</span> <span class="p">)</span>
<a name="ln-7680"></a>          <span class="k">CALL </span><span class="n">SetupEMSActuator</span><span class="p">(</span><span class="s1">&#39;AirLoopHVAC:UnitarySystem&#39;</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-7681"></a>                                <span class="s1">&#39;Autosized Supply Air Flow Rate During Heating Operation&#39;</span><span class="p">,</span> <span class="s1">&#39;[m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7682"></a>                                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlowEMSOverrideOn</span><span class="p">,</span>      <span class="p">&amp;</span>
<a name="ln-7683"></a>                                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlowEMSOverrideValue</span> <span class="p">)</span>
<a name="ln-7684"></a>          <span class="k">CALL </span><span class="n">SetupEMSActuator</span><span class="p">(</span><span class="s1">&#39;AirLoopHVAC:UnitarySystem&#39;</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-7685"></a>                                <span class="s1">&#39;Autosized Supply Air Flow Rate During No Heating or Cooling Operation&#39;</span><span class="p">,</span> <span class="s1">&#39;[m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7686"></a>                                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlowEMSOverrideOn</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7687"></a>                                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlowEMSOverrideValue</span> <span class="p">)</span>
<a name="ln-7688"></a>        <span class="k">END IF</span>
<a name="ln-7689"></a>
<a name="ln-7690"></a><span class="k">      END DO</span>
<a name="ln-7691"></a>
<a name="ln-7692"></a><span class="k">      DEALLOCATE</span><span class="p">(</span><span class="n">Alphas</span><span class="p">)</span>
<a name="ln-7693"></a>      <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">)</span>
<a name="ln-7694"></a>      <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">)</span>
<a name="ln-7695"></a>      <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">Numbers</span><span class="p">)</span>
<a name="ln-7696"></a>      <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">)</span>
<a name="ln-7697"></a>      <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">lNumericBlanks</span><span class="p">)</span>
<a name="ln-7698"></a>
<a name="ln-7699"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">AnyEnergyManagementSystemInModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7700"></a><span class="k">        DO </span><span class="n">UnitarySysNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumUnitarySystem</span>
<a name="ln-7701"></a>          <span class="k">CALL </span><span class="n">SetupEMSInternalVariable</span><span class="p">(</span><span class="s1">&#39;Unitary HVAC Design Heating Capacity&#39;</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="s1">&#39;[W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7702"></a>                        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span>  <span class="p">)</span>
<a name="ln-7703"></a>          <span class="k">CALL </span><span class="n">SetupEMSInternalVariable</span><span class="p">(</span><span class="s1">&#39;Unitary HVAC Design Cooling Capacity&#39;</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="s1">&#39;[W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7704"></a>                        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignCoolingCapacity</span>  <span class="p">)</span>
<a name="ln-7705"></a>          <span class="k">CALL </span><span class="n">SetupEMSActuator</span><span class="p">(</span><span class="s1">&#39;Unitary HVAC&#39;</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="s1">&#39;Sensible Load Request&#39;</span> <span class="p">,</span> <span class="s1">&#39;[W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7706"></a>                        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">EMSOverrideSensZoneLoadRequest</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7707"></a>                        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">EMSSensibleZoneLoadValue</span> <span class="p">)</span>
<a name="ln-7708"></a>          <span class="k">CALL </span><span class="n">SetupEMSActuator</span><span class="p">(</span><span class="s1">&#39;Unitary HVAC&#39;</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="s1">&#39;Moisture Load Request&#39;</span> <span class="p">,</span> <span class="s1">&#39;[W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7709"></a>                        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">EMSOverrideMoistZoneLoadRequest</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7710"></a>                        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">EMSMoistureZoneLoadValue</span> <span class="p">)</span>
<a name="ln-7711"></a>
<a name="ln-7712"></a>        <span class="k">END DO</span>
<a name="ln-7713"></a><span class="k">      END IF</span>
<a name="ln-7714"></a>
<a name="ln-7715"></a><span class="k">      CALL </span><span class="n">ManageEMS</span><span class="p">(</span><span class="n">emsCALLFromComponentGetInput</span><span class="p">)</span>
<a name="ln-7716"></a>
<a name="ln-7717"></a>
<a name="ln-7718"></a>  <span class="k">RETURN</span>
<a name="ln-7719"></a>
<a name="ln-7720"></a><span class="k">END SUBROUTINE </span><span class="n">GetUnitarySystemInput</span>
<a name="ln-7721"></a>
<a name="ln-7722"></a>
<a name="ln-7723"></a><span class="c">! End of Get Input subroutines for the Module</span>
<a name="ln-7724"></a><span class="c">!******************************************************************************</span>
<a name="ln-7725"></a>
<a name="ln-7726"></a>
<a name="ln-7727"></a><span class="c">! Beginning of Calculation subroutines for the DXCoolingSystem Module</span>
<a name="ln-7728"></a><span class="c">! *****************************************************************************</span>
<a name="ln-7729"></a>
<a name="ln-7730"></a><span class="k">SUBROUTINE </span><span class="n">ControlUnitarySystemtoSP</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">AirLoopNum</span><span class="p">,</span><span class="n">OAUCoilOutTemp</span><span class="p">,</span><span class="n">HXUnitOn</span><span class="p">)</span>
<a name="ln-7731"></a>
<a name="ln-7732"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-7733"></a>          <span class="c">!       AUTHOR         Richard Raustad, FSEC</span>
<a name="ln-7734"></a>          <span class="c">!       DATE WRITTEN   February 2013</span>
<a name="ln-7735"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-7736"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-7737"></a>
<a name="ln-7738"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-7739"></a>          <span class="c">! This subroutine manages DXCoolingSystem component simulation.</span>
<a name="ln-7740"></a>
<a name="ln-7741"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7742"></a>          <span class="c">! na</span>
<a name="ln-7743"></a>
<a name="ln-7744"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-7745"></a>          <span class="c">! na</span>
<a name="ln-7746"></a>
<a name="ln-7747"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7748"></a>  <span class="k">USE </span><span class="n">Fans</span><span class="p">,</span>             <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateFanComponents</span>
<a name="ln-7749"></a>
<a name="ln-7750"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7751"></a>
<a name="ln-7752"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-7753"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">UnitarySysNum</span>       <span class="c">! Index of AirloopHVAC:UnitarySystem object</span>
<a name="ln-7754"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">FirstHVACIteration</span>  <span class="c">! True when first HVAC iteration</span>
<a name="ln-7755"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">AirLoopNum</span>          <span class="c">! Primary air loop number</span>
<a name="ln-7756"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">OAUCoilOutTemp</span>   <span class="c">! the coil inlet temperature of OutdoorAirUnit</span>
<a name="ln-7757"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">HXUnitOn</span>        <span class="c">! Flag to control HX for HXAssisted Cooling Coil</span>
<a name="ln-7758"></a>
<a name="ln-7759"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-7760"></a>          <span class="c">! na</span>
<a name="ln-7761"></a>
<a name="ln-7762"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-7763"></a>          <span class="c">! na</span>
<a name="ln-7764"></a>
<a name="ln-7765"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-7766"></a>          <span class="c">! na</span>
<a name="ln-7767"></a>
<a name="ln-7768"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7769"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">PartLoadRatio</span>         <span class="c">! coil operating part-load ratio</span>
<a name="ln-7770"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>     <span class="c">! Setpoint based coil control does not use this variable</span>
<a name="ln-7771"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">CoilCoolHeatRat</span>       <span class="c">! ratio of cooling to heating PLR for cycling fan RH control</span>
<a name="ln-7772"></a>  <span class="kt">INTEGER</span>                       <span class="kd">::</span> <span class="n">CompOn</span>                <span class="c">! compressor control (0=off, 1=on)</span>
<a name="ln-7773"></a>
<a name="ln-7774"></a>  <span class="n">OnOffAirFlowRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7775"></a>  <span class="n">CoilCoolHeatRat</span>   <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7776"></a>
<a name="ln-7777"></a>  <span class="c">!CALL the series of components that simulate a Unitary System</span>
<a name="ln-7778"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanExists</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">BlowThru</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7779"></a><span class="k">    CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanIndex</span><span class="p">,</span><span class="n">FanSpeedRatio</span><span class="p">)</span>
<a name="ln-7780"></a>  <span class="k">END IF</span>
<a name="ln-7781"></a>
<a name="ln-7782"></a><span class="k">  IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilUpstream</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7783"></a>
<a name="ln-7784"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7785"></a><span class="k">      CALL </span><span class="n">UpdateUnitarySystemControl</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">AirLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7786"></a>                            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilOutletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7787"></a>                            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SystemCoolControlNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7788"></a>                            <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">OAUCoilOutTemp</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-7789"></a>      <span class="k">CALL </span><span class="n">ControlCoolingSystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">HXUnitOn</span><span class="p">)</span>
<a name="ln-7790"></a>      <span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingPartLoadFrac</span>
<a name="ln-7791"></a>      <span class="n">CompOn</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-7792"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">PartLoadRatio</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="n">CompOn</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-7793"></a>      <span class="k">CALL </span><span class="n">CalcUnitaryCoolingSystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7794"></a>                                    <span class="n">CompOn</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">CoilCoolHeatRat</span><span class="p">,</span><span class="n">HXUnitOn</span><span class="p">)</span>
<a name="ln-7795"></a>    <span class="k">END IF</span>
<a name="ln-7796"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7797"></a><span class="k">      CALL </span><span class="n">UpdateUnitarySystemControl</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">AirLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7798"></a>                            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilOutletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7799"></a>                            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SystemHeatControlNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7800"></a>                            <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">OAUCoilOutTemp</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7801"></a>                            <span class="n">MaxOutletTemp</span><span class="o">=</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignMaxOutletTemp</span><span class="p">)</span>
<a name="ln-7802"></a>      <span class="k">CALL </span><span class="n">ControlHeatingSystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-7803"></a>      <span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingPartLoadFrac</span>
<a name="ln-7804"></a>      <span class="n">CompOn</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-7805"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">PartLoadRatio</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="n">CompOn</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-7806"></a>      <span class="k">CALL </span><span class="n">CalcUnitaryHeatingSystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">CompOn</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">)</span>
<a name="ln-7807"></a>    <span class="k">END IF</span>
<a name="ln-7808"></a>
<a name="ln-7809"></a><span class="k">  ELSE</span>
<a name="ln-7810"></a>
<a name="ln-7811"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7812"></a><span class="k">      CALL </span><span class="n">UpdateUnitarySystemControl</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">AirLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7813"></a>                            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilOutletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7814"></a>                            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SystemHeatControlNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7815"></a>                            <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">OAUCoilOutTemp</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7816"></a>                            <span class="n">MaxOutletTemp</span><span class="o">=</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignMaxOutletTemp</span><span class="p">)</span>
<a name="ln-7817"></a>      <span class="k">CALL </span><span class="n">ControlHeatingSystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-7818"></a>      <span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingPartLoadFrac</span>
<a name="ln-7819"></a>      <span class="n">CompOn</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-7820"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">PartLoadRatio</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="n">CompOn</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-7821"></a>      <span class="k">CALL </span><span class="n">CalcUnitaryHeatingSystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">CompOn</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">)</span>
<a name="ln-7822"></a>    <span class="k">END IF</span>
<a name="ln-7823"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7824"></a><span class="k">      CALL </span><span class="n">UpdateUnitarySystemControl</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">AirLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7825"></a>                            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilOutletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7826"></a>                            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SystemCoolControlNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7827"></a>                            <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">OAUCoilOutTemp</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-7828"></a>      <span class="k">CALL </span><span class="n">ControlCoolingSystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">HXUnitOn</span><span class="p">)</span>
<a name="ln-7829"></a>      <span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingPartLoadFrac</span>
<a name="ln-7830"></a>      <span class="n">CompOn</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-7831"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">PartLoadRatio</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="n">CompOn</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-7832"></a>      <span class="k">CALL </span><span class="n">CalcUnitaryCoolingSystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7833"></a>                                    <span class="n">CompOn</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">CoilCoolHeatRat</span><span class="p">,</span><span class="n">HXUnitOn</span><span class="p">)</span>
<a name="ln-7834"></a>    <span class="k">END IF</span>
<a name="ln-7835"></a>
<a name="ln-7836"></a><span class="k">  END IF</span>
<a name="ln-7837"></a>
<a name="ln-7838"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanExists</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">DrawThru</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7839"></a><span class="k">    CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanIndex</span><span class="p">,</span><span class="n">FanSpeedRatio</span><span class="p">)</span>
<a name="ln-7840"></a>  <span class="k">END IF</span>
<a name="ln-7841"></a>
<a name="ln-7842"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7843"></a><span class="k">    </span><span class="n">SuppHeatingCoilFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7844"></a>    <span class="k">CALL </span><span class="n">UpdateUnitarySystemControl</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">AirLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7845"></a>                          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilAirOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7846"></a>                          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatControlNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7847"></a>                          <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">OAUCoilOutTemp</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7848"></a>                          <span class="n">MaxOutletTemp</span><span class="o">=</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignMaxOutletTemp</span><span class="p">)</span>
<a name="ln-7849"></a>    <span class="k">CALL </span><span class="n">ControlSuppHeatSystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-7850"></a>    <span class="k">CALL </span><span class="n">CalcUnitarySuppSystemToSP</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-7851"></a>    <span class="n">SuppHeatingCoilFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7852"></a>  <span class="k">END IF</span>
<a name="ln-7853"></a>
<a name="ln-7854"></a>
<a name="ln-7855"></a><span class="k">  </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">InitHeatPump</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7856"></a>  <span class="k">RETURN</span>
<a name="ln-7857"></a>
<a name="ln-7858"></a><span class="k">END SUBROUTINE </span><span class="n">ControlUnitarySystemtoSP</span>
<a name="ln-7859"></a>
<a name="ln-7860"></a><span class="k">SUBROUTINE </span><span class="n">ControlUnitarySystemtoLoad</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">AirLoopNum</span><span class="p">,</span><span class="n">CompOn</span><span class="p">,</span><span class="n">OAUCoilOutTemp</span><span class="p">,</span><span class="n">HXUnitOn</span><span class="p">)</span>
<a name="ln-7861"></a>
<a name="ln-7862"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-7863"></a>          <span class="c">!       AUTHOR         Richard Raustad, FSEC</span>
<a name="ln-7864"></a>          <span class="c">!       DATE WRITTEN   February 2013</span>
<a name="ln-7865"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-7866"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-7867"></a>
<a name="ln-7868"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-7869"></a>          <span class="c">! This subroutine manages DXCoolingSystem component simulation.</span>
<a name="ln-7870"></a>
<a name="ln-7871"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7872"></a>          <span class="c">! na</span>
<a name="ln-7873"></a>
<a name="ln-7874"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-7875"></a>          <span class="c">! na</span>
<a name="ln-7876"></a>
<a name="ln-7877"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7878"></a>  <span class="k">USE </span><span class="n">DataAirLoop</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">AirLoopControlInfo</span>
<a name="ln-7879"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">SetComponentFlowRate</span>
<a name="ln-7880"></a>
<a name="ln-7881"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7882"></a>
<a name="ln-7883"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-7884"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">UnitarySysNum</span>    <span class="c">! Index of AirloopHVAC:UnitarySystem object</span>
<a name="ln-7885"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">FirstHVACIteration</span>  <span class="c">! True when first HVAC iteration</span>
<a name="ln-7886"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">AirLoopNum</span>          <span class="c">! Primary air loop number</span>
<a name="ln-7887"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">CompOn</span>              <span class="c">! Determines if compressor is on or off</span>
<a name="ln-7888"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span>  <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">OAUCoilOutTemp</span>      <span class="c">! the coil inlet temperature of OutdoorAirUnit</span>
<a name="ln-7889"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">HXUnitOn</span>            <span class="c">! Flag to control HX for HXAssisted Cooling Coil</span>
<a name="ln-7890"></a>
<a name="ln-7891"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-7892"></a>          <span class="c">! na</span>
<a name="ln-7893"></a>
<a name="ln-7894"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-7895"></a>          <span class="c">! na</span>
<a name="ln-7896"></a>
<a name="ln-7897"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-7898"></a>          <span class="c">! na</span>
<a name="ln-7899"></a>
<a name="ln-7900"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DEFINITIONS:</span>
<a name="ln-7901"></a>          <span class="c">! na</span>
<a name="ln-7902"></a>
<a name="ln-7903"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7904"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">CoolPLR</span>          <span class="c">! cooling part-load ratio</span>
<a name="ln-7905"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">HeatPLR</span>          <span class="c">! heating part-load ratio</span>
<a name="ln-7906"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">SuppPLR</span>          <span class="c">! supplemental heating part-load ratio</span>
<a name="ln-7907"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">SensOutput</span>       <span class="c">! Sensible output of Unitary System (W)</span>
<a name="ln-7908"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">LatOutput</span>        <span class="c">! Latent output of Unitary System (W)</span>
<a name="ln-7909"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">ZoneLoad</span>           <span class="c">! zone load (W)</span>
<a name="ln-7910"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>  <span class="c">! ratio of on to off air flow</span>
<a name="ln-7911"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">QZnReq</span>             <span class="c">! zone load (W)</span>
<a name="ln-7912"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">FullSensibleOutput</span> <span class="c">! sensible output of Unitary System (W)</span>
<a name="ln-7913"></a><span class="c">!  REAL(R64)                     :: FullLatentOutput   ! latent output of Unitary System (W)</span>
<a name="ln-7914"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">SupHeaterLoad</span>    <span class="c">! additional heating required by supplemental heater (W)</span>
<a name="ln-7915"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">HeatCoilLoad</span>     <span class="c">! load pass to heating coil (W)</span>
<a name="ln-7916"></a>
<a name="ln-7917"></a>  <span class="n">OnOffAirFlowRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7918"></a>  <span class="n">QZnReq</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7919"></a>  <span class="k">CALL </span><span class="n">UpdateUnitarySystemControl</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">AirLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7920"></a>                            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilOutletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7921"></a>                            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SystemCoolControlNodeNum</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7922"></a>                            <span class="n">OAUCoilOutTemp</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">ZoneLoad</span><span class="p">)</span>
<a name="ln-7923"></a>
<a name="ln-7924"></a><span class="c">! will not be running supplemental heater on this CALL (simulate with supplemental heater off)</span>
<a name="ln-7925"></a>  <span class="n">FullSensibleOutput</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7926"></a>  <span class="c">! using furnace module logic</span>
<a name="ln-7927"></a>  <span class="c">! first check to see if cycling fan with economizer can meet the load</span>
<a name="ln-7928"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">AirLoopNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7929"></a><span class="k">    IF</span> <span class="p">(</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilExists</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7930"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">/=</span> <span class="n">Coil_CoolingAirToAirVariableSpeed</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7931"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">/=</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7932"></a>        <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FirstHVACIteration</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span> <span class="o">==</span> <span class="n">CycFanCycCoil</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">CoolingLoad</span> <span class="p">&amp;</span>
<a name="ln-7933"></a>         <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">AirLoopControlInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">EconoActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7934"></a><span class="k">      </span><span class="n">CompOn</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-7935"></a>      <span class="k">CALL </span><span class="n">ControlUnitarySystemOutput</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7936"></a>                                    <span class="n">HXUnitOn</span><span class="p">,</span> <span class="n">ZoneLoad</span><span class="p">,</span> <span class="n">FullSensibleOutput</span><span class="p">,</span> <span class="n">CompOn</span><span class="p">)</span>
<a name="ln-7937"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingPartLoadFrac</span> <span class="o">&gt;=</span> <span class="mf">1.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingPartLoadFrac</span> <span class="o">&gt;=</span> <span class="mf">1.0d0</span> <span class="p">&amp;</span>
<a name="ln-7938"></a>           <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingPartLoadFrac</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7939"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingPartLoadFrac</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7940"></a><span class="k">        </span><span class="n">CompOn</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-7941"></a>        <span class="k">CALL </span><span class="n">ControlUnitarySystemOutput</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7942"></a>                                      <span class="n">HXUnitOn</span><span class="p">,</span> <span class="n">ZoneLoad</span><span class="p">,</span> <span class="n">FullSensibleOutput</span><span class="p">,</span> <span class="n">CompOn</span><span class="p">)</span>
<a name="ln-7943"></a>      <span class="k">END IF</span>
<a name="ln-7944"></a><span class="k">    ELSE</span>
<a name="ln-7945"></a><span class="k">      </span><span class="n">CompOn</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-7946"></a>      <span class="k">CALL </span><span class="n">ControlUnitarySystemOutput</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7947"></a>                                  <span class="n">HXUnitOn</span><span class="p">,</span> <span class="n">ZoneLoad</span><span class="p">,</span> <span class="n">FullSensibleOutput</span><span class="p">,</span> <span class="n">CompOn</span><span class="p">)</span>
<a name="ln-7948"></a>    <span class="k">END IF</span>
<a name="ln-7949"></a><span class="k">  ELSE</span>
<a name="ln-7950"></a><span class="k">    </span><span class="n">CompOn</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-7951"></a>    <span class="k">CALL </span><span class="n">ControlUnitarySystemOutput</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7952"></a>                                  <span class="n">HXUnitOn</span><span class="p">,</span> <span class="n">ZoneLoad</span><span class="p">,</span> <span class="n">FullSensibleOutput</span><span class="p">,</span> <span class="n">CompOn</span><span class="p">)</span>
<a name="ln-7953"></a>  <span class="k">END IF</span>
<a name="ln-7954"></a><span class="k">  </span><span class="n">CoolPLR</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingPartLoadFrac</span>
<a name="ln-7955"></a>  <span class="n">HeatPLR</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingPartLoadFrac</span>
<a name="ln-7956"></a>  <span class="n">HeatCoilLoad</span> <span class="o">=</span> <span class="n">HeatPLR</span> <span class="o">*</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span>
<a name="ln-7957"></a>  <span class="n">SensOutput</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7958"></a>  <span class="n">LatOutput</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7959"></a>
<a name="ln-7960"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilFluidInletNode</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7961"></a><span class="k">    CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilFluidInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7962"></a>                               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilFluidInletNode</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-7963"></a>                               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilFluidOutletNodeNum</span><span class="p">,&amp;</span>
<a name="ln-7964"></a>                               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7965"></a>                               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilLoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7966"></a>                               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7967"></a>                               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilCompNum</span> <span class="p">)</span>
<a name="ln-7968"></a>  <span class="k">END IF</span>
<a name="ln-7969"></a><span class="k">  IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilFluidInletNode</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7970"></a><span class="k">    CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilFluidInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7971"></a>                               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilFluidInletNode</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-7972"></a>                               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilFluidOutletNodeNum</span><span class="p">,&amp;</span>
<a name="ln-7973"></a>                               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7974"></a>                               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilLoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7975"></a>                               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7976"></a>                               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilCompNum</span> <span class="p">)</span>
<a name="ln-7977"></a>  <span class="k">END IF</span>
<a name="ln-7978"></a>
<a name="ln-7979"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilExists</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">HeatingLoad</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CoolingLoad</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">MoistureLoad</span><span class="o">&lt;</span><span class="mf">0.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7980"></a><span class="k">    IF</span><span class="p">((</span><span class="n">FullSensibleOutput</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">QToHeatSetPt</span> <span class="o">-</span> <span class="n">SmallLoad</span><span class="p">))</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FirstHVACIteration</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7981"></a><span class="k">      </span><span class="n">SupHeaterLoad</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">QToHeatSetPt</span> <span class="o">-</span> <span class="n">FullSensibleOutput</span><span class="p">)</span>
<a name="ln-7982"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SupHeaterLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7983"></a><span class="c">! what does this line even do? I know we want the supplemental heater on only if there is a dehum load,</span>
<a name="ln-7984"></a><span class="c">! but for HP&#39;s the supp heater should also run if the heating coil can&#39;t turn on</span>
<a name="ln-7985"></a><span class="c">! (i.e., this line calc&#39;s a supp heater load, then next line also calc&#39;s it?)</span>
<a name="ln-7986"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MoistureLoad</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7987"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SupHeaterLoad</span> <span class="o">=</span> <span class="n">SupHeaterLoad</span>
<a name="ln-7988"></a><span class="c">! so it look&#39;s like this next line should only be valid for HP&#39;s.</span>
<a name="ln-7989"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7990"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatPartLoadFrac</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-7991"></a>             <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">SupHeaterLoad</span><span class="o">/</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span><span class="p">)</span>
<a name="ln-7992"></a>      <span class="k">END IF</span>
<a name="ln-7993"></a><span class="k">    ELSE</span>
<a name="ln-7994"></a><span class="k">      </span><span class="n">SupHeaterLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7995"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatPartLoadFrac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7996"></a>    <span class="k">END IF</span>
<a name="ln-7997"></a><span class="k">  ELSE</span>
<a name="ln-7998"></a><span class="k">    </span><span class="n">SupHeaterLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7999"></a>    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatPartLoadFrac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8000"></a>  <span class="k">END IF</span>
<a name="ln-8001"></a>
<a name="ln-8002"></a><span class="k">  CALL </span><span class="n">CalcUnitarySystemToLoad</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CoolPLR</span><span class="p">,</span><span class="n">HeatPLR</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8003"></a>         <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SensOutput</span><span class="p">,</span><span class="n">LatOutput</span><span class="p">,</span><span class="n">HXUnitOn</span><span class="p">,</span><span class="n">HeatCoilLoad</span><span class="o">=</span><span class="n">HeatCoilLoad</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8004"></a>         <span class="n">SuppCoilLoad</span><span class="o">=</span><span class="n">SupHeaterLoad</span><span class="p">,</span><span class="n">CompOn</span><span class="o">=</span><span class="n">CompOn</span><span class="p">)</span>
<a name="ln-8005"></a>
<a name="ln-8006"></a>  <span class="c">! check supplemental heating coil outlet temp based on maximum allowed</span>
<a name="ln-8007"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8008"></a><span class="k">    </span><span class="n">SuppPLR</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatPartLoadFrac</span>
<a name="ln-8009"></a>    <span class="c">! only need to test for high supply air temp if supplemental coil is operating</span>
<a name="ln-8010"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SuppPLR</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8011"></a><span class="k">      CALL </span><span class="n">CalcUnitarySystemToLoad</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CoolPLR</span><span class="p">,</span><span class="n">HeatPLR</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8012"></a>             <span class="n">SensOutput</span><span class="p">,</span><span class="n">LatOutput</span><span class="p">,</span><span class="n">HXUnitOn</span><span class="p">,</span><span class="n">HeatCoilLoad</span><span class="o">=</span><span class="n">HeatCoilLoad</span><span class="p">,</span><span class="n">SuppCoilLoad</span><span class="o">=</span><span class="n">SupHeaterLoad</span><span class="p">,</span> <span class="n">CompOn</span><span class="o">=</span><span class="n">CompOn</span><span class="p">)</span>
<a name="ln-8013"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8014"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatPartLoadFrac</span> <span class="o">=</span> <span class="n">SupHeaterLoad</span><span class="o">/</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span>
<a name="ln-8015"></a>      <span class="k">ELSE</span>
<a name="ln-8016"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatPartLoadFrac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8017"></a>      <span class="k">END IF</span>
<a name="ln-8018"></a><span class="k">    END IF</span>
<a name="ln-8019"></a><span class="k">  END IF</span>
<a name="ln-8020"></a>
<a name="ln-8021"></a><span class="k">  IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilFluidInletNode</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8022"></a><span class="k">    CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilFluidInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8023"></a>                               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilFluidInletNode</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-8024"></a>                               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilFluidOutletNodeNum</span><span class="p">,&amp;</span>
<a name="ln-8025"></a>                               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8026"></a>                               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilLoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8027"></a>                               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8028"></a>                               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilCompNum</span> <span class="p">)</span>
<a name="ln-8029"></a>  <span class="k">END IF</span>
<a name="ln-8030"></a>
<a name="ln-8031"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatRecActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8032"></a><span class="k">    CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatRecoveryInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8033"></a>                              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatRecoveryInletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8034"></a>                              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatRecoveryOutletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8035"></a>                              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8036"></a>                              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HRLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8037"></a>                              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HRBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8038"></a>                              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HRCompNum</span> <span class="p">)</span>
<a name="ln-8039"></a>  <span class="k">END IF</span>
<a name="ln-8040"></a>
<a name="ln-8041"></a><span class="k">  RETURN</span>
<a name="ln-8042"></a>
<a name="ln-8043"></a><span class="k">END SUBROUTINE </span><span class="n">ControlUnitarySystemtoLoad</span>
<a name="ln-8044"></a>
<a name="ln-8045"></a><span class="k">SUBROUTINE </span><span class="n">ControlUnitarySystemOutput</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">HXUnitOn</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8046"></a>                                      <span class="n">ZoneLoad</span><span class="p">,</span> <span class="n">FullSensibleOutput</span><span class="p">,</span> <span class="n">CompOn</span><span class="p">)</span>
<a name="ln-8047"></a>
<a name="ln-8048"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-8049"></a>          <span class="c">!       AUTHOR         Richard Raustad, FSEC</span>
<a name="ln-8050"></a>          <span class="c">!       DATE WRITTEN   February 2013</span>
<a name="ln-8051"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8052"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8053"></a>
<a name="ln-8054"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-8055"></a>          <span class="c">! This subroutine determines operating PLR and calculates the load based system output.</span>
<a name="ln-8056"></a>
<a name="ln-8057"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8058"></a>          <span class="c">! na</span>
<a name="ln-8059"></a>
<a name="ln-8060"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8061"></a>          <span class="c">! na</span>
<a name="ln-8062"></a>
<a name="ln-8063"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8064"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>           <span class="n">ONLY</span><span class="p">:</span> <span class="n">SolveRegulaFalsi</span><span class="p">,</span> <span class="n">TrimSigDigits</span>
<a name="ln-8065"></a>  <span class="k">USE </span><span class="n">DataHeatBalFanSys</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TempControlType</span>
<a name="ln-8066"></a>  <span class="k">USE </span><span class="n">Psychrometrics</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">PsyCpAirFnWTdb</span>
<a name="ln-8067"></a>
<a name="ln-8068"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8069"></a>
<a name="ln-8070"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-8071"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">UnitarySysNum</span>    <span class="c">! Index of AirloopHVAC:UnitarySystem object</span>
<a name="ln-8072"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">FirstHVACIteration</span>  <span class="c">! True when first HVAC iteration</span>
<a name="ln-8073"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>   <span class="c">! ratio of heating PLR to cooling PLR (is this correct?)</span>
<a name="ln-8074"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">HXUnitOn</span>            <span class="c">! Flag to control HX for HXAssisted Cooling Coil</span>
<a name="ln-8075"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">ZoneLoad</span>
<a name="ln-8076"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">FullSensibleOutput</span>
<a name="ln-8077"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">OPTIONAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompOn</span>
<a name="ln-8078"></a>
<a name="ln-8079"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-8080"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">PARAMETER</span>  <span class="kd">::</span>  <span class="n">MaxIter</span> <span class="o">=</span> <span class="mi">100</span>        <span class="c">! maximum number of iterations</span>
<a name="ln-8081"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>  <span class="kd">::</span>  <span class="n">MinPLR</span>  <span class="o">=</span> <span class="mf">0.0d0</span>      <span class="c">! minimum part load ratio allowed</span>
<a name="ln-8082"></a>
<a name="ln-8083"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-8084"></a>          <span class="c">! na</span>
<a name="ln-8085"></a>
<a name="ln-8086"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-8087"></a>          <span class="c">! na</span>
<a name="ln-8088"></a>
<a name="ln-8089"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DEFINITIONS:</span>
<a name="ln-8090"></a>          <span class="c">! na</span>
<a name="ln-8091"></a>
<a name="ln-8092"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8093"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CompName</span>           <span class="c">! Name of Unitary System object</span>
<a name="ln-8094"></a>  <span class="kt">INTEGER</span>                       <span class="kd">::</span> <span class="n">InletNode</span>          <span class="c">! DX System inlet node number</span>
<a name="ln-8095"></a>  <span class="kt">INTEGER</span>                       <span class="kd">::</span> <span class="n">OutletNode</span>         <span class="c">! DX System outlet node number</span>
<a name="ln-8096"></a>  <span class="kt">INTEGER</span>                       <span class="kd">::</span> <span class="n">OpMode</span>             <span class="c">! fan operating mode (cycling or constant)</span>
<a name="ln-8097"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">PartLoadRatio</span>      <span class="c">! operating part-load ratio</span>
<a name="ln-8098"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">SensOutputOff</span>      <span class="c">! sensible output at PLR = 0 [W]</span>
<a name="ln-8099"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">LatOutputOff</span>       <span class="c">! latent output at PLR = 0 [W]</span>
<a name="ln-8100"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">SensOutputOn</span>       <span class="c">! sensible output at PLR = 1 [W]</span>
<a name="ln-8101"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">LatOutputOn</span>        <span class="c">! latent output at PLR = 1 [W]</span>
<a name="ln-8102"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">CoolPLR</span>            <span class="c">! cooing part load ratio</span>
<a name="ln-8103"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">HeatPLR</span>            <span class="c">! heating part load ratio</span>
<a name="ln-8104"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">Par</span>                <span class="c">! parameters passed to RegulaFalsi function</span>
<a name="ln-8105"></a>  <span class="kt">INTEGER</span>                       <span class="kd">::</span> <span class="n">SolFlag</span>            <span class="c">! return flag from RegulaFalsi for sensible load</span>
<a name="ln-8106"></a>  <span class="kt">INTEGER</span>                       <span class="kd">::</span> <span class="n">SolFlagLat</span>         <span class="c">! return flag from RegulaFalsi for latent load</span>
<a name="ln-8107"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">TempLoad</span>           <span class="c">! represents either a sensible or latent load [W]</span>
<a name="ln-8108"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">TempSysOutput</span>      <span class="c">! represents either a sensible or latent capacity [W]</span>
<a name="ln-8109"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">TempSensOutput</span>     <span class="c">! iterative sensible capacity [W]</span>
<a name="ln-8110"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">TempLatOutput</span>      <span class="c">! iterative latent capacity [W]</span>
<a name="ln-8111"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">TempMinPLR</span>         <span class="c">! iterative minimum PLR</span>
<a name="ln-8112"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">TempMaxPLR</span>         <span class="c">! iterative maximum PLR</span>
<a name="ln-8113"></a>  <span class="kt">INTEGER</span>                       <span class="kd">::</span> <span class="n">SpeedNum</span>           <span class="c">! multi-speed coil speed number</span>
<a name="ln-8114"></a>  <span class="kt">INTEGER</span>                       <span class="kd">::</span> <span class="n">CompressorONFlag</span>   <span class="c">! 0= compressor off, 1= compressor off</span>
<a name="ln-8115"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">CoolingOnlySensibleOutput</span> <span class="c">! use to calculate dehumidification induced heating [W]</span>
<a name="ln-8116"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">CpAir</span>                     <span class="c">! specific heat of air [J/kg_C]</span>
<a name="ln-8117"></a>
<a name="ln-8118"></a>  <span class="n">CompName</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-8119"></a>  <span class="n">InletNode</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemInletNodeNum</span>
<a name="ln-8120"></a>  <span class="n">OutletNode</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemOutletNodeNum</span>
<a name="ln-8121"></a>  <span class="n">OpMode</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span>
<a name="ln-8122"></a>  <span class="c">! Pass full mass flow rate on FirstHVACIteration to set MassFlowRateMax</span>
<a name="ln-8123"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">FirstHVACIteration</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">AirLoopEquipment</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8124"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingSingleSpeed</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8125"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingHXAssisted</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8126"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_HeatingEmpirical</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8127"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8128"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_CoolingAirToAirVariableSpeed</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8129"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_CoolingWaterToAirHPSimple</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8130"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWaterToAirHPSimple</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8131"></a><span class="k">      </span><span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8132"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">HeatingLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8133"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedNum</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span>
<a name="ln-8134"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8135"></a>      <span class="k">ELSE</span>
<a name="ln-8136"></a><span class="c">!        CoolingLoad = .TRUE.</span>
<a name="ln-8137"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedNum</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span>
<a name="ln-8138"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8139"></a>      <span class="k">END IF</span>
<a name="ln-8140"></a><span class="k">    ELSE</span>
<a name="ln-8141"></a><span class="k">      IF</span><span class="p">(</span><span class="n">HeatingLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8142"></a><span class="k">        </span><span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8143"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedNum</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span>
<a name="ln-8144"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8145"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Staged</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">StageNum</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8146"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8147"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedNum</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">StageNum</span><span class="p">)</span>
<a name="ln-8148"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedNum</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8149"></a>        <span class="k">END IF</span>
<a name="ln-8150"></a><span class="k">      ELSE</span>
<a name="ln-8151"></a><span class="c">!        CoolingLoad = .TRUE.</span>
<a name="ln-8152"></a>        <span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8153"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedNum</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span>
<a name="ln-8154"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8155"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Staged</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">StageNum</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8156"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8157"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedNum</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">StageNum</span><span class="p">)</span>
<a name="ln-8158"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedNum</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8159"></a>        <span class="k">END IF</span>
<a name="ln-8160"></a><span class="k">      END IF</span>
<a name="ln-8161"></a><span class="k">    END IF</span>
<a name="ln-8162"></a><span class="k">    CALL </span><span class="n">SetOnOffMassFlowRate</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-8163"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">HeatingLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8164"></a><span class="k">      </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingPartLoadFrac</span><span class="o">=</span><span class="mf">1.0d0</span>
<a name="ln-8165"></a>    <span class="k">ELSE</span>
<a name="ln-8166"></a><span class="k">      </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingPartLoadFrac</span><span class="o">=</span><span class="mf">1.0d0</span>
<a name="ln-8167"></a>    <span class="k">END IF</span>
<a name="ln-8168"></a><span class="k">    </span><span class="n">CompOn</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-8169"></a>    <span class="k">RETURN</span>
<a name="ln-8170"></a><span class="k">  END IF</span>
<a name="ln-8171"></a>
<a name="ln-8172"></a><span class="k">  IF</span><span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SysAvailSchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8173"></a><span class="k">    RETURN</span>
<a name="ln-8174"></a><span class="k">  END IF</span>
<a name="ln-8175"></a>
<a name="ln-8176"></a><span class="k">  </span><span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>   <span class="c">! Get no load result</span>
<a name="ln-8177"></a>  <span class="n">SolFlag</span> <span class="o">=</span> <span class="mi">0</span>    <span class="c">! # of iterations IF positive, -1 means failed to converge, -2 means bounds are incorrect</span>
<a name="ln-8178"></a>  <span class="n">SolFlagLat</span> <span class="o">=</span> <span class="mi">0</span>    <span class="c">! # of iterations IF positive, -1 means failed to converge, -2 means bounds are incorrect</span>
<a name="ln-8179"></a>
<a name="ln-8180"></a>  <span class="n">SensOutputOff</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8181"></a>  <span class="n">LatOutputOff</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8182"></a>  <span class="n">CoolPLR</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8183"></a>  <span class="n">HeatPLR</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8184"></a>  <span class="n">CompressorONFlag</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-8185"></a>
<a name="ln-8186"></a>  <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">WSHPRuntimeFrac</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8187"></a>
<a name="ln-8188"></a>  <span class="k">CALL </span><span class="n">SetOnOffMassFlowRate</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-8189"></a>
<a name="ln-8190"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">HeatingLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8191"></a><span class="k">    </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilSensDemand</span>   <span class="o">=</span> <span class="n">ZoneLoad</span>
<a name="ln-8192"></a>    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilSensDemand</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8193"></a>    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilLatentDemand</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8194"></a>  <span class="k">ELSE IF</span><span class="p">(</span><span class="n">CoolingLoad</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">MoistureLoad</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8195"></a><span class="k">    </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilSensDemand</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8196"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">CoolingLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8197"></a><span class="k">      </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilSensDemand</span>   <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">ZoneLoad</span><span class="p">)</span>
<a name="ln-8198"></a>    <span class="k">ELSE</span>
<a name="ln-8199"></a><span class="k">      </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilSensDemand</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8200"></a>    <span class="k">END IF</span>
<a name="ln-8201"></a><span class="k">    </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilLatentDemand</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">MoistureLoad</span><span class="p">)</span>
<a name="ln-8202"></a>  <span class="k">ELSE</span>
<a name="ln-8203"></a><span class="k">    RETURN</span>
<a name="ln-8204"></a><span class="k">  END IF</span>
<a name="ln-8205"></a>
<a name="ln-8206"></a><span class="k">  CALL </span><span class="n">CalcUnitarySystemToLoad</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CoolPLR</span><span class="p">,</span><span class="n">HeatPLR</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8207"></a>                               <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SensOutputOff</span><span class="p">,</span><span class="n">LatOutputOff</span><span class="p">,</span><span class="n">HXUnitOn</span><span class="p">,</span><span class="n">CompOn</span><span class="o">=</span><span class="n">CompressorONFlag</span><span class="p">)</span>
<a name="ln-8208"></a>  <span class="n">FullSensibleOutput</span> <span class="o">=</span> <span class="n">SensOutputOff</span>
<a name="ln-8209"></a>
<a name="ln-8210"></a>  <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HeatingLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">CoolingLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8211"></a>    <span class="c">! no load</span>
<a name="ln-8212"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">MoistureLoad</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">MoistureLoad</span> <span class="o">&gt;</span> <span class="n">LatOutputOff</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-8213"></a>    <span class="c">! Dehumcontrol_Multimode only controls RH if there is a sensible load</span>
<a name="ln-8214"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">DehumidControl_Multimode</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-8215"></a><span class="k">  END IF</span>
<a name="ln-8216"></a>
<a name="ln-8217"></a><span class="c">! determine if PLR=0 meets the load</span>
<a name="ln-8218"></a>  <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">TempControlType</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">))</span>
<a name="ln-8219"></a>    <span class="k">CASE</span><span class="p">(</span><span class="n">SingleHeatingSetPoint</span><span class="p">)</span>
<a name="ln-8220"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">HeatingLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SensOutputOff</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">ZoneLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">MoistureLoad</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">MoistureLoad</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">LatOutputOff</span><span class="p">))</span><span class="k">RETURN</span>
<a name="ln-8221"></a><span class="k">      IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HeatingLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">MoistureLoad</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">MoistureLoad</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">LatOutputOff</span><span class="p">))</span><span class="k">RETURN</span>
<a name="ln-8222"></a><span class="k">    CASE</span><span class="p">(</span><span class="n">SingleCoolingSetPoint</span><span class="p">)</span>
<a name="ln-8223"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">CoolingLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SensOutputOff</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">ZoneLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">MoistureLoad</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">MoistureLoad</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">LatOutputOff</span><span class="p">))</span><span class="k">RETURN</span>
<a name="ln-8224"></a><span class="k">      IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">CoolingLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">MoistureLoad</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">MoistureLoad</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">LatOutputOff</span><span class="p">))</span><span class="k">RETURN</span>
<a name="ln-8225"></a><span class="k">    CASE</span><span class="p">(</span><span class="n">SingleHeatCoolSetPoint</span><span class="p">,</span> <span class="n">DualSetPointWithDeadBand</span><span class="p">)</span>
<a name="ln-8226"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">HeatingLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SensOutputOff</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">ZoneLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">MoistureLoad</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">MoistureLoad</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">LatOutputOff</span><span class="p">))</span><span class="k">RETURN</span>
<a name="ln-8227"></a><span class="k">      IF</span><span class="p">(</span><span class="n">CoolingLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SensOutputOff</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">ZoneLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">MoistureLoad</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">MoistureLoad</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">LatOutputOff</span><span class="p">))</span><span class="k">RETURN</span>
<a name="ln-8228"></a><span class="k">      IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HeatingLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">CoolingLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">MoistureLoad</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">MoistureLoad</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">LatOutputOff</span><span class="p">))</span><span class="k">RETURN</span>
<a name="ln-8229"></a><span class="k">    CASE </span><span class="n">DEFAULT</span>
<a name="ln-8230"></a>      <span class="c">! should never get here</span>
<a name="ln-8231"></a>  <span class="k">END SELECT</span>
<a name="ln-8232"></a>
<a name="ln-8233"></a><span class="c">! if a variable speed unit, the SensOutputOff at SpeedNum=1 must be checked to see if it exceeds the ZoneLoad</span>
<a name="ln-8234"></a><span class="c">! This is still no load but at the first speed above idle</span>
<a name="ln-8235"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">HeatingLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8236"></a>     <span class="n">CoolingLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8237"></a><span class="k">    IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Staged</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8238"></a><span class="k">      IF</span><span class="p">(</span><span class="n">HeatingLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8239"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedNum</span>   <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">StageNum</span>
<a name="ln-8240"></a>      <span class="k">ELSE</span>
<a name="ln-8241"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedNum</span>   <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">StageNum</span><span class="p">)</span>
<a name="ln-8242"></a>      <span class="k">END IF</span>
<a name="ln-8243"></a><span class="k">    ELSE</span>
<a name="ln-8244"></a><span class="k">      IF</span><span class="p">(</span><span class="n">HeatingLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8245"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedNum</span>   <span class="o">=</span> <span class="mi">1</span>
<a name="ln-8246"></a>      <span class="k">ELSE</span>
<a name="ln-8247"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedNum</span>   <span class="o">=</span> <span class="mi">1</span>
<a name="ln-8248"></a>      <span class="k">END IF</span>
<a name="ln-8249"></a><span class="k">    END IF</span>
<a name="ln-8250"></a><span class="k">    CALL </span><span class="n">SetOnOffMassFlowRate</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-8251"></a>    <span class="k">CALL </span><span class="n">CalcUnitarySystemToLoad</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CoolPLR</span><span class="p">,</span><span class="n">HeatPLR</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8252"></a>                                 <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SensOutputOff</span><span class="p">,</span><span class="n">LatOutputOff</span><span class="p">,</span><span class="n">HXUnitOn</span><span class="p">,</span><span class="n">CompOn</span><span class="o">=</span><span class="n">CompressorONFlag</span><span class="p">)</span>
<a name="ln-8253"></a>    <span class="n">FullSensibleOutput</span> <span class="o">=</span> <span class="n">SensOutputOff</span>
<a name="ln-8254"></a>
<a name="ln-8255"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">TempControlType</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">))</span>
<a name="ln-8256"></a>      <span class="k">CASE</span><span class="p">(</span><span class="n">SingleHeatingSetPoint</span><span class="p">)</span>
<a name="ln-8257"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">HeatingLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SensOutputOff</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">ZoneLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">MoistureLoad</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">MoistureLoad</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">LatOutputOff</span><span class="p">))</span><span class="k">RETURN</span>
<a name="ln-8258"></a><span class="k">        IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HeatingLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">MoistureLoad</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">MoistureLoad</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">LatOutputOff</span><span class="p">))</span><span class="k">RETURN</span>
<a name="ln-8259"></a><span class="k">      CASE</span><span class="p">(</span><span class="n">SingleCoolingSetPoint</span><span class="p">)</span>
<a name="ln-8260"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">CoolingLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SensOutputOff</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">ZoneLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">MoistureLoad</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">MoistureLoad</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">LatOutputOff</span><span class="p">))</span><span class="k">RETURN</span>
<a name="ln-8261"></a><span class="k">        IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">CoolingLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">MoistureLoad</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">MoistureLoad</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">LatOutputOff</span><span class="p">))</span><span class="k">RETURN</span>
<a name="ln-8262"></a><span class="k">      CASE</span><span class="p">(</span><span class="n">SingleHeatCoolSetPoint</span><span class="p">,</span> <span class="n">DualSetPointWithDeadBand</span><span class="p">)</span>
<a name="ln-8263"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">HeatingLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SensOutputOff</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">ZoneLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">MoistureLoad</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">MoistureLoad</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">LatOutputOff</span><span class="p">))</span><span class="k">RETURN</span>
<a name="ln-8264"></a><span class="k">        IF</span><span class="p">(</span><span class="n">CoolingLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SensOutputOff</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">ZoneLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">MoistureLoad</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">MoistureLoad</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">LatOutputOff</span><span class="p">))</span><span class="k">RETURN</span>
<a name="ln-8265"></a><span class="k">        IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HeatingLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">CoolingLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">MoistureLoad</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">MoistureLoad</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">LatOutputOff</span><span class="p">))</span><span class="k">RETURN</span>
<a name="ln-8266"></a><span class="k">      CASE </span><span class="n">DEFAULT</span>
<a name="ln-8267"></a>      <span class="c">! should never get here</span>
<a name="ln-8268"></a>    <span class="k">END SELECT</span>
<a name="ln-8269"></a><span class="k">  END IF</span>
<a name="ln-8270"></a>
<a name="ln-8271"></a><span class="k">  </span><span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>  <span class="c">! Get full load result</span>
<a name="ln-8272"></a>  <span class="k">IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">CompOn</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-8273"></a><span class="k">    </span><span class="n">CompressorONFlag</span> <span class="o">=</span> <span class="n">CompOn</span>
<a name="ln-8274"></a>  <span class="k">ELSE</span>
<a name="ln-8275"></a><span class="k">    </span><span class="n">CompressorONFlag</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-8276"></a>  <span class="k">END IF</span>
<a name="ln-8277"></a>
<a name="ln-8278"></a><span class="k">  IF</span><span class="p">(</span><span class="n">HeatingLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8279"></a><span class="k">    </span><span class="n">CoolPLR</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8280"></a>    <span class="n">HeatPLR</span>       <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8281"></a>    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8282"></a>    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCycRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8283"></a>    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">WSHPRuntimeFrac</span>   <span class="o">=</span> <span class="n">HeatPLR</span>
<a name="ln-8284"></a>    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedNum</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span>
<a name="ln-8285"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Staged</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">StageNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8286"></a><span class="k">      </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedNum</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">StageNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8287"></a>                                                         <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span><span class="p">)</span>
<a name="ln-8288"></a>      <span class="k">CALL </span><span class="n">SetOnOffMassFlowRate</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-8289"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8290"></a>      <span class="k">CALL </span><span class="n">CalcUnitarySystemToLoad</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CoolPLR</span><span class="p">,</span><span class="n">HeatPLR</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8291"></a>                         <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SensOutputOff</span><span class="p">,</span><span class="n">LatOutputOff</span><span class="p">,</span><span class="n">HXUnitOn</span><span class="p">,</span><span class="n">CompOn</span><span class="o">=</span><span class="n">CompressorONFlag</span><span class="p">)</span>
<a name="ln-8292"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">SensOutputOff</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">ZoneLoad</span><span class="p">)</span><span class="k">RETURN</span>
<a name="ln-8293"></a><span class="k">      </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8294"></a>    <span class="k">END IF</span>
<a name="ln-8295"></a><span class="k">  </span><span class="n">ELSEIF</span><span class="p">(</span><span class="n">CoolingLoad</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">MoistureLoad</span> <span class="o">&lt;</span> <span class="n">LatOutputOff</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8296"></a><span class="k">    </span><span class="n">CoolPLR</span>       <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8297"></a>    <span class="n">HeatPLR</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8298"></a>    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8299"></a>    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCycRatio</span>   <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8300"></a>    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">WSHPRuntimeFrac</span>   <span class="o">=</span> <span class="n">CoolPLR</span>
<a name="ln-8301"></a>    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedNum</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span>
<a name="ln-8302"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Staged</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">StageNum</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8303"></a><span class="k">      </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedNum</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">StageNum</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-8304"></a>                                                         <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span><span class="p">)</span>
<a name="ln-8305"></a>      <span class="k">CALL </span><span class="n">SetOnOffMassFlowRate</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-8306"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8307"></a>      <span class="k">CALL </span><span class="n">CalcUnitarySystemToLoad</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CoolPLR</span><span class="p">,</span><span class="n">HeatPLR</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8308"></a>                         <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SensOutputOff</span><span class="p">,</span><span class="n">LatOutputOff</span><span class="p">,</span><span class="n">HXUnitOn</span><span class="p">,</span><span class="n">CompOn</span><span class="o">=</span><span class="n">CompressorONFlag</span><span class="p">)</span>
<a name="ln-8309"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">SensOutputOff</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">ZoneLoad</span><span class="p">)</span><span class="k">RETURN</span>
<a name="ln-8310"></a><span class="k">      </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8311"></a>    <span class="k">END IF</span>
<a name="ln-8312"></a><span class="k">  ELSE</span>
<a name="ln-8313"></a>    <span class="c">! will return here when no cooling or heating load and MoistureLoad &gt; LatOutputOff (i.e., PLR=0)</span>
<a name="ln-8314"></a>    <span class="k">RETURN</span>
<a name="ln-8315"></a><span class="k">  END IF</span>
<a name="ln-8316"></a>
<a name="ln-8317"></a><span class="k">  CALL </span><span class="n">SetOnOffMassFlowRate</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-8318"></a>
<a name="ln-8319"></a>  <span class="k">CALL </span><span class="n">CalcUnitarySystemToLoad</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CoolPLR</span><span class="p">,</span><span class="n">HeatPLR</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8320"></a>                         <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SensOutputOn</span><span class="p">,</span><span class="n">LatOutputOn</span><span class="p">,</span><span class="n">HXUnitOn</span><span class="p">,</span><span class="n">CompOn</span><span class="o">=</span><span class="n">CompressorONFlag</span><span class="p">)</span>
<a name="ln-8321"></a>  <span class="n">FullSensibleOutput</span> <span class="o">=</span> <span class="n">SensOutputOn</span>
<a name="ln-8322"></a>
<a name="ln-8323"></a>  <span class="c">! turn on HX if DehumidControl_Multimode</span>
<a name="ln-8324"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">DehumidControl_Multimode</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8325"></a>     <span class="n">MoistureLoad</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MoistureLoad</span> <span class="o">&lt;</span> <span class="n">LatOutputOn</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">CoolingLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8326"></a><span class="k">    </span><span class="n">HXUnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8327"></a>    <span class="k">CALL </span><span class="n">CalcUnitarySystemToLoad</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CoolPLR</span><span class="p">,</span><span class="n">HeatPLR</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8328"></a>                         <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SensOutputOn</span><span class="p">,</span><span class="n">LatOutputOn</span><span class="p">,</span><span class="n">HXUnitOn</span><span class="p">,</span><span class="n">CompOn</span><span class="o">=</span><span class="n">CompressorONFlag</span><span class="p">)</span>
<a name="ln-8329"></a>    <span class="n">FullSensibleOutput</span> <span class="o">=</span> <span class="n">SensOutputOn</span>
<a name="ln-8330"></a>  <span class="k">END IF</span>
<a name="ln-8331"></a>
<a name="ln-8332"></a>  <span class="c">! test to see if full capacity is less than load, if so set to PLR=1 and RETURN if no moisture load</span>
<a name="ln-8333"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">HeatingLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8334"></a>     <span class="n">CoolingLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8335"></a><span class="k">  SELECT CASE</span> <span class="p">(</span><span class="n">TempControlType</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">))</span>
<a name="ln-8336"></a>    <span class="k">CASE</span><span class="p">(</span><span class="n">SingleHeatingSetPoint</span><span class="p">)</span>
<a name="ln-8337"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">HeatingLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SensOutputOn</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">ZoneLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8338"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingPartLoadFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8339"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">WSHPRuntimeFrac</span>     <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8340"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">MoistureLoad</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">MoistureLoad</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MoistureLoad</span> <span class="o">&lt;</span> <span class="n">LatOutputOn</span><span class="p">))</span><span class="k">RETURN</span>
<a name="ln-8341"></a><span class="k">      END IF</span>
<a name="ln-8342"></a><span class="k">      IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HeatingLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8343"></a>         <span class="p">(</span><span class="n">MoistureLoad</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">MoistureLoad</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MoistureLoad</span> <span class="o">&lt;</span> <span class="n">LatOutputOn</span><span class="p">)))</span><span class="k">RETURN</span>
<a name="ln-8344"></a><span class="k">    CASE</span><span class="p">(</span><span class="n">SingleCoolingSetPoint</span><span class="p">)</span>
<a name="ln-8345"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">CoolingLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SensOutputOn</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">ZoneLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8346"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingPartLoadFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8347"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">WSHPRuntimeFrac</span>     <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8348"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">MoistureLoad</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">MoistureLoad</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MoistureLoad</span> <span class="o">&lt;</span> <span class="n">LatOutputOn</span><span class="p">))</span><span class="k">RETURN</span>
<a name="ln-8349"></a><span class="k">      END IF</span>
<a name="ln-8350"></a><span class="k">      IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">CoolingLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8351"></a>        <span class="p">(</span><span class="n">MoistureLoad</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">MoistureLoad</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MoistureLoad</span> <span class="o">&lt;</span> <span class="n">LatOutputOn</span><span class="p">)))</span><span class="k">RETURN</span>
<a name="ln-8352"></a><span class="k">    CASE</span><span class="p">(</span><span class="n">SingleHeatCoolSetPoint</span><span class="p">,</span> <span class="n">DualSetPointWithDeadBand</span><span class="p">)</span>
<a name="ln-8353"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">HeatingLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SensOutputOn</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">ZoneLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8354"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingPartLoadFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8355"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">WSHPRuntimeFrac</span>     <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8356"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">MoistureLoad</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">MoistureLoad</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MoistureLoad</span> <span class="o">&gt;</span> <span class="n">LatOutputOn</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-8357"></a><span class="k">          RETURN</span>
<a name="ln-8358"></a><span class="k">        END IF</span>
<a name="ln-8359"></a><span class="k">      END IF</span>
<a name="ln-8360"></a><span class="k">      IF</span><span class="p">(</span><span class="n">CoolingLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SensOutputOn</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">ZoneLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8361"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingPartLoadFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8362"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">WSHPRuntimeFrac</span>     <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8363"></a>        <span class="k">RETURN</span>
<a name="ln-8364"></a><span class="k">      END IF</span>
<a name="ln-8365"></a><span class="k">      IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HeatingLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">CoolingLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8366"></a>        <span class="p">(</span><span class="n">MoistureLoad</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">MoistureLoad</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MoistureLoad</span> <span class="o">&lt;</span> <span class="n">LatOutputOn</span><span class="p">)))</span><span class="k">THEN</span>
<a name="ln-8367"></a><span class="k">        RETURN</span>
<a name="ln-8368"></a><span class="k">      END IF</span>
<a name="ln-8369"></a><span class="k">  CASE </span><span class="n">DEFAULT</span>
<a name="ln-8370"></a>    <span class="c">! no other choices for thermostat control</span>
<a name="ln-8371"></a>  <span class="k">END SELECT</span>
<a name="ln-8372"></a><span class="k">  END IF</span>
<a name="ln-8373"></a><span class="c">! will find speed for multispeed coils here and then RegulaFalsi on PLR at a fixed speed</span>
<a name="ln-8374"></a>
<a name="ln-8375"></a><span class="c">! Do the non-variable or non-multispeed coils have a NumOfSpeed = 0 ? We don&#39;t need to do this for single speed coils.</span>
<a name="ln-8376"></a><span class="c">! Check to see which speed to meet the load</span>
<a name="ln-8377"></a>  <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-8378"></a>  <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-8379"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Staged</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8380"></a><span class="k">    IF</span><span class="p">(</span><span class="n">HeatingLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8381"></a><span class="k">      DO </span><span class="n">SpeedNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span>
<a name="ln-8382"></a>        <span class="n">CoolPLR</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8383"></a>        <span class="n">HeatPLR</span>       <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8384"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">SpeedNum</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8385"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8386"></a>        <span class="k">ELSE</span>
<a name="ln-8387"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8388"></a>        <span class="k">END IF</span>
<a name="ln-8389"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCycRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8390"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedNum</span> <span class="o">=</span> <span class="n">SpeedNum</span>
<a name="ln-8391"></a>        <span class="k">CALL </span><span class="n">CalcUnitarySystemToLoad</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CoolPLR</span><span class="p">,</span><span class="n">HeatPLR</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8392"></a>                         <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SensOutputOn</span><span class="p">,</span><span class="n">LatOutputOn</span><span class="p">,</span><span class="n">HXUnitOn</span><span class="p">,</span><span class="n">CompOn</span><span class="o">=</span><span class="n">CompressorONFlag</span><span class="p">)</span>
<a name="ln-8393"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">/=</span> <span class="n">Coil_HeatingWaterToAirHPVSEquationFit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8394"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8395"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedNum</span> <span class="o">=</span> <span class="n">SpeedNum</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-8396"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8397"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCycRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8398"></a>            <span class="n">HeatPLR</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8399"></a>          <span class="k">ELSE</span>
<a name="ln-8400"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCycRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8401"></a>            <span class="n">HeatPLR</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8402"></a>          <span class="k">END IF</span>
<a name="ln-8403"></a><span class="k">          CALL </span><span class="n">CalcUnitarySystemToLoad</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CoolPLR</span><span class="p">,</span><span class="n">HeatPLR</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8404"></a>                       <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SensOutputOff</span><span class="p">,</span><span class="n">LatOutputOff</span><span class="p">,</span><span class="n">HXUnitOn</span><span class="p">,</span><span class="n">CompOn</span><span class="o">=</span><span class="n">CompressorONFlag</span><span class="p">)</span>
<a name="ln-8405"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedNum</span> <span class="o">=</span> <span class="n">SpeedNum</span>
<a name="ln-8406"></a>        <span class="k">END IF</span>
<a name="ln-8407"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">ZoneLoad</span> <span class="o">&lt;=</span> <span class="n">SensOutputOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8408"></a><span class="k">          EXIT</span>
<a name="ln-8409"></a><span class="k">        END IF</span>
<a name="ln-8410"></a><span class="k">      END DO</span>
<a name="ln-8411"></a><span class="k">    ELSE</span> <span class="c">! Cooling or moisture load</span>
<a name="ln-8412"></a>      <span class="k">DO </span><span class="n">SpeedNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span>
<a name="ln-8413"></a>        <span class="n">CoolPLR</span>       <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8414"></a>        <span class="n">HeatPLR</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8415"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">SpeedNum</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8416"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8417"></a>        <span class="k">ELSE</span>
<a name="ln-8418"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8419"></a>        <span class="k">END IF</span>
<a name="ln-8420"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCycRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8421"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedNum</span> <span class="o">=</span> <span class="n">SpeedNum</span>
<a name="ln-8422"></a>        <span class="k">CALL </span><span class="n">CalcUnitarySystemToLoad</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CoolPLR</span><span class="p">,</span><span class="n">HeatPLR</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8423"></a>                                     <span class="n">SensOutputOn</span><span class="p">,</span><span class="n">LatOutputOn</span><span class="p">,</span><span class="n">HXUnitOn</span><span class="p">,</span><span class="n">CompOn</span><span class="o">=</span><span class="n">CompressorONFlag</span><span class="p">)</span>
<a name="ln-8424"></a>
<a name="ln-8425"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">/=</span> <span class="n">Coil_CoolingWaterToAirHPVSEquationFit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8426"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8427"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedNum</span> <span class="o">=</span> <span class="n">SpeedNum</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-8428"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8429"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCycRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8430"></a>            <span class="n">CoolPLR</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8431"></a>          <span class="k">ELSE</span>
<a name="ln-8432"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCycRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8433"></a>            <span class="n">CoolPLR</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8434"></a>          <span class="k">END IF</span>
<a name="ln-8435"></a><span class="k">          CALL </span><span class="n">CalcUnitarySystemToLoad</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CoolPLR</span><span class="p">,</span><span class="n">HeatPLR</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8436"></a>                                       <span class="n">SensOutputOff</span><span class="p">,</span><span class="n">LatOutputOff</span><span class="p">,</span><span class="n">HXUnitOn</span><span class="p">,</span><span class="n">CompOn</span><span class="o">=</span><span class="n">CompressorONFlag</span><span class="p">)</span>
<a name="ln-8437"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedNum</span> <span class="o">=</span> <span class="n">SpeedNum</span>
<a name="ln-8438"></a>          <span class="k">END IF</span>
<a name="ln-8439"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">ZoneLoad</span> <span class="o">&gt;=</span> <span class="n">SensOutputOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8440"></a><span class="k">          EXIT</span>
<a name="ln-8441"></a><span class="k">        END IF</span>
<a name="ln-8442"></a><span class="k">      END DO</span>
<a name="ln-8443"></a><span class="k">    END IF</span>
<a name="ln-8444"></a><span class="k">  ELSE</span> <span class="c">! IF (.NOT. UnitarySystem(UnitarySysNum)%Staged) THEN</span>
<a name="ln-8445"></a>  <span class="c">! Staged control</span>
<a name="ln-8446"></a>   <span class="k">IF</span><span class="p">(</span><span class="n">HeatingLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8447"></a><span class="k">      </span><span class="n">CoolPLR</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8448"></a>      <span class="n">HeatPLR</span>       <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8449"></a>      <span class="n">SpeedNum</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">StageNum</span>
<a name="ln-8450"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">SpeedNum</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8451"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8452"></a>      <span class="k">ELSE</span>
<a name="ln-8453"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8454"></a>        <span class="n">SpeedNum</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">StageNum</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span><span class="p">)</span>
<a name="ln-8455"></a>      <span class="k">END IF</span>
<a name="ln-8456"></a><span class="k">      </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCycRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8457"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedNum</span> <span class="o">=</span> <span class="n">SpeedNum</span>
<a name="ln-8458"></a>      <span class="k">CALL </span><span class="n">CalcUnitarySystemToLoad</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CoolPLR</span><span class="p">,</span><span class="n">HeatPLR</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8459"></a>                         <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SensOutputOn</span><span class="p">,</span><span class="n">LatOutputOn</span><span class="p">,</span><span class="n">HXUnitOn</span><span class="p">,</span><span class="n">CompOn</span><span class="o">=</span><span class="n">CompressorONFlag</span><span class="p">)</span>
<a name="ln-8460"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">/=</span> <span class="n">Coil_HeatingWaterToAirHPVSEquationFit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8461"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8462"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedNum</span> <span class="o">=</span> <span class="n">SpeedNum</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-8463"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8464"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCycRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8465"></a>          <span class="n">HeatPLR</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8466"></a>        <span class="k">ELSE</span>
<a name="ln-8467"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCycRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8468"></a>          <span class="n">HeatPLR</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8469"></a>        <span class="k">END IF</span>
<a name="ln-8470"></a><span class="k">        CALL </span><span class="n">CalcUnitarySystemToLoad</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CoolPLR</span><span class="p">,</span><span class="n">HeatPLR</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8471"></a>                       <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SensOutputOff</span><span class="p">,</span><span class="n">LatOutputOff</span><span class="p">,</span><span class="n">HXUnitOn</span><span class="p">,</span><span class="n">CompOn</span><span class="o">=</span><span class="n">CompressorONFlag</span><span class="p">)</span>
<a name="ln-8472"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedNum</span> <span class="o">=</span> <span class="n">SpeedNum</span>
<a name="ln-8473"></a>      <span class="k">END IF</span>
<a name="ln-8474"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">ZoneLoad</span> <span class="o">&lt;=</span> <span class="n">SensOutputOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8475"></a><span class="c">!        EXIT ????????????</span>
<a name="ln-8476"></a>      <span class="k">END IF</span>
<a name="ln-8477"></a><span class="k">   ELSE</span> <span class="c">! Cooling or moisture load</span>
<a name="ln-8478"></a>      <span class="n">CoolPLR</span>       <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8479"></a>      <span class="n">HeatPLR</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8480"></a>      <span class="n">SpeedNum</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">StageNum</span><span class="p">)</span>
<a name="ln-8481"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">SpeedNum</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8482"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8483"></a>      <span class="k">ELSE</span>
<a name="ln-8484"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8485"></a>        <span class="n">SpeedNum</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">StageNum</span><span class="p">),</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span><span class="p">)</span>
<a name="ln-8486"></a>      <span class="k">END IF</span>
<a name="ln-8487"></a><span class="k">      </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCycRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8488"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedNum</span> <span class="o">=</span> <span class="n">SpeedNum</span>
<a name="ln-8489"></a>      <span class="k">CALL </span><span class="n">CalcUnitarySystemToLoad</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CoolPLR</span><span class="p">,</span><span class="n">HeatPLR</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8490"></a>                                   <span class="n">SensOutputOn</span><span class="p">,</span><span class="n">LatOutputOn</span><span class="p">,</span><span class="n">HXUnitOn</span><span class="p">,</span><span class="n">CompOn</span><span class="o">=</span><span class="n">CompressorONFlag</span><span class="p">)</span>
<a name="ln-8491"></a>
<a name="ln-8492"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">/=</span> <span class="n">Coil_CoolingWaterToAirHPVSEquationFit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8493"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8494"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedNum</span> <span class="o">=</span> <span class="n">SpeedNum</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-8495"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8496"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCycRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8497"></a>          <span class="n">CoolPLR</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8498"></a>        <span class="k">ELSE</span>
<a name="ln-8499"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCycRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8500"></a>          <span class="n">CoolPLR</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8501"></a>        <span class="k">END IF</span>
<a name="ln-8502"></a><span class="k">        CALL </span><span class="n">CalcUnitarySystemToLoad</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CoolPLR</span><span class="p">,</span><span class="n">HeatPLR</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8503"></a>                                     <span class="n">SensOutputOff</span><span class="p">,</span><span class="n">LatOutputOff</span><span class="p">,</span><span class="n">HXUnitOn</span><span class="p">,</span><span class="n">CompOn</span><span class="o">=</span><span class="n">CompressorONFlag</span><span class="p">)</span>
<a name="ln-8504"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedNum</span> <span class="o">=</span> <span class="n">SpeedNum</span>
<a name="ln-8505"></a>      <span class="k">END IF</span>
<a name="ln-8506"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">ZoneLoad</span> <span class="o">&gt;=</span> <span class="n">SensOutputOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8507"></a><span class="c">!        EXIT ???????????</span>
<a name="ln-8508"></a>      <span class="k">END IF</span>
<a name="ln-8509"></a><span class="k">   END IF</span>
<a name="ln-8510"></a><span class="k">  END IF</span> <span class="c">! IF (.NOT. UnitarySystem(UnitarySysNum)%Staged) THEN</span>
<a name="ln-8511"></a>
<a name="ln-8512"></a>  <span class="n">FullSensibleOutput</span> <span class="o">=</span> <span class="n">SensOutputOn</span>
<a name="ln-8513"></a>
<a name="ln-8514"></a>  <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HeatingLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">CoolingLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">MoistureLoad</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">MoistureLoad</span> <span class="o">&lt;</span> <span class="n">LatOutputOn</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-8515"></a>    <span class="c">! if no load, or only a moisture load which can&#39;t be met at PLR=1, RETURN</span>
<a name="ln-8516"></a>    <span class="k">RETURN</span>
<a name="ln-8517"></a><span class="k">  END IF</span>
<a name="ln-8518"></a>  <span class="c">! must test to see if load is bounded by capacity before calling RegulaFalsi</span>
<a name="ln-8519"></a>  <span class="k">IF</span><span class="p">((</span><span class="n">HeatingLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ZoneLoad</span> <span class="o">&lt;</span> <span class="n">SensOutputOn</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">CoolingLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ZoneLoad</span> <span class="o">&gt;</span> <span class="n">SensOutputOn</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-8520"></a><span class="k">    IF</span><span class="p">((</span><span class="n">HeatingLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ZoneLoad</span> <span class="o">&gt;</span> <span class="n">SensOutputOff</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">CoolingLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ZoneLoad</span> <span class="o">&lt;</span> <span class="n">SensOutputOff</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-8521"></a><span class="k">      </span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-8522"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! FLAG, IF 1.0 then FirstHVACIteration equals TRUE, if 0.0 then FirstHVACIteration equals false</span>
<a name="ln-8523"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="mf">1.0d0</span>
<a name="ln-8524"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-8525"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>  <span class="o">=</span> <span class="n">CompressorONFlag</span> <span class="c">! CompOp</span>
<a name="ln-8526"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  <span class="o">=</span> <span class="n">ZoneLoad</span>
<a name="ln-8527"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! FLAG, 0.0 if heating load, 1.0 IF cooling or moisture load</span>
<a name="ln-8528"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">CoolingLoad</span><span class="p">)</span><span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8529"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! FLAG, 0.0 if latent load, 1.0 if sensible load to be met</span>
<a name="ln-8530"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>  <span class="o">=</span> <span class="n">OnOffAirFlowRatio</span> <span class="c">! Ratio of compressor ON mass flow rate to AVERAGE mass flow rate over time step</span>
<a name="ln-8531"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! HXUnitOn is always false for HX</span>
<a name="ln-8532"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingPartLoadFrac</span>
<a name="ln-8533"></a><span class="c">!     Tolerance is in fraction of load, MaxIter = 30, SolFalg = # of iterations or error as appropriate</span>
<a name="ln-8534"></a>      <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="mf">0.001d0</span><span class="p">,</span> <span class="n">MaxIter</span><span class="p">,</span> <span class="n">SolFlag</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">CalcUnitarySystemLoadResidual</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-8535"></a>
<a name="ln-8536"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SolFlag</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8537"></a><span class="k">        IF</span><span class="p">(</span><span class="n">HeatingLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8538"></a>          <span class="c">! IF iteration limit is exceeded, find tighter boundary of solution and repeat RegulaFalsi</span>
<a name="ln-8539"></a>          <span class="c">! This does cause a problem when coil cannot turn on when OAT &lt; min allowed or scheduled off</span>
<a name="ln-8540"></a>          <span class="c">! If max iteration limit is exceeded, how do we know if the heating coil is operating?</span>
<a name="ln-8541"></a>          <span class="n">TempMaxPLR</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.1d0</span>
<a name="ln-8542"></a>          <span class="n">TempSensOutput</span> <span class="o">=</span> <span class="n">SensOutputOff</span>
<a name="ln-8543"></a>          <span class="k">DO WHILE</span><span class="p">((</span><span class="n">TempSensOutput</span> <span class="o">-</span> <span class="n">ZoneLoad</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">TempMaxPLR</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-8544"></a>            <span class="c">! find upper limit of HeatingPLR</span>
<a name="ln-8545"></a>            <span class="n">TempMaxPLR</span> <span class="o">=</span> <span class="n">TempMaxPLR</span> <span class="o">+</span> <span class="mf">0.1d0</span>
<a name="ln-8546"></a>
<a name="ln-8547"></a>            <span class="c">! SUBROUTINE SetSpeedVariables(UnitarySysNum, SensibleLoad, PartLoadRatio)</span>
<a name="ln-8548"></a>            <span class="k">CALL </span><span class="n">SetSpeedVariables</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span> <span class="n">TempMaxPLR</span><span class="p">)</span>
<a name="ln-8549"></a>            <span class="k">CALL </span><span class="n">CalcUnitarySystemToLoad</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CoolPLR</span><span class="p">,</span><span class="n">TempMaxPLR</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8550"></a>                                         <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">TempSensOutput</span><span class="p">,</span><span class="n">TempLatOutput</span><span class="p">,</span><span class="n">HXUnitOn</span><span class="p">,</span><span class="n">CompOn</span><span class="o">=</span><span class="n">CompressorONFlag</span><span class="p">)</span>
<a name="ln-8551"></a>          <span class="k">END DO</span>
<a name="ln-8552"></a><span class="k">          </span><span class="n">TempMinPLR</span> <span class="o">=</span> <span class="n">TempMaxPLR</span>
<a name="ln-8553"></a>          <span class="k">DO WHILE</span><span class="p">((</span><span class="n">TempSensOutput</span> <span class="o">-</span> <span class="n">ZoneLoad</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">TempMinPLR</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-8554"></a>            <span class="c">! pull upper limit of HeatingPLR down to last valid limit (i.e. heat output still exceeds SystemSensibleLoad)</span>
<a name="ln-8555"></a>            <span class="n">TempMaxPLR</span> <span class="o">=</span> <span class="n">TempMinPLR</span>
<a name="ln-8556"></a>            <span class="c">! find minimum limit of HeatingPLR</span>
<a name="ln-8557"></a>            <span class="n">TempMinPLR</span> <span class="o">=</span> <span class="n">TempMinPLR</span> <span class="o">-</span> <span class="mf">0.01d0</span>
<a name="ln-8558"></a>            <span class="k">CALL </span><span class="n">SetSpeedVariables</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span> <span class="n">TempMinPLR</span><span class="p">)</span>
<a name="ln-8559"></a>            <span class="k">CALL </span><span class="n">CalcUnitarySystemToLoad</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CoolPLR</span><span class="p">,</span><span class="n">TempMinPLR</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8560"></a>                                         <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">TempSensOutput</span><span class="p">,</span><span class="n">TempLatOutput</span><span class="p">,</span><span class="n">HXUnitOn</span><span class="p">,</span><span class="n">CompOn</span><span class="o">=</span><span class="n">CompressorONFlag</span><span class="p">)</span>
<a name="ln-8561"></a>          <span class="k">END DO</span>
<a name="ln-8562"></a>          <span class="c">! Now solve again with tighter PLR limits</span>
<a name="ln-8563"></a>          <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="mf">0.001d0</span><span class="p">,</span> <span class="n">MaxIter</span><span class="p">,</span> <span class="n">SolFlag</span><span class="p">,</span> <span class="n">HeatPLR</span><span class="p">,</span> <span class="n">CalcUnitarySystemLoadResidual</span><span class="p">,</span> <span class="n">TempMinPLR</span><span class="p">,</span> <span class="n">TempMaxPLR</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-8564"></a>          <span class="k">CALL </span><span class="n">CalcUnitarySystemToLoad</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CoolPLR</span><span class="p">,</span><span class="n">HeatPLR</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8565"></a>                                       <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">TempSensOutput</span><span class="p">,</span><span class="n">TempLatOutput</span><span class="p">,</span><span class="n">HXUnitOn</span><span class="p">,</span><span class="n">CompOn</span><span class="o">=</span><span class="n">CompressorONFlag</span><span class="p">)</span>
<a name="ln-8566"></a>        <span class="n">ELSEIF</span><span class="p">(</span><span class="n">CoolingLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8567"></a>          <span class="c">! RegulaFalsi may not find cooling PLR when the latent degradation model is used.</span>
<a name="ln-8568"></a>          <span class="c">! IF iteration limit is exceeded, find tighter boundary of solution and repeat RegulaFalsi</span>
<a name="ln-8569"></a>          <span class="n">TempMaxPLR</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.1d0</span>
<a name="ln-8570"></a>          <span class="n">TempSysOutput</span> <span class="o">=</span> <span class="n">SensOutputOff</span>
<a name="ln-8571"></a>          <span class="n">TempLoad</span> <span class="o">=</span> <span class="n">ZoneLoad</span>
<a name="ln-8572"></a>          <span class="k">DO WHILE</span><span class="p">((</span><span class="n">TempSysOutput</span> <span class="o">-</span> <span class="n">TempLoad</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">TempMaxPLR</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-8573"></a>            <span class="c">! find upper limit of HeatingPLR</span>
<a name="ln-8574"></a>            <span class="n">TempMaxPLR</span> <span class="o">=</span> <span class="n">TempMaxPLR</span> <span class="o">+</span> <span class="mf">0.1d0</span>
<a name="ln-8575"></a>            <span class="k">CALL </span><span class="n">SetSpeedVariables</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span> <span class="n">TempMaxPLR</span><span class="p">)</span>
<a name="ln-8576"></a>            <span class="k">CALL </span><span class="n">CalcUnitarySystemToLoad</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">TempMaxPLR</span><span class="p">,</span><span class="n">HeatPLR</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8577"></a>                                       <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">TempSensOutput</span><span class="p">,</span><span class="n">TempLatOutput</span><span class="p">,</span><span class="n">HXUnitOn</span><span class="p">,</span><span class="n">CompOn</span><span class="o">=</span><span class="n">CompressorONFlag</span><span class="p">)</span>
<a name="ln-8578"></a>            <span class="n">TempSysOutput</span> <span class="o">=</span> <span class="n">TempSensOutput</span>
<a name="ln-8579"></a>          <span class="k">END DO</span>
<a name="ln-8580"></a><span class="k">          </span><span class="n">TempMinPLR</span> <span class="o">=</span> <span class="n">TempMaxPLR</span>
<a name="ln-8581"></a>          <span class="k">DO WHILE</span><span class="p">((</span><span class="n">TempSysOutput</span> <span class="o">-</span> <span class="n">TempLoad</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">TempMinPLR</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-8582"></a>            <span class="c">! pull upper limit of HeatingPLR DOwn to last valid limit (i.e. heat output still exceeds SystemSensibleLoad)</span>
<a name="ln-8583"></a>            <span class="n">TempMaxPLR</span> <span class="o">=</span> <span class="n">TempMinPLR</span>
<a name="ln-8584"></a>            <span class="c">! find minimum limit of HeatingPLR</span>
<a name="ln-8585"></a>            <span class="n">TempMinPLR</span> <span class="o">=</span> <span class="n">TempMinPLR</span> <span class="o">-</span> <span class="mf">0.01d0</span>
<a name="ln-8586"></a>            <span class="k">CALL </span><span class="n">SetSpeedVariables</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span> <span class="n">TempMinPLR</span><span class="p">)</span>
<a name="ln-8587"></a>            <span class="k">CALL </span><span class="n">CalcUnitarySystemToLoad</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">TempMinPLR</span><span class="p">,</span><span class="n">HeatPLR</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8588"></a>                                         <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">TempSensOutput</span><span class="p">,</span><span class="n">TempLatOutput</span><span class="p">,</span><span class="n">HXUnitOn</span><span class="p">,</span><span class="n">CompOn</span><span class="o">=</span><span class="n">CompressorONFlag</span><span class="p">)</span>
<a name="ln-8589"></a>            <span class="n">TempSysOutput</span> <span class="o">=</span> <span class="n">TempSensOutput</span>
<a name="ln-8590"></a>          <span class="k">END DO</span>
<a name="ln-8591"></a>          <span class="c">! Now solve again with tighter PLR limits</span>
<a name="ln-8592"></a>          <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="mf">0.001d0</span><span class="p">,</span> <span class="n">MaxIter</span><span class="p">,</span> <span class="n">SolFlag</span><span class="p">,</span> <span class="n">CoolPLR</span><span class="p">,</span> <span class="n">CalcUnitarySystemLoadResidual</span><span class="p">,</span> <span class="n">TempMinPLR</span><span class="p">,</span> <span class="n">TempMaxPLR</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-8593"></a>          <span class="k">CALL </span><span class="n">CalcUnitarySystemToLoad</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CoolPLR</span><span class="p">,</span><span class="n">HeatPLR</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8594"></a>                                       <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">TempSensOutput</span><span class="p">,</span><span class="n">TempLatOutput</span><span class="p">,</span><span class="n">HXUnitOn</span><span class="p">,</span><span class="n">CompOn</span><span class="o">=</span><span class="n">CompressorONFlag</span><span class="p">)</span>
<a name="ln-8595"></a>        <span class="k">END IF</span> <span class="c">! IF(HeatingLoad)THEN</span>
<a name="ln-8596"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SolFlag</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8597"></a><span class="k">          IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">ZoneLoad</span> <span class="o">-</span> <span class="n">TempSensOutput</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SmallLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8598"></a><span class="k">            IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxIterIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8599"></a><span class="k">              CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;Coil control failed to converge for &#39;</span> <span class="p">&amp;</span>
<a name="ln-8600"></a>               <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-8601"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Iteration limit exceeded in calculating system sensible part-load ratio.&#39;</span><span class="p">)</span>
<a name="ln-8602"></a>              <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;Sensible load to be met = &#39;</span> <span class="p">&amp;</span>
<a name="ln-8603"></a>               <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">ZoneLoad</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; (watts), sensible output = &#39;</span> <span class="p">&amp;</span>
<a name="ln-8604"></a>               <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">TempSensOutput</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; (watts), and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-8605"></a>            <span class="k">END IF</span>
<a name="ln-8606"></a><span class="k">            CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-8607"></a>             <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - Iteration limit exceeded in calculating&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8608"></a>             <span class="s1">&#39; sensible part-load ratio error continues. Sensible load statistics:&#39;</span> <span class="p">&amp;</span>
<a name="ln-8609"></a>             <span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxIterIndex</span><span class="p">,</span><span class="n">ZoneLoad</span><span class="p">,</span><span class="n">ZoneLoad</span><span class="p">)</span>
<a name="ln-8610"></a>          <span class="k">END IF</span>
<a name="ln-8611"></a><span class="k">        </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SolFlag</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8612"></a><span class="k">          IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RegulaFalsIFailedIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8613"></a><span class="k">            CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;Coil control failed for &#39;</span> <span class="p">&amp;</span>
<a name="ln-8614"></a>             <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-8615"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  sensible part-load ratio determined to be outside the range of 0-1.&#39;</span><span class="p">)</span>
<a name="ln-8616"></a>            <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;Sensible load to be met = &#39;</span> <span class="p">&amp;</span>
<a name="ln-8617"></a>            <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">ZoneLoad</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; (watts), and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-8618"></a>          <span class="k">END IF</span>
<a name="ln-8619"></a><span class="k">          CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-8620"></a>           <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8621"></a>           <span class="s1">&#39; sensible part-load ratio out of range error continues. Sensible load statistics:&#39;</span> <span class="p">&amp;</span>
<a name="ln-8622"></a>           <span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RegulaFalsIFailedIndex</span><span class="p">,</span><span class="n">ZoneLoad</span><span class="p">,</span><span class="n">ZoneLoad</span><span class="p">)</span>
<a name="ln-8623"></a>        <span class="k">END IF</span>
<a name="ln-8624"></a><span class="k">      </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SolFlag</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8625"></a><span class="k">        IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RegulaFalsIFailedIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8626"></a><span class="k">          CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;Coil control failed for &#39;</span> <span class="p">&amp;</span>
<a name="ln-8627"></a>            <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-8628"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  sensible part-load ratio determined to be outside the range of 0-1.&#39;</span><span class="p">)</span>
<a name="ln-8629"></a>          <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;Sensible load to be met = &#39;</span> <span class="p">&amp;</span>
<a name="ln-8630"></a>           <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">ZoneLoad</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; (watts), and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-8631"></a>        <span class="k">END IF</span>
<a name="ln-8632"></a><span class="k">        CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-8633"></a>        <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8634"></a>        <span class="s1">&#39; sensible part-load ratio out of range error continues. Sensible load statistics:&#39;</span> <span class="p">&amp;</span>
<a name="ln-8635"></a>        <span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RegulaFalsIFailedIndex</span><span class="p">,</span><span class="n">ZoneLoad</span><span class="p">,</span><span class="n">ZoneLoad</span><span class="p">)</span>
<a name="ln-8636"></a>      <span class="k">END IF</span> <span class="c">! IF (SolFlag == -1) THEN</span>
<a name="ln-8637"></a>    <span class="k">ELSE</span> <span class="c">! load is not bounded by capacity. Leave PLR=1 or turn off unit?</span>
<a name="ln-8638"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingPartLoadFrac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8639"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingPartLoadFrac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8640"></a>      <span class="n">CoolPLR</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8641"></a>      <span class="n">HeatPLR</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8642"></a>      <span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8643"></a>    <span class="k">END IF</span> <span class="c">! IF((HeatingLoad .AND. ZoneLoad &gt; SensOutputOff) .OR. (CoolingLoad .AND. ZoneLoad &lt; SensOutputOff))THEN</span>
<a name="ln-8644"></a>  <span class="k">END IF</span> <span class="c">! IF((HeatingLoad .AND. ZoneLoad &lt; SensOutputOn) .OR. (CoolingLoad .AND. ZoneLoad &gt; SensOutputOn))THEN</span>
<a name="ln-8645"></a>
<a name="ln-8646"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">HeatingLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MultiSpeedHeatingCoil</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8647"></a>                        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">VarSpeedHeatingCoil</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8648"></a><span class="k">    IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedNum</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8649"></a><span class="k">      </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCycRatio</span>   <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-8650"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8651"></a>    <span class="k">ELSE</span>
<a name="ln-8652"></a><span class="k">      </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCycRatio</span>   <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8653"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span> <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-8654"></a>    <span class="k">END IF</span>
<a name="ln-8655"></a><span class="k">    </span><span class="n">HeatPLR</span> <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-8656"></a>    <span class="n">CoolPLR</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8657"></a>    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCycRatio</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8658"></a>    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8659"></a>  <span class="n">ELSEIF</span><span class="p">(</span><span class="n">CoolingLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MultiSpeedCoolingCoil</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8660"></a>                            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">VarSpeedCoolingCoil</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-8661"></a><span class="k">    IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedNum</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8662"></a><span class="k">      </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCycRatio</span>   <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-8663"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8664"></a>    <span class="k">ELSE</span>
<a name="ln-8665"></a><span class="k">      </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCycRatio</span>   <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8666"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span> <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-8667"></a>    <span class="k">END IF</span>
<a name="ln-8668"></a><span class="k">    </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCycRatio</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8669"></a>    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8670"></a>    <span class="n">HeatPLR</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8671"></a>    <span class="n">CoolPLR</span> <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-8672"></a>  <span class="k">ELSE</span>
<a name="ln-8673"></a><span class="k">    </span><span class="n">HeatPLR</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingPartLoadFrac</span>
<a name="ln-8674"></a>    <span class="n">CoolPLR</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingPartLoadFrac</span>
<a name="ln-8675"></a>  <span class="k">END IF</span>
<a name="ln-8676"></a>
<a name="ln-8677"></a><span class="k">  CALL </span><span class="n">CalcUnitarySystemToLoad</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CoolPLR</span><span class="p">,</span><span class="n">HeatPLR</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8678"></a>                               <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">TempSensOutput</span><span class="p">,</span><span class="n">TempLatOutput</span><span class="p">,</span><span class="n">HXUnitOn</span><span class="p">,</span><span class="n">CompOn</span><span class="o">=</span><span class="n">CompressorONFlag</span><span class="p">)</span>
<a name="ln-8679"></a>
<a name="ln-8680"></a><span class="c">! FullSensibleOutput is used to set supplemental heater PLR in calling routine</span>
<a name="ln-8681"></a><span class="c">! OnOffAirFlowRatio is used to average air flow between ON and OFF state</span>
<a name="ln-8682"></a>  <span class="n">FullSensibleOutput</span> <span class="o">=</span> <span class="n">TempSensOutput</span>
<a name="ln-8683"></a>
<a name="ln-8684"></a>  <span class="c">! RETURN of the moisture load is met</span>
<a name="ln-8685"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">MoistureLoad</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">MoistureLoad</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MoistureLoad</span> <span class="o">&gt;=</span> <span class="n">TempLatOutput</span><span class="p">))</span><span class="k">RETURN</span>
<a name="ln-8686"></a>  <span class="c">! Multimode does not meet the latent load, only the sensible load with or without HX active</span>
<a name="ln-8687"></a>  <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">CoolingLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">DehumidControl_Multimode</span><span class="p">)</span><span class="k">RETURN</span>
<a name="ln-8688"></a><span class="c">!  IF(HeatingLoad .AND. UnitarySystem(UnitarySysNum)%DehumidControlType_Num .EQ. DehumidControl_CoolReheat)RETURN</span>
<a name="ln-8689"></a>
<a name="ln-8690"></a>  <span class="k">IF</span> <span class="p">((</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">DehumidControl_CoolReheat</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8691"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">DehumidControl_Multimode</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-8692"></a>
<a name="ln-8693"></a>    <span class="c">! find maximum latent output IF not already calculated</span>
<a name="ln-8694"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">HeatingLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8695"></a><span class="k">      </span><span class="n">CoolPLR</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8696"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingPartLoadFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8697"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedNum</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span>
<a name="ln-8698"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8699"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCycRatio</span>   <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8700"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">WSHPRuntimeFrac</span>   <span class="o">=</span> <span class="n">CoolPLR</span>
<a name="ln-8701"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8702"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingPartLoadFrac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8703"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-8704"></a>        <span class="n">HeatPLR</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8705"></a>        <span class="n">CoolingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8706"></a>        <span class="n">HeatingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-8707"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilSensDemand</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8708"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilLatentDemand</span> <span class="o">=</span> <span class="n">MoistureLoad</span>
<a name="ln-8709"></a>        <span class="k">CALL </span><span class="n">CalcUnitarySystemToLoad</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8710"></a>                                   <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">TempSensOutput</span><span class="p">,</span><span class="n">TempLatOutput</span><span class="p">,</span><span class="n">HXUnitOn</span><span class="p">,</span><span class="n">CompOn</span><span class="o">=</span><span class="n">CompressorONFlag</span><span class="p">)</span>
<a name="ln-8711"></a>        <span class="k">CALL </span><span class="n">CalcUnitarySystemToLoad</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CoolPLR</span><span class="p">,</span><span class="n">HeatPLR</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8712"></a>                                   <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">TempSensOutput</span><span class="p">,</span><span class="n">LatOutputOn</span><span class="p">,</span><span class="n">HXUnitOn</span><span class="p">,</span><span class="n">CompOn</span><span class="o">=</span><span class="n">CompressorONFlag</span><span class="p">)</span>
<a name="ln-8713"></a>      <span class="k">ELSE</span>
<a name="ln-8714"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilSensDemand</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8715"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilLatentDemand</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8716"></a>        <span class="k">CALL </span><span class="n">CalcUnitarySystemToLoad</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8717"></a>                                   <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">TempSensOutput</span><span class="p">,</span><span class="n">TempLatOutput</span><span class="p">,</span><span class="n">HXUnitOn</span><span class="p">,</span><span class="n">CompOn</span><span class="o">=</span><span class="n">CompressorONFlag</span><span class="p">)</span>
<a name="ln-8718"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilLatentDemand</span> <span class="o">=</span> <span class="n">MoistureLoad</span>
<a name="ln-8719"></a>        <span class="k">CALL </span><span class="n">CalcUnitarySystemToLoad</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CoolPLR</span><span class="p">,</span><span class="n">HeatPLR</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8720"></a>                                   <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">TempSensOutput</span><span class="p">,</span><span class="n">LatOutputOn</span><span class="p">,</span><span class="n">HXUnitOn</span><span class="p">,</span><span class="n">CompOn</span><span class="o">=</span><span class="n">CompressorONFlag</span><span class="p">)</span>
<a name="ln-8721"></a>      <span class="k">END IF</span>
<a name="ln-8722"></a><span class="k">    END IF</span>
<a name="ln-8723"></a>
<a name="ln-8724"></a><span class="k">    IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">DehumidControl_Multimode</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8725"></a>       <span class="n">MoistureLoad</span> <span class="o">&lt;</span> <span class="n">LatOutputOn</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8726"></a><span class="k">      </span><span class="n">HXUnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8727"></a>      <span class="k">CALL </span><span class="n">CalcUnitarySystemToLoad</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CoolPLR</span><span class="p">,</span><span class="n">HeatPLR</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8728"></a>                                   <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">TempSensOutput</span><span class="p">,</span><span class="n">LatOutputOn</span><span class="p">,</span><span class="n">HXUnitOn</span><span class="p">,</span><span class="n">CompOn</span><span class="o">=</span><span class="n">CompressorONFlag</span><span class="p">)</span>
<a name="ln-8729"></a>      <span class="n">FullSensibleOutput</span> <span class="o">=</span> <span class="n">TempSensOutput</span>
<a name="ln-8730"></a>    <span class="k">END IF</span>
<a name="ln-8731"></a>
<a name="ln-8732"></a><span class="c">!    IF ((HeatingLoad .AND. MoistureLoad &lt; TempLatOutput) .OR. &amp;</span>
<a name="ln-8733"></a><span class="c">!        (CoolingLoad .AND. MoistureLoad &lt; TempLatOutput .AND. MoistureLoad &gt; LatOutputOn) .OR. &amp;</span>
<a name="ln-8734"></a><span class="c">!        ((.NOT. HeatingLoad) .AND. (.NOT. CoolingLoad) .AND. MoistureLoad &gt; LatOutputOn)) THEN</span>
<a name="ln-8735"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">MoistureLoad</span> <span class="o">&lt;</span> <span class="n">TempLatOutput</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">MoistureLoad</span> <span class="o">&gt;</span> <span class="n">LatOutputOn</span><span class="p">))</span> <span class="k">THEN</span> <span class="c">! bounds check for RegulaFalsi</span>
<a name="ln-8736"></a>
<a name="ln-8737"></a>      <span class="c">! save heating PLR</span>
<a name="ln-8738"></a>      <span class="n">HeatPLR</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingPartLoadFrac</span>
<a name="ln-8739"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-8740"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! FLAG, if 1.0 then FirstHVACIteration equals TRUE, if 0.0 then FirstHVACIteration equals false</span>
<a name="ln-8741"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="mf">1.0d0</span>
<a name="ln-8742"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-8743"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>  <span class="o">=</span> <span class="n">CompressorONFlag</span> <span class="c">! CompOp</span>
<a name="ln-8744"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">DehumidControl_Multimode</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8745"></a><span class="k">        </span><span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  <span class="o">=</span> <span class="n">ZoneLoad</span>
<a name="ln-8746"></a>        <span class="n">Par</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! FLAG, 0.0 if latent load, 1.0 if sensible load to be met</span>
<a name="ln-8747"></a>      <span class="k">ELSE</span>
<a name="ln-8748"></a><span class="k">        </span><span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  <span class="o">=</span> <span class="n">MoistureLoad</span>
<a name="ln-8749"></a>        <span class="n">Par</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! FLAG, 0.0 if latent load, 1.0 if sensible load to be met</span>
<a name="ln-8750"></a>      <span class="k">END IF</span>
<a name="ln-8751"></a><span class="k">      </span><span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! FLAG, 0.0 if heating load, 1.0 if cooling or moisture load</span>
<a name="ln-8752"></a><span class="c">!      IF(HeatingLoad)Par(6)  = 0.0d0</span>
<a name="ln-8753"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>  <span class="o">=</span> <span class="n">OnOffAirFlowRatio</span> <span class="c">! Ratio of compressor ON mass flow rate to AVERAGE mass flow rate over time step</span>
<a name="ln-8754"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">HXUnitOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8755"></a><span class="k">        </span><span class="n">Par</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8756"></a>      <span class="k">ELSE</span>
<a name="ln-8757"></a><span class="k">        </span><span class="n">Par</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8758"></a>      <span class="k">END IF</span>
<a name="ln-8759"></a><span class="k">      </span><span class="n">Par</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingPartLoadFrac</span>
<a name="ln-8760"></a>    <span class="c">! Tolerance is fraction of load, MaxIter = 30, SolFalg = # of iterations or error as appropriate</span>
<a name="ln-8761"></a>      <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="mf">0.001d0</span><span class="p">,</span> <span class="n">MaxIter</span><span class="p">,</span> <span class="n">SolFlagLat</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">CalcUnitarySystemLoadResidual</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-8762"></a><span class="c">!      IF (HeatingLoad) THEN</span>
<a name="ln-8763"></a><span class="c">!        UnitarySystem(UnitarySysNum)%HeatingPartLoadFrac = PartLoadRatio</span>
<a name="ln-8764"></a><span class="c">!      ELSE</span>
<a name="ln-8765"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingPartLoadFrac</span> <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-8766"></a><span class="c">!      END IF</span>
<a name="ln-8767"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingPartLoadFrac</span> <span class="o">=</span> <span class="n">HeatPLR</span>
<a name="ln-8768"></a>    <span class="n">ELSEIF</span><span class="p">(</span><span class="n">MoistureLoad</span> <span class="o">&lt;</span> <span class="n">LatOutputOn</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">CoolingLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8769"></a><span class="c">!     Logic below needs further look...what to do if the bounds check for RegulaFalsi fail?</span>
<a name="ln-8770"></a><span class="c">!     I&#39;m not even sure if this should be done.</span>
<a name="ln-8771"></a><span class="c">!     It&#39;s wrong anyway, since there won&#39;t be a cooling load if multimode (see RETURN about 80 lines up).</span>
<a name="ln-8772"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">DehumidControl_Multimode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8773"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingPartLoadFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8774"></a>      <span class="k">END IF</span>
<a name="ln-8775"></a><span class="k">    END IF</span>
<a name="ln-8776"></a><span class="k">  END IF</span>
<a name="ln-8777"></a>
<a name="ln-8778"></a><span class="k">  </span><span class="n">CoolPLR</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingPartLoadFrac</span>
<a name="ln-8779"></a>  <span class="n">HeatPLR</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingPartLoadFrac</span>
<a name="ln-8780"></a>
<a name="ln-8781"></a>  <span class="k">CALL </span><span class="n">CalcUnitarySystemToLoad</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CoolPLR</span><span class="p">,</span><span class="n">HeatPLR</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8782"></a>                               <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">TempSensOutput</span><span class="p">,</span><span class="n">TempLatOutput</span><span class="p">,</span><span class="n">HXUnitOn</span><span class="p">,</span><span class="n">CompOn</span><span class="o">=</span><span class="n">CompressorONFlag</span><span class="p">)</span>
<a name="ln-8783"></a>
<a name="ln-8784"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SolFlagLat</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8785"></a>    <span class="c">! RegulaFalsi may not find cooling PLR when the latent degradation model is used.</span>
<a name="ln-8786"></a>    <span class="c">! IF iteration limit is exceeded, find tighter boundary of solution and repeat RegulaFalsi</span>
<a name="ln-8787"></a>    <span class="n">TempMaxPLR</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.1d0</span>
<a name="ln-8788"></a>    <span class="n">TempLatOutput</span> <span class="o">=</span> <span class="n">LatOutputOff</span>
<a name="ln-8789"></a>    <span class="k">DO WHILE</span><span class="p">((</span><span class="n">TempLatOutput</span> <span class="o">-</span> <span class="n">MoistureLoad</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">TempMaxPLR</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-8790"></a>      <span class="c">! find upper limit of HeatingPLR</span>
<a name="ln-8791"></a>      <span class="n">TempMaxPLR</span> <span class="o">=</span> <span class="n">TempMaxPLR</span> <span class="o">+</span> <span class="mf">0.1d0</span>
<a name="ln-8792"></a>      <span class="k">CALL </span><span class="n">CalcUnitarySystemToLoad</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">TempMaxPLR</span><span class="p">,</span><span class="n">HeatPLR</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8793"></a>                                   <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">TempSensOutput</span><span class="p">,</span><span class="n">TempLatOutput</span><span class="p">,</span><span class="n">HXUnitOn</span><span class="p">,</span><span class="n">CompOn</span><span class="o">=</span><span class="n">CompressorONFlag</span><span class="p">)</span>
<a name="ln-8794"></a>    <span class="k">END DO</span>
<a name="ln-8795"></a><span class="k">    </span><span class="n">TempMinPLR</span> <span class="o">=</span> <span class="n">TempMaxPLR</span>
<a name="ln-8796"></a>    <span class="k">DO WHILE</span><span class="p">((</span><span class="n">TempLatOutput</span> <span class="o">-</span> <span class="n">MoistureLoad</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">TempMinPLR</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-8797"></a>      <span class="c">! pull upper limit of HeatingPLR DOwn to last valid limit (i.e. heat output still exceeds SystemSensibleLoad)</span>
<a name="ln-8798"></a>      <span class="n">TempMaxPLR</span> <span class="o">=</span> <span class="n">TempMinPLR</span>
<a name="ln-8799"></a>      <span class="c">! find minimum limit of HeatingPLR</span>
<a name="ln-8800"></a>      <span class="n">TempMinPLR</span> <span class="o">=</span> <span class="n">TempMinPLR</span> <span class="o">-</span> <span class="mf">0.01d0</span>
<a name="ln-8801"></a>      <span class="k">CALL </span><span class="n">CalcUnitarySystemToLoad</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">TempMinPLR</span><span class="p">,</span><span class="n">HeatPLR</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8802"></a>                                   <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">TempSensOutput</span><span class="p">,</span><span class="n">TempLatOutput</span><span class="p">,</span><span class="n">HXUnitOn</span><span class="p">,</span><span class="n">CompOn</span><span class="o">=</span><span class="n">CompressorONFlag</span><span class="p">)</span>
<a name="ln-8803"></a>    <span class="k">END DO</span>
<a name="ln-8804"></a>    <span class="c">! Now solve again with tighter PLR limits</span>
<a name="ln-8805"></a>    <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="mf">0.001d0</span><span class="p">,</span> <span class="n">MaxIter</span><span class="p">,</span> <span class="n">SolFlagLat</span><span class="p">,</span> <span class="n">CoolPLR</span><span class="p">,</span> <span class="n">CalcUnitarySystemLoadResidual</span><span class="p">,</span> <span class="n">TempMinPLR</span><span class="p">,</span> <span class="n">TempMaxPLR</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-8806"></a>    <span class="k">CALL </span><span class="n">CalcUnitarySystemToLoad</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CoolPLR</span><span class="p">,</span><span class="n">HeatPLR</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8807"></a>                                 <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">TempSensOutput</span><span class="p">,</span><span class="n">TempLatOutput</span><span class="p">,</span><span class="n">HXUnitOn</span><span class="p">,</span><span class="n">CompOn</span><span class="o">=</span><span class="n">CompressorONFlag</span><span class="p">)</span>
<a name="ln-8808"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SolFlagLat</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8809"></a><span class="k">      IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">MoistureLoad</span> <span class="o">-</span> <span class="n">TempLatOutput</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SmallLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8810"></a><span class="k">        IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">LatMaxIterIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8811"></a><span class="k">          CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;Coil control failed to converge for &#39;</span> <span class="p">&amp;</span>
<a name="ln-8812"></a>               <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-8813"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Iteration limit exceeded in calculating system Latent part-load ratio.&#39;</span><span class="p">)</span>
<a name="ln-8814"></a>          <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;Latent load to be met = &#39;</span> <span class="p">&amp;</span>
<a name="ln-8815"></a>             <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MoistureLoad</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; (watts), Latent output = &#39;</span> <span class="p">&amp;</span>
<a name="ln-8816"></a>             <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">TempLatOutput</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; (watts), and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-8817"></a>        <span class="k">END IF</span>
<a name="ln-8818"></a><span class="k">        CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-8819"></a>          <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - Iteration limit exceeded in calculating&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8820"></a>          <span class="s1">&#39; Latent part-load ratio error continues. Latent load statistics:&#39;</span> <span class="p">&amp;</span>
<a name="ln-8821"></a>          <span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">LatMaxIterIndex</span><span class="p">,</span><span class="n">MoistureLoad</span><span class="p">,</span><span class="n">MoistureLoad</span><span class="p">)</span>
<a name="ln-8822"></a>      <span class="k">END IF</span>
<a name="ln-8823"></a><span class="k">    </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SolFlagLat</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8824"></a><span class="k">      IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">LatRegulaFalsIFailedIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8825"></a><span class="k">        CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;Coil control failed for &#39;</span> <span class="p">&amp;</span>
<a name="ln-8826"></a>              <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-8827"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Latent part-load ratio determined to be outside the range of 0-1.&#39;</span><span class="p">)</span>
<a name="ln-8828"></a>        <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;Latent load to be met = &#39;</span> <span class="p">&amp;</span>
<a name="ln-8829"></a>           <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MoistureLoad</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; (watts), and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-8830"></a>      <span class="k">END IF</span>
<a name="ln-8831"></a><span class="k">      CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-8832"></a>        <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8833"></a>        <span class="s1">&#39; Latent part-load ratio out of range error continues. Latent load statistics:&#39;</span> <span class="p">&amp;</span>
<a name="ln-8834"></a>        <span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">LatRegulaFalsIFailedIndex</span><span class="p">,</span><span class="n">MoistureLoad</span><span class="p">,</span><span class="n">MoistureLoad</span><span class="p">)</span>
<a name="ln-8835"></a>    <span class="k">END IF</span>
<a name="ln-8836"></a><span class="k">  </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SolFlagLat</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8837"></a><span class="k">    IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">LatRegulaFalsIFailedIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8838"></a><span class="k">      CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;Coil control failed for &#39;</span> <span class="p">&amp;</span>
<a name="ln-8839"></a>              <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-8840"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Latent part-load ratio determined to be outside the range of 0-1.&#39;</span><span class="p">)</span>
<a name="ln-8841"></a>      <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;Latent load to be met = &#39;</span> <span class="p">&amp;</span>
<a name="ln-8842"></a>           <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MoistureLoad</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; (watts), and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-8843"></a>    <span class="k">END IF</span>
<a name="ln-8844"></a><span class="k">    CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-8845"></a>        <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8846"></a>        <span class="s1">&#39; Latent part-load ratio out of range error continues. Latent load statistics:&#39;</span> <span class="p">&amp;</span>
<a name="ln-8847"></a>        <span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">LatRegulaFalsIFailedIndex</span><span class="p">,</span><span class="n">MoistureLoad</span><span class="p">,</span><span class="n">MoistureLoad</span><span class="p">)</span>
<a name="ln-8848"></a>  <span class="k">END IF</span>
<a name="ln-8849"></a>
<a name="ln-8850"></a><span class="k">  </span><span class="n">FullSensibleOutput</span> <span class="o">=</span> <span class="n">TempSensOutput</span>
<a name="ln-8851"></a>
<a name="ln-8852"></a>  <span class="n">CpAir</span> <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilInletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8853"></a>                         <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span><span class="p">)</span>
<a name="ln-8854"></a>  <span class="n">CoolingOnlySensibleOutput</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span> <span class="n">CpAir</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-8855"></a>     <span class="p">((</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NodeNumOfControlledZone</span><span class="p">)%</span><span class="n">Temp</span><span class="o">-</span><span class="p">&amp;</span>
<a name="ln-8856"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilOutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span><span class="p">)</span><span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-8857"></a>      <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilOutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span><span class="o">-</span><span class="p">&amp;</span>
<a name="ln-8858"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span><span class="p">))</span>
<a name="ln-8859"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">QToHeatSetPt</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8860"></a><span class="c">!   Calculate the reheat coil load wrt the heating setpoint temperature. Reheat coil picks up</span>
<a name="ln-8861"></a><span class="c">!   the entire excess sensible cooling (DX cooling coil and impact of outdoor air).</span>
<a name="ln-8862"></a>    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DehumidInducedHeatingDemandRate</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,(</span><span class="n">CoolingOnlySensibleOutput</span><span class="o">+</span><span class="n">QToHeatSetPt</span><span class="p">))</span>
<a name="ln-8863"></a><span class="c">!   Heating mode and dehumidification is required</span>
<a name="ln-8864"></a>  <span class="n">ELSEIF</span><span class="p">(</span><span class="n">QToHeatSetPt</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8865"></a><span class="c">!   Calculate the reheat coil load as the sensible capacity of the DX cooling coil only. Let</span>
<a name="ln-8866"></a><span class="c">!   the heating coil pick up the load due to outdoor air.</span>
<a name="ln-8867"></a>    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DehumidInducedHeatingDemandRate</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">CoolingOnlySensibleOutput</span><span class="p">)</span>
<a name="ln-8868"></a>  <span class="k">END IF</span>
<a name="ln-8869"></a>
<a name="ln-8870"></a><span class="k">  RETURN</span>
<a name="ln-8871"></a>
<a name="ln-8872"></a><span class="k">END SUBROUTINE </span><span class="n">ControlUnitarySystemOutput</span>
<a name="ln-8873"></a>
<a name="ln-8874"></a><span class="k">SUBROUTINE </span><span class="n">SetSpeedVariables</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">SensibleLoad</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-8875"></a>
<a name="ln-8876"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-8877"></a>          <span class="c">!       AUTHOR         Richard Raustad, FSEC</span>
<a name="ln-8878"></a>          <span class="c">!       DATE WRITTEN   February 2013</span>
<a name="ln-8879"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8880"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8881"></a>
<a name="ln-8882"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-8883"></a>          <span class="c">! This subroutine determines operating PLR and calculates the load based system output.</span>
<a name="ln-8884"></a>
<a name="ln-8885"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8886"></a>          <span class="c">! na</span>
<a name="ln-8887"></a>
<a name="ln-8888"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8889"></a>          <span class="c">! na</span>
<a name="ln-8890"></a>
<a name="ln-8891"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8892"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>           <span class="n">ONLY</span><span class="p">:</span> <span class="n">SolveRegulaFalsi</span><span class="p">,</span> <span class="n">TrimSigDigits</span>
<a name="ln-8893"></a>  <span class="k">USE </span><span class="n">DataHeatBalFanSys</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TempControlType</span>
<a name="ln-8894"></a>
<a name="ln-8895"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8896"></a>
<a name="ln-8897"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-8898"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">UnitarySysNum</span>    <span class="c">! Index of AirloopHVAC:UnitarySystem object</span>
<a name="ln-8899"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">SensibleLoad</span>     <span class="c">! True when meeting a sensible load (not a moisture load)</span>
<a name="ln-8900"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">PartLoadRatio</span>    <span class="c">! operating PLR</span>
<a name="ln-8901"></a>
<a name="ln-8902"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-8903"></a>          <span class="c">! na</span>
<a name="ln-8904"></a>
<a name="ln-8905"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-8906"></a>          <span class="c">! na</span>
<a name="ln-8907"></a>
<a name="ln-8908"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-8909"></a>          <span class="c">! na</span>
<a name="ln-8910"></a>
<a name="ln-8911"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DEFINITIONS:</span>
<a name="ln-8912"></a>          <span class="c">! na</span>
<a name="ln-8913"></a>
<a name="ln-8914"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8915"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">errflag</span>         <span class="c">! error flag returned from subroutine</span>
<a name="ln-8916"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RunTimeFrac</span>   <span class="c">! heat pump runtime fraction</span>
<a name="ln-8917"></a>
<a name="ln-8918"></a>
<a name="ln-8919"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">HeatingLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SensibleLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8920"></a><span class="k">    </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8921"></a>    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCycRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8922"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MultiSpeedHeatingCoil</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">VarSpeedHeatingCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8923"></a><span class="k">      IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedNum</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8924"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8925"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCycRatio</span>   <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-8926"></a>      <span class="k">ELSE</span>
<a name="ln-8927"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span> <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-8928"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCycRatio</span>   <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8929"></a>      <span class="k">END IF</span>
<a name="ln-8930"></a><span class="k">    </span><span class="n">ELSEIF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWaterToAirHPSimple</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8931"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWaterToAirHP</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8932"></a><span class="k">      CALL </span><span class="n">HeatPumpRunFrac</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="n">errflag</span><span class="p">,</span><span class="n">RuntimeFrac</span><span class="p">)</span>
<a name="ln-8933"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">RuntimeFrac</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span> <span class="o">==</span> <span class="n">ContFanCycCoil</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8934"></a><span class="k">        </span><span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="n">PartLoadRatio</span><span class="o">/</span><span class="n">RuntimeFrac</span>
<a name="ln-8935"></a>      <span class="k">ELSE</span>
<a name="ln-8936"></a><span class="k">        </span><span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-8937"></a>      <span class="k">END IF</span>
<a name="ln-8938"></a><span class="k">      </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-8939"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">WSHPRuntimeFrac</span>   <span class="o">=</span> <span class="n">RuntimeFrac</span>
<a name="ln-8940"></a>    <span class="k">END IF</span>
<a name="ln-8941"></a><span class="k">  ELSE</span>
<a name="ln-8942"></a><span class="k">    </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8943"></a>    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCycRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8944"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MultiSpeedCoolingCoil</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8945"></a>       <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">VarSpeedCoolingCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8946"></a><span class="k">      IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedNum</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8947"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8948"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCycRatio</span>   <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-8949"></a>      <span class="k">ELSE</span>
<a name="ln-8950"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span> <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-8951"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCycRatio</span>   <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8952"></a>      <span class="k">END IF</span>
<a name="ln-8953"></a><span class="k">    </span><span class="n">ELSEIF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_CoolingWaterToAirHPSimple</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8954"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_CoolingWaterToAirHP</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8955"></a><span class="k">      CALL </span><span class="n">HeatPumpRunFrac</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="n">errflag</span><span class="p">,</span><span class="n">RuntimeFrac</span><span class="p">)</span>
<a name="ln-8956"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">RuntimeFrac</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span> <span class="o">==</span> <span class="n">ContFanCycCoil</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8957"></a><span class="k">        </span><span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="n">PartLoadRatio</span><span class="o">/</span><span class="n">RuntimeFrac</span>
<a name="ln-8958"></a>      <span class="k">ELSE</span>
<a name="ln-8959"></a><span class="k">        </span><span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8960"></a>      <span class="k">END IF</span>
<a name="ln-8961"></a><span class="k">      </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-8962"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">WSHPRuntimeFrac</span>   <span class="o">=</span> <span class="n">RuntimeFrac</span>
<a name="ln-8963"></a>    <span class="n">ELSEIF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingTwoSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8964"></a><span class="k">      IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedNum</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8965"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8966"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCycRatio</span>   <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-8967"></a>      <span class="k">ELSE</span>
<a name="ln-8968"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span> <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-8969"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCycRatio</span>   <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8970"></a>      <span class="k">END IF</span>
<a name="ln-8971"></a><span class="k">    END IF</span>
<a name="ln-8972"></a><span class="k">  END IF</span>
<a name="ln-8973"></a>
<a name="ln-8974"></a>
<a name="ln-8975"></a><span class="k">  RETURN</span>
<a name="ln-8976"></a>
<a name="ln-8977"></a><span class="k">END SUBROUTINE </span><span class="n">SetSpeedVariables</span>
<a name="ln-8978"></a>
<a name="ln-8979"></a><span class="k">FUNCTION </span><span class="n">CalcUnitarySystemLoadResidual</span><span class="p">(</span><span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Residuum</span><span class="p">)</span>
<a name="ln-8980"></a>
<a name="ln-8981"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-8982"></a>          <span class="c">!       AUTHOR         Richard Raustad, FSEC</span>
<a name="ln-8983"></a>          <span class="c">!       DATE WRITTEN   February 2013</span>
<a name="ln-8984"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8985"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8986"></a>
<a name="ln-8987"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-8988"></a>          <span class="c">! To calculate the part-load ratio for the unitary system</span>
<a name="ln-8989"></a>
<a name="ln-8990"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8991"></a>          <span class="c">! Use SolveRegulaFalsi to CALL this Function to converge on a solution</span>
<a name="ln-8992"></a>
<a name="ln-8993"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8994"></a>          <span class="c">! na</span>
<a name="ln-8995"></a>
<a name="ln-8996"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8997"></a>          <span class="c">! na</span>
<a name="ln-8998"></a>
<a name="ln-8999"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9000"></a>
<a name="ln-9001"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-9002"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">PartLoadRatio</span>  <span class="c">! DX cooling coil part load ratio</span>
<a name="ln-9003"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">Par</span>            <span class="c">! Function parameters</span>
<a name="ln-9004"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                                     <span class="kd">::</span> <span class="n">Residuum</span>       <span class="c">! Result (force to 0)</span>
<a name="ln-9005"></a>
<a name="ln-9006"></a><span class="c">!   Parameter description example:</span>
<a name="ln-9007"></a><span class="c">!       Par(1)  = REAL(UnitarySysNum,r64) ! Index to Unitary System</span>
<a name="ln-9008"></a><span class="c">!       Par(2)  = 0.0                  ! FirstHVACIteration FLAG, IF 1.0 then TRUE, if 0.0 then FALSE</span>
<a name="ln-9009"></a><span class="c">!       Par(3)  = REAL(OpMode,r64)     ! Fan control, IF 1.0 then cycling fan, if 0.0 then continuous fan</span>
<a name="ln-9010"></a><span class="c">!       Par(4)  = REAL(CompOp,r64)     ! Compressor control, IF 1.0 then compressor ON, if 0.0 then compressor OFF</span>
<a name="ln-9011"></a><span class="c">!       Par(5)  = SensLoad or MoistureLoad   ! Sensible or Latent load to be met by unitary system</span>
<a name="ln-9012"></a><span class="c">!       Par(6)  = HeatingLoad or CoolingLoad ! Type of load FLAG, 0.0 IF heating load, 1.0 IF cooling or moisture load</span>
<a name="ln-9013"></a><span class="c">!       Par(7)  = 1.0                  ! Output calculation FLAG, 0.0 for latent capacity, 1.0 for sensible capacity</span>
<a name="ln-9014"></a><span class="c">!       Par(8)  = OnOffAirFlowRatio    ! Ratio of compressor ON air mass flow to AVERAGE air mass flow over time step</span>
<a name="ln-9015"></a><span class="c">!       Par(9)  = HXUnitOn             ! flag to enable HX, 1=ON and 2=OFF</span>
<a name="ln-9016"></a><span class="c">!       Par(10) = HeatingCoilPLR       ! used to calculate latent degradation for cycling fan RH control</span>
<a name="ln-9017"></a>
<a name="ln-9018"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-9019"></a>          <span class="c">! na</span>
<a name="ln-9020"></a>
<a name="ln-9021"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-9022"></a>          <span class="c">! na</span>
<a name="ln-9023"></a>
<a name="ln-9024"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-9025"></a>          <span class="c">! na</span>
<a name="ln-9026"></a>
<a name="ln-9027"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9028"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">UnitarySysNum</span>   <span class="c">! Index to this unitary system</span>
<a name="ln-9029"></a>  <span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">FirstHVACIteration</span> <span class="c">! FirstHVACIteration flag</span>
<a name="ln-9030"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">FanOpMode</span>          <span class="c">! Cycling fan or constant fan</span>
<a name="ln-9031"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">CompOp</span>             <span class="c">! Compressor on/off; 1=on, 0=off</span>
<a name="ln-9032"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">LoadToBeMet</span>        <span class="c">! Sensible or Latent load to be met</span>
<a name="ln-9033"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>  <span class="c">! Ratio of compressor ON air mass flow to AVERAGE air mass flow over time step</span>
<a name="ln-9034"></a>  <span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">HXUnitOn</span>           <span class="c">! flag to enable HX based on zone moisture load</span>
<a name="ln-9035"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">HeatPLR</span>            <span class="c">! heating coil part load ratio</span>
<a name="ln-9036"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CoolPLR</span>            <span class="c">! cooling coil part load ratio</span>
<a name="ln-9037"></a>  <span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">SensibleLoad</span>       <span class="c">! sensible load</span>
<a name="ln-9038"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">SensOutput</span>         <span class="c">! sensible output of system</span>
<a name="ln-9039"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">LatOutput</span>          <span class="c">! latent output of system</span>
<a name="ln-9040"></a>
<a name="ln-9041"></a><span class="c">! Convert parameters to usable variables</span>
<a name="ln-9042"></a>  <span class="n">UnitarySysNum</span>     <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-9043"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9044"></a><span class="k">    </span><span class="n">FirstHVACIteration</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-9045"></a>  <span class="k">ELSE</span>
<a name="ln-9046"></a><span class="k">    </span><span class="n">FirstHVACIteration</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-9047"></a>  <span class="k">END IF</span>
<a name="ln-9048"></a><span class="k">  </span><span class="n">FanOpMode</span>            <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-9049"></a>  <span class="n">CompOp</span>               <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-9050"></a>  <span class="n">LoadToBeMet</span>          <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-9051"></a>  <span class="n">OnOffAirFlowRatio</span>    <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-9052"></a>
<a name="ln-9053"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9054"></a><span class="k">   </span><span class="n">CoolPLR</span>   <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-9055"></a>   <span class="n">HeatPLR</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9056"></a>  <span class="k">ELSE</span>
<a name="ln-9057"></a><span class="k">   </span><span class="n">CoolPLR</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9058"></a>   <span class="n">HeatPLR</span>   <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-9059"></a>  <span class="k">END IF</span>
<a name="ln-9060"></a>
<a name="ln-9061"></a><span class="k">  </span><span class="n">SensibleLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-9062"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="n">SensibleLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-9063"></a>
<a name="ln-9064"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9065"></a><span class="k">    </span><span class="n">HXUnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-9066"></a>  <span class="k">ELSE</span>
<a name="ln-9067"></a><span class="k">    </span><span class="n">HXUnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-9068"></a>  <span class="k">END IF</span>
<a name="ln-9069"></a>
<a name="ln-9070"></a><span class="k"> CALL </span><span class="n">SetSpeedVariables</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">SensibleLoad</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-9071"></a>
<a name="ln-9072"></a> <span class="k">CALL </span><span class="n">CalcUnitarySystemToLoad</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CoolPLR</span><span class="p">,</span><span class="n">HeatPLR</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9073"></a>                    <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SensOutput</span><span class="p">,</span><span class="n">LatOutput</span><span class="p">,</span><span class="n">HXUnitOn</span><span class="o">=</span><span class="n">HXUnitOn</span><span class="p">,</span><span class="n">CompOn</span><span class="o">=</span><span class="n">CompOp</span><span class="p">)</span>
<a name="ln-9074"></a>
<a name="ln-9075"></a><span class="c">! Calculate residual based on output calculation flag</span>
<a name="ln-9076"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">SensibleLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9077"></a><span class="k">    IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">LoadToBeMet</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9078"></a><span class="k">      </span><span class="n">Residuum</span> <span class="o">=</span> <span class="p">(</span><span class="n">SensOutput</span> <span class="o">-</span> <span class="n">LoadToBeMet</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="mf">0.0d0</span>
<a name="ln-9079"></a>    <span class="k">ELSE</span>
<a name="ln-9080"></a><span class="k">      </span><span class="n">Residuum</span> <span class="o">=</span> <span class="p">(</span><span class="n">SensOutput</span> <span class="o">-</span> <span class="n">LoadToBeMet</span><span class="p">)</span><span class="o">/</span><span class="n">LoadToBeMet</span>
<a name="ln-9081"></a>    <span class="k">END IF</span>
<a name="ln-9082"></a><span class="k">  ELSE</span>
<a name="ln-9083"></a><span class="k">    IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">LoadToBeMet</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9084"></a><span class="k">      </span><span class="n">Residuum</span> <span class="o">=</span> <span class="p">(</span><span class="n">LatOutput</span> <span class="o">-</span> <span class="n">LoadToBeMet</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="mf">0.0d0</span>
<a name="ln-9085"></a>    <span class="k">ELSE</span>
<a name="ln-9086"></a><span class="k">      </span><span class="n">Residuum</span> <span class="o">=</span> <span class="p">(</span><span class="n">LatOutput</span> <span class="o">-</span> <span class="n">LoadToBeMet</span><span class="p">)</span><span class="o">/</span><span class="n">LoadToBeMet</span>
<a name="ln-9087"></a>    <span class="k">END IF</span>
<a name="ln-9088"></a><span class="k">  END IF</span>
<a name="ln-9089"></a>
<a name="ln-9090"></a><span class="k">RETURN</span>
<a name="ln-9091"></a><span class="k">END FUNCTION </span><span class="n">CalcUnitarySystemLoadResidual</span>
<a name="ln-9092"></a>
<a name="ln-9093"></a><span class="k">SUBROUTINE </span><span class="n">CalcUnitarySystemToLoad</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CoolPLR</span><span class="p">,</span><span class="n">HeatPLR</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9094"></a>             <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SensOutput</span><span class="p">,</span><span class="n">LatOutput</span><span class="p">,</span><span class="n">HXUnitOn</span><span class="p">,</span><span class="n">HeatCoilLoad</span><span class="p">,</span><span class="n">SuppCoilLoad</span><span class="p">,</span><span class="n">CompOn</span><span class="p">)</span>
<a name="ln-9095"></a>
<a name="ln-9096"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-9097"></a>          <span class="c">!       AUTHOR         Richard Raustad, FSEC</span>
<a name="ln-9098"></a>          <span class="c">!       DATE WRITTEN   February 2013</span>
<a name="ln-9099"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9100"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9101"></a>
<a name="ln-9102"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-9103"></a>          <span class="c">! This subroutine calculates the resulting performance of the unitary system given</span>
<a name="ln-9104"></a>          <span class="c">! the operating PLR. System output is calculated with respect to zone condition.</span>
<a name="ln-9105"></a>
<a name="ln-9106"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9107"></a>          <span class="c">! na</span>
<a name="ln-9108"></a>
<a name="ln-9109"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-9110"></a>          <span class="c">! na</span>
<a name="ln-9111"></a>
<a name="ln-9112"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9113"></a>  <span class="k">USE </span><span class="n">Fans</span><span class="p">,</span>             <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateFanComponents</span>
<a name="ln-9114"></a>  <span class="k">USE </span><span class="n">Psychrometrics</span><span class="p">,</span>   <span class="n">ONLY</span><span class="p">:</span> <span class="n">PsyHFnTdbW</span><span class="p">,</span> <span class="n">PsyCpAirFnWTdb</span>
<a name="ln-9115"></a>
<a name="ln-9116"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9117"></a>
<a name="ln-9118"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-9119"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">UnitarySysNum</span>    <span class="c">! Index of AirloopHVAC:UnitarySystem object</span>
<a name="ln-9120"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">FirstHVACIteration</span>  <span class="c">! True when first HVAC iteration</span>
<a name="ln-9121"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">CoolPLR</span>             <span class="c">! operating cooling part-load ratio []</span>
<a name="ln-9122"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">HeatPLR</span>             <span class="c">! operating cooling part-load ratio []</span>
<a name="ln-9123"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>   <span class="c">! ratio of heating PLR to cooling PLR (is this correct?)</span>
<a name="ln-9124"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">SensOutput</span>          <span class="c">! sensible capacity (W)</span>
<a name="ln-9125"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">LatOutput</span>           <span class="c">! latent capacity (W)</span>
<a name="ln-9126"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">HXUnitOn</span>        <span class="c">! Flag to control HX for HXAssisted Cooling Coil</span>
<a name="ln-9127"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">HeatCoilLoad</span>  <span class="c">! Adjusted load to heating coil when SAT exceeds max limit (W)</span>
<a name="ln-9128"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">SuppCoilLoad</span>  <span class="c">! Adjusted load to supp heating coil when SAT exceeds max limit (W)</span>
<a name="ln-9129"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">OPTIONAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">CompOn</span>           <span class="c">! Determines if compressor is on or off</span>
<a name="ln-9130"></a>
<a name="ln-9131"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-9132"></a>          <span class="c">! na</span>
<a name="ln-9133"></a>
<a name="ln-9134"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-9135"></a>          <span class="c">! na</span>
<a name="ln-9136"></a>
<a name="ln-9137"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-9138"></a>          <span class="c">! na</span>
<a name="ln-9139"></a>
<a name="ln-9140"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9141"></a>  <span class="kt">INTEGER</span>                       <span class="kd">::</span> <span class="n">OutletNode</span>         <span class="c">! DX System outlet node number</span>
<a name="ln-9142"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">SuppPLR</span>            <span class="c">! supplemental heating coil operating part-load ratio</span>
<a name="ln-9143"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">MinHumRatio</span>        <span class="c">! used to calculate delivered capacity</span>
<a name="ln-9144"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">AirMassFlow</span>        <span class="c">! operating mass flow rate through unitary system (kg/s)</span>
<a name="ln-9145"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">ZoneTemp</span>           <span class="c">! zone node temperature (C)</span>
<a name="ln-9146"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">ZoneHumRat</span>         <span class="c">! zone node humidity ratio (kg-water/kg-dryair)</span>
<a name="ln-9147"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">CoilCoolHeatRat</span>    <span class="c">! ratio of cooling to heating PLR for cycling fan RH control</span>
<a name="ln-9148"></a>  <span class="kt">INTEGER</span>                       <span class="kd">::</span> <span class="n">CoolingCompOn</span>      <span class="c">! Compressor control (0=off, 1=on1)</span>
<a name="ln-9149"></a>  <span class="kt">INTEGER</span>                       <span class="kd">::</span> <span class="n">HeatingCompOn</span>      <span class="c">! Compressor control (0=off, 1=on1)</span>
<a name="ln-9150"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">MDotAir</span>            <span class="c">! inlet air mass flow rate [kg/s]</span>
<a name="ln-9151"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">CpAir</span>              <span class="c">! average specific heat [J/kg-C]</span>
<a name="ln-9152"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">CpAirIn</span>            <span class="c">! inlet air Cp  [J/kg-C]</span>
<a name="ln-9153"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">CpAirOut</span>           <span class="c">! outlet air Cp [J/kg-C]</span>
<a name="ln-9154"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">HCDeltaT</span>           <span class="c">! heating coil delta temperture [deltaC]</span>
<a name="ln-9155"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">MaxHeatCoilLoad</span>    <span class="c">! maximum allowed coil load so max temp is not exceeded [W]</span>
<a name="ln-9156"></a>
<a name="ln-9157"></a>  <span class="n">CoolingCompOn</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-9158"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">CoolPLR</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9159"></a><span class="k">    </span><span class="n">CoolingCompOn</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-9160"></a>    <span class="c">! let logical override compressor status if present (tests if economizer can meet load without compressor)</span>
<a name="ln-9161"></a>    <span class="k">IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">CompOn</span><span class="p">))</span><span class="n">CoolingCompOn</span><span class="o">=</span><span class="n">CompOn</span>
<a name="ln-9162"></a>  <span class="c">! for multispeed coils, comp is on IF speed &gt; 1</span>
<a name="ln-9163"></a>  <span class="n">ELSEIF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9164"></a><span class="k">    </span><span class="n">CoolingCompOn</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-9165"></a>  <span class="k">END IF</span>
<a name="ln-9166"></a>
<a name="ln-9167"></a><span class="k">  </span><span class="n">HeatingCompOn</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-9168"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">HeatPLR</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9169"></a><span class="k">    </span><span class="n">HeatingCompOn</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-9170"></a>    <span class="c">! let logical override compressor status if present (tests if economizer can meet load without compressor)</span>
<a name="ln-9171"></a>    <span class="c">! probably don&#39;t need this for heating mode</span>
<a name="ln-9172"></a>    <span class="k">IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">CompOn</span><span class="p">))</span><span class="n">HeatingCompOn</span><span class="o">=</span><span class="n">CompOn</span>
<a name="ln-9173"></a>    <span class="n">CoilCoolHeatRat</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">CoolPLR</span><span class="o">/</span><span class="n">HeatPLR</span><span class="p">)</span>
<a name="ln-9174"></a>  <span class="k">ELSE</span>
<a name="ln-9175"></a><span class="k">    </span><span class="n">CoilCoolHeatRat</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-9176"></a>  <span class="k">END IF</span>
<a name="ln-9177"></a>  <span class="c">! for multispeed coils, comp is on at PLR=0 IF speed &gt; 1</span>
<a name="ln-9178"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span><span class="n">HeatingCompOn</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-9179"></a>
<a name="ln-9180"></a>  <span class="c">! set the operating flow rate</span>
<a name="ln-9181"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9182"></a>     <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9183"></a><span class="k">     CALL </span><span class="n">SetOnOffMassFlowRate</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">CoolPLR</span><span class="p">,</span><span class="n">HeatPLR</span><span class="p">))</span>
<a name="ln-9184"></a>  <span class="k">ELSE</span>
<a name="ln-9185"></a><span class="k">    CALL </span><span class="n">SetAverageAirFlow</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">CoolPLR</span><span class="p">,</span><span class="n">HeatPLR</span><span class="p">),</span> <span class="n">OnOffAirFlowRatio</span><span class="p">)</span>
<a name="ln-9186"></a>  <span class="k">END IF</span>
<a name="ln-9187"></a>
<a name="ln-9188"></a>  <span class="c">! Call the series of components that simulate a Unitary System</span>
<a name="ln-9189"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanExists</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">BlowThru</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9190"></a><span class="k">    CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanIndex</span><span class="p">,</span><span class="n">FanSpeedRatio</span><span class="p">)</span>
<a name="ln-9191"></a>  <span class="k">END IF</span>
<a name="ln-9192"></a>
<a name="ln-9193"></a><span class="k">  IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilUpstream</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9194"></a>
<a name="ln-9195"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9196"></a><span class="k">      CALL </span><span class="n">CalcUnitaryCoolingSystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">CoolPLR</span><span class="p">,</span> <span class="n">CoolingCompOn</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9197"></a>                                    <span class="n">CoilCoolHeatRat</span><span class="p">,</span> <span class="n">HXUnitOn</span><span class="p">)</span>
<a name="ln-9198"></a>    <span class="k">END IF</span>
<a name="ln-9199"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9200"></a>      <span class="c">! operate the heating coil without regard to coil outlet temperature</span>
<a name="ln-9201"></a>      <span class="k">CALL </span><span class="n">CalcUnitaryHeatingSystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">HeatPLR</span><span class="p">,</span> <span class="n">HeatingCompOn</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9202"></a>                                    <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">HeatCoilLoad</span><span class="p">)</span>
<a name="ln-9203"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilOutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9204"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignMaxOutletTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9205"></a><span class="k">        </span><span class="n">MDotAir</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-9206"></a>        <span class="n">CpAirIn</span>  <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilInletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9207"></a>                                  <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span><span class="p">)</span>
<a name="ln-9208"></a>        <span class="n">CpAirOut</span> <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilOutletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9209"></a>                                  <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilOutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span><span class="p">)</span>
<a name="ln-9210"></a>        <span class="n">CpAir</span> <span class="o">=</span> <span class="p">(</span><span class="n">CpAirIn</span> <span class="o">+</span> <span class="n">CpAirout</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<a name="ln-9211"></a>        <span class="n">HCDeltaT</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignMaxOutletTemp</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-9212"></a>                   <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-9213"></a>        <span class="n">MaxHeatCoilLoad</span> <span class="o">=</span> <span class="n">MDotAir</span> <span class="o">*</span> <span class="n">CpAir</span> <span class="o">*</span> <span class="n">HCDeltaT</span>
<a name="ln-9214"></a>        <span class="k">CALL </span><span class="n">CalcUnitaryHeatingSystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">HeatPLR</span><span class="p">,</span> <span class="n">HeatingCompOn</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9215"></a>                                      <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">MaxHeatCoilLoad</span><span class="p">)</span>
<a name="ln-9216"></a>        <span class="k">IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">HeatCoilLoad</span><span class="p">))</span><span class="n">HeatCoilLoad</span> <span class="o">=</span> <span class="n">MaxHeatCoilLoad</span>
<a name="ln-9217"></a>      <span class="k">END IF</span>
<a name="ln-9218"></a><span class="k">    END IF</span>
<a name="ln-9219"></a>
<a name="ln-9220"></a>    <span class="c">! If blow thru fan is used, the fan must be simulated after coil sets OnOffFanPartLoadFraction</span>
<a name="ln-9221"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanExists</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">BlowThru</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9222"></a>        <span class="n">OnOffFanPartLoadFraction</span> <span class="o">&lt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9223"></a><span class="k">      CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanIndex</span><span class="p">,</span><span class="n">FanSpeedRatio</span><span class="p">)</span>
<a name="ln-9224"></a>
<a name="ln-9225"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9226"></a><span class="k">        CALL </span><span class="n">CalcUnitaryCoolingSystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">CoolPLR</span><span class="p">,</span> <span class="n">CoolingCompOn</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9227"></a>                                    <span class="n">CoilCoolHeatRat</span><span class="p">,</span> <span class="n">HXUnitOn</span><span class="p">)</span>
<a name="ln-9228"></a>      <span class="k">END IF</span>
<a name="ln-9229"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9230"></a><span class="k">        CALL </span><span class="n">CalcUnitaryHeatingSystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">HeatPLR</span><span class="p">,</span> <span class="n">HeatingCompOn</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">HeatCoilLoad</span><span class="p">)</span>
<a name="ln-9231"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilOutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9232"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignMaxOutletTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9233"></a><span class="k">          </span><span class="n">MDotAir</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-9234"></a>          <span class="n">CpAirIn</span>  <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilInletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9235"></a>                                    <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span><span class="p">)</span>
<a name="ln-9236"></a>          <span class="n">CpAirOut</span> <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilOutletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9237"></a>                                    <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilOutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span><span class="p">)</span>
<a name="ln-9238"></a>          <span class="n">CpAir</span> <span class="o">=</span> <span class="p">(</span><span class="n">CpAirIn</span> <span class="o">+</span> <span class="n">CpAirout</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<a name="ln-9239"></a>          <span class="n">HCDeltaT</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignMaxOutletTemp</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-9240"></a>                     <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-9241"></a>          <span class="n">MaxHeatCoilLoad</span> <span class="o">=</span> <span class="n">MDotAir</span> <span class="o">*</span> <span class="n">CpAir</span> <span class="o">*</span> <span class="n">HCDeltaT</span>
<a name="ln-9242"></a>          <span class="k">CALL </span><span class="n">CalcUnitaryHeatingSystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">HeatPLR</span><span class="p">,</span> <span class="n">HeatingCompOn</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9243"></a>                                        <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">MaxHeatCoilLoad</span><span class="p">)</span>
<a name="ln-9244"></a>        <span class="k">END IF</span>
<a name="ln-9245"></a><span class="k">      END IF</span>
<a name="ln-9246"></a><span class="k">    END IF</span>
<a name="ln-9247"></a>
<a name="ln-9248"></a><span class="k">  ELSE</span>
<a name="ln-9249"></a>
<a name="ln-9250"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9251"></a><span class="k">      CALL </span><span class="n">CalcUnitaryHeatingSystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">HeatPLR</span><span class="p">,</span> <span class="n">HeatingCompOn</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">HeatCoilLoad</span><span class="p">)</span>
<a name="ln-9252"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilOutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9253"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignMaxOutletTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9254"></a><span class="k">        </span><span class="n">MDotAir</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-9255"></a>        <span class="n">CpAirIn</span>  <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilInletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9256"></a>                                  <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span><span class="p">)</span>
<a name="ln-9257"></a>        <span class="n">CpAirOut</span> <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilOutletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9258"></a>                                  <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilOutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span><span class="p">)</span>
<a name="ln-9259"></a>        <span class="n">CpAir</span> <span class="o">=</span> <span class="p">(</span><span class="n">CpAirIn</span> <span class="o">+</span> <span class="n">CpAirout</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<a name="ln-9260"></a>        <span class="n">HCDeltaT</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignMaxOutletTemp</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-9261"></a>                   <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-9262"></a>        <span class="n">MaxHeatCoilLoad</span> <span class="o">=</span> <span class="n">MDotAir</span> <span class="o">*</span> <span class="n">CpAir</span> <span class="o">*</span> <span class="n">HCDeltaT</span>
<a name="ln-9263"></a>        <span class="k">CALL </span><span class="n">CalcUnitaryHeatingSystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">HeatPLR</span><span class="p">,</span> <span class="n">HeatingCompOn</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9264"></a>                                      <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">MaxHeatCoilLoad</span><span class="p">)</span>
<a name="ln-9265"></a>      <span class="k">END IF</span>
<a name="ln-9266"></a><span class="k">    END IF</span>
<a name="ln-9267"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9268"></a><span class="k">      CALL </span><span class="n">CalcUnitaryCoolingSystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">CoolPLR</span><span class="p">,</span> <span class="n">CoolingCompOn</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9269"></a>                                    <span class="n">CoilCoolHeatRat</span><span class="p">,</span> <span class="n">HXUnitOn</span><span class="p">)</span>
<a name="ln-9270"></a>    <span class="k">END IF</span>
<a name="ln-9271"></a>
<a name="ln-9272"></a>    <span class="c">! If blow thru fan is used, the fan must be simulated after coil sets OnOffFanPartLoadFraction</span>
<a name="ln-9273"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanExists</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">BlowThru</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9274"></a>        <span class="n">OnOffFanPartLoadFraction</span> <span class="o">&lt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9275"></a><span class="k">      CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanIndex</span><span class="p">,</span><span class="n">FanSpeedRatio</span><span class="p">)</span>
<a name="ln-9276"></a>
<a name="ln-9277"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9278"></a><span class="k">        CALL </span><span class="n">CalcUnitaryHeatingSystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">HeatPLR</span><span class="p">,</span> <span class="n">HeatingCompOn</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">HeatCoilLoad</span><span class="p">)</span>
<a name="ln-9279"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilOutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9280"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignMaxOutletTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9281"></a><span class="k">          </span><span class="n">MDotAir</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-9282"></a>          <span class="n">CpAirIn</span>  <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilInletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9283"></a>                                    <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span><span class="p">)</span>
<a name="ln-9284"></a>          <span class="n">CpAirOut</span> <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilOutletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9285"></a>                                    <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilOutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span><span class="p">)</span>
<a name="ln-9286"></a>          <span class="n">CpAir</span> <span class="o">=</span> <span class="p">(</span><span class="n">CpAirIn</span> <span class="o">+</span> <span class="n">CpAirout</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<a name="ln-9287"></a>          <span class="n">HCDeltaT</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignMaxOutletTemp</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-9288"></a>                     <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-9289"></a>          <span class="n">MaxHeatCoilLoad</span> <span class="o">=</span> <span class="n">MDotAir</span> <span class="o">*</span> <span class="n">CpAir</span> <span class="o">*</span> <span class="n">HCDeltaT</span>
<a name="ln-9290"></a>          <span class="k">CALL </span><span class="n">CalcUnitaryHeatingSystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">HeatPLR</span><span class="p">,</span> <span class="n">HeatingCompOn</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9291"></a>                                        <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">MaxHeatCoilLoad</span><span class="p">)</span>
<a name="ln-9292"></a>        <span class="k">END IF</span>
<a name="ln-9293"></a><span class="k">      END IF</span>
<a name="ln-9294"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9295"></a><span class="k">        CALL </span><span class="n">CalcUnitaryCoolingSystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">CoolPLR</span><span class="p">,</span> <span class="n">CoolingCompOn</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9296"></a>                                    <span class="n">CoilCoolHeatRat</span><span class="p">,</span> <span class="n">HXUnitOn</span><span class="p">)</span>
<a name="ln-9297"></a>      <span class="k">END IF</span>
<a name="ln-9298"></a><span class="k">    END IF</span>
<a name="ln-9299"></a>
<a name="ln-9300"></a><span class="k">  END IF</span>
<a name="ln-9301"></a>
<a name="ln-9302"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanExists</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">DrawThru</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9303"></a><span class="k">    CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanIndex</span><span class="p">,</span><span class="n">FanSpeedRatio</span><span class="p">)</span>
<a name="ln-9304"></a>  <span class="k">END IF</span>
<a name="ln-9305"></a>
<a name="ln-9306"></a><span class="k">  </span><span class="n">SuppPLR</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatPartLoadFrac</span>
<a name="ln-9307"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9308"></a><span class="k">    CALL </span><span class="n">CalcUnitarySuppHeatingSystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">SuppPLR</span><span class="p">,</span> <span class="n">SuppCoilLoad</span><span class="p">)</span>
<a name="ln-9309"></a>    <span class="k">IF</span><span class="p">((</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilAirOutletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9310"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignMaxOutletTemp</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SuppPLR</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9311"></a><span class="k">      </span><span class="n">MDotAir</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilAirInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-9312"></a>      <span class="n">CpAirIn</span>  <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilAirInletNode</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9313"></a>                                <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilAirInletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">)</span>
<a name="ln-9314"></a>      <span class="n">CpAirOut</span> <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilAirOutletNode</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9315"></a>                                <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilAirOutletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">)</span>
<a name="ln-9316"></a>      <span class="n">CpAir</span> <span class="o">=</span> <span class="p">(</span><span class="n">CpAirIn</span> <span class="o">+</span> <span class="n">CpAirout</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<a name="ln-9317"></a>      <span class="n">HCDeltaT</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignMaxOutletTemp</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-9318"></a>                           <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilAirInletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">)</span>
<a name="ln-9319"></a>      <span class="n">MaxHeatCoilLoad</span> <span class="o">=</span> <span class="n">MDotAir</span> <span class="o">*</span> <span class="n">CpAir</span> <span class="o">*</span> <span class="n">HCDeltaT</span>
<a name="ln-9320"></a>      <span class="k">CALL </span><span class="n">CalcUnitarySuppHeatingSystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">SuppPLR</span><span class="p">,</span> <span class="n">MaxHeatCoilLoad</span><span class="p">)</span>
<a name="ln-9321"></a>      <span class="k">IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">SuppCoilLoad</span><span class="p">))</span><span class="n">SuppCoilLoad</span> <span class="o">=</span> <span class="n">MaxHeatCoilLoad</span>
<a name="ln-9322"></a>    <span class="k">END IF</span>
<a name="ln-9323"></a><span class="k">  END IF</span>
<a name="ln-9324"></a>
<a name="ln-9325"></a> <span class="c">! Check delta T (outlet to space), IF positive</span>
<a name="ln-9326"></a> <span class="c">! use space HumRat (next line), ELSE outlet humrat (IF) so psyc routine gives good result</span>
<a name="ln-9327"></a>  <span class="n">MinHumRatio</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NodeNumofControlledZone</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-9328"></a>  <span class="n">OutletNode</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemOutletNodeNum</span>
<a name="ln-9329"></a>  <span class="n">AirMassFlow</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-9330"></a>  <span class="n">ZoneTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NodeNumofControlledZone</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-9331"></a>  <span class="n">ZoneHumRat</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NodeNumofControlledZone</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-9332"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">ZoneTemp</span> <span class="p">)</span> <span class="n">MinHumRatio</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-9333"></a>
<a name="ln-9334"></a> <span class="c">! Calculate sensible load met (at constant humidity ratio)</span>
<a name="ln-9335"></a>  <span class="n">SensOutput</span> <span class="o">=</span> <span class="n">AirMassFlow</span> <span class="o">*</span> <span class="p">(</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">MinHumRatio</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-9336"></a>         <span class="o">-</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">ZoneTemp</span><span class="p">,</span><span class="n">MinHumRatio</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-9337"></a>         <span class="o">-</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SenLoadLoss</span>
<a name="ln-9338"></a>  <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SensibleLoadMet</span> <span class="o">=</span> <span class="n">SensOutput</span>
<a name="ln-9339"></a>
<a name="ln-9340"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Humidistat</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9341"></a>
<a name="ln-9342"></a><span class="c">!   Calculate latent load met (at constant temperature)</span>
<a name="ln-9343"></a>    <span class="n">LatOutput</span> <span class="o">=</span> <span class="n">AirMassFlow</span> <span class="o">*</span> <span class="p">(</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">ZoneTemp</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-9344"></a>         <span class="o">-</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">ZoneTemp</span><span class="p">,</span><span class="n">ZoneHumRat</span><span class="p">))</span> <span class="o">-</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">LatLoadLoss</span>
<a name="ln-9345"></a>  <span class="k">ELSE</span>
<a name="ln-9346"></a><span class="k">    </span><span class="n">LatOutput</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9347"></a>  <span class="k">END IF</span>
<a name="ln-9348"></a><span class="k">  </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">LatentLoadMet</span> <span class="o">=</span> <span class="n">LatOutput</span>
<a name="ln-9349"></a>
<a name="ln-9350"></a>  <span class="k">RETURN</span>
<a name="ln-9351"></a>
<a name="ln-9352"></a><span class="k">END SUBROUTINE </span><span class="n">CalcUnitarySystemToLoad</span>
<a name="ln-9353"></a>
<a name="ln-9354"></a><span class="k">SUBROUTINE </span><span class="n">CalcUnitaryCoolingSystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9355"></a>                                    <span class="n">CompOn</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">CoilCoolHeatRat</span><span class="p">,</span> <span class="n">HXUnitOn</span><span class="p">)</span>
<a name="ln-9356"></a>
<a name="ln-9357"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-9358"></a>          <span class="c">!       AUTHOR         Richard Raustad, FSEC</span>
<a name="ln-9359"></a>          <span class="c">!       DATE WRITTEN   February 2013</span>
<a name="ln-9360"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9361"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9362"></a>
<a name="ln-9363"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-9364"></a>          <span class="c">! This subroutine manages unitary cooling system component simulation.</span>
<a name="ln-9365"></a>
<a name="ln-9366"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9367"></a>          <span class="c">! na</span>
<a name="ln-9368"></a>
<a name="ln-9369"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-9370"></a>          <span class="c">! na</span>
<a name="ln-9371"></a>
<a name="ln-9372"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9373"></a>  <span class="k">USE </span><span class="n">DXCoils</span><span class="p">,</span>                   <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimDXCoil</span><span class="p">,</span> <span class="n">SimDXCoilMultiSpeed</span><span class="p">,</span> <span class="n">SimDXCoilMultiMode</span>
<a name="ln-9374"></a>  <span class="k">USE </span><span class="n">HVACHXAssistedCoolingCoil</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimHXAssistedCoolingCoil</span>
<a name="ln-9375"></a>  <span class="k">USE </span><span class="n">Fans</span><span class="p">,</span>                      <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateFanComponents</span>
<a name="ln-9376"></a>  <span class="k">USE </span><span class="n">WaterCoils</span><span class="p">,</span>                <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateWaterCoilComponents</span>
<a name="ln-9377"></a>  <span class="k">USE </span><span class="n">VariableSpeedCoils</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimVariableSpeedCoils</span>
<a name="ln-9378"></a>  <span class="k">USE </span><span class="n">WatertoAirHeatPumpSimple</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimWatertoAirHPSimple</span>
<a name="ln-9379"></a>  <span class="k">USE </span><span class="n">WatertoAirHeatPump</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimWaterToAirHP</span>
<a name="ln-9380"></a>
<a name="ln-9381"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9382"></a>
<a name="ln-9383"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-9384"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">UnitarySysNum</span>       <span class="c">! Index of AirloopHVAC:UnitarySystem object</span>
<a name="ln-9385"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">FirstHVACIteration</span>  <span class="c">! True when first HVAC iteration</span>
<a name="ln-9386"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">PartLoadRatio</span>       <span class="c">! coil operating part-load ratio</span>
<a name="ln-9387"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">CompOn</span>              <span class="c">! compressor control (0=off, 1=on)</span>
<a name="ln-9388"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>   <span class="c">!</span>
<a name="ln-9389"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">CoilCoolHeatRat</span>     <span class="c">! ratio of cooling to heating PLR for cycling fan RH control</span>
<a name="ln-9390"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">HXUnitOn</span>        <span class="c">! Flag to control HX for HXAssisted Cooling Coil</span>
<a name="ln-9391"></a>
<a name="ln-9392"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-9393"></a>
<a name="ln-9394"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-9395"></a>          <span class="c">! na</span>
<a name="ln-9396"></a>
<a name="ln-9397"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-9398"></a>          <span class="c">! na</span>
<a name="ln-9399"></a>
<a name="ln-9400"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9401"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CompName</span>            <span class="c">! Name of Unitary System object</span>
<a name="ln-9402"></a>  <span class="kt">INTEGER</span>                       <span class="kd">::</span> <span class="n">CompIndex</span>           <span class="c">! index to cooling coil</span>
<a name="ln-9403"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">OutsideDryBulbTemp</span>  <span class="c">! outdoor temperature (C)</span>
<a name="ln-9404"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">mdot</span>                <span class="c">! water side flow rate (kg/s)</span>
<a name="ln-9405"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">QActual</span>             <span class="c">! actual coil output (W)</span>
<a name="ln-9406"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">OutdoorPressure</span>     <span class="c">! Outdoor barometric pressure at condenser (Pa)</span>
<a name="ln-9407"></a>  <span class="kt">LOGICAL</span>                       <span class="kd">::</span> <span class="n">errflag</span>             <span class="c">! returned flag from called routine</span>
<a name="ln-9408"></a>
<a name="ln-9409"></a><span class="c">! Simulate the coil component</span>
<a name="ln-9410"></a>  <span class="n">CompName</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilName</span>
<a name="ln-9411"></a>  <span class="n">CompIndex</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span>
<a name="ln-9412"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CondenserNodeNum</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9413"></a><span class="k">    </span><span class="n">OutdoorPressure</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CondenserNodeNum</span><span class="p">)%</span><span class="n">Press</span>
<a name="ln-9414"></a>    <span class="c">! IF node is not connected to anything, pressure = default, use weather data</span>
<a name="ln-9415"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">OutdoorPressure</span> <span class="o">==</span> <span class="n">DefaultNodeValues</span><span class="p">%</span><span class="n">Press</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9416"></a><span class="k">      </span><span class="n">OutsideDryBulbTemp</span>  <span class="o">=</span> <span class="n">OutDryBulbTemp</span>
<a name="ln-9417"></a><span class="c">!      OutdoorHumRat   = OutHumRat</span>
<a name="ln-9418"></a><span class="c">!      OutdoorPressure = OutBaroPress</span>
<a name="ln-9419"></a><span class="c">!      OutdoorWetBulb  = OutWetBulbTemp</span>
<a name="ln-9420"></a>    <span class="k">ELSE</span>
<a name="ln-9421"></a><span class="k">      </span><span class="n">OutsideDryBulbTemp</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CondenserNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-9422"></a><span class="c">!      OutdoorHumRat   = Node(UnitarySystem(UnitarySysNum)%CondenserNodeNum)%HumRat</span>
<a name="ln-9423"></a><span class="c">!      OutdoorWetBulb  = PsyTwbFnTdbWPb(OutdoorDryBulb,OutdoorHumRat,OutdoorPressure,RoutineName)</span>
<a name="ln-9424"></a>    <span class="k">END IF</span>
<a name="ln-9425"></a><span class="k">  ELSE</span>
<a name="ln-9426"></a><span class="k">    </span><span class="n">OutsideDryBulbTemp</span>  <span class="o">=</span> <span class="n">OutDryBulbTemp</span>
<a name="ln-9427"></a><span class="c">!    OutdoorHumRat   = OutHumRat</span>
<a name="ln-9428"></a><span class="c">!    OutdoorPressure = OutBaroPress</span>
<a name="ln-9429"></a><span class="c">!    OutdoorWetBulb  = OutWetBulbTemp</span>
<a name="ln-9430"></a>  <span class="k">END IF</span>
<a name="ln-9431"></a><span class="c">!  PartLoadRatio = UnitarySystem(UnitarySysNum)%CoolingPartLoadFrac</span>
<a name="ln-9432"></a>
<a name="ln-9433"></a>  <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span><span class="p">)</span>
<a name="ln-9434"></a>
<a name="ln-9435"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_CoolingSingleSpeed</span><span class="p">)</span> <span class="c">! Coil:Cooling:DX:SingleSpeed</span>
<a name="ln-9436"></a>
<a name="ln-9437"></a>      <span class="k">CALL </span><span class="n">SimDXCoil</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">CompOn</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9438"></a>         <span class="n">CompIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9439"></a>         <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9440"></a>         <span class="n">CoilCoolingHeatingPLRRatio</span> <span class="o">=</span> <span class="n">CoilCoolHeatRat</span><span class="p">)</span>
<a name="ln-9441"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCompPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadRatio</span><span class="o">*</span><span class="kt">REAL</span><span class="p">(</span><span class="n">CompOn</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-9442"></a>
<a name="ln-9443"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_CoolingHXAssisted</span><span class="p">,</span><span class="n">CoilWater_CoolingHXAssisted</span><span class="p">)</span>  <span class="c">! CoilSystem:Cooling:*:HeatExchangerAssisted</span>
<a name="ln-9444"></a>
<a name="ln-9445"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span><span class="o">==</span><span class="n">CoilWater_CoolingHXAssisted</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9446"></a><span class="k">        </span><span class="n">mdot</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilFluidOutletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9447"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolCoilFluidFlow</span> <span class="o">*</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-9448"></a>        <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilFluidInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">mdot</span>
<a name="ln-9449"></a>      <span class="k">END IF</span>
<a name="ln-9450"></a><span class="k">      CALL </span><span class="n">SimHXAssistedCoolingCoil</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOn</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9451"></a>                                <span class="n">CompIndex</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9452"></a>                                <span class="n">HXUnitEnable</span><span class="o">=</span><span class="n">HXUnitOn</span><span class="p">,</span><span class="n">EconomizerFlag</span><span class="o">=</span><span class="n">EconomizerFlag</span><span class="p">)</span>
<a name="ln-9453"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span><span class="o">==</span><span class="n">CoilDX_CoolingHXAssisted</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-9454"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCompPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadRatio</span><span class="o">*</span><span class="kt">REAL</span><span class="p">(</span><span class="n">CompOn</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-9455"></a>
<a name="ln-9456"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_CoolingTwoSpeed</span><span class="p">)</span>  <span class="c">! Coil:Cooling:DX:TwoSpeed</span>
<a name="ln-9457"></a>                                   <span class="c">! formerly (v3 and beyond)COIL:DX:MULTISPEED:COOLINGEMPIRICAL</span>
<a name="ln-9458"></a>
<a name="ln-9459"></a>      <span class="k">CALL </span><span class="n">SimDXCoilMultiSpeed</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span><span class="p">,&amp;</span>
<a name="ln-9460"></a>                     <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCycRatio</span><span class="p">,</span><span class="n">CompIndex</span><span class="p">)</span>
<a name="ln-9461"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9462"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCompPartLoadRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span><span class="o">*</span><span class="kt">REAL</span><span class="p">(</span><span class="n">CompOn</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-9463"></a>      <span class="k">ELSE</span>
<a name="ln-9464"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCompPartLoadRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCycRatio</span><span class="o">*</span><span class="kt">REAL</span><span class="p">(</span><span class="n">CompOn</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-9465"></a>      <span class="k">END IF</span>
<a name="ln-9466"></a>
<a name="ln-9467"></a><span class="k">    CASE</span> <span class="p">(</span><span class="n">CoilDX_MultiSpeedCooling</span><span class="p">)</span> <span class="c">! Coil:Cooling:DX:Multispeed</span>
<a name="ln-9468"></a>
<a name="ln-9469"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">OutsideDryBulbTemp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MinOATCompressor</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9470"></a><span class="k">        CALL </span><span class="n">SimDXCoilMultiSpeed</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9471"></a>                                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCycRatio</span><span class="p">,&amp;</span>
<a name="ln-9472"></a>                                 <span class="n">CompIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9473"></a>                                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9474"></a>                                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">CompOn</span><span class="p">)</span>
<a name="ln-9475"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9476"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCompPartLoadRatio</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">CompOn</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-9477"></a>        <span class="k">ELSE</span>
<a name="ln-9478"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCompPartLoadRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCycRatio</span><span class="o">*</span><span class="kt">REAL</span><span class="p">(</span><span class="n">CompOn</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-9479"></a>        <span class="k">END IF</span>
<a name="ln-9480"></a><span class="k">      ELSE</span>
<a name="ln-9481"></a><span class="k">        CALL </span><span class="n">SimDXCoilMultiSpeed</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,&amp;</span>
<a name="ln-9482"></a>                                 <span class="n">CompIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9483"></a>                                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9484"></a>                                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">CompOn</span><span class="p">)</span>
<a name="ln-9485"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCompPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9486"></a>      <span class="k">END IF</span>
<a name="ln-9487"></a>
<a name="ln-9488"></a><span class="k">    CASE</span> <span class="p">(</span><span class="n">CoilDX_CoolingTwoStageWHumControl</span><span class="p">)</span>  <span class="c">! Coil:Cooling:DX:TwoStageWithHumidityControlMode</span>
<a name="ln-9489"></a>                                     <span class="c">! formerly (v3 and beyond) COIL:DX:MULTIMODE:COOLINGEMPIRICAL</span>
<a name="ln-9490"></a>
<a name="ln-9491"></a>      <span class="k">CALL </span><span class="n">SimDXCoilMultiMode</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">CompOn</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9492"></a>                     <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">dehumidificationMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9493"></a>                     <span class="n">CompIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9494"></a>                     <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">)</span>
<a name="ln-9495"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCompPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadRatio</span><span class="o">*</span><span class="kt">REAL</span><span class="p">(</span><span class="n">CompOn</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-9496"></a>
<a name="ln-9497"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_CoolingWater</span><span class="p">,</span> <span class="n">Coil_CoolingWaterDetailed</span><span class="p">)</span>
<a name="ln-9498"></a>      <span class="n">mdot</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilFluidOutletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9499"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolCoilFluidFlow</span> <span class="o">*</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-9500"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilFluidInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">mdot</span>
<a name="ln-9501"></a>      <span class="k">CALL </span><span class="n">SimulateWaterCoilComponents</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9502"></a>                                           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9503"></a>                                           <span class="n">QActual</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9504"></a>                                           <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-9505"></a>
<a name="ln-9506"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_CoolingAirToAirVariableSpeed</span><span class="p">,</span> <span class="n">Coil_CoolingWaterToAirHPVSEquationFit</span><span class="p">)</span>
<a name="ln-9507"></a>      <span class="k">CALL </span><span class="n">SimVariableSpeedCoils</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">CompIndex</span><span class="p">,&amp;</span>
<a name="ln-9508"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9509"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,&amp;</span>
<a name="ln-9510"></a>           <span class="n">CompOn</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9511"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9512"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span><span class="p">,&amp;</span>
<a name="ln-9513"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilSensDemand</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9514"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilLatentDemand</span> <span class="p">)</span>
<a name="ln-9515"></a>
<a name="ln-9516"></a>
<a name="ln-9517"></a>    <span class="k">CASE</span><span class="p">(</span><span class="n">Coil_CoolingWaterToAirHPSimple</span><span class="p">)</span>
<a name="ln-9518"></a>
<a name="ln-9519"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">PartLoadRatio</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">WSHPRuntimeFrac</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9520"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span> <span class="o">==</span> <span class="n">CycFanCycCoil</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9521"></a><span class="k">          </span><span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="n">PartLoadRatio</span><span class="o">/</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">WSHPRuntimeFrac</span>
<a name="ln-9522"></a>        <span class="k">END IF</span>
<a name="ln-9523"></a>
<a name="ln-9524"></a><span class="k">        CALL </span><span class="n">SimWatertoAirHPSimple</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9525"></a>                                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilSensDemand</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9526"></a>                                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilLatentDemand</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9527"></a>                                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">WSHPRuntimeFrac</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9528"></a>                                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9529"></a>                                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9530"></a>                                   <span class="n">CompOn</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-9531"></a>
<a name="ln-9532"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCompPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadRatio</span><span class="o">*</span><span class="kt">REAL</span><span class="p">(</span><span class="n">CompOn</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-9533"></a>
<a name="ln-9534"></a>    <span class="k">CASE</span><span class="p">(</span><span class="n">Coil_CoolingWaterToAirHP</span><span class="p">)</span>
<a name="ln-9535"></a>
<a name="ln-9536"></a>        <span class="k">CALL </span><span class="n">HeatPumpRunFrac</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="n">errflag</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">WSHPRuntimeFrac</span><span class="p">)</span>
<a name="ln-9537"></a>
<a name="ln-9538"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">PartLoadRatio</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">WSHPRuntimeFrac</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9539"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span> <span class="o">==</span> <span class="n">CycFanCycCoil</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9540"></a><span class="k">          </span><span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="n">PartLoadRatio</span><span class="o">/</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">WSHPRuntimeFrac</span>
<a name="ln-9541"></a>        <span class="k">END IF</span>
<a name="ln-9542"></a>
<a name="ln-9543"></a><span class="k">        CALL </span><span class="n">SimWatertoAirHP</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9544"></a>              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirMassFlow</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,&amp;</span>
<a name="ln-9545"></a>              <span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">WSHPRuntimeFrac</span><span class="p">,&amp;</span>
<a name="ln-9546"></a>              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9547"></a>              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9548"></a>              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9549"></a>              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">InitHeatPump</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9550"></a>              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilSensDemand</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9551"></a>              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilLatentDemand</span><span class="p">,</span><span class="n">CompOn</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-9552"></a>
<a name="ln-9553"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCompPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadRatio</span><span class="o">*</span><span class="kt">REAL</span><span class="p">(</span><span class="n">CompOn</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-9554"></a>
<a name="ln-9555"></a>  <span class="k">END SELECT</span>
<a name="ln-9556"></a>
<a name="ln-9557"></a><span class="k">  </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingPartLoadFrac</span> <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-9558"></a>
<a name="ln-9559"></a>  <span class="k">RETURN</span>
<a name="ln-9560"></a>
<a name="ln-9561"></a><span class="k">END SUBROUTINE </span><span class="n">CalcUnitaryCoolingSystem</span>
<a name="ln-9562"></a>
<a name="ln-9563"></a><span class="k">SUBROUTINE </span><span class="n">CalcUnitaryHeatingSystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">CompOn</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">HeatCoilLoad</span><span class="p">)</span>
<a name="ln-9564"></a>
<a name="ln-9565"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-9566"></a>          <span class="c">!       AUTHOR         Richard Raustad, FSEC</span>
<a name="ln-9567"></a>          <span class="c">!       DATE WRITTEN   February 2013</span>
<a name="ln-9568"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9569"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9570"></a>
<a name="ln-9571"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-9572"></a>          <span class="c">! This subroutine manages unitary heating system component simulation.</span>
<a name="ln-9573"></a>
<a name="ln-9574"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9575"></a>          <span class="c">! na</span>
<a name="ln-9576"></a>
<a name="ln-9577"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-9578"></a>          <span class="c">! na</span>
<a name="ln-9579"></a>
<a name="ln-9580"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9581"></a>  <span class="k">USE </span><span class="n">DXCoils</span><span class="p">,</span>                   <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimDXCoil</span><span class="p">,</span> <span class="n">SimDXCoilMultiSpeed</span>
<a name="ln-9582"></a>  <span class="k">USE </span><span class="n">HeatingCoils</span><span class="p">,</span>              <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateHeatingCoilComponents</span>
<a name="ln-9583"></a>  <span class="k">USE </span><span class="n">WaterCoils</span><span class="p">,</span>                <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateWaterCoilComponents</span>
<a name="ln-9584"></a>  <span class="k">USE </span><span class="n">SteamCoils</span><span class="p">,</span>                <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateSteamCoilComponents</span>
<a name="ln-9585"></a>  <span class="k">USE </span><span class="n">VariableSpeedCoils</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimVariableSpeedCoils</span>
<a name="ln-9586"></a>  <span class="k">USE </span><span class="n">WatertoAirHeatPumpSimple</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimWatertoAirHPSimple</span>
<a name="ln-9587"></a>  <span class="k">USE </span><span class="n">WatertoAirHeatPump</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimWaterToAirHP</span>
<a name="ln-9588"></a>
<a name="ln-9589"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9590"></a>
<a name="ln-9591"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-9592"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">UnitarySysNum</span>    <span class="c">! Index of AirloopHVAC:UnitarySystem object</span>
<a name="ln-9593"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">FirstHVACIteration</span>  <span class="c">! True when first HVAC iteration</span>
<a name="ln-9594"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">PartLoadRatio</span>       <span class="c">! coil operating part-load ratio</span>
<a name="ln-9595"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">CompOn</span>              <span class="c">! comrpressor control (0=off, 1=on)</span>
<a name="ln-9596"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>   <span class="c">! ratio of on to off flow rate</span>
<a name="ln-9597"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">OPTIONAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatCoilLoad</span>     <span class="c">! adjusted heating coil load if outlet temp exceeds max (W)</span>
<a name="ln-9598"></a>
<a name="ln-9599"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-9600"></a>
<a name="ln-9601"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-9602"></a>          <span class="c">! na</span>
<a name="ln-9603"></a>
<a name="ln-9604"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-9605"></a>          <span class="c">! na</span>
<a name="ln-9606"></a>
<a name="ln-9607"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9608"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CompName</span>            <span class="c">! Name of Unitary System object</span>
<a name="ln-9609"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">OutsideDryBulbTemp</span>  <span class="c">! outdoor temperature (C)</span>
<a name="ln-9610"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">mdot</span>                <span class="c">! water side flow rate (kg/s)</span>
<a name="ln-9611"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">QActual</span>             <span class="c">! actual output of coil (W)</span>
<a name="ln-9612"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">dummy</span>               <span class="c">! used when sub argument is not needed</span>
<a name="ln-9613"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">OutdoorPressure</span>     <span class="c">! Outdoor barometric pressure at condenser (Pa)</span>
<a name="ln-9614"></a>  <span class="kt">LOGICAL</span>                       <span class="kd">::</span> <span class="n">errflag</span>             <span class="c">! returned flag from called routine</span>
<a name="ln-9615"></a>
<a name="ln-9616"></a>  <span class="n">CompName</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilName</span>
<a name="ln-9617"></a>  <span class="n">dummy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9618"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CondenserNodeNum</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9619"></a><span class="k">    </span><span class="n">OutdoorPressure</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CondenserNodeNum</span><span class="p">)%</span><span class="n">Press</span>
<a name="ln-9620"></a>    <span class="c">! IF node is not connected to anything, pressure = default, use weather data</span>
<a name="ln-9621"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">OutdoorPressure</span> <span class="o">==</span> <span class="n">DefaultNodeValues</span><span class="p">%</span><span class="n">Press</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9622"></a><span class="k">      </span><span class="n">OutsideDryBulbTemp</span>  <span class="o">=</span> <span class="n">OutDryBulbTemp</span>
<a name="ln-9623"></a><span class="c">!      OutdoorHumRat   = OutHumRat</span>
<a name="ln-9624"></a><span class="c">!      OutdoorPressure = OutBaroPress</span>
<a name="ln-9625"></a><span class="c">!      OutdoorWetBulb  = OutWetBulbTemp</span>
<a name="ln-9626"></a>    <span class="k">ELSE</span>
<a name="ln-9627"></a><span class="k">      </span><span class="n">OutsideDryBulbTemp</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CondenserNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-9628"></a><span class="c">!      OutdoorHumRat   = Node(UnitarySystem(UnitarySysNum)%CondenserNodeNum)%HumRat</span>
<a name="ln-9629"></a><span class="c">!      OutdoorWetBulb  = PsyTwbFnTdbWPb(OutdoorDryBulb,OutdoorHumRat,OutdoorPressure,RoutineName)</span>
<a name="ln-9630"></a>    <span class="k">END IF</span>
<a name="ln-9631"></a><span class="k">  ELSE</span>
<a name="ln-9632"></a><span class="k">    </span><span class="n">OutsideDryBulbTemp</span>  <span class="o">=</span> <span class="n">OutDryBulbTemp</span>
<a name="ln-9633"></a><span class="c">!    OutdoorHumRat   = OutHumRat</span>
<a name="ln-9634"></a><span class="c">!    OutdoorPressure = OutBaroPress</span>
<a name="ln-9635"></a><span class="c">!    OutdoorWetBulb  = OutWetBulbTemp</span>
<a name="ln-9636"></a>  <span class="k">END IF</span>
<a name="ln-9637"></a>
<a name="ln-9638"></a><span class="k">  SELECT CASE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span><span class="p">)</span>
<a name="ln-9639"></a>
<a name="ln-9640"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_HeatingEmpirical</span><span class="p">)</span> <span class="c">! COIL:HEATING:DX:SINGLESPEED</span>
<a name="ln-9641"></a>
<a name="ln-9642"></a>        <span class="k">CALL </span><span class="n">SimDXCoil</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">CompOn</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9643"></a>                       <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9644"></a>                       <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">)</span>
<a name="ln-9645"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCompPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadRatio</span><span class="o">*</span><span class="kt">REAL</span><span class="p">(</span><span class="n">CompOn</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-9646"></a>
<a name="ln-9647"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_HeatingGas</span><span class="p">,</span><span class="n">Coil_HeatingElectric</span> <span class="p">)</span>
<a name="ln-9648"></a>      <span class="k">IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">HeatCoilLoad</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-9649"></a><span class="k">          CALL </span><span class="n">SimulateHeatingCoilComponents</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9650"></a>                                <span class="n">CompIndex</span><span class="o">=</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9651"></a>                                <span class="n">SuppHeat</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span> <span class="p">&amp;</span>
<a name="ln-9652"></a>                                <span class="n">QCoilReq</span><span class="o">=</span><span class="n">HeatCoilLoad</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9653"></a>                                <span class="n">FanOpMode</span><span class="o">=</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9654"></a>                                <span class="n">PartLoadRatio</span><span class="o">=</span><span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-9655"></a>      <span class="k">ELSE</span>
<a name="ln-9656"></a><span class="k">          CALL </span><span class="n">SimulateHeatingCoilComponents</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9657"></a>                                <span class="n">CompIndex</span><span class="o">=</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9658"></a>                                <span class="n">SuppHeat</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span> <span class="p">&amp;</span>
<a name="ln-9659"></a>                                <span class="n">QCoilReq</span><span class="o">=</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span><span class="o">*</span><span class="n">PartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9660"></a>                                <span class="n">FanOpMode</span><span class="o">=</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9661"></a>                                <span class="n">PartLoadRatio</span><span class="o">=</span><span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-9662"></a>      <span class="k">END IF</span>
<a name="ln-9663"></a><span class="k">    CASE</span> <span class="p">(</span><span class="n">Coil_HeatingDesuperheater</span> <span class="p">)</span>
<a name="ln-9664"></a>      <span class="k">IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">HeatCoilLoad</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-9665"></a><span class="k">          CALL </span><span class="n">SimulateHeatingCoilComponents</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9666"></a>                                <span class="n">CompIndex</span><span class="o">=</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9667"></a>                                <span class="n">SuppHeat</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span> <span class="p">&amp;</span>
<a name="ln-9668"></a>                                <span class="n">QCoilReq</span><span class="o">=</span><span class="n">HeatCoilLoad</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9669"></a>                                <span class="n">FanOpMode</span><span class="o">=</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9670"></a>                                <span class="n">PartLoadRatio</span><span class="o">=</span><span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-9671"></a>      <span class="k">ELSE</span>
<a name="ln-9672"></a><span class="k">          CALL </span><span class="n">SimulateHeatingCoilComponents</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9673"></a>                                <span class="n">CompIndex</span><span class="o">=</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9674"></a>                                <span class="n">SuppHeat</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span> <span class="p">&amp;</span>
<a name="ln-9675"></a>                                <span class="n">QCoilReq</span><span class="o">=</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span><span class="o">*</span><span class="n">PartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9676"></a>                                <span class="n">FanOpMode</span><span class="o">=</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9677"></a>                                <span class="n">PartLoadRatio</span><span class="o">=</span><span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-9678"></a>      <span class="k">END IF</span>
<a name="ln-9679"></a>
<a name="ln-9680"></a><span class="k">    CASE</span><span class="p">(</span><span class="n">CoilDX_MultiSpeedHeating</span><span class="p">)</span>
<a name="ln-9681"></a>
<a name="ln-9682"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">OutsideDryBulbTemp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MinOATCompressor</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9683"></a><span class="k">          CALL </span><span class="n">SimDXCoilMultiSpeed</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9684"></a>                                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCycRatio</span><span class="p">,&amp;</span>
<a name="ln-9685"></a>                                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9686"></a>                                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9687"></a>                                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">CompOn</span><span class="p">)</span>
<a name="ln-9688"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCompPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadRatio</span><span class="o">*</span><span class="kt">REAL</span><span class="p">(</span><span class="n">CompOn</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-9689"></a>        <span class="k">ELSE</span>
<a name="ln-9690"></a><span class="k">          CALL </span><span class="n">SimDXCoilMultiSpeed</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,&amp;</span>
<a name="ln-9691"></a>                                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9692"></a>                                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9693"></a>                                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">CompOn</span><span class="p">)</span>
<a name="ln-9694"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCompPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9695"></a>        <span class="k">END IF</span>
<a name="ln-9696"></a>
<a name="ln-9697"></a><span class="k">    CASE</span><span class="p">(</span><span class="n">Coil_HeatingElectric_MultiStage</span><span class="p">,</span> <span class="n">Coil_HeatingGas_MultiStage</span><span class="p">)</span>
<a name="ln-9698"></a>        <span class="k">CALL </span><span class="n">SimulateHeatingCoilComponents</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9699"></a>                                           <span class="n">CompIndex</span>     <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9700"></a>                                           <span class="n">FanOpMode</span>     <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span>      <span class="p">&amp;</span>
<a name="ln-9701"></a>                                           <span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCycRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9702"></a>                                           <span class="n">StageNum</span>      <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedNum</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-9703"></a>                                           <span class="n">SpeedRatio</span>    <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span><span class="p">)</span>
<a name="ln-9704"></a>
<a name="ln-9705"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_HeatingWater</span><span class="p">)</span>
<a name="ln-9706"></a>          <span class="n">mdot</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilFluidOutletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9707"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="o">*</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-9708"></a>          <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilFluidInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">mdot</span>
<a name="ln-9709"></a>          <span class="k">CALL </span><span class="n">SimulateWaterCoilComponents</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9710"></a>                                           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9711"></a>                                           <span class="n">QActual</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9712"></a>                                           <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-9713"></a>
<a name="ln-9714"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_HeatingSteam</span><span class="p">)</span>
<a name="ln-9715"></a><span class="c">! this same CALL is made in the steam coil calc routine</span>
<a name="ln-9716"></a>          <span class="n">mdot</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilFluidOutletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9717"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="o">*</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-9718"></a>          <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilFluidInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">mdot</span>
<a name="ln-9719"></a>          <span class="k">CALL </span><span class="n">SimulateSteamCoilComponents</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9720"></a>                                           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span><span class="o">*</span><span class="n">PartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9721"></a>                                           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9722"></a>                                           <span class="n">FanOpMode</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9723"></a>                                           <span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-9724"></a>
<a name="ln-9725"></a>    <span class="k">CASE</span><span class="p">(</span><span class="n">Coil_HeatingAirToAirVariableSpeed</span><span class="p">,</span> <span class="n">Coil_HeatingWaterToAirHPVSEquationFit</span><span class="p">)</span>
<a name="ln-9726"></a>
<a name="ln-9727"></a>        <span class="k">CALL </span><span class="n">SimVariableSpeedCoils</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9728"></a>             <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9729"></a>             <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9730"></a>             <span class="n">CompOn</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9731"></a>             <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedNum</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9732"></a>             <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilSensDemand</span><span class="p">,</span> <span class="n">dummy</span><span class="p">)</span>
<a name="ln-9733"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9734"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCompPartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-9735"></a>        <span class="k">ELSE</span>
<a name="ln-9736"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCompPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadRatio</span><span class="o">*</span><span class="kt">REAL</span><span class="p">(</span><span class="n">CompOn</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-9737"></a>        <span class="k">END IF</span>
<a name="ln-9738"></a><span class="k">    CASE</span><span class="p">(</span><span class="n">Coil_HeatingWaterToAirHPSimple</span><span class="p">)</span>
<a name="ln-9739"></a>
<a name="ln-9740"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">PartLoadRatio</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">WSHPRuntimeFrac</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9741"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span> <span class="o">==</span> <span class="n">CycFanCycCoil</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9742"></a><span class="k">          </span><span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="n">PartLoadRatio</span><span class="o">/</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">WSHPRuntimeFrac</span>
<a name="ln-9743"></a>        <span class="k">END IF</span>
<a name="ln-9744"></a>
<a name="ln-9745"></a><span class="k">        CALL </span><span class="n">SimWatertoAirHPSimple</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9746"></a>                                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilSensDemand</span><span class="p">,</span> <span class="n">dummy</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9747"></a>                                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">WSHPRuntimeFrac</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9748"></a>                                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9749"></a>                                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9750"></a>                                   <span class="n">CompOn</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-9751"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCompPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadRatio</span><span class="o">*</span><span class="kt">REAL</span><span class="p">(</span><span class="n">CompOn</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-9752"></a>
<a name="ln-9753"></a>    <span class="k">CASE</span><span class="p">(</span><span class="n">Coil_HeatingWaterToAirHP</span><span class="p">)</span>
<a name="ln-9754"></a>
<a name="ln-9755"></a>        <span class="k">CALL </span><span class="n">HeatPumpRunFrac</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="n">errflag</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">WSHPRuntimeFrac</span><span class="p">)</span>
<a name="ln-9756"></a>
<a name="ln-9757"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">PartLoadRatio</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">WSHPRuntimeFrac</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9758"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span> <span class="o">==</span> <span class="n">CycFanCycCoil</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9759"></a><span class="k">          </span><span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="n">PartLoadRatio</span><span class="o">/</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">WSHPRuntimeFrac</span>
<a name="ln-9760"></a>        <span class="k">END IF</span>
<a name="ln-9761"></a>
<a name="ln-9762"></a><span class="k">        CALL </span><span class="n">SimWatertoAirHP</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9763"></a>              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirMassFlow</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,&amp;</span>
<a name="ln-9764"></a>              <span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">WSHPRuntimeFrac</span><span class="p">,&amp;</span>
<a name="ln-9765"></a>              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9766"></a>              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9767"></a>              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9768"></a>              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">InitHeatPump</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9769"></a>              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilSensDemand</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9770"></a>              <span class="n">dummy</span><span class="p">,</span><span class="n">CompOn</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-9771"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCompPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadRatio</span><span class="o">*</span><span class="kt">REAL</span><span class="p">(</span><span class="n">CompOn</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-9772"></a>
<a name="ln-9773"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-9774"></a>          <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;CalcUnitaryHeatingSystem: Invalid Unitary System coil type = &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9775"></a>                              <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAllCoilTypes</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span><span class="p">)))</span>
<a name="ln-9776"></a>
<a name="ln-9777"></a>  <span class="k">END SELECT</span>
<a name="ln-9778"></a>
<a name="ln-9779"></a><span class="k">  </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingPartLoadFrac</span> <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-9780"></a>
<a name="ln-9781"></a>  <span class="k">RETURN</span>
<a name="ln-9782"></a>
<a name="ln-9783"></a><span class="k">END SUBROUTINE </span><span class="n">CalcUnitaryHeatingSystem</span>
<a name="ln-9784"></a>
<a name="ln-9785"></a><span class="k">SUBROUTINE </span><span class="n">CalcUnitarySuppHeatingSystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">SuppCoilLoad</span><span class="p">)</span>
<a name="ln-9786"></a>
<a name="ln-9787"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-9788"></a>          <span class="c">!       AUTHOR         Richard Raustad, FSEC</span>
<a name="ln-9789"></a>          <span class="c">!       DATE WRITTEN   February 2013</span>
<a name="ln-9790"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9791"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9792"></a>
<a name="ln-9793"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-9794"></a>          <span class="c">! This subroutine manages supplemental heater simulation.</span>
<a name="ln-9795"></a>
<a name="ln-9796"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9797"></a>          <span class="c">! na</span>
<a name="ln-9798"></a>
<a name="ln-9799"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-9800"></a>          <span class="c">! na</span>
<a name="ln-9801"></a>
<a name="ln-9802"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9803"></a>  <span class="k">USE </span><span class="n">HeatingCoils</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateHeatingCoilComponents</span>
<a name="ln-9804"></a>  <span class="k">USE </span><span class="n">WaterCoils</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateWaterCoilComponents</span>
<a name="ln-9805"></a>  <span class="k">USE </span><span class="n">SteamCoils</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateSteamCoilComponents</span>
<a name="ln-9806"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>          <span class="n">ONLY</span><span class="p">:</span> <span class="n">SolveRegulaFalsi</span>
<a name="ln-9807"></a>
<a name="ln-9808"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9809"></a>
<a name="ln-9810"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-9811"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">UnitarySysNum</span>    <span class="c">! Index of AirloopHVAC:UnitarySystem object</span>
<a name="ln-9812"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">FirstHVACIteration</span>  <span class="c">! True when first HVAC iteration</span>
<a name="ln-9813"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">PartLoadRatio</span>       <span class="c">! coil operating part-load ratio</span>
<a name="ln-9814"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">OPTIONAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SuppCoilLoad</span>     <span class="c">! adjusted supp coil load when outlet temp exceeds max (W)</span>
<a name="ln-9815"></a>
<a name="ln-9816"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-9817"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span>   <span class="kd">::</span> <span class="n">MaxIte</span>    <span class="o">=</span> <span class="mi">500</span>     <span class="c">! Maximum number of iterations for solver</span>
<a name="ln-9818"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Acc</span>       <span class="o">=</span> <span class="mf">1.d-3</span>   <span class="c">! Accuracy of solver result</span>
<a name="ln-9819"></a>
<a name="ln-9820"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-9821"></a>          <span class="c">! na</span>
<a name="ln-9822"></a>
<a name="ln-9823"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-9824"></a>          <span class="c">! na</span>
<a name="ln-9825"></a>
<a name="ln-9826"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9827"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CompName</span>              <span class="c">! Name of Unitary System object</span>
<a name="ln-9828"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">SuppHeatCoilLoad</span>      <span class="c">! load passed to supplemental heating coil (W)</span>
<a name="ln-9829"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">QActual</span>               <span class="c">! actual coil output (W)</span>
<a name="ln-9830"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">mdot</span>                  <span class="c">! water coil water mass flow rate (kg/s)</span>
<a name="ln-9831"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">Par</span>                   <span class="c">! Parameter array passed to solver</span>
<a name="ln-9832"></a>  <span class="kt">INTEGER</span>                       <span class="kd">::</span> <span class="n">SolFla</span>                <span class="c">! Flag of solver, num iterations if &gt;0, else error index</span>
<a name="ln-9833"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">PartLoadFrac</span>          <span class="c">! temporary PLR variable</span>
<a name="ln-9834"></a>
<a name="ln-9835"></a>
<a name="ln-9836"></a><span class="c">! work is needed to figure out how to adjust other coil types if outlet temp exceeds maximum</span>
<a name="ln-9837"></a><span class="c">! this works for gas and electric heating coils</span>
<a name="ln-9838"></a>  <span class="n">CompName</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span>
<a name="ln-9839"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">OutDryBulbTemp</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxOATSuppHeat</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9840"></a>     <span class="p">(</span><span class="n">MoistureLoad</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingPartLoadFrac</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-9841"></a><span class="k">    IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">SuppCoilLoad</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-9842"></a><span class="k">      </span><span class="n">SuppHeatCoilLoad</span> <span class="o">=</span> <span class="n">SuppCoilLoad</span>
<a name="ln-9843"></a>    <span class="k">ELSE</span>
<a name="ln-9844"></a><span class="k">      </span><span class="n">SuppHeatCoilLoad</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span><span class="o">*</span><span class="n">PartLoadRatio</span>
<a name="ln-9845"></a>    <span class="k">END IF</span>
<a name="ln-9846"></a><span class="k">  ELSE</span>
<a name="ln-9847"></a><span class="k">    </span><span class="n">SuppHeatCoilLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9848"></a>  <span class="k">END IF</span>
<a name="ln-9849"></a>
<a name="ln-9850"></a><span class="k">  SELECT CASE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType_Num</span><span class="p">)</span>
<a name="ln-9851"></a>
<a name="ln-9852"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_HeatingGas</span><span class="p">,</span><span class="n">Coil_HeatingElectric</span><span class="p">)</span>
<a name="ln-9853"></a>      <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlType</span><span class="p">)</span>
<a name="ln-9854"></a>        <span class="k">CASE</span><span class="p">(</span><span class="n">SetPointBased</span><span class="p">)</span>
<a name="ln-9855"></a>          <span class="k">CALL </span><span class="n">SimulateHeatingCoilComponents</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9856"></a>                                <span class="n">CompIndex</span><span class="o">=</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9857"></a>                                <span class="n">SuppHeat</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span> <span class="p">&amp;</span>
<a name="ln-9858"></a>                                <span class="n">FanOpMode</span><span class="o">=</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9859"></a>                                <span class="n">PartLoadRatio</span><span class="o">=</span><span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-9860"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-9861"></a>          <span class="k">CALL </span><span class="n">SimulateHeatingCoilComponents</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9862"></a>                                <span class="n">CompIndex</span><span class="o">=</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9863"></a>                                <span class="n">SuppHeat</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span> <span class="p">&amp;</span>
<a name="ln-9864"></a>                                <span class="n">QCoilReq</span><span class="o">=</span><span class="n">SuppHeatCoilLoad</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9865"></a>                                <span class="n">FanOpMode</span><span class="o">=</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9866"></a>                                <span class="n">PartLoadRatio</span><span class="o">=</span><span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-9867"></a>      <span class="k">END SELECT</span>
<a name="ln-9868"></a><span class="k">    CASE</span> <span class="p">(</span><span class="n">Coil_HeatingDesuperheater</span><span class="p">)</span>
<a name="ln-9869"></a>        <span class="k">CALL </span><span class="n">SimulateHeatingCoilComponents</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9870"></a>                                <span class="n">CompIndex</span><span class="o">=</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9871"></a>                                <span class="n">SuppHeat</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span> <span class="p">&amp;</span>
<a name="ln-9872"></a>                                <span class="n">QCoilReq</span><span class="o">=</span><span class="n">SuppHeatCoilLoad</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9873"></a>                                <span class="n">FanOpMode</span><span class="o">=</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9874"></a>                                <span class="n">PartLoadRatio</span><span class="o">=</span><span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-9875"></a>
<a name="ln-9876"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_HeatingWater</span><span class="p">)</span>
<a name="ln-9877"></a>      <span class="k">IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">SuppCoilLoad</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-9878"></a><span class="k">        IF</span><span class="p">(</span><span class="n">SuppHeatCoilLoad</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9879"></a>          <span class="c">! see if HW coil has enough capacity to meet the load</span>
<a name="ln-9880"></a>          <span class="n">mdot</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilFluidOutletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9881"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span><span class="p">)</span>
<a name="ln-9882"></a>          <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilFluidInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">mdot</span>
<a name="ln-9883"></a>          <span class="c">!     simulate water coil to find operating capacity</span>
<a name="ln-9884"></a>          <span class="k">CALL </span><span class="n">SimulateWaterCoilComponents</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9885"></a>                                           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span> <span class="n">QActual</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9886"></a>                                           <span class="n">FanOpMode</span><span class="o">=</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9887"></a>                                           <span class="n">PartLoadRatio</span><span class="o">=</span><span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-9888"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">QActual</span> <span class="o">&gt;</span> <span class="n">SuppHeatCoilLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9889"></a><span class="k">            </span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-9890"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9891"></a><span class="k">              </span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-9892"></a>            <span class="k">ELSE</span>
<a name="ln-9893"></a><span class="k">              </span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9894"></a>            <span class="k">END IF</span>
<a name="ln-9895"></a><span class="k">            </span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">SuppHeatCoilLoad</span>
<a name="ln-9896"></a>            <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! SuppHeatingCoilFlag</span>
<a name="ln-9897"></a>            <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! Load based control</span>
<a name="ln-9898"></a>            <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">HotWaterHeatingCoilResidual</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-9899"></a>                                        <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-9900"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatPartLoadFrac</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-9901"></a>          <span class="k">ELSE</span>
<a name="ln-9902"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatPartLoadFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-9903"></a>          <span class="k">END IF</span>
<a name="ln-9904"></a><span class="k">        END IF</span>
<a name="ln-9905"></a><span class="k">      ELSE</span>
<a name="ln-9906"></a><span class="k">        </span><span class="n">mdot</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilFluidOutletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9907"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">*</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-9908"></a>        <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilFluidInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">mdot</span>
<a name="ln-9909"></a>
<a name="ln-9910"></a>        <span class="k">CALL </span><span class="n">SimulateWaterCoilComponents</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9911"></a>                                           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9912"></a>                                           <span class="n">QActual</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9913"></a>                                           <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-9914"></a>      <span class="k">END IF</span>
<a name="ln-9915"></a><span class="k">    CASE</span> <span class="p">(</span><span class="n">Coil_HeatingSteam</span><span class="p">)</span>
<a name="ln-9916"></a>        <span class="n">mdot</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilFluidOutletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9917"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">*</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-9918"></a>        <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilFluidInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">mdot</span>
<a name="ln-9919"></a>        <span class="k">CALL </span><span class="n">SimulateSteamCoilComponents</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9920"></a>                                           <span class="n">SuppHeatCoilLoad</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9921"></a>                                           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9922"></a>                                           <span class="n">FanOpMode</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9923"></a>                                           <span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-9924"></a>
<a name="ln-9925"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-9926"></a>
<a name="ln-9927"></a>  <span class="k">END SELECT</span>
<a name="ln-9928"></a>
<a name="ln-9929"></a><span class="c">!  UnitarySystem(UnitarySysNum)%SuppHeatPartLoadFrac = PartLoadRatio</span>
<a name="ln-9930"></a>
<a name="ln-9931"></a>  <span class="k">RETURN</span>
<a name="ln-9932"></a>
<a name="ln-9933"></a><span class="k">END SUBROUTINE </span><span class="n">CalcUnitarySuppHeatingSystem</span>
<a name="ln-9934"></a>
<a name="ln-9935"></a><span class="k">SUBROUTINE </span><span class="n">CalcUnitarySuppSystemtoSP</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-9936"></a>
<a name="ln-9937"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-9938"></a>          <span class="c">!       AUTHOR         Richard Raustad, FSEC</span>
<a name="ln-9939"></a>          <span class="c">!       DATE WRITTEN   February 2013</span>
<a name="ln-9940"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9941"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9942"></a>
<a name="ln-9943"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-9944"></a>          <span class="c">! This subroutine manages supplemental heater component simulation for setpoint based operation scheme.</span>
<a name="ln-9945"></a>
<a name="ln-9946"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9947"></a>          <span class="c">! na</span>
<a name="ln-9948"></a>
<a name="ln-9949"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-9950"></a>          <span class="c">! na</span>
<a name="ln-9951"></a>
<a name="ln-9952"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9953"></a>  <span class="k">USE </span><span class="n">HeatingCoils</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateHeatingCoilComponents</span>
<a name="ln-9954"></a>  <span class="k">USE </span><span class="n">WaterCoils</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateWaterCoilComponents</span>
<a name="ln-9955"></a>  <span class="k">USE </span><span class="n">SteamCoils</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateSteamCoilComponents</span>
<a name="ln-9956"></a>
<a name="ln-9957"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9958"></a>
<a name="ln-9959"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-9960"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">UnitarySysNum</span>    <span class="c">! Index of AirloopHVAC:UnitarySystem object</span>
<a name="ln-9961"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">FirstHVACIteration</span>  <span class="c">! True when first HVAC iteration</span>
<a name="ln-9962"></a>
<a name="ln-9963"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-9964"></a>          <span class="c">! na</span>
<a name="ln-9965"></a>
<a name="ln-9966"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-9967"></a>          <span class="c">! na</span>
<a name="ln-9968"></a>
<a name="ln-9969"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-9970"></a>          <span class="c">! na</span>
<a name="ln-9971"></a>
<a name="ln-9972"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9973"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CompName</span>              <span class="c">! Name of Unitary System object</span>
<a name="ln-9974"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">QActual</span>
<a name="ln-9975"></a>
<a name="ln-9976"></a>  <span class="n">CompName</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span>
<a name="ln-9977"></a>
<a name="ln-9978"></a>  <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType_Num</span><span class="p">)</span>
<a name="ln-9979"></a>
<a name="ln-9980"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_HeatingGas</span><span class="p">,</span><span class="n">Coil_HeatingElectric</span><span class="p">)</span>
<a name="ln-9981"></a>      <span class="k">CALL </span><span class="n">SimulateHeatingCoilComponents</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9982"></a>                                <span class="n">CompIndex</span><span class="o">=</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9983"></a><span class="c">!                                QCoilReq=(UnitarySystem(UnitarySysNum)%DesignSuppHeatingCapacity* &amp;</span>
<a name="ln-9984"></a><span class="c">!                                          UnitarySystem(UnitarySysNum)%SuppHeatPartLoadFrac), &amp;</span>
<a name="ln-9985"></a>                                <span class="n">FanOpMode</span><span class="o">=</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9986"></a>                                <span class="n">PartLoadRatio</span><span class="o">=</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatPartLoadFrac</span><span class="p">)</span>
<a name="ln-9987"></a>
<a name="ln-9988"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_HeatingDesuperheater</span> <span class="p">)</span>
<a name="ln-9989"></a>      <span class="k">CALL </span><span class="n">SimulateHeatingCoilComponents</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9990"></a>                                <span class="n">CompIndex</span><span class="o">=</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9991"></a>                                <span class="n">FanOpMode</span><span class="o">=</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9992"></a>                                <span class="n">PartLoadRatio</span><span class="o">=</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatPartLoadFrac</span><span class="p">)</span>
<a name="ln-9993"></a>
<a name="ln-9994"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_HeatingWater</span><span class="p">)</span>
<a name="ln-9995"></a>      <span class="k">CALL </span><span class="n">SimulateWaterCoilComponents</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9996"></a>                                       <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9997"></a>                                       <span class="n">QActual</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9998"></a>                                       <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatPartLoadFrac</span><span class="p">)</span>
<a name="ln-9999"></a>
<a name="ln-10000"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_HeatingSteam</span><span class="p">)</span>
<a name="ln-10001"></a>      <span class="k">CALL </span><span class="n">SimulateSteamCoilComponents</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10002"></a>                                       <span class="n">QCoilReq</span><span class="o">=</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-10003"></a>                                       <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatPartLoadFrac</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-10004"></a>                                       <span class="n">CompIndex</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10005"></a>                                       <span class="n">FanOpMode</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10006"></a>                                       <span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatPartLoadFrac</span><span class="p">)</span>
<a name="ln-10007"></a>
<a name="ln-10008"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-10009"></a>
<a name="ln-10010"></a>  <span class="k">END SELECT</span>
<a name="ln-10011"></a>
<a name="ln-10012"></a><span class="k">  RETURN</span>
<a name="ln-10013"></a>
<a name="ln-10014"></a><span class="k">END SUBROUTINE </span><span class="n">CalcUnitarySuppSystemtoSP</span>
<a name="ln-10015"></a>
<a name="ln-10016"></a><span class="k">SUBROUTINE </span><span class="n">ControlCoolingSystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">HXUnitOn</span><span class="p">)</span>
<a name="ln-10017"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-10018"></a>          <span class="c">!       AUTHOR         Richard Raustad, FSEC</span>
<a name="ln-10019"></a>          <span class="c">!       DATE WRITTEN   February 2013</span>
<a name="ln-10020"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-10021"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10022"></a>
<a name="ln-10023"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-10024"></a>          <span class="c">!  Simulate the coil object at the required PLR.</span>
<a name="ln-10025"></a>
<a name="ln-10026"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-10027"></a>          <span class="c">!  Calculate operating PLR and adjust speed when using multispeed coils.</span>
<a name="ln-10028"></a>          <span class="c">!  Meet moisture load if required to do so.</span>
<a name="ln-10029"></a>
<a name="ln-10030"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-10031"></a>          <span class="c">!  na</span>
<a name="ln-10032"></a>
<a name="ln-10033"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-10034"></a>  <span class="k">USE </span><span class="n">DataAirLoop</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">LoopDXCoilRTF</span>
<a name="ln-10035"></a>  <span class="k">USE </span><span class="n">Psychrometrics</span> <span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">PsyHFnTdbW</span><span class="p">,</span> <span class="n">PsyTdpFnWPb</span>
<a name="ln-10036"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">SolveRegulaFalsi</span><span class="p">,</span> <span class="n">RoundSigDigits</span>
<a name="ln-10037"></a>  <span class="k">USE </span><span class="n">DXCoils</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimDXCoil</span><span class="p">,</span> <span class="n">SimDXCoilMultiSpeed</span><span class="p">,</span> <span class="n">DXCoilOutletTemp</span><span class="p">,</span> <span class="n">SimDXCoilMultiMode</span><span class="p">,</span> <span class="n">DXCoilOutletHumRat</span>
<a name="ln-10038"></a>  <span class="k">USE </span><span class="n">HVACHXAssistedCoolingCoil</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimHXAssistedCoolingCoil</span><span class="p">,</span> <span class="n">HXAssistedCoilOutletTemp</span><span class="p">,</span> <span class="n">HXAssistedCoilOutletHumRat</span>
<a name="ln-10039"></a>  <span class="k">USE </span><span class="n">WaterCoils</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateWaterCoilComponents</span>
<a name="ln-10040"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">SetComponentFlowRate</span>
<a name="ln-10041"></a>  <span class="k">USE </span><span class="n">WatertoAirHeatPumpSimple</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimWatertoAirHPSimple</span>
<a name="ln-10042"></a>  <span class="k">USE </span><span class="n">WatertoAirHeatPump</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimWaterToAirHP</span>
<a name="ln-10043"></a>  <span class="k">USE </span><span class="n">VariableSpeedCoils</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimVariableSpeedCoils</span><span class="p">,</span> <span class="n">VarSpeedCoil</span>
<a name="ln-10044"></a>
<a name="ln-10045"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-10046"></a>
<a name="ln-10047"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-10048"></a>  <span class="kt">INTEGER</span><span class="p">,</span>  <span class="k">Intent</span><span class="p">(</span><span class="n">In</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">UnitarySysNum</span>           <span class="c">! index to Unitary System</span>
<a name="ln-10049"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>  <span class="k">Intent</span><span class="p">(</span><span class="n">In</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FirstHVACIteration</span>      <span class="c">! First HVAC iteration flag</span>
<a name="ln-10050"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>  <span class="k">Intent</span><span class="p">(</span><span class="n">InOut</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HXUnitOn</span>                <span class="c">! flag to enable heat exchanger heat recovery</span>
<a name="ln-10051"></a>
<a name="ln-10052"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-10053"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span>   <span class="kd">::</span> <span class="n">MaxIte</span>    <span class="o">=</span> <span class="mi">500</span>     <span class="c">! Maximum number of iterations for solver</span>
<a name="ln-10054"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Acc</span>       <span class="o">=</span> <span class="mf">1.d-3</span>   <span class="c">! Accuracy of solver result</span>
<a name="ln-10055"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HumRatAcc</span> <span class="o">=</span> <span class="mf">1.d-6</span>   <span class="c">! Accuracy of solver result</span>
<a name="ln-10056"></a>
<a name="ln-10057"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-10058"></a>          <span class="c">!  na</span>
<a name="ln-10059"></a>
<a name="ln-10060"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-10061"></a>          <span class="c">!  na</span>
<a name="ln-10062"></a>
<a name="ln-10063"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10064"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CompName</span>  <span class="c">! Name of the DX cooling coil</span>
<a name="ln-10065"></a><span class="c">!  REAL(r64)           :: NoOutput            ! Sensible capacity (outlet - inlet) when the compressor is off</span>
<a name="ln-10066"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">FullOutput</span>          <span class="c">! Sensible capacity (outlet - inlet) when the compressor is on</span>
<a name="ln-10067"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">ReqOutput</span>           <span class="c">! Sensible capacity (outlet - inlet) required to meet load or setpoint temperature</span>
<a name="ln-10068"></a>  <span class="kt">Integer</span>             <span class="kd">::</span> <span class="n">InletNode</span>           <span class="c">! Inlet node number of the DX cooling coil</span>
<a name="ln-10069"></a>  <span class="kt">Integer</span>             <span class="kd">::</span> <span class="n">OutletNode</span>          <span class="c">! Outlet node number of the DX cooling coil</span>
<a name="ln-10070"></a>  <span class="kt">Integer</span>             <span class="kd">::</span> <span class="n">ControlNode</span>         <span class="c">! The node number where a setpoint is placed to control the DX cooling coil</span>
<a name="ln-10071"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">PartLoadFrac</span>        <span class="c">! The part-load fraction of the compressor</span>
<a name="ln-10072"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">SpeedRatio</span>          <span class="c">! SpeedRatio = (CompressorSpeed - CompressorSpeedMin) /</span>
<a name="ln-10073"></a>                                             <span class="c">!              (CompressorSpeedMax - CompressorSpeedMin)</span>
<a name="ln-10074"></a>                                             <span class="c">! for variable speed or 2 speed compressors</span>
<a name="ln-10075"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">CycRatio</span>            <span class="c">! Cycling part-load ratio for variable speed or 2 speed compressors</span>
<a name="ln-10076"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">DesOutTemp</span>          <span class="c">! Desired outlet temperature of the DX cooling coil</span>
<a name="ln-10077"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">DesOutHumRat</span>        <span class="c">! Desired outlet humidity ratio of the DX cooling coil</span>
<a name="ln-10078"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">OutletTempDXCoil</span>    <span class="c">! Actual outlet temperature of the DX cooling coil</span>
<a name="ln-10079"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">OutletHumRatLS</span>      <span class="c">! Actual outlet humrat of the variable speed DX cooling coil at low speed</span>
<a name="ln-10080"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">OutletHumRatHS</span>      <span class="c">! Actual outlet humrat of the variable speed DX cooling coil at high speed</span>
<a name="ln-10081"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">OutletHumRatDXCoil</span>  <span class="c">! Actual outlet humidity ratio of the DX cooling coil</span>
<a name="ln-10082"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">SolFla</span>              <span class="c">! Flag of solver, num iterations if &gt;0, else error index</span>
<a name="ln-10083"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">SolFlaLat</span>           <span class="c">! Flag of solver for dehumid calculations</span>
<a name="ln-10084"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Par</span>                 <span class="c">! Parameter array passed to solver</span>
<a name="ln-10085"></a>  <span class="kt">LOGICAL</span>             <span class="kd">::</span> <span class="n">SensibleLoad</span>        <span class="c">! True if there is a sensible cooling load on this system</span>
<a name="ln-10086"></a>  <span class="kt">LOGICAL</span>             <span class="kd">::</span> <span class="n">LatentLoad</span>          <span class="c">! True if there is a latent   cooling load on this system</span>
<a name="ln-10087"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">DehumidMode</span>         <span class="c">! dehumidification mode (0=normal, 1=enhanced)</span>
<a name="ln-10088"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">FanOpMode</span>           <span class="c">! Supply air fan operating mode</span>
<a name="ln-10089"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">TempMinPLR</span>          <span class="c">! Used to find latent PLR when max iterations exceeded</span>
<a name="ln-10090"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">TempMaxPLR</span>          <span class="c">! Used to find latent PLR when max iterations exceeded</span>
<a name="ln-10091"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">TempOutletTempDXCoil</span>   <span class="c">! Used to find latent PLR when max iterations exceeded</span>
<a name="ln-10092"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">TempOutletHumRatDXCoil</span> <span class="c">! Used to find latent PLR when max iterations exceeded</span>
<a name="ln-10093"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">NoLoadHumRatOut</span>     <span class="c">! DX coil outlet air humidity ratio with comprssor off</span>
<a name="ln-10094"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">FullLoadHumRatOut</span>   <span class="c">! DX coil outlet air humidity ratio with comprssor full on</span>
<a name="ln-10095"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">WSHPRuntimeFrac</span>            <span class="c">! Run time fraction of water to air hp</span>
<a name="ln-10096"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">dummy</span>               <span class="c">! dummy variable for heating latent demand</span>
<a name="ln-10097"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>
<a name="ln-10098"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">OutletTemp</span>
<a name="ln-10099"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">SpeedNum</span>
<a name="ln-10100"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">LoopDXCoilMaxRTFSave</span> <span class="c">! Used to find RTF of DX heating coils without overwriting globabl variable</span>
<a name="ln-10101"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">NoLoadTempOut</span>       <span class="c">! saves coil off outlet temp</span>
<a name="ln-10102"></a>
<a name="ln-10103"></a>  <span class="c">! Set local variables</span>
<a name="ln-10104"></a>  <span class="c">! Retrieve the load on the controlled zone</span>
<a name="ln-10105"></a>  <span class="n">OutletNode</span>   <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilOutletNodeNum</span>
<a name="ln-10106"></a>  <span class="n">InletNode</span>    <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilInletNodeNum</span>
<a name="ln-10107"></a>  <span class="n">ControlNode</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SystemCoolControlNodeNum</span>
<a name="ln-10108"></a>  <span class="n">DesOutTemp</span>   <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesiredOutletTemp</span>
<a name="ln-10109"></a>  <span class="n">DesOutHumRat</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesiredOutletHumRat</span>
<a name="ln-10110"></a>  <span class="n">LoopDXCoilMaxRTFSave</span><span class="o">=</span><span class="n">LoopDXCoilRTF</span>
<a name="ln-10111"></a>  <span class="n">LoopDXCoilRTF</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-10112"></a>
<a name="ln-10113"></a>  <span class="n">CompName</span>     <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilName</span>
<a name="ln-10114"></a>  <span class="n">FanOpMode</span>    <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span>
<a name="ln-10115"></a>  <span class="n">SpeedRatio</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10116"></a>  <span class="n">CycRatio</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10117"></a>  <span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10118"></a>  <span class="n">DehumidMode</span>  <span class="o">=</span> <span class="mi">0</span>
<a name="ln-10119"></a>  <span class="n">SensibleLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-10120"></a>  <span class="n">LatentLoad</span>   <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-10121"></a>  <span class="n">WSHPRuntimeFrac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10122"></a>  <span class="n">Dummy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10123"></a>  <span class="n">SolFla</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10124"></a>  <span class="n">SolFlaLat</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10125"></a>  <span class="n">NoLoadTempOut</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10126"></a>  <span class="n">NoLoadHumRatOut</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10127"></a>
<a name="ln-10128"></a><span class="c">! Check the dehumidification control type. IF it&#39;s multimode, turn off the HX to find the sensible PLR. Then check to</span>
<a name="ln-10129"></a><span class="c">! see if the humidity load is met without the use of the HX. Always run the HX for the other modes.</span>
<a name="ln-10130"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">DehumidControl_Multimode</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10131"></a><span class="k">    </span><span class="n">HXUnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-10132"></a>  <span class="k">ELSE</span>
<a name="ln-10133"></a><span class="k">    </span><span class="n">HXUnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-10134"></a>  <span class="k">END IF</span>
<a name="ln-10135"></a>
<a name="ln-10136"></a>  <span class="c">! IF DXCoolingSystem is scheduled on and there is flow</span>
<a name="ln-10137"></a>  <span class="k">IF</span><span class="p">((</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SysAvailSchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-10138"></a>      <span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilAvailSchPtr</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-10139"></a>     <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">MinAirMassFlow</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingPartLoadFrac</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10140"></a>
<a name="ln-10141"></a>    <span class="c">! Determine if there is a sensible load on this system (aren&#39;t the first 2 tests redundant?)</span>
<a name="ln-10142"></a>    <span class="k">IF</span><span class="p">((</span><span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">&gt;</span> <span class="n">DesOutTemp</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-10143"></a>       <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">-</span> <span class="n">DesOutTemp</span><span class="p">)</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">TempControlTol</span><span class="p">)</span> <span class="p">)</span> <span class="n">SensibleLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-10144"></a>
<a name="ln-10145"></a>    <span class="c">! Determine if there is a latent load on this system - for future use to serve latent-only loads</span>
<a name="ln-10146"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">HumRat</span> <span class="o">&gt;</span> <span class="n">DesOutHumRat</span><span class="p">)</span> <span class="n">LatentLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-10147"></a>
<a name="ln-10148"></a>    <span class="c">! disable latent dehumidification if there is no sensible load and latent only is not allowed</span>
<a name="ln-10149"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RunOnLatentOnlyWithSensible</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SensibleLoad</span><span class="p">)</span><span class="n">LatentLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-10150"></a>
<a name="ln-10151"></a>    <span class="c">! IF DXCoolingSystem runs with a cooling load then set PartLoadFrac on Cooling System and the Mass Flow</span>
<a name="ln-10152"></a>    <span class="c">! Multimode coil will switch to enhanced dehumidification IF available and needed, but it</span>
<a name="ln-10153"></a>    <span class="c">! still runs to meet the sensible load. Multimode applies to Multimode or HXAssistedCooling coils.</span>
<a name="ln-10154"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">SensibleLoad</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RunOnSensibleLoad</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-10155"></a>        <span class="p">(</span><span class="n">LatentLoad</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RunOnLatentLoad</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10156"></a>      <span class="c">! calculate sensible PLR, don&#39;t care IF latent is true here but need to gaurd for</span>
<a name="ln-10157"></a>      <span class="c">! when LatentLoad=TRUE and SensibleLoad=FALSE</span>
<a name="ln-10158"></a>      <span class="n">ReqOutput</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-10159"></a>                    <span class="p">(</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">DesOutTemp</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">)</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-10160"></a>                     <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">))</span>
<a name="ln-10161"></a>
<a name="ln-10162"></a>      <span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10163"></a>
<a name="ln-10164"></a>      <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span><span class="p">)</span>
<a name="ln-10165"></a>
<a name="ln-10166"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_CoolingSingleSpeed</span><span class="p">)</span>  <span class="c">! COIL:DX:COOLINGBYPASSFACTOREMPIRICAL</span>
<a name="ln-10167"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-10168"></a>
<a name="ln-10169"></a>          <span class="k">CALL </span><span class="n">SimDXCoil</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">On</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">)</span>
<a name="ln-10170"></a>
<a name="ln-10171"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_CoolingHXAssisted</span><span class="p">,</span> <span class="n">CoilWater_CoolingHXAssisted</span><span class="p">)</span>  <span class="c">! CoilSystem:Cooling:DX:HeatExchangerAssisted</span>
<a name="ln-10172"></a>
<a name="ln-10173"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilFluidInletNode</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-10174"></a>               <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilFluidInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10175"></a>
<a name="ln-10176"></a>          <span class="k">CALL </span><span class="n">SimHXAssistedCoolingCoil</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">On</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10177"></a>                                        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10178"></a>                                        <span class="n">HXUnitEnable</span><span class="o">=</span><span class="n">HXUnitOn</span><span class="p">,</span><span class="n">EconomizerFlag</span><span class="o">=</span><span class="n">EconomizerFlag</span><span class="p">)</span>
<a name="ln-10179"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span><span class="o">==</span><span class="n">CoilDX_CoolingHXAssisted</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-10180"></a>               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-10181"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_CoolingTwoSpeed</span><span class="p">)</span>
<a name="ln-10182"></a>
<a name="ln-10183"></a>          <span class="k">CALL </span><span class="n">SimDXCoilMultiSpeed</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">)</span>
<a name="ln-10184"></a>
<a name="ln-10185"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_MultiSpeedCooling</span><span class="p">,</span> <span class="n">Coil_CoolingAirToAirVariableSpeed</span><span class="p">,</span> <span class="n">Coil_CoolingWaterToAirHPVSEquationFit</span><span class="p">)</span>
<a name="ln-10186"></a>
<a name="ln-10187"></a>          <span class="k">CALL </span><span class="n">SimMultiSpeedCoils</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">SensibleLoad</span><span class="p">,</span> <span class="n">LatentLoad</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10188"></a>                                  <span class="n">CoolingCoil</span><span class="p">)</span>
<a name="ln-10189"></a>
<a name="ln-10190"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_CoolingTwoStageWHumControl</span><span class="p">)</span> <span class="c">! Coil:Cooling:DX:TwoStageWithHumidityControlMode</span>
<a name="ln-10191"></a>
<a name="ln-10192"></a>          <span class="k">CALL </span><span class="n">SimDXCoilMultiMode</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">On</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">DehumidMode</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-10193"></a>                                  <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">)</span>
<a name="ln-10194"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-10195"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_CoolingWater</span><span class="p">,</span> <span class="n">Coil_CoolingWaterDetailed</span><span class="p">)</span>  <span class="c">! COIL:COOLING:WATER</span>
<a name="ln-10196"></a>
<a name="ln-10197"></a>          <span class="k">CALL </span><span class="n">SimWaterCoils</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">CoolingCoil</span><span class="p">)</span>
<a name="ln-10198"></a>
<a name="ln-10199"></a>        <span class="k">CASE</span><span class="p">(</span><span class="n">Coil_CoolingWaterToAirHPSimple</span><span class="p">)</span>
<a name="ln-10200"></a>
<a name="ln-10201"></a>          <span class="k">CALL </span><span class="n">SimWatertoAirHPSimple</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="n">ReqOutput</span><span class="p">,</span> <span class="n">Dummy</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10202"></a>                                       <span class="n">FanOpMode</span><span class="p">,</span><span class="n">WSHPRuntimeFrac</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10203"></a>                                       <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10204"></a>                                       <span class="mi">0</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-10205"></a>
<a name="ln-10206"></a>        <span class="k">CASE</span><span class="p">(</span><span class="n">Coil_CoolingWaterToAirHP</span><span class="p">)</span>
<a name="ln-10207"></a>
<a name="ln-10208"></a>          <span class="k">CALL </span><span class="n">SimWatertoAirHP</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10209"></a>                                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirMassFlow</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10210"></a>                                 <span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">WSHPRuntimeFrac</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10211"></a>                                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10212"></a>                                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">InitHeatPump</span><span class="p">,</span> <span class="n">ReqOutput</span><span class="p">,</span><span class="n">Dummy</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-10213"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-10214"></a>
<a name="ln-10215"></a>
<a name="ln-10216"></a>      <span class="k">END SELECT</span>
<a name="ln-10217"></a>
<a name="ln-10218"></a><span class="c">!      NoOutput = Node(InletNode)%MassFlowRate *  &amp;</span>
<a name="ln-10219"></a><span class="c">!                   (PsyHFnTdbW(Node(OutletNode)%Temp,Node(OutletNode)%HumRat)  &amp;</span>
<a name="ln-10220"></a><span class="c">!                    - PsyHFnTdbW(Node(InletNode)%Temp,Node(OutletNode)%HumRat))</span>
<a name="ln-10221"></a>      <span class="n">NoLoadTempOut</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-10222"></a>      <span class="n">NoLoadHumRatOut</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-10223"></a>
<a name="ln-10224"></a><span class="c">!     Changed logic to use temperature instead of load. The Psyc calcs can cause slight errors.</span>
<a name="ln-10225"></a><span class="c">!     For example it&#39;s possible that (NoOutput-ReqOutput) &gt; Acc while (Node(OutletNode)%Temp-DesOutTemp) is not</span>
<a name="ln-10226"></a><span class="c">!     This can (and did) lead to RegulaFalsi errors</span>
<a name="ln-10227"></a>
<a name="ln-10228"></a><span class="c">!      IF ((NoOutput-ReqOutput) .LT. Acc) THEN</span>
<a name="ln-10229"></a><span class="c">!     IF outlet temp at no load is lower than DesOutTemp (set point), do not operate the coil</span>
<a name="ln-10230"></a>      <span class="k">IF</span> <span class="p">((</span><span class="n">NoLoadTempOut</span><span class="o">-</span><span class="n">DesOutTemp</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">Acc</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10231"></a><span class="k">        </span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10232"></a>      <span class="k">ELSE IF</span><span class="p">(</span><span class="n">SensibleLoad</span><span class="p">)</span><span class="k">THEN</span> <span class="c">! need to turn on compressor to see if load is met</span>
<a name="ln-10233"></a>        <span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-10234"></a>        <span class="n">WSHPRuntimeFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-10235"></a>        <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span><span class="p">)</span>
<a name="ln-10236"></a>
<a name="ln-10237"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_CoolingSingleSpeed</span><span class="p">)</span>  <span class="c">! COIL:DX:COOLINGBYPASSFACTOREMPIRICAL</span>
<a name="ln-10238"></a>
<a name="ln-10239"></a>            <span class="k">CALL </span><span class="n">SimDXCoil</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">On</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">)</span>
<a name="ln-10240"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-10241"></a>
<a name="ln-10242"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_CoolingHXAssisted</span><span class="p">,</span><span class="n">CoilWater_CoolingHXAssisted</span><span class="p">)</span>  <span class="c">! CoilSystem:Cooling:DX:HeatExchangerAssisted</span>
<a name="ln-10243"></a>
<a name="ln-10244"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilFluidInletNode</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-10245"></a>                 <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilFluidInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-10246"></a>                    <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolCoilFluidFlow</span><span class="p">)</span>
<a name="ln-10247"></a>            <span class="k">CALL </span><span class="n">SimHXAssistedCoolingCoil</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">On</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10248"></a>                                          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10249"></a>                                          <span class="n">HXUnitEnable</span><span class="o">=</span><span class="n">HXUnitOn</span><span class="p">,</span><span class="n">EconomizerFlag</span><span class="o">=</span><span class="n">EconomizerFlag</span><span class="p">)</span>
<a name="ln-10250"></a>
<a name="ln-10251"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span><span class="o">==</span><span class="n">CoilDX_CoolingHXAssisted</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-10252"></a>                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-10253"></a>
<a name="ln-10254"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_CoolingTwoSpeed</span><span class="p">)</span>
<a name="ln-10255"></a>
<a name="ln-10256"></a>            <span class="n">CycRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-10257"></a>            <span class="k">DO </span><span class="n">SpeedNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span>
<a name="ln-10258"></a>              <span class="n">SpeedRatio</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.0d0</span>
<a name="ln-10259"></a>              <span class="k">CALL </span><span class="n">SimDXCoilMultiSpeed</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="n">CycRatio</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">)</span>
<a name="ln-10260"></a>              <span class="n">OutletTemp</span> <span class="o">=</span> <span class="n">DXCoilOutletTemp</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">)</span>
<a name="ln-10261"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">OutletTemp</span> <span class="o">&lt;</span> <span class="n">DesOutTemp</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SensibleLoad</span><span class="p">)</span> <span class="k">EXIT</span> <span class="c">! this isn&#39;t going to work IF dehumidIFying</span>
<a name="ln-10262"></a>            <span class="k">END DO</span>
<a name="ln-10263"></a>
<a name="ln-10264"></a><span class="k">          CASE</span> <span class="p">(</span><span class="n">CoilDX_MultiSpeedCooling</span><span class="p">,</span> <span class="n">Coil_CoolingAirToAirVariableSpeed</span><span class="p">,</span> <span class="n">Coil_CoolingWaterToAirHPVSEquationFit</span><span class="p">)</span>
<a name="ln-10265"></a>
<a name="ln-10266"></a>            <span class="n">CycRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-10267"></a>            <span class="k">DO </span><span class="n">SpeedNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span>
<a name="ln-10268"></a>              <span class="k">CALL </span><span class="n">SimMultiSpeedCoils</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">SensibleLoad</span><span class="p">,</span> <span class="n">LatentLoad</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10269"></a>                                      <span class="n">CoolingCoil</span><span class="p">,</span> <span class="n">SpeedNum</span><span class="p">)</span>
<a name="ln-10270"></a>              <span class="n">OutletTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-10271"></a>              <span class="n">SpeedRatio</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.0d0</span>
<a name="ln-10272"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">OutletTemp</span> <span class="o">&lt;</span> <span class="n">DesOutTemp</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SensibleLoad</span><span class="p">)</span> <span class="k">EXIT</span>
<a name="ln-10273"></a><span class="k">            END DO</span>
<a name="ln-10274"></a>
<a name="ln-10275"></a><span class="k">          CASE</span> <span class="p">(</span><span class="n">CoilDX_CoolingTwoStageWHumControl</span><span class="p">)</span> <span class="c">! Coil:Cooling:DX:TwoStageWithHumidityControlMode</span>
<a name="ln-10276"></a>
<a name="ln-10277"></a>            <span class="k">CALL </span><span class="n">SimDXCoilMultiMode</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">On</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">DehumidMode</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-10278"></a>                                    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">)</span>
<a name="ln-10279"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-10280"></a>
<a name="ln-10281"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_CoolingWater</span><span class="p">,</span> <span class="n">Coil_CoolingWaterDetailed</span><span class="p">)</span>  <span class="c">! COIL:COOLING:WATER</span>
<a name="ln-10282"></a>
<a name="ln-10283"></a>            <span class="k">CALL </span><span class="n">SimWaterCoils</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">CoolingCoil</span><span class="p">)</span>
<a name="ln-10284"></a>
<a name="ln-10285"></a>          <span class="k">CASE</span><span class="p">(</span><span class="n">Coil_CoolingWaterToAirHPSimple</span><span class="p">)</span>
<a name="ln-10286"></a>
<a name="ln-10287"></a>            <span class="k">CALL </span><span class="n">SimWatertoAirHPSimple</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="n">ReqOutput</span><span class="p">,</span> <span class="n">Dummy</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10288"></a>                                       <span class="n">FanOpMode</span><span class="p">,</span><span class="n">WSHPRuntimeFrac</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10289"></a>                                       <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10290"></a>                                       <span class="mi">0</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-10291"></a>
<a name="ln-10292"></a>          <span class="k">CASE</span><span class="p">(</span><span class="n">Coil_CoolingWaterToAirHP</span><span class="p">)</span>
<a name="ln-10293"></a>
<a name="ln-10294"></a>            <span class="k">CALL </span><span class="n">SimWatertoAirHP</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10295"></a>                                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirMassFlow</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10296"></a>                                   <span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">WSHPRuntimeFrac</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10297"></a>                                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10298"></a>                                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">InitHeatPump</span><span class="p">,</span> <span class="n">ReqOutput</span><span class="p">,</span><span class="n">Dummy</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-10299"></a>          <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-10300"></a>
<a name="ln-10301"></a>
<a name="ln-10302"></a>        <span class="k">END SELECT</span>
<a name="ln-10303"></a>
<a name="ln-10304"></a><span class="k">        </span><span class="n">FullOutput</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-10305"></a>                   <span class="p">(</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-10306"></a>                    <span class="o">-</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">))</span>
<a name="ln-10307"></a>
<a name="ln-10308"></a>        <span class="n">FullLoadHumRatOut</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-10309"></a>
<a name="ln-10310"></a>
<a name="ln-10311"></a><span class="c">!        IF ((FullOutput - ReqOutput) .GT. Acc) THEN ! old method</span>
<a name="ln-10312"></a><span class="c">!        IF ((Node(OutletNode)%Temp-DesOutTemp) .GT. Acc) THEN ! new method gets caught when temps are very close</span>
<a name="ln-10313"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">DesOutTemp</span><span class="o">-</span><span class="n">Acc</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10314"></a><span class="k">          </span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-10315"></a>
<a name="ln-10316"></a>        <span class="k">ELSE</span>
<a name="ln-10317"></a><span class="k">          SELECT CASE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span><span class="p">)</span>
<a name="ln-10318"></a>
<a name="ln-10319"></a>            <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_CoolingSingleSpeed</span><span class="p">)</span>  <span class="c">! COIL:DX:COOLINGBYPASSFACTOREMPIRICAL</span>
<a name="ln-10320"></a>
<a name="ln-10321"></a>              <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-10322"></a>              <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">DesOutTemp</span>
<a name="ln-10323"></a>              <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-10324"></a>              <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">DOE2DXCoilResidual</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-10325"></a>                                    <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-10326"></a>              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-10327"></a>
<a name="ln-10328"></a>            <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_CoolingHXAssisted</span><span class="p">,</span><span class="n">CoilWater_CoolingHXAssisted</span><span class="p">)</span>  <span class="c">! CoilSystem:Cooling:DX:HeatExchangerAssisted</span>
<a name="ln-10329"></a>
<a name="ln-10330"></a>                <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-10331"></a>                <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">DesOutTemp</span>
<a name="ln-10332"></a>              <span class="c">! FirstHVACIteration is a logical, Par is REAL(r64), so make TRUE = 1 and FALSE = 0</span>
<a name="ln-10333"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10334"></a><span class="k">                  </span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-10335"></a>                <span class="k">ELSE</span>
<a name="ln-10336"></a><span class="k">                  </span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10337"></a>                <span class="k">END IF</span>
<a name="ln-10338"></a><span class="k">                IF</span><span class="p">(</span><span class="n">HXUnitOn</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10339"></a><span class="k">                  </span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-10340"></a>                <span class="k">ELSE</span>
<a name="ln-10341"></a><span class="k">                  </span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10342"></a>                <span class="k">END IF</span>
<a name="ln-10343"></a><span class="k">                </span><span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-10344"></a>                <span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-10345"></a>                <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">HXAssistedCoolCoilTempResidual</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-10346"></a>                                      <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-10347"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10348"></a>
<a name="ln-10349"></a><span class="c">!                 RegulaFalsi may not find sensible PLR when the latent degradation model is used.</span>
<a name="ln-10350"></a><span class="c">!                 IF iteration limit is exceeded, find tighter boundary of solution and repeat RegulaFalsi</span>
<a name="ln-10351"></a>                  <span class="n">TempMaxPLR</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.1d0</span>
<a name="ln-10352"></a>                  <span class="n">TempOutletTempDXCoil</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-10353"></a>                  <span class="k">DO WHILE</span><span class="p">((</span><span class="n">TempOutletTempDXCoil</span><span class="o">-</span><span class="n">DesOutTemp</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">TempMaxPLR</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-10354"></a><span class="c">!                   find upper limit of PLR</span>
<a name="ln-10355"></a>                    <span class="n">TempMaxPLR</span> <span class="o">=</span> <span class="n">TempMaxPLR</span> <span class="o">+</span> <span class="mf">0.1d0</span>
<a name="ln-10356"></a>                    <span class="k">CALL </span><span class="n">SimHXAssistedCoolingCoil</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">On</span><span class="p">,</span><span class="n">TempMaxPLR</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10357"></a>                                                  <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="n">FanOpMOde</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10358"></a>                                                  <span class="n">HXUnitEnable</span><span class="o">=</span><span class="n">HXUnitOn</span><span class="p">,</span> <span class="n">EconomizerFlag</span><span class="o">=</span><span class="n">EconomizerFlag</span><span class="p">)</span>
<a name="ln-10359"></a>                    <span class="n">TempOutletTempDXCoil</span> <span class="o">=</span> <span class="n">HXAssistedCoilOutletTemp</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">)</span>
<a name="ln-10360"></a>                  <span class="k">END DO</span>
<a name="ln-10361"></a><span class="k">                  </span><span class="n">TempMinPLR</span> <span class="o">=</span> <span class="n">TempMaxPLR</span>
<a name="ln-10362"></a>                  <span class="k">DO WHILE</span><span class="p">((</span><span class="n">TempOutletTempDXCoil</span><span class="o">-</span><span class="n">DesOutTemp</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">TempMinPLR</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-10363"></a><span class="c">!                  pull upper limit of PLR DOwn to last valid limit (i.e. outlet temp still exceeds DesOutTemp)</span>
<a name="ln-10364"></a>                    <span class="n">TempMaxPLR</span> <span class="o">=</span> <span class="n">TempMinPLR</span>
<a name="ln-10365"></a><span class="c">!                   find minimum limit of PLR</span>
<a name="ln-10366"></a>                    <span class="n">TempMinPLR</span> <span class="o">=</span> <span class="n">TempMinPLR</span> <span class="o">-</span> <span class="mf">0.01d0</span>
<a name="ln-10367"></a>                    <span class="k">CALL </span><span class="n">SimHXAssistedCoolingCoil</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">On</span><span class="p">,</span><span class="n">TempMinPLR</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10368"></a>                                                  <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10369"></a>                                                  <span class="n">HXUnitEnable</span><span class="o">=</span><span class="n">HXUnitOn</span><span class="p">,</span> <span class="n">EconomizerFlag</span><span class="o">=</span><span class="n">EconomizerFlag</span><span class="p">)</span>
<a name="ln-10370"></a>                    <span class="n">TempOutletTempDXCoil</span> <span class="o">=</span> <span class="n">HXAssistedCoilOutletTemp</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">)</span>
<a name="ln-10371"></a>                  <span class="k">END DO</span>
<a name="ln-10372"></a><span class="c">!                 Relax boundary slightly to assure a solution can be found using RegulaFalsi (i.e. one boundary may be</span>
<a name="ln-10373"></a><span class="c">!                 very near the desired result)</span>
<a name="ln-10374"></a>                  <span class="n">TempMinPLR</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,(</span><span class="n">TempMinPLR</span> <span class="o">-</span> <span class="mf">0.01d0</span><span class="p">))</span>
<a name="ln-10375"></a>                  <span class="n">TempMaxPLR</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,(</span><span class="n">TempMaxPLR</span> <span class="o">+</span> <span class="mf">0.01d0</span><span class="p">))</span>
<a name="ln-10376"></a><span class="c">!                 tighter boundary of solution has been found, CALL RegulaFalsi a second time</span>
<a name="ln-10377"></a>                  <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span><span class="n">MaxIte</span><span class="p">,</span><span class="n">SolFla</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">HXAssistedCoolCoilTempResidual</span><span class="p">,</span><span class="n">TempMinPLR</span><span class="p">,</span><span class="n">TempMaxPLR</span><span class="p">,</span><span class="n">Par</span><span class="p">)</span>
<a name="ln-10378"></a>                  <span class="k">IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10379"></a><span class="k">                    IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10380"></a><span class="k">                      IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HXAssistedSensPLRIter</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10381"></a><span class="k">                        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HXAssistedSensPLRIter</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HXAssistedSensPLRIter</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-10382"></a>                        <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; - Iteration limit&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10383"></a>                                              <span class="s1">&#39; exceeded calculating DX unit sensible part-load ratio for unit = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10384"></a>                                              <span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-10385"></a>                        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Estimated part-load ratio   = &#39;</span><span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">((</span><span class="n">ReqOutput</span><span class="o">/</span><span class="n">FullOutput</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-10386"></a>                        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Calculated part-load ratio = &#39;</span><span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-10387"></a>                        <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;The calculated part-load ratio will be used and the simulation&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10388"></a>                                                        <span class="s1">&#39; continues. Occurrence info: &#39;</span><span class="p">)</span>
<a name="ln-10389"></a>                      <span class="k">END IF</span>
<a name="ln-10390"></a><span class="k">                      CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-10391"></a>                          <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - Iteration limit exceeded calculating&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10392"></a>                          <span class="s1">&#39; sensible part-load ratio error continues. Sensible PLR statistics follow.&#39;</span> <span class="p">&amp;</span>
<a name="ln-10393"></a>                          <span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HXAssistedSensPLRIterIndex</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-10394"></a>                    <span class="k">END IF</span>
<a name="ln-10395"></a><span class="k">                  </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10396"></a><span class="k">                    </span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="n">ReqOutput</span><span class="o">/</span><span class="n">FullOutput</span>
<a name="ln-10397"></a>                    <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10398"></a><span class="k">                      IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HXAssistedSensPLRFail</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10399"></a><span class="k">                        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HXAssistedSensPLRFail</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HXAssistedSensPLRFail</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-10400"></a>                        <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10401"></a>                                            <span class="s1">&#39; - DX unit sensible part-load ratio calculation unexpectedly failed: part-load &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10402"></a>                                            <span class="s1">&#39;ratio limits exceeded, for unit = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-10403"></a>                        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Estimated part-load ratio = &#39;</span><span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-10404"></a>                        <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;The estimated part-load ratio will be used and the simulation&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10405"></a>                                                        <span class="s1">&#39; continues. Occurrence info: &#39;</span><span class="p">)</span>
<a name="ln-10406"></a>                      <span class="k">END IF</span>
<a name="ln-10407"></a><span class="k">                      CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-10408"></a>                          <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - DX unit sensible part-load ratio calculation&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10409"></a>                          <span class="s1">&#39; unexpectedly failed error continues. Sensible PLR statistics follow.&#39;</span> <span class="p">&amp;</span>
<a name="ln-10410"></a>                          <span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HXAssistedSensPLRFailIndex</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-10411"></a>                    <span class="k">END IF</span>
<a name="ln-10412"></a><span class="k">                  END IF</span>
<a name="ln-10413"></a><span class="k">                </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10414"></a><span class="k">                  </span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="n">ReqOutput</span><span class="o">/</span><span class="n">FullOutput</span>
<a name="ln-10415"></a>                  <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10416"></a><span class="k">                    IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HXAssistedSensPLRFail2</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10417"></a><span class="k">                      </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HXAssistedSensPLRFail2</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HXAssistedSensPLRFail2</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-10418"></a>                      <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10419"></a>                                            <span class="s1">&#39; - DX unit sensible part-load ratio calculation failed: part-load &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10420"></a>                                            <span class="s1">&#39;ratio limits exceeded, for unit = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-10421"></a>                      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Estimated part-load ratio = &#39;</span><span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-10422"></a>                      <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;The estimated part-load ratio will be used and the simulation&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10423"></a>                                                      <span class="s1">&#39; continues. Occurrence info: &#39;</span><span class="p">)</span>
<a name="ln-10424"></a>                    <span class="k">END IF</span>
<a name="ln-10425"></a><span class="k">                    CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-10426"></a>                        <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - DX unit sensible part-load ratio calculation&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10427"></a>                        <span class="s1">&#39; failed error continues. Sensible PLR statistics follow.&#39;</span> <span class="p">&amp;</span>
<a name="ln-10428"></a>                        <span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HXAssistedSensPLRFailIndex2</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-10429"></a>                  <span class="k">END IF</span>
<a name="ln-10430"></a><span class="k">                END IF</span>
<a name="ln-10431"></a><span class="k">              IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span><span class="o">==</span><span class="n">CoilDX_CoolingHXAssisted</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-10432"></a>                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-10433"></a>
<a name="ln-10434"></a>            <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_CoolingTwoSpeed</span><span class="p">)</span>
<a name="ln-10435"></a>              <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-10436"></a>              <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">DesOutTemp</span>
<a name="ln-10437"></a>              <span class="c">! Par(3) is only needed for variable speed coils (see DXCoilVarSpeedResidual and DXCoilCyclingResidual)</span>
<a name="ln-10438"></a>              <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">UnitarySysNum</span>
<a name="ln-10439"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">SpeedRatio</span> <span class="o">==</span> <span class="mf">1.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10440"></a><span class="k">                CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">SpeedRatio</span><span class="p">,</span> <span class="n">DXCoilVarSpeedResidual</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-10441"></a>                                        <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-10442"></a>                <span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="n">SpeedRatio</span>
<a name="ln-10443"></a>              <span class="k">ELSE</span>
<a name="ln-10444"></a><span class="k">                CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">CycRatio</span><span class="p">,</span> <span class="n">DXCoilCyclingResidual</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-10445"></a>                                      <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-10446"></a>                <span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="n">CycRatio</span>
<a name="ln-10447"></a>              <span class="k">END IF</span>
<a name="ln-10448"></a>
<a name="ln-10449"></a><span class="k">            CASE</span> <span class="p">(</span><span class="n">CoilDX_MultiSpeedCooling</span><span class="p">,</span> <span class="n">Coil_CoolingAirToAirVariableSpeed</span><span class="p">,</span> <span class="n">Coil_CoolingWaterToAirHPVSEquationFit</span><span class="p">)</span>
<a name="ln-10450"></a>
<a name="ln-10451"></a>                <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-10452"></a>                <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">DesOutTemp</span>
<a name="ln-10453"></a>                <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">UnitarySysNum</span>
<a name="ln-10454"></a>                <span class="c">! Par(4) = CycRatio or SpeedRatio</span>
<a name="ln-10455"></a>                <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedNum</span>
<a name="ln-10456"></a>                <span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! UnitarySystem(UnitarySysNum)%FanOpMode</span>
<a name="ln-10457"></a>                <span class="n">Par</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! CompOp</span>
<a name="ln-10458"></a>                <span class="n">Par</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">=</span> <span class="n">ReqOutput</span>
<a name="ln-10459"></a>
<a name="ln-10460"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">SpeedRatio</span> <span class="o">==</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10461"></a><span class="k">                </span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">CycRatio</span>
<a name="ln-10462"></a>                <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">SpeedRatio</span><span class="p">,</span> <span class="n">DXCoilVarSpeedResidual</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-10463"></a>                                              <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-10464"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCycRatio</span> <span class="o">=</span> <span class="n">SpeedRatio</span>
<a name="ln-10465"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingPartLoadFrac</span> <span class="o">=</span> <span class="n">SpeedRatio</span>
<a name="ln-10466"></a>                <span class="k">CALL </span><span class="n">CalcPassiveSystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-10467"></a>                <span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="n">SpeedRatio</span>
<a name="ln-10468"></a>              <span class="k">ELSE</span>
<a name="ln-10469"></a><span class="k">                </span><span class="n">SpeedRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10470"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span> <span class="o">=</span> <span class="n">SpeedRatio</span>
<a name="ln-10471"></a>                <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">SpeedRatio</span>
<a name="ln-10472"></a>
<a name="ln-10473"></a>                <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">CycRatio</span><span class="p">,</span> <span class="n">DXCoilCyclingResidual</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-10474"></a>                                                <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-10475"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCycRatio</span> <span class="o">=</span> <span class="n">CycRatio</span>
<a name="ln-10476"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingPartLoadFrac</span> <span class="o">=</span> <span class="n">CycRatio</span>
<a name="ln-10477"></a>                <span class="k">CALL </span><span class="n">CalcPassiveSystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-10478"></a>                <span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="n">CycRatio</span>
<a name="ln-10479"></a>              <span class="k">END IF</span>
<a name="ln-10480"></a>
<a name="ln-10481"></a><span class="k">            CASE</span> <span class="p">(</span><span class="n">CoilDX_CoolingTwoStageWHumControl</span><span class="p">)</span> <span class="c">! Coil:Cooling:DX:TwoStageWithHumidityControlMode</span>
<a name="ln-10482"></a>
<a name="ln-10483"></a>              <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-10484"></a>              <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">DesOutTemp</span>
<a name="ln-10485"></a>              <span class="c">! dehumidification mode = 0 for normal mode, 1+ for enhanced mode</span>
<a name="ln-10486"></a>              <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">DehumidMode</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-10487"></a>              <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-10488"></a>              <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">MultiModeDXCoilResidual</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-10489"></a>                                    <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-10490"></a>              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-10491"></a>
<a name="ln-10492"></a>            <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_CoolingWater</span><span class="p">,</span> <span class="n">Coil_CoolingWaterDetailed</span><span class="p">)</span>  <span class="c">! COIL:COOLING:WATER</span>
<a name="ln-10493"></a>
<a name="ln-10494"></a>              <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-10495"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10496"></a><span class="k">                </span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-10497"></a>              <span class="k">ELSE</span>
<a name="ln-10498"></a><span class="k">                </span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10499"></a>              <span class="k">END IF</span>
<a name="ln-10500"></a><span class="k">              </span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">DesOutTemp</span>
<a name="ln-10501"></a>              <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">CoolWaterTempResidual</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-10502"></a>                                            <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-10503"></a>
<a name="ln-10504"></a>            <span class="k">CASE</span><span class="p">(</span><span class="n">Coil_CoolingWaterToAirHPSimple</span><span class="p">,</span> <span class="n">Coil_CoolingWaterToAirHP</span><span class="p">)</span>
<a name="ln-10505"></a>              <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-10506"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10507"></a><span class="k">                </span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-10508"></a>              <span class="k">ELSE</span>
<a name="ln-10509"></a><span class="k">                </span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10510"></a>              <span class="k">END IF</span>
<a name="ln-10511"></a><span class="k">              </span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">DesOutTemp</span>
<a name="ln-10512"></a>              <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">ReqOutput</span>
<a name="ln-10513"></a>
<a name="ln-10514"></a>              <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">CoolWatertoAirHPTempResidual</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-10515"></a>                                            <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-10516"></a>
<a name="ln-10517"></a>            <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-10518"></a>              <span class="k">CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39; For :&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10519"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-10520"></a>              <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;ControlCoolingSystem: Invalid cooling coil type = &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-10521"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">CALLCoilTypes</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span><span class="p">)))</span>
<a name="ln-10522"></a>
<a name="ln-10523"></a>          <span class="k">END SELECT</span>
<a name="ln-10524"></a>
<a name="ln-10525"></a><span class="k">        END IF</span>
<a name="ln-10526"></a><span class="k">      END IF</span>
<a name="ln-10527"></a>
<a name="ln-10528"></a><span class="c">!     IF system does not operate to meet sensible load, use no load humidity ratio to test against humidity setpoint,</span>
<a name="ln-10529"></a><span class="c">!     ELSE use operating humidity ratio to test against humidity setpoint</span>
<a name="ln-10530"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">PartLoadFrac</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10531"></a><span class="k">        </span><span class="n">OutletHumRatDXCoil</span> <span class="o">=</span> <span class="n">NoLoadHumRatOut</span>
<a name="ln-10532"></a>      <span class="k">ELSE</span>
<a name="ln-10533"></a><span class="k">        </span><span class="n">OutletHumRatDXCoil</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-10534"></a>      <span class="k">END IF</span>
<a name="ln-10535"></a>
<a name="ln-10536"></a>      <span class="c">! IF humidity setpoint is not satisfied and humidity control type is MultiMode,</span>
<a name="ln-10537"></a>      <span class="c">! then enable heat exchanger and run to meet sensible load</span>
<a name="ln-10538"></a>
<a name="ln-10539"></a>      <span class="k">IF</span> <span class="p">((</span> <span class="n">OutletHumRatDXCoil</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">DesOutHumRat</span> <span class="o">+</span> <span class="n">HumRatAcc</span><span class="p">))</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">PartLoadFrac</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-10540"></a>          <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">DehumidControl_Multimode</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10541"></a>
<a name="ln-10542"></a><span class="k">        SELECT CASE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span><span class="p">)</span>
<a name="ln-10543"></a>
<a name="ln-10544"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_CoolingHXAssisted</span><span class="p">)</span>  <span class="c">! CoilSystem:Cooling:DX:HeatExchangerAssisted</span>
<a name="ln-10545"></a>            <span class="c">! Determine required part load when heat exchanger is ON</span>
<a name="ln-10546"></a>            <span class="n">HXUnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-10547"></a>            <span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-10548"></a>            <span class="k">CALL </span><span class="n">SimHXAssistedCoolingCoil</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">On</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10549"></a>                                            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10550"></a>                                            <span class="n">HXUnitEnable</span><span class="o">=</span><span class="n">HXUnitOn</span><span class="p">,</span> <span class="n">EconomizerFlag</span><span class="o">=</span><span class="n">EconomizerFlag</span><span class="p">)</span>
<a name="ln-10551"></a>
<a name="ln-10552"></a>            <span class="n">OutletTempDXCoil</span> <span class="o">=</span> <span class="n">HXAssistedCoilOutletTemp</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">)</span>
<a name="ln-10553"></a>
<a name="ln-10554"></a>        <span class="c">!               FullOutput will be different than the FullOutput determined above during sensible PLR calculations</span>
<a name="ln-10555"></a>            <span class="n">FullOutput</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-10556"></a>                        <span class="p">(</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-10557"></a>                        <span class="o">-</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">))</span>
<a name="ln-10558"></a>
<a name="ln-10559"></a>        <span class="c">!   Check to see if the system can meet the load with the compressor off</span>
<a name="ln-10560"></a>        <span class="c">!   If NoOutput is lower than (more cooling than required) or very near the ReqOutput, do not run the compressor</span>
<a name="ln-10561"></a>            <span class="k">IF</span> <span class="p">((</span><span class="n">NoLoadTempOut</span><span class="o">-</span><span class="n">DesOutTemp</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">Acc</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10562"></a><span class="k">                </span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10563"></a>        <span class="c">!          OutletTempDXCoil is the full capacity outlet temperature at PartLoadFrac = 1 from the CALL above.</span>
<a name="ln-10564"></a>        <span class="c">!          if this temp is greater than or very near the desired outlet temp, then run the compressor at PartLoadFrac = 1.</span>
<a name="ln-10565"></a><span class="c">!            ELSEIF ((OutletTempDXCoil &gt; DesOutTemp) .OR. ABS(OutletTempDXCoil - DesOutTemp) .LE. (Acc*2.0d0)) THEN</span>
<a name="ln-10566"></a>            <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">OutletTempDXCoil</span> <span class="o">&gt;</span> <span class="n">DesOutTemp</span> <span class="o">-</span> <span class="p">(</span><span class="n">Acc</span><span class="o">*</span><span class="mf">2.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10567"></a><span class="k">                </span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-10568"></a>            <span class="k">ELSE</span>
<a name="ln-10569"></a><span class="k">                </span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-10570"></a>                <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">DesOutTemp</span>
<a name="ln-10571"></a>                <span class="c">! FirstHVACIteration is a logical, Par is REAL(r64), so make TRUE = 1.0 and FALSE = 0.0</span>
<a name="ln-10572"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10573"></a><span class="k">                </span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-10574"></a>                <span class="k">ELSE</span>
<a name="ln-10575"></a><span class="k">                </span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10576"></a>                <span class="k">END IF</span>
<a name="ln-10577"></a><span class="k">                IF</span><span class="p">(</span><span class="n">HXUnitOn</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10578"></a><span class="k">                </span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-10579"></a>                <span class="k">ELSE</span>
<a name="ln-10580"></a><span class="k">                </span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10581"></a>                <span class="k">END IF</span>
<a name="ln-10582"></a><span class="k">                </span><span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-10583"></a>                <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">HXAssistedCoolCoilTempResidual</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-10584"></a>                                            <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-10585"></a>            <span class="k">END IF</span>
<a name="ln-10586"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-10587"></a>
<a name="ln-10588"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_CoolingTwoStageWHumControl</span><span class="p">)</span> <span class="c">! Coil:Cooling:DX:TwoStageWithHumidityControlMode</span>
<a name="ln-10589"></a>                                        <span class="c">! formerly (v3 and beyond) COIL:DX:MULTIMODE:COOLINGEMPIRICAL)</span>
<a name="ln-10590"></a>
<a name="ln-10591"></a>               <span class="c">! Get full load result</span>
<a name="ln-10592"></a>                <span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-10593"></a>                <span class="n">DehumidMode</span>  <span class="o">=</span> <span class="mi">1</span>
<a name="ln-10594"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">dehumidificationMode</span> <span class="o">=</span> <span class="n">DehumidMode</span>
<a name="ln-10595"></a>                <span class="k">CALL </span><span class="n">SimDXCoilMultiMode</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">On</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">DehumidMode</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-10596"></a>                                        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">)</span>
<a name="ln-10597"></a>                <span class="n">FullOutput</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-10598"></a>                             <span class="p">(</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-10599"></a>                              <span class="o">-</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">))</span>
<a name="ln-10600"></a>
<a name="ln-10601"></a>                <span class="c">! Since we are cooling, we expect FullOutput to be &lt; 0 and FullOutput &lt; NoCoolOutput</span>
<a name="ln-10602"></a>                <span class="c">! Check that this is the case; IF not set PartLoadFrac = 0.0 (off) and return</span>
<a name="ln-10603"></a>                <span class="c">! Calculate the part load fraction</span>
<a name="ln-10604"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">FullOutput</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10605"></a><span class="k">                  </span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10606"></a>                <span class="k">ELSE</span>
<a name="ln-10607"></a><span class="k">                  </span><span class="n">OutletTempDXCoil</span> <span class="o">=</span> <span class="n">DXCoilOutletTemp</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">)</span>
<a name="ln-10608"></a>                  <span class="n">OutletHumRatDXCoil</span> <span class="o">=</span> <span class="n">DXCoilOutletHumRat</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">)</span>
<a name="ln-10609"></a>                  <span class="c">! If sensible load and setpoint cannot be met, set PLR = 1. if no sensible load and</span>
<a name="ln-10610"></a>                  <span class="c">! latent load exists and setpoint cannot be met, set PLR = 1.</span>
<a name="ln-10611"></a><span class="c">! why is our logic different? Did we figure something out that reduced the logic?</span>
<a name="ln-10612"></a><span class="c">!                  IF ((SensibleLoad .and. LatentLoad .AND. .NOT. UnitarySystem(UnitarySysNum)%RunOnLatentLoad .AND. &amp;</span>
<a name="ln-10613"></a><span class="c">!                       OutletHumRatDXCoil &gt;= DesOutHumRat)) THEN</span>
<a name="ln-10614"></a>                  <span class="k">IF</span> <span class="p">((</span><span class="n">OutletTempDXCoil</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">DesOutTemp</span><span class="o">-</span><span class="p">(</span><span class="n">Acc</span><span class="o">*</span><span class="mf">2.0d0</span><span class="p">))</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SensibleLoad</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-10615"></a>                       <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RunOnSensibleLoad</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-10616"></a>                      <span class="p">(</span><span class="n">OutletHumRatDXCoil</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">DesOutHumRat</span><span class="o">-</span><span class="p">(</span><span class="n">HumRatAcc</span><span class="o">*</span><span class="mf">2.0d0</span><span class="p">))</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-10617"></a>                      <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SensibleLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">LatentLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RunOnLatentLoad</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10618"></a><span class="k">                    </span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-10619"></a><span class="c">!                  ELSEIF ((SensibleLoad .and. LatentLoad .AND. .NOT. UnitarySystem(UnitarySysNum)%RunOnLatentLoad .AND. &amp;</span>
<a name="ln-10620"></a><span class="c">!                       OutletHumRatDXCoil &lt; DesOutHumRat)) THEN</span>
<a name="ln-10621"></a>                  <span class="k">ELSE IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SensibleLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-10622"></a>                      <span class="p">(</span><span class="n">OutletHumRatDXCoil</span> <span class="o">&lt;</span> <span class="n">DesOutHumRat</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">LatentLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">RunOnLatentLoad</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10623"></a><span class="k">                    </span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="n">ReqOutput</span><span class="o">/</span><span class="n">FullOutput</span>
<a name="ln-10624"></a>                    <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-10625"></a>                    <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">DesOutHumRat</span>
<a name="ln-10626"></a>                    <span class="c">! dehumidification mode = 0 for normal mode, 1+ for enhanced mode</span>
<a name="ln-10627"></a>                    <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">DehumidMode</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-10628"></a>                    <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-10629"></a>                    <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">MultiModeDXCoilHumRatResidual</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10630"></a>                                          <span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-10631"></a>                  <span class="k">ELSE</span> <span class="c">! must be a sensible load so find PLR</span>
<a name="ln-10632"></a>                    <span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="n">ReqOutput</span><span class="o">/</span><span class="n">FullOutput</span>
<a name="ln-10633"></a>                    <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-10634"></a>                    <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">DesOutTemp</span>
<a name="ln-10635"></a>                    <span class="c">! Dehumidification mode = 0 for normal mode, 1+ for enhanced mode</span>
<a name="ln-10636"></a>                    <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">DehumidMode</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-10637"></a>                    <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-10638"></a>                    <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">MultiModeDXCoilResidual</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10639"></a>                                          <span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-10640"></a>                  <span class="k">END IF</span>
<a name="ln-10641"></a><span class="k">                END IF</span>
<a name="ln-10642"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-10643"></a>
<a name="ln-10644"></a>          <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-10645"></a>
<a name="ln-10646"></a>        <span class="k">END SELECT</span>
<a name="ln-10647"></a><span class="k">      END IF</span> <span class="c">! END IF humidity ratio setpoint not met - Multimode humidity control</span>
<a name="ln-10648"></a>
<a name="ln-10649"></a>        <span class="c">! IF humidity setpoint is not satisfied and humidity control type is CoolReheat,</span>
<a name="ln-10650"></a>        <span class="c">! then overcool to meet moisture load</span>
<a name="ln-10651"></a>
<a name="ln-10652"></a>      <span class="k">IF</span> <span class="p">((</span> <span class="n">OutletHumRatDXCoil</span> <span class="o">&gt;</span> <span class="n">DesOutHumRat</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">PartLoadFrac</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">LatentLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-10653"></a>            <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">DehumidControl_CoolReheat</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10654"></a>
<a name="ln-10655"></a><span class="c">!           IF NoLoadHumRatOut is lower than (more dehumidification than required) or very near the DesOutHumRat,</span>
<a name="ln-10656"></a><span class="c">!           do not run the compressor</span>
<a name="ln-10657"></a>        <span class="k">IF</span> <span class="p">((</span><span class="n">NoLoadHumRatOut</span><span class="o">-</span><span class="n">DesOutHumRat</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">HumRatAcc</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10658"></a><span class="k">            </span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>  <span class="c">! keep part-load fraction from sensible calculation</span>
<a name="ln-10659"></a><span class="c">!           If the FullLoadHumRatOut is greater than (insufficient dehumidification) or very near the DesOutHumRat,</span>
<a name="ln-10660"></a><span class="c">!           run the compressor at PartLoadFrac = 1.</span>
<a name="ln-10661"></a><span class="c">!        ELSEIF ((DesOutHumRat-FullLoadHumRatOut) .LT. HumRatAcc) THEN</span>
<a name="ln-10662"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">FullLoadHumRatOut</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="p">(</span><span class="n">DesOutHumRat</span><span class="o">-</span><span class="n">HumRatAcc</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10663"></a><span class="k">            </span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-10664"></a><span class="c">!           ELSE find the PLR to meet the load</span>
<a name="ln-10665"></a>
<a name="ln-10666"></a>        <span class="k">ELSE</span>
<a name="ln-10667"></a>
<a name="ln-10668"></a><span class="k">          SELECT CASE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span><span class="p">)</span>
<a name="ln-10669"></a>
<a name="ln-10670"></a>            <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_CoolingSingleSpeed</span><span class="p">)</span>  <span class="c">! COIL:DX:COOLINGBYPASSFACTOREMPIRICAL</span>
<a name="ln-10671"></a>
<a name="ln-10672"></a>                <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-10673"></a>                <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">DesOutHumRat</span>
<a name="ln-10674"></a>                <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-10675"></a>                <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">HumRatAcc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFlaLat</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">DOE2DXCoilHumRatResidual</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-10676"></a>                                            <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-10677"></a>              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-10678"></a>
<a name="ln-10679"></a>            <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_CoolingHXAssisted</span><span class="p">)</span>  <span class="c">! CoilSystem:Cooling:DX:HeatExchangerAssisted</span>
<a name="ln-10680"></a>
<a name="ln-10681"></a><span class="c">!               IF NoLoadHumRatOut is lower than (more dehumidification than required) or very near the DesOutHumRat,</span>
<a name="ln-10682"></a><span class="c">!               do not run the compressor</span>
<a name="ln-10683"></a>                <span class="k">IF</span> <span class="p">((</span><span class="n">NoLoadHumRatOut</span><span class="o">-</span><span class="n">DesOutHumRat</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">HumRatAcc</span><span class="o">*</span><span class="mf">2.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10684"></a><span class="k">                  </span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>  <span class="c">! keep part-load fraction from sensible calculation</span>
<a name="ln-10685"></a><span class="c">!                If the FullLoadHumRatOut is greater than (insufficient dehumidification) or very near the DesOutHumRat,</span>
<a name="ln-10686"></a><span class="c">!                run the compressor at PartLoadFrac = 1.</span>
<a name="ln-10687"></a>                <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">DesOutHumRat</span><span class="o">-</span><span class="n">FullLoadHumRatOut</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">HumRatAcc</span><span class="o">*</span><span class="mf">2.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10688"></a><span class="k">                  </span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-10689"></a><span class="c">!               ELSE find the PLR to meet the load</span>
<a name="ln-10690"></a>                <span class="k">ELSE</span>
<a name="ln-10691"></a><span class="k">                  </span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-10692"></a>                  <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">DesOutHumRat</span>
<a name="ln-10693"></a>                  <span class="c">! FirstHVACIteration is a logical, Par is REAL(r64), so make TRUE = 1 and FALSE = 0</span>
<a name="ln-10694"></a>                  <span class="k">IF</span><span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10695"></a><span class="k">                    </span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-10696"></a>                  <span class="k">ELSE</span>
<a name="ln-10697"></a><span class="k">                    </span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10698"></a>                  <span class="k">END IF</span>
<a name="ln-10699"></a><span class="k">                  IF</span><span class="p">(</span><span class="n">HXUnitOn</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10700"></a><span class="k">                    </span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-10701"></a>                  <span class="k">ELSE</span>
<a name="ln-10702"></a><span class="k">                    </span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10703"></a>                  <span class="k">END IF</span>
<a name="ln-10704"></a><span class="k">                  </span><span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-10705"></a>                  <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">HumRatAcc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">HXAssistedCoolCoilHRResidual</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-10706"></a>                                        <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-10707"></a>                  <span class="k">IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10708"></a>
<a name="ln-10709"></a><span class="c">!                   RegulaFalsi may not find latent PLR when the latent degradation model is used.</span>
<a name="ln-10710"></a><span class="c">!                   IF iteration limit is exceeded, find tighter boundary of solution and repeat RegulaFalsi</span>
<a name="ln-10711"></a>                    <span class="n">TempMaxPLR</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.1d0</span>
<a name="ln-10712"></a>                    <span class="n">TempOutletHumRatDXCoil</span> <span class="o">=</span> <span class="n">OutletHumRatDXCoil</span>
<a name="ln-10713"></a>                    <span class="k">DO WHILE</span><span class="p">((</span><span class="n">OutletHumRatDXCoil</span> <span class="o">-</span> <span class="n">TempOutletHumRatDXCoil</span><span class="p">)</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">TempMaxPLR</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-10714"></a><span class="c">!                     find upper limit of LatentPLR</span>
<a name="ln-10715"></a>                      <span class="n">TempMaxPLR</span> <span class="o">=</span> <span class="n">TempMaxPLR</span> <span class="o">+</span> <span class="mf">0.1d0</span>
<a name="ln-10716"></a>                      <span class="k">CALL </span><span class="n">SimHXAssistedCoolingCoil</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">On</span><span class="p">,</span><span class="n">TempMaxPLR</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10717"></a>                                                    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10718"></a>                                                    <span class="n">HXUnitEnable</span><span class="o">=</span><span class="n">HXUnitOn</span><span class="p">,</span> <span class="n">EconomizerFlag</span><span class="o">=</span><span class="n">EconomizerFlag</span><span class="p">)</span>
<a name="ln-10719"></a>                      <span class="n">OutletHumRatDXCoil</span> <span class="o">=</span> <span class="n">HXAssistedCoilOutletHumRat</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">)</span>
<a name="ln-10720"></a>                    <span class="k">END DO</span>
<a name="ln-10721"></a><span class="k">                    </span><span class="n">TempMinPLR</span> <span class="o">=</span> <span class="n">TempMaxPLR</span>
<a name="ln-10722"></a>                    <span class="k">DO WHILE</span><span class="p">((</span><span class="n">OutletHumRatDXCoil</span> <span class="o">-</span> <span class="n">TempOutletHumRatDXCoil</span><span class="p">)</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">TempMinPLR</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-10723"></a><span class="c">!                     pull upper limit of LatentPLR DOwn to last valid limit (i.e. latent output still exceeds SystemMoisuterLoad)</span>
<a name="ln-10724"></a>                      <span class="n">TempMaxPLR</span> <span class="o">=</span> <span class="n">TempMinPLR</span>
<a name="ln-10725"></a><span class="c">!                     find minimum limit of Latent PLR</span>
<a name="ln-10726"></a>                      <span class="n">TempMinPLR</span> <span class="o">=</span> <span class="n">TempMinPLR</span> <span class="o">-</span> <span class="mf">0.01d0</span>
<a name="ln-10727"></a>                      <span class="k">CALL </span><span class="n">SimHXAssistedCoolingCoil</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">On</span><span class="p">,</span><span class="n">TempMaxPLR</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10728"></a>                                                    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10729"></a>                                                    <span class="n">HXUnitEnable</span><span class="o">=</span><span class="n">HXUnitOn</span><span class="p">,</span> <span class="n">EconomizerFlag</span><span class="o">=</span><span class="n">EconomizerFlag</span><span class="p">)</span>
<a name="ln-10730"></a>                      <span class="n">OutletHumRatDXCoil</span> <span class="o">=</span> <span class="n">HXAssistedCoilOutletHumRat</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">)</span>
<a name="ln-10731"></a>                    <span class="k">END DO</span>
<a name="ln-10732"></a><span class="c">!                   tighter boundary of solution has been found, CALL RegulaFalsi a second time</span>
<a name="ln-10733"></a>                    <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">HumRatAcc</span><span class="p">,</span><span class="n">MaxIte</span><span class="p">,</span><span class="n">SolFla</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">HXAssistedCoolCoilHRResidual</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10734"></a>                                          <span class="n">TempMinPLR</span><span class="p">,</span><span class="n">TempMaxPLR</span><span class="p">,</span><span class="n">Par</span><span class="p">)</span>
<a name="ln-10735"></a>                    <span class="k">IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10736"></a><span class="k">                      IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10737"></a><span class="k">                        IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HXAssistedCRLatPLRIter</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10738"></a><span class="k">                          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HXAssistedCRLatPLRIter</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-10739"></a>                            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HXAssistedCRLatPLRIter</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-10740"></a>                          <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10741"></a>                                                <span class="s1">&#39; - Iteration limit exceeded calculating DX unit latent&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10742"></a>                                                <span class="s1">&#39; part-load ratio for unit = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-10743"></a>                          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Estimated latent part-load ratio  = &#39;</span><span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">((</span><span class="n">ReqOutput</span><span class="o">/</span><span class="n">FullOutput</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-10744"></a>                          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Calculated latent part-load ratio = &#39;</span><span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-10745"></a>                          <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;The calculated latent part-load ratio will be used and the&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10746"></a>                                                          <span class="s1">&#39; simulation continues. Occurrence info: &#39;</span><span class="p">)</span>
<a name="ln-10747"></a>                        <span class="k">END IF</span>
<a name="ln-10748"></a><span class="k">                        CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-10749"></a>                            <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - Iteration limit exceeded calculating&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10750"></a>                            <span class="s1">&#39; latent part-load ratio error continues. Latent PLR statistics follow.&#39;</span> <span class="p">&amp;</span>
<a name="ln-10751"></a>                            <span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HXAssistedCRLatPLRIterIndex</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-10752"></a>                      <span class="k">END IF</span>
<a name="ln-10753"></a>
<a name="ln-10754"></a><span class="k">                    </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10755"></a>
<a name="ln-10756"></a><span class="k">                      </span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="n">ReqOutput</span><span class="o">/</span><span class="n">FullOutput</span>
<a name="ln-10757"></a>                      <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10758"></a><span class="k">                        IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HXAssistedCRLatPLRFail</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10759"></a><span class="k">                          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HXAssistedCRLatPLRFail</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-10760"></a>                            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HXAssistedCRLatPLRFail</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-10761"></a>                          <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10762"></a>                                         <span class="s1">&#39; - DX unit latent part-load ratio calculation failed unexpectedly:&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10763"></a>                                         <span class="s1">&#39; part-load ratio limits exceeded, for unit = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-10764"></a>                          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Estimated part-load ratio = &#39;</span><span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-10765"></a>                          <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;The estimated part-load ratio will be used and the simulation&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10766"></a>                                                          <span class="s1">&#39; continues. Occurrence info: &#39;</span><span class="p">)</span>
<a name="ln-10767"></a>                        <span class="k">END IF</span>
<a name="ln-10768"></a><span class="k">                        CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-10769"></a>                            <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - DX unit latent part-load ratio calculation&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10770"></a>                            <span class="s1">&#39; failed unexpectedly error continues. Latent PLR statistics follow.&#39;</span> <span class="p">&amp;</span>
<a name="ln-10771"></a>                            <span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HXAssistedCRLatPLRFailIndex</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-10772"></a>                      <span class="k">END IF</span>
<a name="ln-10773"></a><span class="k">                    END IF</span>
<a name="ln-10774"></a><span class="k">                  </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10775"></a><span class="k">                    </span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="n">ReqOutput</span><span class="o">/</span><span class="n">FullOutput</span>
<a name="ln-10776"></a>                    <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10777"></a><span class="k">                      IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HXAssistedCRLatPLRFail2</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10778"></a><span class="k">                        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HXAssistedCRLatPLRFail2</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-10779"></a>                          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HXAssistedCRLatPLRFail2</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-10780"></a>                        <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10781"></a>                                            <span class="s1">&#39; - DX unit latent part-load ratio calculation failed: part-load &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10782"></a>                                             <span class="s1">&#39;ratio limits exceeded, for unit = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-10783"></a>                        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Estimated part-load ratio = &#39;</span><span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-10784"></a>                        <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;The estimated part-load ratio will be used and the simulation&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10785"></a>                                                        <span class="s1">&#39; continues. Occurrence info: &#39;</span><span class="p">)</span>
<a name="ln-10786"></a>                      <span class="k">END IF</span>
<a name="ln-10787"></a><span class="k">                      CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-10788"></a>                          <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - DX unit latent part-load ratio calculation&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10789"></a>                          <span class="s1">&#39; failed error continues. Latent PLR statistics follow.&#39;</span> <span class="p">&amp;</span>
<a name="ln-10790"></a>                          <span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HXAssistedCRLatPLRFailIndex2</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-10791"></a>                    <span class="k">END IF</span>
<a name="ln-10792"></a><span class="k">                  END IF</span>
<a name="ln-10793"></a><span class="k">                END IF</span>
<a name="ln-10794"></a><span class="k">              </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-10795"></a>
<a name="ln-10796"></a>            <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_CoolingTwoSpeed</span><span class="p">)</span>
<a name="ln-10797"></a>
<a name="ln-10798"></a><span class="c">!               Simulate MultiSpeed DX coil at sensible result</span>
<a name="ln-10799"></a>                <span class="k">CALL </span><span class="n">SimDXCoilMultiSpeed</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="n">CycRatio</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">)</span>
<a name="ln-10800"></a>
<a name="ln-10801"></a>                <span class="n">OutletHumRatDXCoil</span> <span class="o">=</span> <span class="n">DXCoilOutletHumRat</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">)</span>
<a name="ln-10802"></a>                <span class="c">! IF humidity setpoint is not satisfied and humidity control type is CoolReheat,</span>
<a name="ln-10803"></a>                <span class="c">! then overcool to meet moisture load</span>
<a name="ln-10804"></a>
<a name="ln-10805"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">OutletHumRatDXCoil</span> <span class="o">&gt;</span> <span class="n">DesOutHumRat</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10806"></a>
<a name="ln-10807"></a><span class="k">                  </span><span class="n">CycRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10808"></a>                  <span class="n">SpeedRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10809"></a>
<a name="ln-10810"></a>                  <span class="k">CALL </span><span class="n">SimDXCoilMultiSpeed</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">)</span>
<a name="ln-10811"></a>                  <span class="n">OutletHumRatLS</span> <span class="o">=</span> <span class="n">DXCoilOutletHumRat</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">)</span>
<a name="ln-10812"></a>                  <span class="k">IF</span> <span class="p">(</span><span class="n">OutletHumRatLS</span> <span class="o">&gt;</span> <span class="n">DesOutHumRat</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10813"></a><span class="k">                    </span><span class="n">CycRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-10814"></a>                    <span class="k">CALL </span><span class="n">SimDXCoilMultiSpeed</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">)</span>
<a name="ln-10815"></a>                    <span class="n">OutletHumRatHS</span> <span class="o">=</span> <span class="n">DXCoilOutletHumRat</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">)</span>
<a name="ln-10816"></a>                    <span class="k">IF</span> <span class="p">(</span><span class="n">OutletHumRatHS</span> <span class="o">&lt;</span> <span class="n">DesOutHumRat</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10817"></a><span class="k">                      </span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-10818"></a>                      <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">DesOutHumRat</span>
<a name="ln-10819"></a>                      <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">HumRatAcc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">SpeedRatio</span><span class="p">,</span> <span class="n">DXCoilVarSpeedHumRatResidual</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10820"></a>                                            <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-10821"></a>                    <span class="k">ELSE</span>
<a name="ln-10822"></a><span class="k">                      </span><span class="n">SpeedRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-10823"></a>                    <span class="k">END IF</span>
<a name="ln-10824"></a><span class="k">                  ELSE</span>
<a name="ln-10825"></a><span class="k">                    </span><span class="n">SpeedRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10826"></a>                    <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-10827"></a>                    <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">DesOutHumRat</span>
<a name="ln-10828"></a>                    <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">HumRatAcc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">CycRatio</span><span class="p">,</span> <span class="n">DXCoilCyclingHumRatResidual</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10829"></a>                                          <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-10830"></a>                  <span class="k">END IF</span>
<a name="ln-10831"></a>
<a name="ln-10832"></a><span class="k">                END IF</span>
<a name="ln-10833"></a>
<a name="ln-10834"></a><span class="k">            CASE</span> <span class="p">(</span><span class="n">CoilDX_MultiSpeedCooling</span><span class="p">,</span> <span class="n">Coil_CoolingAirToAirVariableSpeed</span><span class="p">,</span> <span class="n">Coil_CoolingWaterToAirHPVSEquationFit</span><span class="p">)</span>
<a name="ln-10835"></a>
<a name="ln-10836"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_MultiSpeedCooling</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10837"></a><span class="k">                  CALL </span><span class="n">SimDXCoilMultiSpeed</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="n">CycRatio</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">)</span>
<a name="ln-10838"></a>                <span class="k">ELSE</span>
<a name="ln-10839"></a><span class="k">                  CALL </span><span class="n">SimVariableSpeedCoils</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10840"></a>                                    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10841"></a>                                    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10842"></a>                                    <span class="mi">1</span><span class="p">,</span> <span class="n">CycRatio</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span> <span class="n">SpeedRatio</span><span class="p">,</span><span class="n">ReqOutput</span><span class="p">,</span><span class="n">Dummy</span> <span class="p">)</span>
<a name="ln-10843"></a>                <span class="k">END IF</span>
<a name="ln-10844"></a>
<a name="ln-10845"></a><span class="k">                </span><span class="n">OutletHumRatDXCoil</span> <span class="o">=</span> <span class="n">DXCoilOutletHumRat</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">)</span>
<a name="ln-10846"></a>                <span class="c">! IF humidity setpoint is not satisfied and humidity control type is CoolReheat,</span>
<a name="ln-10847"></a>                <span class="c">! then overcool to meet moisture load</span>
<a name="ln-10848"></a>
<a name="ln-10849"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">OutletHumRatDXCoil</span> <span class="o">&gt;</span> <span class="n">DesOutHumRat</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10850"></a>
<a name="ln-10851"></a><span class="k">                  </span><span class="n">CycRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10852"></a>                  <span class="n">SpeedRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10853"></a>
<a name="ln-10854"></a>                  <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_MultiSpeedCooling</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10855"></a><span class="k">                    CALL </span><span class="n">SimDXCoilMultiSpeed</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">)</span>
<a name="ln-10856"></a>                  <span class="k">ELSE</span>
<a name="ln-10857"></a><span class="k">                    CALL </span><span class="n">SimVariableSpeedCoils</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10858"></a>                                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10859"></a>                                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10860"></a>                                 <span class="mi">1</span><span class="p">,</span> <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span> <span class="mf">1.0d0</span><span class="p">,</span><span class="n">ReqOutput</span><span class="p">,</span><span class="n">Dummy</span> <span class="p">)</span>
<a name="ln-10861"></a>                  <span class="k">END IF</span>
<a name="ln-10862"></a>
<a name="ln-10863"></a><span class="k">                  </span><span class="n">OutletHumRatLS</span> <span class="o">=</span> <span class="n">DXCoilOutletHumRat</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">)</span>
<a name="ln-10864"></a>
<a name="ln-10865"></a>                  <span class="k">IF</span> <span class="p">(</span><span class="n">OutletHumRatLS</span> <span class="o">&gt;</span> <span class="n">DesOutHumRat</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10866"></a><span class="k">                    </span><span class="n">CycRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-10867"></a>                    <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_MultiSpeedCooling</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10868"></a><span class="k">                      CALL </span><span class="n">SimDXCoilMultiSpeed</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">)</span>
<a name="ln-10869"></a>                    <span class="k">ELSE</span>
<a name="ln-10870"></a><span class="k">                      CALL </span><span class="n">SimVariableSpeedCoils</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10871"></a>                                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10872"></a>                                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10873"></a>                                   <span class="mi">1</span><span class="p">,</span> <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span> <span class="mf">1.0d0</span><span class="p">,</span><span class="n">ReqOutput</span><span class="p">,</span><span class="n">Dummy</span> <span class="p">)</span>
<a name="ln-10874"></a>                    <span class="k">END IF</span>
<a name="ln-10875"></a><span class="k">                    </span><span class="n">OutletHumRatHS</span> <span class="o">=</span> <span class="n">DXCoilOutletHumRat</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">)</span>
<a name="ln-10876"></a>                    <span class="k">IF</span> <span class="p">(</span><span class="n">OutletHumRatHS</span> <span class="o">&lt;</span> <span class="n">DesOutHumRat</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10877"></a><span class="k">                      </span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-10878"></a>                      <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">DesOutHumRat</span>
<a name="ln-10879"></a>                      <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">ReqOutput</span>
<a name="ln-10880"></a>                      <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">HumRatAcc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">SpeedRatio</span><span class="p">,</span> <span class="n">DXCoilVarSpeedHumRatResidual</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-10881"></a>                                                <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-10882"></a>                    <span class="k">ELSE</span>
<a name="ln-10883"></a><span class="k">                      </span><span class="n">SpeedRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-10884"></a>                    <span class="k">END IF</span>
<a name="ln-10885"></a><span class="k">                  ELSE</span>
<a name="ln-10886"></a><span class="k">                    </span><span class="n">SpeedRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10887"></a>                    <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-10888"></a>                    <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">DesOutHumRat</span>
<a name="ln-10889"></a>                    <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">ReqOutput</span>
<a name="ln-10890"></a>                      <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">HumRatAcc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">CycRatio</span><span class="p">,</span> <span class="n">DXCoilCyclingHumRatResidual</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-10891"></a>                                                <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-10892"></a>                  <span class="k">END IF</span>
<a name="ln-10893"></a>
<a name="ln-10894"></a><span class="k">                END IF</span>
<a name="ln-10895"></a>
<a name="ln-10896"></a><span class="k">            CASE</span> <span class="p">(</span><span class="n">CoilDX_CoolingTwoStageWHumControl</span><span class="p">)</span> <span class="c">! Coil:Cooling:DX:TwoStageWithHumidityControlMode</span>
<a name="ln-10897"></a>
<a name="ln-10898"></a>                <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-10899"></a>                <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">DesOutHumRat</span>
<a name="ln-10900"></a>                <span class="c">! dehumidification mode = 0 for normal mode, 1+ for enhanced mode</span>
<a name="ln-10901"></a>                <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">DehumidMode</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-10902"></a>                <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-10903"></a>                <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFlaLat</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">MultiModeDXCoilHumRatResidual</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-10904"></a>                                            <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-10905"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-10906"></a>
<a name="ln-10907"></a>            <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_CoolingWater</span><span class="p">,</span> <span class="n">Coil_CoolingWaterDetailed</span><span class="p">)</span>  <span class="c">! COIL:COOLING:WATER</span>
<a name="ln-10908"></a>
<a name="ln-10909"></a>                <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-10910"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10911"></a><span class="k">                </span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-10912"></a>                <span class="k">ELSE</span>
<a name="ln-10913"></a><span class="k">                </span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10914"></a>                <span class="k">END IF</span>
<a name="ln-10915"></a><span class="k">                </span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">DesOutHumRat</span>
<a name="ln-10916"></a>
<a name="ln-10917"></a>                <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">HumRatAcc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFlaLat</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">CoolWaterHumRatResidual</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-10918"></a>                                            <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-10919"></a>
<a name="ln-10920"></a>            <span class="k">CASE</span><span class="p">(</span><span class="n">Coil_CoolingWaterToAirHPSimple</span><span class="p">,</span> <span class="n">Coil_CoolingWaterToAirHP</span><span class="p">)</span>
<a name="ln-10921"></a>
<a name="ln-10922"></a>                <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-10923"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10924"></a><span class="k">                  </span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-10925"></a>                <span class="k">ELSE</span>
<a name="ln-10926"></a><span class="k">                  </span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10927"></a>                <span class="k">END IF</span>
<a name="ln-10928"></a><span class="k">                </span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">DesOutHumRat</span>
<a name="ln-10929"></a>                <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">ReqOutput</span>
<a name="ln-10930"></a>
<a name="ln-10931"></a>                <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">HumRatAcc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFlaLat</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">CoolWatertoAirHPHumRatResidual</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-10932"></a>                                                <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-10933"></a>
<a name="ln-10934"></a>              <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-10935"></a>
<a name="ln-10936"></a>            <span class="k">END SELECT</span>
<a name="ln-10937"></a><span class="k">        END IF</span>
<a name="ln-10938"></a><span class="k">      END IF</span>
<a name="ln-10939"></a><span class="k">    END IF</span>
<a name="ln-10940"></a><span class="k">  END IF</span>
<a name="ln-10941"></a>
<a name="ln-10942"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10943"></a><span class="k">    IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10944"></a><span class="k">      IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SensPLRIter</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10945"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SensPLRIter</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SensPLRIter</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-10946"></a>        <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10947"></a>                                <span class="s1">&#39; - Iteration limit exceeded calculating &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10948"></a>                                <span class="s1">&#39;part-load ratio for unit = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-10949"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Estimated part-load ratio  = &#39;</span><span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">((</span><span class="n">ReqOutput</span><span class="o">/</span><span class="n">FullOutput</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-10950"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Calculated part-load ratio = &#39;</span><span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-10951"></a>        <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;The calculated part-load ratio will be used and the simulation&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10952"></a>                                        <span class="s1">&#39; continues. Occurrence info: &#39;</span><span class="p">)</span>
<a name="ln-10953"></a>      <span class="k">ELSE</span>
<a name="ln-10954"></a><span class="k">        CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-10955"></a>            <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - Iteration limit exceeded calculating&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10956"></a>            <span class="s1">&#39; sensible part-load ratio error continues. Sensible PLR statistics follow.&#39;</span> <span class="p">&amp;</span>
<a name="ln-10957"></a>            <span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SensPLRIterIndex</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-10958"></a>      <span class="k">END IF</span>
<a name="ln-10959"></a><span class="k">    END IF</span>
<a name="ln-10960"></a><span class="k">  </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10961"></a><span class="k">    </span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="n">ReqOutput</span><span class="o">/</span><span class="n">FullOutput</span>
<a name="ln-10962"></a>    <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10963"></a><span class="k">      IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SensPLRFail</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10964"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SensPLRFail</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SensPLRFail</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-10965"></a>        <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; - sensible part-&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10966"></a>                        <span class="s1">&#39;load ratio calculation failed: part-load ratio limits exceeded, for unit = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10967"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-10968"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Estimated part-load ratio = &#39;</span><span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-10969"></a>        <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;The estimated part-load ratio will be used and the simulation&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10970"></a>                                        <span class="s1">&#39; continues. Occurrence info: &#39;</span><span class="p">)</span>
<a name="ln-10971"></a>      <span class="k">ELSE</span>
<a name="ln-10972"></a><span class="k">        CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-10973"></a>            <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - sensible part-load ratio calculation&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10974"></a>            <span class="s1">&#39; failed error continues. Sensible PLR statistics follow.&#39;</span> <span class="p">&amp;</span>
<a name="ln-10975"></a>            <span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SensPLRFailIndex</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-10976"></a>      <span class="k">END IF</span>
<a name="ln-10977"></a><span class="k">    END IF</span>
<a name="ln-10978"></a><span class="k">  END IF</span>
<a name="ln-10979"></a>
<a name="ln-10980"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">SolFlaLat</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SolFla</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10981"></a><span class="k">    IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10982"></a><span class="k">      IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">LatPLRIter</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10983"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">LatPLRIter</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">LatPLRIter</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-10984"></a>        <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10985"></a>                                <span class="s1">&#39; - Iteration limit exceeded calculating latent part-load&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10986"></a>                                <span class="s1">&#39; ratio for unit = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-10987"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Estimated part-load ratio   = &#39;</span><span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">((</span><span class="n">ReqOutput</span><span class="o">/</span><span class="n">FullOutput</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-10988"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Calculated part-load ratio = &#39;</span><span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-10989"></a>        <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;The calculated part-load ratio will be used and the simulation&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10990"></a>                                        <span class="s1">&#39; continues. Occurrence info: &#39;</span><span class="p">)</span>
<a name="ln-10991"></a>      <span class="k">END IF</span>
<a name="ln-10992"></a><span class="k">        CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-10993"></a>            <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - Iteration limit exceeded calculating&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10994"></a>            <span class="s1">&#39; latent part-load ratio error continues. Latent PLR statistics follow.&#39;</span> <span class="p">&amp;</span>
<a name="ln-10995"></a>            <span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">LatPLRIterIndex</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-10996"></a>    <span class="k">END IF</span>
<a name="ln-10997"></a><span class="k">  </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SolFlaLat</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SolFla</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10998"></a><span class="c">!               RegulaFalsi returns PLR = minPLR when a solution cannot be found, recalculate PartLoadFrac.</span>
<a name="ln-10999"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NoLoadHumRatOut</span><span class="o">-</span><span class="n">FullLoadHumRatOut</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-11000"></a><span class="k">        </span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="p">(</span><span class="n">NoLoadHumRatOut</span><span class="o">-</span><span class="n">DesOutHumRat</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">NoLoadHumRatOut</span><span class="o">-</span><span class="n">FullLoadHumRatOut</span><span class="p">)</span>
<a name="ln-11001"></a>    <span class="k">ELSE</span>
<a name="ln-11002"></a><span class="k">        </span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-11003"></a>    <span class="k">END IF</span>
<a name="ln-11004"></a><span class="k">    IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-11005"></a><span class="k">      IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">LatPLRFail</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-11006"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">LatPLRFail</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">LatPLRFail</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-11007"></a>        <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; - latent part-&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11008"></a>                        <span class="s1">&#39;load ratio calculation failed: part-load ratio limits exceeded, for unit = &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-11009"></a>                        <span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-11010"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Estimated part-load ratio = &#39;</span><span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-11011"></a>        <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;The estimated part-load ratio will be used and the simulation&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11012"></a>                                        <span class="s1">&#39; continues. Occurrence info: &#39;</span><span class="p">)</span>
<a name="ln-11013"></a>      <span class="k">END IF</span>
<a name="ln-11014"></a><span class="k">        CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-11015"></a>            <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - latent part-load ratio calculation&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11016"></a>            <span class="s1">&#39; failed error continues. Latent PLR statistics follow.&#39;</span> <span class="p">&amp;</span>
<a name="ln-11017"></a>            <span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">LatPLRFailIndex</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-11018"></a>    <span class="k">END IF</span>
<a name="ln-11019"></a><span class="k">  END IF</span>
<a name="ln-11020"></a>  <span class="c">!Set the final results</span>
<a name="ln-11021"></a>
<a name="ln-11022"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">PartLoadFrac</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11023"></a><span class="k">    </span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-11024"></a>  <span class="n">ELSEIF</span><span class="p">(</span><span class="n">PartLoadFrac</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11025"></a><span class="k">    </span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11026"></a>  <span class="k">END IF</span>
<a name="ln-11027"></a>
<a name="ln-11028"></a><span class="k">  </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingPartLoadFrac</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-11029"></a>  <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span> <span class="o">=</span> <span class="n">SpeedRatio</span>
<a name="ln-11030"></a>  <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCycRatio</span> <span class="o">=</span> <span class="n">CycRatio</span>
<a name="ln-11031"></a>  <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">dehumidificationMode</span> <span class="o">=</span> <span class="n">DehumidMode</span>
<a name="ln-11032"></a>
<a name="ln-11033"></a>  <span class="n">LoopDXCoilRTF</span>      <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">LoopDXCoilRTF</span><span class="p">,</span> <span class="n">LoopDXCoilMaxRTFSave</span><span class="p">)</span>
<a name="ln-11034"></a>
<a name="ln-11035"></a><span class="k">RETURN</span>
<a name="ln-11036"></a><span class="k">END SUBROUTINE </span><span class="n">ControlCoolingSystem</span>
<a name="ln-11037"></a>
<a name="ln-11038"></a><span class="k">SUBROUTINE </span><span class="n">ControlHeatingSystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-11039"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-11040"></a>          <span class="c">!       AUTHOR         Richard Raustad, FSEC</span>
<a name="ln-11041"></a>          <span class="c">!       DATE WRITTEN   February 2013</span>
<a name="ln-11042"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-11043"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-11044"></a>
<a name="ln-11045"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-11046"></a>          <span class="c">!  Simulate the coil object at the required PLR.</span>
<a name="ln-11047"></a>
<a name="ln-11048"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-11049"></a>          <span class="c">!  Calculate operating PLR and adjust speed when using multispeed coils.</span>
<a name="ln-11050"></a>
<a name="ln-11051"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-11052"></a>          <span class="c">!  na</span>
<a name="ln-11053"></a>
<a name="ln-11054"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-11055"></a>  <span class="k">USE </span><span class="n">Psychrometrics</span> <span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">PsyHFnTdbW</span><span class="p">,</span> <span class="n">PsyTdpFnWPb</span>
<a name="ln-11056"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">SolveRegulaFalsi</span><span class="p">,</span> <span class="n">RoundSigDigits</span>
<a name="ln-11057"></a>  <span class="k">USE </span><span class="n">DXCoils</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimDXCoil</span><span class="p">,</span> <span class="n">SimDXCoilMultiSpeed</span><span class="p">,</span> <span class="n">DXCoilOutletTemp</span><span class="p">,</span> <span class="n">DXCoilOutletHumRat</span>
<a name="ln-11058"></a>  <span class="k">USE </span><span class="n">HeatingCoils</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateHeatingCoilComponents</span>
<a name="ln-11059"></a>  <span class="k">USE </span><span class="n">DataAirLoop</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">LoopHeatingCoilMaxRTF</span><span class="p">,</span> <span class="n">LoopDXCoilRTF</span>
<a name="ln-11060"></a>  <span class="k">USE </span><span class="n">WaterCoils</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateWaterCoilComponents</span>
<a name="ln-11061"></a>  <span class="k">USE </span><span class="n">SteamCoils</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateSteamCoilComponents</span>
<a name="ln-11062"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">SetComponentFlowRate</span>
<a name="ln-11063"></a>  <span class="k">USE </span><span class="n">WatertoAirHeatPumpSimple</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimWatertoAirHPSimple</span>
<a name="ln-11064"></a>  <span class="k">USE </span><span class="n">WatertoAirHeatPump</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimWaterToAirHP</span>
<a name="ln-11065"></a>  <span class="k">USE </span><span class="n">VariableSpeedCoils</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimVariableSpeedCoils</span><span class="p">,</span> <span class="n">VarSpeedCoil</span>
<a name="ln-11066"></a>
<a name="ln-11067"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-11068"></a>
<a name="ln-11069"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-11070"></a>  <span class="kt">INTEGER</span><span class="p">,</span>  <span class="k">INTENT</span><span class="p">(</span><span class="n">In</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">UnitarySysNum</span>             <span class="c">! index to Unitary System</span>
<a name="ln-11071"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>  <span class="k">INTENT</span><span class="p">(</span><span class="n">In</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FirstHVACIteration</span>        <span class="c">! First HVAC iteration flag</span>
<a name="ln-11072"></a>
<a name="ln-11073"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-11074"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span>   <span class="kd">::</span> <span class="n">MaxIte</span>    <span class="o">=</span> <span class="mi">500</span>     <span class="c">! Maximum number of iterations for solver</span>
<a name="ln-11075"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Acc</span>       <span class="o">=</span> <span class="mf">1.0d-3</span>   <span class="c">! Accuracy of solver result</span>
<a name="ln-11076"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HumRatAcc</span> <span class="o">=</span> <span class="mf">1.0d-6</span>   <span class="c">! Accuracy of solver result</span>
<a name="ln-11077"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">PARAMETER</span>   <span class="kd">::</span> <span class="n">SuppHeatingCoilFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-11078"></a>
<a name="ln-11079"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-11080"></a>          <span class="c">!  na</span>
<a name="ln-11081"></a>
<a name="ln-11082"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-11083"></a>          <span class="c">!  na</span>
<a name="ln-11084"></a>
<a name="ln-11085"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-11086"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CompName</span>  <span class="c">! Name of the heating coil</span>
<a name="ln-11087"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">CompIndex</span>           <span class="c">! Index to the heating coil</span>
<a name="ln-11088"></a><span class="c">!  REAL(r64)           :: NoOutput            ! Sensible capacity (outlet - inlet) when the compressor is off</span>
<a name="ln-11089"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">FullOutput</span>          <span class="c">! Sensible capacity (outlet - inlet) when the compressor is on</span>
<a name="ln-11090"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">ReqOutput</span>           <span class="c">! Sensible capacity (outlet - inlet) required to meet load or set point temperature</span>
<a name="ln-11091"></a>  <span class="kt">Integer</span>             <span class="kd">::</span> <span class="n">InletNode</span>           <span class="c">! Inlet node number of the DX cooling coil</span>
<a name="ln-11092"></a>  <span class="kt">Integer</span>             <span class="kd">::</span> <span class="n">OutletNode</span>          <span class="c">! Outlet node number of the DX cooling coil</span>
<a name="ln-11093"></a>  <span class="kt">Integer</span>             <span class="kd">::</span> <span class="n">ControlNode</span>         <span class="c">! The node number where a set point is placed to control the DX cooling coil</span>
<a name="ln-11094"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">PartLoadFrac</span>        <span class="c">! The part-load fraction of the compressor</span>
<a name="ln-11095"></a>
<a name="ln-11096"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">SpeedRatio</span>          <span class="c">! SpeedRatio = (CompressorSpeed - CompressorSpeedMin) /</span>
<a name="ln-11097"></a>                                             <span class="c">!              (CompressorSpeedMax - CompressorSpeedMin)</span>
<a name="ln-11098"></a>                                             <span class="c">! for variable speed or 2 speed compressors</span>
<a name="ln-11099"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">SpeedNum</span>
<a name="ln-11100"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">CycRatio</span>            <span class="c">! Cycling part-load ratio for variable speed or 2 speed compressors</span>
<a name="ln-11101"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">DesOutTemp</span>          <span class="c">! Desired outlet temperature of the DX cooling coil</span>
<a name="ln-11102"></a>
<a name="ln-11103"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">SolFla</span>              <span class="c">! Flag of solver, num iterations if &gt;0, else error index</span>
<a name="ln-11104"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Par</span>                 <span class="c">! Parameter array passed to solver</span>
<a name="ln-11105"></a>  <span class="kt">LOGICAL</span>             <span class="kd">::</span> <span class="n">SensibleLoad</span>        <span class="c">! True if there is a sensible cooling load on this system</span>
<a name="ln-11106"></a>  <span class="kt">LOGICAL</span>             <span class="kd">::</span> <span class="n">LatentLoad</span>          <span class="c">! True if there is a latent   cooling load on this system</span>
<a name="ln-11107"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">FanOpMode</span>           <span class="c">! Supply air fan operating mode</span>
<a name="ln-11108"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">LoopHeatingCoilMaxRTFSave</span> <span class="c">! Used to find RTF of heating coils without overwriting globabl variable</span>
<a name="ln-11109"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">LoopDXCoilMaxRTFSave</span> <span class="c">! Used to find RTF of DX heating coils without overwriting globabl variable</span>
<a name="ln-11110"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">dummy</span>               <span class="c">! dummy variable for heating latent demand</span>
<a name="ln-11111"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">WSHPRuntimeFrac</span>            <span class="c">! Run time fraction of water to air hp</span>
<a name="ln-11112"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">OutdoorDryBulb</span>     <span class="c">! local variable for OutDryBulbTemp</span>
<a name="ln-11113"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">OutdoorHumRat</span>      <span class="c">! local variable for OutHumRat</span>
<a name="ln-11114"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">OutdoorPressure</span>    <span class="c">! local variable for OutBaroPress</span>
<a name="ln-11115"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">OutdoorWetBulb</span>     <span class="c">! local variable for OutWetBulbTemp</span>
<a name="ln-11116"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">OutletTemp</span>
<a name="ln-11117"></a>
<a name="ln-11118"></a>      <span class="c">! Set local variables</span>
<a name="ln-11119"></a>      <span class="c">! Retrieve the load on the controlled zone</span>
<a name="ln-11120"></a>  <span class="n">InletNode</span>    <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilInletNodeNum</span>
<a name="ln-11121"></a>  <span class="n">OutletNode</span>   <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilOutletNodeNum</span>
<a name="ln-11122"></a>  <span class="n">ControlNode</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SystemHeatControlNodeNum</span>
<a name="ln-11123"></a>  <span class="n">DesOutTemp</span>   <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesiredOutletTemp</span>
<a name="ln-11124"></a>  <span class="n">LoopHeatingCoilMaxRTFSave</span><span class="o">=</span><span class="n">LoopHeatingCoilMaxRTF</span>
<a name="ln-11125"></a>  <span class="n">LoopHeatingCoilMaxRTF</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11126"></a>  <span class="n">LoopDXCoilMaxRTFSave</span><span class="o">=</span><span class="n">LoopDXCoilRTF</span>
<a name="ln-11127"></a>  <span class="n">LoopDXCoilRTF</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-11128"></a>
<a name="ln-11129"></a>  <span class="n">CompName</span>     <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilName</span>
<a name="ln-11130"></a>  <span class="n">CompIndex</span>    <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span>
<a name="ln-11131"></a>  <span class="n">FanOpMode</span>    <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span>
<a name="ln-11132"></a>
<a name="ln-11133"></a>  <span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11134"></a>  <span class="n">SpeedRatio</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11135"></a>  <span class="n">CycRatio</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11136"></a>  <span class="n">Dummy</span>        <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11137"></a>  <span class="n">SolFla</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11138"></a>  <span class="n">SensibleLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-11139"></a>  <span class="n">LatentLoad</span>   <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-11140"></a>
<a name="ln-11141"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CondenserNodeNum</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11142"></a><span class="k">    </span><span class="n">OutdoorDryBulb</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CondenserNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-11143"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CondenserType</span> <span class="o">==</span> <span class="n">WaterCooled</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-11144"></a><span class="k">      </span><span class="n">OutdoorHumRat</span>   <span class="o">=</span> <span class="n">OutHumRat</span>
<a name="ln-11145"></a>      <span class="n">OutdoorPressure</span> <span class="o">=</span> <span class="n">OutBaroPress</span>
<a name="ln-11146"></a>      <span class="n">OutdoorWetBulb</span>  <span class="o">=</span> <span class="n">OutWetBulbTemp</span>
<a name="ln-11147"></a>    <span class="k">ELSE</span>
<a name="ln-11148"></a><span class="k">      </span><span class="n">OutdoorPressure</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CondenserNodeNum</span><span class="p">)%</span><span class="n">Press</span>
<a name="ln-11149"></a>      <span class="c">! IF node is not connected to anything, pressure = default, use weather data</span>
<a name="ln-11150"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">OutdoorPressure</span> <span class="o">==</span> <span class="n">DefaultNodeValues</span><span class="p">%</span><span class="n">Press</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-11151"></a><span class="k">        </span><span class="n">OutdoorDryBulb</span>  <span class="o">=</span> <span class="n">OutDryBulbTemp</span>
<a name="ln-11152"></a>        <span class="n">OutdoorHumRat</span>   <span class="o">=</span> <span class="n">OutHumRat</span>
<a name="ln-11153"></a>        <span class="n">OutdoorPressure</span> <span class="o">=</span> <span class="n">OutBaroPress</span>
<a name="ln-11154"></a>        <span class="n">OutdoorWetBulb</span>  <span class="o">=</span> <span class="n">OutWetBulbTemp</span>
<a name="ln-11155"></a>      <span class="k">ELSE</span>
<a name="ln-11156"></a><span class="k">        </span><span class="n">OutdoorHumRat</span>   <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CondenserNodeNum</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-11157"></a>  <span class="c">!     this should use Node%WetBulbTemp or a PSYC function, not OAWB</span>
<a name="ln-11158"></a>        <span class="n">OutdoorWetBulb</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CondenserNodeNum</span><span class="p">)%</span><span class="n">OutAirWetBulb</span>
<a name="ln-11159"></a>      <span class="k">END IF</span>
<a name="ln-11160"></a><span class="k">    END IF</span>
<a name="ln-11161"></a><span class="k">  ELSE</span>
<a name="ln-11162"></a><span class="k">    </span><span class="n">OutdoorDryBulb</span>  <span class="o">=</span> <span class="n">OutDryBulbTemp</span>
<a name="ln-11163"></a>    <span class="n">OutdoorHumRat</span>   <span class="o">=</span> <span class="n">OutHumRat</span>
<a name="ln-11164"></a>    <span class="n">OutdoorPressure</span> <span class="o">=</span> <span class="n">OutBaroPress</span>
<a name="ln-11165"></a>    <span class="n">OutdoorWetBulb</span>  <span class="o">=</span> <span class="n">OutWetBulbTemp</span>
<a name="ln-11166"></a>  <span class="k">END IF</span>
<a name="ln-11167"></a>
<a name="ln-11168"></a>  <span class="c">! IF DXHeatingSystem is scheduled on and there is flow</span>
<a name="ln-11169"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SysAvailSchedPtr</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-11170"></a>      <span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilAvailSchPtr</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-11171"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">MinAirMassFlow</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingPartLoadFrac</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11172"></a>
<a name="ln-11173"></a>    <span class="c">! Determine if there is a sensible load on this system</span>
<a name="ln-11174"></a><span class="c">!    IF((Node(InletNode)%Temp &lt; Node(ControlNode)%TempSetPoint) .AND. &amp;</span>
<a name="ln-11175"></a>    <span class="k">IF</span><span class="p">((</span><span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">&lt;</span> <span class="n">DesOutTemp</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-11176"></a>       <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">-</span> <span class="n">DesOutTemp</span><span class="p">)</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">TempControlTol</span><span class="p">)</span> <span class="p">)</span> <span class="n">SensibleLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-11177"></a>
<a name="ln-11178"></a>
<a name="ln-11179"></a>    <span class="c">! IF DXHeatingSystem runs with a heating load then set PartLoadFrac on Heating System</span>
<a name="ln-11180"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SensibleLoad</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11181"></a>
<a name="ln-11182"></a><span class="k">      </span><span class="n">ReqOutput</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-11183"></a>                      <span class="p">(</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesiredOutletTemp</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">)</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-11184"></a>                       <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">))</span>
<a name="ln-11185"></a>
<a name="ln-11186"></a>      <span class="c">! Get no load result</span>
<a name="ln-11187"></a>      <span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11188"></a>      <span class="n">WSHPRuntimeFrac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11189"></a>
<a name="ln-11190"></a>      <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span><span class="p">)</span>
<a name="ln-11191"></a>
<a name="ln-11192"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_HeatingEmpirical</span><span class="p">)</span>  <span class="c">! Coil:Heating:DX:SingleSpeed</span>
<a name="ln-11193"></a>
<a name="ln-11194"></a>          <span class="k">CALL </span><span class="n">SimDXCoil</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">On</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">)</span>
<a name="ln-11195"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-11196"></a>
<a name="ln-11197"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_MultiSpeedHeating</span><span class="p">,</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span><span class="p">,</span> <span class="n">Coil_HeatingWaterToAirHPVSEquationFit</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11198"></a>              <span class="n">Coil_HeatingElectric_MultiStage</span><span class="p">,</span> <span class="n">Coil_HeatingGas_MultiStage</span><span class="p">)</span>
<a name="ln-11199"></a>
<a name="ln-11200"></a>          <span class="k">CALL </span><span class="n">SimMultiSpeedCoils</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">SensibleLoad</span><span class="p">,</span> <span class="n">LatentLoad</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11201"></a>                                  <span class="n">HeatingCoil</span><span class="p">)</span>
<a name="ln-11202"></a>
<a name="ln-11203"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_HeatingGas</span><span class="p">,</span><span class="n">Coil_HeatingElectric</span><span class="p">,</span><span class="n">Coil_HeatingDesuperheater</span> <span class="p">)</span>
<a name="ln-11204"></a>
<a name="ln-11205"></a>          <span class="k">CALL </span><span class="n">SimulateHeatingCoilComponents</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11206"></a>                                <span class="n">CompIndex</span><span class="o">=</span><span class="n">CompIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11207"></a>                                <span class="n">FanOpMode</span><span class="o">=</span><span class="n">FanOpMode</span><span class="p">,</span> <span class="n">QCoilReq</span> <span class="o">=</span> <span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-11208"></a>
<a name="ln-11209"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_HeatingWater</span><span class="p">)</span>
<a name="ln-11210"></a>
<a name="ln-11211"></a>          <span class="k">CALL </span><span class="n">SimWaterCoils</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">HeatingCoil</span><span class="p">)</span>
<a name="ln-11212"></a>
<a name="ln-11213"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_HeatingSteam</span><span class="p">)</span>
<a name="ln-11214"></a>
<a name="ln-11215"></a>          <span class="k">CALL </span><span class="n">SimSteamCoils</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">HeatingCoil</span><span class="p">)</span>
<a name="ln-11216"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-11217"></a>                     <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilFluidOutletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-11218"></a>                              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span><span class="p">)</span>
<a name="ln-11219"></a>
<a name="ln-11220"></a>        <span class="k">CASE</span><span class="p">(</span><span class="n">Coil_HeatingWaterToAirHPSimple</span><span class="p">)</span>
<a name="ln-11221"></a>
<a name="ln-11222"></a>          <span class="k">CALL </span><span class="n">SimWatertoAirHPSimple</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span> <span class="n">ReqOutput</span><span class="p">,</span> <span class="n">Dummy</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11223"></a>                                     <span class="n">FanOpMode</span><span class="p">,</span><span class="n">WSHPRuntimeFrac</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11224"></a>                                     <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11225"></a>                                     <span class="mi">0</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-11226"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-11227"></a>
<a name="ln-11228"></a>        <span class="k">CASE</span><span class="p">(</span><span class="n">Coil_HeatingWaterToAirHP</span><span class="p">)</span>
<a name="ln-11229"></a>
<a name="ln-11230"></a>          <span class="k">CALL </span><span class="n">SimWatertoAirHP</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11231"></a>                                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirMassFlow</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11232"></a>                                 <span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">WSHPRuntimeFrac</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11233"></a>                                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11234"></a>                                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">InitHeatPump</span><span class="p">,</span> <span class="n">ReqOutput</span><span class="p">,</span><span class="n">Dummy</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-11235"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-11236"></a>
<a name="ln-11237"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-11238"></a>
<a name="ln-11239"></a>      <span class="k">END SELECT</span>
<a name="ln-11240"></a>
<a name="ln-11241"></a><span class="c">!     IF outlet temp at no load is within ACC of set point, do not run the coil</span>
<a name="ln-11242"></a>      <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="o">-</span><span class="n">DesOutTemp</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">Acc</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-11243"></a>       <span class="c">! do nothing, coil is at the set point.</span>
<a name="ln-11244"></a>      <span class="k">ELSE IF</span> <span class="p">((</span><span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="o">-</span><span class="n">DesOutTemp</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">Acc</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! IF outlet temp is above set point turn off coil</span>
<a name="ln-11245"></a>        <span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11246"></a>      <span class="k">ELSE</span> <span class="c">! ELSE get full load result</span>
<a name="ln-11247"></a>
<a name="ln-11248"></a>        <span class="c">! Get full load result</span>
<a name="ln-11249"></a>        <span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-11250"></a>        <span class="n">WSHPRuntimeFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-11251"></a>
<a name="ln-11252"></a>        <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span><span class="p">)</span>
<a name="ln-11253"></a>
<a name="ln-11254"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_HeatingEmpirical</span><span class="p">)</span>  <span class="c">! Coil:Heating:DX:SingleSpeed</span>
<a name="ln-11255"></a>
<a name="ln-11256"></a>            <span class="k">CALL </span><span class="n">SimDXCoil</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">On</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">)</span>
<a name="ln-11257"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-11258"></a>
<a name="ln-11259"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_MultiSpeedHeating</span><span class="p">,</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span><span class="p">,</span> <span class="n">Coil_HeatingWaterToAirHPVSEquationFit</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11260"></a>                <span class="n">Coil_HeatingElectric_MultiStage</span><span class="p">,</span> <span class="n">Coil_HeatingGas_MultiStage</span><span class="p">)</span>
<a name="ln-11261"></a>
<a name="ln-11262"></a>            <span class="n">CycRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-11263"></a>            <span class="k">DO </span><span class="n">SpeedNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span>
<a name="ln-11264"></a>              <span class="k">CALL </span><span class="n">SimMultiSpeedCoils</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">SensibleLoad</span><span class="p">,</span> <span class="n">LatentLoad</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11265"></a>                                      <span class="n">HeatingCoil</span><span class="p">,</span> <span class="n">SpeedNum</span><span class="p">)</span>
<a name="ln-11266"></a>              <span class="n">OutletTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-11267"></a>              <span class="n">SpeedRatio</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.0d0</span>
<a name="ln-11268"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">OutletTemp</span> <span class="o">&gt;</span> <span class="n">DesOutTemp</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SensibleLoad</span><span class="p">)</span> <span class="k">EXIT</span>
<a name="ln-11269"></a><span class="k">            END DO</span>
<a name="ln-11270"></a>
<a name="ln-11271"></a><span class="k">          CASE</span> <span class="p">(</span><span class="n">Coil_HeatingGas</span><span class="p">,</span><span class="n">Coil_HeatingElectric</span><span class="p">)</span>
<a name="ln-11272"></a>
<a name="ln-11273"></a>            <span class="k">CALL </span><span class="n">SimulateHeatingCoilComponents</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11274"></a>                                <span class="n">CompIndex</span><span class="o">=</span><span class="n">CompIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11275"></a>                                <span class="n">FanOpMode</span><span class="o">=</span><span class="n">FanOpMode</span><span class="p">,</span> <span class="n">QCoilReq</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span><span class="p">)</span>
<a name="ln-11276"></a>
<a name="ln-11277"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_HeatingDesuperheater</span> <span class="p">)</span>
<a name="ln-11278"></a>
<a name="ln-11279"></a>              <span class="k">CALL </span><span class="n">SimulateHeatingCoilComponents</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11280"></a>                                <span class="n">CompIndex</span><span class="o">=</span><span class="n">CompIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11281"></a>                                <span class="n">FanOpMode</span><span class="o">=</span><span class="n">FanOpMode</span><span class="p">,</span> <span class="n">QCoilReq</span> <span class="o">=</span> <span class="n">ReqOutput</span><span class="p">)</span>
<a name="ln-11282"></a>
<a name="ln-11283"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_HeatingWater</span><span class="p">)</span>
<a name="ln-11284"></a>
<a name="ln-11285"></a>            <span class="k">CALL </span><span class="n">SimWaterCoils</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">HeatingCoil</span><span class="p">)</span>
<a name="ln-11286"></a>
<a name="ln-11287"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_HeatingSteam</span><span class="p">)</span>
<a name="ln-11288"></a>
<a name="ln-11289"></a>            <span class="k">CALL </span><span class="n">SimSteamCoils</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">HeatingCoil</span><span class="p">)</span>
<a name="ln-11290"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-11291"></a>                     <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilFluidOutletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-11292"></a>                              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span><span class="p">)</span>
<a name="ln-11293"></a>
<a name="ln-11294"></a>
<a name="ln-11295"></a>          <span class="k">CASE</span><span class="p">(</span><span class="n">Coil_HeatingWaterToAirHPSimple</span><span class="p">)</span>
<a name="ln-11296"></a>
<a name="ln-11297"></a>            <span class="k">CALL </span><span class="n">SimWatertoAirHPSimple</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span> <span class="n">ReqOutput</span><span class="p">,</span> <span class="n">Dummy</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11298"></a>                                     <span class="n">FanOpMode</span><span class="p">,</span><span class="n">WSHPRuntimeFrac</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11299"></a>                                     <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11300"></a>                                     <span class="mi">0</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-11301"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-11302"></a>
<a name="ln-11303"></a>          <span class="k">CASE</span><span class="p">(</span><span class="n">Coil_HeatingWaterToAirHP</span><span class="p">)</span>
<a name="ln-11304"></a>            <span class="k">CALL </span><span class="n">SimWatertoAirHP</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11305"></a>                                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirMassFlow</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11306"></a>                                 <span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">WSHPRuntimeFrac</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11307"></a>                                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11308"></a>                                 <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">InitHeatPump</span><span class="p">,</span> <span class="n">ReqOutput</span><span class="p">,</span><span class="n">Dummy</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-11309"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-11310"></a>
<a name="ln-11311"></a>
<a name="ln-11312"></a>          <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-11313"></a>
<a name="ln-11314"></a>        <span class="k">END SELECT</span>
<a name="ln-11315"></a>
<a name="ln-11316"></a><span class="k">        </span><span class="n">FullOutput</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-11317"></a>                       <span class="p">(</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-11318"></a>                        <span class="o">-</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">))</span>
<a name="ln-11319"></a>
<a name="ln-11320"></a><span class="c">!       If the outlet temp is within ACC of set point,</span>
<a name="ln-11321"></a>        <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="o">-</span><span class="n">DesOutTemp</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">Acc</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-11322"></a>          <span class="c">! do nothing, coil is at set point</span>
<a name="ln-11323"></a>        <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="p">(</span><span class="n">DesOutTemp</span><span class="o">-</span><span class="n">Acc</span><span class="p">))</span> <span class="k">THEN</span> <span class="c">! IF outlet temp is below set point coil must be on</span>
<a name="ln-11324"></a>          <span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-11325"></a>        <span class="k">ELSE</span>  <span class="c">! ELSE find the PLR to meet the set point</span>
<a name="ln-11326"></a>
<a name="ln-11327"></a>          <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span><span class="p">)</span>
<a name="ln-11328"></a>
<a name="ln-11329"></a>            <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_HeatingEmpirical</span><span class="p">)</span>  <span class="c">! Coil:Heating:DX:SingleSpeed</span>
<a name="ln-11330"></a>
<a name="ln-11331"></a>              <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-11332"></a>              <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">DesOutTemp</span>
<a name="ln-11333"></a>              <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>  <span class="c">!OnOffAirFlowFrac assume = 1.0 for continuous fan dx system</span>
<a name="ln-11334"></a>              <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span> <span class="c">! this does nothing since set point based control requires constant fan</span>
<a name="ln-11335"></a>              <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">DXHeatingCoilResidual</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-11336"></a>                                            <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-11337"></a>              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-11338"></a>
<a name="ln-11339"></a>            <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_MultiSpeedHeating</span><span class="p">,</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span><span class="p">,</span> <span class="n">Coil_HeatingWaterToAirHPVSEquationFit</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11340"></a>                  <span class="n">Coil_HeatingElectric_MultiStage</span><span class="p">,</span> <span class="n">Coil_HeatingGas_MultiStage</span><span class="p">)</span>
<a name="ln-11341"></a>
<a name="ln-11342"></a>              <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-11343"></a>              <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">DesOutTemp</span>
<a name="ln-11344"></a>              <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">UnitarySysNum</span>
<a name="ln-11345"></a>              <span class="c">! Par(4) = CycRatio or SpeedRatio</span>
<a name="ln-11346"></a>              <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedNum</span>
<a name="ln-11347"></a>              <span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! UnitarySystem(UnitarySysNum)%FanOpMode</span>
<a name="ln-11348"></a>              <span class="n">Par</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! UnitarySystem(UnitarySysNum)%CompOp</span>
<a name="ln-11349"></a>              <span class="n">Par</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">=</span> <span class="n">ReqOutput</span> <span class="c">! UnitarySystem(UnitarySysNum)%FanOpMode</span>
<a name="ln-11350"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">SpeedRatio</span> <span class="o">==</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11351"></a><span class="k">                </span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">CycRatio</span>
<a name="ln-11352"></a>                <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">SpeedRatio</span><span class="p">,</span> <span class="n">HeatingCoilVarSpeedResidual</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-11353"></a>                                                <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-11354"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCycRatio</span> <span class="o">=</span> <span class="n">CycRatio</span>
<a name="ln-11355"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span> <span class="o">=</span> <span class="n">SpeedRatio</span>
<a name="ln-11356"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingPartLoadFrac</span> <span class="o">=</span> <span class="n">SpeedRatio</span>
<a name="ln-11357"></a>                <span class="k">CALL </span><span class="n">CalcPassiveSystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-11358"></a>                <span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="n">SpeedRatio</span>
<a name="ln-11359"></a>              <span class="k">ELSE</span>
<a name="ln-11360"></a><span class="k">                </span><span class="n">SpeedRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11361"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span> <span class="o">=</span> <span class="n">SpeedRatio</span>
<a name="ln-11362"></a>                <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">SpeedRatio</span>
<a name="ln-11363"></a>                <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">CycRatio</span><span class="p">,</span> <span class="n">HeatingCoilVarSpeedCycResidual</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-11364"></a>                                                <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-11365"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCycRatio</span> <span class="o">=</span> <span class="n">CycRatio</span>
<a name="ln-11366"></a>                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingPartLoadFrac</span> <span class="o">=</span> <span class="n">CycRatio</span>
<a name="ln-11367"></a>                <span class="k">CALL </span><span class="n">CalcPassiveSystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-11368"></a>                <span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="n">CycRatio</span>
<a name="ln-11369"></a>              <span class="k">END IF</span>
<a name="ln-11370"></a>
<a name="ln-11371"></a><span class="k">            CASE</span> <span class="p">(</span><span class="n">Coil_HeatingGas</span><span class="p">,</span><span class="n">Coil_HeatingElectric</span><span class="p">,</span> <span class="n">Coil_HeatingDesuperheater</span><span class="p">)</span>
<a name="ln-11372"></a>
<a name="ln-11373"></a>              <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-11374"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11375"></a><span class="k">                </span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-11376"></a>              <span class="k">ELSE</span>
<a name="ln-11377"></a><span class="k">                </span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11378"></a>              <span class="k">END IF</span>
<a name="ln-11379"></a><span class="k">              </span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">DesOutTemp</span>
<a name="ln-11380"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">SuppHeatingCoilFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11381"></a><span class="k">                </span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-11382"></a>              <span class="k">ELSE</span>
<a name="ln-11383"></a><span class="k">                </span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11384"></a>              <span class="k">END IF</span>
<a name="ln-11385"></a><span class="k">              </span><span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">FanOpMode</span>
<a name="ln-11386"></a>              <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">GasElecHeatingCoilResidual</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-11387"></a>                                                <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-11388"></a>
<a name="ln-11389"></a>            <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_HeatingWater</span><span class="p">)</span>
<a name="ln-11390"></a>
<a name="ln-11391"></a>              <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-11392"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11393"></a><span class="k">                </span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-11394"></a>              <span class="k">ELSE</span>
<a name="ln-11395"></a><span class="k">                </span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11396"></a>              <span class="k">END IF</span>
<a name="ln-11397"></a><span class="k">              </span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">DesOutTemp</span>
<a name="ln-11398"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">SuppHeatingCoilFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11399"></a><span class="k">                </span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-11400"></a>              <span class="k">ELSE</span>
<a name="ln-11401"></a><span class="k">                </span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11402"></a>              <span class="k">END IF</span>
<a name="ln-11403"></a><span class="k">              </span><span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11404"></a>              <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">HotWaterHeatingCoilResidual</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-11405"></a>                                                <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-11406"></a>
<a name="ln-11407"></a>            <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_HeatingSteam</span><span class="p">)</span>
<a name="ln-11408"></a>
<a name="ln-11409"></a>              <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-11410"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11411"></a><span class="k">                </span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-11412"></a>              <span class="k">ELSE</span>
<a name="ln-11413"></a><span class="k">                </span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11414"></a>              <span class="k">END IF</span>
<a name="ln-11415"></a><span class="k">              </span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">DesOutTemp</span>
<a name="ln-11416"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">SuppHeatingCoilFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11417"></a><span class="k">                </span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-11418"></a>              <span class="k">ELSE</span>
<a name="ln-11419"></a><span class="k">                </span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11420"></a>              <span class="k">END IF</span>
<a name="ln-11421"></a>
<a name="ln-11422"></a><span class="k">              CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">SteamHeatingCoilResidual</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-11423"></a>                                                <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-11424"></a>
<a name="ln-11425"></a>            <span class="k">CASE</span><span class="p">(</span><span class="n">Coil_HeatingWaterToAirHPSimple</span><span class="p">,</span> <span class="n">Coil_HeatingWaterToAirHP</span><span class="p">)</span>
<a name="ln-11426"></a>
<a name="ln-11427"></a>              <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-11428"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11429"></a><span class="k">                </span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-11430"></a>              <span class="k">ELSE</span>
<a name="ln-11431"></a><span class="k">                </span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11432"></a>              <span class="k">END IF</span>
<a name="ln-11433"></a><span class="k">              </span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">DesOutTemp</span>
<a name="ln-11434"></a>              <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">ReqOutput</span>
<a name="ln-11435"></a>
<a name="ln-11436"></a>              <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">HeatWatertoAirHPTempResidual</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-11437"></a>                                            <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-11438"></a>
<a name="ln-11439"></a>            <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-11440"></a>              <span class="k">CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39; For :&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11441"></a>                                       <span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-11442"></a>              <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;ControlHeatingSystem: Invalid heating coil type = &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-11443"></a>                                  <span class="nb">TRIM</span><span class="p">(</span><span class="n">CALLCoilTypes</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span><span class="p">)))</span>
<a name="ln-11444"></a>
<a name="ln-11445"></a>          <span class="k">END SELECT</span>
<a name="ln-11446"></a><span class="k">        END IF</span>
<a name="ln-11447"></a><span class="k">      END IF</span>
<a name="ln-11448"></a><span class="k">    END IF</span>
<a name="ln-11449"></a><span class="k">  END IF</span>
<a name="ln-11450"></a>
<a name="ln-11451"></a><span class="k">  IF</span><span class="p">(</span><span class="n">PartLoadFrac</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11452"></a><span class="k">    </span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-11453"></a>  <span class="n">ELSEIF</span><span class="p">(</span><span class="n">PartLoadFrac</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11454"></a><span class="k">    </span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11455"></a>  <span class="k">END IF</span>
<a name="ln-11456"></a>
<a name="ln-11457"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11458"></a><span class="k">    IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-11459"></a><span class="k">      IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilSensPLRIter</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-11460"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilSensPLRIter</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilSensPLRIter</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-11461"></a>        <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11462"></a>                                <span class="s1">&#39; - Iteration limit exceeded calculating sensible &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11463"></a>                                <span class="s1">&#39;part-load ratio for unit = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-11464"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Estimated part-load ratio  = &#39;</span><span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">((</span><span class="n">ReqOutput</span><span class="o">/</span><span class="n">FullOutput</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-11465"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Calculated part-load ratio = &#39;</span><span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-11466"></a>        <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;The calculated part-load ratio will be used and the simulation&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11467"></a>                                        <span class="s1">&#39; continues. Occurrence info: &#39;</span><span class="p">)</span>
<a name="ln-11468"></a>      <span class="k">ELSE</span>
<a name="ln-11469"></a><span class="k">        CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-11470"></a>            <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - Iteration limit exceeded calculating&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11471"></a>            <span class="s1">&#39; sensible part-load ratio error continues. Sensible PLR statistics follow.&#39;</span> <span class="p">&amp;</span>
<a name="ln-11472"></a>            <span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilSensPLRIterIndex</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-11473"></a>      <span class="k">END IF</span>
<a name="ln-11474"></a><span class="k">    END IF</span>
<a name="ln-11475"></a><span class="k">  </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11476"></a><span class="k">    </span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="n">ReqOutput</span><span class="o">/</span><span class="n">FullOutput</span>
<a name="ln-11477"></a>    <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-11478"></a><span class="k">      IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilSensPLRFail</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-11479"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilSensPLRFail</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilSensPLRFail</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-11480"></a>        <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; - sensible part-&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11481"></a>                        <span class="s1">&#39;load ratio calculation failed: part-load ratio limits exceeded, for unit = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11482"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-11483"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Estimated part-load ratio = &#39;</span><span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-11484"></a>        <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;The estimated part-load ratio will be used and the simulation&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11485"></a>                                        <span class="s1">&#39; continues. Occurrence info: &#39;</span><span class="p">)</span>
<a name="ln-11486"></a>      <span class="k">ELSE</span>
<a name="ln-11487"></a><span class="k">        CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-11488"></a>            <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - sensible part-load ratio calculation&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11489"></a>            <span class="s1">&#39; failed error continues. Sensible PLR statistics follow.&#39;</span> <span class="p">&amp;</span>
<a name="ln-11490"></a>            <span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilSensPLRFailIndex</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-11491"></a>      <span class="k">END IF</span>
<a name="ln-11492"></a><span class="k">    END IF</span>
<a name="ln-11493"></a><span class="k">  END IF</span>
<a name="ln-11494"></a>
<a name="ln-11495"></a>  <span class="c">!Set the final results</span>
<a name="ln-11496"></a>  <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingPartLoadFrac</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-11497"></a>  <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span> <span class="o">=</span> <span class="n">SpeedRatio</span>
<a name="ln-11498"></a>  <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCycRatio</span> <span class="o">=</span> <span class="n">CycRatio</span>
<a name="ln-11499"></a>
<a name="ln-11500"></a>  <span class="n">LoopHeatingCoilMaxRTF</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">LoopHeatingCoilMaxRTF</span><span class="p">,</span> <span class="n">LoopHeatingCoilMaxRTFSave</span><span class="p">)</span>
<a name="ln-11501"></a>  <span class="n">LoopDXCoilRTF</span>      <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">LoopDXCoilRTF</span><span class="p">,</span> <span class="n">LoopDXCoilMaxRTFSave</span><span class="p">)</span>
<a name="ln-11502"></a>
<a name="ln-11503"></a><span class="k">RETURN</span>
<a name="ln-11504"></a><span class="k">END SUBROUTINE </span><span class="n">ControlHeatingSystem</span>
<a name="ln-11505"></a>
<a name="ln-11506"></a><span class="k">SUBROUTINE </span><span class="n">ControlSuppHeatSystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span> <span class="p">)</span>
<a name="ln-11507"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-11508"></a>          <span class="c">!       AUTHOR         Richard Raustad, FSEC</span>
<a name="ln-11509"></a>          <span class="c">!       DATE WRITTEN   February 2013</span>
<a name="ln-11510"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-11511"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-11512"></a>
<a name="ln-11513"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-11514"></a>          <span class="c">!  This subroutine updates the System outlet nodes.</span>
<a name="ln-11515"></a>
<a name="ln-11516"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-11517"></a>          <span class="c">!  Data is moved from the System data structure to the System outlet nodes.</span>
<a name="ln-11518"></a>
<a name="ln-11519"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-11520"></a>          <span class="c">!  na</span>
<a name="ln-11521"></a>
<a name="ln-11522"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-11523"></a>  <span class="k">USE </span><span class="n">DataAirLoop</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">LoopHeatingCoilMaxRTF</span><span class="p">,</span> <span class="n">LoopDXCoilRTF</span>
<a name="ln-11524"></a>  <span class="k">USE </span><span class="n">Psychrometrics</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">PsyHFnTdbW</span><span class="p">,</span> <span class="n">PsyTdpFnWPb</span>
<a name="ln-11525"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">SolveRegulaFalsi</span><span class="p">,</span> <span class="n">RoundSigDigits</span>
<a name="ln-11526"></a>  <span class="k">USE </span><span class="n">HeatingCoils</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateHeatingCoilComponents</span>
<a name="ln-11527"></a>  <span class="k">USE </span><span class="n">WaterCoils</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateWaterCoilComponents</span>
<a name="ln-11528"></a>  <span class="k">USE </span><span class="n">SteamCoils</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateSteamCoilComponents</span>
<a name="ln-11529"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">SetComponentFlowRate</span>
<a name="ln-11530"></a>
<a name="ln-11531"></a>
<a name="ln-11532"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-11533"></a>
<a name="ln-11534"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-11535"></a>  <span class="kt">INTEGER</span><span class="p">,</span>  <span class="k">INTENT</span><span class="p">(</span><span class="n">In</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">UnitarySysNum</span>           <span class="c">! index to Unitary System</span>
<a name="ln-11536"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>  <span class="k">INTENT</span><span class="p">(</span><span class="n">In</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FirstHVACIteration</span>      <span class="c">! First HVAC iteration flag</span>
<a name="ln-11537"></a>
<a name="ln-11538"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-11539"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span>   <span class="kd">::</span> <span class="n">MaxIte</span>    <span class="o">=</span> <span class="mi">500</span>     <span class="c">! Maximum number of iterations for solver</span>
<a name="ln-11540"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Acc</span>       <span class="o">=</span> <span class="mf">1.0d-3</span>  <span class="c">! Accuracy of solver result</span>
<a name="ln-11541"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HumRatAcc</span> <span class="o">=</span> <span class="mf">1.0d-6</span>  <span class="c">! Accuracy of solver result</span>
<a name="ln-11542"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span>   <span class="kd">::</span> <span class="n">SolveMaxIter</span><span class="o">=</span><span class="mi">50</span>
<a name="ln-11543"></a>
<a name="ln-11544"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-11545"></a>          <span class="c">!  na</span>
<a name="ln-11546"></a>
<a name="ln-11547"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-11548"></a>          <span class="c">!  na</span>
<a name="ln-11549"></a>
<a name="ln-11550"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-11551"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CompName</span>  <span class="c">! Name of the heating coil</span>
<a name="ln-11552"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">CompIndex</span>           <span class="c">! Index to the heating coil</span>
<a name="ln-11553"></a><span class="c">!  REAL(r64)           :: NoOutput            ! Sensible capacity (outlet - inlet) when the compressor is off</span>
<a name="ln-11554"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">FullOutput</span>          <span class="c">! Sensible capacity (outlet - inlet) when the compressor is on</span>
<a name="ln-11555"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">ReqOutput</span>           <span class="c">! Sensible capacity (outlet - inlet) required to meet load or set point temperature</span>
<a name="ln-11556"></a>  <span class="kt">Integer</span>             <span class="kd">::</span> <span class="n">InletNode</span>           <span class="c">! Inlet node number of the DX cooling coil</span>
<a name="ln-11557"></a>  <span class="kt">Integer</span>             <span class="kd">::</span> <span class="n">OutletNode</span>          <span class="c">! Outlet node number of the DX cooling coil</span>
<a name="ln-11558"></a>  <span class="kt">Integer</span>             <span class="kd">::</span> <span class="n">ControlNode</span>         <span class="c">! The node number where a set point is placed to control the DX cooling coil</span>
<a name="ln-11559"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">PartLoadFrac</span>        <span class="c">! The part-load fraction of the compressor</span>
<a name="ln-11560"></a>
<a name="ln-11561"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">DesOutTemp</span>          <span class="c">! Desired outlet temperature of the DX cooling coil</span>
<a name="ln-11562"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">QCoilActual</span>         <span class="c">! Heating coil operating capacity [W]</span>
<a name="ln-11563"></a>
<a name="ln-11564"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">SolFla</span>              <span class="c">! Flag of solver, num iterations if &gt;0, else error index</span>
<a name="ln-11565"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Par</span>            <span class="c">! Parameter array passed to solver</span>
<a name="ln-11566"></a>  <span class="kt">LOGICAL</span>             <span class="kd">::</span> <span class="n">SensibleLoad</span>        <span class="c">! True if there is a sensible cooling load on this system</span>
<a name="ln-11567"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">FanOpMode</span>           <span class="c">! Supply air fan operating mode</span>
<a name="ln-11568"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">LoopHeatingCoilMaxRTFSave</span> <span class="c">! Used to find RTF of heating coils without overwriting globabl variable</span>
<a name="ln-11569"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">LoopDXCoilMaxRTFSave</span> <span class="c">! Used to find RTF of DX heating coils without overwriting globabl variable</span>
<a name="ln-11570"></a>  <span class="kt">LOGICAL</span>             <span class="kd">::</span> <span class="n">SuppHeatingCoilFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-11571"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">NoLoadTempOut</span>       <span class="c">! save outlet temp when coil is off (C)</span>
<a name="ln-11572"></a>
<a name="ln-11573"></a>      <span class="c">! Set local variables</span>
<a name="ln-11574"></a>      <span class="c">! Retrieve the load on the controlled zone</span>
<a name="ln-11575"></a>
<a name="ln-11576"></a>  <span class="n">OutletNode</span>   <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilAirOutletNode</span>
<a name="ln-11577"></a>  <span class="n">InletNode</span>    <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilAirInletNode</span>
<a name="ln-11578"></a>  <span class="n">ControlNode</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilAirOutletNode</span>
<a name="ln-11579"></a>  <span class="n">DesOutTemp</span>   <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesiredOutletTemp</span>
<a name="ln-11580"></a>  <span class="n">CompName</span>     <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span>
<a name="ln-11581"></a>  <span class="n">CompIndex</span>    <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span>
<a name="ln-11582"></a>  <span class="n">FanOpMode</span>    <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span>
<a name="ln-11583"></a>  <span class="n">SolFla</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11584"></a>
<a name="ln-11585"></a>  <span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11586"></a>
<a name="ln-11587"></a>  <span class="n">SensibleLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-11588"></a>
<a name="ln-11589"></a>  <span class="n">LoopHeatingCoilMaxRTFSave</span><span class="o">=</span><span class="n">LoopHeatingCoilMaxRTF</span>
<a name="ln-11590"></a>  <span class="n">LoopHeatingCoilMaxRTF</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11591"></a>  <span class="n">LoopDXCoilMaxRTFSave</span><span class="o">=</span><span class="n">LoopDXCoilRTF</span>
<a name="ln-11592"></a>  <span class="n">LoopDXCoilRTF</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-11593"></a>
<a name="ln-11594"></a>  <span class="k">IF</span><span class="p">((</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SysAvailSchedPtr</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-11595"></a>     <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">MinAirMassFlow</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-11596"></a>
<a name="ln-11597"></a>    <span class="c">! Determine if there is a sensible load on this system</span>
<a name="ln-11598"></a>    <span class="k">IF</span><span class="p">((</span><span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">&lt;</span> <span class="n">DesOutTemp</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-11599"></a>       <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">-</span> <span class="n">DesOutTemp</span><span class="p">)</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">TempControlTol</span><span class="p">)</span> <span class="p">)</span> <span class="n">SensibleLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-11600"></a>
<a name="ln-11601"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SensibleLoad</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11602"></a>
<a name="ln-11603"></a><span class="k">      </span><span class="n">ReqOutput</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-11604"></a>                       <span class="p">(</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesiredOutletTemp</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">)</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-11605"></a>                        <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">))</span>
<a name="ln-11606"></a>
<a name="ln-11607"></a>      <span class="c">! Get no load result</span>
<a name="ln-11608"></a>      <span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11609"></a>
<a name="ln-11610"></a>      <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType_Num</span><span class="p">)</span>
<a name="ln-11611"></a>
<a name="ln-11612"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_HeatingGas</span><span class="p">,</span><span class="n">Coil_HeatingElectric</span><span class="p">,</span><span class="n">Coil_HeatingDesuperheater</span> <span class="p">)</span>
<a name="ln-11613"></a>          <span class="k">CALL </span><span class="n">SimulateHeatingCoilComponents</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11614"></a>                                <span class="n">CompIndex</span><span class="o">=</span><span class="n">CompIndex</span><span class="p">,</span> <span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! QCoilReq= 0.0d0,  &amp;</span>
<a name="ln-11615"></a>                                <span class="n">SuppHeat</span><span class="o">=</span><span class="n">SuppHeatingCoilFlag</span><span class="p">,</span><span class="n">FanOpMode</span><span class="o">=</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">QCoilActual</span><span class="o">=</span><span class="n">QCoilActual</span><span class="p">)</span>
<a name="ln-11616"></a>          <span class="n">PartLoadFrac</span><span class="o">=</span><span class="n">QCoilActual</span><span class="o">/</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span>
<a name="ln-11617"></a>
<a name="ln-11618"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_HeatingWater</span><span class="p">)</span>
<a name="ln-11619"></a>
<a name="ln-11620"></a>          <span class="k">CALL </span><span class="n">SimWaterCoils</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">SuppHeatCoil</span><span class="p">)</span>
<a name="ln-11621"></a>
<a name="ln-11622"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_HeatingSteam</span><span class="p">)</span>
<a name="ln-11623"></a>
<a name="ln-11624"></a>          <span class="k">CALL </span><span class="n">SimSteamCoils</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">SuppHeatCoil</span><span class="p">)</span>
<a name="ln-11625"></a>
<a name="ln-11626"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-11627"></a>
<a name="ln-11628"></a>      <span class="k">END SELECT</span>
<a name="ln-11629"></a>
<a name="ln-11630"></a>
<a name="ln-11631"></a><span class="k">      </span><span class="n">NoLoadTempOut</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-11632"></a><span class="c">!      NoOutput = Node(InletNode)%MassFlowRate *  &amp;</span>
<a name="ln-11633"></a><span class="c">!                       (PsyHFnTdbW(NoLoadTempOut,Node(OutletNode)%HumRat)  &amp;</span>
<a name="ln-11634"></a><span class="c">!                        - PsyHFnTdbW(Node(InletNode)%Temp,Node(OutletNode)%HumRat))</span>
<a name="ln-11635"></a>
<a name="ln-11636"></a><span class="c">!     If OutletTemp is within ACC of set point, either coil operated or is not needed</span>
<a name="ln-11637"></a>      <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="o">-</span><span class="n">DesOutTemp</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">Acc</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-11638"></a>        <span class="c">! do nothing, coil is at set point (i.e., gas/elec/steam coil will try to hit set point</span>
<a name="ln-11639"></a>      <span class="k">ELSE IF</span><span class="p">(</span><span class="n">PartLoadFrac</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-11640"></a>        <span class="c">! do nothing, coil tried to hit set point (i.e., gas/elec/steam coil tried to hit set point but missed</span>
<a name="ln-11641"></a>      <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">NoLoadTempOut</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="p">(</span><span class="n">DesOutTemp</span> <span class="o">-</span> <span class="n">Acc</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-11642"></a><span class="k">        </span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! outlet temp &gt; set point, coil is not needed</span>
<a name="ln-11643"></a>      <span class="k">ELSE</span> <span class="c">! outlet temp too low, turn on coil</span>
<a name="ln-11644"></a>
<a name="ln-11645"></a>        <span class="c">! Get full load result</span>
<a name="ln-11646"></a>        <span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-11647"></a>
<a name="ln-11648"></a>        <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType_Num</span><span class="p">)</span>
<a name="ln-11649"></a>
<a name="ln-11650"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_HeatingGas</span><span class="p">,</span><span class="n">Coil_HeatingElectric</span><span class="p">)</span>
<a name="ln-11651"></a>
<a name="ln-11652"></a>            <span class="k">CALL </span><span class="n">SimulateHeatingCoilComponents</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11653"></a><span class="c">!                                  CompIndex=CompIndex, QCoilReq= UnitarySystem(UnitarySysNum)%DesignSuppHeatingCapacity,  &amp;</span>
<a name="ln-11654"></a>                                  <span class="n">CompIndex</span><span class="o">=</span><span class="n">CompIndex</span><span class="p">,</span> <span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11655"></a>                                  <span class="n">SuppHeat</span><span class="o">=</span><span class="n">SuppHeatingCoilFlag</span><span class="p">,</span> <span class="n">FanOpMode</span><span class="o">=</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">QCoilActual</span><span class="o">=</span><span class="n">QCoilActual</span><span class="p">)</span>
<a name="ln-11656"></a>            <span class="n">PartLoadFrac</span><span class="o">=</span><span class="n">QCoilActual</span><span class="o">/</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span>
<a name="ln-11657"></a>
<a name="ln-11658"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_HeatingDesuperheater</span> <span class="p">)</span>
<a name="ln-11659"></a>
<a name="ln-11660"></a>            <span class="k">CALL </span><span class="n">SimulateHeatingCoilComponents</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11661"></a>                                  <span class="n">CompIndex</span><span class="o">=</span><span class="n">CompIndex</span><span class="p">,</span> <span class="n">QCoilReq</span><span class="o">=</span> <span class="n">ReqOutput</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-11662"></a>                                  <span class="n">SuppHeat</span><span class="o">=</span><span class="n">SuppHeatingCoilFlag</span><span class="p">,</span> <span class="n">FanOpMode</span><span class="o">=</span><span class="n">FanOpMode</span><span class="p">)</span>
<a name="ln-11663"></a>
<a name="ln-11664"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_HeatingWater</span><span class="p">)</span>
<a name="ln-11665"></a>
<a name="ln-11666"></a>            <span class="k">CALL </span><span class="n">SimWaterCoils</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">SuppHeatCoil</span><span class="p">)</span>
<a name="ln-11667"></a>
<a name="ln-11668"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_HeatingSteam</span><span class="p">)</span>
<a name="ln-11669"></a>
<a name="ln-11670"></a>            <span class="k">CALL </span><span class="n">SimSteamCoils</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">SuppHeatCoil</span><span class="p">)</span>
<a name="ln-11671"></a>
<a name="ln-11672"></a>          <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-11673"></a>
<a name="ln-11674"></a>        <span class="k">END SELECT</span>
<a name="ln-11675"></a>
<a name="ln-11676"></a><span class="k">        </span><span class="n">FullOutput</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-11677"></a>                       <span class="p">(</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-11678"></a>                        <span class="o">-</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">))</span>
<a name="ln-11679"></a>
<a name="ln-11680"></a><span class="c">!         If the FullOutput outlet temp is less than (insufficient heating) or very near set point,</span>
<a name="ln-11681"></a><span class="c">!         run the coil at PartLoadFrac = 1.</span>
<a name="ln-11682"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="p">(</span><span class="n">DesOutTemp</span><span class="o">+</span><span class="n">Acc</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-11683"></a><span class="k">          </span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-11684"></a>        <span class="k">ELSE</span>
<a name="ln-11685"></a>
<a name="ln-11686"></a><span class="k">          SELECT CASE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType_Num</span><span class="p">)</span>
<a name="ln-11687"></a>
<a name="ln-11688"></a>            <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_HeatingGas</span><span class="p">,</span><span class="n">Coil_HeatingElectric</span><span class="p">,</span> <span class="n">Coil_HeatingDesuperheater</span><span class="p">)</span>
<a name="ln-11689"></a>
<a name="ln-11690"></a>              <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-11691"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11692"></a><span class="k">                </span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-11693"></a>              <span class="k">ELSE</span>
<a name="ln-11694"></a><span class="k">                </span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11695"></a>              <span class="k">END IF</span>
<a name="ln-11696"></a><span class="k">              </span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">DesOutTemp</span>
<a name="ln-11697"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">SuppHeatingCoilFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11698"></a><span class="k">                </span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-11699"></a>              <span class="k">ELSE</span>
<a name="ln-11700"></a><span class="k">                </span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11701"></a>              <span class="k">END IF</span>
<a name="ln-11702"></a><span class="k">              </span><span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">FanOpMode</span>
<a name="ln-11703"></a>              <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">GasElecHeatingCoilResidual</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-11704"></a>                                                <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-11705"></a>
<a name="ln-11706"></a>            <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_HeatingWater</span><span class="p">)</span>
<a name="ln-11707"></a>
<a name="ln-11708"></a>               <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-11709"></a>               <span class="k">IF</span> <span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11710"></a><span class="k">                 </span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-11711"></a>               <span class="k">ELSE</span>
<a name="ln-11712"></a><span class="k">                 </span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11713"></a>               <span class="k">END IF</span>
<a name="ln-11714"></a><span class="k">               </span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">DesOutTemp</span>
<a name="ln-11715"></a>               <span class="k">IF</span> <span class="p">(</span><span class="n">SuppHeatingCoilFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11716"></a><span class="k">                 </span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-11717"></a>               <span class="k">ELSE</span>
<a name="ln-11718"></a><span class="k">                 </span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11719"></a>               <span class="k">END IF</span>
<a name="ln-11720"></a><span class="k">               </span><span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-11721"></a>               <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">SolveMaxIter</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">HotWaterHeatingCoilResidual</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11722"></a>                                     <span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-11723"></a>
<a name="ln-11724"></a>            <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_HeatingSteam</span><span class="p">)</span>
<a name="ln-11725"></a>
<a name="ln-11726"></a>              <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-11727"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11728"></a><span class="k">                </span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-11729"></a>              <span class="k">ELSE</span>
<a name="ln-11730"></a><span class="k">                </span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11731"></a>              <span class="k">END IF</span>
<a name="ln-11732"></a><span class="k">              </span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">DesOutTemp</span>
<a name="ln-11733"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">SuppHeatingCoilFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11734"></a><span class="k">                </span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-11735"></a>              <span class="k">ELSE</span>
<a name="ln-11736"></a><span class="k">                </span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11737"></a>              <span class="k">END IF</span>
<a name="ln-11738"></a>
<a name="ln-11739"></a><span class="k">              CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">SteamHeatingCoilResidual</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-11740"></a>                                                <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-11741"></a>
<a name="ln-11742"></a>            <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-11743"></a>
<a name="ln-11744"></a>          <span class="k">END SELECT</span>
<a name="ln-11745"></a>
<a name="ln-11746"></a><span class="k">        END IF</span>   <span class="c">! IF ((FullOutput - ReqOutput) &lt; Acc) THEN</span>
<a name="ln-11747"></a>      <span class="k">END IF</span>     <span class="c">! IF ((NoOutput-ReqOutput) &gt; Acc) THEN</span>
<a name="ln-11748"></a>    <span class="k">END IF</span>       <span class="c">! IF (SensibleLoad ) THEN</span>
<a name="ln-11749"></a>  <span class="k">END IF</span>         <span class="c">! IF((GetCurrentScheduleValue(UnitarySystem(UnitarySysNum)%SysAvailSchedPtr) &gt; 0.0d0) .AND. &amp;</span>
<a name="ln-11750"></a>
<a name="ln-11751"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">PartLoadFrac</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11752"></a><span class="k">    </span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-11753"></a>  <span class="n">ELSEIF</span><span class="p">(</span><span class="n">PartLoadFrac</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11754"></a><span class="k">    </span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11755"></a>  <span class="k">END IF</span>
<a name="ln-11756"></a>
<a name="ln-11757"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11758"></a><span class="k">    IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-11759"></a><span class="k">      IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilSensPLRIter</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-11760"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilSensPLRIter</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilSensPLRIter</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-11761"></a>        <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11762"></a>                              <span class="s1">&#39; - Iteration limit exceeded calculating sensible &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11763"></a>                              <span class="s1">&#39;part-load ratio for unit = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-11764"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Estimated part-load ratio  = &#39;</span><span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">((</span><span class="n">ReqOutput</span><span class="o">/</span><span class="n">FullOutput</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-11765"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Calculated part-load ratio = &#39;</span><span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-11766"></a>        <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;The calculated part-load ratio will be used and the simulation&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11767"></a>                                      <span class="s1">&#39; continues. Occurrence info: &#39;</span><span class="p">)</span>
<a name="ln-11768"></a>      <span class="k">ELSE</span>
<a name="ln-11769"></a><span class="k">        CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-11770"></a>        <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - Iteration limit exceeded calculating&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11771"></a>        <span class="s1">&#39; sensible part-load ratio error continues. Sensible PLR statistics follow.&#39;</span> <span class="p">&amp;</span>
<a name="ln-11772"></a>        <span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilSensPLRIterIndex</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-11773"></a>      <span class="k">END IF</span>
<a name="ln-11774"></a><span class="k">    END IF</span>  <span class="c">! IF(.NOT. WarmupFlag)THEN</span>
<a name="ln-11775"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11776"></a><span class="k">    </span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="n">ReqOutput</span><span class="o">/</span><span class="n">FullOutput</span>
<a name="ln-11777"></a>    <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-11778"></a><span class="k">      IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilSensPLRFail</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-11779"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilSensPLRFail</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilSensPLRFail</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-11780"></a>        <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; - sensible part-&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11781"></a>                              <span class="s1">&#39;load ratio calculation failed: part-load ratio limits exceeded, for unit = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11782"></a>                              <span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-11783"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Estimated part-load ratio = &#39;</span><span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-11784"></a>        <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;The estimated part-load ratio will be used and the simulation&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11785"></a>                                        <span class="s1">&#39; continues. Occurrence info: &#39;</span><span class="p">)</span>
<a name="ln-11786"></a>      <span class="k">ELSE</span>
<a name="ln-11787"></a><span class="k">        CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-11788"></a>             <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - sensible part-load ratio calculation&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11789"></a>             <span class="s1">&#39; failed error continues. Sensible PLR statistics follow.&#39;</span> <span class="p">&amp;</span>
<a name="ln-11790"></a>             <span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilSensPLRFailIndex</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-11791"></a>      <span class="k">END IF</span>
<a name="ln-11792"></a><span class="k">    END IF</span>  <span class="c">! IF(.NOT. WarmupFlag)THEN</span>
<a name="ln-11793"></a>  <span class="k">END IF</span>  <span class="c">! IF (SolFla == -1) THEN</span>
<a name="ln-11794"></a>
<a name="ln-11795"></a>  <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatPartLoadFrac</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-11796"></a>
<a name="ln-11797"></a>  <span class="n">LoopHeatingCoilMaxRTF</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">LoopHeatingCoilMaxRTF</span><span class="p">,</span> <span class="n">LoopHeatingCoilMaxRTFSave</span><span class="p">)</span>
<a name="ln-11798"></a>  <span class="n">LoopDXCoilRTF</span>      <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">LoopDXCoilRTF</span><span class="p">,</span> <span class="n">LoopDXCoilMaxRTFSave</span><span class="p">)</span>
<a name="ln-11799"></a>
<a name="ln-11800"></a><span class="k">RETURN</span>
<a name="ln-11801"></a><span class="k">END SUBROUTINE </span><span class="n">ControlSuppHeatSystem</span>
<a name="ln-11802"></a>
<a name="ln-11803"></a><span class="k">SUBROUTINE </span><span class="n">SimWaterCoils</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">CoilType</span><span class="p">)</span>
<a name="ln-11804"></a>
<a name="ln-11805"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-11806"></a>          <span class="c">!       AUTHOR         Chandan Sharma, FSEC</span>
<a name="ln-11807"></a>          <span class="c">!       DATE WRITTEN   March 2013</span>
<a name="ln-11808"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-11809"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-11810"></a>
<a name="ln-11811"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-11812"></a>          <span class="c">! This subroutine manages water cooling/heating coil simulation.</span>
<a name="ln-11813"></a>
<a name="ln-11814"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-11815"></a>          <span class="c">! na</span>
<a name="ln-11816"></a>
<a name="ln-11817"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-11818"></a>          <span class="c">! na</span>
<a name="ln-11819"></a>
<a name="ln-11820"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-11821"></a>  <span class="k">USE </span><span class="n">WaterCoils</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateWaterCoilComponents</span>
<a name="ln-11822"></a>
<a name="ln-11823"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-11824"></a>
<a name="ln-11825"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-11826"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">UnitarySysNum</span>    <span class="c">! Index of AirloopHVAC:UnitarySystem object</span>
<a name="ln-11827"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">CoilType</span>
<a name="ln-11828"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">FirstHVACIteration</span>  <span class="c">! True when first HVAC iteration</span>
<a name="ln-11829"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">PartLoadFrac</span>
<a name="ln-11830"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-11831"></a>          <span class="c">! na</span>
<a name="ln-11832"></a>
<a name="ln-11833"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-11834"></a>          <span class="c">! na</span>
<a name="ln-11835"></a>
<a name="ln-11836"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-11837"></a>          <span class="c">! na</span>
<a name="ln-11838"></a>
<a name="ln-11839"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-11840"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CompName</span>              <span class="c">! Name of Unitary System object</span>
<a name="ln-11841"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">mdot</span>
<a name="ln-11842"></a>
<a name="ln-11843"></a> <span class="k">IF</span> <span class="p">(</span><span class="n">CoilType</span> <span class="o">==</span> <span class="n">CoolingCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11844"></a><span class="k">    </span><span class="n">CompName</span>     <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilName</span>
<a name="ln-11845"></a>
<a name="ln-11846"></a>    <span class="n">mdot</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilFluidOutletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11847"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolCoilFluidFlow</span> <span class="o">*</span> <span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-11848"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilFluidInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">mdot</span>
<a name="ln-11849"></a>
<a name="ln-11850"></a>    <span class="k">CALL </span><span class="n">SimulateWaterCoilComponents</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11851"></a>                                    <span class="n">FanOpMode</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11852"></a>                                    <span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-11853"></a>
<a name="ln-11854"></a> <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">CoilType</span> <span class="o">==</span> <span class="n">HeatingCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11855"></a><span class="k">    </span><span class="n">CompName</span>     <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilName</span>
<a name="ln-11856"></a>
<a name="ln-11857"></a>    <span class="n">mdot</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilFluidOutletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11858"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="o">*</span> <span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-11859"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilFluidInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">mdot</span>
<a name="ln-11860"></a>
<a name="ln-11861"></a>    <span class="k">CALL </span><span class="n">SimulateWaterCoilComponents</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11862"></a>                                    <span class="n">FanOpMode</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11863"></a>                                    <span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-11864"></a>
<a name="ln-11865"></a> <span class="k">ELSE</span>
<a name="ln-11866"></a><span class="k">    </span><span class="n">CompName</span>     <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span>
<a name="ln-11867"></a>
<a name="ln-11868"></a>    <span class="n">mdot</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilFluidOutletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11869"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">*</span> <span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-11870"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilFluidInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">mdot</span>
<a name="ln-11871"></a>
<a name="ln-11872"></a>    <span class="k">CALL </span><span class="n">SimulateWaterCoilComponents</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11873"></a>                                    <span class="n">FanOpMode</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11874"></a>                                    <span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-11875"></a> <span class="k">END IF</span>
<a name="ln-11876"></a>
<a name="ln-11877"></a><span class="k">END SUBROUTINE </span><span class="n">SimWaterCoils</span>
<a name="ln-11878"></a>
<a name="ln-11879"></a><span class="k">SUBROUTINE </span><span class="n">SimSteamCoils</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">CoilType</span><span class="p">)</span>
<a name="ln-11880"></a>
<a name="ln-11881"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-11882"></a>          <span class="c">!       AUTHOR         Chandan Sharma, FSEC</span>
<a name="ln-11883"></a>          <span class="c">!       DATE WRITTEN   March 2013</span>
<a name="ln-11884"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-11885"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-11886"></a>
<a name="ln-11887"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-11888"></a>          <span class="c">! This subroutine manages steam heating coil simulation.</span>
<a name="ln-11889"></a>
<a name="ln-11890"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-11891"></a>          <span class="c">! na</span>
<a name="ln-11892"></a>
<a name="ln-11893"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-11894"></a>          <span class="c">! na</span>
<a name="ln-11895"></a>
<a name="ln-11896"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-11897"></a>  <span class="k">USE </span><span class="n">SteamCoils</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateSteamCoilComponents</span>
<a name="ln-11898"></a>
<a name="ln-11899"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-11900"></a>
<a name="ln-11901"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-11902"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">UnitarySysNum</span>    <span class="c">! Index of AirloopHVAC:UnitarySystem object</span>
<a name="ln-11903"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">CoilType</span>
<a name="ln-11904"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">FirstHVACIteration</span>  <span class="c">! True when first HVAC iteration</span>
<a name="ln-11905"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">PartLoadFrac</span>
<a name="ln-11906"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-11907"></a>          <span class="c">! na</span>
<a name="ln-11908"></a>
<a name="ln-11909"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-11910"></a>          <span class="c">! na</span>
<a name="ln-11911"></a>
<a name="ln-11912"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-11913"></a>          <span class="c">! na</span>
<a name="ln-11914"></a>
<a name="ln-11915"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-11916"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CompName</span>              <span class="c">! Name of Unitary System object</span>
<a name="ln-11917"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">mdot</span>
<a name="ln-11918"></a>
<a name="ln-11919"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CoilType</span> <span class="o">==</span> <span class="n">HeatingCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11920"></a>
<a name="ln-11921"></a><span class="k">    </span><span class="n">CompName</span>     <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilName</span>
<a name="ln-11922"></a>
<a name="ln-11923"></a>    <span class="n">mdot</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilFluidOutletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11924"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="o">*</span> <span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-11925"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilFluidInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">mdot</span>
<a name="ln-11926"></a>
<a name="ln-11927"></a>    <span class="k">CALL </span><span class="n">SimulateSteamCoilComponents</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11928"></a>                                           <span class="mf">1.0d0</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">!QCoilReq, simulate any load &gt; 0 to get max capacity</span>
<a name="ln-11929"></a>                                           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11930"></a>                                           <span class="n">FanOpMode</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11931"></a>                                           <span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-11932"></a>
<a name="ln-11933"></a>  <span class="k">ELSE</span>
<a name="ln-11934"></a>
<a name="ln-11935"></a><span class="k">    </span><span class="n">CompName</span>     <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span>
<a name="ln-11936"></a>
<a name="ln-11937"></a>    <span class="n">mdot</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilFluidOutletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11938"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">*</span> <span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-11939"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilFluidInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">mdot</span>
<a name="ln-11940"></a>
<a name="ln-11941"></a>    <span class="k">CALL </span><span class="n">SimulateSteamCoilComponents</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11942"></a>                                           <span class="mf">1.0d0</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">!QCoilReq, simulate any load &gt; 0 to get max capacity</span>
<a name="ln-11943"></a>                                           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11944"></a>                                           <span class="n">FanOpMode</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11945"></a>                                           <span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-11946"></a>
<a name="ln-11947"></a>  <span class="k">END IF</span>
<a name="ln-11948"></a><span class="k">RETURN</span>
<a name="ln-11949"></a>
<a name="ln-11950"></a><span class="k">END SUBROUTINE </span><span class="n">SimSteamCoils</span>
<a name="ln-11951"></a>
<a name="ln-11952"></a><span class="k">SUBROUTINE </span><span class="n">SimMultiSpeedCoils</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">SensibleLoad</span><span class="p">,</span> <span class="n">LatentLoad</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">CoilType</span><span class="p">,</span> <span class="n">SpeedNumber</span><span class="p">)</span>
<a name="ln-11953"></a>
<a name="ln-11954"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-11955"></a>          <span class="c">!       AUTHOR         Chandan Sharma, FSEC</span>
<a name="ln-11956"></a>          <span class="c">!       DATE WRITTEN   March 2013</span>
<a name="ln-11957"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-11958"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-11959"></a>
<a name="ln-11960"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-11961"></a>          <span class="c">! This subroutine manages multispeed and variable speed cooling coil simulation.</span>
<a name="ln-11962"></a>
<a name="ln-11963"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-11964"></a>          <span class="c">! na</span>
<a name="ln-11965"></a>
<a name="ln-11966"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-11967"></a>          <span class="c">! na</span>
<a name="ln-11968"></a>
<a name="ln-11969"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-11970"></a>  <span class="k">USE </span><span class="n">DXCoils</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimDXCoilMultiSpeed</span><span class="p">,</span> <span class="n">DXCoilOutletTemp</span>
<a name="ln-11971"></a>  <span class="k">USE </span><span class="n">VariableSpeedCoils</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimVariableSpeedCoils</span>
<a name="ln-11972"></a>  <span class="k">USE </span><span class="n">HeatingCoils</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateHeatingCoilComponents</span>
<a name="ln-11973"></a>
<a name="ln-11974"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-11975"></a>
<a name="ln-11976"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-11977"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">UnitarySysNum</span>    <span class="c">! Index of AirloopHVAC:UnitarySystem object</span>
<a name="ln-11978"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">FirstHVACIteration</span>  <span class="c">! True when first HVAC iteration</span>
<a name="ln-11979"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">SensibleLoad</span>
<a name="ln-11980"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">LatentLoad</span>
<a name="ln-11981"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">CoilType</span>
<a name="ln-11982"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">PartLoadFrac</span>
<a name="ln-11983"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">OPTIONAL</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">SpeedNumber</span>
<a name="ln-11984"></a>
<a name="ln-11985"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-11986"></a>          <span class="c">! na</span>
<a name="ln-11987"></a>
<a name="ln-11988"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-11989"></a>          <span class="c">! na</span>
<a name="ln-11990"></a>
<a name="ln-11991"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-11992"></a>          <span class="c">! na</span>
<a name="ln-11993"></a>
<a name="ln-11994"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-11995"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CompName</span>              <span class="c">! Name of Unitary System object</span>
<a name="ln-11996"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">Dummy</span>
<a name="ln-11997"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">SensLoad</span>
<a name="ln-11998"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">LatLoad</span>
<a name="ln-11999"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>
<a name="ln-12000"></a>  <span class="kt">INTEGER</span>                       <span class="kd">::</span> <span class="n">CoilTypeNum</span>
<a name="ln-12001"></a>  <span class="kt">INTEGER</span>                       <span class="kd">::</span> <span class="n">SpeedNum</span>
<a name="ln-12002"></a>  <span class="kt">INTEGER</span>                       <span class="kd">::</span> <span class="n">CoilOutletNodeNum</span>
<a name="ln-12003"></a>  <span class="kt">INTEGER</span>                       <span class="kd">::</span> <span class="n">CompIndex</span>
<a name="ln-12004"></a>  <span class="kt">LOGICAL</span>                       <span class="kd">::</span> <span class="n">CoolLoad</span>
<a name="ln-12005"></a>  <span class="kt">LOGICAL</span>                       <span class="kd">::</span> <span class="n">HeatLoad</span>
<a name="ln-12006"></a>
<a name="ln-12007"></a>  <span class="n">Dummy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12008"></a>
<a name="ln-12009"></a>  <span class="k">IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">SpeedNumber</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-12010"></a><span class="k">    </span><span class="n">SpeedNum</span> <span class="o">=</span> <span class="n">SpeedNumber</span>
<a name="ln-12011"></a>  <span class="k">ELSE</span>
<a name="ln-12012"></a><span class="k">    </span><span class="n">SpeedNum</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-12013"></a>  <span class="k">END IF</span>
<a name="ln-12014"></a>
<a name="ln-12015"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">CoilType</span> <span class="o">==</span> <span class="n">CoolingCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12016"></a>
<a name="ln-12017"></a><span class="k">    </span><span class="n">CompName</span>     <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilName</span>
<a name="ln-12018"></a>    <span class="n">CompIndex</span>    <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span>
<a name="ln-12019"></a>    <span class="n">CoilTypeNum</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span>
<a name="ln-12020"></a>    <span class="n">CoilOutletNodeNum</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilOutletNodeNum</span>
<a name="ln-12021"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SensibleLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12022"></a><span class="k">      </span><span class="n">SensLoad</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0d0</span>
<a name="ln-12023"></a>      <span class="n">CoolLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-12024"></a>      <span class="n">HeatLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-12025"></a>    <span class="k">END IF</span>
<a name="ln-12026"></a><span class="k">    IF</span><span class="p">(</span><span class="n">LatentLoad</span><span class="p">)</span><span class="n">LatLoad</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0d0</span>
<a name="ln-12027"></a>
<a name="ln-12028"></a>  <span class="k">ELSE</span>
<a name="ln-12029"></a>
<a name="ln-12030"></a><span class="k">    </span><span class="n">CompName</span>     <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilName</span>
<a name="ln-12031"></a>    <span class="n">CompIndex</span>    <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span>
<a name="ln-12032"></a>    <span class="n">CoilTypeNum</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span>
<a name="ln-12033"></a>    <span class="n">CoilOutletNodeNum</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilOutletNodeNum</span>
<a name="ln-12034"></a>
<a name="ln-12035"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SensibleLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12036"></a><span class="k">      </span><span class="n">SensLoad</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-12037"></a>      <span class="n">CoolLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-12038"></a>      <span class="n">HeatLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-12039"></a>    <span class="k">ELSE</span>
<a name="ln-12040"></a><span class="k">      </span><span class="n">SensLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12041"></a>      <span class="n">HeatLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-12042"></a>    <span class="k">END IF</span>
<a name="ln-12043"></a><span class="k">    </span><span class="n">LatLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12044"></a>    <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-12045"></a>
<a name="ln-12046"></a>  <span class="k">END IF</span>
<a name="ln-12047"></a>
<a name="ln-12048"></a><span class="k">  </span><span class="n">OnOffAirFlowRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-12049"></a>  <span class="k">CALL </span><span class="n">SetOnOffMassFlowRate</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">)</span> <span class="c">!1.0d0 = PartLoadRatio</span>
<a name="ln-12050"></a>
<a name="ln-12051"></a>  <span class="k">CALL </span><span class="n">CalcPassiveSystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-12052"></a>
<a name="ln-12053"></a>  <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">CoilTypeNum</span><span class="p">)</span>
<a name="ln-12054"></a>
<a name="ln-12055"></a>    <span class="k">CASE</span><span class="p">(</span><span class="n">CoilDX_MultiSpeedCooling</span><span class="p">,</span> <span class="n">CoilDX_MultiSpeedHeating</span><span class="p">)</span>
<a name="ln-12056"></a>
<a name="ln-12057"></a>      <span class="k">CALL </span><span class="n">SimDXCoilMultiSpeed</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">CompIndex</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12058"></a>
<a name="ln-12059"></a>    <span class="k">CASE</span><span class="p">(</span><span class="n">Coil_CoolingAirToAirVariableSpeed</span><span class="p">)</span>
<a name="ln-12060"></a>
<a name="ln-12061"></a>       <span class="k">CALL </span><span class="n">SimVariableSpeedCoils</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">CompIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-12062"></a>                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-12063"></a>                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-12064"></a>                   <span class="mi">1</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilSensDemand</span><span class="p">,</span><span class="n">Dummy</span> <span class="p">)</span>
<a name="ln-12065"></a>
<a name="ln-12066"></a>    <span class="k">CASE</span><span class="p">(</span><span class="n">Coil_HeatingAirToAirVariableSpeed</span><span class="p">)</span>
<a name="ln-12067"></a>
<a name="ln-12068"></a>       <span class="k">CALL </span><span class="n">SimVariableSpeedCoils</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">CompIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-12069"></a>                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-12070"></a>                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-12071"></a>                   <span class="mi">1</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilSensDemand</span><span class="p">,</span><span class="n">Dummy</span> <span class="p">)</span>
<a name="ln-12072"></a>
<a name="ln-12073"></a>    <span class="k">CASE</span><span class="p">(</span><span class="n">Coil_CoolingWaterToAirHPVSEquationFit</span><span class="p">)</span>
<a name="ln-12074"></a>
<a name="ln-12075"></a>      <span class="k">CALL </span><span class="n">SimVariableSpeedCoils</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">CompIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-12076"></a>                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-12077"></a>                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-12078"></a>                   <span class="mi">1</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilSensDemand</span><span class="p">,</span><span class="n">Dummy</span> <span class="p">)</span>
<a name="ln-12079"></a>
<a name="ln-12080"></a>    <span class="k">CASE</span><span class="p">(</span><span class="n">Coil_HeatingWaterToAirHPVSEquationFit</span><span class="p">)</span>
<a name="ln-12081"></a>
<a name="ln-12082"></a>      <span class="k">CALL </span><span class="n">SimVariableSpeedCoils</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">CompIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-12083"></a>                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-12084"></a>                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-12085"></a>                   <span class="mi">1</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilSensDemand</span><span class="p">,</span><span class="n">Dummy</span> <span class="p">)</span>
<a name="ln-12086"></a>
<a name="ln-12087"></a>    <span class="k">CASE</span><span class="p">(</span><span class="n">Coil_HeatingElectric_MultiStage</span><span class="p">,</span> <span class="n">Coil_HeatingGas_MultiStage</span><span class="p">)</span>
<a name="ln-12088"></a>
<a name="ln-12089"></a>      <span class="k">CALL </span><span class="n">SimulateHeatingCoilComponents</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-12090"></a>                                         <span class="n">CompIndex</span>     <span class="o">=</span> <span class="n">CompIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-12091"></a>                                         <span class="n">FanOpMode</span>     <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span>      <span class="p">&amp;</span>
<a name="ln-12092"></a>                                         <span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-12093"></a>                                         <span class="n">StageNum</span>      <span class="o">=</span> <span class="n">SpeedNum</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-12094"></a>                                         <span class="n">SpeedRatio</span>    <span class="o">=</span> <span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-12095"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-12096"></a>
<a name="ln-12097"></a>  <span class="k">END SELECT</span>
<a name="ln-12098"></a>
<a name="ln-12099"></a><span class="k">  RETURN</span>
<a name="ln-12100"></a>
<a name="ln-12101"></a><span class="k">END SUBROUTINE </span><span class="n">SimMultiSpeedCoils</span>
<a name="ln-12102"></a>
<a name="ln-12103"></a><span class="k">SUBROUTINE </span><span class="n">CalcPassiveSystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-12104"></a>
<a name="ln-12105"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-12106"></a>          <span class="c">!       AUTHOR         Richard Raustad, FSEC</span>
<a name="ln-12107"></a>          <span class="c">!       DATE WRITTEN   February 2013</span>
<a name="ln-12108"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-12109"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-12110"></a>
<a name="ln-12111"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-12112"></a>          <span class="c">! This subroutine calculates the set point based output of the unitary system.</span>
<a name="ln-12113"></a>
<a name="ln-12114"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-12115"></a>          <span class="c">! na</span>
<a name="ln-12116"></a>
<a name="ln-12117"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-12118"></a>          <span class="c">! na</span>
<a name="ln-12119"></a>
<a name="ln-12120"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-12121"></a>  <span class="k">USE </span><span class="n">Fans</span><span class="p">,</span>             <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateFanComponents</span>
<a name="ln-12122"></a>
<a name="ln-12123"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-12124"></a>
<a name="ln-12125"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-12126"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">UnitarySysNum</span>       <span class="c">! Index of AirloopHVAC:UnitarySystem object</span>
<a name="ln-12127"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">FirstHVACIteration</span>  <span class="c">! True when first HVAC iteration</span>
<a name="ln-12128"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-12129"></a>          <span class="c">! na</span>
<a name="ln-12130"></a>
<a name="ln-12131"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-12132"></a>          <span class="c">! na</span>
<a name="ln-12133"></a>
<a name="ln-12134"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-12135"></a>          <span class="c">! na</span>
<a name="ln-12136"></a>
<a name="ln-12137"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-12138"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">PartLoadRatio</span>         <span class="c">! coil operating part-load ratio</span>
<a name="ln-12139"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>     <span class="c">! Setpoint based coil control does not use this variable</span>
<a name="ln-12140"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">CoilCoolHeatRat</span>       <span class="c">! ratio of cooling to heating PLR for cycling fan RH control</span>
<a name="ln-12141"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">QZnReq</span>
<a name="ln-12142"></a>  <span class="kt">INTEGER</span>                       <span class="kd">::</span> <span class="n">CompOn</span>                <span class="c">! compressor control (0=off, 1=on)</span>
<a name="ln-12143"></a>  <span class="kt">LOGICAL</span>                       <span class="kd">::</span> <span class="n">HXUnitOn</span>
<a name="ln-12144"></a>
<a name="ln-12145"></a>  <span class="n">OnOffAirFlowRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-12146"></a>  <span class="n">CoilCoolHeatRat</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-12147"></a>  <span class="n">QZnReq</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12148"></a>  <span class="c">!CALL the series of components that simulate a Unitary System</span>
<a name="ln-12149"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanExists</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">BlowThru</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12150"></a><span class="k">    CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanIndex</span><span class="p">,</span><span class="n">FanSpeedRatio</span><span class="p">)</span>
<a name="ln-12151"></a>  <span class="k">END IF</span>
<a name="ln-12152"></a>
<a name="ln-12153"></a><span class="k">  IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilUpstream</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12154"></a>
<a name="ln-12155"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12156"></a><span class="k">      </span><span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingPartLoadFrac</span>
<a name="ln-12157"></a>      <span class="n">CompOn</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-12158"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">PartLoadRatio</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="n">CompOn</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-12159"></a>      <span class="n">HXUnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-12160"></a>      <span class="k">CALL </span><span class="n">CalcUnitaryCoolingSystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-12161"></a>                                    <span class="n">CompOn</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">CoilCoolHeatRat</span><span class="p">,</span><span class="n">HXUnitOn</span><span class="p">)</span>
<a name="ln-12162"></a>    <span class="k">END IF</span>
<a name="ln-12163"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12164"></a><span class="k">      </span><span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingPartLoadFrac</span>
<a name="ln-12165"></a>      <span class="n">CompOn</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-12166"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">PartLoadRatio</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="n">CompOn</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-12167"></a>      <span class="k">CALL </span><span class="n">CalcUnitaryHeatingSystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">CompOn</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">)</span>
<a name="ln-12168"></a>    <span class="k">END IF</span>
<a name="ln-12169"></a>
<a name="ln-12170"></a><span class="k">  ELSE</span>
<a name="ln-12171"></a>
<a name="ln-12172"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12173"></a><span class="k">      </span><span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingPartLoadFrac</span>
<a name="ln-12174"></a>      <span class="n">CompOn</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-12175"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">PartLoadRatio</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="n">CompOn</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-12176"></a>      <span class="k">CALL </span><span class="n">CalcUnitaryHeatingSystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">CompOn</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">)</span>
<a name="ln-12177"></a>    <span class="k">END IF</span>
<a name="ln-12178"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12179"></a><span class="k">      </span><span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingPartLoadFrac</span>
<a name="ln-12180"></a>      <span class="n">CompOn</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-12181"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">PartLoadRatio</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="n">CompOn</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-12182"></a>      <span class="n">HXUnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-12183"></a>      <span class="k">CALL </span><span class="n">CalcUnitaryCoolingSystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-12184"></a>                                    <span class="n">CompOn</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">CoilCoolHeatRat</span><span class="p">,</span><span class="n">HXUnitOn</span><span class="p">)</span>
<a name="ln-12185"></a>    <span class="k">END IF</span>
<a name="ln-12186"></a>
<a name="ln-12187"></a><span class="k">  END IF</span>
<a name="ln-12188"></a>
<a name="ln-12189"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanExists</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">DrawThru</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12190"></a><span class="k">    CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanIndex</span><span class="p">,</span><span class="n">FanSpeedRatio</span><span class="p">)</span>
<a name="ln-12191"></a>  <span class="k">END IF</span>
<a name="ln-12192"></a>
<a name="ln-12193"></a><span class="c">! CALL reheat coils next</span>
<a name="ln-12194"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12195"></a><span class="k">    </span><span class="n">SuppHeatingCoilFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-12196"></a>    <span class="k">CALL </span><span class="n">CalcUnitarySuppSystemToSP</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-12197"></a>    <span class="n">SuppHeatingCoilFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-12198"></a>  <span class="k">END IF</span>
<a name="ln-12199"></a>
<a name="ln-12200"></a><span class="k">  RETURN</span>
<a name="ln-12201"></a>
<a name="ln-12202"></a><span class="k">END SUBROUTINE </span><span class="n">CalcPassiveSystem</span>
<a name="ln-12203"></a>
<a name="ln-12204"></a><span class="k">SUBROUTINE </span><span class="n">SetOnOffMassFlowRate</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-12205"></a>
<a name="ln-12206"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-12207"></a>          <span class="c">!       AUTHOR         Chandan Sharma</span>
<a name="ln-12208"></a>          <span class="c">!       DATE WRITTEN   May 2013</span>
<a name="ln-12209"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-12210"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-12211"></a>
<a name="ln-12212"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-12213"></a>          <span class="c">! This subroutine is for initializations of the components.</span>
<a name="ln-12214"></a>
<a name="ln-12215"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-12216"></a>          <span class="c">! The unitarysystem may have alternate air flow rates</span>
<a name="ln-12217"></a>          <span class="c">! in cooling, heating, and when no cooling or heating is needed. Set up the coil (comp) ON and OFF</span>
<a name="ln-12218"></a>          <span class="c">! air flow rates. Use these flow rates during the Calc routines to set the average mass flow rates</span>
<a name="ln-12219"></a>          <span class="c">! based on PLR.</span>
<a name="ln-12220"></a>
<a name="ln-12221"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-12222"></a>          <span class="c">! Based on SetOnOffMassFlowRate by Richard Raustad</span>
<a name="ln-12223"></a>
<a name="ln-12224"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-12225"></a>          <span class="c">! na</span>
<a name="ln-12226"></a>
<a name="ln-12227"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-12228"></a>
<a name="ln-12229"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-12230"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">UnitarySysNum</span>     <span class="c">! index to unitary system</span>
<a name="ln-12231"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span> <span class="c">! ratio of coil on to coil off air flow rate</span>
<a name="ln-12232"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">PartLoadRatio</span>     <span class="c">! coil part-load ratio</span>
<a name="ln-12233"></a>
<a name="ln-12234"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-12235"></a>          <span class="c">! na</span>
<a name="ln-12236"></a>
<a name="ln-12237"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-12238"></a>          <span class="c">! na</span>
<a name="ln-12239"></a>
<a name="ln-12240"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-12241"></a>          <span class="c">! na</span>
<a name="ln-12242"></a>
<a name="ln-12243"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-12244"></a> <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">HeatSpeedNum</span>
<a name="ln-12245"></a> <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolSpeedNum</span>
<a name="ln-12246"></a> <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SpeedRatio</span>
<a name="ln-12247"></a>
<a name="ln-12248"></a><span class="n">CompOffMassFlow</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12249"></a><span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12250"></a>
<a name="ln-12251"></a><span class="c">! Set the compressor or coil ON mass flow rate</span>
<a name="ln-12252"></a><span class="k">IF</span> <span class="p">(</span> <span class="n">HeatingLoad</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12253"></a>
<a name="ln-12254"></a><span class="k">  </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">LastMode</span> <span class="o">=</span> <span class="n">HeatingMode</span>
<a name="ln-12255"></a>
<a name="ln-12256"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">MultiOrVarSpeedHeatCoil</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-12257"></a>
<a name="ln-12258"></a><span class="k">    </span><span class="n">HeatSpeedNum</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedNum</span>
<a name="ln-12259"></a>
<a name="ln-12260"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">HeatSpeedNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12261"></a><span class="k">      </span><span class="n">CompOnMassFlow</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleMassFlowRate</span>
<a name="ln-12262"></a>      <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleSpeedRatio</span>
<a name="ln-12263"></a>    <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">HeatSpeedNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12264"></a><span class="k">      </span><span class="n">CompOnMassFlow</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12265"></a>      <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSHeatingSpeedRatio</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12266"></a>      <span class="n">MSHPMassFlowRateLow</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12267"></a>      <span class="n">MSHPMassFlowRateHigh</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12268"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">HeatSpeedNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12269"></a><span class="k">      </span><span class="n">SpeedRatio</span>       <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span>
<a name="ln-12270"></a>
<a name="ln-12271"></a>      <span class="n">CompOnMassFlow</span>   <span class="o">=</span> <span class="n">SpeedRatio</span><span class="o">*</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="n">HeatSpeedNum</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-12272"></a>                         <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SpeedRatio</span><span class="p">)</span><span class="o">*</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="n">HeatSpeedNum</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12273"></a>      <span class="n">CompOnFlowRatio</span>  <span class="o">=</span> <span class="n">SpeedRatio</span><span class="o">*</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSHeatingSpeedRatio</span><span class="p">(</span><span class="n">HeatSpeedNum</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-12274"></a>                         <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SpeedRatio</span><span class="p">)</span><span class="o">*</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSHeatingSpeedRatio</span><span class="p">(</span><span class="n">HeatSpeedNum</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12275"></a>      <span class="n">MSHPMassFlowRateHigh</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="n">HeatSpeedNum</span><span class="p">)</span>
<a name="ln-12276"></a>      <span class="n">MSHPMassFlowRateLow</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="n">HeatSpeedNum</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12277"></a>    <span class="k">END IF</span>
<a name="ln-12278"></a>    <span class="c">! Set the compressor or coil OFF mass flow rate based on LOGICAL flag</span>
<a name="ln-12279"></a>    <span class="c">! UseCompressorOnFlow is used when the user does not enter a value for no cooling or heating flow rate</span>
<a name="ln-12280"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span> <span class="o">==</span> <span class="n">ContFanCycCoil</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12281"></a><span class="k">      IF</span><span class="p">(</span><span class="n">MoistureLoad</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Humidistat</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-12282"></a>         <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">==</span> <span class="n">DehumidControl_CoolReheat</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12283"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">MultiOrVarSpeedCoolCoil</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-12284"></a><span class="k">          </span><span class="n">CoolSpeedNum</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedNum</span>
<a name="ln-12285"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">CoolSpeedNum</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12286"></a><span class="k">            </span><span class="n">CompOffMassFlow</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleMassFlowRate</span>
<a name="ln-12287"></a>            <span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleSpeedRatio</span>
<a name="ln-12288"></a>          <span class="n">ELSEIF</span><span class="p">(</span><span class="n">CoolSpeedNum</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12289"></a><span class="k">            </span><span class="n">CompOffMassFlow</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12290"></a>            <span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSCoolingSpeedRatio</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12291"></a>          <span class="n">ELSEIF</span><span class="p">(</span><span class="n">CoolSpeedNum</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12292"></a><span class="k">            </span><span class="n">CompOffMassFlow</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">CoolSpeedNum</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12293"></a>            <span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSCoolingSpeedRatio</span><span class="p">(</span><span class="n">CoolSpeedNum</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12294"></a>          <span class="k">END IF</span>
<a name="ln-12295"></a><span class="k">        ELSE</span>
<a name="ln-12296"></a><span class="k">          </span><span class="n">CompOffMassFlow</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirMassFlow</span>
<a name="ln-12297"></a>          <span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingFanSpeedRatio</span>
<a name="ln-12298"></a>        <span class="k">END IF</span>
<a name="ln-12299"></a><span class="k">      ELSE</span>
<a name="ln-12300"></a><span class="c">!        IF (UnitarySystem(UnitarySysNum)%AirFlowControl .EQ. UseCompressorOnFlow) THEN</span>
<a name="ln-12301"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">HeatSpeedNum</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12302"></a><span class="k">            </span><span class="n">CompOffMassFlow</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleMassFlowRate</span>
<a name="ln-12303"></a>            <span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleSpeedRatio</span>
<a name="ln-12304"></a>          <span class="k">ELSE</span>
<a name="ln-12305"></a><span class="k">            </span><span class="n">CompOffMassFlow</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="n">HeatSpeedNum</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12306"></a>            <span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSHeatingSpeedRatio</span><span class="p">(</span><span class="n">HeatSpeedNum</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12307"></a>          <span class="k">END IF</span>
<a name="ln-12308"></a><span class="k">      END IF</span>
<a name="ln-12309"></a><span class="k">    END IF</span>
<a name="ln-12310"></a><span class="k">  ELSE</span>   <span class="c">! IF(MultiOrVarSpeedHeatCoil) THEN</span>
<a name="ln-12311"></a><span class="c">!   If a heating and moisture load exists, operate at the cooling mass flow rate ELSE operate at the heating flow rate</span>
<a name="ln-12312"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">MoistureLoad</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Humidistat</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-12313"></a>       <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">==</span> <span class="n">DehumidControl_CoolReheat</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-12314"></a>       <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DXHeatingCoil</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12315"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">MultiOrVarSpeedCoolCoil</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-12316"></a><span class="k">        </span><span class="n">CoolSpeedNum</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedNum</span>
<a name="ln-12317"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">CoolSpeedNum</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12318"></a><span class="k">          </span><span class="n">CompOnMassFlow</span>   <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleMassFlowRate</span>
<a name="ln-12319"></a>          <span class="n">CompOnFlowRatio</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleSpeedRatio</span>
<a name="ln-12320"></a>        <span class="n">ELSEIF</span><span class="p">(</span><span class="n">CoolSpeedNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12321"></a><span class="k">          </span><span class="n">CompOnMassFlow</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12322"></a>          <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSCoolingSpeedRatio</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12323"></a>        <span class="k">ELSE</span>
<a name="ln-12324"></a><span class="c">!          SpeedRatio           = UnitarySystem(UnitarySysNum)%MSCoolingSpeedRatio(CoolSpeedNum)</span>
<a name="ln-12325"></a>          <span class="n">SpeedRatio</span>           <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span>
<a name="ln-12326"></a>
<a name="ln-12327"></a>          <span class="n">CompOnMassFlow</span>       <span class="o">=</span> <span class="n">SpeedRatio</span><span class="o">*</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">CoolSpeedNum</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-12328"></a>                                 <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SpeedRatio</span><span class="p">)</span><span class="o">*</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">CoolSpeedNum</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12329"></a>          <span class="n">CompOnFlowRatio</span>      <span class="o">=</span> <span class="n">SpeedRatio</span><span class="o">*</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSCoolingSpeedRatio</span><span class="p">(</span><span class="n">CoolSpeedNum</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-12330"></a>                                 <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SpeedRatio</span><span class="p">)</span><span class="o">*</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSCoolingSpeedRatio</span><span class="p">(</span><span class="n">CoolSpeedNum</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12331"></a>          <span class="n">MSHPMassFlowRateHigh</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">CoolSpeedNum</span><span class="p">)</span>
<a name="ln-12332"></a>          <span class="n">MSHPMassFlowRateLow</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">CoolSpeedNum</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12333"></a>        <span class="k">END IF</span>
<a name="ln-12334"></a><span class="k">      ELSE</span> <span class="c">! IF (MultiOrVarSpeedCoolCoil) THEN</span>
<a name="ln-12335"></a>        <span class="n">CompOnMassFlow</span>   <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirMassFlow</span>
<a name="ln-12336"></a>        <span class="n">CompOnFlowRatio</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingFanSpeedRatio</span>
<a name="ln-12337"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span> <span class="o">==</span> <span class="n">ContFanCycCoil</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12338"></a><span class="k">          </span><span class="n">CompOffMassFlow</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirMassFlow</span>
<a name="ln-12339"></a>          <span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingFanSpeedRatio</span>
<a name="ln-12340"></a>        <span class="k">END IF</span>
<a name="ln-12341"></a><span class="k">      END IF</span>
<a name="ln-12342"></a><span class="k">    ELSE</span>  <span class="c">! Heating load but no moisture load</span>
<a name="ln-12343"></a>      <span class="n">CompOnMassFlow</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirMassFlow</span>
<a name="ln-12344"></a>      <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingFanSpeedRatio</span>
<a name="ln-12345"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span> <span class="o">==</span> <span class="n">ContFanCycCoil</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12346"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">AirFlowControl</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">UseCompressorOnFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12347"></a><span class="k">          </span><span class="n">CompOffMassFlow</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirMassFlow</span>
<a name="ln-12348"></a>          <span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingFanSpeedRatio</span>
<a name="ln-12349"></a>        <span class="k">ELSE</span>
<a name="ln-12350"></a><span class="k">          </span><span class="n">CompOffMassFlow</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirMassFlow</span>
<a name="ln-12351"></a>          <span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingFanSpeedRatio</span>
<a name="ln-12352"></a>        <span class="k">END IF</span>
<a name="ln-12353"></a><span class="k">      END IF</span>
<a name="ln-12354"></a><span class="k">    END IF</span>
<a name="ln-12355"></a><span class="k">  END IF</span>
<a name="ln-12356"></a>
<a name="ln-12357"></a><span class="c">! If a cooling load exists, operate at the cooling mass flow rate</span>
<a name="ln-12358"></a><span class="n">ELSEIF</span> <span class="p">(</span> <span class="n">CoolingLoad</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12359"></a>
<a name="ln-12360"></a><span class="k">  </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">LastMode</span> <span class="o">=</span> <span class="n">CoolingMode</span>
<a name="ln-12361"></a>
<a name="ln-12362"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">MultiOrVarSpeedCoolCoil</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-12363"></a>
<a name="ln-12364"></a><span class="k">    </span><span class="n">CoolSpeedNum</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedNum</span>
<a name="ln-12365"></a>
<a name="ln-12366"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CoolSpeedNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12367"></a><span class="k">      </span><span class="n">CompOnMassFlow</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleMassFlowRate</span>
<a name="ln-12368"></a>      <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleSpeedRatio</span>
<a name="ln-12369"></a>    <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">CoolSpeedNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12370"></a><span class="k">      </span><span class="n">CompOnMassFlow</span>       <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12371"></a>      <span class="n">CompOnFlowRatio</span>      <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSCoolingSpeedRatio</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12372"></a>      <span class="n">MSHPMassFlowRateLow</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12373"></a>      <span class="n">MSHPMassFlowRateHigh</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12374"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">CoolSpeedNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12375"></a><span class="c">!      SpeedRatio           = UnitarySystem(UnitarySysNum)%MSCoolingSpeedRatio(CoolSpeedNum)</span>
<a name="ln-12376"></a>      <span class="n">SpeedRatio</span>           <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span>
<a name="ln-12377"></a>
<a name="ln-12378"></a>      <span class="n">CompOnMassFlow</span>       <span class="o">=</span> <span class="n">SpeedRatio</span> <span class="o">*</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">CoolSpeedNum</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-12379"></a>                             <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SpeedRatio</span><span class="p">)</span> <span class="o">*</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">CoolSpeedNum</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12380"></a>      <span class="n">CompOnFlowRatio</span>      <span class="o">=</span> <span class="n">SpeedRatio</span> <span class="o">*</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSCoolingSpeedRatio</span><span class="p">(</span><span class="n">CoolSpeedNum</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-12381"></a>                             <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SpeedRatio</span><span class="p">)</span> <span class="o">*</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSCoolingSpeedRatio</span><span class="p">(</span><span class="n">CoolSpeedNum</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12382"></a>      <span class="n">MSHPMassFlowRateHigh</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">CoolSpeedNum</span><span class="p">)</span>
<a name="ln-12383"></a>      <span class="n">MSHPMassFlowRateLow</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">CoolSpeedNum</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12384"></a>    <span class="k">END IF</span>
<a name="ln-12385"></a>    <span class="c">! Set the compressor or coil OFF mass flow rate based on LOGICAL flag</span>
<a name="ln-12386"></a>    <span class="c">! UseCompressorOnFlow is used when the user does not enter a value for no cooling or heating flow rate</span>
<a name="ln-12387"></a><span class="c">!    IF(UnitarySystem(UnitarySysNum)%FanOpMode == ContFanCycCoil)THEN</span>
<a name="ln-12388"></a><span class="c">!      IF (UnitarySystem(UnitarySysNum)%AirFlowControl .EQ. UseCompressorOnFlow) THEN</span>
<a name="ln-12389"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">CoolSpeedNum</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12390"></a><span class="k">          IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span> <span class="o">==</span> <span class="n">ContFanCycCoil</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12391"></a><span class="k">            </span><span class="n">CompOffMassFlow</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleMassFlowRate</span>
<a name="ln-12392"></a>            <span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleSpeedRatio</span>
<a name="ln-12393"></a>          <span class="k">END IF</span>
<a name="ln-12394"></a><span class="k">        ELSE</span>
<a name="ln-12395"></a><span class="k">          </span><span class="n">CompOffMassFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">CoolSpeedNum</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12396"></a>          <span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSCoolingSpeedRatio</span><span class="p">(</span><span class="n">CoolSpeedNum</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12397"></a>        <span class="k">END IF</span>
<a name="ln-12398"></a><span class="c">!      ELSE</span>
<a name="ln-12399"></a><span class="c">!        CompOffMassFlow  = UnitarySystem(UnitarySysNum)%IdleMassFlowRate</span>
<a name="ln-12400"></a><span class="c">!        CompOffFlowRatio = UnitarySystem(UnitarySysNum)%IdleSpeedRatio</span>
<a name="ln-12401"></a><span class="c">!      END IF</span>
<a name="ln-12402"></a><span class="c">!    END IF</span>
<a name="ln-12403"></a>  <span class="k">ELSE</span> <span class="c">! IF(MultiOrVarSpeedCoolCoil(UnitarySysNum)) THEN</span>
<a name="ln-12404"></a>    <span class="n">CompOnMassFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirMassFlow</span>
<a name="ln-12405"></a>    <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span>
<a name="ln-12406"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span> <span class="o">==</span> <span class="n">ContFanCycCoil</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12407"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">AirFlowControl</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">UseCompressorOnFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12408"></a><span class="k">        </span><span class="n">CompOffMassFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirMassFlow</span>
<a name="ln-12409"></a>        <span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingFanSpeedRatio</span>
<a name="ln-12410"></a>      <span class="k">ELSE</span>
<a name="ln-12411"></a><span class="k">        </span><span class="n">CompOffMassFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirMassFlow</span>
<a name="ln-12412"></a>        <span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingFanSpeedRatio</span>
<a name="ln-12413"></a>      <span class="k">END IF</span>
<a name="ln-12414"></a><span class="k">    END IF</span>
<a name="ln-12415"></a><span class="k">  END IF</span>
<a name="ln-12416"></a>
<a name="ln-12417"></a><span class="k">ELSE</span>  <span class="c">! No load</span>
<a name="ln-12418"></a><span class="c">! If no load exists, set the compressor on mass flow rate.</span>
<a name="ln-12419"></a><span class="c">! Set equal the mass flow rate when no heating or cooling is needed If no moisture load exists.</span>
<a name="ln-12420"></a><span class="c">! If the user has set the off mass flow rate to 0, set according to the last operating mode.</span>
<a name="ln-12421"></a>
<a name="ln-12422"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">MoistureLoad</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Humidistat</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-12423"></a>     <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">==</span> <span class="n">DehumidControl_CoolReheat</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12424"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">MultiOrVarSpeedCoolCoil</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-12425"></a><span class="k">      </span><span class="n">CoolSpeedNum</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedNum</span>
<a name="ln-12426"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">CoolSpeedNum</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12427"></a><span class="k">        </span><span class="n">CompOnMassFlow</span>   <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleMassFlowRate</span>
<a name="ln-12428"></a>        <span class="n">CompOnFlowRatio</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleSpeedRatio</span>
<a name="ln-12429"></a>      <span class="n">ELSEIF</span><span class="p">(</span><span class="n">CoolSpeedNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12430"></a><span class="k">        </span><span class="n">CompOnMassFlow</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12431"></a>        <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSCoolingSpeedRatio</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12432"></a>      <span class="k">ELSE</span>
<a name="ln-12433"></a><span class="c">!        SpeedRatio           = UnitarySystem(UnitarySysNum)%MSCoolingSpeedRatio(CoolSpeedNum)</span>
<a name="ln-12434"></a>        <span class="n">SpeedRatio</span>           <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span>
<a name="ln-12435"></a>
<a name="ln-12436"></a>        <span class="n">CompOnMassFlow</span>       <span class="o">=</span> <span class="n">SpeedRatio</span> <span class="o">*</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">CoolSpeedNum</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-12437"></a>                               <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SpeedRatio</span><span class="p">)</span> <span class="o">*</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">CoolSpeedNum</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12438"></a>        <span class="n">CompOnFlowRatio</span>      <span class="o">=</span> <span class="n">SpeedRatio</span> <span class="o">*</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSCoolingSpeedRatio</span><span class="p">(</span><span class="n">CoolSpeedNum</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-12439"></a>                               <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SpeedRatio</span><span class="p">)</span> <span class="o">*</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSCoolingSpeedRatio</span><span class="p">(</span><span class="n">CoolSpeedNum</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12440"></a>        <span class="n">MSHPMassFlowRateHigh</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">CoolSpeedNum</span><span class="p">)</span>
<a name="ln-12441"></a>        <span class="n">MSHPMassFlowRateLow</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">CoolSpeedNum</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12442"></a>      <span class="k">END IF</span>
<a name="ln-12443"></a>
<a name="ln-12444"></a><span class="k">      IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span> <span class="o">==</span> <span class="n">ContFanCycCoil</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12445"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">AirFlowControl</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">UseCompressorOnFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12446"></a><span class="k">          IF</span><span class="p">(</span><span class="n">CoolSpeedNum</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12447"></a><span class="k">            </span><span class="n">CompOffMassFlow</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleMassFlowRate</span>
<a name="ln-12448"></a>            <span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleSpeedRatio</span>
<a name="ln-12449"></a>          <span class="k">ELSE</span>
<a name="ln-12450"></a><span class="k">            </span><span class="n">CompOffMassFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">CoolSpeedNum</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12451"></a>            <span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSCoolingSpeedRatio</span><span class="p">(</span><span class="n">CoolSpeedNum</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12452"></a>          <span class="k">END IF</span>
<a name="ln-12453"></a><span class="k">        ELSE</span>
<a name="ln-12454"></a><span class="k">          </span><span class="n">CompOffMassFlow</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleMassFlowRate</span>
<a name="ln-12455"></a>          <span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleSpeedRatio</span>
<a name="ln-12456"></a>        <span class="k">END IF</span>
<a name="ln-12457"></a><span class="k">      END IF</span>
<a name="ln-12458"></a>
<a name="ln-12459"></a><span class="k">    ELSE</span>  <span class="c">! IF (MultiOrVarSpeedCoolCoil(UnitarySysNum)) THEN</span>
<a name="ln-12460"></a>      <span class="n">CompOnMassFlow</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirMassFlow</span>
<a name="ln-12461"></a>      <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingFanSpeedRatio</span>
<a name="ln-12462"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span> <span class="o">==</span> <span class="n">ContFanCycCoil</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12463"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">AirFlowControl</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">UseCompressorOnFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12464"></a><span class="k">          </span><span class="n">CompOffMassFlow</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirMassFlow</span>
<a name="ln-12465"></a>          <span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingFanSpeedRatio</span>
<a name="ln-12466"></a>        <span class="k">ELSE</span>
<a name="ln-12467"></a><span class="k">          </span><span class="n">CompOffMassFlow</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirMassFlow</span>
<a name="ln-12468"></a>          <span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingFanSpeedRatio</span>
<a name="ln-12469"></a>        <span class="k">END IF</span>
<a name="ln-12470"></a><span class="k">      END IF</span>
<a name="ln-12471"></a><span class="k">    END IF</span>
<a name="ln-12472"></a>
<a name="ln-12473"></a><span class="k">  ELSE</span> <span class="c">! No Moisture Load</span>
<a name="ln-12474"></a>
<a name="ln-12475"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">LastMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">HeatingMode</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12476"></a><span class="k">      IF</span><span class="p">(</span><span class="n">MultiOrVarSpeedHeatCoil</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-12477"></a><span class="k">        </span><span class="n">CompOnMassFlow</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleMassFlowRate</span>
<a name="ln-12478"></a>        <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleSpeedRatio</span>
<a name="ln-12479"></a>      <span class="k">ELSE</span>
<a name="ln-12480"></a><span class="k">        </span><span class="n">CompOnMassFlow</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirMassFlow</span>
<a name="ln-12481"></a>        <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-12482"></a>      <span class="k">END IF</span>
<a name="ln-12483"></a><span class="k">    ELSE</span>
<a name="ln-12484"></a><span class="k">      IF</span><span class="p">(</span><span class="n">MultiOrVarSpeedCoolCoil</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-12485"></a><span class="k">        </span><span class="n">CompOnMassFlow</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleMassFlowRate</span>
<a name="ln-12486"></a>        <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleSpeedRatio</span>
<a name="ln-12487"></a>      <span class="k">ELSE</span>
<a name="ln-12488"></a><span class="k">        </span><span class="n">CompOnMassFlow</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirMassFlow</span>
<a name="ln-12489"></a>        <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-12490"></a>      <span class="k">END IF</span>
<a name="ln-12491"></a><span class="k">    END IF</span>
<a name="ln-12492"></a><span class="k">    IF</span><span class="p">(</span><span class="n">CompOnMassFlow</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12493"></a><span class="k">      IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">LastMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">HeatingMode</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12494"></a><span class="k">        IF</span><span class="p">(</span><span class="n">MultiOrVarSpeedHeatCoil</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-12495"></a><span class="k">          </span><span class="n">HeatSpeedNum</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedNum</span>
<a name="ln-12496"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">HeatSpeedNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12497"></a><span class="k">            </span><span class="n">CompOnMassFlow</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleMassFlowRate</span>
<a name="ln-12498"></a>            <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleSpeedRatio</span>
<a name="ln-12499"></a>          <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">HeatSpeedNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12500"></a><span class="k">            </span><span class="n">CompOnMassFlow</span>   <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12501"></a>            <span class="n">CompOnFlowRatio</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSHeatingSpeedRatio</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12502"></a><span class="c">!            CompOffMassFlow  = UnitarySystem(UnitarySysNum)%IdleMassFlowRate</span>
<a name="ln-12503"></a><span class="c">!            CompOffFlowRatio = UnitarySystem(UnitarySysNum)%IdleMassFlowRate</span>
<a name="ln-12504"></a>          <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">HeatSpeedNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12505"></a><span class="k">            </span><span class="n">CompOnMassFlow</span>   <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="n">HeatSpeedNum</span><span class="p">)</span>
<a name="ln-12506"></a>            <span class="n">CompOnFlowRatio</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSHeatingSpeedRatio</span><span class="p">(</span><span class="n">HeatSpeedNum</span><span class="p">)</span>
<a name="ln-12507"></a><span class="c">!            CompOffMassFlow  = UnitarySystem(UnitarySysNum)%HeatMassFlowRate(HeatSpeedNum-1)</span>
<a name="ln-12508"></a><span class="c">!            CompOffFlowRatio = UnitarySystem(UnitarySysNum)%MSHeatingSpeedRatio(HeatSpeedNum-1)</span>
<a name="ln-12509"></a>          <span class="k">END IF</span>
<a name="ln-12510"></a><span class="k">        ELSE</span>  <span class="c">! IF(MultiOrVarSpeedHeatCoil) THEN</span>
<a name="ln-12511"></a>          <span class="n">CompOnMassFlow</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirMassFlow</span>
<a name="ln-12512"></a>          <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingFanSpeedRatio</span>
<a name="ln-12513"></a>        <span class="k">END IF</span>
<a name="ln-12514"></a><span class="k">      ELSE</span>   <span class="c">! IF(UnitarySystem(UnitarySysNum)%LastMode .EQ. HeatingMode)THEN</span>
<a name="ln-12515"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">MultiOrVarSpeedCoolCoil</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-12516"></a><span class="k">          </span><span class="n">CoolSpeedNum</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedNum</span>
<a name="ln-12517"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">CoolSpeedNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12518"></a><span class="k">            </span><span class="n">CompOnMassFlow</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleMassFlowRate</span>
<a name="ln-12519"></a>            <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleSpeedRatio</span>
<a name="ln-12520"></a>          <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">CoolSpeedNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12521"></a><span class="k">            </span><span class="n">CompOnMassFlow</span>   <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12522"></a>            <span class="n">CompOnFlowRatio</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSCoolingSpeedRatio</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12523"></a><span class="c">!            CompOffMassFlow  = UnitarySystem(UnitarySysNum)%IdleMassFlowRate</span>
<a name="ln-12524"></a><span class="c">!            CompOffFlowRatio = UnitarySystem(UnitarySysNum)%IdleMassFlowRate</span>
<a name="ln-12525"></a>          <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">CoolSpeedNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12526"></a><span class="k">            </span><span class="n">CompOnMassFlow</span>   <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">CoolSpeedNum</span><span class="p">)</span>
<a name="ln-12527"></a>            <span class="n">CompOnFlowRatio</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSCoolingSpeedRatio</span><span class="p">(</span><span class="n">CoolSpeedNum</span><span class="p">)</span>
<a name="ln-12528"></a><span class="c">!            CompOffMassFlow  = UnitarySystem(UnitarySysNum)%CoolMassFlowRate(CoolSpeedNum-1)</span>
<a name="ln-12529"></a><span class="c">!            CompOffFlowRatio = UnitarySystem(UnitarySysNum)%MSCoolingSpeedRatio(CoolSpeedNum-1)</span>
<a name="ln-12530"></a>          <span class="k">END IF</span>
<a name="ln-12531"></a><span class="k">        ELSE</span>  <span class="c">! IF(MultiOrVarSpeedCoolCoil) THEN</span>
<a name="ln-12532"></a>          <span class="n">CompOnMassFlow</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirMassFlow</span>
<a name="ln-12533"></a>          <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingFanSpeedRatio</span>
<a name="ln-12534"></a>        <span class="k">END IF</span> <span class="c">! IF(MultiOrVarSpeedCoolCoil) THEN</span>
<a name="ln-12535"></a>      <span class="k">END IF</span>   <span class="c">! IF(UnitarySystem(UnitarySysNum)%LastMode .EQ. HeatingMode)THEN</span>
<a name="ln-12536"></a>    <span class="k">END IF</span> <span class="c">! IF(CompOnMassFlow .EQ. 0.0d0)THEN</span>
<a name="ln-12537"></a>
<a name="ln-12538"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span> <span class="o">==</span> <span class="n">ContFanCycCoil</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12539"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">AirFlowControl</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">UseCompressorOnFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12540"></a><span class="k">        IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">LastMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">HeatingMode</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12541"></a><span class="k">          IF</span><span class="p">(</span><span class="n">MultiOrVarSpeedHeatCoil</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-12542"></a><span class="k">            </span><span class="n">HeatSpeedNum</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedNum</span>
<a name="ln-12543"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">HeatSpeedNum</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12544"></a><span class="k">              </span><span class="n">CompOffMassFlow</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleMassFlowRate</span>
<a name="ln-12545"></a>              <span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleSpeedRatio</span>
<a name="ln-12546"></a>            <span class="k">ELSE IF</span><span class="p">(</span><span class="n">HeatSpeedNum</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12547"></a><span class="k">              </span><span class="n">CompOffMassFlow</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12548"></a>              <span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSHeatingSpeedRatio</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12549"></a>            <span class="k">ELSE</span>
<a name="ln-12550"></a><span class="k">              </span><span class="n">CompOffMassFlow</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="n">HeatSpeedNum</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12551"></a>              <span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSHeatingSpeedRatio</span><span class="p">(</span><span class="n">HeatSpeedNum</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12552"></a>            <span class="k">END IF</span>
<a name="ln-12553"></a><span class="k">          ELSE</span>
<a name="ln-12554"></a><span class="k">            </span><span class="n">CompOffMassFlow</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirMassFlow</span>
<a name="ln-12555"></a>            <span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingFanSpeedRatio</span>
<a name="ln-12556"></a>          <span class="k">END IF</span>
<a name="ln-12557"></a><span class="k">        ELSE</span>   <span class="c">! IF(UnitarySystem(UnitarySysNum)%LastMode .EQ. HeatingMode)THEN</span>
<a name="ln-12558"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">MultiOrVarSpeedCoolCoil</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-12559"></a><span class="k">            </span><span class="n">CoolSpeedNum</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedNum</span>
<a name="ln-12560"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">CoolSpeedNum</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12561"></a><span class="k">              </span><span class="n">CompOffMassFlow</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleMassFlowRate</span>
<a name="ln-12562"></a>              <span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">IdleSpeedRatio</span>
<a name="ln-12563"></a>            <span class="k">ELSE IF</span><span class="p">(</span><span class="n">CoolSpeedNum</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12564"></a><span class="k">              </span><span class="n">CompOffMassFlow</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12565"></a>              <span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSCoolingSpeedRatio</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12566"></a>            <span class="k">ELSE</span>
<a name="ln-12567"></a><span class="k">              </span><span class="n">CompOffMassFlow</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">CoolSpeedNum</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12568"></a>              <span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSCoolingSpeedRatio</span><span class="p">(</span><span class="n">CoolSpeedNum</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12569"></a>            <span class="k">END IF</span>
<a name="ln-12570"></a><span class="k">          ELSE</span>
<a name="ln-12571"></a><span class="k">            </span><span class="n">CompOffMassFlow</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirMassFlow</span>
<a name="ln-12572"></a>            <span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingFanSpeedRatio</span>
<a name="ln-12573"></a>          <span class="k">END IF</span>
<a name="ln-12574"></a><span class="k">        END IF</span>   <span class="c">! IF(UnitarySystem(UnitarySysNum)%LastMode .EQ. HeatingMode)THEN</span>
<a name="ln-12575"></a>      <span class="k">ELSE</span>  <span class="c">! IF (UnitarySystem(UnitarySysNum)%AirFlowControl .EQ. UseCompressorOnFlow) THEN</span>
<a name="ln-12576"></a>        <span class="n">CompOffMassFlow</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirMassFlow</span>
<a name="ln-12577"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">LastMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">HeatingMode</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12578"></a><span class="k">          IF</span><span class="p">(</span><span class="n">MultiOrVarSpeedHeatCoil</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-12579"></a><span class="k">            </span><span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSHeatingSpeedRatio</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12580"></a>          <span class="k">ELSE</span>
<a name="ln-12581"></a><span class="k">            </span><span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingFanSpeedRatio</span>
<a name="ln-12582"></a>          <span class="k">END IF</span>
<a name="ln-12583"></a><span class="k">        ELSE</span>
<a name="ln-12584"></a><span class="k">          IF</span><span class="p">(</span><span class="n">MultiOrVarSpeedCoolCoil</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-12585"></a><span class="k">            </span><span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MSCoolingSpeedRatio</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-12586"></a>          <span class="k">ELSE</span>
<a name="ln-12587"></a><span class="k">            </span><span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingFanSpeedRatio</span>
<a name="ln-12588"></a>          <span class="k">END IF</span>
<a name="ln-12589"></a><span class="k">        END IF</span>
<a name="ln-12590"></a><span class="k">      END IF</span> <span class="c">! IF (UnitarySystem(UnitarySysNum)%AirFlowControl .EQ. UseCompressorOnFlow) THEN</span>
<a name="ln-12591"></a>    <span class="k">END IF</span>   <span class="c">! IF(UnitarySystem(UnitarySysNum)%FanOpMode == ContFanCycCoil)THEN</span>
<a name="ln-12592"></a>  <span class="k">END IF</span>     <span class="c">! ELSE ! No Moisture Load</span>
<a name="ln-12593"></a><span class="k">END IF</span>       <span class="c">! No Heating/Cooling Load</span>
<a name="ln-12594"></a>
<a name="ln-12595"></a><span class="c">! Set the system mass flow rates</span>
<a name="ln-12596"></a><span class="k">CALL </span><span class="n">SetAverageAirFlow</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">)</span>
<a name="ln-12597"></a>
<a name="ln-12598"></a><span class="k">END SUBROUTINE </span><span class="n">SetOnOffMassFlowRate</span>
<a name="ln-12599"></a>
<a name="ln-12600"></a><span class="k">SUBROUTINE </span><span class="n">SetAverageAirFlow</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">)</span>
<a name="ln-12601"></a>
<a name="ln-12602"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-12603"></a>          <span class="c">!       AUTHOR         Richard Raustad</span>
<a name="ln-12604"></a>          <span class="c">!       DATE WRITTEN   July 2005</span>
<a name="ln-12605"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-12606"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-12607"></a>
<a name="ln-12608"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-12609"></a>          <span class="c">! Set the average air mass flow rates using the part-load fraction of the HVAC system for this time step</span>
<a name="ln-12610"></a>          <span class="c">! Set OnOffAirFlowRatio to be used by DX coils</span>
<a name="ln-12611"></a>
<a name="ln-12612"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-12613"></a>          <span class="c">! The air flow rate in cooling, heating, and no cooling or heating can be dIFferent.</span>
<a name="ln-12614"></a>          <span class="c">! Calculate the air flow rate based on initializations.</span>
<a name="ln-12615"></a>
<a name="ln-12616"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-12617"></a>          <span class="c">! na</span>
<a name="ln-12618"></a>
<a name="ln-12619"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-12620"></a>  <span class="k">USE </span><span class="n">DataZoneEnergyDemands</span>
<a name="ln-12621"></a>
<a name="ln-12622"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-12623"></a>
<a name="ln-12624"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-12625"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">UnitarySysNum</span>   <span class="c">! Unit index</span>
<a name="ln-12626"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">PartLoadRatio</span>      <span class="c">! unit part load ratio</span>
<a name="ln-12627"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>  <span class="c">! ratio of compressor ON airflow to AVERAGE airflow over timestep</span>
<a name="ln-12628"></a>
<a name="ln-12629"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-12630"></a>          <span class="c">! na</span>
<a name="ln-12631"></a>
<a name="ln-12632"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-12633"></a>          <span class="c">! na</span>
<a name="ln-12634"></a>
<a name="ln-12635"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-12636"></a>          <span class="c">! na</span>
<a name="ln-12637"></a>
<a name="ln-12638"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-12639"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">InletNode</span>           <span class="c">! inlet node number</span>
<a name="ln-12640"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">AverageUnitMassFlow</span> <span class="c">! average supply air mass flow rate over time step</span>
<a name="ln-12641"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">SpeedNum</span>            <span class="c">! speed for multi-speed or variable-speed coils</span>
<a name="ln-12642"></a>  <span class="kt">LOGICAL</span>             <span class="kd">::</span> <span class="n">FanOn</span>
<a name="ln-12643"></a>
<a name="ln-12644"></a>  <span class="n">SpeedNum</span>  <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedNum</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedNum</span><span class="p">)</span>
<a name="ln-12645"></a>  <span class="n">InletNode</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemInletNodeNum</span>
<a name="ln-12646"></a>
<a name="ln-12647"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">SpeedNum</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12648"></a><span class="k">    </span><span class="n">AverageUnitMassFlow</span> <span class="o">=</span> <span class="n">CompOnMassFlow</span>
<a name="ln-12649"></a>  <span class="k">ELSE</span>
<a name="ln-12650"></a><span class="k">    </span><span class="n">AverageUnitMassFlow</span> <span class="o">=</span> <span class="p">(</span><span class="n">PartLoadRatio</span> <span class="o">*</span> <span class="n">CompOnMassFlow</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">PartLoadRatio</span><span class="p">)</span> <span class="o">*</span> <span class="n">CompOffMassFlow</span><span class="p">)</span>
<a name="ln-12651"></a>  <span class="k">END IF</span>
<a name="ln-12652"></a><span class="k">  IF</span><span class="p">(</span><span class="n">CompOffFlowRatio</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12653"></a><span class="k">    IF</span><span class="p">(</span><span class="n">SpeedNum</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12654"></a><span class="k">      </span><span class="n">FanSpeedRatio</span> <span class="o">=</span> <span class="n">CompOnFlowRatio</span>
<a name="ln-12655"></a>    <span class="k">ELSE</span>
<a name="ln-12656"></a><span class="k">      </span><span class="n">FanSpeedRatio</span> <span class="o">=</span> <span class="p">(</span><span class="n">PartLoadRatio</span> <span class="o">*</span> <span class="n">CompOnFlowRatio</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">PartLoadRatio</span><span class="p">)</span> <span class="o">*</span> <span class="n">CompOffFlowRatio</span><span class="p">)</span>
<a name="ln-12657"></a>    <span class="k">END IF</span>
<a name="ln-12658"></a><span class="k">  ELSE</span>
<a name="ln-12659"></a><span class="k">    </span><span class="n">FanSpeedRatio</span>     <span class="o">=</span> <span class="n">CompOnFlowRatio</span>
<a name="ln-12660"></a>  <span class="k">END IF</span>
<a name="ln-12661"></a><span class="c">! If the unitary system is scheduled on or nightime cycle overrides fan schedule. Uses same logic as fan.</span>
<a name="ln-12662"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12663"></a><span class="k">    </span><span class="n">FanOn</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-12664"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanAvailSchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="n">FanOn</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-12665"></a>  <span class="k">ELSE</span>
<a name="ln-12666"></a><span class="k">    </span><span class="n">FanOn</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-12667"></a>  <span class="k">END IF</span>
<a name="ln-12668"></a><span class="k">  IF</span> <span class="p">(</span> <span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SysAvailSchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-12669"></a>     <span class="p">(</span> <span class="p">(</span><span class="n">FanOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">TurnFansOn</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">TurnFansOff</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12670"></a><span class="k">    </span><span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>              <span class="o">=</span> <span class="n">AverageUnitMassFlow</span>
<a name="ln-12671"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span>      <span class="o">=</span> <span class="n">AverageUnitMassFlow</span>
<a name="ln-12672"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">AverageUnitMassFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12673"></a><span class="k">      </span><span class="n">OnOffAirFlowRatio</span>                       <span class="o">=</span> <span class="n">CompOnMassFlow</span> <span class="o">/</span> <span class="n">AverageUnitMassFlow</span>
<a name="ln-12674"></a>    <span class="k">ELSE</span>
<a name="ln-12675"></a><span class="k">      </span><span class="n">OnOffAirFlowRatio</span>                       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12676"></a>    <span class="k">END IF</span>
<a name="ln-12677"></a><span class="k">  ELSE</span>
<a name="ln-12678"></a><span class="k">    </span><span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>              <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12679"></a>    <span class="n">OnOffAirFlowRatio</span>                         <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-12680"></a>  <span class="k">END IF</span>
<a name="ln-12681"></a>
<a name="ln-12682"></a><span class="k">  RETURN</span>
<a name="ln-12683"></a><span class="k">END SUBROUTINE </span><span class="n">SetAverageAirFlow</span>
<a name="ln-12684"></a>
<a name="ln-12685"></a><span class="k">SUBROUTINE </span><span class="n">ReportUnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span> <span class="n">AirLoopNum</span><span class="p">)</span>
<a name="ln-12686"></a>
<a name="ln-12687"></a>
<a name="ln-12688"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-12689"></a>          <span class="c">!       AUTHOR         Chandan Sharma</span>
<a name="ln-12690"></a>          <span class="c">!       DATE WRITTEN   July 2013</span>
<a name="ln-12691"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-12692"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-12693"></a>
<a name="ln-12694"></a>
<a name="ln-12695"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-12696"></a>          <span class="c">! This subroutine updates the report variable for the coils.</span>
<a name="ln-12697"></a>
<a name="ln-12698"></a>
<a name="ln-12699"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-12700"></a>          <span class="c">!</span>
<a name="ln-12701"></a>
<a name="ln-12702"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-12703"></a>          <span class="c">! na</span>
<a name="ln-12704"></a>
<a name="ln-12705"></a>
<a name="ln-12706"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-12707"></a>  <span class="k">USE </span><span class="n">Psychrometrics</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">PsyHFnTdbW</span>
<a name="ln-12708"></a>  <span class="k">USE </span><span class="n">DataAirLoop</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">LoopSystemOnMassFlowrate</span><span class="p">,</span><span class="n">LoopSystemOffMassFlowrate</span><span class="p">,</span><span class="n">LoopFanOperationMode</span><span class="p">,</span><span class="n">LoopOnOffFanPartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-12709"></a>                         <span class="n">LoopCompCycRatio</span><span class="p">,</span> <span class="n">AirLoopFlow</span>
<a name="ln-12710"></a>
<a name="ln-12711"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-12712"></a>
<a name="ln-12713"></a>
<a name="ln-12714"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-12715"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UnitarySysNum</span>
<a name="ln-12716"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirLoopNum</span>
<a name="ln-12717"></a>
<a name="ln-12718"></a>
<a name="ln-12719"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-12720"></a>          <span class="c">! na</span>
<a name="ln-12721"></a>
<a name="ln-12722"></a>
<a name="ln-12723"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-12724"></a>          <span class="c">! na</span>
<a name="ln-12725"></a>
<a name="ln-12726"></a>
<a name="ln-12727"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-12728"></a>          <span class="c">! na</span>
<a name="ln-12729"></a>
<a name="ln-12730"></a>
<a name="ln-12731"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-12732"></a>      <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">OutletNode</span>
<a name="ln-12733"></a>      <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">InletNode</span>
<a name="ln-12734"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QSensUnitOut</span>
<a name="ln-12735"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QTotUnitOut</span>
<a name="ln-12736"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">AirMassFlow</span>
<a name="ln-12737"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MinHumRatio</span>
<a name="ln-12738"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CompPartLoadFrac</span>
<a name="ln-12739"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ReportingConstant</span>
<a name="ln-12740"></a>
<a name="ln-12741"></a>      <span class="n">ReportingConstant</span> <span class="o">=</span> <span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-12742"></a>
<a name="ln-12743"></a>      <span class="n">QTotUnitOut</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12744"></a>      <span class="n">QSensUnitOut</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12745"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">PartLoadFrac</span>              <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12746"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span>         <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12747"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CycRatio</span>                  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12748"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SpeedRatio</span>                <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12749"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanPartLoadRatio</span>          <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12750"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">TotalAuxElecPower</span>         <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12751"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingAuxElecConsumption</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12752"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingAuxElecConsumption</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12753"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ElecPower</span>                 <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12754"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ElecPowerConsumption</span>      <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12755"></a>
<a name="ln-12756"></a>      <span class="n">OutletNode</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemOutletNodeNum</span>
<a name="ln-12757"></a>      <span class="n">AirMassFlow</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-12758"></a>      <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ControlType</span><span class="p">)</span>
<a name="ln-12759"></a>        <span class="k">CASE</span><span class="p">(</span><span class="n">SetPointBased</span><span class="p">)</span>
<a name="ln-12760"></a>          <span class="n">InletNode</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">UnitarySystemInletNodeNum</span>
<a name="ln-12761"></a>          <span class="n">MinHumRatio</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-12762"></a>          <span class="n">QSensUnitOut</span> <span class="o">=</span> <span class="n">AirMassFlow</span> <span class="o">*</span> <span class="p">(</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">MinHumRatio</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-12763"></a>                            <span class="o">-</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">MinHumRatio</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-12764"></a>                            <span class="o">-</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SenLoadLoss</span>
<a name="ln-12765"></a>          <span class="n">QTotUnitOut</span>  <span class="o">=</span> <span class="n">AirMassFlow</span> <span class="o">*</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">Enthalpy</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-12766"></a>                         <span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">Enthalpy</span><span class="p">)</span>
<a name="ln-12767"></a>
<a name="ln-12768"></a>        <span class="k">CASE</span><span class="p">(</span><span class="n">LoadBased</span><span class="p">)</span>
<a name="ln-12769"></a>          <span class="n">MinHumRatio</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NodeNumofControlledZone</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-12770"></a>          <span class="n">QSensUnitOut</span> <span class="o">=</span> <span class="n">AirMassFlow</span> <span class="o">*</span> <span class="p">(</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">MinHumRatio</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-12771"></a>                           <span class="o">-</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NodeNumofControlledZone</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">MinHumRatio</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-12772"></a>                           <span class="o">-</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SenLoadLoss</span>
<a name="ln-12773"></a>          <span class="n">QTotUnitOut</span>  <span class="o">=</span> <span class="n">AirMassFlow</span> <span class="o">*</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">Enthalpy</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-12774"></a>                         <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">NodeNumofControlledZone</span><span class="p">)%</span><span class="n">Enthalpy</span><span class="p">)</span>
<a name="ln-12775"></a>
<a name="ln-12776"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-12777"></a>
<a name="ln-12778"></a>      <span class="k">END SELECT</span>
<a name="ln-12779"></a>
<a name="ln-12780"></a>      <span class="c">! set the system part-load ratio report variable</span>
<a name="ln-12781"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingPartLoadFrac</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-12782"></a>                                                      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingPartLoadFrac</span><span class="p">)</span>
<a name="ln-12783"></a>      <span class="c">! set the compressor part-load ratio report variable</span>
<a name="ln-12784"></a>      <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span><span class="p">)</span>
<a name="ln-12785"></a>        <span class="k">CASE</span><span class="p">(</span><span class="n">CoilDX_HeatingEmpirical</span><span class="p">,</span> <span class="n">CoilDX_MultiSpeedHeating</span><span class="p">,</span> <span class="n">Coil_HeatingWaterToAirHP</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-12786"></a>             <span class="n">Coil_HeatingWaterToAirHPSimple</span><span class="p">,</span> <span class="n">Coil_HeatingWaterToAirHPVSEquationFit</span><span class="p">,</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span><span class="p">)</span>
<a name="ln-12787"></a><span class="c">! wasn&#39;t this already set in the calc routine?</span>
<a name="ln-12788"></a><span class="c">! they look wrong anyway since the compressor can be off when the fan is on</span>
<a name="ln-12789"></a><span class="c">!          UnitarySystem(UnitarySysNum)%CompPartLoadRatio = UnitarySystem(UnitarySysNum)%PartLoadFrac</span>
<a name="ln-12790"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-12791"></a><span class="c">!          UnitarySystem(UnitarySysNum)%CompPartLoadRatio = UnitarySystem(UnitarySysNum)%CoolingPartLoadFrac</span>
<a name="ln-12792"></a>      <span class="k">END SELECT</span>
<a name="ln-12793"></a><span class="k">      </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCompPartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-12794"></a>                                                           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCompPartLoadRatio</span><span class="p">)</span>
<a name="ln-12795"></a>
<a name="ln-12796"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">HeatingLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12797"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">TotCoolEnergyRate</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12798"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SensCoolEnergyRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12799"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">LatCoolEnergyRate</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12800"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">TotHeatEnergyRate</span>  <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="n">QTotUnitOut</span><span class="p">))</span>
<a name="ln-12801"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SensHeatEnergyRate</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="n">QSensUnitOut</span><span class="p">))</span>
<a name="ln-12802"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">LatHeatEnergyRate</span>  <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="p">(</span><span class="n">QTotUnitOut</span> <span class="o">-</span> <span class="n">QSensUnitOut</span><span class="p">)))</span>
<a name="ln-12803"></a>      <span class="k">ELSE</span>
<a name="ln-12804"></a><span class="k">        </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">TotCoolEnergyRate</span>  <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="nb">MIN</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="n">QTotUnitOut</span><span class="p">))</span>
<a name="ln-12805"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SensCoolEnergyRate</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="nb">MIN</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="n">QSensUnitOut</span><span class="p">))</span>
<a name="ln-12806"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">LatCoolEnergyRate</span>  <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="nb">MIN</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="p">(</span><span class="n">QTotUnitOut</span> <span class="o">-</span> <span class="n">QSensUnitOut</span><span class="p">)))</span>
<a name="ln-12807"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">TotHeatEnergyRate</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12808"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SensHeatEnergyRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12809"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">LatHeatEnergyRate</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12810"></a>      <span class="k">END IF</span>
<a name="ln-12811"></a>
<a name="ln-12812"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanExists</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12813"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">CompOnMassFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12814"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanPartLoadRatio</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">/</span> <span class="n">CompOnMassFlow</span>
<a name="ln-12815"></a>        <span class="k">ELSE</span>
<a name="ln-12816"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12817"></a>        <span class="k">END IF</span>
<a name="ln-12818"></a><span class="k">        IF</span><span class="p">(</span><span class="n">AirLoopNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12819"></a><span class="k">          IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span> <span class="o">==</span> <span class="n">CycFanCycCoil</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12820"></a><span class="k">            </span><span class="n">AirLoopflow</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">FanPLR</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanPartLoadRatio</span>
<a name="ln-12821"></a>          <span class="k">ELSE</span>
<a name="ln-12822"></a><span class="k">            </span><span class="n">AirLoopflow</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">FanPLR</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12823"></a>          <span class="k">END IF</span>
<a name="ln-12824"></a><span class="k">        END IF</span>
<a name="ln-12825"></a><span class="k">      END IF</span>
<a name="ln-12826"></a>
<a name="ln-12827"></a><span class="k">      SELECT CASE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span><span class="p">)</span>
<a name="ln-12828"></a>
<a name="ln-12829"></a>        <span class="k">CASE</span><span class="p">(</span><span class="n">CoilDX_CoolingTwoSpeed</span><span class="p">)</span>
<a name="ln-12830"></a>          <span class="c">! need to make sure these are 0 for non-variable speed coils (or not report these variables)</span>
<a name="ln-12831"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CycRatio</span>     <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCycRatio</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-12832"></a>                                                          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCycRatio</span><span class="p">)</span>
<a name="ln-12833"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SpeedRatio</span>   <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-12834"></a>                                                          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span><span class="p">)</span>
<a name="ln-12835"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SpeedNum</span>     <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedNum</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-12836"></a>                                                          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedNum</span><span class="p">)</span>
<a name="ln-12837"></a>
<a name="ln-12838"></a>        <span class="k">CASE</span><span class="p">(</span><span class="n">CoilDX_MultiSpeedCooling</span><span class="p">)</span>
<a name="ln-12839"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CycRatio</span>     <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCycRatio</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-12840"></a>                                                          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCycRatio</span><span class="p">)</span>
<a name="ln-12841"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SpeedRatio</span>   <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-12842"></a>                                                          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span><span class="p">)</span>
<a name="ln-12843"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SpeedNum</span>     <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedNum</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-12844"></a>                                                          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedNum</span><span class="p">)</span>
<a name="ln-12845"></a>
<a name="ln-12846"></a>          <span class="n">CompPartLoadFrac</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span>
<a name="ln-12847"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">CoolingLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12848"></a>
<a name="ln-12849"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">TotalAuxElecPower</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">AncillaryOnPower</span> <span class="o">*</span> <span class="n">CompPartLoadFrac</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-12850"></a>                                                         <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">AncillaryOffPower</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">CompPartLoadFrac</span><span class="p">)</span>
<a name="ln-12851"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingAuxElecConsumption</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">AncillaryOnPower</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-12852"></a>                                                                   <span class="n">CompPartLoadFrac</span> <span class="o">*</span> <span class="n">ReportingConstant</span>
<a name="ln-12853"></a>          <span class="k">END IF</span>
<a name="ln-12854"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">LastMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CoolingMode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12855"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingAuxElecConsumption</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingAuxElecConsumption</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-12856"></a>                              <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">AncillaryOffPower</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">CompPartLoadFrac</span><span class="p">)</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-12857"></a>
<a name="ln-12858"></a>          <span class="k">END IF</span>
<a name="ln-12859"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ElecPower</span> <span class="o">=</span> <span class="n">FanElecPower</span> <span class="o">+</span> <span class="n">DXElecCoolingPower</span> <span class="o">+</span> <span class="n">DXElecHeatingPower</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-12860"></a>                                                   <span class="n">ElecHeatingCoilPower</span> <span class="o">+</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">TotalAuxElecPower</span>
<a name="ln-12861"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ElecPowerConsumption</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ElecPower</span> <span class="o">*</span> <span class="n">ReportingConstant</span>
<a name="ln-12862"></a>
<a name="ln-12863"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-12864"></a>
<a name="ln-12865"></a>      <span class="k">END SELECT</span>
<a name="ln-12866"></a>
<a name="ln-12867"></a><span class="k">      SELECT CASE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span><span class="p">)</span>
<a name="ln-12868"></a>
<a name="ln-12869"></a>        <span class="k">CASE</span><span class="p">(</span><span class="n">CoilDX_MultiSpeedHeating</span><span class="p">)</span>
<a name="ln-12870"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CycRatio</span>     <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCycRatio</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-12871"></a>                                                          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCycRatio</span><span class="p">)</span>
<a name="ln-12872"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SpeedRatio</span>   <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-12873"></a>                                                          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span><span class="p">)</span>
<a name="ln-12874"></a>
<a name="ln-12875"></a>          <span class="n">CompPartLoadFrac</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span>
<a name="ln-12876"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">HeatingLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12877"></a>
<a name="ln-12878"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">TotalAuxElecPower</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">AncillaryOnPower</span> <span class="o">*</span> <span class="n">CompPartLoadFrac</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-12879"></a>                                                         <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">AncillaryOffPower</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">CompPartLoadFrac</span><span class="p">)</span>
<a name="ln-12880"></a>            <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingAuxElecConsumption</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">AncillaryOnPower</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-12881"></a>                                                                     <span class="n">CompPartLoadFrac</span> <span class="o">*</span> <span class="n">ReportingConstant</span>
<a name="ln-12882"></a>          <span class="k">END IF</span>
<a name="ln-12883"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">LastMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">HeatingMode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12884"></a><span class="k">            </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingAuxElecConsumption</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingAuxElecConsumption</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-12885"></a>                                <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">AncillaryOffPower</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">CompPartLoadFrac</span><span class="p">)</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-12886"></a>
<a name="ln-12887"></a>          <span class="k">END IF</span>
<a name="ln-12888"></a><span class="k">          </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ElecPower</span> <span class="o">=</span> <span class="n">FanElecPower</span> <span class="o">+</span> <span class="n">DXElecCoolingPower</span> <span class="o">+</span> <span class="n">DXElecHeatingPower</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-12889"></a>                                                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">TotalAuxElecPower</span>
<a name="ln-12890"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ElecPowerConsumption</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ElecPower</span> <span class="o">*</span> <span class="n">ReportingConstant</span>
<a name="ln-12891"></a>
<a name="ln-12892"></a>        <span class="k">CASE</span><span class="p">(</span><span class="n">Coil_HeatingGas_MultiStage</span><span class="p">,</span> <span class="n">Coil_HeatingElectric_MultiStage</span><span class="p">)</span>
<a name="ln-12893"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CycRatio</span>     <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCycRatio</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-12894"></a>                                                          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCycRatio</span><span class="p">)</span>
<a name="ln-12895"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SpeedRatio</span>   <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-12896"></a>                                                          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span><span class="p">)</span>
<a name="ln-12897"></a>
<a name="ln-12898"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ElecPower</span> <span class="o">=</span> <span class="n">FanElecPower</span> <span class="o">+</span> <span class="n">DXElecCoolingPower</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-12899"></a>                                                   <span class="n">ElecHeatingCoilPower</span> <span class="o">+</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">TotalAuxElecPower</span>
<a name="ln-12900"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ElecPowerConsumption</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ElecPower</span> <span class="o">*</span> <span class="n">ReportingConstant</span>
<a name="ln-12901"></a>
<a name="ln-12902"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-12903"></a>
<a name="ln-12904"></a>      <span class="k">END SELECT</span>
<a name="ln-12905"></a>
<a name="ln-12906"></a><span class="k">  </span><span class="n">LoopSystemOnMassFlowrate</span> <span class="o">=</span> <span class="n">CompOnMassFlow</span>
<a name="ln-12907"></a>  <span class="n">LoopSystemOffMassFlowrate</span> <span class="o">=</span> <span class="n">CompOffMassFlow</span>
<a name="ln-12908"></a>  <span class="n">LoopFanOperationMode</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span>
<a name="ln-12909"></a>  <span class="n">LoopOnOffFanPartLoadRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanPartLoadRatio</span>
<a name="ln-12910"></a>  <span class="n">LoopCompCycRatio</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CycRatio</span>
<a name="ln-12911"></a>
<a name="ln-12912"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12913"></a><span class="k">    </span><span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-12914"></a>    <span class="n">OASysEqSizing</span><span class="p">(</span><span class="n">CurOASysNum</span><span class="p">)%</span><span class="n">Capacity</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-12915"></a>  <span class="k">ELSE IF</span><span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12916"></a><span class="k">    </span><span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-12917"></a>    <span class="n">UnitarySysEqSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">Capacity</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-12918"></a>    <span class="n">AirLoopControlInfo</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">UnitarySysSimulating</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-12919"></a>  <span class="k">ELSE IF</span><span class="p">(</span><span class="n">CurZoneEqNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-12920"></a><span class="k">    </span><span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-12921"></a>    <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">Capacity</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-12922"></a>  <span class="k">END IF</span>
<a name="ln-12923"></a>
<a name="ln-12924"></a><span class="k">RETURN</span>
<a name="ln-12925"></a><span class="k">END SUBROUTINE </span><span class="n">ReportUnitarySystem</span>
<a name="ln-12926"></a>
<a name="ln-12927"></a><span class="k">SUBROUTINE </span><span class="n">UnitarySystemHeatRecovery</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)</span>
<a name="ln-12928"></a>
<a name="ln-12929"></a>            <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-12930"></a>            <span class="c">!       AUTHOR:          Chandan Sharma</span>
<a name="ln-12931"></a>            <span class="c">!       DATE WRITTEN:    May 2013</span>
<a name="ln-12932"></a>            <span class="c">!       MODIFIED:        na</span>
<a name="ln-12933"></a>            <span class="c">!       RE-ENGINEERED    na</span>
<a name="ln-12934"></a>
<a name="ln-12935"></a>            <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-12936"></a>            <span class="c">!  Calculate the heat recovered from UnitarySystem</span>
<a name="ln-12937"></a>
<a name="ln-12938"></a>            <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-12939"></a>            <span class="c">!  na</span>
<a name="ln-12940"></a>
<a name="ln-12941"></a>            <span class="c">! REFERENCES:</span>
<a name="ln-12942"></a>            <span class="c">!  na</span>
<a name="ln-12943"></a>
<a name="ln-12944"></a>            <span class="c">! USE STATEMENTS:</span>
<a name="ln-12945"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetSpecificHeatGlycol</span>
<a name="ln-12946"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>           <span class="n">ONLY</span><span class="p">:</span> <span class="n">PlantLoop</span>
<a name="ln-12947"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">SafeCopyPlantNode</span>
<a name="ln-12948"></a>
<a name="ln-12949"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-12950"></a>
<a name="ln-12951"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-12952"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">UnitarySysNum</span> <span class="c">! Number of the current electric UnitarySystem being simulated</span>
<a name="ln-12953"></a>
<a name="ln-12954"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-12955"></a>          <span class="c">!  na</span>
<a name="ln-12956"></a>
<a name="ln-12957"></a>          <span class="c">! DERIVMS TYPE DEFINITIONS:</span>
<a name="ln-12958"></a>          <span class="c">!  na</span>
<a name="ln-12959"></a>
<a name="ln-12960"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-12961"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">HeatRecInNode</span>       <span class="c">! Node number of heat recovery water inlet node</span>
<a name="ln-12962"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">HeatRecOutNode</span>      <span class="c">! Node number of heat recovery water outlet node</span>
<a name="ln-12963"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QHeatRec</span>            <span class="c">! Total heat recovered [W]</span>
<a name="ln-12964"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeatRecInletTemp</span>    <span class="c">! Heat reclaim inlet temp [C]</span>
<a name="ln-12965"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeatRecOutletTemp</span>   <span class="c">! Heat reclaim outlet temp [C]</span>
<a name="ln-12966"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeatRecMassFlowRate</span> <span class="c">! Heat reclaim mass flow rate [m3/s]</span>
<a name="ln-12967"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CpHeatRec</span>           <span class="c">! Heat reclaim water inlet specIFic heat [J/kg-K]</span>
<a name="ln-12968"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeatRecInletEnth</span>    <span class="c">! Heat reclaim water inlet enthalpy [J/kg]</span>
<a name="ln-12969"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ReportingConstant</span>
<a name="ln-12970"></a>
<a name="ln-12971"></a>  <span class="n">ReportingConstant</span> <span class="o">=</span> <span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-12972"></a>
<a name="ln-12973"></a>  <span class="c">! Begin routine</span>
<a name="ln-12974"></a>  <span class="n">HeatRecInNode</span>  <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatRecoveryInletNodeNum</span>
<a name="ln-12975"></a>  <span class="n">HeatRecOutNode</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatRecoveryOutletNodeNum</span>
<a name="ln-12976"></a>
<a name="ln-12977"></a>   <span class="c">! Inlet node to the heat recovery heat exchanger</span>
<a name="ln-12978"></a>  <span class="n">HeatRecInletTemp</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">HeatRecInNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-12979"></a>  <span class="n">HeatRecInletEnth</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">HeatRecInNode</span><span class="p">)%</span><span class="n">Enthalpy</span>
<a name="ln-12980"></a>
<a name="ln-12981"></a>   <span class="c">! Set heat recovery mass flow rates</span>
<a name="ln-12982"></a>  <span class="n">HeatRecMassFlowRate</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">HeatRecInNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-12983"></a>
<a name="ln-12984"></a>  <span class="n">QHeatRec</span> <span class="o">=</span> <span class="n">MSHPWasteHeat</span>
<a name="ln-12985"></a>
<a name="ln-12986"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">HeatRecMassFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12987"></a>
<a name="ln-12988"></a><span class="k">    </span><span class="n">CpHeatRec</span> <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-12989"></a>                                      <span class="n">HeatRecInletTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-12990"></a>                                      <span class="n">PlantLoop</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-12991"></a>                                      <span class="s1">&#39;UnitarySystemHeatRecovery&#39;</span><span class="p">)</span>
<a name="ln-12992"></a>
<a name="ln-12993"></a>    <span class="n">HeatRecOutletTemp</span> <span class="o">=</span> <span class="n">QHeatRec</span><span class="o">/</span><span class="p">(</span><span class="n">HeatRecMassFlowRate</span><span class="o">*</span><span class="n">CpHeatRec</span><span class="p">)</span> <span class="o">+</span> <span class="n">HeatRecInletTemp</span>
<a name="ln-12994"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">HeatRecOutletTemp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHROutletWaterTemp</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-12995"></a>        <span class="n">HeatRecOutletTemp</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHROutletWaterTemp</span>
<a name="ln-12996"></a>  <span class="k">ELSE</span>
<a name="ln-12997"></a><span class="k">    </span><span class="n">HeatRecOutletTemp</span> <span class="o">=</span> <span class="n">HeatRecInletTemp</span>
<a name="ln-12998"></a>  <span class="k">END IF</span>
<a name="ln-12999"></a>
<a name="ln-13000"></a><span class="k">  CALL </span><span class="n">SafeCopyPlantNode</span><span class="p">(</span><span class="n">HeatRecInNode</span><span class="p">,</span> <span class="n">HeatRecOutNode</span><span class="p">)</span>
<a name="ln-13001"></a>  <span class="c">! changed outputs</span>
<a name="ln-13002"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">HeatRecOutNode</span><span class="p">)%</span><span class="n">Temp</span>         <span class="o">=</span> <span class="n">HeatRecOutletTemp</span>
<a name="ln-13003"></a>
<a name="ln-13004"></a>  <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatRecoveryRate</span>         <span class="o">=</span> <span class="n">QHeatRec</span>
<a name="ln-13005"></a>  <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatRecoveryEnergy</span>       <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatRecoveryRate</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-13006"></a>  <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatRecoveryInletTemp</span>    <span class="o">=</span> <span class="n">HeatRecInletTemp</span>
<a name="ln-13007"></a>  <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatRecoveryOutletTemp</span>   <span class="o">=</span> <span class="n">HeatRecOutletTemp</span>
<a name="ln-13008"></a>  <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatRecoveryMassFlowRate</span> <span class="o">=</span> <span class="n">HeatRecMassFlowRate</span>
<a name="ln-13009"></a>
<a name="ln-13010"></a>  <span class="k">RETURN</span>
<a name="ln-13011"></a>
<a name="ln-13012"></a><span class="k">END SUBROUTINE </span><span class="n">UnitarySystemHeatRecovery</span>
<a name="ln-13013"></a>
<a name="ln-13014"></a><span class="k">FUNCTION </span><span class="n">DXHeatingCoilResidual</span><span class="p">(</span><span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Residuum</span><span class="p">)</span>
<a name="ln-13015"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-13016"></a>          <span class="c">!       AUTHOR         Richard Raustad, FSEC</span>
<a name="ln-13017"></a>          <span class="c">!       DATE WRITTEN   June 2006</span>
<a name="ln-13018"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-13019"></a>          <span class="c">!       RE-ENGINEERED</span>
<a name="ln-13020"></a>
<a name="ln-13021"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-13022"></a>          <span class="c">! Calculates residual function (desired outlet temp - actual outlet temp)</span>
<a name="ln-13023"></a>          <span class="c">! DX Coil output depends on the part load ratio which is being varied to zero the residual.</span>
<a name="ln-13024"></a>
<a name="ln-13025"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-13026"></a>          <span class="c">! Calls CalcDOe2DXCoil to get outlet temperature at the given cycling ratio</span>
<a name="ln-13027"></a>          <span class="c">! and calculates the residual as defined above</span>
<a name="ln-13028"></a>
<a name="ln-13029"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-13030"></a>
<a name="ln-13031"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-13032"></a>  <span class="k">USE </span><span class="n">DXCoils</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">DXCoilOutletTemp</span><span class="p">,</span> <span class="n">CalcDXHeatingCoil</span>
<a name="ln-13033"></a>
<a name="ln-13034"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-13035"></a>
<a name="ln-13036"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-13037"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">PartLoadFrac</span>               <span class="c">! Compressor cycling ratio (1.0 is continuous, 0.0 is off)</span>
<a name="ln-13038"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">Par</span> <span class="c">! Par(1) = DX coil number</span>
<a name="ln-13039"></a>                                                    <span class="c">! Par(2) = desired air outlet temperature [C]</span>
<a name="ln-13040"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">Residuum</span>                   <span class="c">! Residual to be minimized to zero</span>
<a name="ln-13041"></a>
<a name="ln-13042"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-13043"></a>          <span class="c">! na</span>
<a name="ln-13044"></a>
<a name="ln-13045"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-13046"></a>          <span class="c">! na</span>
<a name="ln-13047"></a>
<a name="ln-13048"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-13049"></a>          <span class="c">! na</span>
<a name="ln-13050"></a>
<a name="ln-13051"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-13052"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">CoilIndex</span>        <span class="c">! Index of this coil</span>
<a name="ln-13053"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">OutletAirTemp</span>    <span class="c">! Outlet air temperature [C]</span>
<a name="ln-13054"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">OnOffAirFlowFrac</span> <span class="c">! Ratio of compressor ON to compressor OFF air mass flow rate</span>
<a name="ln-13055"></a>
<a name="ln-13056"></a>  <span class="n">CoilIndex</span>        <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-13057"></a>  <span class="n">OnOffAirFlowFrac</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-13058"></a>
<a name="ln-13059"></a>  <span class="k">CALL </span><span class="n">CalcDXHeatingCoil</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">ContFanCycCoil</span><span class="p">,</span><span class="n">OnOffAirFlowFrac</span><span class="p">)</span>
<a name="ln-13060"></a>
<a name="ln-13061"></a>  <span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">DXCoilOutletTemp</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">)</span>
<a name="ln-13062"></a>  <span class="n">Residuum</span>      <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">OutletAirTemp</span>
<a name="ln-13063"></a>
<a name="ln-13064"></a>  <span class="k">RETURN</span>
<a name="ln-13065"></a><span class="k">END FUNCTION </span><span class="n">DXHeatingCoilResidual</span>
<a name="ln-13066"></a>
<a name="ln-13067"></a><span class="k">FUNCTION </span><span class="n">DXCoilVarSpeedResidual</span><span class="p">(</span><span class="n">SpeedRatio</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Residuum</span><span class="p">)</span>
<a name="ln-13068"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-13069"></a>          <span class="c">!       AUTHOR         Fred Buhl</span>
<a name="ln-13070"></a>          <span class="c">!       DATE WRITTEN   September 2002</span>
<a name="ln-13071"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-13072"></a>          <span class="c">!       RE-ENGINEERED</span>
<a name="ln-13073"></a>
<a name="ln-13074"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-13075"></a>          <span class="c">! Calculates residual function (desired outlet temp - actual outlet temp).</span>
<a name="ln-13076"></a>          <span class="c">! DX Coil output depends on the compressor speed which is being varied to zero the residual.</span>
<a name="ln-13077"></a>
<a name="ln-13078"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-13079"></a>          <span class="c">! Calls CalcMultiSpeedDXCoil to get outlet temperature at the given compressor speed</span>
<a name="ln-13080"></a>          <span class="c">! and calculates the residual as defined above</span>
<a name="ln-13081"></a>
<a name="ln-13082"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-13083"></a>
<a name="ln-13084"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-13085"></a>  <span class="k">USE </span><span class="n">DXCoils</span><span class="p">,</span>                   <span class="n">ONLY</span><span class="p">:</span> <span class="n">DXCoilOutletTemp</span><span class="p">,</span> <span class="n">CalcMultiSpeedDXCoil</span><span class="p">,</span> <span class="n">CalcMultiSpeedDXCoilCooling</span>
<a name="ln-13086"></a>  <span class="k">USE </span><span class="n">VariableSpeedCoils</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">CalcVarSpeedCoilCooling</span>
<a name="ln-13087"></a>
<a name="ln-13088"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-13089"></a>
<a name="ln-13090"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-13091"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">SpeedRatio</span> <span class="c">! compressor speed ratio (1.0 is max, 0.0 is min)</span>
<a name="ln-13092"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">Par</span> <span class="c">! par(1) = DX coil number</span>
<a name="ln-13093"></a>                                                    <span class="c">! par(2) = desired air outlet temperature [C]</span>
<a name="ln-13094"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">Residuum</span> <span class="c">! residual to be minimized to zero</span>
<a name="ln-13095"></a>
<a name="ln-13096"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-13097"></a>          <span class="c">! na</span>
<a name="ln-13098"></a>
<a name="ln-13099"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-13100"></a>          <span class="c">! na</span>
<a name="ln-13101"></a>
<a name="ln-13102"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-13103"></a>          <span class="c">! na</span>
<a name="ln-13104"></a>
<a name="ln-13105"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-13106"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoilIndex</span>        <span class="c">! index of this coil</span>
<a name="ln-13107"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">UnitarySysNum</span> <span class="c">! index to Unitary System</span>
<a name="ln-13108"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirTemp</span>   <span class="c">! outlet air temperature [C]</span>
<a name="ln-13109"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CycRatio</span>
<a name="ln-13110"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">SpeedNum</span>
<a name="ln-13111"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">FanOpMode</span>
<a name="ln-13112"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CompOp</span>
<a name="ln-13113"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ReqOutput</span>
<a name="ln-13114"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dummy</span>
<a name="ln-13115"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RuntimeFrac</span>
<a name="ln-13116"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>
<a name="ln-13117"></a>
<a name="ln-13118"></a>
<a name="ln-13119"></a>  <span class="n">CoilIndex</span>     <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-13120"></a>  <span class="n">UnitarySysNum</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-13121"></a>
<a name="ln-13122"></a>  <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span><span class="p">)</span>
<a name="ln-13123"></a>
<a name="ln-13124"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_CoolingTwoSpeed</span><span class="p">)</span>
<a name="ln-13125"></a>
<a name="ln-13126"></a>      <span class="k">CALL </span><span class="n">CalcMultiSpeedDXCoil</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-13127"></a>      <span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">DXCoilOutletTemp</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">)</span>
<a name="ln-13128"></a>
<a name="ln-13129"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_MultiSpeedCooling</span><span class="p">)</span>
<a name="ln-13130"></a>
<a name="ln-13131"></a>      <span class="n">CycRatio</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-13132"></a>      <span class="n">SpeedNum</span>   <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-13133"></a>      <span class="n">FanOpMode</span>  <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-13134"></a>      <span class="n">CompOp</span>     <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<a name="ln-13135"></a>
<a name="ln-13136"></a>      <span class="k">CALL </span><span class="n">CalcMultiSpeedDXCoilCooling</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="n">CycRatio</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">)</span>
<a name="ln-13137"></a>      <span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">DXCoilOutletTemp</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">)</span>
<a name="ln-13138"></a>
<a name="ln-13139"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_CoolingAirToAirVariableSpeed</span><span class="p">,</span> <span class="n">Coil_CoolingWaterToAirHPVSEquationFit</span><span class="p">)</span>
<a name="ln-13140"></a>
<a name="ln-13141"></a>      <span class="n">CycRatio</span>   <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-13142"></a>      <span class="n">SpeedNum</span>   <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-13143"></a>      <span class="n">FanOpMode</span>  <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-13144"></a>      <span class="n">CompOp</span>     <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<a name="ln-13145"></a>      <span class="n">ReqOutput</span>  <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-13146"></a>      <span class="n">dummy</span>      <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-13147"></a>      <span class="n">RuntimeFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-13148"></a>      <span class="n">OnOffAirFlowRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-13149"></a>
<a name="ln-13150"></a>      <span class="k">CALL </span><span class="n">CalcVarSpeedCoilCooling</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">RuntimeFrac</span><span class="p">,&amp;</span>
<a name="ln-13151"></a>                <span class="n">ReqOutput</span><span class="p">,</span><span class="n">dummy</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">CycRatio</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">SpeedRatio</span><span class="p">,</span> <span class="n">SpeedNum</span><span class="p">)</span>
<a name="ln-13152"></a>
<a name="ln-13153"></a>      <span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilOutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-13154"></a>
<a name="ln-13155"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-13156"></a>
<a name="ln-13157"></a>  <span class="k">END SELECT</span>
<a name="ln-13158"></a>
<a name="ln-13159"></a><span class="k">  </span><span class="n">Residuum</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">OutletAirTemp</span>
<a name="ln-13160"></a>
<a name="ln-13161"></a>  <span class="k">RETURN</span>
<a name="ln-13162"></a><span class="k">END FUNCTION </span><span class="n">DXCoilVarSpeedResidual</span>
<a name="ln-13163"></a>
<a name="ln-13164"></a><span class="k">FUNCTION </span><span class="n">HeatingCoilVarSpeedResidual</span><span class="p">(</span><span class="n">SpeedRatio</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Residuum</span><span class="p">)</span>
<a name="ln-13165"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-13166"></a>          <span class="c">!       AUTHOR         Fred Buhl</span>
<a name="ln-13167"></a>          <span class="c">!       DATE WRITTEN   September 2002</span>
<a name="ln-13168"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-13169"></a>          <span class="c">!       RE-ENGINEERED</span>
<a name="ln-13170"></a>
<a name="ln-13171"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-13172"></a>          <span class="c">! Calculates residual function (desired outlet temp - actual outlet temp).</span>
<a name="ln-13173"></a>          <span class="c">! DX Coil output depends on the compressor speed which is being varied to zero the residual.</span>
<a name="ln-13174"></a>
<a name="ln-13175"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-13176"></a>          <span class="c">! Calls calc routines of  multi Speed or variable Coil to get outlet temperature at the given compressor speed</span>
<a name="ln-13177"></a>          <span class="c">! and calculates the residual as defined above</span>
<a name="ln-13178"></a>
<a name="ln-13179"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-13180"></a>
<a name="ln-13181"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-13182"></a>  <span class="k">USE </span><span class="n">DXCoils</span><span class="p">,</span>               <span class="n">ONLY</span><span class="p">:</span> <span class="n">DXCoilOutletTemp</span><span class="p">,</span> <span class="n">CalcMultiSpeedDXCoil</span><span class="p">,</span> <span class="n">CalcMultiSpeedDXCoilHeating</span>
<a name="ln-13183"></a>  <span class="k">USE </span><span class="n">VariableSpeedCoils</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">CalcVarSpeedCoilHeating</span>
<a name="ln-13184"></a>  <span class="k">USE </span><span class="n">HeatingCoils</span><span class="p">,</span>          <span class="n">ONLY</span><span class="p">:</span> <span class="n">CalcMultiStageElectricHeatingCoil</span><span class="p">,</span> <span class="n">CalcMultiStageGasHeatingCoil</span>
<a name="ln-13185"></a>
<a name="ln-13186"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-13187"></a>
<a name="ln-13188"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-13189"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">SpeedRatio</span> <span class="c">! compressor speed ratio (1.0 is max, 0.0 is min)</span>
<a name="ln-13190"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">Par</span> <span class="c">! par(1) = DX coil number</span>
<a name="ln-13191"></a>                                                    <span class="c">! par(2) = desired air outlet temperature [C]</span>
<a name="ln-13192"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">Residuum</span> <span class="c">! residual to be minimized to zero</span>
<a name="ln-13193"></a>
<a name="ln-13194"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-13195"></a>          <span class="c">! na</span>
<a name="ln-13196"></a>
<a name="ln-13197"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-13198"></a>          <span class="c">! na</span>
<a name="ln-13199"></a>
<a name="ln-13200"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-13201"></a>          <span class="c">! na</span>
<a name="ln-13202"></a>
<a name="ln-13203"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-13204"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoilIndex</span>        <span class="c">! index of this coil</span>
<a name="ln-13205"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">UnitarySysNum</span> <span class="c">! index to Unitary System</span>
<a name="ln-13206"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirTemp</span>   <span class="c">! outlet air temperature [C]</span>
<a name="ln-13207"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CycRatio</span>
<a name="ln-13208"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">SpeedNum</span>
<a name="ln-13209"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">FanOpMode</span>
<a name="ln-13210"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CompOp</span>
<a name="ln-13211"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ReqOutput</span>
<a name="ln-13212"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RuntimeFrac</span>
<a name="ln-13213"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>
<a name="ln-13214"></a>
<a name="ln-13215"></a>  <span class="n">CoilIndex</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-13216"></a>  <span class="n">UnitarySysNum</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-13217"></a>
<a name="ln-13218"></a>  <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span><span class="p">)</span>
<a name="ln-13219"></a>
<a name="ln-13220"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_MultiSpeedHeating</span><span class="p">)</span>
<a name="ln-13221"></a>
<a name="ln-13222"></a>      <span class="n">CycRatio</span>   <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-13223"></a>      <span class="n">SpeedNum</span>   <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-13224"></a>      <span class="n">FanOpMode</span>  <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-13225"></a>
<a name="ln-13226"></a>      <span class="k">CALL </span><span class="n">CalcMultiSpeedDXCoilHeating</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="n">CycRatio</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">)</span>
<a name="ln-13227"></a>
<a name="ln-13228"></a>      <span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">DXCoilOutletTemp</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">)</span>
<a name="ln-13229"></a>
<a name="ln-13230"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_HeatingAirToAirVariableSpeed</span><span class="p">,</span> <span class="n">Coil_HeatingWaterToAirHPVSEquationFit</span><span class="p">)</span>
<a name="ln-13231"></a>
<a name="ln-13232"></a>      <span class="n">CycRatio</span>   <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-13233"></a>      <span class="n">SpeedNum</span>   <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-13234"></a>      <span class="n">FanOpMode</span>  <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-13235"></a>      <span class="n">CompOp</span>     <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<a name="ln-13236"></a>      <span class="n">ReqOutput</span>  <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-13237"></a>      <span class="n">RuntimeFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-13238"></a>      <span class="n">OnOffAirFlowRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-13239"></a>
<a name="ln-13240"></a>      <span class="k">CALL </span><span class="n">CalcVarSpeedCoilHeating</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">RuntimeFrac</span><span class="p">,&amp;</span>
<a name="ln-13241"></a>                <span class="n">ReqOutput</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">CycRatio</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">SpeedRatio</span><span class="p">,</span> <span class="n">SpeedNum</span><span class="p">)</span>
<a name="ln-13242"></a>
<a name="ln-13243"></a>      <span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilOutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-13244"></a>
<a name="ln-13245"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_HeatingElectric_MultiStage</span><span class="p">)</span>
<a name="ln-13246"></a>
<a name="ln-13247"></a>      <span class="n">CycRatio</span>   <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-13248"></a>      <span class="n">SpeedNum</span>   <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-13249"></a>      <span class="n">FanOpMode</span>  <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-13250"></a>
<a name="ln-13251"></a>      <span class="k">CALL </span><span class="n">CalcMultiStageElectricHeatingCoil</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="n">CycRatio</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">)</span>
<a name="ln-13252"></a>
<a name="ln-13253"></a>      <span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilOutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-13254"></a>
<a name="ln-13255"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_HeatingGas_MultiStage</span><span class="p">)</span>
<a name="ln-13256"></a>
<a name="ln-13257"></a>      <span class="n">CycRatio</span>   <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-13258"></a>      <span class="n">SpeedNum</span>   <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-13259"></a>      <span class="n">FanOpMode</span>  <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-13260"></a>
<a name="ln-13261"></a>      <span class="k">CALL </span><span class="n">CalcMultiStageElectricHeatingCoil</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="n">CycRatio</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">)</span>
<a name="ln-13262"></a>
<a name="ln-13263"></a>      <span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilOutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-13264"></a>
<a name="ln-13265"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-13266"></a>
<a name="ln-13267"></a>  <span class="k">END SELECT</span>
<a name="ln-13268"></a>
<a name="ln-13269"></a><span class="k">  </span><span class="n">Residuum</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">OutletAirTemp</span>
<a name="ln-13270"></a>
<a name="ln-13271"></a>  <span class="k">RETURN</span>
<a name="ln-13272"></a><span class="k">END FUNCTION </span><span class="n">HeatingCoilVarSpeedResidual</span>
<a name="ln-13273"></a>
<a name="ln-13274"></a><span class="k">FUNCTION </span><span class="n">DXCoilVarSpeedHumRatResidual</span><span class="p">(</span><span class="n">SpeedRatio</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Residuum</span><span class="p">)</span>
<a name="ln-13275"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-13276"></a>          <span class="c">!       AUTHOR         Richard Raustad</span>
<a name="ln-13277"></a>          <span class="c">!       DATE WRITTEN   January 2008</span>
<a name="ln-13278"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-13279"></a>          <span class="c">!       RE-ENGINEERED</span>
<a name="ln-13280"></a>
<a name="ln-13281"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-13282"></a>          <span class="c">! Calculates residual function (desired outlet humrat - actual outlet humrat).</span>
<a name="ln-13283"></a>          <span class="c">! DX Coil output depends on the compressor speed which is being varied to zero the residual.</span>
<a name="ln-13284"></a>
<a name="ln-13285"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-13286"></a>          <span class="c">! Calls calc routine sof multi speed or variable speed coils to get outlet humidity ratio at the given compressor speed</span>
<a name="ln-13287"></a>          <span class="c">! and calculates the residual as defined above</span>
<a name="ln-13288"></a>
<a name="ln-13289"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-13290"></a>
<a name="ln-13291"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-13292"></a>  <span class="k">USE </span><span class="n">DXCoils</span><span class="p">,</span>                   <span class="n">ONLY</span><span class="p">:</span> <span class="n">DXCoilOutletHumRat</span><span class="p">,</span> <span class="n">CalcMultiSpeedDXCoil</span><span class="p">,</span> <span class="n">CalcMultiSpeedDXCoilCooling</span>
<a name="ln-13293"></a>  <span class="k">USE </span><span class="n">VariableSpeedCoils</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">CalcVarSpeedCoilCooling</span>
<a name="ln-13294"></a>
<a name="ln-13295"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-13296"></a>
<a name="ln-13297"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-13298"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">SpeedRatio</span> <span class="c">! compressor speed ratio (1.0 is max, 0.0 is min)</span>
<a name="ln-13299"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">Par</span> <span class="c">! par(1) = DX coil number</span>
<a name="ln-13300"></a>                                                    <span class="c">! par(2) = desired air outlet humidity ratio [kg/kg]</span>
<a name="ln-13301"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">Residuum</span> <span class="c">! residual to be minimized to zero</span>
<a name="ln-13302"></a>
<a name="ln-13303"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-13304"></a>          <span class="c">! na</span>
<a name="ln-13305"></a>
<a name="ln-13306"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-13307"></a>          <span class="c">! na</span>
<a name="ln-13308"></a>
<a name="ln-13309"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-13310"></a>          <span class="c">! na</span>
<a name="ln-13311"></a>
<a name="ln-13312"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-13313"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoilIndex</span>         <span class="c">! index of this coil</span>
<a name="ln-13314"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">UnitarySysNum</span>     <span class="c">! index to Unitary System</span>
<a name="ln-13315"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirHumRat</span>   <span class="c">! outlet air humidity ratio</span>
<a name="ln-13316"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CycRatio</span>
<a name="ln-13317"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">SpeedNum</span>
<a name="ln-13318"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">FanOpMode</span>
<a name="ln-13319"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CompOp</span>
<a name="ln-13320"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ReqOutput</span>
<a name="ln-13321"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dummy</span>
<a name="ln-13322"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RuntimeFrac</span>
<a name="ln-13323"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>
<a name="ln-13324"></a>
<a name="ln-13325"></a>  <span class="n">CoilIndex</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-13326"></a>  <span class="n">UnitarySysNum</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-13327"></a>  <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span><span class="p">)</span>
<a name="ln-13328"></a>
<a name="ln-13329"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_CoolingTwoSpeed</span><span class="p">)</span>
<a name="ln-13330"></a>
<a name="ln-13331"></a>      <span class="k">CALL </span><span class="n">CalcMultiSpeedDXCoil</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-13332"></a>      <span class="n">OutletAirHumRat</span> <span class="o">=</span> <span class="n">DXCoilOutletHumRat</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">)</span>
<a name="ln-13333"></a>
<a name="ln-13334"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_MultiSpeedCooling</span><span class="p">)</span>
<a name="ln-13335"></a>
<a name="ln-13336"></a>      <span class="n">CycRatio</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-13337"></a>      <span class="n">SpeedNum</span>   <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-13338"></a>      <span class="n">FanOpMode</span>  <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-13339"></a>      <span class="n">CompOp</span>     <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<a name="ln-13340"></a>
<a name="ln-13341"></a>      <span class="k">CALL </span><span class="n">CalcMultiSpeedDXCoilCooling</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="n">CycRatio</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">)</span>
<a name="ln-13342"></a>      <span class="n">OutletAirHumRat</span> <span class="o">=</span> <span class="n">DXCoilOutletHumRat</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">)</span>
<a name="ln-13343"></a>
<a name="ln-13344"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_CoolingAirToAirVariableSpeed</span><span class="p">,</span> <span class="n">Coil_CoolingWaterToAirHPVSEquationFit</span><span class="p">)</span>
<a name="ln-13345"></a>
<a name="ln-13346"></a>      <span class="n">CycRatio</span>   <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-13347"></a>      <span class="n">SpeedNum</span>   <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-13348"></a>      <span class="n">FanOpMode</span>  <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-13349"></a>      <span class="n">CompOp</span>     <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<a name="ln-13350"></a>      <span class="n">ReqOutput</span>  <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-13351"></a>      <span class="n">dummy</span>      <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-13352"></a>      <span class="n">RuntimeFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-13353"></a>      <span class="n">OnOffAirFlowRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-13354"></a>
<a name="ln-13355"></a>      <span class="k">CALL </span><span class="n">CalcVarSpeedCoilCooling</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">RuntimeFrac</span><span class="p">,&amp;</span>
<a name="ln-13356"></a>                <span class="n">ReqOutput</span><span class="p">,</span><span class="n">dummy</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">CycRatio</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">SpeedRatio</span><span class="p">,</span> <span class="n">SpeedNum</span><span class="p">)</span>
<a name="ln-13357"></a>
<a name="ln-13358"></a>      <span class="n">OutletAirHumRat</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilOutletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-13359"></a>
<a name="ln-13360"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-13361"></a>
<a name="ln-13362"></a>  <span class="k">END SELECT</span>
<a name="ln-13363"></a>
<a name="ln-13364"></a><span class="k">  </span><span class="n">Residuum</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">OutletAirHumRat</span>
<a name="ln-13365"></a>
<a name="ln-13366"></a>  <span class="k">RETURN</span>
<a name="ln-13367"></a><span class="k">END FUNCTION </span><span class="n">DXCoilVarSpeedHumRatResidual</span>
<a name="ln-13368"></a>
<a name="ln-13369"></a><span class="k">FUNCTION </span><span class="n">DXCoilCyclingResidual</span><span class="p">(</span><span class="n">CycRatio</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Residuum</span><span class="p">)</span>
<a name="ln-13370"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-13371"></a>          <span class="c">!       AUTHOR         Fred Buhl</span>
<a name="ln-13372"></a>          <span class="c">!       DATE WRITTEN   September 2002</span>
<a name="ln-13373"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-13374"></a>          <span class="c">!       RE-ENGINEERED</span>
<a name="ln-13375"></a>
<a name="ln-13376"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-13377"></a>          <span class="c">! Calculates residual function (desired outlet temp - actual outlet temp)</span>
<a name="ln-13378"></a>          <span class="c">! DX Coil output depends on the cycling ratio which is being varied to zero the residual.</span>
<a name="ln-13379"></a>
<a name="ln-13380"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-13381"></a>          <span class="c">! Calls multi or variable speed coil to get outlet temperature at the given cycling ratio</span>
<a name="ln-13382"></a>          <span class="c">! and calculates the residual as defined above</span>
<a name="ln-13383"></a>
<a name="ln-13384"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-13385"></a>
<a name="ln-13386"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-13387"></a>  <span class="k">USE </span><span class="n">DXCoils</span><span class="p">,</span>             <span class="n">ONLY</span><span class="p">:</span> <span class="n">DXCoilOutletTemp</span><span class="p">,</span> <span class="n">CalcMultiSpeedDXCoil</span><span class="p">,</span> <span class="n">CalcMultiSpeedDXCoilCooling</span>
<a name="ln-13388"></a>  <span class="k">USE </span><span class="n">VariableSpeedCoils</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">CalcVarSpeedCoilCooling</span>
<a name="ln-13389"></a>
<a name="ln-13390"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-13391"></a>
<a name="ln-13392"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-13393"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CycRatio</span> <span class="c">! compressor cycling ratio (1.0 is continuous, 0.0 is off)</span>
<a name="ln-13394"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">Par</span> <span class="c">! par(1) = DX coil number</span>
<a name="ln-13395"></a>                                                    <span class="c">! par(2) = desired air outlet temperature [C]</span>
<a name="ln-13396"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">Residuum</span> <span class="c">! residual to be minimized to zero</span>
<a name="ln-13397"></a>
<a name="ln-13398"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-13399"></a>          <span class="c">! na</span>
<a name="ln-13400"></a>
<a name="ln-13401"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-13402"></a>          <span class="c">! na</span>
<a name="ln-13403"></a>
<a name="ln-13404"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-13405"></a>          <span class="c">! na</span>
<a name="ln-13406"></a>
<a name="ln-13407"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-13408"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoilIndex</span>       <span class="c">! index of this coil</span>
<a name="ln-13409"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirTemp</span>   <span class="c">! outlet air temperature [C]</span>
<a name="ln-13410"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SpeedRatio</span>
<a name="ln-13411"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">SpeedNum</span>
<a name="ln-13412"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">FanOpMode</span>
<a name="ln-13413"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CompOp</span>
<a name="ln-13414"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">UnitarySysNum</span>
<a name="ln-13415"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ReqOutput</span>
<a name="ln-13416"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dummy</span>
<a name="ln-13417"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RuntimeFrac</span>
<a name="ln-13418"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>
<a name="ln-13419"></a>
<a name="ln-13420"></a><span class="c">!            Par(1) = REAL(UnitarySystem(UnitarySysNum)%CoolingCoilIndex,r64)</span>
<a name="ln-13421"></a><span class="c">!            Par(2) = DesOutTemp</span>
<a name="ln-13422"></a><span class="c">!            Par(3) = UnitarySysNum</span>
<a name="ln-13423"></a><span class="c">!            Par(4) = SpeedRatio</span>
<a name="ln-13424"></a><span class="c">!            Par(5) = UnitarySystem(UnitarySysNum)%CoolingSpeedNum</span>
<a name="ln-13425"></a><span class="c">!            Par(6) = UnitarySystem(UnitarySysNum)%FanOpMode</span>
<a name="ln-13426"></a><span class="c">!            Par(7) = 1.0d0 ! CompOp</span>
<a name="ln-13427"></a>
<a name="ln-13428"></a>  <span class="n">CoilIndex</span>  <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-13429"></a>  <span class="n">UnitarySysNum</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-13430"></a>
<a name="ln-13431"></a><span class="k">SELECT CASE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span><span class="p">)</span>
<a name="ln-13432"></a>
<a name="ln-13433"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_CoolingTwoSpeed</span><span class="p">)</span>
<a name="ln-13434"></a>
<a name="ln-13435"></a>    <span class="k">CALL </span><span class="n">CalcMultiSpeedDXCoil</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">CycRatio</span><span class="p">)</span>
<a name="ln-13436"></a>
<a name="ln-13437"></a>    <span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">DXCoilOutletTemp</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">)</span>
<a name="ln-13438"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_MultiSpeedCooling</span><span class="p">)</span>
<a name="ln-13439"></a>
<a name="ln-13440"></a>    <span class="n">SpeedRatio</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-13441"></a>    <span class="n">SpeedNum</span>   <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-13442"></a>    <span class="n">FanOpMode</span>  <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-13443"></a>    <span class="n">CompOp</span>     <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<a name="ln-13444"></a>
<a name="ln-13445"></a>    <span class="k">CALL </span><span class="n">CalcMultiSpeedDXCoilCooling</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="n">CycRatio</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">)</span>
<a name="ln-13446"></a>    <span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">DXCoilOutletTemp</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">)</span>
<a name="ln-13447"></a>
<a name="ln-13448"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_CoolingAirToAirVariableSpeed</span><span class="p">,</span> <span class="n">Coil_CoolingWaterToAirHPVSEquationFit</span><span class="p">)</span>
<a name="ln-13449"></a>
<a name="ln-13450"></a>      <span class="n">SpeedNum</span>   <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-13451"></a>      <span class="n">FanOpMode</span>  <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-13452"></a>      <span class="n">CompOp</span>     <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<a name="ln-13453"></a>      <span class="n">ReqOutput</span>  <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-13454"></a>      <span class="n">dummy</span>      <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-13455"></a>      <span class="n">RuntimeFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-13456"></a>      <span class="n">OnOffAirFlowRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-13457"></a>
<a name="ln-13458"></a>      <span class="k">CALL </span><span class="n">CalcVarSpeedCoilCooling</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">RuntimeFrac</span><span class="p">,&amp;</span>
<a name="ln-13459"></a>                <span class="n">ReqOutput</span><span class="p">,</span><span class="n">dummy</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">CycRatio</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">SpeedRatio</span><span class="p">,</span> <span class="n">SpeedNum</span><span class="p">)</span>
<a name="ln-13460"></a>
<a name="ln-13461"></a>      <span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilOutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-13462"></a>
<a name="ln-13463"></a>  <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-13464"></a>
<a name="ln-13465"></a><span class="k">END SELECT</span>
<a name="ln-13466"></a>
<a name="ln-13467"></a><span class="k">  </span><span class="n">Residuum</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">OutletAirTemp</span>
<a name="ln-13468"></a>
<a name="ln-13469"></a>  <span class="k">RETURN</span>
<a name="ln-13470"></a><span class="k">END FUNCTION </span><span class="n">DXCoilCyclingResidual</span>
<a name="ln-13471"></a>
<a name="ln-13472"></a><span class="k">FUNCTION </span><span class="n">HeatingCoilVarSpeedCycResidual</span><span class="p">(</span><span class="n">CycRatio</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Residuum</span><span class="p">)</span>
<a name="ln-13473"></a>
<a name="ln-13474"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-13475"></a>          <span class="c">!       AUTHOR         Fred Buhl</span>
<a name="ln-13476"></a>          <span class="c">!       DATE WRITTEN   September 2002</span>
<a name="ln-13477"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-13478"></a>          <span class="c">!       RE-ENGINEERED</span>
<a name="ln-13479"></a>
<a name="ln-13480"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-13481"></a>          <span class="c">! Calculates residual function (desired outlet temp - actual outlet temp)</span>
<a name="ln-13482"></a>          <span class="c">! DX Coil output depends on the cycling ratio which is being varied to zero the residual.</span>
<a name="ln-13483"></a>
<a name="ln-13484"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-13485"></a>          <span class="c">! Calls multi or variable speed coil to get outlet temperature at the given cycling ratio</span>
<a name="ln-13486"></a>          <span class="c">! and calculates the residual as defined above</span>
<a name="ln-13487"></a>
<a name="ln-13488"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-13489"></a>
<a name="ln-13490"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-13491"></a>  <span class="k">USE </span><span class="n">DXCoils</span><span class="p">,</span>               <span class="n">ONLY</span><span class="p">:</span> <span class="n">DXCoilOutletTemp</span><span class="p">,</span> <span class="n">CalcMultiSpeedDXCoil</span><span class="p">,</span> <span class="n">CalcMultiSpeedDXCoilHeating</span>
<a name="ln-13492"></a>  <span class="k">USE </span><span class="n">VariableSpeedCoils</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">CalcVarSpeedCoilHeating</span>
<a name="ln-13493"></a>  <span class="k">USE </span><span class="n">HeatingCoils</span><span class="p">,</span>          <span class="n">ONLY</span><span class="p">:</span> <span class="n">CalcMultiStageElectricHeatingCoil</span><span class="p">,</span> <span class="n">CalcMultiStageGasHeatingCoil</span>
<a name="ln-13494"></a>
<a name="ln-13495"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-13496"></a>
<a name="ln-13497"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-13498"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CycRatio</span> <span class="c">! compressor cycling ratio (1.0 is continuous, 0.0 is off)</span>
<a name="ln-13499"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">Par</span> <span class="c">! par(1) = DX coil number</span>
<a name="ln-13500"></a>                                                    <span class="c">! par(2) = desired air outlet temperature [C]</span>
<a name="ln-13501"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">Residuum</span> <span class="c">! residual to be minimized to zero</span>
<a name="ln-13502"></a>
<a name="ln-13503"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-13504"></a>          <span class="c">! na</span>
<a name="ln-13505"></a>
<a name="ln-13506"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-13507"></a>          <span class="c">! na</span>
<a name="ln-13508"></a>
<a name="ln-13509"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-13510"></a>          <span class="c">! na</span>
<a name="ln-13511"></a>
<a name="ln-13512"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-13513"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoilIndex</span>       <span class="c">! index of this coil</span>
<a name="ln-13514"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirTemp</span>   <span class="c">! outlet air temperature [C]</span>
<a name="ln-13515"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SpeedRatio</span>
<a name="ln-13516"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">SpeedNum</span>
<a name="ln-13517"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">FanOpMode</span>
<a name="ln-13518"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CompOp</span>
<a name="ln-13519"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">UnitarySysNum</span>
<a name="ln-13520"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RuntimeFrac</span>
<a name="ln-13521"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ReqOutput</span>
<a name="ln-13522"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dummy</span>
<a name="ln-13523"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>
<a name="ln-13524"></a>
<a name="ln-13525"></a><span class="c">!            Par(1) = REAL(UnitarySystem(UnitarySysNum)%CoolingCoilIndex,r64)</span>
<a name="ln-13526"></a><span class="c">!            Par(2) = DesOutTemp</span>
<a name="ln-13527"></a><span class="c">!            Par(3) = UnitarySysNum</span>
<a name="ln-13528"></a><span class="c">!            Par(4) = SpeedRatio</span>
<a name="ln-13529"></a><span class="c">!            Par(5) = UnitarySystem(UnitarySysNum)%CoolingSpeedNum</span>
<a name="ln-13530"></a><span class="c">!            Par(6) = UnitarySystem(UnitarySysNum)%FanOpMode</span>
<a name="ln-13531"></a><span class="c">!            Par(7) = 1.0d0 ! CompOp</span>
<a name="ln-13532"></a>
<a name="ln-13533"></a>  <span class="n">CoilIndex</span>  <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-13534"></a>  <span class="n">UnitarySysNum</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-13535"></a>
<a name="ln-13536"></a>
<a name="ln-13537"></a><span class="k">SELECT CASE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span><span class="p">)</span>
<a name="ln-13538"></a>
<a name="ln-13539"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_MultiSpeedHeating</span><span class="p">)</span>
<a name="ln-13540"></a>
<a name="ln-13541"></a>    <span class="n">SpeedRatio</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-13542"></a>    <span class="n">SpeedNum</span>   <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-13543"></a>    <span class="n">FanOpMode</span>  <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-13544"></a>    <span class="n">CompOp</span>     <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<a name="ln-13545"></a>
<a name="ln-13546"></a>    <span class="k">CALL </span><span class="n">CalcMultiSpeedDXCoilHeating</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="n">CycRatio</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">)</span>
<a name="ln-13547"></a>    <span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">DXCoilOutletTemp</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">)</span>
<a name="ln-13548"></a>
<a name="ln-13549"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_HeatingAirToAirVariableSpeed</span><span class="p">,</span> <span class="n">Coil_HeatingWaterToAirHPVSEquationFit</span><span class="p">)</span>
<a name="ln-13550"></a>
<a name="ln-13551"></a>      <span class="n">SpeedNum</span>   <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-13552"></a>      <span class="n">FanOpMode</span>  <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-13553"></a>      <span class="n">CompOp</span>     <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<a name="ln-13554"></a>      <span class="n">ReqOutput</span>  <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-13555"></a>      <span class="n">dummy</span>      <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-13556"></a>      <span class="n">RuntimeFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-13557"></a>      <span class="n">OnOffAirFlowRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-13558"></a>
<a name="ln-13559"></a>      <span class="k">CALL </span><span class="n">CalcVarSpeedCoilHeating</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">RuntimeFrac</span><span class="p">,&amp;</span>
<a name="ln-13560"></a>                <span class="n">ReqOutput</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">CycRatio</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">SpeedRatio</span><span class="p">,</span> <span class="n">SpeedNum</span><span class="p">)</span>
<a name="ln-13561"></a>
<a name="ln-13562"></a>      <span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilOutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-13563"></a>
<a name="ln-13564"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_HeatingElectric_MultiStage</span><span class="p">)</span>
<a name="ln-13565"></a>
<a name="ln-13566"></a>      <span class="n">SpeedRatio</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-13567"></a>      <span class="n">SpeedNum</span>   <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-13568"></a>      <span class="n">FanOpMode</span>  <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-13569"></a>
<a name="ln-13570"></a>      <span class="k">CALL </span><span class="n">CalcMultiStageElectricHeatingCoil</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="n">CycRatio</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">)</span>
<a name="ln-13571"></a>
<a name="ln-13572"></a>      <span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilOutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-13573"></a>
<a name="ln-13574"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_HeatingGas_MultiStage</span><span class="p">)</span>
<a name="ln-13575"></a>
<a name="ln-13576"></a>      <span class="n">SpeedRatio</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-13577"></a>      <span class="n">SpeedNum</span>   <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-13578"></a>      <span class="n">FanOpMode</span>  <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-13579"></a>
<a name="ln-13580"></a>      <span class="k">CALL </span><span class="n">CalcMultiStageElectricHeatingCoil</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="n">CycRatio</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">)</span>
<a name="ln-13581"></a>
<a name="ln-13582"></a>      <span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilOutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-13583"></a>
<a name="ln-13584"></a>  <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-13585"></a>
<a name="ln-13586"></a>
<a name="ln-13587"></a><span class="k">END SELECT</span>
<a name="ln-13588"></a>
<a name="ln-13589"></a><span class="k">  </span><span class="n">Residuum</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">OutletAirTemp</span>
<a name="ln-13590"></a>
<a name="ln-13591"></a>  <span class="k">RETURN</span>
<a name="ln-13592"></a><span class="k">END FUNCTION </span><span class="n">HeatingCoilVarSpeedCycResidual</span>
<a name="ln-13593"></a>
<a name="ln-13594"></a><span class="k">FUNCTION </span><span class="n">DXCoilCyclingHumRatResidual</span><span class="p">(</span><span class="n">CycRatio</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Residuum</span><span class="p">)</span>
<a name="ln-13595"></a>
<a name="ln-13596"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-13597"></a>          <span class="c">!       AUTHOR         Fred Buhl</span>
<a name="ln-13598"></a>          <span class="c">!       DATE WRITTEN   September 2002</span>
<a name="ln-13599"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-13600"></a>          <span class="c">!       RE-ENGINEERED</span>
<a name="ln-13601"></a>
<a name="ln-13602"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-13603"></a>          <span class="c">! Calculates residual function (desired outlet temp - actual outlet temp)</span>
<a name="ln-13604"></a>          <span class="c">! DX Coil output depends on the cycling ratio which is being varied to zero the residual.</span>
<a name="ln-13605"></a>
<a name="ln-13606"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-13607"></a>          <span class="c">! Calls CalcMultiSpeedDXCoil to get outlet temperature at the given cycling ratio</span>
<a name="ln-13608"></a>          <span class="c">! and calculates the residual as defined above</span>
<a name="ln-13609"></a>
<a name="ln-13610"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-13611"></a>
<a name="ln-13612"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-13613"></a>  <span class="k">USE </span><span class="n">DXCoils</span><span class="p">,</span>             <span class="n">ONLY</span><span class="p">:</span> <span class="n">DXCoilOutletHumRat</span><span class="p">,</span> <span class="n">CalcMultiSpeedDXCoil</span><span class="p">,</span> <span class="n">CalcMultiSpeedDXCoilCooling</span>
<a name="ln-13614"></a>  <span class="k">USE </span><span class="n">VariableSpeedCoils</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">CalcVarSpeedCoilCooling</span>
<a name="ln-13615"></a>
<a name="ln-13616"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-13617"></a>
<a name="ln-13618"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-13619"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CycRatio</span> <span class="c">! compressor cycling ratio (1.0 is continuous, 0.0 is off)</span>
<a name="ln-13620"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">Par</span> <span class="c">! par(1) = DX coil number</span>
<a name="ln-13621"></a>                                                    <span class="c">! par(2) = desired air outlet humidity ratio [kg/kg]</span>
<a name="ln-13622"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">Residuum</span> <span class="c">! residual to be minimized to zero</span>
<a name="ln-13623"></a>
<a name="ln-13624"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-13625"></a>          <span class="c">! na</span>
<a name="ln-13626"></a>
<a name="ln-13627"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-13628"></a>          <span class="c">! na</span>
<a name="ln-13629"></a>
<a name="ln-13630"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-13631"></a>          <span class="c">! na</span>
<a name="ln-13632"></a>
<a name="ln-13633"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-13634"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoilIndex</span>       <span class="c">! index of this coil</span>
<a name="ln-13635"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirHumRat</span>  <span class="c">! outlet air humidity ratio [kg/kg]</span>
<a name="ln-13636"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SpeedRatio</span>
<a name="ln-13637"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">SpeedNum</span>
<a name="ln-13638"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">FanOpMode</span>
<a name="ln-13639"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CompOp</span>
<a name="ln-13640"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">UnitarySysNum</span>
<a name="ln-13641"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ReqOutput</span>
<a name="ln-13642"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dummy</span>
<a name="ln-13643"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RuntimeFrac</span>
<a name="ln-13644"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>
<a name="ln-13645"></a>
<a name="ln-13646"></a>  <span class="n">CoilIndex</span>     <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-13647"></a>  <span class="n">UnitarySysNum</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-13648"></a>
<a name="ln-13649"></a><span class="k">SELECT CASE</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span><span class="p">)</span>
<a name="ln-13650"></a>
<a name="ln-13651"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_CoolingTwoSpeed</span><span class="p">)</span>
<a name="ln-13652"></a>
<a name="ln-13653"></a>    <span class="k">CALL </span><span class="n">CalcMultiSpeedDXCoil</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">CycRatio</span><span class="p">)</span>
<a name="ln-13654"></a>
<a name="ln-13655"></a>    <span class="n">OutletAirHumRat</span> <span class="o">=</span> <span class="n">DXCoilOutletHumRat</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">)</span>
<a name="ln-13656"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">CoilDX_MultiSpeedCooling</span><span class="p">)</span>
<a name="ln-13657"></a>
<a name="ln-13658"></a>    <span class="n">SpeedRatio</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-13659"></a>    <span class="n">SpeedNum</span>   <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-13660"></a>    <span class="n">FanOpMode</span>  <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-13661"></a>    <span class="n">CompOp</span>     <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<a name="ln-13662"></a>
<a name="ln-13663"></a>    <span class="k">CALL </span><span class="n">CalcMultiSpeedDXCoilCooling</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="n">CycRatio</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">)</span>
<a name="ln-13664"></a>    <span class="n">OutletAirHumRat</span> <span class="o">=</span> <span class="n">DXCoilOutletHumRat</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">)</span>
<a name="ln-13665"></a>
<a name="ln-13666"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_CoolingAirToAirVariableSpeed</span><span class="p">,</span> <span class="n">Coil_CoolingWaterToAirHPVSEquationFit</span><span class="p">)</span>
<a name="ln-13667"></a>
<a name="ln-13668"></a>      <span class="n">SpeedNum</span>   <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-13669"></a>      <span class="n">FanOpMode</span>  <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-13670"></a>      <span class="n">CompOp</span>     <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<a name="ln-13671"></a>      <span class="n">ReqOutput</span>  <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-13672"></a>      <span class="n">dummy</span>      <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-13673"></a>      <span class="n">RuntimeFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-13674"></a>      <span class="n">OnOffAirFlowRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-13675"></a>
<a name="ln-13676"></a>      <span class="k">CALL </span><span class="n">CalcVarSpeedCoilCooling</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">RuntimeFrac</span><span class="p">,&amp;</span>
<a name="ln-13677"></a>                <span class="n">ReqOutput</span><span class="p">,</span><span class="n">dummy</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">CycRatio</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">SpeedRatio</span><span class="p">,</span> <span class="n">SpeedNum</span><span class="p">)</span>
<a name="ln-13678"></a>
<a name="ln-13679"></a>      <span class="n">OutletAirHumRat</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilOutletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-13680"></a>
<a name="ln-13681"></a>  <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-13682"></a>
<a name="ln-13683"></a><span class="k">END SELECT</span>
<a name="ln-13684"></a>
<a name="ln-13685"></a><span class="k">  </span><span class="n">Residuum</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">OutletAirHumRat</span>
<a name="ln-13686"></a>
<a name="ln-13687"></a>  <span class="k">RETURN</span>
<a name="ln-13688"></a><span class="k">END FUNCTION </span><span class="n">DXCoilCyclingHumRatResidual</span>
<a name="ln-13689"></a>
<a name="ln-13690"></a><span class="k">FUNCTION </span><span class="n">DOE2DXCoilResidual</span><span class="p">(</span><span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Residuum</span><span class="p">)</span>
<a name="ln-13691"></a>
<a name="ln-13692"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-13693"></a>          <span class="c">!       AUTHOR         Richard Raustad, FSEC</span>
<a name="ln-13694"></a>          <span class="c">!       DATE WRITTEN   November 2003</span>
<a name="ln-13695"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-13696"></a>          <span class="c">!       RE-ENGINEERED</span>
<a name="ln-13697"></a>
<a name="ln-13698"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-13699"></a>          <span class="c">! Calculates residual function (desired outlet temp - actual outlet temp)</span>
<a name="ln-13700"></a>          <span class="c">! DX Coil output depends on the part load ratio which is being varied to zero the residual.</span>
<a name="ln-13701"></a>
<a name="ln-13702"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-13703"></a>          <span class="c">! Calls CalcDOe2DXCoil to get outlet temperature at the given cycling ratio</span>
<a name="ln-13704"></a>          <span class="c">! and calculates the residual as defined above</span>
<a name="ln-13705"></a>
<a name="ln-13706"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-13707"></a>
<a name="ln-13708"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-13709"></a>  <span class="k">USE </span><span class="n">DXCoils</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">DXCoilOutletTemp</span><span class="p">,</span> <span class="n">CalcDOe2DXCoil</span>
<a name="ln-13710"></a>
<a name="ln-13711"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-13712"></a>
<a name="ln-13713"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-13714"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">PartLoadRatio</span> <span class="c">! compressor cycling ratio (1.0 is continuous, 0.0 is off)</span>
<a name="ln-13715"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">Par</span> <span class="c">! par(1) = DX coil number</span>
<a name="ln-13716"></a>                                                    <span class="c">! par(2) = desired air outlet temperature [C]</span>
<a name="ln-13717"></a>                                                    <span class="c">! par(5) = supply air fan operating mode (ContFanCycCoil)</span>
<a name="ln-13718"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">Residuum</span> <span class="c">! residual to be minimized to zero</span>
<a name="ln-13719"></a>
<a name="ln-13720"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-13721"></a>          <span class="c">! na</span>
<a name="ln-13722"></a>
<a name="ln-13723"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-13724"></a>          <span class="c">! na</span>
<a name="ln-13725"></a>
<a name="ln-13726"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-13727"></a>          <span class="c">! na</span>
<a name="ln-13728"></a>
<a name="ln-13729"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-13730"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoilIndex</span>       <span class="c">! index of this coil</span>
<a name="ln-13731"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirTemp</span>   <span class="c">! outlet air temperature [C]</span>
<a name="ln-13732"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">FanOpMode</span>       <span class="c">! Supply air fan operating mode</span>
<a name="ln-13733"></a>
<a name="ln-13734"></a>  <span class="n">CoilIndex</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-13735"></a>  <span class="n">FanOpMode</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-13736"></a>  <span class="k">CALL </span><span class="n">CalcDOe2DXCoil</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">,</span><span class="n">On</span><span class="p">,.</span><span class="n">TRUE</span><span class="p">.,</span> <span class="n">PartLoadRatio</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">)</span>
<a name="ln-13737"></a>  <span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">DXCoilOutletTemp</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">)</span>
<a name="ln-13738"></a>  <span class="n">Residuum</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">OutletAirTemp</span>
<a name="ln-13739"></a>
<a name="ln-13740"></a>  <span class="k">RETURN</span>
<a name="ln-13741"></a><span class="k">END FUNCTION </span><span class="n">DOE2DXCoilResidual</span>
<a name="ln-13742"></a>
<a name="ln-13743"></a><span class="k">FUNCTION </span><span class="n">DOE2DXCoilHumRatResidual</span><span class="p">(</span><span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Residuum</span><span class="p">)</span>
<a name="ln-13744"></a>
<a name="ln-13745"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-13746"></a>          <span class="c">!       AUTHOR         Richard Raustad, FSEC</span>
<a name="ln-13747"></a>          <span class="c">!       DATE WRITTEN   January 2008</span>
<a name="ln-13748"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-13749"></a>          <span class="c">!       RE-ENGINEERED</span>
<a name="ln-13750"></a>
<a name="ln-13751"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-13752"></a>          <span class="c">! Calculates residual function (desired outlet humrat - actual outlet humrat)</span>
<a name="ln-13753"></a>          <span class="c">! DX Coil output depends on the part load ratio which is being varied to zero the residual.</span>
<a name="ln-13754"></a>
<a name="ln-13755"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-13756"></a>          <span class="c">! Calls CalcDOe2DXCoil to get outlet humidity ratio at the given cycling ratio</span>
<a name="ln-13757"></a>          <span class="c">! and calculates the residual as defined above</span>
<a name="ln-13758"></a>
<a name="ln-13759"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-13760"></a>
<a name="ln-13761"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-13762"></a>  <span class="k">USE </span><span class="n">DXCoils</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">DXCoilOutletHumRat</span><span class="p">,</span> <span class="n">CalcDOe2DXCoil</span>
<a name="ln-13763"></a>
<a name="ln-13764"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-13765"></a>
<a name="ln-13766"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-13767"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">PartLoadRatio</span> <span class="c">! compressor cycling ratio (1.0 is continuous, 0.0 is off)</span>
<a name="ln-13768"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">Par</span> <span class="c">! par(1) = DX coil number</span>
<a name="ln-13769"></a>                                                    <span class="c">! par(2) = desired air outlet humidity ratio [kg/kg]</span>
<a name="ln-13770"></a>                                                    <span class="c">! par(5) = supply air fan operating mode (ContFanCycCoil)</span>
<a name="ln-13771"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">Residuum</span> <span class="c">! residual to be minimized to zero</span>
<a name="ln-13772"></a>
<a name="ln-13773"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-13774"></a>          <span class="c">! na</span>
<a name="ln-13775"></a>
<a name="ln-13776"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-13777"></a>          <span class="c">! na</span>
<a name="ln-13778"></a>
<a name="ln-13779"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-13780"></a>          <span class="c">! na</span>
<a name="ln-13781"></a>
<a name="ln-13782"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-13783"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoilIndex</span>       <span class="c">! index of this coil</span>
<a name="ln-13784"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirHumRat</span> <span class="c">! outlet air humidity ratio [kg/kg]</span>
<a name="ln-13785"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">FanOpMode</span>       <span class="c">! Supply air fan operating mode</span>
<a name="ln-13786"></a>
<a name="ln-13787"></a>  <span class="n">CoilIndex</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-13788"></a>  <span class="n">FanOpMode</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-13789"></a>  <span class="k">CALL </span><span class="n">CalcDOe2DXCoil</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">,</span><span class="n">On</span><span class="p">,.</span><span class="n">TRUE</span><span class="p">.,</span> <span class="n">PartLoadRatio</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">)</span>
<a name="ln-13790"></a>  <span class="n">OutletAirHumRat</span> <span class="o">=</span> <span class="n">DXCoilOutletHumRat</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">)</span>
<a name="ln-13791"></a>  <span class="n">Residuum</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">OutletAirHumRat</span>
<a name="ln-13792"></a>
<a name="ln-13793"></a>  <span class="k">RETURN</span>
<a name="ln-13794"></a><span class="k">END FUNCTION </span><span class="n">DOE2DXCoilHumRatResidual</span>
<a name="ln-13795"></a>
<a name="ln-13796"></a><span class="k">FUNCTION </span><span class="n">CoolWaterHumRatResidual</span><span class="p">(</span><span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Residuum</span><span class="p">)</span>
<a name="ln-13797"></a>
<a name="ln-13798"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-13799"></a>          <span class="c">!       AUTHOR         Chandan Sharma, FSEC</span>
<a name="ln-13800"></a>          <span class="c">!       DATE WRITTEN   January 2013</span>
<a name="ln-13801"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-13802"></a>          <span class="c">!       RE-ENGINEERED</span>
<a name="ln-13803"></a>
<a name="ln-13804"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-13805"></a>          <span class="c">! Calculates residual function (desired outlet humrat - actual outlet humrat)</span>
<a name="ln-13806"></a>          <span class="c">! Cool water coil output depends on the part load ratio which is being varied to zero the residual.</span>
<a name="ln-13807"></a>
<a name="ln-13808"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-13809"></a>          <span class="c">! Calls SimulateWaterCoilComponents to get outlet temp at the given cycling ratio</span>
<a name="ln-13810"></a>          <span class="c">! and calculates the residual as defined above</span>
<a name="ln-13811"></a>
<a name="ln-13812"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-13813"></a>
<a name="ln-13814"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-13815"></a>  <span class="k">USE </span><span class="n">WaterCoils</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateWaterCoilComponents</span>
<a name="ln-13816"></a>
<a name="ln-13817"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-13818"></a>
<a name="ln-13819"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-13820"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">PartLoadRatio</span> <span class="c">! compressor cycling ratio (1.0 is continuous, 0.0 is off)</span>
<a name="ln-13821"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">Par</span> <span class="c">! par(1) = CoolWater coil number</span>
<a name="ln-13822"></a>                                                    <span class="c">! par(2) = desired air outlet humidity ratio [kg/kg]</span>
<a name="ln-13823"></a>                                                    <span class="c">! par(5) = supply air fan operating mode (ContFanCycCoil)</span>
<a name="ln-13824"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">Residuum</span> <span class="c">! residual to be minimized to zero</span>
<a name="ln-13825"></a>
<a name="ln-13826"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-13827"></a>          <span class="c">! na</span>
<a name="ln-13828"></a>
<a name="ln-13829"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-13830"></a>          <span class="c">! na</span>
<a name="ln-13831"></a>
<a name="ln-13832"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-13833"></a>          <span class="c">! na</span>
<a name="ln-13834"></a>
<a name="ln-13835"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-13836"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">UnitarySysNum</span>       <span class="c">! index of this coil</span>
<a name="ln-13837"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirHumRat</span>        <span class="c">! outlet air humidity ratio [kg/kg]</span>
<a name="ln-13838"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">mdot</span>
<a name="ln-13839"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">FirstHVACIteration</span>
<a name="ln-13840"></a>
<a name="ln-13841"></a>
<a name="ln-13842"></a>  <span class="n">UnitarySysNum</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-13843"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-13844"></a><span class="k">    </span><span class="n">FirstHVACIteration</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-13845"></a>  <span class="k">ELSE</span>
<a name="ln-13846"></a><span class="k">    </span><span class="n">FirstHVACIteration</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-13847"></a>  <span class="k">END IF</span>
<a name="ln-13848"></a>
<a name="ln-13849"></a><span class="k">  </span><span class="n">mdot</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilFluidOutletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-13850"></a>         <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolCoilFluidFlow</span> <span class="o">*</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-13851"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilFluidInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">mdot</span>
<a name="ln-13852"></a>  <span class="k">CALL </span><span class="n">SimulateWaterCoilComponents</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-13853"></a>                                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-13854"></a>                                   <span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-13855"></a>
<a name="ln-13856"></a>  <span class="n">OutletAirHumRat</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilOutletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-13857"></a>  <span class="n">Residuum</span>      <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">OutletAirHumRat</span>
<a name="ln-13858"></a>
<a name="ln-13859"></a>  <span class="k">RETURN</span>
<a name="ln-13860"></a><span class="k">END FUNCTION </span><span class="n">CoolWaterHumRatResidual</span>
<a name="ln-13861"></a>
<a name="ln-13862"></a><span class="k">FUNCTION </span><span class="n">CoolWaterTempResidual</span><span class="p">(</span><span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Residuum</span><span class="p">)</span>
<a name="ln-13863"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-13864"></a>          <span class="c">!       AUTHOR         Chandan Sharma, FSEC</span>
<a name="ln-13865"></a>          <span class="c">!       DATE WRITTEN   January 2013</span>
<a name="ln-13866"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-13867"></a>          <span class="c">!       RE-ENGINEERED</span>
<a name="ln-13868"></a>
<a name="ln-13869"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-13870"></a>          <span class="c">! Calculates residual function (desired outlet temp - actual outlet temp)</span>
<a name="ln-13871"></a>          <span class="c">! Cool water coil output depends on the part load ratio which is being varied to zero the residual.</span>
<a name="ln-13872"></a>
<a name="ln-13873"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-13874"></a>          <span class="c">! Calls SimulateWaterCoilComponents to get outlet temp at the given cycling ratio</span>
<a name="ln-13875"></a>          <span class="c">! and calculates the residual as defined above</span>
<a name="ln-13876"></a>
<a name="ln-13877"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-13878"></a>
<a name="ln-13879"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-13880"></a>  <span class="k">USE </span><span class="n">WaterCoils</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateWaterCoilComponents</span>
<a name="ln-13881"></a>
<a name="ln-13882"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-13883"></a>
<a name="ln-13884"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-13885"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">PartLoadRatio</span> <span class="c">! compressor cycling ratio (1.0 is continuous, 0.0 is off)</span>
<a name="ln-13886"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">Par</span> <span class="c">! par(1) = CoolWater coil number</span>
<a name="ln-13887"></a>                                                    <span class="c">! par(2) = desired air outlet humidity ratio [kg/kg]</span>
<a name="ln-13888"></a>                                                    <span class="c">! par(5) = supply air fan operating mode (ContFanCycCoil)</span>
<a name="ln-13889"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">Residuum</span> <span class="c">! residual to be minimized to zero</span>
<a name="ln-13890"></a>
<a name="ln-13891"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-13892"></a>          <span class="c">! na</span>
<a name="ln-13893"></a>
<a name="ln-13894"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-13895"></a>          <span class="c">! na</span>
<a name="ln-13896"></a>
<a name="ln-13897"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-13898"></a>          <span class="c">! na</span>
<a name="ln-13899"></a>
<a name="ln-13900"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-13901"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">UnitarySysNum</span>       <span class="c">! index of this coil</span>
<a name="ln-13902"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirTemp</span>        <span class="c">! outlet air humidity ratio [kg/kg]</span>
<a name="ln-13903"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">mdot</span>
<a name="ln-13904"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">FirstHVACIteration</span>
<a name="ln-13905"></a>
<a name="ln-13906"></a>
<a name="ln-13907"></a>  <span class="n">UnitarySysNum</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-13908"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-13909"></a><span class="k">    </span><span class="n">FirstHVACIteration</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-13910"></a>  <span class="k">ELSE</span>
<a name="ln-13911"></a><span class="k">    </span><span class="n">FirstHVACIteration</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-13912"></a>  <span class="k">END IF</span>
<a name="ln-13913"></a>
<a name="ln-13914"></a><span class="k">  </span><span class="n">mdot</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilFluidOutletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-13915"></a>         <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolCoilFluidFlow</span> <span class="o">*</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-13916"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilFluidInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">mdot</span>
<a name="ln-13917"></a>  <span class="k">CALL </span><span class="n">SimulateWaterCoilComponents</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-13918"></a>                                   <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-13919"></a>                                   <span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-13920"></a>
<a name="ln-13921"></a>  <span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilOutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-13922"></a>  <span class="n">Residuum</span>      <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">OutletAirTemp</span>
<a name="ln-13923"></a>
<a name="ln-13924"></a>  <span class="k">RETURN</span>
<a name="ln-13925"></a><span class="k">END FUNCTION </span><span class="n">CoolWaterTempResidual</span>
<a name="ln-13926"></a>
<a name="ln-13927"></a><span class="k">FUNCTION </span><span class="n">CoolWatertoAirHPHumRatResidual</span><span class="p">(</span><span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Residuum</span><span class="p">)</span>
<a name="ln-13928"></a>
<a name="ln-13929"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-13930"></a>          <span class="c">!       AUTHOR         Chandan Sharma, FSEC</span>
<a name="ln-13931"></a>          <span class="c">!       DATE WRITTEN   January 2013</span>
<a name="ln-13932"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-13933"></a>          <span class="c">!       RE-ENGINEERED</span>
<a name="ln-13934"></a>
<a name="ln-13935"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-13936"></a>          <span class="c">! Calculates residual function (desired outlet humrat - actual outlet humrat)</span>
<a name="ln-13937"></a>          <span class="c">! Cool water coil output depends on the part load ratio which is being varied to zero the residual.</span>
<a name="ln-13938"></a>
<a name="ln-13939"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-13940"></a>          <span class="c">! Calls SimWatertoAirHP or SimWatertoAirHPSimple to get outlet humidity ratio at the given cycling ratio</span>
<a name="ln-13941"></a>          <span class="c">! and calculates the residual as defined above</span>
<a name="ln-13942"></a>
<a name="ln-13943"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-13944"></a>
<a name="ln-13945"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-13946"></a>  <span class="k">USE </span><span class="n">WatertoAirHeatPumpSimple</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimWatertoAirHPSimple</span>
<a name="ln-13947"></a>  <span class="k">USE </span><span class="n">WatertoAirHeatPump</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimWaterToAirHP</span>
<a name="ln-13948"></a>
<a name="ln-13949"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-13950"></a>
<a name="ln-13951"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-13952"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">PartLoadRatio</span> <span class="c">! compressor cycling ratio (1.0 is continuous, 0.0 is off)</span>
<a name="ln-13953"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">Par</span> <span class="c">! par(1) = CoolWatertoAirHP coil number</span>
<a name="ln-13954"></a>                                                    <span class="c">! par(2) = desired air outlet humidity ratio [kg/kg]</span>
<a name="ln-13955"></a>                                                    <span class="c">! par(5) = supply air fan operating mode (ContFanCycCoil)</span>
<a name="ln-13956"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">Residuum</span> <span class="c">! residual to be minimized to zero</span>
<a name="ln-13957"></a>
<a name="ln-13958"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-13959"></a>          <span class="c">! na</span>
<a name="ln-13960"></a>
<a name="ln-13961"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-13962"></a>          <span class="c">! na</span>
<a name="ln-13963"></a>
<a name="ln-13964"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-13965"></a>          <span class="c">! na</span>
<a name="ln-13966"></a>
<a name="ln-13967"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-13968"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">UnitarySysNum</span>       <span class="c">! index of this coil</span>
<a name="ln-13969"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirHumRat</span>        <span class="c">! outlet air humidity ratio [kg/kg]</span>
<a name="ln-13970"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ReqOutput</span>
<a name="ln-13971"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">FirstHVACIteration</span>
<a name="ln-13972"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">errflag</span>
<a name="ln-13973"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">RuntimeFrac</span>        <span class="c">! heat pump runtime fraction</span>
<a name="ln-13974"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Dummy</span>
<a name="ln-13975"></a>
<a name="ln-13976"></a>
<a name="ln-13977"></a>  <span class="n">UnitarySysNum</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-13978"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-13979"></a><span class="k">    </span><span class="n">FirstHVACIteration</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-13980"></a>  <span class="k">ELSE</span>
<a name="ln-13981"></a><span class="k">    </span><span class="n">FirstHVACIteration</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-13982"></a>  <span class="k">END IF</span>
<a name="ln-13983"></a><span class="k">  </span><span class="n">ReqOutput</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-13984"></a>
<a name="ln-13985"></a>  <span class="k">CALL </span><span class="n">HeatPumpRunFrac</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="n">errflag</span><span class="p">,</span><span class="n">RuntimeFrac</span><span class="p">)</span>
<a name="ln-13986"></a>
<a name="ln-13987"></a>  <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-13988"></a>  <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">WSHPRuntimeFrac</span>   <span class="o">=</span> <span class="n">RuntimeFrac</span>
<a name="ln-13989"></a>
<a name="ln-13990"></a>  <span class="n">Dummy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-13991"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_CoolingWaterToAirHPSimple</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-13992"></a><span class="k">    CALL </span><span class="n">SimWatertoAirHPSimple</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="n">ReqOutput</span><span class="p">,</span> <span class="n">Dummy</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-13993"></a>                               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">RuntimeFrac</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-13994"></a>                               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-13995"></a>                               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-13996"></a>                               <span class="mi">0</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-13997"></a>  <span class="k">ELSE</span>
<a name="ln-13998"></a><span class="k">    CALL </span><span class="n">SimWatertoAirHP</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-13999"></a>                         <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirMassFlow</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-14000"></a>                         <span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">RuntimeFrac</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-14001"></a>                         <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-14002"></a>                         <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">InitHeatPump</span><span class="p">,</span> <span class="n">ReqOutput</span><span class="p">,</span><span class="n">Dummy</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-14003"></a>  <span class="k">END IF</span>
<a name="ln-14004"></a>
<a name="ln-14005"></a><span class="k">  </span><span class="n">OutletAirHumRat</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilOutletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-14006"></a>  <span class="n">Residuum</span>      <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">OutletAirHumRat</span>
<a name="ln-14007"></a>
<a name="ln-14008"></a>  <span class="k">RETURN</span>
<a name="ln-14009"></a><span class="k">END FUNCTION </span><span class="n">CoolWatertoAirHPHumRatResidual</span>
<a name="ln-14010"></a>
<a name="ln-14011"></a><span class="k">FUNCTION </span><span class="n">CoolWatertoAirHPTempResidual</span><span class="p">(</span><span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Residuum</span><span class="p">)</span>
<a name="ln-14012"></a>
<a name="ln-14013"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-14014"></a>          <span class="c">!       AUTHOR        Chandan Sharma, FSEC</span>
<a name="ln-14015"></a>          <span class="c">!       DATE WRITTEN   January 2013</span>
<a name="ln-14016"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-14017"></a>          <span class="c">!       RE-ENGINEERED</span>
<a name="ln-14018"></a>
<a name="ln-14019"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-14020"></a>          <span class="c">! Calculates residual function (desired outlet temp - actual outlet temp)</span>
<a name="ln-14021"></a>          <span class="c">! Cool water coil output depends on the part load ratio which is being varied to zero the residual.</span>
<a name="ln-14022"></a>
<a name="ln-14023"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-14024"></a>          <span class="c">! Calls SimWatertoAirHP or SimWatertoAirHPSimple to get outlet humidity ratio at the given cycling ratio</span>
<a name="ln-14025"></a>          <span class="c">! and calculates the residual as defined above</span>
<a name="ln-14026"></a>
<a name="ln-14027"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-14028"></a>
<a name="ln-14029"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-14030"></a>  <span class="k">USE </span><span class="n">WatertoAirHeatPumpSimple</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimWatertoAirHPSimple</span>
<a name="ln-14031"></a>  <span class="k">USE </span><span class="n">WatertoAirHeatPump</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimWaterToAirHP</span>
<a name="ln-14032"></a>
<a name="ln-14033"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-14034"></a>
<a name="ln-14035"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-14036"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">PartLoadRatio</span> <span class="c">! compressor cycling ratio (1.0 is continuous, 0.0 is off)</span>
<a name="ln-14037"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">Par</span> <span class="c">! par(1) = CoolWatertoAirHP coil number</span>
<a name="ln-14038"></a>                                                    <span class="c">! par(2) = desired air outlet humidity ratio [kg/kg]</span>
<a name="ln-14039"></a>                                                    <span class="c">! par(5) = supply air fan operating mode (ContFanCycCoil)</span>
<a name="ln-14040"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">Residuum</span> <span class="c">! residual to be minimized to zero</span>
<a name="ln-14041"></a>
<a name="ln-14042"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-14043"></a>          <span class="c">! na</span>
<a name="ln-14044"></a>
<a name="ln-14045"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-14046"></a>          <span class="c">! na</span>
<a name="ln-14047"></a>
<a name="ln-14048"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-14049"></a>          <span class="c">! na</span>
<a name="ln-14050"></a>
<a name="ln-14051"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-14052"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">UnitarySysNum</span>       <span class="c">! index of this coil</span>
<a name="ln-14053"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirTemp</span>        <span class="c">! outlet air humidity ratio [kg/kg]</span>
<a name="ln-14054"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ReqOutput</span>
<a name="ln-14055"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">FirstHVACIteration</span>
<a name="ln-14056"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">errflag</span>
<a name="ln-14057"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RuntimeFrac</span>
<a name="ln-14058"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Dummy</span>
<a name="ln-14059"></a>
<a name="ln-14060"></a>  <span class="n">UnitarySysNum</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-14061"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14062"></a><span class="k">    </span><span class="n">FirstHVACIteration</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-14063"></a>  <span class="k">ELSE</span>
<a name="ln-14064"></a><span class="k">    </span><span class="n">FirstHVACIteration</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-14065"></a>  <span class="k">END IF</span>
<a name="ln-14066"></a><span class="k">  </span><span class="n">ReqOutput</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-14067"></a>
<a name="ln-14068"></a>  <span class="k">CALL </span><span class="n">HeatPumpRunFrac</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="n">errflag</span><span class="p">,</span><span class="n">RuntimeFrac</span><span class="p">)</span>
<a name="ln-14069"></a>
<a name="ln-14070"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">RuntimeFrac</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span> <span class="o">==</span> <span class="n">CycFanCycCoil</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-14071"></a><span class="k">    </span><span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="n">PartLoadRatio</span><span class="o">/</span><span class="n">RuntimeFrac</span>
<a name="ln-14072"></a>  <span class="k">ELSE</span>
<a name="ln-14073"></a><span class="k">    </span><span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-14074"></a>  <span class="k">END IF</span>
<a name="ln-14075"></a>
<a name="ln-14076"></a><span class="k">  </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-14077"></a>  <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">WSHPRuntimeFrac</span>   <span class="o">=</span> <span class="n">RuntimeFrac</span>
<a name="ln-14078"></a>
<a name="ln-14079"></a>  <span class="n">Dummy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-14080"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_CoolingWaterToAirHPSimple</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14081"></a><span class="k">    CALL </span><span class="n">SimWatertoAirHPSimple</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="n">ReqOutput</span><span class="p">,</span> <span class="n">Dummy</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-14082"></a>                               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">RuntimeFrac</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-14083"></a>                               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-14084"></a>                               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-14085"></a>                               <span class="mi">0</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-14086"></a>  <span class="k">ELSE</span>
<a name="ln-14087"></a><span class="k">    CALL </span><span class="n">SimWatertoAirHP</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-14088"></a>                         <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolAirMassFlow</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-14089"></a>                         <span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">RuntimeFrac</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-14090"></a>                         <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-14091"></a>                         <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">InitHeatPump</span><span class="p">,</span> <span class="n">ReqOutput</span><span class="p">,</span><span class="n">Dummy</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-14092"></a>  <span class="k">END IF</span>
<a name="ln-14093"></a>
<a name="ln-14094"></a><span class="k">  </span><span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilOutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-14095"></a>  <span class="n">Residuum</span>      <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">OutletAirTemp</span>
<a name="ln-14096"></a>
<a name="ln-14097"></a>  <span class="k">RETURN</span>
<a name="ln-14098"></a><span class="k">END FUNCTION </span><span class="n">CoolWatertoAirHPTempResidual</span>
<a name="ln-14099"></a>
<a name="ln-14100"></a><span class="k">FUNCTION </span><span class="n">HeatWatertoAirHPTempResidual</span><span class="p">(</span><span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Residuum</span><span class="p">)</span>
<a name="ln-14101"></a>
<a name="ln-14102"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-14103"></a>          <span class="c">!       AUTHOR         Chandan Sharma, FSEC</span>
<a name="ln-14104"></a>          <span class="c">!       DATE WRITTEN   January 2013</span>
<a name="ln-14105"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-14106"></a>          <span class="c">!       RE-ENGINEERED</span>
<a name="ln-14107"></a>
<a name="ln-14108"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-14109"></a>          <span class="c">! Calculates residual function (desired outlet temp - actual outlet temp)</span>
<a name="ln-14110"></a>          <span class="c">! Heat water coil output depends on the part load ratio which is being varied to zero the residual.</span>
<a name="ln-14111"></a>
<a name="ln-14112"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-14113"></a>          <span class="c">! Calls SimWatertoAirHP or SimWatertoAirHPSimple to get outlet humidity ratio at the given cycling ratio</span>
<a name="ln-14114"></a>          <span class="c">! and calculates the residual as defined above</span>
<a name="ln-14115"></a>
<a name="ln-14116"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-14117"></a>
<a name="ln-14118"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-14119"></a>  <span class="k">USE </span><span class="n">WatertoAirHeatPumpSimple</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimWatertoAirHPSimple</span>
<a name="ln-14120"></a>  <span class="k">USE </span><span class="n">WatertoAirHeatPump</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimWaterToAirHP</span>
<a name="ln-14121"></a>
<a name="ln-14122"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-14123"></a>
<a name="ln-14124"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-14125"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">PartLoadRatio</span> <span class="c">! compressor cycling ratio (1.0 is continuous, 0.0 is off)</span>
<a name="ln-14126"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">Par</span> <span class="c">! par(1) = HeatWatertoAirHP coil number</span>
<a name="ln-14127"></a>                                                    <span class="c">! par(2) = desired air outlet humidity ratio [kg/kg]</span>
<a name="ln-14128"></a>                                                    <span class="c">! par(5) = supply air fan operating mode (ContFanCycCoil)</span>
<a name="ln-14129"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">Residuum</span> <span class="c">! residual to be minimized to zero</span>
<a name="ln-14130"></a>
<a name="ln-14131"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-14132"></a>          <span class="c">! na</span>
<a name="ln-14133"></a>
<a name="ln-14134"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-14135"></a>          <span class="c">! na</span>
<a name="ln-14136"></a>
<a name="ln-14137"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-14138"></a>          <span class="c">! na</span>
<a name="ln-14139"></a>
<a name="ln-14140"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-14141"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">UnitarySysNum</span>       <span class="c">! index of this coil</span>
<a name="ln-14142"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirTemp</span>        <span class="c">! outlet air humidity ratio [kg/kg]</span>
<a name="ln-14143"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ReqOutput</span>
<a name="ln-14144"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">FirstHVACIteration</span>
<a name="ln-14145"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">errflag</span>
<a name="ln-14146"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RuntimeFrac</span>
<a name="ln-14147"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Dummy</span>
<a name="ln-14148"></a>
<a name="ln-14149"></a>  <span class="n">UnitarySysNum</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-14150"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14151"></a><span class="k">    </span><span class="n">FirstHVACIteration</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-14152"></a>  <span class="k">ELSE</span>
<a name="ln-14153"></a><span class="k">    </span><span class="n">FirstHVACIteration</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-14154"></a>  <span class="k">END IF</span>
<a name="ln-14155"></a><span class="k">  </span><span class="n">ReqOutput</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-14156"></a>
<a name="ln-14157"></a>  <span class="k">CALL </span><span class="n">HeatPumpRunFrac</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="n">errflag</span><span class="p">,</span><span class="n">RuntimeFrac</span><span class="p">)</span>
<a name="ln-14158"></a>
<a name="ln-14159"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">RuntimeFrac</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span> <span class="o">==</span> <span class="n">CycFanCycCoil</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-14160"></a><span class="k">    </span><span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="n">PartLoadRatio</span><span class="o">/</span><span class="n">RuntimeFrac</span>
<a name="ln-14161"></a>  <span class="k">ELSE</span>
<a name="ln-14162"></a><span class="k">    </span><span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-14163"></a>  <span class="k">END IF</span>
<a name="ln-14164"></a>
<a name="ln-14165"></a><span class="k">  </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-14166"></a>  <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">WSHPRuntimeFrac</span>   <span class="o">=</span> <span class="n">RuntimeFrac</span>
<a name="ln-14167"></a>
<a name="ln-14168"></a>  <span class="n">Dummy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-14169"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWaterToAirHPSimple</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14170"></a><span class="k">    CALL </span><span class="n">SimWatertoAirHPSimple</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span> <span class="n">ReqOutput</span><span class="p">,</span> <span class="n">Dummy</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-14171"></a>                               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">RuntimeFrac</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-14172"></a>                               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-14173"></a>                               <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-14174"></a>                               <span class="mi">0</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-14175"></a>  <span class="k">ELSE</span>
<a name="ln-14176"></a><span class="k">    CALL </span><span class="n">SimWatertoAirHP</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-14177"></a>                         <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatAirMassFlow</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-14178"></a>                         <span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">RuntimeFrac</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-14179"></a>                         <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-14180"></a>                         <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">InitHeatPump</span><span class="p">,</span> <span class="n">ReqOutput</span><span class="p">,</span><span class="n">Dummy</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-14181"></a>  <span class="k">END IF</span>
<a name="ln-14182"></a>
<a name="ln-14183"></a><span class="k">  </span><span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilOutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-14184"></a>  <span class="n">Residuum</span>      <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">OutletAirTemp</span>
<a name="ln-14185"></a>
<a name="ln-14186"></a>  <span class="k">RETURN</span>
<a name="ln-14187"></a><span class="k">END FUNCTION </span><span class="n">HeatWatertoAirHPTempResidual</span>
<a name="ln-14188"></a>
<a name="ln-14189"></a><span class="k">SUBROUTINE </span><span class="n">HeatPumpRunFrac</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">PLR</span><span class="p">,</span><span class="n">errflag</span><span class="p">,</span><span class="n">RuntimeFrac</span><span class="p">)</span>
<a name="ln-14190"></a>
<a name="ln-14191"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-14192"></a>          <span class="c">!       AUTHOR         Kenneth Tang</span>
<a name="ln-14193"></a>          <span class="c">!       DATE WRITTEN   Apr 2004</span>
<a name="ln-14194"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-14195"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-14196"></a>
<a name="ln-14197"></a>
<a name="ln-14198"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-14199"></a>          <span class="c">! This subroutine calculates the PLF based on the PLR. Parameters required are</span>
<a name="ln-14200"></a>          <span class="c">! thermostat cycling rate (Nmax), heat pump time constant (tau), and the fraction</span>
<a name="ln-14201"></a>          <span class="c">! of on-cycle power use (pr)</span>
<a name="ln-14202"></a>
<a name="ln-14203"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-14204"></a>          <span class="c">! NA</span>
<a name="ln-14205"></a>
<a name="ln-14206"></a>
<a name="ln-14207"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-14208"></a>          <span class="c">! (1) Henderson, H. I., K. Rengarajan.1996. A Model to predict the latent capacity</span>
<a name="ln-14209"></a>          <span class="c">! of air conditioners and heat pumps at part-load conditions with constant fan</span>
<a name="ln-14210"></a>          <span class="c">! operation. ASHRAE Transactions 102 (1): 266-274</span>
<a name="ln-14211"></a>
<a name="ln-14212"></a>          <span class="c">! (2) Henderson, H.I. Jr., Y.J. Huang and Danny Parker. 1999. Residential Equipment</span>
<a name="ln-14213"></a>          <span class="c">! Part Load Curves for Use in DOE-2.  Environmental Energy Technologies Division,</span>
<a name="ln-14214"></a>          <span class="c">! Ernest OrlanDO Lawrence Berkeley National Laboratory.</span>
<a name="ln-14215"></a>
<a name="ln-14216"></a>
<a name="ln-14217"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-14218"></a>
<a name="ln-14219"></a>
<a name="ln-14220"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-14221"></a>
<a name="ln-14222"></a>
<a name="ln-14223"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-14224"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">UnitarySysNum</span>       <span class="c">! UnitarySystem Index Number</span>
<a name="ln-14225"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">PLR</span>              <span class="c">! part load ratio</span>
<a name="ln-14226"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">RuntimeFrac</span>      <span class="c">! the required run time fraction to meet part load</span>
<a name="ln-14227"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">errflag</span>          <span class="c">! part load factor out of range flag</span>
<a name="ln-14228"></a>
<a name="ln-14229"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-14230"></a>          <span class="c">! na</span>
<a name="ln-14231"></a>
<a name="ln-14232"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-14233"></a>          <span class="c">! na</span>
<a name="ln-14234"></a>
<a name="ln-14235"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-14236"></a>          <span class="c">! na</span>
<a name="ln-14237"></a>
<a name="ln-14238"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-14239"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartLoadFactor</span> <span class="c">! Part load factor</span>
<a name="ln-14240"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Nmax</span>           <span class="c">! Maximum cycling rate [cycles/hr]</span>
<a name="ln-14241"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tau</span>            <span class="c">! Heat pump time constant [s]</span>
<a name="ln-14242"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pr</span>             <span class="c">! On-cycle power use fraction [~]</span>
<a name="ln-14243"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">error</span>          <span class="c">! Calculation error</span>
<a name="ln-14244"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PLF1</span>           <span class="c">! ith term of part load factor</span>
<a name="ln-14245"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PLF2</span>           <span class="c">! (i+1)th term of part load factor</span>
<a name="ln-14246"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A</span>              <span class="c">! Variable for simplIFy equation</span>
<a name="ln-14247"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NumIteration</span>   <span class="c">! Iteration Counter</span>
<a name="ln-14248"></a>
<a name="ln-14249"></a>  <span class="n">Nmax</span><span class="o">=</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span>
<a name="ln-14250"></a>  <span class="n">tau</span><span class="o">=</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span>
<a name="ln-14251"></a>  <span class="n">pr</span><span class="o">=</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">OnCyclePowerFraction</span>
<a name="ln-14252"></a>
<a name="ln-14253"></a>  <span class="c">!Initialize</span>
<a name="ln-14254"></a>  <span class="n">errflag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-14255"></a>  <span class="n">error</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-14256"></a>  <span class="n">NumIteration</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-14257"></a>
<a name="ln-14258"></a>  <span class="c">!Initial guess for part load fraction</span>
<a name="ln-14259"></a>  <span class="n">PLF1</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-14260"></a>
<a name="ln-14261"></a>  <span class="c">!Calculate PLF using successive substitution until convergence</span>
<a name="ln-14262"></a>  <span class="c">!is achieved</span>
<a name="ln-14263"></a>  <span class="n">LOOPPLF</span><span class="p">:</span> <span class="k">DO</span>
<a name="ln-14264"></a><span class="k">    </span><span class="n">NumIteration</span><span class="o">=</span><span class="n">NumIteration</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-14265"></a>
<a name="ln-14266"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PLR</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14267"></a>        <span class="c">! Set part load fraction, PLF1=1.0 IF PLR=1.0 and EXIT loop</span>
<a name="ln-14268"></a>        <span class="n">PLF1</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-14269"></a>        <span class="k">EXIT </span><span class="n">LOOPPLF</span>
<a name="ln-14270"></a>    <span class="k">END IF</span>
<a name="ln-14271"></a>
<a name="ln-14272"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">NumIteration</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="mi">100</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-14273"></a>        <span class="c">! EXIT loop IF interation exceed 100</span>
<a name="ln-14274"></a>        <span class="n">errflag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-14275"></a>        <span class="n">PLF1</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-14276"></a>        <span class="k">EXIT </span><span class="n">LOOPPLF</span>
<a name="ln-14277"></a>    <span class="k">END IF</span>
<a name="ln-14278"></a>
<a name="ln-14279"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">error</span><span class="p">.</span><span class="n">LT</span><span class="p">.</span><span class="mf">0.00001d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-14280"></a>        <span class="c">! EXIT loop IF convergence is achieved</span>
<a name="ln-14281"></a>        <span class="k">EXIT </span><span class="n">LOOPPLF</span>
<a name="ln-14282"></a>
<a name="ln-14283"></a>    <span class="k">ELSE</span>
<a name="ln-14284"></a>        <span class="c">! Calculate PLF</span>
<a name="ln-14285"></a>        <span class="n">A</span> <span class="o">=</span> <span class="mf">4.d0</span> <span class="o">*</span> <span class="n">tau</span> <span class="o">*</span> <span class="p">(</span><span class="n">Nmax</span><span class="o">/</span><span class="mi">360</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">PLR</span> <span class="o">/</span> <span class="n">PLF1</span><span class="p">)</span>
<a name="ln-14286"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">LT</span><span class="p">.</span><span class="mf">1.5d-3</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14287"></a>            <span class="c">! A safety check to prevent PLF2 = 1 - A * (1 - Exp(-1 / A))</span>
<a name="ln-14288"></a>            <span class="c">! from &quot;float underflow error&quot;. Occurs when PLR is very close to 1.0,</span>
<a name="ln-14289"></a>            <span class="c">! small A value, thus Exp(-1/A) = 0</span>
<a name="ln-14290"></a>            <span class="n">PLF2</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">A</span>
<a name="ln-14291"></a>        <span class="k">ELSE</span>
<a name="ln-14292"></a><span class="k">            </span><span class="n">PLF2</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">A</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="nb">Exp</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0d0</span> <span class="o">/</span> <span class="n">A</span><span class="p">))</span>
<a name="ln-14293"></a>        <span class="k">END IF</span>
<a name="ln-14294"></a><span class="k">        </span><span class="n">error</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">((</span><span class="n">PLF2</span> <span class="o">-</span> <span class="n">PLF1</span><span class="p">)</span> <span class="o">/</span> <span class="n">PLF1</span><span class="p">)</span>
<a name="ln-14295"></a>        <span class="n">PLF1</span> <span class="o">=</span> <span class="n">PLF2</span>
<a name="ln-14296"></a>     <span class="k">END IF</span>
<a name="ln-14297"></a><span class="k">  END DO </span><span class="n">LOOPPLF</span>
<a name="ln-14298"></a>
<a name="ln-14299"></a>  <span class="c">!Adjust PLF for the off cycle power consumption IF</span>
<a name="ln-14300"></a>  <span class="c">!on-cycle power use is specified by the user</span>
<a name="ln-14301"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">pr</span><span class="o">&gt;</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14302"></a><span class="k">    </span><span class="n">PartLoadFactor</span> <span class="o">=</span> <span class="n">PLR</span> <span class="o">/</span> <span class="p">((</span><span class="n">PLR</span> <span class="o">/</span> <span class="n">PLF1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">PLR</span> <span class="o">/</span> <span class="n">PLF1</span><span class="p">)</span> <span class="o">*</span> <span class="n">pr</span><span class="p">)</span>
<a name="ln-14303"></a>  <span class="k">ELSE</span>
<a name="ln-14304"></a><span class="k">    </span><span class="n">PartLoadFactor</span><span class="o">=</span><span class="n">PLF1</span>
<a name="ln-14305"></a>  <span class="k">END IF</span>
<a name="ln-14306"></a>
<a name="ln-14307"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">PartLoadFactor</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-14308"></a><span class="k">     </span><span class="n">PartLoadFactor</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-14309"></a>     <span class="n">RuntimeFrac</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-14310"></a>     <span class="n">errflag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-14311"></a>  <span class="k">ELSE</span>
<a name="ln-14312"></a><span class="k">     </span><span class="n">RuntimeFrac</span> <span class="o">=</span> <span class="n">PLR</span> <span class="o">/</span> <span class="n">PartLoadFactor</span>
<a name="ln-14313"></a>  <span class="k">END IF</span>
<a name="ln-14314"></a>
<a name="ln-14315"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">RuntimeFrac</span> <span class="o">&gt;</span> <span class="mf">1.0d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14316"></a><span class="k">     </span><span class="n">RuntimeFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-14317"></a>  <span class="k">END IF</span>
<a name="ln-14318"></a>
<a name="ln-14319"></a><span class="k"> RETURN</span>
<a name="ln-14320"></a>
<a name="ln-14321"></a><span class="k">END SUBROUTINE </span><span class="n">HeatPumpRunFrac</span>
<a name="ln-14322"></a>
<a name="ln-14323"></a><span class="k">FUNCTION </span><span class="n">MultiModeDXCoilResidual</span><span class="p">(</span><span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Residuum</span><span class="p">)</span>
<a name="ln-14324"></a>
<a name="ln-14325"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-14326"></a>          <span class="c">!       AUTHOR         M. J. Witte, GARD Analytics, Inc.</span>
<a name="ln-14327"></a>          <span class="c">!       DATE WRITTEN   February 2005</span>
<a name="ln-14328"></a>          <span class="c">!                      (based on DOE2DXCoilResidual by Richard Raustad, FSEC)</span>
<a name="ln-14329"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-14330"></a>          <span class="c">!       RE-ENGINEERED</span>
<a name="ln-14331"></a>
<a name="ln-14332"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-14333"></a>          <span class="c">! Calculates residual function (desired outlet temp - actual outlet temp)</span>
<a name="ln-14334"></a>          <span class="c">! DX Coil output depends on the part load ratio which is being varied to zero the residual.</span>
<a name="ln-14335"></a>
<a name="ln-14336"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-14337"></a>          <span class="c">! Calls SimDXCoilMultiMode to get outlet temperature at the given cycling ratio</span>
<a name="ln-14338"></a>          <span class="c">! and calculates the residual as defined above</span>
<a name="ln-14339"></a>
<a name="ln-14340"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-14341"></a>
<a name="ln-14342"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-14343"></a>  <span class="k">USE </span><span class="n">DXCoils</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">DXCoilOutletTemp</span><span class="p">,</span> <span class="n">SimDXCoilMultiMode</span>
<a name="ln-14344"></a>
<a name="ln-14345"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-14346"></a>
<a name="ln-14347"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-14348"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">PartLoadRatio</span> <span class="c">! compressor cycling ratio (1.0 is continuous, 0.0 is off)</span>
<a name="ln-14349"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">Par</span> <span class="c">! par(1) = DX coil number</span>
<a name="ln-14350"></a>                                                    <span class="c">! par(2) = desired air outlet temperature [C]</span>
<a name="ln-14351"></a>                                                    <span class="c">! par(3) = dehumidification mode (0=normal, 1=enhanced)</span>
<a name="ln-14352"></a>                                                    <span class="c">! par(4) = supply air fan operating mode (ContFanCycCoil)</span>
<a name="ln-14353"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">Residuum</span> <span class="c">! residual to be minimized to zero</span>
<a name="ln-14354"></a>
<a name="ln-14355"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-14356"></a>          <span class="c">! na</span>
<a name="ln-14357"></a>
<a name="ln-14358"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-14359"></a>          <span class="c">! na</span>
<a name="ln-14360"></a>
<a name="ln-14361"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-14362"></a>          <span class="c">! na</span>
<a name="ln-14363"></a>
<a name="ln-14364"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-14365"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoilIndex</span>       <span class="c">! index of this coil</span>
<a name="ln-14366"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirTemp</span>   <span class="c">! outlet air temperature [C]</span>
<a name="ln-14367"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">DehumidMode</span>     <span class="c">! dehumidification mode (par3)</span>
<a name="ln-14368"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">FanOpMode</span>       <span class="c">! supply air fan operating mode</span>
<a name="ln-14369"></a>
<a name="ln-14370"></a>  <span class="n">CoilIndex</span>   <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-14371"></a>  <span class="n">DehumidMode</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-14372"></a>  <span class="n">FanOpMode</span>   <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-14373"></a>  <span class="k">CALL </span><span class="n">SimDXCoilMultiMode</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">On</span><span class="p">,.</span><span class="n">FALSE</span><span class="p">.,</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="n">DehumidMode</span><span class="p">,</span><span class="n">CoilIndex</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">)</span>
<a name="ln-14374"></a>  <span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">DXCoilOutletTemp</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">)</span>
<a name="ln-14375"></a>  <span class="n">Residuum</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">OutletAirTemp</span>
<a name="ln-14376"></a>
<a name="ln-14377"></a>  <span class="k">RETURN</span>
<a name="ln-14378"></a><span class="k">END FUNCTION </span><span class="n">MultiModeDXCoilResidual</span>
<a name="ln-14379"></a>
<a name="ln-14380"></a><span class="k">FUNCTION </span><span class="n">MultiModeDXCoilHumRatResidual</span><span class="p">(</span><span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Residuum</span><span class="p">)</span>
<a name="ln-14381"></a>
<a name="ln-14382"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-14383"></a>          <span class="c">!       AUTHOR         Richard Raustad, FSEC</span>
<a name="ln-14384"></a>          <span class="c">!       DATE WRITTEN   January 2008</span>
<a name="ln-14385"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-14386"></a>          <span class="c">!       RE-ENGINEERED</span>
<a name="ln-14387"></a>
<a name="ln-14388"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-14389"></a>          <span class="c">! Calculates residual function (desired outlet humrat - actual outlet humrat)</span>
<a name="ln-14390"></a>          <span class="c">! DX Coil output depends on the part load ratio which is being varied to zero the residual.</span>
<a name="ln-14391"></a>
<a name="ln-14392"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-14393"></a>          <span class="c">! Calls SimDXCoilMultiMode to get outlet humidity ratio at the given cycling ratio</span>
<a name="ln-14394"></a>          <span class="c">! and calculates the residual as defined above</span>
<a name="ln-14395"></a>
<a name="ln-14396"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-14397"></a>
<a name="ln-14398"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-14399"></a>  <span class="k">USE </span><span class="n">DXCoils</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">DXCoilOutletHumRat</span><span class="p">,</span> <span class="n">SimDXCoilMultiMode</span>
<a name="ln-14400"></a>
<a name="ln-14401"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-14402"></a>
<a name="ln-14403"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-14404"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">PartLoadRatio</span> <span class="c">! compressor cycling ratio (1.0 is continuous, 0.0 is off)</span>
<a name="ln-14405"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">Par</span> <span class="c">! par(1) = DX coil number</span>
<a name="ln-14406"></a>                                                    <span class="c">! par(2) = desired air outlet humidity ratio [kg/kg]</span>
<a name="ln-14407"></a>                                                    <span class="c">! par(3) = dehumidification mode (0=normal, 1=enhanced)</span>
<a name="ln-14408"></a>                                                    <span class="c">! par(4) = supply air fan operating mode (ContFanCycCoil)</span>
<a name="ln-14409"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">Residuum</span> <span class="c">! residual to be minimized to zero</span>
<a name="ln-14410"></a>
<a name="ln-14411"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-14412"></a>          <span class="c">! na</span>
<a name="ln-14413"></a>
<a name="ln-14414"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-14415"></a>          <span class="c">! na</span>
<a name="ln-14416"></a>
<a name="ln-14417"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-14418"></a>          <span class="c">! na</span>
<a name="ln-14419"></a>
<a name="ln-14420"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-14421"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoilIndex</span>       <span class="c">! index of this coil</span>
<a name="ln-14422"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirHumRat</span> <span class="c">! outlet air humidity ratio [kg/kg]</span>
<a name="ln-14423"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">DehumidMode</span>     <span class="c">! dehumidification mode (par3)</span>
<a name="ln-14424"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">FanOpMode</span>       <span class="c">! supply air fan operating mode</span>
<a name="ln-14425"></a>
<a name="ln-14426"></a>  <span class="n">CoilIndex</span>   <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-14427"></a>  <span class="n">DehumidMode</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-14428"></a>  <span class="n">FanOpMode</span>   <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-14429"></a>  <span class="k">CALL </span><span class="n">SimDXCoilMultiMode</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">On</span><span class="p">,.</span><span class="n">FALSE</span><span class="p">.,</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="n">DehumidMode</span><span class="p">,</span><span class="n">CoilIndex</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">)</span>
<a name="ln-14430"></a>  <span class="n">OutletAirHumRat</span> <span class="o">=</span> <span class="n">DXCoilOutletHumRat</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">)</span>
<a name="ln-14431"></a>  <span class="n">Residuum</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">OutletAirHumRat</span>
<a name="ln-14432"></a>
<a name="ln-14433"></a>  <span class="k">RETURN</span>
<a name="ln-14434"></a><span class="k">END FUNCTION </span><span class="n">MultiModeDXCoilHumRatResidual</span>
<a name="ln-14435"></a>
<a name="ln-14436"></a><span class="k">FUNCTION </span><span class="n">HXAssistedCoolCoilTempResidual</span><span class="p">(</span><span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Residuum</span><span class="p">)</span>
<a name="ln-14437"></a>
<a name="ln-14438"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-14439"></a>          <span class="c">!       AUTHOR         Richard Raustad, FSEC</span>
<a name="ln-14440"></a>          <span class="c">!       DATE WRITTEN   November 2003</span>
<a name="ln-14441"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-14442"></a>          <span class="c">!       RE-ENGINEERED</span>
<a name="ln-14443"></a>
<a name="ln-14444"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-14445"></a>          <span class="c">!  Calculates residual function (desired outlet temp - actual outlet temp)</span>
<a name="ln-14446"></a>          <span class="c">!  DX Coil output depends on the part load ratio which is being varied to zero the residual.</span>
<a name="ln-14447"></a>
<a name="ln-14448"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-14449"></a>          <span class="c">!  Calls CalcHXAssistedCoolingCoil to get outlet temperature at the given part load ratio</span>
<a name="ln-14450"></a>          <span class="c">!  and calculates the residual as defined above</span>
<a name="ln-14451"></a>
<a name="ln-14452"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-14453"></a>
<a name="ln-14454"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-14455"></a>  <span class="k">USE </span><span class="n">HVACHXAssistedCoolingCoil</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">HXAssistedCoilOutletTemp</span><span class="p">,</span> <span class="n">CalcHXAssistedCoolingCoil</span>
<a name="ln-14456"></a>
<a name="ln-14457"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-14458"></a>
<a name="ln-14459"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-14460"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">PartLoadRatio</span> <span class="c">! compressor cycling ratio (1.0 is continuous, 0.0 is off)</span>
<a name="ln-14461"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">Par</span> <span class="c">! par(1) = DX coil number</span>
<a name="ln-14462"></a>                                                  <span class="c">! par(2) = desired air outlet temperature [C]</span>
<a name="ln-14463"></a>                                                  <span class="c">! par(3) = FirstHVACIteration logical converted to numeric (1=TRUE,0=FALSE)</span>
<a name="ln-14464"></a>                                                  <span class="c">! par(4) = HX control (On/Off)</span>
<a name="ln-14465"></a>                                                  <span class="c">! par(5) = supply air fan operating mode (ContFanCycCoil)</span>
<a name="ln-14466"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">Residuum</span>  <span class="c">! residual to be minimized to zero</span>
<a name="ln-14467"></a>
<a name="ln-14468"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-14469"></a>          <span class="c">!  na</span>
<a name="ln-14470"></a>
<a name="ln-14471"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-14472"></a>          <span class="c">!  na</span>
<a name="ln-14473"></a>
<a name="ln-14474"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-14475"></a>          <span class="c">!  na</span>
<a name="ln-14476"></a>
<a name="ln-14477"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-14478"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoilIndex</span>          <span class="c">! index of this coil</span>
<a name="ln-14479"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirTemp</span>      <span class="c">! outlet air temperature [C]</span>
<a name="ln-14480"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">FirstHVACIteration</span> <span class="c">! FirstHVACIteration flag</span>
<a name="ln-14481"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">HXUnitOn</span>           <span class="c">! flag to enable heat exchanger heat recovery</span>
<a name="ln-14482"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">FanOpMode</span>          <span class="c">! Supply air fan operating mode</span>
<a name="ln-14483"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">UnitarySysNum</span>      <span class="c">! index to unitary system</span>
<a name="ln-14484"></a>
<a name="ln-14485"></a>  <span class="n">CoilIndex</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-14486"></a>  <span class="c">! FirstHVACIteration is a logical, Par is REAL(r64), so make 1=TRUE and 0=FALSE</span>
<a name="ln-14487"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-14488"></a><span class="k">    </span><span class="n">FirstHVACIteration</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-14489"></a>  <span class="k">ELSE</span>
<a name="ln-14490"></a><span class="k">    </span><span class="n">FirstHVACIteration</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-14491"></a>  <span class="k">END IF</span>
<a name="ln-14492"></a><span class="k">  IF</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-14493"></a><span class="k">    </span><span class="n">HXUnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-14494"></a>  <span class="k">ELSE</span>
<a name="ln-14495"></a><span class="k">    </span><span class="n">HXUnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-14496"></a>  <span class="k">END IF</span>
<a name="ln-14497"></a><span class="k">  </span><span class="n">FanOpMode</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-14498"></a>  <span class="n">UnitarySysNum</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-14499"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilFluidInletNode</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-14500"></a><span class="k">    </span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilFluidInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-14501"></a>      <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxCoolCoilFluidFlow</span> <span class="o">*</span> <span class="n">PartLoadRatio</span>
<a name="ln-14502"></a>  <span class="k">END IF</span>
<a name="ln-14503"></a><span class="k">  CALL </span><span class="n">CalcHXAssistedCoolingCoil</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">On</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">HXUnitOn</span><span class="p">,</span> <span class="n">FanOpMode</span><span class="p">)</span>
<a name="ln-14504"></a>  <span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">HXAssistedCoilOutletTemp</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">)</span>
<a name="ln-14505"></a>  <span class="n">Residuum</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">OutletAirTemp</span>
<a name="ln-14506"></a>  <span class="k">RETURN</span>
<a name="ln-14507"></a>
<a name="ln-14508"></a><span class="k">END FUNCTION </span><span class="n">HXAssistedCoolCoilTempResidual</span>
<a name="ln-14509"></a>
<a name="ln-14510"></a><span class="k">FUNCTION </span><span class="n">HXAssistedCoolCoilHRResidual</span><span class="p">(</span><span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Residuum</span><span class="p">)</span>
<a name="ln-14511"></a>
<a name="ln-14512"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-14513"></a>          <span class="c">!       AUTHOR         Richard Raustad, FSEC</span>
<a name="ln-14514"></a>          <span class="c">!       DATE WRITTEN   January 2008</span>
<a name="ln-14515"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-14516"></a>          <span class="c">!       RE-ENGINEERED</span>
<a name="ln-14517"></a>
<a name="ln-14518"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-14519"></a>          <span class="c">!  Calculates residual function (desired outlet humrat - actual outlet humrat)</span>
<a name="ln-14520"></a>          <span class="c">!  DX Coil output depends on the part load ratio which is being varied to zero the residual.</span>
<a name="ln-14521"></a>
<a name="ln-14522"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-14523"></a>          <span class="c">!  Calls CalcHXAssistedCoolingCoil to get outlet humidity ratio at the given part load ratio</span>
<a name="ln-14524"></a>          <span class="c">!  and calculates the residual as defined above</span>
<a name="ln-14525"></a>
<a name="ln-14526"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-14527"></a>
<a name="ln-14528"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-14529"></a>  <span class="k">USE </span><span class="n">HVACHXAssistedCoolingCoil</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">HXAssistedCoilOutletHumRat</span><span class="p">,</span> <span class="n">CalcHXAssistedCoolingCoil</span>
<a name="ln-14530"></a>
<a name="ln-14531"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-14532"></a>
<a name="ln-14533"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-14534"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">PartLoadRatio</span> <span class="c">! compressor cycling ratio (1.0 is continuous, 0.0 is off)</span>
<a name="ln-14535"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">Par</span> <span class="c">! par(1) = DX coil number</span>
<a name="ln-14536"></a>                                                  <span class="c">! par(2) = desired air outlet humidity ratio [kg/kg]</span>
<a name="ln-14537"></a>                                                  <span class="c">! par(3) = FirstHVACIteration logical converted to numeric (1=TRUE,0=FALSE)</span>
<a name="ln-14538"></a>                                                  <span class="c">! par(4) = HX control (On/Off)</span>
<a name="ln-14539"></a>                                                  <span class="c">! par(5) = supply air fan operating mode (ContFanCycCoil)</span>
<a name="ln-14540"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">Residuum</span>  <span class="c">! residual to be minimized to zero</span>
<a name="ln-14541"></a>
<a name="ln-14542"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-14543"></a>          <span class="c">!  na</span>
<a name="ln-14544"></a>
<a name="ln-14545"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-14546"></a>          <span class="c">!  na</span>
<a name="ln-14547"></a>
<a name="ln-14548"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-14549"></a>          <span class="c">!  na</span>
<a name="ln-14550"></a>
<a name="ln-14551"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-14552"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoilIndex</span>          <span class="c">! index of this coil</span>
<a name="ln-14553"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirHumRat</span>    <span class="c">! outlet air humidity ratio [kg/kg]</span>
<a name="ln-14554"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">FirstHVACIteration</span> <span class="c">! FirstHVACIteration flag</span>
<a name="ln-14555"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">HXUnitOn</span>           <span class="c">! flag to enable heat exchanger heat recovery</span>
<a name="ln-14556"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">FanOpMode</span>          <span class="c">! Supply air fan operating mode</span>
<a name="ln-14557"></a>
<a name="ln-14558"></a>  <span class="n">CoilIndex</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-14559"></a>  <span class="c">! FirstHVACIteration is a logical, Par is REAL(r64), so make 1=TRUE and 0=FALSE</span>
<a name="ln-14560"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-14561"></a><span class="k">    </span><span class="n">FirstHVACIteration</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-14562"></a>  <span class="k">ELSE</span>
<a name="ln-14563"></a><span class="k">    </span><span class="n">FirstHVACIteration</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-14564"></a>  <span class="k">END IF</span>
<a name="ln-14565"></a><span class="k">  IF</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-14566"></a><span class="k">    </span><span class="n">HXUnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-14567"></a>  <span class="k">ELSE</span>
<a name="ln-14568"></a><span class="k">    </span><span class="n">HXUnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-14569"></a>  <span class="k">END IF</span>
<a name="ln-14570"></a><span class="k">  </span><span class="n">FanOpMode</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-14571"></a>  <span class="k">CALL </span><span class="n">CalcHXAssistedCoolingCoil</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">On</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">HXUnitOn</span><span class="p">,</span> <span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-14572"></a>                                 <span class="n">EconomizerFlag</span><span class="o">=</span><span class="n">EconomizerFlag</span><span class="p">)</span>
<a name="ln-14573"></a>  <span class="n">OutletAirHumRat</span> <span class="o">=</span> <span class="n">HXAssistedCoilOutletHumRat</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">)</span>
<a name="ln-14574"></a>  <span class="n">Residuum</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">OutletAirHumRat</span>
<a name="ln-14575"></a>  <span class="k">RETURN</span>
<a name="ln-14576"></a>
<a name="ln-14577"></a><span class="k">END FUNCTION </span><span class="n">HXAssistedCoolCoilHRResidual</span>
<a name="ln-14578"></a>
<a name="ln-14579"></a><span class="k">FUNCTION </span><span class="n">GasElecHeatingCoilResidual</span><span class="p">(</span><span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Residuum</span><span class="p">)</span>
<a name="ln-14580"></a>
<a name="ln-14581"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-14582"></a>          <span class="c">!       AUTHOR         Chandan Sharma, FSEC</span>
<a name="ln-14583"></a>          <span class="c">!       DATE WRITTEN   February 2013</span>
<a name="ln-14584"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-14585"></a>          <span class="c">!       RE-ENGINEERED</span>
<a name="ln-14586"></a>
<a name="ln-14587"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-14588"></a>          <span class="c">! Calculates residual function (desired outlet temp - actual outlet temp)</span>
<a name="ln-14589"></a>          <span class="c">! hot water Coil output depends on the part load ratio which is being varied to zero the residual.</span>
<a name="ln-14590"></a>
<a name="ln-14591"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-14592"></a>          <span class="c">! Calls SimulateHeatingCoilComponents to get outlet temperature at the given part load ratio</span>
<a name="ln-14593"></a>          <span class="c">! and calculates the residual as defined above</span>
<a name="ln-14594"></a>
<a name="ln-14595"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-14596"></a>
<a name="ln-14597"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-14598"></a>  <span class="k">USE </span><span class="n">HeatingCoils</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateHeatingCoilComponents</span>
<a name="ln-14599"></a>
<a name="ln-14600"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-14601"></a>
<a name="ln-14602"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-14603"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">PartLoadFrac</span>               <span class="c">! Compressor cycling ratio (1.0 is continuous, 0.0 is off)</span>
<a name="ln-14604"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">Par</span> <span class="c">! Par(1) = DX coil number</span>
<a name="ln-14605"></a>                                                    <span class="c">! Par(2) = desired air outlet temperature [C]</span>
<a name="ln-14606"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">Residuum</span>                   <span class="c">! Residual to be minimized to zero</span>
<a name="ln-14607"></a>
<a name="ln-14608"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-14609"></a>          <span class="c">! na</span>
<a name="ln-14610"></a>
<a name="ln-14611"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-14612"></a>          <span class="c">! na</span>
<a name="ln-14613"></a>
<a name="ln-14614"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-14615"></a>          <span class="c">! na</span>
<a name="ln-14616"></a>
<a name="ln-14617"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-14618"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">OutletAirTemp</span>    <span class="c">! Outlet air temperature [C]</span>
<a name="ln-14619"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">UnitarySysNum</span>
<a name="ln-14620"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">FanOpMode</span>              <span class="o">=</span><span class="mi">0</span>   <span class="c">! Fan operating mode (see parameter above)</span>
<a name="ln-14621"></a>  <span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">FirstHVACIteration</span>
<a name="ln-14622"></a>  <span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">SuppHeatingCoilFlag</span>
<a name="ln-14623"></a>
<a name="ln-14624"></a>  <span class="n">UnitarySysNum</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-14625"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14626"></a><span class="k">    </span><span class="n">FirstHVACIteration</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-14627"></a>  <span class="k">ELSE</span>
<a name="ln-14628"></a><span class="k">    </span><span class="n">FirstHVACIteration</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-14629"></a>  <span class="k">END IF</span>
<a name="ln-14630"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14631"></a><span class="k">    </span><span class="n">SuppHeatingCoilFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-14632"></a>  <span class="k">ELSE</span>
<a name="ln-14633"></a><span class="k">    </span><span class="n">SuppHeatingCoilFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-14634"></a>  <span class="k">END IF</span>
<a name="ln-14635"></a><span class="k">  </span><span class="n">FanOpMode</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-14636"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SuppHeatingCoilFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14637"></a><span class="k">    CALL </span><span class="n">SimulateHeatingCoilComponents</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-14638"></a>                                       <span class="n">CompIndex</span><span class="o">=</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-14639"></a>                                       <span class="n">FanOpMode</span><span class="o">=</span><span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-14640"></a>                                       <span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-14641"></a>    <span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilOutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-14642"></a>  <span class="k">ELSE</span>
<a name="ln-14643"></a><span class="k">    CALL </span><span class="n">SimulateHeatingCoilComponents</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-14644"></a>                                       <span class="n">CompIndex</span><span class="o">=</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-14645"></a>                                       <span class="n">FanOpMode</span><span class="o">=</span><span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-14646"></a>                                       <span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">SuppHeat</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.)</span>
<a name="ln-14647"></a>    <span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilAirOutletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-14648"></a>  <span class="k">END IF</span>
<a name="ln-14649"></a><span class="k">  </span><span class="n">Residuum</span>      <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">OutletAirTemp</span>
<a name="ln-14650"></a>
<a name="ln-14651"></a>  <span class="k">RETURN</span>
<a name="ln-14652"></a><span class="k">END FUNCTION </span><span class="n">GasElecHeatingCoilResidual</span>
<a name="ln-14653"></a>
<a name="ln-14654"></a><span class="k">FUNCTION </span><span class="n">HotWaterHeatingCoilResidual</span><span class="p">(</span><span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Residuum</span><span class="p">)</span>
<a name="ln-14655"></a>
<a name="ln-14656"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-14657"></a>          <span class="c">!       AUTHOR         Chandan Sharma, FSEC</span>
<a name="ln-14658"></a>          <span class="c">!       DATE WRITTEN   February 2013</span>
<a name="ln-14659"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-14660"></a>          <span class="c">!       RE-ENGINEERED</span>
<a name="ln-14661"></a>
<a name="ln-14662"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-14663"></a>          <span class="c">! Calculates residual function (desired outlet temp - actual outlet temp)</span>
<a name="ln-14664"></a>          <span class="c">! hot water Coil output depends on the part load ratio which is being varied to zero the residual.</span>
<a name="ln-14665"></a>
<a name="ln-14666"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-14667"></a>          <span class="c">! Calls SimulateWaterCoilComponents to get outlet temperature at the given part load ratio</span>
<a name="ln-14668"></a>          <span class="c">! and calculates the residual as defined above</span>
<a name="ln-14669"></a>
<a name="ln-14670"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-14671"></a>
<a name="ln-14672"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-14673"></a>  <span class="k">USE </span><span class="n">WaterCoils</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateWaterCoilComponents</span>
<a name="ln-14674"></a>
<a name="ln-14675"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-14676"></a>
<a name="ln-14677"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-14678"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">PartLoadFrac</span>               <span class="c">! Compressor cycling ratio (1.0 is continuous, 0.0 is off)</span>
<a name="ln-14679"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">Par</span> <span class="c">! Par(1) = DX coil number</span>
<a name="ln-14680"></a>                                                    <span class="c">! Par(2) = desired air outlet temperature [C]</span>
<a name="ln-14681"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">Residuum</span>                   <span class="c">! Residual to be minimized to zero</span>
<a name="ln-14682"></a>
<a name="ln-14683"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-14684"></a>          <span class="c">! na</span>
<a name="ln-14685"></a>
<a name="ln-14686"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-14687"></a>          <span class="c">! na</span>
<a name="ln-14688"></a>
<a name="ln-14689"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-14690"></a>          <span class="c">! na</span>
<a name="ln-14691"></a>
<a name="ln-14692"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-14693"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">OutletAirTemp</span>    <span class="c">! Outlet air temperature [C]</span>
<a name="ln-14694"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">mdot</span>             <span class="c">! water-side flow rate of HW coil [kg/s]</span>
<a name="ln-14695"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QActual</span>          <span class="c">! heating capacity of HW coil [W]</span>
<a name="ln-14696"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">UnitarySysNum</span>    <span class="c">! index to unitary system</span>
<a name="ln-14697"></a>  <span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">FirstHVACIteration</span> <span class="c">! iteration flag</span>
<a name="ln-14698"></a>  <span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">SuppHeatingCoilFlag</span> <span class="c">! TRUE if supplemental heating coil</span>
<a name="ln-14699"></a>  <span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">LoadBased</span>        <span class="c">! TRUE if controlling to load, else control to temperature</span>
<a name="ln-14700"></a>
<a name="ln-14701"></a>  <span class="n">UnitarySysNum</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-14702"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14703"></a><span class="k">    </span><span class="n">FirstHVACIteration</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-14704"></a>  <span class="k">ELSE</span>
<a name="ln-14705"></a><span class="k">    </span><span class="n">FirstHVACIteration</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-14706"></a>  <span class="k">END IF</span>
<a name="ln-14707"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14708"></a><span class="k">    </span><span class="n">SuppHeatingCoilFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-14709"></a>  <span class="k">ELSE</span>
<a name="ln-14710"></a><span class="k">    </span><span class="n">SuppHeatingCoilFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-14711"></a>  <span class="k">END IF</span>
<a name="ln-14712"></a><span class="k">  IF</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-14713"></a><span class="k">    </span><span class="n">LoadBased</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-14714"></a>  <span class="k">ELSE</span>
<a name="ln-14715"></a><span class="k">    </span><span class="n">LoadBased</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-14716"></a>  <span class="k">END IF</span>
<a name="ln-14717"></a><span class="k">  </span><span class="n">QActual</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-14718"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SuppHeatingCoilFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14719"></a><span class="k">    </span><span class="n">mdot</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilFluidOutletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-14720"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="o">*</span> <span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-14721"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilFluidInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">mdot</span>
<a name="ln-14722"></a>    <span class="k">CALL </span><span class="n">SimulateWaterCoilComponents</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-14723"></a>                                     <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span><span class="n">QActual</span><span class="o">=</span><span class="n">QActual</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-14724"></a>                                     <span class="n">FanOpMode</span><span class="o">=</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-14725"></a>    <span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilOutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-14726"></a>  <span class="k">ELSE</span>
<a name="ln-14727"></a><span class="k">    </span><span class="n">mdot</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilFluidOutletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-14728"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">*</span> <span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-14729"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilFluidInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">mdot</span>
<a name="ln-14730"></a>    <span class="k">CALL </span><span class="n">SimulateWaterCoilComponents</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-14731"></a>                                     <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span><span class="n">QActual</span><span class="o">=</span><span class="n">QActual</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-14732"></a>                                     <span class="n">FanOpMode</span><span class="o">=</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-14733"></a>    <span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilAirOutletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-14734"></a>  <span class="k">END IF</span>
<a name="ln-14735"></a><span class="k">  IF</span><span class="p">(</span><span class="n">LoadBased</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-14736"></a><span class="k">    </span><span class="n">Residuum</span>      <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">QActual</span>
<a name="ln-14737"></a>  <span class="k">ELSE</span>
<a name="ln-14738"></a><span class="k">    </span><span class="n">Residuum</span>      <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">OutletAirTemp</span>
<a name="ln-14739"></a>  <span class="k">END IF</span>
<a name="ln-14740"></a>
<a name="ln-14741"></a><span class="k">  RETURN</span>
<a name="ln-14742"></a><span class="k">END FUNCTION </span><span class="n">HotWaterHeatingCoilResidual</span>
<a name="ln-14743"></a>
<a name="ln-14744"></a><span class="k">FUNCTION </span><span class="n">SteamHeatingCoilResidual</span><span class="p">(</span><span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Residuum</span><span class="p">)</span>
<a name="ln-14745"></a>
<a name="ln-14746"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-14747"></a>          <span class="c">!       AUTHOR         Chandan Sharma, FSEC</span>
<a name="ln-14748"></a>          <span class="c">!       DATE WRITTEN   February 2013</span>
<a name="ln-14749"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-14750"></a>          <span class="c">!       RE-ENGINEERED</span>
<a name="ln-14751"></a>
<a name="ln-14752"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-14753"></a>          <span class="c">! Calculates residual function (desired outlet temp - actual outlet temp)</span>
<a name="ln-14754"></a>          <span class="c">! hot Steam Coil output depends on the part load ratio which is being varied to zero the residual.</span>
<a name="ln-14755"></a>
<a name="ln-14756"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-14757"></a>          <span class="c">! Calls SimulateSteamCoilComponents to get outlet temperature at the given part load ratio</span>
<a name="ln-14758"></a>          <span class="c">! and calculates the residual as defined above</span>
<a name="ln-14759"></a>
<a name="ln-14760"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-14761"></a>
<a name="ln-14762"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-14763"></a>  <span class="k">USE </span><span class="n">SteamCoils</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateSteamCoilComponents</span>
<a name="ln-14764"></a>
<a name="ln-14765"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-14766"></a>
<a name="ln-14767"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-14768"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">PartLoadFrac</span>               <span class="c">! Compressor cycling ratio (1.0 is continuous, 0.0 is off)</span>
<a name="ln-14769"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">Par</span> <span class="c">! Par(1) = DX coil number</span>
<a name="ln-14770"></a>                                                    <span class="c">! Par(2) = desired air outlet temperature [C]</span>
<a name="ln-14771"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">Residuum</span>                   <span class="c">! Residual to be minimized to zero</span>
<a name="ln-14772"></a>
<a name="ln-14773"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-14774"></a>          <span class="c">! na</span>
<a name="ln-14775"></a>
<a name="ln-14776"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-14777"></a>          <span class="c">! na</span>
<a name="ln-14778"></a>
<a name="ln-14779"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-14780"></a>          <span class="c">! na</span>
<a name="ln-14781"></a>
<a name="ln-14782"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-14783"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">OutletAirTemp</span>    <span class="c">! Outlet air temperature [C]</span>
<a name="ln-14784"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">mdot</span>
<a name="ln-14785"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">UnitarySysNum</span>
<a name="ln-14786"></a>  <span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">FirstHVACIteration</span>
<a name="ln-14787"></a>  <span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">SuppHeatingCoilFlag</span>
<a name="ln-14788"></a>
<a name="ln-14789"></a>  <span class="n">UnitarySysNum</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-14790"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14791"></a><span class="k">    </span><span class="n">FirstHVACIteration</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-14792"></a>  <span class="k">ELSE</span>
<a name="ln-14793"></a><span class="k">    </span><span class="n">FirstHVACIteration</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-14794"></a>  <span class="k">END IF</span>
<a name="ln-14795"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14796"></a><span class="k">    </span><span class="n">SuppHeatingCoilFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-14797"></a>  <span class="k">ELSE</span>
<a name="ln-14798"></a><span class="k">    </span><span class="n">SuppHeatingCoilFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-14799"></a>  <span class="k">END IF</span>
<a name="ln-14800"></a>
<a name="ln-14801"></a><span class="k">  IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SuppHeatingCoilFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14802"></a><span class="k">    </span><span class="n">mdot</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilFluidOutletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-14803"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="o">*</span> <span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-14804"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilFluidInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">mdot</span>
<a name="ln-14805"></a>    <span class="k">CALL </span><span class="n">SimulateSteamCoilComponents</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilName</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-14806"></a>                                     <span class="mf">1.0d0</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-14807"></a>                                     <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-14808"></a>                                     <span class="n">FanOpMode</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-14809"></a>                                     <span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-14810"></a>  <span class="k">ELSE</span>
<a name="ln-14811"></a><span class="k">    </span><span class="n">mdot</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilFluidOutletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-14812"></a>           <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">*</span> <span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-14813"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilFluidInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">mdot</span>
<a name="ln-14814"></a>    <span class="k">CALL </span><span class="n">SimulateSteamCoilComponents</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-14815"></a>                                     <span class="mf">1.0d0</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-14816"></a>                                     <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-14817"></a>                                     <span class="n">FanOpMode</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-14818"></a>                                     <span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-14819"></a>  <span class="k">END IF</span>
<a name="ln-14820"></a><span class="k">  </span><span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilOutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-14821"></a>  <span class="n">Residuum</span>      <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">OutletAirTemp</span>
<a name="ln-14822"></a>
<a name="ln-14823"></a>  <span class="k">RETURN</span>
<a name="ln-14824"></a><span class="k">END FUNCTION </span><span class="n">SteamHeatingCoilResidual</span>
<a name="ln-14825"></a>
<a name="ln-14826"></a><span class="k">SUBROUTINE </span><span class="n">FrostControlSetPointLimit</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">,</span><span class="n">TempSetPoint</span><span class="p">,</span><span class="n">HumRatSetPoint</span><span class="p">,</span><span class="n">BaroPress</span><span class="p">,</span><span class="n">TfrostControl</span><span class="p">,</span><span class="n">ControlMode</span><span class="p">)</span>
<a name="ln-14827"></a>
<a name="ln-14828"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-14829"></a>          <span class="c">!       AUTHOR         Bereket Nigusse, FSEC</span>
<a name="ln-14830"></a>          <span class="c">!       DATE WRITTEN   January 2013</span>
<a name="ln-14831"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-14832"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-14833"></a>          <span class="c">!</span>
<a name="ln-14834"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-14835"></a>          <span class="c">! Controls the forst formation condition based on user specified minimum DX coil outlet</span>
<a name="ln-14836"></a>          <span class="c">! air temperature. Resets the cooling setpoint based on the user specified limiting</span>
<a name="ln-14837"></a>          <span class="c">! temperature for frost control.</span>
<a name="ln-14838"></a>          <span class="c">!</span>
<a name="ln-14839"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-14840"></a>          <span class="c">! Based on FrostControlSetPointLimit by Bereket Nigusse in HVACDXSystem</span>
<a name="ln-14841"></a>          <span class="c">!</span>
<a name="ln-14842"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-14843"></a>          <span class="c">!  na</span>
<a name="ln-14844"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-14845"></a>  <span class="k">USE </span><span class="n">Psychrometrics</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">PsyWFnTdpPb</span>
<a name="ln-14846"></a>          <span class="c">!</span>
<a name="ln-14847"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-14848"></a>          <span class="c">!</span>
<a name="ln-14849"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-14850"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">UnitarySysNum</span>           <span class="c">! dx cooling coil system index</span>
<a name="ln-14851"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">TempSetPoint</span>          <span class="c">! temperature setpoint of the sensor node</span>
<a name="ln-14852"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">HumRatSetPoint</span>        <span class="c">! humidity ratio setpoint of the sensor node</span>
<a name="ln-14853"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">BaroPress</span>             <span class="c">! baromtric pressure, Pa [N/m^2]</span>
<a name="ln-14854"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">TfrostControl</span>         <span class="c">! minimum temperature limit for forst control</span>
<a name="ln-14855"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">ControlMode</span>           <span class="c">! temperature or humidity control mode</span>
<a name="ln-14856"></a>
<a name="ln-14857"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-14858"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span>        <span class="kd">::</span> <span class="n">RunOnSensible</span> <span class="o">=</span> <span class="mi">1</span>     <span class="c">! identifier for temperature (sensible load) control</span>
<a name="ln-14859"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span>        <span class="kd">::</span> <span class="n">RunOnLatent</span> <span class="o">=</span> <span class="mi">2</span>       <span class="c">! identifier for humidity (latent load) control</span>
<a name="ln-14860"></a>
<a name="ln-14861"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-14862"></a>          <span class="c">! na</span>
<a name="ln-14863"></a>          <span class="c">!</span>
<a name="ln-14864"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-14865"></a>          <span class="c">! na</span>
<a name="ln-14866"></a>          <span class="c">!</span>
<a name="ln-14867"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-14868"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">HumRatioSat</span>     <span class="c">! saturation humidity ratio at forst control temperature</span>
<a name="ln-14869"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">AirMassFlow</span>     <span class="c">! air masss flow rate through the DX coil</span>
<a name="ln-14870"></a>  <span class="c">!</span>
<a name="ln-14871"></a>  <span class="n">AirMassFlow</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-14872"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ControlMode</span> <span class="o">==</span> <span class="n">RunOnSensible</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">AirMassFlow</span> <span class="o">&gt;</span> <span class="n">MinAirMassFlow</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-14873"></a>      <span class="n">TempSetPoint</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14874"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">TempSetPoint</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">TfrostControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14875"></a><span class="k">        </span><span class="n">TempSetPoint</span> <span class="o">=</span> <span class="n">TfrostControl</span>
<a name="ln-14876"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FrostControlStatus</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-14877"></a>    <span class="k">END IF</span>
<a name="ln-14878"></a><span class="k">  </span><span class="n">ELSEIF</span><span class="p">(</span><span class="n">ControlMode</span> <span class="o">==</span> <span class="n">RunOnLatent</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">AirMassFlow</span> <span class="o">&gt;</span> <span class="n">MinAirMassFlow</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-14879"></a>         <span class="n">HumRatSetPoint</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">Node</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilInletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14880"></a><span class="k">    </span><span class="n">HumRatioSat</span> <span class="o">=</span> <span class="n">PsyWFnTdpPb</span><span class="p">(</span><span class="n">TfrostControl</span><span class="p">,</span><span class="n">BaroPress</span><span class="p">,</span><span class="s1">&#39;FrostControlSetPointLimit&#39;</span><span class="p">)</span>
<a name="ln-14881"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">HumRatioSat</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">HumRatSetPoint</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14882"></a><span class="k">        </span><span class="n">HumRatSetPoint</span> <span class="o">=</span> <span class="n">HumRatioSat</span>
<a name="ln-14883"></a>        <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FrostControlStatus</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-14884"></a>    <span class="k">END IF</span>
<a name="ln-14885"></a><span class="k">  ELSE</span>
<a name="ln-14886"></a><span class="k">    </span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">FrostControlStatus</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-14887"></a>  <span class="k">END IF</span>
<a name="ln-14888"></a><span class="k">  RETURN</span>
<a name="ln-14889"></a><span class="k">END SUBROUTINE </span><span class="n">FrostControlSetPointLimit</span>
<a name="ln-14890"></a>
<a name="ln-14891"></a><span class="k">SUBROUTINE </span><span class="n">CheckUnitarySysCoilInOASysExists</span><span class="p">(</span><span class="n">UnitarySysName</span><span class="p">)</span>
<a name="ln-14892"></a>
<a name="ln-14893"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-14894"></a>          <span class="c">!       AUTHOR         Chandan Sharma</span>
<a name="ln-14895"></a>          <span class="c">!       DATE WRITTEN   April 2013</span>
<a name="ln-14896"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-14897"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-14898"></a>          <span class="c">!</span>
<a name="ln-14899"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-14900"></a>          <span class="c">! After making sure get input is done, checks if the Coil System DX coil is in the</span>
<a name="ln-14901"></a>          <span class="c">! OA System.  IF exists then the DX cooling coil is 100% DOAS DX coil.</span>
<a name="ln-14902"></a>          <span class="c">!</span>
<a name="ln-14903"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-14904"></a>          <span class="c">! Based on CheckDXCoolingCoilInOASysExists by Bereket Nigusse in HVACDXSystem</span>
<a name="ln-14905"></a>          <span class="c">!</span>
<a name="ln-14906"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-14907"></a>          <span class="c">! na</span>
<a name="ln-14908"></a>          <span class="c">!</span>
<a name="ln-14909"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-14910"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-14911"></a>  <span class="k">USE </span><span class="n">DXCoils</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">SetDXCoilTypeData</span>
<a name="ln-14912"></a>
<a name="ln-14913"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-14914"></a>
<a name="ln-14915"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-14916"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UnitarySysName</span>
<a name="ln-14917"></a>
<a name="ln-14918"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-14919"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;CheckUnitarySysCoilInOASysExists: &#39;</span> <span class="c">! include trailing blank space</span>
<a name="ln-14920"></a>
<a name="ln-14921"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-14922"></a>          <span class="c">! na</span>
<a name="ln-14923"></a>
<a name="ln-14924"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-14925"></a>          <span class="c">! na</span>
<a name="ln-14926"></a>
<a name="ln-14927"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-14928"></a>  <span class="kt">INTEGER</span>                       <span class="kd">::</span> <span class="n">UnitarySysNum</span>
<a name="ln-14929"></a>
<a name="ln-14930"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetInputFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14931"></a><span class="k">    CALL </span><span class="n">GetUnitarySystemInput</span>
<a name="ln-14932"></a>    <span class="n">GetInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-14933"></a>  <span class="k">END IF</span>
<a name="ln-14934"></a>
<a name="ln-14935"></a><span class="k">  </span><span class="n">UnitarySysNum</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-14936"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumUnitarySystem</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14937"></a><span class="k">     </span><span class="n">UnitarySysNum</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">UnitarySysName</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumUnitarySystem</span><span class="p">)</span>
<a name="ln-14938"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">UnitarySysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-14939"></a><span class="k">       IF</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">ISHundredPercentDOASDXCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-14940"></a><span class="k">         CALL </span><span class="n">SetDXCoilTypeData</span><span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilName</span><span class="p">)</span>
<a name="ln-14941"></a>       <span class="k">END IF</span>
<a name="ln-14942"></a><span class="k">     ELSE</span>
<a name="ln-14943"></a><span class="k">       CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoutineName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;System not found = AirloopHVAC:UnitarySystem &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySysName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-14944"></a>     <span class="k">END IF</span>
<a name="ln-14945"></a><span class="k">  ELSE</span>
<a name="ln-14946"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoutineName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;System not found = AirloopHVAC:UnitarySystem &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UnitarySysName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-14947"></a>  <span class="k">END IF</span>
<a name="ln-14948"></a>
<a name="ln-14949"></a>
<a name="ln-14950"></a><span class="k">  RETURN</span>
<a name="ln-14951"></a>
<a name="ln-14952"></a><span class="k">END SUBROUTINE </span><span class="n">CheckUnitarySysCoilInOASysExists</span>
<a name="ln-14953"></a>
<a name="ln-14954"></a><span class="k">SUBROUTINE </span><span class="n">GetUnitarySystemOAHeatCoolCoil</span><span class="p">(</span><span class="n">UnitarySystemName</span><span class="p">,</span> <span class="n">OACoolingCoil</span><span class="p">,</span> <span class="n">OAHeatingCoil</span><span class="p">)</span>
<a name="ln-14955"></a>
<a name="ln-14956"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-14957"></a>          <span class="c">!       AUTHOR         Chandan Sharma</span>
<a name="ln-14958"></a>          <span class="c">!       DATE WRITTEN   April 2013</span>
<a name="ln-14959"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-14960"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-14961"></a>
<a name="ln-14962"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-14963"></a>          <span class="c">! Determined weather Unitary system in OA stream has heating or cooling coils</span>
<a name="ln-14964"></a>
<a name="ln-14965"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-14966"></a>          <span class="c">! na</span>
<a name="ln-14967"></a>
<a name="ln-14968"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-14969"></a>          <span class="c">! na</span>
<a name="ln-14970"></a>
<a name="ln-14971"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-14972"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>   <span class="n">ONLY</span><span class="p">:</span> <span class="n">SameString</span>
<a name="ln-14973"></a>
<a name="ln-14974"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-14975"></a>
<a name="ln-14976"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-14977"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">UnitarySystemName</span>  <span class="c">! Name of Unitary System object</span>
<a name="ln-14978"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">),</span>   <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">OACoolingCoil</span>      <span class="c">! Cooling coil in OA stream</span>
<a name="ln-14979"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">),</span>   <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">OAHeatingCoil</span>      <span class="c">! Heating coil in OA stream</span>
<a name="ln-14980"></a>
<a name="ln-14981"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-14982"></a>          <span class="c">! na</span>
<a name="ln-14983"></a>
<a name="ln-14984"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-14985"></a>          <span class="c">! na</span>
<a name="ln-14986"></a>
<a name="ln-14987"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-14988"></a>          <span class="c">! na</span>
<a name="ln-14989"></a>
<a name="ln-14990"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-14991"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">UnitarySysNum</span>
<a name="ln-14992"></a>
<a name="ln-14993"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetInputFlag</span><span class="p">)</span> <span class="k">THEN</span>             <span class="c">!First time subroutine has been entered</span>
<a name="ln-14994"></a>    <span class="k">CALL </span><span class="n">GetUnitarySystemInput</span>
<a name="ln-14995"></a>    <span class="n">GetInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-14996"></a>  <span class="k">END IF</span>
<a name="ln-14997"></a>
<a name="ln-14998"></a><span class="k">  DO </span><span class="n">UnitarySysNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>  <span class="n">NumUnitarySystem</span>
<a name="ln-14999"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">UnitarySystemName</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-15000"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilExists</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-15001"></a><span class="k">        </span><span class="n">OACoolingCoil</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-15002"></a>      <span class="k">END IF</span>
<a name="ln-15003"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">HeatCoilExists</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-15004"></a>          <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">SuppCoilExists</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-15005"></a><span class="k">        </span><span class="n">OAHeatingCoil</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-15006"></a>      <span class="k">END IF</span>
<a name="ln-15007"></a><span class="k">    END IF</span>
<a name="ln-15008"></a><span class="k">  END DO</span>
<a name="ln-15009"></a>
<a name="ln-15010"></a><span class="k">  RETURN</span>
<a name="ln-15011"></a>
<a name="ln-15012"></a><span class="k">END SUBROUTINE </span><span class="n">GetUnitarySystemOAHeatCoolCoil</span>
<a name="ln-15013"></a>
<a name="ln-15014"></a><span class="k">FUNCTION </span><span class="n">GetUnitarySystemDXCoolingCoilIndex</span><span class="p">(</span><span class="n">UnitarySystemName</span><span class="p">)</span>
<a name="ln-15015"></a>
<a name="ln-15016"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-15017"></a>          <span class="c">!       AUTHOR         Richard Raustad</span>
<a name="ln-15018"></a>          <span class="c">!       DATE WRITTEN   July 2013</span>
<a name="ln-15019"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-15020"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-15021"></a>
<a name="ln-15022"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-15023"></a>          <span class="c">! Find the DX cooling coil in this Unitary System</span>
<a name="ln-15024"></a>
<a name="ln-15025"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-15026"></a>          <span class="c">! na</span>
<a name="ln-15027"></a>
<a name="ln-15028"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-15029"></a>          <span class="c">! na</span>
<a name="ln-15030"></a>
<a name="ln-15031"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-15032"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>   <span class="n">ONLY</span><span class="p">:</span> <span class="n">SameString</span>
<a name="ln-15033"></a>
<a name="ln-15034"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-15035"></a>
<a name="ln-15036"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-15037"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">UnitarySystemName</span>  <span class="c">! Name of Unitary System object</span>
<a name="ln-15038"></a>
<a name="ln-15039"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-15040"></a>          <span class="c">! na</span>
<a name="ln-15041"></a>
<a name="ln-15042"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-15043"></a>          <span class="c">! na</span>
<a name="ln-15044"></a>
<a name="ln-15045"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-15046"></a>          <span class="c">! na</span>
<a name="ln-15047"></a>
<a name="ln-15048"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-15049"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">UnitarySysNum</span>
<a name="ln-15050"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">GetUnitarySystemDXCoolingCoilIndex</span>
<a name="ln-15051"></a>
<a name="ln-15052"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetInputFlag</span><span class="p">)</span> <span class="k">THEN</span>             <span class="c">!First time subroutine has been entered</span>
<a name="ln-15053"></a>    <span class="k">CALL </span><span class="n">GetUnitarySystemInput</span>
<a name="ln-15054"></a>    <span class="n">GetInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-15055"></a>  <span class="k">END IF</span>
<a name="ln-15056"></a>
<a name="ln-15057"></a><span class="k">  </span><span class="n">GetUnitarySystemDXCoolingCoilIndex</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-15058"></a>  <span class="k">DO </span><span class="n">UnitarySysNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>  <span class="n">NumUnitarySystem</span>
<a name="ln-15059"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">UnitarySystemName</span><span class="p">,</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-15060"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolCoilExists</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-15061"></a><span class="k">        </span><span class="n">GetUnitarySystemDXCoolingCoilIndex</span> <span class="o">=</span> <span class="n">UnitarySystem</span><span class="p">(</span><span class="n">UnitarySysNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span>
<a name="ln-15062"></a>      <span class="k">END IF</span>
<a name="ln-15063"></a><span class="k">    END IF</span>
<a name="ln-15064"></a><span class="k">  END DO</span>
<a name="ln-15065"></a>
<a name="ln-15066"></a><span class="k">  RETURN</span>
<a name="ln-15067"></a>
<a name="ln-15068"></a><span class="k">END FUNCTION </span><span class="n">GetUnitarySystemDXCoolingCoilIndex</span>
<a name="ln-15069"></a>
<a name="ln-15070"></a><span class="k">END MODULE </span><span class="n">HVACUnitarySystem</span>
<a name="ln-15071"></a>
<a name="ln-15072"></a><span class="c">! *****************************************************************************</span>
<a name="ln-15073"></a><span class="c">!</span>
<a name="ln-15074"></a><span class="c">!     NOTICE</span>
<a name="ln-15075"></a><span class="c">!</span>
<a name="ln-15076"></a><span class="c">!     Copyright  1996-2013 The Board of Trustees of the University of Illinois</span>
<a name="ln-15077"></a><span class="c">!     and The Regents of the University of CalIFornia through Ernest OrlanDO Lawrence</span>
<a name="ln-15078"></a><span class="c">!     Berkeley National Laboratory.  All rights reserved.</span>
<a name="ln-15079"></a><span class="c">!</span>
<a name="ln-15080"></a><span class="c">!     Portions of the EnergyPlus software package have been developed and copyrighted</span>
<a name="ln-15081"></a><span class="c">!     by other individuals, companies and institutions.  These portions have been</span>
<a name="ln-15082"></a><span class="c">!     incorporated into the EnergyPlus software package under license.   For a complete</span>
<a name="ln-15083"></a><span class="c">!     list of contributors, see &quot;Notice&quot; located in EnergyPlus.f90.</span>
<a name="ln-15084"></a><span class="c">!</span>
<a name="ln-15085"></a><span class="c">!     NOTICE: The U.S. Government is granted for itself and others acting on its</span>
<a name="ln-15086"></a><span class="c">!     behalf a paid-up, nonexclusive, irrevocable, worldwide license in this data to</span>
<a name="ln-15087"></a><span class="c">!     reproduce, prepare derivative works, and perform publicly and display publicly.</span>
<a name="ln-15088"></a><span class="c">!     Beginning five (5) years after permission to assert copyright is granted,</span>
<a name="ln-15089"></a><span class="c">!     subject to two possible five year renewals, the U.S. Government is granted for</span>
<a name="ln-15090"></a><span class="c">!     itself and others acting on its behalf a paid-up, non-exclusive, irrevocable</span>
<a name="ln-15091"></a><span class="c">!     worldwide license in this data to reproduce, prepare derivative works,</span>
<a name="ln-15092"></a><span class="c">!     distribute copies to the public, perform publicly and display publicly, and to</span>
<a name="ln-15093"></a><span class="c">!     permit others to DO so.</span>
<a name="ln-15094"></a><span class="c">!</span>
<a name="ln-15095"></a><span class="c">!     TRADEMARKS: EnergyPlus is a trademark of the US Department of Energy.</span>
<a name="ln-15096"></a><span class="c">!</span>
</pre></div>

    </section>
    </div>
  </div>

  <section class="visible-xs visible-sm hidden-md">
    <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-1">All Source Files</a></h3></div>
  <div id="allfiles-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


  </section>

    <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2017 </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by
            <a href="https://github.com/cmacmackin/ford">FORD</a>

          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> EnergyPlusFortran</p></div>
      </div>
      <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': {
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>
