<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

	 <meta name="description" content="">

    <meta name="author" content="dmey (forked from NREL)" >
    <link rel="icon" href="../favicon.png">

    <title>PlantPipingSystemManager.f90 &ndash; EnergyPlusFortran</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>


    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>


  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">EnergyPlusFortran <small>8.1.0.009</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">

            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
		 aria-expanded="false">Contents <span class="caret"></span></a>
	      <ul class="dropdown-menu">

            <li><a href="../lists/files.html">Source Files</a></li>


            <li><a href="../lists/modules.html">Modules</a></li>


            <li><a href="../lists/procedures.html">Procedures</a></li>


            <li><a href="../lists/types.html">Derived Types</a></li>


            <li><a href="../program/energyplus.html">Program</a></li>

            </ul>
            </li>

<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/energyplus.html">Program</a></li>

          </ul>


        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">


  <div class="row">
    <h1>PlantPipingSystemManager.f90
    <small>Source File</small>

    </h1>

<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">


     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
	  data-placement="bottom" data-html="true"
	  title=" 0.9% of total for source files.">3485 statements</a>
     </li>


    <li><i class="fa fa-code"></i><a href="../src/PlantPipingSystemManager.f90"> Source File</a></li>

  </ul>
  <ol class="breadcrumb in-well text-right">

     <li class="active">PlantPipingSystemManager.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">

<div id="sidebar">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/plantpipingsystemsmanager.html">PlantPipingSystemsManager</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html#src">PlantPipingSystemManager.f90</a>
  </div>
</div>


  <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-0">All Source Files</a></h3></div>
  <div id="allfiles-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


</div>

    </div>
    <div class="col-md-9" id='text'>


    <h3>This File Depends On</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefileplantpipingsystemmanagerf90EfferentGraph" width="641pt" height="730pt"
 viewBox="0.00 0.00 641.00 730.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph" class="graph" transform="scale(.2809 .2809) rotate(0) translate(4 2596.6754)">
<title>sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-2596.6754 2278.0461,-2596.6754 2278.0461,4 -4,4"/>
<!-- sourcefile~plantpipingsystemmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~plantpipingsystemmanager.f90</title>
<polygon fill="none" stroke="#000000" points="2273.8008,-2265.65 2115.7837,-2265.65 2115.7837,-2243.6391 2273.8008,-2243.6391 2273.8008,-2265.65"/>
<text text-anchor="middle" x="2194.7922" y="-2251.4945" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">PlantPipingSystemManager.f90</text>
</g>
<!-- sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~dataloopnode.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node2"><a xlink:href="../sourcefile/dataloopnode.f90.html" xlink:title="DataLoopNode.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="846.1377,-2036.65 745.8318,-2036.65 745.8318,-2014.6391 846.1377,-2014.6391 846.1377,-2036.65"/>
<text text-anchor="middle" x="795.9847" y="-2022.4945" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataLoopNode.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantpipingsystemmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge185" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantpipingsystemmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2035.8962,-2368.6445C2094.4364,-2349.8169 2149.6791,-2300.5664 2176.9872,-2273.3661"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2179.7119,-2275.5875 2184.2339,-2266.0061 2174.7239,-2270.6762 2179.7119,-2275.5875"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M827.676,-2036.6542C1009.2365,-2099.4302 1913.5727,-2407.9861 2035.8962,-2368.6445"/>
</g>
<!-- sourcefile~dataplant.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~dataplant.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node8"><a xlink:href="../sourcefile/dataplant.f90.html" xlink:title="DataPlant.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1956.0678,-1674.65 1880.815,-1674.65 1880.815,-1652.6391 1956.0678,-1652.6391 1956.0678,-1674.65"/>
<text text-anchor="middle" x="1918.4414" y="-1660.4945" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPlant.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge61" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#00ff1e" stroke-dasharray="5,2" d="M1145.9073,-1988.6445C1359.9073,-1976.102 1408.2507,-2051.3992 1622.2083,-2064.6445"/>
<path fill="none" stroke="#00ff1e" stroke-dasharray="5,2" d="M1622.2083,-2064.6445C1812.9119,-2060.9035 1894.8049,-1766.4559 1913.9062,-1684.5675"/>
<polygon fill="#00ff1e" stroke="#00ff1e" points="1917.3521,-1685.1977 1916.1467,-1674.6716 1910.5249,-1683.6519 1917.3521,-1685.1977"/>
</g>
<!-- sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~nodeinputmanager.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node13"><a xlink:href="../sourcefile/nodeinputmanager.f90.html" xlink:title="NodeInputManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1681.5438,-1428.65 1562.8727,-1428.65 1562.8727,-1406.6391 1681.5438,-1406.6391 1681.5438,-1428.65"/>
<text text-anchor="middle" x="1622.2083" y="-1414.4945" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">NodeInputManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge142" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#001dff" stroke-dasharray="5,2" d="M979.6978,-1988.6445C997.8732,-1986.8325 1474.3997,-1795.2821 1526.7905,-1734.6445 1566.491,-1688.695 1605.6637,-1502.6145 1618.13,-1439.0501"/>
<polygon fill="#001dff" stroke="#001dff" points="1621.6145,-1439.4657 1620.081,-1428.9824 1614.7423,-1438.1339 1621.6145,-1439.4657"/>
<path fill="none" stroke="#001dff" stroke-dasharray="5,2" d="M837.1921,-2014.6284C874.1767,-2005.3948 930.1132,-1993.0364 979.6978,-1988.6445"/>
</g>
<!-- sourcefile~plantutilities.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~plantutilities.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node14"><a xlink:href="../sourcefile/plantutilities.f90.html" xlink:title="PlantUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2079.6809,-2265.65 1992.1116,-2265.65 1992.1116,-2243.6391 2079.6809,-2243.6391 2079.6809,-2265.65"/>
<text text-anchor="middle" x="2035.8962" y="-2251.4945" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge155" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#3c00ff" stroke-dasharray="5,2" d="M1622.2083,-2254.6445C1692.2752,-2263.5506 1711.5411,-2266.7464 1781.1273,-2254.6445"/>
<path fill="none" stroke="#3c00ff" stroke-dasharray="5,2" d="M979.6978,-1988.6445C1133.6276,-1975.0105 1468.9092,-2235.159 1622.2083,-2254.6445"/>
<path fill="none" stroke="#3c00ff" stroke-dasharray="5,2" d="M1781.1273,-2254.6445C1841.2533,-2244.1879 1857.7107,-2248.623 1918.4414,-2254.6445"/>
</g>
<!-- sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~branchnodeconnections.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node16"><a xlink:href="../sourcefile/branchnodeconnections.f90.html" xlink:title="BranchNodeConnections.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1052.9524,-1464.65 906.4431,-1464.65 906.4431,-1442.6391 1052.9524,-1442.6391 1052.9524,-1464.65"/>
<text text-anchor="middle" x="979.6978" y="-1450.4945" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">BranchNodeConnections.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge166" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#f000ff" stroke-dasharray="5,2" d="M798.5986,-2014.5906C808.4141,-1972.9836 843.8732,-1821.7986 870.5706,-1696.6445 887.5909,-1616.8554 865.4308,-1587.0968 906.5706,-1516.6445 917.6217,-1497.7194 936.4665,-1481.6887 952.2578,-1470.5343"/>
<polygon fill="#f000ff" stroke="#f000ff" points="954.3309,-1473.3574 960.6477,-1464.8516 950.4053,-1467.5617 954.3309,-1473.3574"/>
</g>
<!-- sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node23" class="node">
<title>sourcefile~branchinputmanager.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node23"><a xlink:href="../sourcefile/branchinputmanager.f90.html" xlink:title="BranchInputManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1844.63,-1694.65 1717.6246,-1694.65 1717.6246,-1672.6391 1844.63,-1672.6391 1844.63,-1694.65"/>
<text text-anchor="middle" x="1781.1273" y="-1680.4945" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">BranchInputManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-1988.6445C1219.5325,-1984.3294 1236.2775,-1970.0191 1307.4386,-1950.6445"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1307.4386,-1950.6445C1446.3015,-1912.8373 1490.5378,-1932.7408 1622.2083,-1874.6445"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-1988.6445C1053.2806,-1982.1271 1072.163,-1992.9667 1145.9073,-1988.6445"/>
</g>
<!-- sourcefile~curvemanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node25" class="node">
<title>sourcefile~curvemanager.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node25"><a xlink:href="../sourcefile/curvemanager.f90.html" xlink:title="CurveManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1029.0877,-1697.65 930.3078,-1697.65 930.3078,-1675.6391 1029.0877,-1675.6391 1029.0877,-1697.65"/>
<text text-anchor="middle" x="979.6978" y="-1683.4945" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CurveManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M802.0972,-2014.3654C828.6323,-1965.401 934.0543,-1770.869 968.6423,-1707.0449"/>
<polygon fill="#ff0000" stroke="#ff0000" points="971.8749,-1708.4256 973.5623,-1697.966 965.7205,-1705.0904 971.8749,-1708.4256"/>
</g>
<!-- sourcefile~dataplantpipingsystems.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~dataplantpipingsystems.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node3"><a xlink:href="../sourcefile/dataplantpipingsystems.f90.html" xlink:title="DataPlantPipingSystems.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="471.6539,-2380.65 326.5138,-2380.65 326.5138,-2358.6391 471.6539,-2358.6391 471.6539,-2380.65"/>
<text text-anchor="middle" x="399.0839" y="-2366.4945" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPlantPipingSystems.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataplantpipingsystems.f90&#45;&gt;sourcefile~plantpipingsystemmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge186" class="edge">
<title>sourcefile~dataplantpipingsystems.f90&#45;&gt;sourcefile~plantpipingsystemmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M459.6115,-2380.7224C466.8328,-2382.265 474.0814,-2383.9173 480.9653,-2385.6445 623.0564,-2421.2972 649.4891,-2482.6445 795.9847,-2482.6445 795.9847,-2482.6445 795.9847,-2482.6445 1145.9073,-2482.6445 1248.469,-2482.6445 1274.4264,-2486.6596 1375.8875,-2501.6445 1417.9062,-2507.8503 1426.9543,-2524.4054 1469.339,-2521.6445"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1469.339,-2521.6445C1671.2781,-2506.4018 1718.2677,-2475.3405 1918.4414,-2444.6445"/>
</g>
<!-- sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~fluidproperties.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node4"><a xlink:href="../sourcefile/fluidproperties.f90.html" xlink:title="FluidProperties.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1029.825,-1656.65 929.5705,-1656.65 929.5705,-1634.6391 1029.825,-1634.6391 1029.825,-1656.65"/>
<text text-anchor="middle" x="979.6978" y="-1642.4945" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">FluidProperties.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantpipingsystemmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge187" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantpipingsystemmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1469.339,-1570.6445C1519.1165,-1553.2884 1866.556,-1408.3203 1918.4414,-1417.6445"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge144" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#001dff" stroke-dasharray="5,2" d="M1469.339,-1570.6445C1496.2701,-1564.2821 1505.0116,-1563.7162 1526.7905,-1546.6445 1565.8176,-1516.0527 1596.7058,-1465.6309 1611.9034,-1437.7489"/>
<polygon fill="#001dff" stroke="#001dff" points="1615.0062,-1439.3686 1616.6123,-1428.8962 1608.8261,-1436.0813 1615.0062,-1439.3686"/>
<path fill="none" stroke="#001dff" stroke-dasharray="5,2" d="M1029.9655,-1641.7702C1075.3278,-1637.9645 1143.8207,-1631.4494 1202.9897,-1622.6445 1322.2885,-1604.8919 1351.9579,-1598.3757 1469.339,-1570.6445"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge156" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#3c00ff" stroke-dasharray="5,2" d="M1030.008,-1654.7752C1038.1294,-1657.6982 1046.0749,-1661.5553 1052.825,-1666.6445 1177.5199,-1760.6583 1120.3473,-1863.0995 1238.9897,-1964.6445 1363.7118,-2071.3931 1755.7678,-2232.5508 1918.4414,-2254.6445"/>
</g>
<!-- sourcefile~general.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~general.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node5"><a xlink:href="../sourcefile/general.f90.html" xlink:title="General.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="829.3535,-1198.65 762.616,-1198.65 762.616,-1176.6391 829.3535,-1176.6391 829.3535,-1198.65"/>
<text text-anchor="middle" x="795.9847" y="-1184.4945" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">General.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~plantpipingsystemmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge188" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~plantpipingsystemmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-1036.6445C1211.1838,-1006.7611 1235.679,-1034.4984 1307.4386,-1036.6445"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ffb300" stroke-dasharray="5,2" d="M829.3428,-1198.7138C844.4637,-1205.4992 861.054,-1215.7952 870.5706,-1230.6445 917.5327,-1303.9226 852.7474,-1552.2473 906.5706,-1620.6445 910.3445,-1625.4404 915.0859,-1629.3212 920.3317,-1632.4608"/>
<polygon fill="#ffb300" stroke="#ffb300" points="919.0455,-1635.7309 929.5547,-1637.0754 922.1777,-1629.4708 919.0455,-1635.7309"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge63" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#00ff1e" stroke-dasharray="5,2" d="M979.6978,-1110.6445C1281.6475,-1015.5524 1411.3344,-1066.8459 1681.626,-1231.6445 1839.3249,-1327.7947 1899.4818,-1569.1278 1914.4454,-1642.2902"/>
<polygon fill="#00ff1e" stroke="#00ff1e" points="1911.098,-1643.4067 1916.4669,-1652.5404 1917.9658,-1642.0521 1911.098,-1643.4067"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge145" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#001dff" stroke-dasharray="5,2" d="M1307.4386,-1302.6445C1388.8631,-1336.0329 1382.6413,-1401.5365 1469.339,-1416.6445"/>
<path fill="none" stroke="#001dff" stroke-dasharray="5,2" d="M1469.339,-1416.6445C1496.2299,-1421.3306 1526.1874,-1422.4128 1552.4073,-1422.0305"/>
<polygon fill="#001dff" stroke="#001dff" points="1552.7147,-1425.5247 1562.6354,-1421.8059 1552.5609,-1418.5264 1552.7147,-1425.5247"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge157" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#3c00ff" stroke-dasharray="5,2" d="M822.3678,-1198.7064C837.7432,-1206.1001 856.7612,-1216.975 870.5706,-1230.6445 892.9436,-1252.7909 887.1043,-1266.9043 906.5706,-1291.6445 962.5938,-1362.8461 990.8984,-1367.5131 1052.825,-1433.6445 1063.3452,-1444.8791 1400.8004,-1844.969 1411.8875,-1855.6445 1413.5003,-1857.1975 1916.2134,-2254.4236 1918.4414,-2254.6445"/>
<path fill="none" stroke="#3c00ff" stroke-dasharray="5,2" d="M1918.4414,-2254.6445C1939.1561,-2255.866 1961.9616,-2256.1164 1981.9225,-2255.9747"/>
<polygon fill="#3c00ff" stroke="#3c00ff" points="1982.1127,-2259.473 1992.0753,-2255.8679 1982.039,-2252.4734 1982.1127,-2259.473"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge167" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#f000ff" stroke-dasharray="5,2" d="M826.2479,-1198.711C841.5292,-1205.7139 859.1918,-1216.2045 870.5706,-1230.6445 905.561,-1275.0486 881.6345,-1301.9075 906.5706,-1352.6445 921.7921,-1383.6157 946.412,-1415.1784 962.8234,-1434.5869"/>
<polygon fill="#f000ff" stroke="#f000ff" points="960.3381,-1437.0648 969.5128,-1442.3634 965.6449,-1432.4998 960.3381,-1437.0648"/>
</g>
<!-- sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~dataenvironment.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node18"><a xlink:href="../sourcefile/dataenvironment.f90.html" xlink:title="DataEnvironment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1034.8358,-930.65 924.5597,-930.65 924.5597,-908.6391 1034.8358,-908.6391 1034.8358,-930.65"/>
<text text-anchor="middle" x="979.6978" y="-916.4945" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEnvironment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge181" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#ff005a" stroke-dasharray="5,2" d="M817.476,-1176.6307C834.607,-1166.6997 857.7744,-1150.468 870.5706,-1129.6445 914.426,-1058.2779 851.5401,-1007.7963 906.5706,-944.6445 909.5772,-941.1942 913.0808,-938.2195 916.8956,-935.655"/>
<polygon fill="#ff005a" stroke="#ff005a" points="918.705,-938.6525 925.6719,-930.6704 915.2479,-932.5657 918.705,-938.6525"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1622.2083,-1378.6445C1643.9906,-1395.7972 1661.7748,-1378.2896 1681.626,-1397.6445 1701.5524,-1417.0729 1756.5909,-1600.0349 1775.0225,-1662.705"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1771.6688,-1663.7068 1777.84,-1672.3189 1778.3863,-1661.7381 1771.6688,-1663.7068"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1307.4386,-1302.6445C1440.5962,-1357.2461 1509.1391,-1289.6072 1622.2083,-1378.6445"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M829.4759,-1190.4417C913.4021,-1198.4358 1138.1033,-1225.9594 1307.4386,-1302.6445"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M829.4042,-1198.6746C844.5397,-1205.4507 861.1244,-1215.7503 870.5706,-1230.6445 922.5205,-1312.557 845.0634,-1590.6424 906.5706,-1665.6445 910.4876,-1670.421 915.4139,-1674.1531 920.8499,-1677.0631"/>
<polygon fill="#ff0000" stroke="#ff0000" points="919.8261,-1680.4349 930.3915,-1681.2234 922.6239,-1674.0183 919.8261,-1680.4349"/>
</g>
<!-- sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node29" class="node">
<title>sourcefile~schedulemanager.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node29"><a xlink:href="../sourcefile/schedulemanager.f90.html" xlink:title="ScheduleManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1203.0723,-818.65 1088.7424,-818.65 1088.7424,-796.6391 1203.0723,-796.6391 1203.0723,-818.65"/>
<text text-anchor="middle" x="1145.9073" y="-804.4945" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ScheduleManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge74" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M818.0268,-1176.5533C835.2416,-1166.6767 858.2443,-1150.5594 870.5706,-1129.6445 923.1043,-1040.5065 854.0877,-988.8126 906.5706,-899.6445 927.473,-864.1314 942.9706,-861.3316 979.6978,-842.6445"/>
</g>
<!-- sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node30" class="node">
<title>sourcefile~outputprocessor.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node30"><a xlink:href="../sourcefile/outputprocessor.f90.html" xlink:title="OutputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1523.0647,-895.65 1415.6133,-895.65 1415.6133,-873.6391 1523.0647,-873.6391 1523.0647,-895.65"/>
<text text-anchor="middle" x="1469.339" y="-881.4945" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge120" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M829.6575,-1179.0001C842.8325,-1174.948 857.8128,-1169.486 870.5706,-1162.6445 888.4339,-1153.0652 888.6771,-1144.1676 906.5706,-1134.6445 936.7669,-1118.5738 947.0709,-1120.9196 979.6978,-1110.6445"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1145.9073,-1036.6445C1170.9309,-1025.1888 1180.9512,-1029.1283 1202.9897,-1012.6445 1261.788,-968.6663 1234.0402,-886.6424 1307.4386,-884.6445"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M979.6978,-1110.6445C1012.3246,-1100.3694 1022.3476,-1102.1759 1052.825,-1086.6445 1070.4098,-1077.6832 1071.6168,-1070.3095 1088.825,-1060.6445 1112.8204,-1047.1674 1120.8838,-1048.1003 1145.9073,-1036.6445"/>
</g>
<!-- sourcefile~psychroutines.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node32" class="node">
<title>sourcefile~psychroutines.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node32"><a xlink:href="../sourcefile/psychroutines.f90.html" xlink:title="PsychRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1195.4562,-1466.65 1096.3585,-1466.65 1096.3585,-1444.6391 1195.4562,-1444.6391 1195.4562,-1466.65"/>
<text text-anchor="middle" x="1145.9073" y="-1452.4945" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PsychRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge136" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M829.4937,-1198.2824C882.6473,-1216.5988 986.9963,-1258.6105 1052.825,-1324.6445 1076.9677,-1348.8626 1069.1922,-1364.6456 1088.825,-1392.6445 1100.0857,-1408.7038 1115.0373,-1425.0668 1126.8136,-1437.0906"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1124.483,-1439.7101 1134.023,-1444.3186 1129.4391,-1434.7668 1124.483,-1439.7101"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node35" class="node">
<title>sourcefile~sqlitefortranroutines.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node35"><a xlink:href="../sourcefile/sqlitefortranroutines.f90.html" xlink:title="SQLiteFortranRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1375.8363,-512.65 1239.0409,-512.65 1239.0409,-490.6391 1375.8363,-490.6391 1375.8363,-512.65"/>
<text text-anchor="middle" x="1307.4386" y="-498.4945" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SQLiteFortranRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge88" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M811.126,-1176.4382C826.3987,-1165.0033 850.5216,-1146.5813 870.5706,-1129.6445 887.1513,-1115.6377 890.1853,-1110.8795 906.5706,-1096.6445 985.7665,-1027.8422 1005.86,-1010.8518 1088.825,-946.6445 1138.4357,-908.2504 1166.9736,-915.0076 1202.9897,-863.6445 1281.312,-751.948 1301.3422,-581.9839 1306.0763,-522.8251"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1309.5697,-523.0427 1306.8125,-512.8129 1302.5885,-522.5293 1309.5697,-523.0427"/>
</g>
<!-- sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node38" class="node">
<title>sourcefile~dataheatbalance.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node38"><a xlink:href="../sourcefile/dataheatbalance.f90.html" xlink:title="DataHeatBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1201.7241,-360.65 1090.0905,-360.65 1090.0905,-338.6391 1201.7241,-338.6391 1201.7241,-360.65"/>
<text text-anchor="middle" x="1145.9073" y="-346.4945" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge107" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M818.8104,-1176.5969C836.2312,-1166.8418 859.1252,-1150.868 870.5706,-1129.6445 918.5034,-1040.7614 871.416,-771.312 906.5706,-676.6445 956.5783,-541.9792 1079.0737,-414.1039 1126.6095,-367.8582"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1129.3028,-370.1237 1134.0784,-360.6661 1124.4473,-365.0813 1129.3028,-370.1237"/>
</g>
<!-- sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~datahvacglobals.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node6"><a xlink:href="../sourcefile/datahvacglobals.f90.html" xlink:title="DataHVACGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="658.8752,-968.65 543.4891,-968.65 543.4891,-946.6391 658.8752,-946.6391 658.8752,-968.65"/>
<text text-anchor="middle" x="601.1821" y="-954.4945" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHVACGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~plantpipingsystemmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge189" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~plantpipingsystemmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M646.0658,-946.5595C658.9975,-942.7698 672.9649,-938.0893 685.3989,-932.6445 1012.5433,-789.3919 1071.4268,-708.3221 1375.8875,-521.6445 1417.762,-495.9695 1436.8771,-425.7812 1469.339,-462.6445"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#f0ff00" stroke-dasharray="5,2" d="M612.8084,-968.7246C630.6459,-986.2862 664.8521,-1022.2659 685.3989,-1058.6445 709.4536,-1101.234 686.6426,-1128.2281 721.3989,-1162.6445 729.8803,-1171.043 741.2639,-1176.6208 752.5795,-1180.3251"/>
<polygon fill="#f0ff00" stroke="#f0ff00" points="751.8556,-1183.7578 762.4314,-1183.1218 753.7673,-1177.0239 751.8556,-1183.7578"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M605.7654,-969.0189C618.465,-1000.5476 655.165,-1091.7402 685.3989,-1167.6445 701.4936,-1208.0514 687.1259,-1231.8656 721.3989,-1258.6445 761.1822,-1289.7288 1581.2558,-1349.1176 1622.2083,-1378.6445"/>
</g>
<!-- sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~datasurfaces.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node7"><a xlink:href="../sourcefile/datasurfaces.f90.html" xlink:title="DataSurfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="647.8111,-358.65 554.5531,-358.65 554.5531,-336.6391 647.8111,-336.6391 647.8111,-358.65"/>
<text text-anchor="middle" x="601.1821" y="-344.4945" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSurfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~plantpipingsystemmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge190" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~plantpipingsystemmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9847,-272.6445C1104.2245,-231.6472 1260.2624,-232.4718 1469.339,-462.6445"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M621.4169,-336.5192C655.9487,-318.3107 729.0308,-283.1207 795.9847,-272.6445"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#f0ff00" stroke-dasharray="5,2" d="M608.3037,-358.6601C625.3177,-385.6448 668.1896,-457.7411 685.3989,-524.6445 718.9505,-655.0807 658.6518,-1010.472 721.3989,-1129.6445 730.7259,-1147.3588 748.112,-1161.3653 763.7531,-1171.1731"/>
<polygon fill="#f0ff00" stroke="#f0ff00" points="762.2979,-1174.3789 772.6865,-1176.4589 765.8625,-1168.3544 762.2979,-1174.3789"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node31" class="node">
<title>sourcefile~datacontaminantbalance.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node31"><a xlink:href="../sourcefile/datacontaminantbalance.f90.html" xlink:title="DataContaminantBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="870.6565,-1426.65 721.313,-1426.65 721.313,-1404.6391 870.6565,-1404.6391 870.6565,-1426.65"/>
<text text-anchor="middle" x="795.9847" y="-1412.4945" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataContaminantBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge134" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M608.6366,-359.0421C625.991,-386.2915 668.8705,-457.9202 685.3989,-524.6445 708.555,-618.1245 663.5416,-1313.6559 721.3989,-1390.6445 723.7526,-1393.7765 726.5155,-1396.5205 729.5661,-1398.9242"/>
<polygon fill="#00ffff" stroke="#00ffff" points="727.9321,-1402.0355 738.2305,-1404.5244 731.732,-1396.1566 727.9321,-1402.0355"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge89" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1145.9073,-576.6445C1192.0335,-567.8311 1196.1404,-545.86 1238.9897,-526.6445 1247.2092,-522.9586 1256.1516,-519.389 1264.779,-516.1563"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1266.1421,-519.3845 1274.3303,-512.6612 1263.7365,-512.8108 1266.1421,-519.3845"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M639.2016,-358.7249C678.1627,-369.2553 740.6955,-383.8842 795.9847,-386.6445"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M795.9847,-386.6445C853.8908,-389.5356 1012.7263,-460.2688 1052.825,-486.6445 1100.9021,-518.2683 1089.3845,-587.4445 1145.9073,-576.6445"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge108" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M795.9847,-272.6445C878.6355,-261.6516 898.2785,-292.675 979.6978,-310.6445"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~plantpipingsystemmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge191" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~plantpipingsystemmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1918.6989,-1652.3687C1920.4334,-1600.3643 1933.7778,-1387.4637 2035.8962,-1417.6445"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge158" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#3c00ff" stroke-dasharray="5,2" d="M1920.6313,-1674.6635C1934.7083,-1745.4951 2012.4857,-2136.8493 2031.6353,-2233.2046"/>
<polygon fill="#3c00ff" stroke="#3c00ff" points="2028.2444,-2234.0984 2033.6266,-2243.2243 2035.1101,-2232.7338 2028.2444,-2234.0984"/>
</g>
<!-- sourcefile~dataheatbalsurface.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~dataheatbalsurface.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node9"><a xlink:href="../sourcefile/dataheatbalsurface.f90.html" xlink:title="DataHeatBalSurface.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1370.1727,-2532.65 1244.7045,-2532.65 1244.7045,-2510.6391 1370.1727,-2510.6391 1370.1727,-2532.65"/>
<text text-anchor="middle" x="1307.4386" y="-2518.4945" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalSurface.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~plantpipingsystemmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge192" class="edge">
<title>sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~plantpipingsystemmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1370.1601,-2523.5406C1400.1981,-2523.9642 1436.6628,-2523.773 1469.339,-2521.6445"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~dataprecisionglobals.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node10"><a xlink:href="../sourcefile/dataprecisionglobals.f90.html" xlink:title="DataPrecisionGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="130.719,-681.65 -.2403,-681.65 -.2403,-659.6391 130.719,-659.6391 130.719,-681.65"/>
<text text-anchor="middle" x="65.2394" y="-667.4945" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPrecisionGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantpipingsystemmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge193" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantpipingsystemmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-2560.6445C1247.9957,-2550.803 1274.4264,-2556.6295 1375.8875,-2541.6445 1417.9062,-2535.4387 1426.9849,-2524.8415 1469.339,-2521.6445"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataloopnode.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-2064.6445C294.2808,-2112.0295 315.2428,-2127.3094 399.0839,-2140.6445"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-2140.6445C489.3447,-2155.0008 510.3854,-2113.0891 601.1821,-2102.6445"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataplantpipingsystems.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataplantpipingsystems.f90</title>
<path fill="none" stroke="#ff5900" stroke-dasharray="5,2" d="M223.8406,-2064.6445C332.2949,-2138.4404 223.2685,-2253.077 317.2024,-2344.6445 320.8992,-2348.2483 325.1003,-2351.3343 329.6007,-2353.9768"/>
<polygon fill="#ff5900" stroke="#ff5900" points="328.0692,-2357.1245 338.5702,-2358.5313 331.2385,-2350.883 328.0692,-2357.1245"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ffb300" stroke-dasharray="5,2" d="M399.0839,-1950.6445C457.9054,-1920.8969 461.9776,-1896.9935 516.9653,-1860.6445 604.113,-1803.0366 625.7453,-1786.642 721.3989,-1744.6445 753.2841,-1730.6451 762.8968,-1731.4998 795.9847,-1720.6445"/>
<path fill="none" stroke="#ffb300" stroke-dasharray="5,2" d="M223.8406,-2064.6445C300.9359,-2116.5063 315.7755,-1991.7911 399.0839,-1950.6445"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#f0ff00" stroke-dasharray="5,2" d="M223.8406,-879.6445C314.471,-927.9901 609.07,-835.9055 685.3989,-904.6445 760.6527,-972.4153 669.8316,-1042.4848 721.3989,-1129.6445 731.7325,-1147.1105 749.4981,-1161.241 765.0988,-1171.1806"/>
<polygon fill="#f0ff00" stroke="#f0ff00" points="763.5937,-1174.3606 773.9616,-1176.5421 767.217,-1168.3713 763.5937,-1174.3606"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#96ff00" stroke-dasharray="5,2" d="M223.8406,-879.6445C245.4949,-891.1958 294.5571,-929.1823 317.2024,-938.6445 351.6729,-953.0478 362.0718,-952.5674 399.0839,-957.6445"/>
<path fill="none" stroke="#96ff00" stroke-dasharray="5,2" d="M399.0839,-957.6445C443.5324,-963.7418 493.9992,-963.748 533.3827,-962.2268"/>
<polygon fill="#96ff00" stroke="#96ff00" points="533.5631,-965.7224 543.4043,-961.7979 533.2637,-958.7288 533.5631,-965.7224"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#3cff00" stroke-dasharray="5,2" d="M399.0839,-384.6445C405.0593,-380.4187 486.4595,-366.4004 544.1046,-356.8846"/>
<polygon fill="#3cff00" stroke="#3cff00" points="544.9102,-360.2992 554.2095,-355.2224 543.7739,-353.3921 544.9102,-360.2992"/>
<path fill="none" stroke="#3cff00" stroke-dasharray="5,2" d="M223.8406,-442.6445C263.9082,-422.2291 274.4024,-417.442 317.2024,-403.6445 352.7591,-392.1821 368.5818,-406.2152 399.0839,-384.6445"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge64" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#00ff1e" stroke-dasharray="5,2" d="M399.0839,-2330.6445C413.2142,-2339.0397 963.2625,-2444.8154 979.6978,-2444.6445"/>
<path fill="none" stroke="#00ff1e" stroke-dasharray="5,2" d="M979.6978,-2444.6445C1192.7291,-2439.634 1715.8138,-2200.392 1844.6287,-2030.6445 1886.7757,-1975.1048 1910.1231,-1754.8716 1916.578,-1685.0193"/>
<polygon fill="#00ff1e" stroke="#00ff1e" points="1920.0867,-1685.0798 1917.4993,-1674.8058 1913.115,-1684.4509 1920.0867,-1685.0798"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalsurface.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge69" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalsurface.f90</title>
<path fill="none" stroke="#00ff78" stroke-dasharray="5,2" d="M1145.9073,-2560.6445C1188.219,-2558.7379 1235.1258,-2546.1915 1267.4415,-2535.836"/>
<polygon fill="#00ff78" stroke="#00ff78" points="1268.5699,-2539.1494 1276.9808,-2532.7067 1266.388,-2532.4981 1268.5699,-2539.1494"/>
<path fill="none" stroke="#00ff78" stroke-dasharray="5,2" d="M223.8406,-2064.6445C348.5382,-2148.5282 222.7745,-2272.7286 317.2024,-2389.6445 553.4964,-2682.2122 770.2159,-2577.5743 1145.9073,-2560.6445"/>
</g>
<!-- sourcefile~dataglobals.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~dataglobals.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node11"><a xlink:href="../sourcefile/dataglobals.f90.html" xlink:title="DataGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="267.6355,-948.65 180.0456,-948.65 180.0456,-926.6391 267.6355,-926.6391 267.6355,-948.65"/>
<text text-anchor="middle" x="223.8406" y="-934.4945" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge70" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90</title>
<path fill="none" stroke="#00d1ff" stroke-dasharray="5,2" d="M68.2146,-681.8881C77.7764,-716.4516 110.411,-823.0656 166.4788,-893.6445 174.7736,-904.0862 186.0641,-913.4398 196.4347,-920.8099"/>
<polygon fill="#00d1ff" stroke="#00d1ff" points="194.6034,-923.7969 204.8438,-926.5145 198.5333,-918.0041 194.6034,-923.7969"/>
</g>
<!-- sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~dataipshortcuts.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node12"><a xlink:href="../sourcefile/dataipshortcuts.f90.html" xlink:title="DataIPShortCuts.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="453.3838,-929.65 344.7839,-929.65 344.7839,-907.6391 453.3838,-907.6391 453.3838,-929.65"/>
<text text-anchor="middle" x="399.0839" y="-915.4945" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataIPShortCuts.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge72" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#0078ff" stroke-dasharray="5,2" d="M223.8406,-879.6445C258.0061,-897.8697 300.283,-907.5906 334.7519,-912.7692"/>
<polygon fill="#0078ff" stroke="#0078ff" points="334.3252,-916.2436 344.7159,-914.1738 335.3024,-909.3121 334.3252,-916.2436"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge149" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#001dff" stroke-dasharray="5,2" d="M223.8406,-2064.6445C287.8564,-2109.0088 321.9325,-2075.3163 399.0839,-2064.6445"/>
<path fill="none" stroke="#001dff" stroke-dasharray="5,2" d="M399.0839,-2064.6445C457.1189,-2056.617 462.8743,-2028.1538 516.9653,-2005.6445 670.0576,-1941.9374 716.2298,-1947.2644 870.5706,-1886.6445 1021.4377,-1827.389 1055.7523,-1804.4179 1202.9897,-1736.6445 1347.404,-1670.1707 1409.9589,-1692.4621 1526.7905,-1584.6445 1572.6023,-1542.3674 1602.3412,-1472.9402 1615.0866,-1438.4444"/>
<polygon fill="#001dff" stroke="#001dff" points="1618.4178,-1439.5235 1618.4955,-1428.9289 1611.8279,-1437.1626 1618.4178,-1439.5235"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge160" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#3c00ff" stroke-dasharray="5,2" d="M979.6978,-2444.6445C1125.2386,-2450.5979 1161.776,-2444.6445 1307.4386,-2444.6445 1307.4386,-2444.6445 1307.4386,-2444.6445 1469.339,-2444.6445 1687.1657,-2444.6445 1928.7962,-2316.834 2008.6546,-2270.8669"/>
<polygon fill="#3c00ff" stroke="#3c00ff" points="2010.6913,-2273.7315 2017.579,-2265.681 2007.1743,-2267.6791 2010.6913,-2273.7315"/>
</g>
<!-- sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~datainterfaces.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node15"><a xlink:href="../sourcefile/datainterfaces.f90.html" xlink:title="DataInterfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="447.8836,-1658.65 350.2841,-1658.65 350.2841,-1636.6391 447.8836,-1636.6391 447.8836,-1658.65"/>
<text text-anchor="middle" x="399.0839" y="-1644.4945" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataInterfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge164" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90</title>
<path fill="none" stroke="#9500ff" stroke-dasharray="5,2" d="M223.8406,-2064.6445C332.2949,-2138.4404 262.4845,-1903.8676 317.2024,-1784.6445 337.2755,-1740.908 367.7978,-1693.4616 385.3534,-1667.468"/>
<polygon fill="#9500ff" stroke="#9500ff" points="388.4481,-1669.1422 391.1913,-1658.9086 382.6651,-1665.1979 388.4481,-1669.1422"/>
</g>
<!-- sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~inputprocessor.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node17"><a xlink:href="../sourcefile/inputprocessor.f90.html" xlink:title="InputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="650.7412,-1198.65 551.623,-1198.65 551.623,-1176.6391 650.7412,-1176.6391 650.7412,-1198.65"/>
<text text-anchor="middle" x="601.1821" y="-1184.4945" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">InputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge174" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00b4" stroke-dasharray="5,2" d="M223.8406,-2064.6445C434.6271,-2208.0706 169.4322,-1706.4087 317.2024,-1498.6445 365.2146,-1431.1396 422.4344,-1468.2638 480.9653,-1409.6445 541.7759,-1348.7422 580.0271,-1250.6576 594.5494,-1208.2613"/>
<polygon fill="#ff00b4" stroke="#ff00b4" points="597.8816,-1209.3327 597.7296,-1198.739 591.242,-1207.1153 597.8816,-1209.3327"/>
<path fill="none" stroke="#ff00b4" stroke-dasharray="5,2" d="M65.5135,-681.9578C68.7385,-809.9479 101.5685,-1982.3925 223.8406,-2064.6445"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge184" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#ff005a" stroke-dasharray="5,2" d="M69.6215,-681.6675C84.6501,-717.8065 137.964,-833.0484 223.8406,-879.6445"/>
<path fill="none" stroke="#ff005a" stroke-dasharray="5,2" d="M223.8406,-879.6445C263.5183,-901.1734 273.2479,-849.9313 317.2024,-839.6445 476.611,-802.3376 522.3191,-814.2266 685.3989,-828.6445 768.6693,-836.0065 791.5523,-834.3631 870.5706,-861.6445 900.738,-872.06 932.6916,-889.9538 954.1704,-903.1187"/>
<polygon fill="#ff005a" stroke="#ff005a" points="952.3609,-906.1151 962.6985,-908.4358 956.0644,-900.175 952.3609,-906.1151"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~dataruntimelanguage.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node19"><a xlink:href="../sourcefile/dataruntimelanguage.f90.html" xlink:title="DataRuntimeLanguage.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="669.6908,-1542.65 532.6734,-1542.65 532.6734,-1520.6391 669.6908,-1520.6391 669.6908,-1542.65"/>
<text text-anchor="middle" x="601.1821" y="-1528.4945" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRuntimeLanguage.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1608.6445C444.3515,-1570.8193 461.2082,-1566.9072 516.9653,-1547.6445 519.2204,-1546.8655 521.5233,-1546.1212 523.8592,-1545.4105"/>
<polygon fill="#ff0000" stroke="#ff0000" points="524.9276,-1548.746 533.61,-1542.6742 523.0362,-1542.0063 524.9276,-1548.746"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-2064.6445C388.63,-2175.4979 178.0035,-1769.3051 317.2024,-1627.6445 343.3864,-1600.9975 370.416,-1632.5991 399.0839,-1608.6445"/>
</g>
<!-- sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node21" class="node">
<title>sourcefile~datavectortypes.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node21"><a xlink:href="../sourcefile/datavectortypes.f90.html" xlink:title="DataVectorTypes.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="278.8255,-318.65 168.8556,-318.65 168.8556,-296.6391 278.8255,-296.6391 278.8255,-318.65"/>
<text text-anchor="middle" x="223.8406" y="-304.4945" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataVectorTypes.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M69.6987,-659.47C83.5332,-624.9178 127.158,-516.8243 166.4788,-428.6445 182.3849,-392.9737 202.1179,-352.0105 213.8048,-328.0633"/>
<polygon fill="#ff0000" stroke="#ff0000" points="217.0338,-329.4276 218.2863,-318.907 210.7464,-326.3503 217.0338,-329.4276"/>
</g>
<!-- sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node22" class="node">
<title>sourcefile~databsdfwindow.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node22"><a xlink:href="../sourcefile/databsdfwindow.f90.html" xlink:title="DataBSDFWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="457.5516,-356.65 340.6161,-356.65 340.6161,-334.6391 457.5516,-334.6391 457.5516,-356.65"/>
<text text-anchor="middle" x="399.0839" y="-342.4945" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBSDFWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M68.7585,-659.4202C81.7031,-620.3386 130.8259,-490.0378 223.8406,-442.6445"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-442.6445C270.5294,-418.8555 270.6425,-394.6849 317.2024,-370.6445 325.2523,-366.4881 334.1109,-362.8936 342.9365,-359.8292"/>
<polygon fill="#00ffff" stroke="#00ffff" points="344.0464,-363.1488 352.4606,-356.7105 341.868,-356.4963 344.0464,-363.1488"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge52" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-2330.6445C478.6226,-2373.4921 1119.0745,-2242.1193 1202.9897,-2208.6445 1440.6674,-2113.8322 1513.5355,-2081.584 1681.626,-1888.6445 1731.6155,-1831.2651 1762.6604,-1744.3684 1775.0057,-1704.7123"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1778.3815,-1705.6404 1777.93,-1695.0552 1771.682,-1703.6117 1778.3815,-1705.6404"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-2064.6445C318.593,-2130.3099 232.3708,-2228.5833 317.2024,-2306.6445 345.1083,-2332.3233 366.4811,-2311.2745 399.0839,-2330.6445"/>
</g>
<!-- sourcefile~datasizing.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node24" class="node">
<title>sourcefile~datasizing.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node24"><a xlink:href="../sourcefile/datasizing.f90.html" xlink:title="DataSizing.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="439.3754,-2190.65 358.7923,-2190.65 358.7923,-2168.6391 439.3754,-2168.6391 439.3754,-2190.65"/>
<text text-anchor="middle" x="399.0839" y="-2176.4945" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSizing.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge60" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-2064.6445C271.4907,-2097.0672 267.5243,-2125.4239 317.2024,-2154.6445 326.9131,-2160.3564 338.0515,-2164.8774 348.921,-2168.4122"/>
<polygon fill="#00ffff" stroke="#00ffff" points="348.1941,-2171.8487 358.7789,-2171.387 350.2164,-2165.1472 348.1941,-2171.8487"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1950.6445C523.5769,-1889.1566 562.1234,-1889.5382 685.3989,-1825.6445 736.4194,-1799.2007 742.7697,-1780.3362 795.9847,-1758.6445"/>
</g>
<!-- sourcefile~dataerrortracking.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node26" class="node">
<title>sourcefile~dataerrortracking.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node26"><a xlink:href="../sourcefile/dataerrortracking.f90.html" xlink:title="DataErrorTracking.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1526.7421,-1846.65 1411.9359,-1846.65 1411.9359,-1824.6391 1526.7421,-1824.6391 1526.7421,-1846.65"/>
<text text-anchor="middle" x="1469.339" y="-1832.4945" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataErrorTracking.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataerrortracking.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataerrortracking.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M399.0839,-2064.6445C501.9874,-2055.0542 1202.9745,-1896.37 1411.159,-1848.9337"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1412.014,-1852.3287 1420.9861,-1846.6938 1410.4583,-1845.5037 1412.014,-1852.3287"/>
</g>
<!-- sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node27" class="node">
<title>sourcefile~databranchairloopplant.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node27"><a xlink:href="../sourcefile/databranchairloopplant.f90.html" xlink:title="DataBranchAirLoopPlant.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="868.5702,-2133.65 723.3993,-2133.65 723.3993,-2111.6391 868.5702,-2111.6391 868.5702,-2133.65"/>
<text text-anchor="middle" x="795.9847" y="-2119.4945" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBranchAirLoopPlant.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M399.0839,-2140.6445C487.7903,-2154.7536 511.3612,-2140.3526 601.1821,-2140.6445"/>
</g>
<!-- sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node28" class="node">
<title>sourcefile~datasystemvariables.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node28"><a xlink:href="../sourcefile/datasystemvariables.f90.html" xlink:title="DataSystemVariables.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.7837,-625.65 334.3841,-625.65 334.3841,-603.6391 463.7837,-603.6391 463.7837,-625.65"/>
<text text-anchor="middle" x="399.0839" y="-611.4945" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSystemVariables.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-442.6445C262.9144,-422.7355 352.371,-545.9202 385.9904,-595.0567"/>
<polygon fill="#ff0000" stroke="#ff0000" points="383.2578,-597.2632 391.7664,-603.5762 389.0517,-593.335 383.2578,-597.2632"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge75" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-442.6445C270.2507,-418.9974 634.4248,-513.9337 685.3989,-524.6445 768.2828,-542.0604 792.0649,-537.8656 870.5706,-569.6445 957.6376,-604.8891 983.5841,-613.1736 1052.825,-676.6445 1089.2757,-710.0578 1119.8704,-759.9951 1135.2464,-787.5613"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1132.3377,-789.5372 1140.2054,-796.6331 1138.4799,-786.1797 1132.3377,-789.5372"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge122" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M223.8406,-73.6445C265.2762,-47.3299 270.053,-28.294 317.2024,-14.6445 387.1153,5.5948 410.5794,3.8829 480.9653,-14.6445 540.3282,-30.2704 539.9748,-77.9775 601.1821,-82.6445"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M66.2176,-659.406C73.142,-582.9372 117.594,-140.1371 223.8406,-73.6445"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M601.1821,-82.6445C801.7524,-95.9832 867.9978,-27.6173 1052.825,-106.6445 1234.107,-184.156 1280.4625,-238.1184 1375.8875,-410.6445 1420.4758,-491.2592 1457.3518,-782.5317 1466.9207,-863.5839"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1463.4518,-864.055 1468.0876,-873.5818 1470.4046,-863.2434 1463.4518,-864.055"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge135" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-1608.6445C498.6487,-1525.4491 574.2668,-1618.6093 685.3989,-1551.6445 710.0581,-1536.7857 758.6763,-1469.5977 782.3663,-1435.5511"/>
<polygon fill="#00ffff" stroke="#00ffff" points="785.5403,-1437.1146 788.3464,-1426.8981 779.7817,-1433.1348 785.5403,-1437.1146"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge137" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M399.0839,-1950.6445C516.4137,-1891.4141 561.6282,-1920.8638 685.3989,-1876.6445 727.7597,-1861.5104 1024.3132,-1741.4377 1052.825,-1706.6445 1096.2803,-1653.6155 1063.7146,-1620.4404 1088.825,-1556.6445 1100.5427,-1526.8742 1119.6958,-1495.1629 1132.5459,-1475.3809"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1135.5333,-1477.2085 1138.1223,-1466.9349 1129.6916,-1473.3516 1135.5333,-1477.2085"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge91" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M979.6978,-120.6445C1045.4396,-156.2353 1033.6666,-198.1842 1088.825,-248.6445 1134.728,-290.6379 1166.018,-279.6083 1202.9897,-329.6445 1233.3084,-370.6767 1211.3337,-395.7725 1238.9897,-438.6445 1250.5532,-456.57 1268.4048,-472.7685 1282.978,-484.2505"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1281.0316,-487.1677 1291.1073,-490.4434 1285.2735,-481.5993 1281.0316,-487.1677"/>
</g>
<!-- sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node37" class="node">
<title>sourcefile~outputreportpredefined.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node37"><a xlink:href="../sourcefile/outputreportpredefined.f90.html" xlink:title="OutputReportPredefined.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="470.9214,-45.65 327.2463,-45.65 327.2463,-23.6391 470.9214,-23.6391 470.9214,-45.65"/>
<text text-anchor="middle" x="399.0839" y="-31.4945" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputReportPredefined.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge101" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M223.8406,-73.6445C251.5693,-55.9269 286.2316,-46.1899 317.3928,-40.8644"/>
<polygon fill="#0000ff" stroke="#0000ff" points="318.0433,-44.3051 327.3738,-39.2859 316.9498,-37.3911 318.0433,-44.3051"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge109" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M979.6978,-120.6445C1030.576,-145.2252 1026.7725,-174.504 1052.825,-224.6445 1074.6042,-266.5608 1056.5652,-290.1392 1088.825,-324.6445 1091.9859,-328.0255 1095.6845,-330.9747 1099.6528,-333.5419"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1098.2289,-336.7553 1108.6669,-338.5713 1101.6396,-330.6424 1098.2289,-336.7553"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M223.8406,-73.6445C278.8997,-38.4639 451.7645,-92.3965 516.9653,-96.6445 568.3402,-99.9918 933.3406,-98.2482 979.6978,-120.6445"/>
</g>
<!-- sourcefile~dataroomair.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node39" class="node">
<title>sourcefile~dataroomair.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node39"><a xlink:href="../sourcefile/dataroomair.f90.html" xlink:title="DataRoomAir.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="445.0438,-434.65 353.1239,-434.65 353.1239,-412.6391 445.0438,-412.6391 445.0438,-434.65"/>
<text text-anchor="middle" x="399.0839" y="-420.4945" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRoomAir.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataroomair.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge85" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataroomair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-442.6445C260.446,-423.9932 306.8515,-419.6786 342.712,-419.7933"/>
<polygon fill="#ff0000" stroke="#ff0000" points="342.9525,-423.2972 353.0038,-419.9472 343.0573,-416.298 342.9525,-423.2972"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node40" class="node">
<title>sourcefile~datacomplexfenestration.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node40"><a xlink:href="../sourcefile/datacomplexfenestration.f90.html" xlink:title="DataComplexFenestration.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="475.0737,-240.65 323.0941,-240.65 323.0941,-218.6391 475.0737,-218.6391 475.0737,-240.65"/>
<text text-anchor="middle" x="399.0839" y="-226.4945" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataComplexFenestration.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge103" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-73.6445C285.3136,-34.3657 257.3421,-166.9491 317.2024,-208.6445 320.2732,-210.7835 323.5446,-212.7047 326.9463,-214.4302"/>
<polygon fill="#ff0000" stroke="#ff0000" points="325.6477,-217.6833 336.2065,-218.5563 328.4967,-211.2893 325.6477,-217.6833"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node41" class="node">
<title>sourcefile~dataequivalentlayerwindow.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node41"><a xlink:href="../sourcefile/dataequivalentlayerwindow.f90.html" xlink:title="DataEquivalentLayerWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="480.847,-199.65 317.3208,-199.65 317.3208,-177.6391 480.847,-177.6391 480.847,-199.65"/>
<text text-anchor="middle" x="399.0839" y="-185.4945" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEquivalentLayerWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge105" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-73.6445C285.2631,-34.3979 357.8517,-126.9701 386.5301,-169.1092"/>
<polygon fill="#00ffff" stroke="#00ffff" points="383.6585,-171.1118 392.112,-177.4985 389.4864,-167.2341 383.6585,-171.1118"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantpipingsystemmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge194" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantpipingsystemmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M246.27,-926.6233C258.8531,-919.1633 273.5252,-908.0419 281.2024,-893.6445 340.7117,-782.0439 239.4562,-425.4022 317.2024,-325.6445 374.5113,-252.1103 426.0824,-282.4265 516.9653,-261.6445 719.4177,-215.3503 772.0198,-196.6445 979.6978,-196.6445 979.6978,-196.6445 979.6978,-196.6445 1145.9073,-196.6445 1255.6688,-196.6445 1293.9386,-213.6242 1375.8875,-286.6445 1442.011,-345.5637 1413.5722,-393.8415 1469.339,-462.6445"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1469.339,-462.6445C1641.9843,-662.3728 1464.8037,-824.6974 1622.2083,-1036.6445"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1781.1273,-1188.6445C1810.3001,-1217.0333 1821.7904,-1220.949 1844.6287,-1254.6445 1889.2472,-1320.4746 1840.8159,-1400.3617 1918.4414,-1417.6445"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1622.2083,-1036.6445C1680.4809,-1115.1094 1711.0823,-1120.4819 1781.1273,-1188.6445"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1918.4414,-1417.6445C1969.3959,-1428.9893 1985.8347,-1402.849 2035.8962,-1417.6445"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2035.8962,-1417.6445C2117.9061,-1441.8823 2181.4204,-2105.4272 2192.9262,-2233.3999"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2189.4516,-2233.841 2193.825,-2243.4911 2196.424,-2233.22 2189.4516,-2233.841"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataloopnode.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.1948,-948.7945C227.6334,-1054.3958 256.2723,-1876.4481 317.2024,-1964.6445 322.1875,-1971.8604 592.4992,-2103.8801 601.1821,-2102.6445"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-2102.6445C664.1941,-2095.3961 731.7681,-2062.2829 768.4392,-2041.913"/>
<polygon fill="#ff0000" stroke="#ff0000" points="770.5239,-2044.755 777.5046,-2036.785 767.0774,-2038.6623 770.5239,-2044.755"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataplantpipingsystems.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataplantpipingsystems.f90</title>
<path fill="none" stroke="#ff5900" stroke-dasharray="5,2" d="M224.3998,-948.7275C230.9965,-1079.0599 294.151,-2315.5702 317.2024,-2344.6445 319.7274,-2347.8292 322.6471,-2350.6188 325.8485,-2353.0614"/>
<polygon fill="#ff5900" stroke="#ff5900" points="324.0045,-2356.0365 334.3218,-2358.4454 327.7586,-2350.1283 324.0045,-2356.0365"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ffb300" stroke-dasharray="5,2" d="M224.6032,-948.7212C230.2479,-1029.3016 266.7238,-1526.2575 317.2024,-1667.6445 340.2884,-1732.3069 345.9124,-1755.2051 399.0839,-1798.6445"/>
<path fill="none" stroke="#ffb300" stroke-dasharray="5,2" d="M795.9847,-1720.6445C829.7468,-1712.1139 840.061,-1713.432 870.5706,-1696.6445 888.818,-1686.6041 888.1665,-1676.3948 906.5706,-1666.6445 911.1226,-1664.2329 915.9849,-1662.0687 920.9573,-1660.1325"/>
<polygon fill="#ffb300" stroke="#ffb300" points="922.3639,-1663.3466 930.6024,-1656.6849 920.0078,-1656.755 922.3639,-1663.3466"/>
<path fill="none" stroke="#ffb300" stroke-dasharray="5,2" d="M399.0839,-1798.6445C443.4291,-1834.8732 461.5425,-1761.0434 516.9653,-1746.6445 637.5095,-1715.3272 675.2338,-1751.1547 795.9847,-1720.6445"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#f0ff00" stroke-dasharray="5,2" d="M234.3488,-948.7808C250.6761,-965.5286 283.7525,-997.2944 317.2024,-1016.6445 394.7465,-1061.5024 650.3461,-1142.7364 752.8744,-1174.4551"/>
<polygon fill="#f0ff00" stroke="#f0ff00" points="752.008,-1177.8505 762.5955,-1177.4559 754.0727,-1171.1619 752.008,-1177.8505"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#96ff00" stroke-dasharray="5,2" d="M267.8415,-942.1072C303.3249,-945.8406 354.4876,-951.5271 399.0839,-957.6445"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#3cff00" stroke-dasharray="5,2" d="M246.2175,-926.5952C258.782,-919.1252 273.4531,-908.0031 281.2024,-893.6445 333.058,-797.5624 246.1941,-486.582 317.2024,-403.6445 341.4991,-375.266 368.5818,-406.2152 399.0839,-384.6445"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge65" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#00ff1e" stroke-dasharray="5,2" d="M399.0839,-1798.6445C492.4753,-1885.6812 558.4254,-1834.8757 685.3989,-1821.6445 867.6492,-1802.6534 907.9758,-1766.1301 1088.825,-1736.6445 1366.5027,-1691.3721 1436.7515,-1679.8939 1717.626,-1663.6445 1769.816,-1660.6252 1829.7634,-1661.1429 1870.4752,-1662.09"/>
<polygon fill="#00ff1e" stroke="#00ff1e" points="1870.5673,-1665.5933 1880.6519,-1662.3451 1870.7428,-1658.5955 1870.5673,-1665.5933"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge71" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#0078ff" stroke-dasharray="5,2" d="M267.6098,-932.899C287.918,-930.6972 312.4607,-928.0363 334.8156,-925.6125"/>
<polygon fill="#0078ff" stroke="#0078ff" points="335.3453,-929.0757 344.9098,-924.5181 334.5907,-922.1165 335.3453,-929.0757"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge150" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#001dff" stroke-dasharray="5,2" d="M601.1821,-1492.6445C721.1733,-1493.6256 751.4966,-1495.8045 870.5706,-1510.6445 919.5008,-1516.7427 930.6017,-1535.2204 979.6978,-1530.6445"/>
<path fill="none" stroke="#001dff" stroke-dasharray="5,2" d="M224.1314,-948.8681C225.9094,-1002.6808 238.0846,-1238.7009 317.2024,-1409.6445 341.7656,-1462.7163 352.0462,-1477.8966 399.0839,-1512.6445"/>
<path fill="none" stroke="#001dff" stroke-dasharray="5,2" d="M399.0839,-1512.6445C435.3834,-1539.46 556.063,-1491.6491 601.1821,-1492.6445"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge161" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#3c00ff" stroke-dasharray="5,2" d="M224.2995,-948.8392C229.342,-1070.7567 275.049,-2148.4436 317.2024,-2199.6445 457.424,-2369.9626 581.8134,-2277.7204 795.9847,-2330.6445"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge169" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#f000ff" stroke-dasharray="5,2" d="M795.9847,-1376.6445C829.8159,-1381.7078 840.4799,-1379.3739 870.5706,-1395.6445 889.6632,-1405.9683 887.9059,-1417.5657 906.5706,-1428.6445 913.3039,-1432.6412 920.7676,-1436.1149 928.2787,-1439.0964"/>
<polygon fill="#f000ff" stroke="#f000ff" points="927.1737,-1442.4194 937.7668,-1442.6119 929.6058,-1435.8555 927.1737,-1442.4194"/>
<path fill="none" stroke="#f000ff" stroke-dasharray="5,2" d="M399.0839,-1395.6445C418.4165,-1406.3013 774.1526,-1373.3771 795.9847,-1376.6445"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge175" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00b4" stroke-dasharray="5,2" d="M226.1646,-948.9409C239.9744,-1014.7635 313.5539,-1347.5619 399.0839,-1395.6445"/>
<path fill="none" stroke="#ff00b4" stroke-dasharray="5,2" d="M399.0839,-1395.6445C492.2274,-1448.0073 569.8284,-1270.6088 593.645,-1208.4055"/>
<polygon fill="#ff00b4" stroke="#ff00b4" points="597.0003,-1209.4255 597.231,-1198.8332 590.4452,-1206.9698 597.0003,-1209.4255"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge182" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#ff005a" stroke-dasharray="5,2" d="M601.1821,-842.6445C715.4625,-861.1358 847.7386,-889.7026 921.7732,-906.3478"/>
<polygon fill="#ff005a" stroke="#ff005a" points="921.3002,-909.829 931.8253,-908.6151 922.8405,-903.0006 921.3002,-909.829"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1512.6445C433.9689,-1538.4151 482.0202,-1543.7987 522.5162,-1542.4413"/>
<polygon fill="#ff0000" stroke="#ff0000" points="522.8143,-1545.9312 532.6364,-1541.9593 522.4811,-1538.9391 522.8143,-1545.9312"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M246.2416,-926.6081C258.8147,-919.1428 273.4862,-908.021 281.2024,-893.6445 336.2956,-790.9978 244.7136,-461.842 317.2024,-370.6445 321.2082,-365.6049 326.2023,-361.555 331.7358,-358.3041"/>
<polygon fill="#00ffff" stroke="#00ffff" points="333.3918,-361.3899 340.8105,-353.8259 330.2941,-355.1126 333.3918,-361.3899"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge53" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1798.6445C728.9895,-2104.979 962.6459,-1844.9805 1411.8875,-1815.6445 1462.8469,-1812.3168 1477.6677,-1801.684 1526.7905,-1815.6445 1574.7514,-1829.2748 1575.2984,-1891.5411 1622.2083,-1874.6445"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge59" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.9423,-948.6634C225.1053,-1064.4076 237.3684,-2055.0104 317.2024,-2154.6445 325.1227,-2164.5292 336.8434,-2170.6032 348.9566,-2174.3083"/>
<polygon fill="#00ffff" stroke="#00ffff" points="348.1347,-2177.7107 358.6903,-2176.7994 349.8703,-2170.9293 348.1347,-2177.7107"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9847,-1758.6445C828.8857,-1747.2351 839.0631,-1749.4745 870.5706,-1734.6445 887.7494,-1726.5588 889.4656,-1719.8855 906.5706,-1711.6445 914.6502,-1707.7519 923.4962,-1704.1876 932.1574,-1701.0456"/>
<polygon fill="#ff0000" stroke="#ff0000" points="933.516,-1704.2787 941.8071,-1697.6826 931.2122,-1697.6686 933.516,-1704.2787"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1798.6445C465.7535,-1857.0692 712.2308,-1787.6887 795.9847,-1758.6445"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M601.1821,-2140.6445C637.968,-2140.6739 678.4962,-2137.4565 713.0156,-2133.7343"/>
<polygon fill="#0000ff" stroke="#0000ff" points="713.5003,-2137.2021 723.053,-2132.6199 712.7278,-2130.2449 713.5003,-2137.2021"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M223.9606,-948.6973C225.2758,-1060.7386 238.519,-1988.7049 317.2024,-2078.6445 338.4677,-2102.952 568.8856,-2140.6187 601.1821,-2140.6445"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge76" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M243.3028,-926.5391C298.7516,-896.2511 462.4923,-816.1928 601.1821,-842.6445"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-842.6445C647.3195,-848.6449 943.2303,-824.8424 1078.5492,-813.431"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1079.1214,-816.8952 1088.791,-812.5651 1078.5316,-809.9201 1079.1214,-816.8952"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge123" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1307.4386,-884.6445C1339.61,-883.7689 1375.3907,-883.6765 1405.1163,-883.8419"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1405.339,-887.3434 1415.3622,-883.9103 1405.3858,-880.3436 1405.339,-887.3434"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M795.9847,-614.6445C908.5779,-581.289 946.4157,-626.9769 1052.825,-676.6445 1128.0299,-711.7473 1139.1129,-734.6565 1202.9897,-787.6445 1251.7495,-828.0924 1244.1095,-886.3683 1307.4386,-884.6445"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge133" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-1395.6445C511.0856,-1458.6089 557.4258,-1447.1237 685.3989,-1435.6445 701.8937,-1434.165 719.6079,-1431.4677 735.9194,-1428.523"/>
<polygon fill="#00ffff" stroke="#00ffff" points="736.6826,-1431.9411 745.871,-1426.6662 735.3986,-1425.0599 736.6826,-1431.9411"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge138" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M601.1821,-1492.6445C803.0152,-1502.1386 865.2944,-1619.871 1052.825,-1544.6445 1071.0161,-1537.3473 1107.9506,-1498.2996 1129.4221,-1474.4145"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1132.2779,-1476.4705 1136.3159,-1466.6753 1127.0509,-1471.8144 1132.2779,-1476.4705"/>
</g>
<!-- sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node33" class="node">
<title>sourcefile~sortandstringutilities.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node33"><a xlink:href="../sourcefile/sortandstringutilities.f90.html" xlink:title="SortAndStringUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.3044,-1123.65 334.8633,-1123.65 334.8633,-1101.6391 463.3044,-1101.6391 463.3044,-1123.65"/>
<text text-anchor="middle" x="399.0839" y="-1109.4945" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SortAndStringUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge82" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M227.6903,-948.9778C237.7597,-976.9037 267.585,-1049.5169 317.2024,-1087.6445 322.2297,-1091.5077 327.855,-1094.7775 333.7395,-1097.5445"/>
<polygon fill="#ff0000" stroke="#ff0000" points="332.5756,-1100.8517 343.1511,-1101.4918 335.283,-1094.3965 332.5756,-1100.8517"/>
</g>
<!-- sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node34" class="node">
<title>sourcefile~dataoutputs.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node34"><a xlink:href="../sourcefile/dataoutputs.f90.html" xlink:title="DataOutputs.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="443.5485,-1007.65 354.6193,-1007.65 354.6193,-985.6391 443.5485,-985.6391 443.5485,-1007.65"/>
<text text-anchor="middle" x="399.0839" y="-993.4945" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataOutputs.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge83" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M253.1349,-948.764C271.4611,-955.6078 295.6083,-964.4216 317.2024,-971.6445 328.3226,-975.3641 340.3651,-979.1653 351.7053,-982.6447"/>
<polygon fill="#ffff00" stroke="#ffff00" points="350.8636,-986.0469 361.4494,-985.6093 352.9012,-979.35 350.8636,-986.0469"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge93" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M241.1047,-926.6321C253.1666,-918.4309 269.1964,-906.4745 281.2024,-893.6445 300.911,-872.5834 296.2218,-859.4389 317.2024,-839.6445 464.6019,-700.579 528.3041,-690.1283 721.3989,-628.6445 753.5372,-618.4113 763.2782,-622.8827 795.9847,-614.6445"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M795.9847,-614.6445C859.5197,-595.8224 847.2581,-544.1909 906.5706,-514.6445 936.1902,-499.8896 946.8422,-496.7018 979.6978,-500.6445"/>
</g>
<!-- sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node36" class="node">
<title>sourcefile~dataglobalconstants.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node36"><a xlink:href="../sourcefile/dataglobalconstants.f90.html" xlink:title="DataGlobalConstants.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="860.8052,-1120.65 731.1643,-1120.65 731.1643,-1098.6391 860.8052,-1098.6391 860.8052,-1120.65"/>
<text text-anchor="middle" x="795.9847" y="-1106.4945" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobalConstants.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge98" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataglobalconstants.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M601.1821,-842.6445C639.6023,-848.8612 657.1237,-839.9 685.3989,-866.6445 720.9342,-900.2561 701.7732,-925.8414 721.3989,-970.6445 740.5807,-1014.4343 768.2829,-1063.1353 783.9667,-1089.689"/>
<polygon fill="#00ffff" stroke="#00ffff" points="781.041,-1091.6167 789.1632,-1098.4197 787.0562,-1088.0365 781.041,-1091.6167"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge100" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M246.633,-926.4887C259.1756,-919.0434 273.6822,-907.9829 281.2024,-893.6445 356.1264,-750.7908 269.6768,-322.7942 317.2024,-168.6445 331.0699,-123.6651 363.4733,-78.4093 383.1046,-53.7068"/>
<polygon fill="#0000ff" stroke="#0000ff" points="385.8866,-55.833 389.4644,-45.8606 380.4486,-51.4252 385.8866,-55.833"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge110" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M245.6889,-926.6343C258.2296,-919.1151 273.0593,-907.9282 281.2024,-893.6445 347.4935,-777.365 245.078,-707.3988 317.2024,-594.6445 420.7929,-432.6983 532.0332,-483.5606 685.3989,-367.6445 702.7146,-354.5571 701.5564,-343.4414 721.3989,-334.6445 826.7992,-287.9168 866.6952,-287.7728 979.6978,-310.6445"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataroomair.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge84" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataroomair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M246.0932,-926.5271C258.6136,-919.033 273.2819,-907.9094 281.2024,-893.6445 361.1915,-749.583 254.6706,-677.0971 317.2024,-524.6445 330.8298,-491.4209 359.1397,-460.4868 378.6219,-441.8263"/>
<polygon fill="#ff0000" stroke="#ff0000" points="381.1871,-444.2198 386.1104,-434.8383 376.4113,-439.1019 381.1871,-444.2198"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge102" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M246.2881,-926.633C258.8777,-919.1764 273.5502,-908.0551 281.2024,-893.6445 343.9509,-775.4764 254.541,-410.8589 317.2024,-292.6445 328.0039,-272.2668 348.6127,-256.4655 366.4514,-245.7845"/>
<polygon fill="#ff0000" stroke="#ff0000" points="368.4932,-248.6501 375.4608,-240.6687 365.0367,-242.563 368.4932,-248.6501"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge104" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M246.6173,-926.4805C259.1545,-919.0323 273.6609,-907.9717 281.2024,-893.6445 316.6512,-826.2993 268.9843,-268.5259 317.2024,-209.6445 318.2194,-208.4027 319.2989,-207.2286 320.4338,-206.1187"/>
<polygon fill="#00ffff" stroke="#00ffff" points="322.9322,-208.608 328.6514,-199.6894 318.6188,-203.0949 322.9322,-208.608"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node42" class="node">
<title>sourcefile~databranchnodeconnections.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node42"><a xlink:href="../sourcefile/databranchnodeconnections.f90.html" xlink:title="DataBranchNodeConnections.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="685.6163,-1426.65 516.748,-1426.65 516.748,-1404.6391 685.6163,-1404.6391 685.6163,-1426.65"/>
<text text-anchor="middle" x="601.1821" y="-1412.4945" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBranchNodeConnections.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchnodeconnections.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge165" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchnodeconnections.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1395.6445C431.2527,-1413.729 470.9005,-1420.3688 506.5339,-1421.8993"/>
<polygon fill="#ff0000" stroke="#ff0000" points="506.8583,-1425.4104 516.9579,-1422.2093 507.0664,-1418.4135 506.8583,-1425.4104"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~plantpipingsystemmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge195" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~plantpipingsystemmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M405.5956,-907.3726C447.0908,-837.1524 682.3374,-462.6445 979.6978,-462.6445 979.6978,-462.6445 979.6978,-462.6445 1145.9073,-462.6445 1289.6547,-462.6445 1376.6749,-352.7506 1469.339,-462.6445"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#f0ff00" stroke-dasharray="5,2" d="M601.1821,-918.6445C637.4328,-931.2214 659.1382,-909.6684 685.3989,-937.6445 754.7093,-1011.4827 655.9243,-1085.3848 721.3989,-1162.6445 729.3317,-1172.0052 740.883,-1177.8748 752.5359,-1181.5507"/>
<polygon fill="#f0ff00" stroke="#f0ff00" points="751.7064,-1184.9518 762.271,-1184.151 753.5129,-1178.1889 751.7064,-1184.9518"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge176" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00b4" stroke-dasharray="5,2" d="M419.4913,-929.6645C437.3164,-940.0339 463.0684,-956.8934 480.9653,-976.6445 535.798,-1037.1582 576.4757,-1126.8896 593.0288,-1166.9847"/>
<polygon fill="#ff00b4" stroke="#ff00b4" points="589.8808,-1168.5357 596.8813,-1176.4882 596.368,-1165.9058 589.8808,-1168.5357"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M425.1024,-929.8092C443.9554,-939.3578 468.2772,-955.0044 480.9653,-976.6445 557.3765,-1106.9674 429.8863,-1191.1943 516.9653,-1314.6445 564.8451,-1382.5227 626.3725,-1337.1996 685.3989,-1395.6445 711.1049,-1421.0973 700.785,-1438.9173 721.3989,-1468.6445 789.8717,-1567.3891 804.0032,-1603.043 906.5706,-1665.6445 910.9677,-1668.3283 915.7222,-1670.6817 920.6233,-1672.7432"/>
<polygon fill="#ff0000" stroke="#ff0000" points="919.5818,-1676.0913 930.1733,-1676.3578 922.0597,-1669.5445 919.5818,-1676.0913"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge77" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-918.6445C641.709,-932.705 941.4654,-862.0974 979.6978,-842.6445"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M453.4977,-909.0305C495.1514,-903.9289 553.3793,-901.7513 601.1821,-918.6445"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-842.6445C996.9601,-833.7426 1040.4657,-824.7347 1078.6362,-818.0869"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1079.4517,-821.4984 1088.7187,-816.3631 1078.2719,-814.5985 1079.4517,-821.4984"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge125" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M601.1821,-918.6445C637.3599,-931.4296 658.7672,-910.0213 685.3989,-937.6445 745.6582,-1000.1473 654.5899,-1074.1979 721.3989,-1129.6445 772.4162,-1171.9851 808.782,-1153.6793 870.5706,-1129.6445 890.7992,-1121.7759 888.2526,-1108.2877 906.5706,-1096.6445 936.6285,-1077.5392 1172.6419,-993.286 1202.9897,-974.6445 1255.2038,-942.5716 1246.1834,-886.3119 1307.4386,-884.6445"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~plantpipingsystemmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge196" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~plantpipingsystemmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1681.6486,-1414.3105C1711.5873,-1413.476 1748.3897,-1413.7355 1781.1273,-1417.6445"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge54" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1634.7476,-1428.7913C1647.645,-1440.714 1667.7543,-1460.6247 1681.626,-1480.6445 1724.3303,-1542.2763 1758.7094,-1624.9705 1773.4073,-1662.9699"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1770.1881,-1664.3512 1777.0215,-1672.4478 1776.7287,-1661.857 1770.1881,-1664.3512"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~plantpipingsystemmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge197" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~plantpipingsystemmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2079.7359,-2254.6445C2087.8784,-2254.6445 2096.6501,-2254.6445 2105.5891,-2254.6445"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2105.728,-2258.1446 2115.7279,-2254.6445 2105.7279,-2251.1446 2105.728,-2258.1446"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantpipingsystemmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge198" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantpipingsystemmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1918.4414,-2444.6445C1979.436,-2432.5756 1980.0181,-2395.9142 2035.8962,-2368.6445"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1622.2083,-2368.6445C1756.5523,-2347.9864 1785.1035,-2471.0279 1918.4414,-2444.6445"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ffb300" stroke-dasharray="5,2" d="M795.9847,-1682.6445C820.6359,-1682.4903 880.4764,-1669.5537 925.2077,-1659.0218"/>
<polygon fill="#ffb300" stroke="#ffb300" points="926.1542,-1662.3945 935.0758,-1656.6801 924.5379,-1655.5837 926.1542,-1662.3945"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#f0ff00" stroke-dasharray="5,2" d="M448.0445,-1637.8849C521.6496,-1622.1649 655.4147,-1589.1737 685.3989,-1551.6445 775.0095,-1439.4852 642.7537,-1350.7475 721.3989,-1230.6445 729.0983,-1218.8865 741.2044,-1209.9647 753.4412,-1203.382"/>
<polygon fill="#f0ff00" stroke="#f0ff00" points="755.3287,-1206.3539 762.7534,-1198.7959 752.236,-1200.0742 755.3287,-1206.3539"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge67" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#00ff1e" stroke-dasharray="5,2" d="M407.6722,-1658.7786C456.5666,-1722.0983 698.4435,-2034.3972 721.3989,-2045.6445 901.2009,-2133.7413 1432.0265,-2127.2602 1622.2083,-2064.6445"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge151" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#001dff" stroke-dasharray="5,2" d="M979.6978,-1606.6445C1070.7351,-1565.9437 1106.0947,-1608.2178 1202.9897,-1584.6445 1354.2661,-1547.841 1523.3009,-1467.542 1591.3635,-1433.4544"/>
<polygon fill="#001dff" stroke="#001dff" points="1593.303,-1436.3964 1600.6587,-1428.7711 1590.1533,-1430.145 1593.303,-1436.3964"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge163" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#3c00ff" stroke-dasharray="5,2" d="M407.2185,-1658.8017C423.3928,-1681.453 459.8481,-1734.9092 480.9653,-1784.6445 504.8986,-1841.0123 491.9131,-1861.7651 516.9653,-1917.6445 584.9383,-2069.2592 581.7032,-2140.6867 721.3989,-2230.6445 806.5321,-2285.4665 1522.4481,-2385.9941 1622.2083,-2368.6445"/>
<path fill="none" stroke="#3c00ff" stroke-dasharray="5,2" d="M1622.2083,-2368.6445C1680.4334,-2359.6912 1667.4145,-2307.4527 1717.626,-2276.6445 1743.0844,-2261.0241 1751.7004,-2259.7622 1781.1273,-2254.6445"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge170" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#f000ff" stroke-dasharray="5,2" d="M601.1821,-1646.6445C666.8139,-1647.7451 849.2206,-1557.6425 870.5706,-1544.6445 880.0156,-1538.8944 929.7626,-1496.5588 958.7239,-1471.7069"/>
<polygon fill="#f000ff" stroke="#f000ff" points="961.3301,-1474.0822 966.634,-1464.9105 956.7682,-1468.7728 961.3301,-1474.0822"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge180" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00b4" stroke-dasharray="5,2" d="M447.9273,-1642.1003C460.3038,-1638.4139 472.4789,-1632.4013 480.9653,-1622.6445 548.0038,-1545.5705 489.6207,-1494.0663 516.9653,-1395.6445 536.6981,-1324.6205 573.2673,-1244.9594 591.0057,-1208.2274"/>
<polygon fill="#ff00b4" stroke="#ff00b4" points="594.2444,-1209.5709 595.4798,-1199.0484 587.9521,-1206.5039 594.2444,-1209.5709"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge183" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#ff005a" stroke-dasharray="5,2" d="M448.0082,-1642.6509C460.5392,-1638.9828 472.7744,-1632.842 480.9653,-1622.6445 544.4823,-1543.5683 458.5627,-1250.5697 516.9653,-1167.6445 616.1857,-1026.7627 743.3781,-1124.8962 870.5706,-1008.6445 894.6603,-986.627 881.4819,-965.5166 906.5706,-944.6445 911.1298,-940.8515 916.2949,-937.623 921.7206,-934.8772"/>
<polygon fill="#ff005a" stroke="#ff005a" points="923.3457,-937.9842 931.0367,-930.6973 920.4802,-931.5976 923.3457,-937.9842"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M448.0511,-1639.3687C459.7221,-1635.6774 471.5182,-1630.345 480.9653,-1622.6445 506.8646,-1601.5336 490.9843,-1577.6548 516.9653,-1556.6445 521.6756,-1552.8354 526.9516,-1549.6065 532.5043,-1546.8694"/>
<polygon fill="#ff0000" stroke="#ff0000" points="534.2862,-1549.9111 542.0593,-1542.7118 531.4932,-1543.4924 534.2862,-1549.9111"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge56" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-1646.6445C647.6443,-1645.3973 654.6018,-1673.8332 685.3989,-1708.6445 707.0234,-1733.0877 694.2628,-1754.5139 721.3989,-1772.6445 805.1541,-1828.6044 1529.337,-1913.6494 1622.2083,-1874.6445"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9847,-1682.6445C837.3602,-1682.3857 883.9659,-1683.4158 919.8822,-1684.4953"/>
<polygon fill="#ff0000" stroke="#ff0000" points="920.0868,-1688.0032 930.1906,-1684.8152 920.304,-1681.0066 920.0868,-1688.0032"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge81" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-1646.6445C649.012,-1646.5876 649.493,-1611.2429 685.3989,-1579.6445 702.1511,-1564.9021 704.3481,-1559.0405 721.3989,-1544.6445 784.1393,-1491.6729 829.5729,-1506.7891 870.5706,-1435.6445 946.2199,-1304.3677 843.6998,-1234.4985 906.5706,-1096.6445 946.1417,-1009.8787 997.7705,-1017.5111 1052.825,-939.6445 1072.794,-911.4013 1069.0516,-899.0251 1088.825,-870.6445 1100.0373,-854.5515 1114.9909,-838.1898 1126.7801,-826.175"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1129.4044,-828.5004 1133.9992,-818.9538 1124.4539,-823.5514 1129.4044,-828.5004"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M448.099,-1648.0017C489.0326,-1648.1561 548.9214,-1648.0475 601.1821,-1646.6445"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge132" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M979.6978,-1606.6445C1032.5415,-1583.9029 1170.6923,-1523.2525 1202.9897,-1475.6445 1250.5056,-1405.6038 1209.6348,-1368.0281 1238.9897,-1288.6445 1297.6126,-1130.1131 1414.3975,-960.6966 1455.017,-904.2119"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1458.0415,-906.0026 1461.0696,-895.8497 1452.371,-901.8982 1458.0415,-906.0026"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge140" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M795.9847,-1682.6445C851.2777,-1682.2986 854.9203,-1645.3848 906.5706,-1625.6445 937.9378,-1613.6563 948.8527,-1619.9189 979.6978,-1606.6445"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M601.1821,-1646.6445C689.227,-1646.5397 707.9415,-1683.1953 795.9847,-1682.6445"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M979.6978,-1606.6445C1011.1182,-1593.1226 1026.3946,-1604.3592 1052.825,-1582.6445 1078.0415,-1561.9271 1069.7491,-1545.1247 1088.825,-1518.6445 1100.2894,-1502.7301 1115.2333,-1486.3616 1126.955,-1474.2989"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1129.586,-1476.6159 1134.1235,-1467.0418 1124.6059,-1471.6966 1129.586,-1476.6159"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge94" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M448.0956,-1642.7207C460.6281,-1639.0537 472.842,-1632.896 480.9653,-1622.6445 556.6218,-1527.1675 452.7966,-1179.1922 516.9653,-1075.6445 562.5869,-1002.026 620.9778,-1035.5318 685.3989,-977.6445 808.8801,-866.6874 776.0825,-779.2698 906.5706,-676.6445 997.1867,-605.3774 1034.3699,-605.7939 1145.9073,-576.6445"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge113" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M979.6978,-424.6445C1010.1986,-394.375 1055.0831,-375.1194 1090.5229,-363.7079"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1091.7323,-366.9974 1100.2485,-360.6947 1089.6606,-360.311 1091.7323,-366.9974"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M448.2313,-1642.8271C460.7659,-1639.1618 472.9471,-1632.9783 480.9653,-1622.6445 535.1036,-1552.872 470.7541,-903.902 516.9653,-828.6445 611.4435,-674.7819 760.9897,-772.1432 870.5706,-628.6445 910.0853,-576.899 872.1008,-541.879 906.5706,-486.6445 929.1295,-450.496 949.4534,-454.6595 979.6978,-424.6445"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~plantpipingsystemmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge199" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~plantpipingsystemmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M996.1994,-1442.5054C1025.0227,-1423.9237 1087.09,-1387.7385 1145.9073,-1378.6445"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1781.1273,-1417.6445C1841.7253,-1424.8802 1858.8715,-1404.3817 1918.4414,-1417.6445"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-1378.6445C1381.289,-1342.2515 1450.5437,-1306.9387 1681.626,-1364.6445 1730.2383,-1376.784 1731.3756,-1411.704 1781.1273,-1417.6445"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge152" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#001dff" stroke-dasharray="5,2" d="M1145.9073,-1378.6445C1218.7928,-1367.3755 1233.9633,-1410.2679 1307.4386,-1416.6445"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge57" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-1570.6445C1315.1287,-1578.328 1361.916,-1517.7691 1526.7905,-1556.6445 1617.8304,-1578.1107 1713.4665,-1637.3972 1756.9982,-1666.7417"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1755.2428,-1669.781 1765.4762,-1672.5247 1759.1873,-1663.9982 1755.2428,-1669.781"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1022.5419,-1464.6983C1032.8718,-1468.3187 1043.5854,-1472.9226 1052.825,-1478.6445 1102.2768,-1509.2695 1089.2081,-1557.6613 1145.9073,-1570.6445"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~plantpipingsystemmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge200" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~plantpipingsystemmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9847,-1244.6445C1022.1868,-1278.159 1078.7673,-1188.6445 1307.4386,-1188.6445 1307.4386,-1188.6445 1307.4386,-1188.6445 1469.339,-1188.6445 1607.9116,-1188.6445 1678.6434,-1095.374 1781.1273,-1188.6445"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ffb300" stroke-dasharray="5,2" d="M795.9847,-1338.6445C825.6693,-1367.9614 849.1755,-1359.8269 870.5706,-1395.6445 922.5039,-1482.5866 841.3279,-1543.1887 906.5706,-1620.6445 910.4467,-1625.2463 915.2088,-1629.003 920.4275,-1632.0695"/>
<polygon fill="#ffb300" stroke="#ffb300" points="919.0521,-1635.2942 929.5654,-1636.6059 922.1647,-1629.0243 919.0521,-1635.2942"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#f0ff00" stroke-dasharray="5,2" d="M650.8431,-1187.6445C682.1022,-1187.6445 722.077,-1187.6445 752.1568,-1187.6445"/>
<polygon fill="#f0ff00" stroke="#f0ff00" points="752.3532,-1191.1446 762.3532,-1187.6445 752.3531,-1184.1446 752.3532,-1191.1446"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge68" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#00ff1e" stroke-dasharray="5,2" d="M795.9847,-1244.6445C1187.137,-1313.7803 1367.9979,-1120.8879 1681.626,-1364.6445 1708.3166,-1385.3889 1698.4479,-1403.8072 1717.626,-1431.6445 1776.5959,-1517.2402 1862.334,-1607.1325 1899.7776,-1645.046"/>
<polygon fill="#00ff1e" stroke="#00ff1e" points="1897.4778,-1647.6974 1907.0076,-1652.3272 1902.445,-1642.7651 1897.4778,-1647.6974"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge153" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#001dff" stroke-dasharray="5,2" d="M1307.4386,-1416.6445C1379.1478,-1422.5964 1398.4515,-1404.2916 1469.339,-1416.6445"/>
<path fill="none" stroke="#001dff" stroke-dasharray="5,2" d="M795.9847,-1244.6445C833.2192,-1252.449 838.8941,-1265.5751 870.5706,-1286.6445 887.4479,-1297.8704 888.0138,-1306.4891 906.5706,-1314.6445 1028.8826,-1368.3988 1075.9406,-1323.3135 1202.9897,-1364.6445 1252.3025,-1380.6867 1255.7598,-1412.3552 1307.4386,-1416.6445"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge171" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#f000ff" stroke-dasharray="5,2" d="M610.4595,-1198.7828C633.8184,-1226.5978 695.0674,-1298.0599 721.3989,-1314.6445 750.8646,-1333.2032 771.2081,-1314.1748 795.9847,-1338.6445"/>
<path fill="none" stroke="#f000ff" stroke-dasharray="5,2" d="M795.9847,-1338.6445C820.7614,-1363.1143 843.744,-1340.4412 870.5706,-1362.6445 896.311,-1383.9489 881.024,-1407.1081 906.5706,-1428.6445 911.0393,-1432.4118 916.1047,-1435.6209 921.4343,-1438.3526"/>
<polygon fill="#f000ff" stroke="#f000ff" points="920.0421,-1441.5643 930.5943,-1442.5136 922.9372,-1435.1911 920.0421,-1441.5643"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge58" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9847,-1338.6445C825.6693,-1367.9614 844.4883,-1363.0812 870.5706,-1395.6445 894.4396,-1425.4447 878.941,-1447.2933 906.5706,-1473.6445 989.6281,-1552.8594 1034.027,-1545.0256 1145.9073,-1570.6445"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9847,-1338.6445C825.6693,-1367.9614 849.6448,-1359.5507 870.5706,-1395.6445 931.2907,-1500.3778 827.4885,-1573.982 906.5706,-1665.6445 910.5504,-1670.2576 915.4701,-1673.89 920.8617,-1676.7454"/>
<polygon fill="#ff0000" stroke="#ff0000" points="919.7325,-1680.0711 930.2984,-1680.8534 922.5265,-1673.6528 919.7325,-1680.0711"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge80" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9847,-956.6445C816.5457,-928.5394 840.4658,-950.1475 870.5706,-932.6445 889.3347,-921.7351 889.9979,-913.6609 906.5706,-899.6445 938.0344,-873.0341 942.9706,-861.3316 979.6978,-842.6445"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge131" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M650.9324,-1195.667C662.341,-1197.901 674.3588,-1200.5725 685.3989,-1203.6445 735.8988,-1217.6967 744.5211,-1234.685 795.9847,-1244.6445"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M795.9847,-1244.6445C845.1695,-1254.163 1159.209,-1074.9959 1202.9897,-1050.6445 1294.0568,-999.992 1397.7101,-932.3746 1444.3183,-901.41"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1446.476,-904.1782 1452.8586,-895.7217 1442.5955,-898.3522 1446.476,-904.1782"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge92" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M795.9847,-956.6445C816.5457,-928.5394 845.6784,-956.9967 870.5706,-932.6445 905.5345,-898.4391 881.153,-870.435 906.5706,-828.6445 911.5872,-820.3964 1136.5281,-578.9312 1145.9073,-576.6445"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge99" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataglobalconstants.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M643.1711,-1176.5985C656.7954,-1172.6392 671.8786,-1167.8535 685.3989,-1162.6445 713.4341,-1151.8434 744.1642,-1136.8455 766.0992,-1125.5597"/>
<polygon fill="#00ffff" stroke="#00ffff" points="767.9626,-1128.5358 775.2222,-1120.8189 764.7348,-1122.3244 767.9626,-1128.5358"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge115" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M795.9847,-956.6445C864.9496,-862.3751 844.4302,-818.4846 870.5706,-704.6445 892.5479,-608.9343 858.151,-572.0787 906.5706,-486.6445 927.5801,-449.5741 949.4534,-454.6595 979.6978,-424.6445"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M611.4902,-1176.5621C641.5233,-1144.0409 730.9376,-1045.5589 795.9847,-956.6445"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~plantpipingsystemmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge201" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~plantpipingsystemmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-960.6445C1218.0846,-993.5903 1228.6265,-1027.4992 1307.4386,-1036.6445"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1307.4386,-1036.6445C1446.4037,-1052.7701 1537.7074,-925.1504 1622.2083,-1036.6445"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1034.929,-927.9322C1068.1214,-934.1993 1110.6236,-944.5391 1145.9073,-960.6445"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge154" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#001dff" stroke-dasharray="5,2" d="M1145.9073,-960.6445C1198.257,-984.5399 1196.9741,-1011.3233 1238.9897,-1050.6445 1268.9588,-1078.6917 1281.4616,-1080.8643 1307.4386,-1112.6445"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge79" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M991.3674,-908.6245C1010.5469,-890.9244 1050.4459,-855.803 1088.825,-832.6445 1094.6752,-829.1144 1101.1131,-825.8045 1107.4926,-822.821"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1109.0209,-825.9717 1116.7224,-818.6958 1106.1646,-819.581 1109.0209,-825.9717"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge128" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1020.3061,-908.6266C1053.7295,-900.157 1102.4989,-889.1654 1145.9073,-884.6445"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge139" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M985.602,-930.8678C999.7551,-958.3138 1035.7078,-1031.3567 1052.825,-1096.6445 1086.4343,-1224.8369 1033.7487,-1272.1063 1088.825,-1392.6445 1096.8253,-1410.154 1111.491,-1426.1752 1123.9534,-1437.6796"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1121.9225,-1440.5559 1131.7326,-1444.5576 1126.5592,-1435.3117 1121.9225,-1440.5559"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge97" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1003.3566,-908.5121C1025.3378,-898.2909 1059.0656,-882.9164 1088.825,-870.6445 1138.95,-849.9744 1165.624,-866.9329 1202.9897,-827.6445 1246.5468,-781.8462 1289.8266,-587.1134 1303.2225,-522.5423"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1306.6613,-523.1959 1305.2417,-512.6966 1299.804,-521.7896 1306.6613,-523.1959"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge114" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M982.9433,-908.5142C1003.2134,-838.9998 1112.4413,-464.4133 1139.7273,-370.8383"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1143.1331,-371.6612 1142.5725,-361.0812 1136.4129,-369.7016 1143.1331,-371.6612"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#f0ff00" stroke-dasharray="5,2" d="M666.9956,-1520.6128C673.9745,-1517.1167 680.3526,-1512.5637 685.3989,-1506.6445 765.6554,-1412.5063 652.7011,-1333.5218 721.3989,-1230.6445 729.3472,-1218.7417 741.7851,-1209.7271 754.2418,-1203.1054"/>
<polygon fill="#f0ff00" stroke="#f0ff00" points="755.8057,-1206.2367 763.2516,-1198.6996 752.7306,-1199.9483 755.8057,-1206.2367"/>
</g>
<!-- sourcefile~datastringglobals.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~datastringglobals.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_node20"><a xlink:href="../sourcefile/datastringglobals.f90.html" xlink:title="DataStringGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="281.0645,-654.65 166.6166,-654.65 166.6166,-632.6391 281.0645,-632.6391 281.0645,-654.65"/>
<text text-anchor="middle" x="223.8406" y="-640.4945" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataStringGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#f0ff00" stroke-dasharray="5,2" d="M247.4823,-654.6921C266.2669,-663.3698 293.2675,-675.621 317.2024,-685.6445 479.1279,-753.4564 577.8081,-689.9271 685.3989,-828.6445 767.9721,-935.1066 655.1046,-1012.3519 721.3989,-1129.6445 731.3171,-1147.1924 748.8989,-1161.2578 764.5019,-1171.1407"/>
<polygon fill="#f0ff00" stroke="#f0ff00" points="763.0113,-1174.3279 773.3872,-1176.471 766.6124,-1168.3252 763.0113,-1174.3279"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge178" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00b4" stroke-dasharray="5,2" d="M226.7793,-654.7136C235.3612,-687.1016 261.0515,-784.5139 281.2024,-865.6445 297.833,-932.6022 273.5441,-963.223 317.2024,-1016.6445 367.9781,-1078.7751 412.6278,-1050.5927 480.9653,-1092.6445 518.6971,-1115.863 558.2156,-1149.0792 581.2262,-1169.4575"/>
<polygon fill="#ff00b4" stroke="#ff00b4" points="579.1362,-1172.2839 588.923,-1176.3421 583.803,-1167.0665 579.1362,-1172.2839"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M281.2218,-634.1489C295.0096,-631.8672 309.936,-629.3971 324.3832,-627.0063"/>
<polygon fill="#ff0000" stroke="#ff0000" points="324.9944,-630.4529 334.2888,-625.3671 323.8515,-623.5468 324.9944,-630.4529"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge73" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M281.1486,-641.1859C435.9772,-635.479 859.1149,-626.3442 979.6978,-690.6445"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge118" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M228.0273,-632.4414C238.61,-603.6803 266.6228,-524.7153 281.2024,-456.6445 294.7104,-393.5769 275.6247,-217.9527 317.2024,-168.6445 402.2129,-67.8283 469.5139,-75.2839 601.1821,-82.6445"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge87" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M979.6978,-500.6445C1059.7403,-514.4667 1067.1086,-596.3578 1145.9073,-576.6445"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M243.1042,-632.4701C261.7034,-621.9382 290.8469,-606.1052 317.2024,-594.6445 403.4752,-557.1289 425.3525,-546.0337 516.9653,-524.6445 717.5074,-477.8233 776.766,-465.6013 979.6978,-500.6445"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#3cff00" stroke-dasharray="5,2" d="M278.6857,-309.7174C330.8609,-312.1063 411.4835,-316.8824 480.9653,-325.6445 501.855,-328.2789 524.6134,-332.1766 544.6528,-335.9625"/>
<polygon fill="#3cff00" stroke="#3cff00" points="544.0741,-339.4152 554.5549,-337.8651 545.395,-332.541 544.0741,-339.4152"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M274.9993,-318.7379C294.7941,-323.0302 317.6108,-327.9778 338.2375,-332.4505"/>
<polygon fill="#00ffff" stroke="#00ffff" points="337.6499,-335.9044 348.1645,-334.6031 339.1334,-329.0634 337.6499,-335.9044"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge111" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M601.1821,-188.6445C807.3461,-178.9999 868.294,-204.2058 1052.825,-296.6445 1070.948,-305.7231 1071.4074,-314.2767 1088.825,-324.6445 1094.6963,-328.1395 1101.1449,-331.4316 1107.5285,-334.4082"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1106.202,-337.6488 1116.7601,-338.5304 1109.0561,-331.2571 1106.202,-337.6488"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M227.2186,-296.6299C236.3799,-268.9462 264.6116,-196.6735 317.2024,-168.6445 428.86,-109.1351 474.9071,-180.6823 601.1821,-188.6445"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#3cff00" stroke-dasharray="5,2" d="M457.5391,-346.223C484.8289,-346.4931 517.192,-346.8134 544.2844,-347.0815"/>
<polygon fill="#3cff00" stroke="#3cff00" points="544.3541,-350.5822 554.3882,-347.1815 544.4234,-343.5826 544.3541,-350.5822"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge106" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M435.1696,-334.6118C506.88,-312.9022 665.2344,-266.0913 721.3989,-258.6445 787.1222,-249.9304 805.904,-244.0249 870.5706,-258.6445 922.9739,-270.4917 927.2344,-299.0657 979.6978,-310.6445"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M979.6978,-310.6445C1017.477,-318.2911 1059.7648,-328.2331 1092.2313,-336.1652"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1091.4298,-339.5723 1101.9759,-338.5576 1093.0988,-332.7742 1091.4298,-339.5723"/>
</g>
<!-- sourcefile~branchinputmanager.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge62" class="edge">
<title>sourcefile~branchinputmanager.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#00ff1e" stroke-dasharray="5,2" d="M1844.9605,-1674.3472C1853.529,-1673.0991 1862.1982,-1671.8364 1870.4308,-1670.6374"/>
<polygon fill="#00ff1e" stroke="#00ff1e" points="1871.1936,-1674.0633 1880.5847,-1669.1584 1870.1846,-1667.1364 1871.1936,-1674.0633"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge66" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#00ff1e" stroke-dasharray="5,2" d="M795.9847,-2216.6445C1192.3571,-2176.818 1312.4421,-2228.3123 1681.626,-2078.6445 1762.1638,-2045.9944 1794.7873,-2041.8359 1844.6287,-1970.6445 1877.7031,-1923.4024 1906.2713,-1746.4357 1915.3985,-1684.8959"/>
<polygon fill="#00ff1e" stroke="#00ff1e" points="1918.8902,-1685.2067 1916.8732,-1674.8057 1911.9638,-1684.1944 1918.8902,-1685.2067"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge162" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#3c00ff" stroke-dasharray="5,2" d="M795.9847,-2330.6445C1017.4672,-2391.9438 1077.6299,-2406.6445 1307.4386,-2406.6445 1307.4386,-2406.6445 1307.4386,-2406.6445 1469.339,-2406.6445 1564.2898,-2406.6445 1591.0304,-2411.0716 1681.626,-2382.6445 1738.703,-2364.7349 1858.7242,-2251.1233 1918.4414,-2254.6445"/>
<path fill="none" stroke="#3c00ff" stroke-dasharray="5,2" d="M601.1821,-2235.6445C694.9386,-2257.7434 702.4719,-2307.5365 795.9847,-2330.6445"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge177" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00b4" stroke-dasharray="5,2" d="M439.2359,-2177.0329C454.6998,-2173.8647 471.0203,-2167.434 480.9653,-2154.6445 532.7917,-2087.9952 498.8658,-1478.1098 516.9653,-1395.6445 532.768,-1323.6441 571.2167,-1244.4499 590.2031,-1208.028"/>
<polygon fill="#ff00b4" stroke="#ff00b4" points="593.4324,-1209.4081 595.0072,-1198.9309 587.2425,-1206.1392 593.4324,-1209.4081"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge55" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-2235.6445C685.8517,-2255.6016 709.9795,-2229.6955 795.9847,-2216.6445"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9847,-2216.6445C1140.6664,-2164.3403 1213.6569,-2084.9041 1526.7905,-1931.6445 1571.1597,-1909.9286 1576.7574,-1893.9947 1622.2083,-1874.6445"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M435.7408,-2190.7266C476.0628,-2202.6995 542.8875,-2221.9042 601.1821,-2235.6445"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1622.2083,-1874.6445C1700.5751,-1842.0303 1752.3619,-1746.7059 1772.129,-1704.3456"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1775.419,-1705.5652 1776.3625,-1695.0125 1769.0441,-1702.6736 1775.419,-1705.5652"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1029.0207,-1679.3367C1130.0118,-1666.9197 1364.4801,-1651.3617 1526.7905,-1744.6445 1588.9299,-1780.3572 1556.039,-1902.1824 1622.2083,-1874.6445"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge147" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#001dff" stroke-dasharray="5,2" d="M1508.1962,-1824.607C1515.1866,-1821.1102 1521.8195,-1816.5551 1526.7905,-1810.6445 1575.5863,-1752.6265 1609.9554,-1512.8444 1619.5154,-1439.2339"/>
<polygon fill="#001dff" stroke="#001dff" points="1623.0401,-1439.2627 1620.8351,-1428.8999 1616.0965,-1438.3759 1623.0401,-1439.2627"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge50" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1496.3668,-1846.6633C1533.8547,-1861.2432 1599.576,-1884.0635 1622.2083,-1874.6445"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge159" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#3c00ff" stroke-dasharray="5,2" d="M818.4374,-2133.6693C866.5849,-2156.6879 983.9195,-2209.4725 1088.825,-2230.6445 1321.4341,-2277.5899 1385.3626,-2239.9823 1622.2083,-2254.6445"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge51" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M843.2679,-2111.5725C920.0774,-2092.9532 1076.1412,-2052.4759 1202.9897,-2002.6445 1251.2555,-1983.6837 1259.0234,-1969.2204 1307.4386,-1950.6445"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M810.4416,-2111.4001C827.216,-2097.6222 854.608,-2072.746 870.5706,-2045.6445 939.2218,-1929.0875 968.3022,-1765.4092 976.8373,-1707.7469"/>
<polygon fill="#ff0000" stroke="#ff0000" points="980.3269,-1708.0678 978.276,-1697.6734 973.3972,-1707.0781 980.3269,-1708.0678"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge179" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00b4" stroke-dasharray="5,2" d="M402.3838,-625.7256C415.7038,-670.2435 467.1825,-840.2829 516.9653,-977.6445 542.4122,-1047.8582 576.5128,-1129.609 592.3776,-1167.0327"/>
<polygon fill="#ff00b4" stroke="#ff00b4" points="589.2123,-1168.5332 596.3464,-1176.3662 595.6541,-1165.794 589.2123,-1168.5332"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M403.0391,-625.8419C416.248,-663.683 459.2264,-790.4826 480.9653,-898.6445 494.5872,-966.4203 480.2195,-1149.0881 516.9653,-1207.6445 564.1061,-1282.7658 631.9375,-1243.882 685.3989,-1314.6445 719.2209,-1359.412 680.3329,-1397.4132 721.3989,-1435.6445 771.0971,-1481.9122 823.4527,-1419.7517 870.5706,-1468.6445 932.3329,-1532.7334 846.822,-1599.6742 906.5706,-1665.6445 910.6036,-1670.0976 915.512,-1673.6312 920.8574,-1676.4315"/>
<polygon fill="#ff0000" stroke="#ff0000" points="919.6219,-1679.7107 930.1884,-1680.4848 922.4109,-1673.2903 919.6219,-1679.7107"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge78" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-690.6445C1034.8115,-720.9544 1093.7529,-765.776 1124.474,-790.2081"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1122.3713,-793.0083 1132.3639,-796.5295 1126.7482,-787.5453 1122.3713,-793.0083"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M440.3905,-603.6009C524.3851,-583.2305 719.8967,-546.5274 870.5706,-600.6445 929.7376,-621.8954 924.6109,-660.3495 979.6978,-690.6445"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge124" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M601.1821,-538.6445C658.6353,-511.9526 648.416,-475.0798 685.3989,-423.6445 701.5958,-401.1181 696.7646,-385.4089 721.3989,-372.6445 753.6768,-355.9196 1273.8939,-394.61 1307.4386,-424.6445"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M421.7425,-603.5296C445.201,-592.2897 483.0932,-574.8759 516.9653,-562.6445 553.5717,-549.4258 565.533,-554.2618 601.1821,-538.6445"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge96" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M601.1821,-538.6445C639.3419,-520.4655 938.1121,-493.0766 979.6978,-500.6445"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge141" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#001dff" stroke-dasharray="5,2" d="M1307.4386,-1112.6445C1457.0059,-1190.0781 1425.2111,-1295.494 1562.7905,-1392.6445 1567.95,-1396.2879 1573.7224,-1399.5398 1579.5867,-1402.396"/>
<polygon fill="#001dff" stroke="#001dff" points="1578.2486,-1405.6319 1588.8029,-1406.5576 1581.1294,-1399.2522 1578.2486,-1405.6319"/>
<path fill="none" stroke="#001dff" stroke-dasharray="5,2" d="M1150.7097,-818.7306C1160.8096,-842.1737 1184.8155,-898.5728 1202.9897,-946.6445 1220.2872,-992.3971 1212.02,-1009.8386 1238.9897,-1050.6445 1261.6218,-1084.8875 1281.4616,-1080.8643 1307.4386,-1112.6445"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge117" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1158.7358,-818.9575C1184.856,-840.7535 1246.8807,-886.2929 1307.4386,-884.6445"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge86" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1151.8479,-796.3909C1175.8454,-750.9308 1265.824,-580.478 1296.8464,-521.71"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1300.0413,-523.1552 1301.6144,-512.6778 1293.8508,-519.8873 1300.0413,-523.1552"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge143" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#001dff" stroke-dasharray="5,2" d="M1472.8856,-895.6552C1482.8628,-927.0308 1511.4438,-1019.724 1526.7905,-1098.6445 1539.3547,-1163.2556 1523.1039,-1340.1334 1562.7905,-1392.6445 1565.2261,-1395.8671 1568.156,-1398.678 1571.3924,-1401.1291"/>
<polygon fill="#001dff" stroke="#001dff" points="1569.6318,-1404.1564 1579.9618,-1406.5107 1573.3547,-1398.2284 1569.6318,-1404.1564"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge146" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#001dff" stroke-dasharray="5,2" d="M979.6978,-1530.6445C1020.686,-1526.395 1022.3181,-1501.3469 1052.825,-1473.6445 1070.048,-1458.0048 1067.8721,-1445.7545 1088.825,-1435.6445 1176.6625,-1393.2623 1210.2759,-1408.2122 1307.4386,-1416.6445"/>
<path fill="none" stroke="#001dff" stroke-dasharray="5,2" d="M863.2763,-1426.7908C865.8359,-1428.2301 868.282,-1429.8414 870.5706,-1431.6445 899.6139,-1454.5267 878.7778,-1482.2586 906.5706,-1506.6445 932.2828,-1529.2049 945.6388,-1533.8189 979.6978,-1530.6445"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge148" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#001dff" stroke-dasharray="5,2" d="M1170.428,-1444.5305C1201.7538,-1431.5454 1257.8597,-1412.3418 1307.4386,-1416.6445"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge172" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00b4" stroke-dasharray="5,2" d="M428.9042,-1123.711C464.129,-1136.7832 522.8493,-1158.5747 561.7914,-1173.0264"/>
<polygon fill="#ff00b4" stroke="#ff00b4" points="560.6465,-1176.3347 571.2395,-1176.5326 563.082,-1169.772 560.6465,-1176.3347"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge119" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M463.359,-1106.1581C556.8905,-1094.8143 734.2086,-1066.0334 870.5706,-1000.6445 888.8476,-991.8802 888.1048,-981.0041 906.5706,-972.6445 936.7166,-958.9973 950.41,-974.0476 979.6978,-958.6445"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M979.6978,-958.6445C1009.4957,-943.1621 1024.2362,-957.26 1052.825,-939.6445 1073.4702,-926.9236 1068.0931,-911.2239 1088.825,-898.6445 1111.1573,-885.0941 1119.942,-887.4997 1145.9073,-884.6445"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge173" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00b4" stroke-dasharray="5,2" d="M443.5644,-1004.6169C456.4304,-1008.3526 469.9584,-1013.7838 480.9653,-1021.6445 535.5206,-1060.6062 574.8878,-1132.1289 591.8741,-1167.184"/>
<polygon fill="#ff00b4" stroke="#ff00b4" points="588.8071,-1168.8859 596.2432,-1176.4327 595.1364,-1165.8958 588.8071,-1168.8859"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge121" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1145.9073,-884.6445C1217.3128,-877.2079 1235.6735,-886.5979 1307.4386,-884.6445"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M443.5294,-999.6803C547.1352,-1005.9015 801.1495,-1015.9595 870.5706,-970.6445 900.1974,-951.3054 877.0164,-919.0946 906.5706,-899.6445 995.6007,-841.0522 1039.9001,-895.6848 1145.9073,-884.6445"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge126" class="edge">
<title>sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1312.1094,-512.6939C1334.4982,-565.6582 1430.9675,-793.871 1460.6286,-864.0387"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1457.5318,-865.7022 1464.6493,-873.5503 1463.9794,-862.9767 1457.5318,-865.7022"/>
</g>
<!-- sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge127" class="edge">
<title>sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M816.4588,-1098.5739C832.7638,-1088.9467 855.3077,-1073.7231 870.5706,-1055.6445 893.907,-1028.0031 879.2521,-1006.3584 906.5706,-982.6445 932.4024,-960.2212 949.4228,-974.5668 979.6978,-958.6445"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge129" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M438.3642,-45.725C487.7499,-59.3479 569.8566,-80.8933 601.1821,-82.6445"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge130" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1163.9982,-360.7182C1182.4322,-371.7217 1212.0601,-388.6433 1238.9897,-400.6445 1268.4356,-413.7671 1283.4213,-403.1404 1307.4386,-424.6445"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1307.4386,-424.6445C1336.9325,-451.0522 1355.123,-447.9385 1375.8875,-481.6445 1416.6459,-547.8057 1455.2707,-790.0601 1466.2471,-863.4396"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1462.7887,-863.979 1467.7154,-873.3586 1469.7132,-862.9539 1462.7887,-863.979"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge95" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1157.3047,-360.6762C1174.7856,-377.5657 1209.3123,-410.8039 1238.9897,-438.6445 1255.3349,-453.9781 1274.0719,-471.1992 1287.8052,-483.7562"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1285.5125,-486.4024 1295.2571,-490.5611 1290.2329,-481.2333 1285.5125,-486.4024"/>
</g>
<!-- sourcefile~dataroomair.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge90" class="edge">
<title>sourcefile~dataroomair.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M435.7077,-412.6171C506.31,-393.0242 665.7777,-356.8791 795.9847,-386.6445"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge112" class="edge">
<title>sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M445.0005,-218.6253C494.8758,-206.9617 571.4101,-190.0373 601.1821,-188.6445"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge116" class="edge">
<title>sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M481.2304,-190.3833C517.9493,-190.7124 561.7529,-190.4891 601.1821,-188.6445"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~EfferentGraph_edge168" class="edge">
<title>sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#f000ff" stroke-dasharray="5,2" d="M640.0307,-1404.6115C687.8894,-1391.5916 766.4786,-1372.2286 795.9847,-1376.6445"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefileplantpipingsystemmanagerf90EfferentGraph = svgPanZoom('#sourcefileplantpipingsystemmanagerf90EfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <h3>Files Dependent On This One</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~plantpipingsystemmanager.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefileplantpipingsystemmanagerf90AfferentGraph" width="641pt" height="46pt"
 viewBox="0.00 0.00 641.00 46.43" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~plantpipingsystemmanager.f90~~AfferentGraph" class="graph" transform="scale(.3753 .3753) rotate(0) translate(4 119.7261)">
<title>sourcefile~~plantpipingsystemmanager.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-119.7261 1704.1306,-119.7261 1704.1306,4 -4,4"/>
<!-- sourcefile~plantpipingsystemmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~plantpipingsystemmanager.f90</title>
<polygon fill="none" stroke="#000000" points="158.2625,-95.4815 .2453,-95.4815 .2453,-73.4707 158.2625,-73.4707 158.2625,-95.4815"/>
<text text-anchor="middle" x="79.2539" y="-81.3261" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">PlantPipingSystemManager.f90</text>
</g>
<!-- sourcefile~plantloopequipment.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~plantloopequipment.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~AfferentGraph_node2"><a xlink:href="../sourcefile/plantloopequipment.f90.html" xlink:title="PlantLoopEquipment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="321.5118,-95.4815 194.5065,-95.4815 194.5065,-73.4707 321.5118,-73.4707 321.5118,-95.4815"/>
<text text-anchor="middle" x="258.0092" y="-81.3261" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantLoopEquipment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantpipingsystemmanager.f90&#45;&gt;sourcefile~plantloopequipment.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~AfferentGraph_edge18" class="edge">
<title>sourcefile~plantpipingsystemmanager.f90&#45;&gt;sourcefile~plantloopequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M158.4392,-84.4761C167.0037,-84.4761 175.6948,-84.4761 184.1922,-84.4761"/>
<polygon fill="#ff0000" stroke="#ff0000" points="184.4397,-87.9762 194.4396,-84.4761 184.4396,-80.9762 184.4397,-87.9762"/>
</g>
<!-- sourcefile~plantmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~plantmanager.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~AfferentGraph_node3"><a xlink:href="../sourcefile/plantmanager.f90.html" xlink:title="PlantManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="593.9733,-95.4815 499.3458,-95.4815 499.3458,-73.4707 593.9733,-73.4707 593.9733,-95.4815"/>
<text text-anchor="middle" x="546.6595" y="-81.3261" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~AfferentGraph_edge16" class="edge">
<title>sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M321.7053,-85.2114C333.6047,-85.3217 345.9361,-85.4179 357.5105,-85.4761 404.6177,-85.7128 416.396,-85.7593 463.5029,-85.4761 471.7144,-85.4267 480.3817,-85.3499 488.897,-85.2603"/>
<polygon fill="#ff0000" stroke="#ff0000" points="489.2072,-88.7572 499.1675,-85.1457 489.129,-81.7576 489.2072,-88.7572"/>
</g>
<!-- sourcefile~plantloopsolver.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~plantloopsolver.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~AfferentGraph_node4"><a xlink:href="../sourcefile/plantloopsolver.f90.html" xlink:title="PlantLoopSolver.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.4991,-76.4815 357.5143,-76.4815 357.5143,-54.4707 463.4991,-54.4707 463.4991,-76.4815"/>
<text text-anchor="middle" x="410.5067" y="-62.3261" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantLoopSolver.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantloopsolver.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~AfferentGraph_edge17" class="edge">
<title>sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantloopsolver.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M321.7983,-76.5285C330.1539,-75.4874 338.7147,-74.4208 347.0645,-73.3805"/>
<polygon fill="#ff0000" stroke="#ff0000" points="347.6264,-76.8376 357.1169,-72.1281 346.7609,-69.8914 347.6264,-76.8376"/>
</g>
<!-- sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~simulationmanager.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~AfferentGraph_node5"><a xlink:href="../sourcefile/simulationmanager.f90.html" xlink:title="SimulationManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1567.7132,-75.4815 1447.9028,-75.4815 1447.9028,-53.4707 1567.7132,-53.4707 1567.7132,-75.4815"/>
<text text-anchor="middle" x="1507.808" y="-61.3261" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SimulationManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~plantmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1362.6163,-104.4761C1400.4168,-101.8848 1441.9464,-89.4098 1470.8706,-79.0712"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1472.3648,-82.2513 1480.549,-75.5231 1469.9553,-75.679 1472.3648,-82.2513"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M593.9955,-89.757C651.2829,-95.6824 750.7126,-104.4761 836.2635,-104.4761 836.2635,-104.4761 836.2635,-104.4761 1027.2773,-104.4761 1176.3169,-104.4761 1213.9257,-114.669 1362.6163,-104.4761"/>
</g>
<!-- sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~utilityroutines.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~AfferentGraph_node6"><a xlink:href="../sourcefile/utilityroutines.f90.html" xlink:title="UtilityRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1699.9415,-115.4815 1603.6993,-115.4815 1603.6993,-93.4707 1699.9415,-93.4707 1699.9415,-115.4815"/>
<text text-anchor="middle" x="1651.8204" y="-101.3261" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">UtilityRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~plantmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1362.6163,-104.4761C1442.4176,-98.2074 1534.9878,-99.7465 1593.473,-101.7999"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1593.5068,-105.3034 1603.6288,-102.1737 1593.7644,-98.3081 1593.5068,-105.3034"/>
</g>
<!-- sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~hvacmanager.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~AfferentGraph_node7"><a xlink:href="../sourcefile/hvacmanager.f90.html" xlink:title="HVACManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="728.4846,-76.4815 629.9265,-76.4815 629.9265,-54.4707 728.4846,-54.4707 728.4846,-76.4815"/>
<text text-anchor="middle" x="679.2056" y="-62.3261" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantmanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~AfferentGraph_edge14" class="edge">
<title>sourcefile~plantmanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M594.1373,-77.6703C602.4663,-76.4764 611.227,-75.2206 619.8309,-73.9873"/>
<polygon fill="#ff0000" stroke="#ff0000" points="620.4217,-77.4384 629.8238,-72.5548 619.4283,-70.5093 620.4217,-77.4384"/>
</g>
<!-- sourcefile~plantloopsolver.f90&#45;&gt;sourcefile~plantmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~AfferentGraph_edge15" class="edge">
<title>sourcefile~plantloopsolver.f90&#45;&gt;sourcefile~plantmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M463.5368,-72.8764C472.0162,-74.0597 480.8234,-75.2887 489.3958,-76.485"/>
<polygon fill="#00ffff" stroke="#00ffff" points="488.9298,-79.9538 499.3176,-77.8696 489.8973,-73.021 488.9298,-79.9538"/>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1547.5412,-75.5122C1564.4005,-80.1949 1584.2358,-85.7042 1602.0559,-90.6538"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1601.145,-94.0332 1611.7169,-93.3372 1603.0184,-87.2886 1601.145,-94.0332"/>
</g>
<!-- sourcefile~energyplus.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~energyplus.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~AfferentGraph_node8"><a xlink:href="../sourcefile/energyplus.f90.html" xlink:title="EnergyPlus.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1693.5289,-74.4815 1610.1119,-74.4815 1610.1119,-52.4707 1693.5289,-52.4707 1693.5289,-74.4815"/>
<text text-anchor="middle" x="1651.8204" y="-60.3261" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EnergyPlus.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1567.6311,-64.0607C1578.2957,-63.9866 1589.3275,-63.91 1599.7539,-63.8376"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1599.9669,-67.3363 1609.9424,-63.7669 1599.9183,-60.3365 1599.9669,-67.3363"/>
</g>
<!-- sourcefile~hvacmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~hvacmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M728.529,-64.1301C796.0184,-62.6281 920.9083,-61.0607 1027.2773,-66.4761"/>
</g>
<!-- sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~heatbalanceairmanager.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~AfferentGraph_node9"><a xlink:href="../sourcefile/heatbalanceairmanager.f90.html" xlink:title="HeatBalanceAirManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="908.1011,-38.4815 764.426,-38.4815 764.426,-16.4707 908.1011,-16.4707 908.1011,-38.4815"/>
<text text-anchor="middle" x="836.2635" y="-24.3261" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceAirManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacmanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~hvacmanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M725.0554,-54.3828C742.4736,-50.1685 762.5024,-45.3225 780.721,-40.9146"/>
<polygon fill="#0000ff" stroke="#0000ff" points="781.7317,-44.2711 790.6282,-38.5175 780.0855,-37.4674 781.7317,-44.2711"/>
</g>
<!-- sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M873.5272,-38.5558C911.7177,-49.0856 973.0243,-63.714 1027.2773,-66.4761"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1027.2773,-66.4761C1109.2145,-70.6476 1129.992,-61.3458 1211.8748,-66.4761"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~AfferentGraph_node10" class="node">
<title>sourcefile~heatbalancesurfacemanager.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~AfferentGraph_node10"><a xlink:href="../sourcefile/heatbalancesurfacemanager.f90.html" xlink:title="HeatBalanceSurfaceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1110.4681,-38.4815 944.0866,-38.4815 944.0866,-16.4707 1110.4681,-16.4707 1110.4681,-38.4815"/>
<text text-anchor="middle" x="1027.2773" y="-24.3261" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceSurfaceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M907.9335,-27.4761C916.3792,-27.4761 925.0906,-27.4761 933.7799,-27.4761"/>
<polygon fill="#ff0000" stroke="#ff0000" points="933.9529,-30.9762 943.9528,-27.4761 933.9528,-23.9762 933.9529,-30.9762"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1063.2603,-38.5545C1100.1451,-49.0832 1159.3748,-63.7109 1211.8748,-66.4761"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1211.8748,-66.4761C1289.1134,-70.5443 1377.8463,-69.1363 1437.8457,-67.2859"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1438.08,-70.7802 1447.9626,-66.9612 1437.8554,-63.7838 1438.08,-70.7802"/>
</g>
<!-- sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~AfferentGraph_node11" class="node">
<title>sourcefile~heatbalancemanager.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~AfferentGraph_node11"><a xlink:href="../sourcefile/heatbalancemanager.f90.html" xlink:title="HeatBalanceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1276.8801,-38.4815 1146.8694,-38.4815 1146.8694,-16.4707 1276.8801,-16.4707 1276.8801,-38.4815"/>
<text text-anchor="middle" x="1211.8748" y="-24.3261" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1110.665,-27.4761C1119.3866,-27.4761 1128.2153,-27.4761 1136.8357,-27.4761"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1136.8408,-30.9762 1146.8408,-27.4761 1136.8408,-23.9762 1136.8408,-30.9762"/>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1246.8909,-16.3906C1287.3778,-5.3016 1355.6871,8.0525 1412.1057,-7.4761 1440.113,-15.1848 1468.2024,-33.4716 1486.6349,-47.2689"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1484.5693,-50.0958 1494.6271,-53.4265 1488.8416,-44.5507 1484.5693,-50.0958"/>
</g>
<!-- sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~AfferentGraph_node12" class="node">
<title>sourcefile~sizingmanager.f90</title>
<g id="a_sourcefile~~plantpipingsystemmanager.f90~~AfferentGraph_node12"><a xlink:href="../sourcefile/sizingmanager.f90.html" xlink:title="SizingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1412.0951,-38.4815 1313.1376,-38.4815 1313.1376,-16.4707 1412.0951,-16.4707 1412.0951,-38.4815"/>
<text text-anchor="middle" x="1362.6163" y="-24.3261" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SizingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1277.1155,-27.4761C1285.6008,-27.4761 1294.2607,-27.4761 1302.6542,-27.4761"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1302.7307,-30.9762 1312.7307,-27.4761 1302.7306,-23.9762 1302.7307,-30.9762"/>
</g>
<!-- sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~plantpipingsystemmanager.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1406.1786,-38.5773C1421.4658,-42.473 1438.8095,-46.8928 1454.7863,-50.9643"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1453.9722,-54.3686 1464.5268,-53.4465 1455.7008,-47.5854 1453.9722,-54.3686"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefileplantpipingsystemmanagerf90AfferentGraph = svgPanZoom('#sourcefileplantpipingsystemmanagerf90AfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <br>

    <section class="visible-xs visible-sm hidden-md">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/plantpipingsystemsmanager.html">PlantPipingSystemsManager</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html#src">PlantPipingSystemManager.f90</a>
  </div>
</div>


    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">MODULE </span><span class="n">PlantPipingSystemsManager</span>
<a name="ln-2"></a>
<a name="ln-3"></a>          <span class="c">! Module containing the routines dealing with the PipingSystems</span>
<a name="ln-4"></a>
<a name="ln-5"></a>          <span class="c">! MODULE INFORMATION:</span>
<a name="ln-6"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-7"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-8"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10"></a>
<a name="ln-11"></a>          <span class="c">! PURPOSE OF THIS MODULE:</span>
<a name="ln-12"></a>          <span class="c">! Simulate all cases of plant &quot;piping systems&quot;</span>
<a name="ln-13"></a>          <span class="c">!      PipingSystem:Underground</span>
<a name="ln-14"></a>          <span class="c">!      PipingSystem:Generalized</span>
<a name="ln-15"></a>
<a name="ln-16"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-17"></a>          <span class="c">! A 3D mesh is established, with full 3D conduction being employed</span>
<a name="ln-18"></a>          <span class="c">! For ground simulation, moisture content and soil freezing is included</span>
<a name="ln-19"></a>          <span class="c">! The mesh can include any number of pipe circuits placed within the domain</span>
<a name="ln-20"></a>          <span class="c">! The mesh can interact with basement walls also</span>
<a name="ln-21"></a>
<a name="ln-22"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-23"></a>          <span class="c">! na</span>
<a name="ln-24"></a>
<a name="ln-25"></a>          <span class="c">! OTHER NOTES:</span>
<a name="ln-26"></a>          <span class="c">! na</span>
<a name="ln-27"></a>
<a name="ln-28"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-29"></a>    <span class="k">USE </span><span class="n">DataPrecisionGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">r64</span>
<a name="ln-30"></a>    <span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">ShowWarningError</span><span class="p">,</span> <span class="n">ShowSevereError</span><span class="p">,</span> <span class="n">ShowFatalError</span><span class="p">,</span> <span class="n">ShowContinueError</span>
<a name="ln-31"></a>    <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>          <span class="n">ONLY</span><span class="p">:</span> <span class="n">MaxNameLength</span><span class="p">,</span><span class="n">outputfiledebug</span>
<a name="ln-32"></a>    <span class="k">USE </span><span class="n">DataPlantPipingSystems</span>
<a name="ln-33"></a>
<a name="ln-34"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables</span>
<a name="ln-35"></a>
<a name="ln-36"></a>    <span class="k">PRIVATE</span> <span class="c">! Everything private unless explicitly made public</span>
<a name="ln-37"></a>
<a name="ln-38"></a>          <span class="c">! MODULE PARAMETER DEFINITIONS:</span>
<a name="ln-39"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ObjName_ug_GeneralDomain</span> <span class="o">=</span> <span class="s1">&#39;PipingSystem:Underground:Domain&#39;</span>
<a name="ln-40"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">objName_Circuit</span>          <span class="o">=</span> <span class="s1">&#39;PipingSystem:Underground:PipeCircuit&#39;</span>
<a name="ln-41"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">objName_Segment</span>          <span class="o">=</span> <span class="s1">&#39;PipingSystem:Underground:PipeSegment&#39;</span>
<a name="ln-42"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">objName_HorizTrench</span>      <span class="o">=</span> <span class="s1">&#39;GroundHeatExchanger:HorizontalTrench&#39;</span>
<a name="ln-43"></a>
<a name="ln-44"></a>          <span class="c">! MODULE INTERFACE DEFINITIONS:</span>
<a name="ln-45"></a>    <span class="k">INTERFACE </span><span class="n">IssueSevereInputFieldError</span>
<a name="ln-46"></a>      <span class="k">MODULE PROCEDURE </span><span class="n">IssueSevereAlphaInputFieldError</span>
<a name="ln-47"></a>      <span class="k">MODULE PROCEDURE </span><span class="n">IssueSevereRealInputFieldError</span>
<a name="ln-48"></a>    <span class="k">END INTERFACE</span>
<a name="ln-49"></a>
<a name="ln-50"></a><span class="k">    INTERFACE </span><span class="n">IsInRange</span>
<a name="ln-51"></a>      <span class="k">MODULE PROCEDURE </span><span class="n">Integer_IsInRange</span>
<a name="ln-52"></a>      <span class="k">MODULE PROCEDURE </span><span class="n">Real_IsInRange</span>
<a name="ln-53"></a>    <span class="k">END INTERFACE</span>
<a name="ln-54"></a>
<a name="ln-55"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-56"></a>    <span class="c">! na</span>
<a name="ln-57"></a>
<a name="ln-58"></a>          <span class="c">! MODULE VARIABLE DECLARATIONS:</span>
<a name="ln-59"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">NeighborFieldCells</span>
<a name="ln-60"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">NeighborBoundaryCells</span>
<a name="ln-61"></a>
<a name="ln-62"></a>
<a name="ln-63"></a>          <span class="c">! SUBROUTINE SPECIFICATIONS FOR MODULE:</span>
<a name="ln-64"></a>    <span class="c">! ************************************* !</span>
<a name="ln-65"></a>    <span class="c">! Driver/Manager Routines               !</span>
<a name="ln-66"></a>    <span class="c">! ************************************* !</span>
<a name="ln-67"></a>    <span class="c">!   Public Entry Point                  !</span>
<a name="ln-68"></a>    <span class="k">PUBLIC  </span><span class="n">SimPipingSystemCircuit</span>          <span class="c">!</span>
<a name="ln-69"></a>    <span class="c">!   Other Management                    !</span>
<a name="ln-70"></a>    <span class="k">PRIVATE </span><span class="n">GetPipingSystemsInput</span>           <span class="c">!</span>
<a name="ln-71"></a>    <span class="k">PRIVATE </span><span class="n">ReadGeneralDomainInputs</span>         <span class="c">!</span>
<a name="ln-72"></a>    <span class="k">PRIVATE </span><span class="n">ReadPipeCircuitInputs</span>           <span class="c">!</span>
<a name="ln-73"></a>    <span class="k">PRIVATE </span><span class="n">ReadPipeSegmentInputs</span>           <span class="c">!</span>
<a name="ln-74"></a>    <span class="k">PRIVATE </span><span class="n">InitPipingSystems</span>               <span class="c">!</span>
<a name="ln-75"></a>    <span class="k">PRIVATE </span><span class="n">UpdatePipingSystems</span>             <span class="c">!</span>
<a name="ln-76"></a>    <span class="c">!   Management/Input workers</span>
<a name="ln-77"></a>    <span class="k">PRIVATE </span><span class="n">IssueSevereAlphaInputFieldError</span> <span class="c">!</span>
<a name="ln-78"></a>    <span class="k">PRIVATE </span><span class="n">IssueSevereRealInputFieldError</span>  <span class="c">!</span>
<a name="ln-79"></a>    <span class="k">PRIVATE </span><span class="n">GetSurfaceCountForOSCM</span>          <span class="c">!</span>
<a name="ln-80"></a>    <span class="k">PRIVATE </span><span class="n">GetSurfaceIndecesForOSCM</span>        <span class="c">!</span>
<a name="ln-81"></a>    <span class="c">! ************************************* !</span>
<a name="ln-82"></a>    <span class="c">! ************************************* !</span>
<a name="ln-83"></a>
<a name="ln-84"></a>    <span class="c">! ******************************************** !</span>
<a name="ln-85"></a>    <span class="c">! Utility Routines                             !</span>
<a name="ln-86"></a>    <span class="c">! ******************************************** !</span>
<a name="ln-87"></a>    <span class="c">!   Useful numeric routines                    !</span>
<a name="ln-88"></a>    <span class="k">PRIVATE </span><span class="n">Integer_IsInRange</span>                      <span class="c">!</span>
<a name="ln-89"></a>    <span class="k">PRIVATE </span><span class="n">Real_IsInRange</span>                         <span class="c">!</span>
<a name="ln-90"></a>    <span class="k">PRIVATE </span><span class="n">Real_ConstrainTo</span>                       <span class="c">!</span>
<a name="ln-91"></a>    <span class="c">!   Extensions for data classes                !</span>
<a name="ln-92"></a>    <span class="k">PRIVATE </span><span class="n">CellType_IsFieldCell</span>                   <span class="c">!</span>
<a name="ln-93"></a>    <span class="k">PRIVATE </span><span class="n">MeshPartitionArray_Contains</span>            <span class="c">!</span>
<a name="ln-94"></a>    <span class="k">PRIVATE </span><span class="n">RadialCellInfo_XY_CrossSectArea</span>        <span class="c">!</span>
<a name="ln-95"></a>    <span class="k">PRIVATE </span><span class="n">DomainRectangle_Contains</span>               <span class="c">!</span>
<a name="ln-96"></a>    <span class="k">PRIVATE </span><span class="n">MeshPartition_SelectionSort</span>            <span class="c">!</span>
<a name="ln-97"></a>    <span class="k">PRIVATE </span><span class="n">MeshPartition_CompareByDimension</span>       <span class="c">!</span>
<a name="ln-98"></a>    <span class="k">PRIVATE </span><span class="n">BaseThermalPropertySet_Diffusivity</span>     <span class="c">!</span>
<a name="ln-99"></a>    <span class="k">PRIVATE </span><span class="n">RectangleF_Contains</span>                    <span class="c">!</span>
<a name="ln-100"></a>    <span class="k">PRIVATE </span><span class="n">RadialSizing_Thickness</span>                 <span class="c">!</span>
<a name="ln-101"></a>    <span class="k">PRIVATE </span><span class="n">PipeSegmentInfo_InitPipeCells</span>          <span class="c">!</span>
<a name="ln-102"></a>    <span class="k">PRIVATE </span><span class="n">PipeCircuitInfo_InitInOutCells</span>         <span class="c">!</span>
<a name="ln-103"></a>    <span class="c">!   Convergence checks                         !</span>
<a name="ln-104"></a>    <span class="k">PRIVATE </span><span class="n">IsConverged_CurrentToPrevIteration</span>     <span class="c">!</span>
<a name="ln-105"></a>    <span class="k">PRIVATE </span><span class="n">IsConverged_PipeCurrentToPrevIteration</span> <span class="c">!</span>
<a name="ln-106"></a>    <span class="c">!   Array shifting                             !</span>
<a name="ln-107"></a>    <span class="k">PRIVATE </span><span class="n">ShiftTemperaturesForNewTimeStep</span>        <span class="c">!</span>
<a name="ln-108"></a>    <span class="k">PRIVATE </span><span class="n">ShiftTemperaturesForNewIteration</span>       <span class="c">!</span>
<a name="ln-109"></a>    <span class="k">PRIVATE </span><span class="n">ShiftPipeTemperaturesForNewIteration</span>   <span class="c">!</span>
<a name="ln-110"></a>    <span class="c">!   Error checking                             !</span>
<a name="ln-111"></a>    <span class="k">PRIVATE </span><span class="n">CheckForOutOfRangeTemps</span>                <span class="c">!</span>
<a name="ln-112"></a>    <span class="c">!   Other utilities                            !</span>
<a name="ln-113"></a>    <span class="c">!   Cartesian cell property routines           !</span>
<a name="ln-114"></a>    <span class="k">PRIVATE </span><span class="n">Width</span>                                  <span class="c">!</span>
<a name="ln-115"></a>    <span class="k">PRIVATE </span><span class="n">Height</span>                                 <span class="c">!</span>
<a name="ln-116"></a>    <span class="k">PRIVATE </span><span class="n">Depth</span>                                  <span class="c">!</span>
<a name="ln-117"></a>    <span class="k">PRIVATE </span><span class="n">XNormalArea</span>                            <span class="c">!</span>
<a name="ln-118"></a>    <span class="k">PRIVATE </span><span class="n">YNormalArea</span>                            <span class="c">!</span>
<a name="ln-119"></a>    <span class="k">PRIVATE </span><span class="n">ZNormalArea</span>                            <span class="c">!</span>
<a name="ln-120"></a>    <span class="k">PRIVATE </span><span class="n">Volume</span>                                 <span class="c">!</span>
<a name="ln-121"></a>    <span class="k">PRIVATE </span><span class="n">XYRectangle</span>                            <span class="c">!</span>
<a name="ln-122"></a>    <span class="k">PRIVATE </span><span class="n">XZRectangle</span>                            <span class="c">!</span>
<a name="ln-123"></a>    <span class="k">PRIVATE </span><span class="n">YZRectangle</span>                            <span class="c">!</span>
<a name="ln-124"></a>    <span class="k">PRIVATE </span><span class="n">NormalArea</span>                             <span class="c">!</span>
<a name="ln-125"></a>    <span class="k">PRIVATE </span><span class="n">NeighborInformationArray_Value</span>         <span class="c">!</span>
<a name="ln-126"></a>    <span class="c">!   Class &quot;constructors&quot;                       !</span>
<a name="ln-127"></a>    <span class="k">PRIVATE </span><span class="n">CartesianPipeCellInformation_ctor</span>      <span class="c">!</span>
<a name="ln-128"></a>    <span class="k">PRIVATE </span><span class="n">RadialCellInformation_ctor</span>             <span class="c">!</span>
<a name="ln-129"></a>    <span class="k">PRIVATE </span><span class="n">FluidCellInformation_ctor</span>              <span class="c">!</span>
<a name="ln-130"></a>    <span class="c">! ******************************************** !</span>
<a name="ln-131"></a>    <span class="c">! ******************************************** !</span>
<a name="ln-132"></a>
<a name="ln-133"></a>    <span class="c">! ***************************************** !</span>
<a name="ln-134"></a>    <span class="c">! Simulation Algorithms                     !</span>
<a name="ln-135"></a>    <span class="c">! ***************************************** !</span>
<a name="ln-136"></a>    <span class="c">!   Mesh Development routines               !</span>
<a name="ln-137"></a>    <span class="k">PRIVATE </span><span class="n">DevelopMesh</span>                         <span class="c">!</span>
<a name="ln-138"></a>    <span class="k">PRIVATE </span><span class="n">CreatePartitionCenterList</span>           <span class="c">!</span>
<a name="ln-139"></a>    <span class="k">PRIVATE </span><span class="n">CreatePartitionRegionList</span>           <span class="c">!</span>
<a name="ln-140"></a>    <span class="k">PRIVATE </span><span class="n">CreateRegionListCount</span>               <span class="c">!</span>
<a name="ln-141"></a>    <span class="k">PRIVATE </span><span class="n">CreateRegionList</span>                    <span class="c">!</span>
<a name="ln-142"></a>    <span class="k">PRIVATE </span><span class="n">CreateBoundaryListCount</span>             <span class="c">!</span>
<a name="ln-143"></a>    <span class="k">PRIVATE </span><span class="n">CreateBoundaryList</span>                  <span class="c">!</span>
<a name="ln-144"></a>    <span class="k">PRIVATE </span><span class="n">CreateCellArray</span>                     <span class="c">!</span>
<a name="ln-145"></a>    <span class="k">PRIVATE </span><span class="n">SetupCellNeighbors</span>                  <span class="c">!</span>
<a name="ln-146"></a>    <span class="k">PRIVATE </span><span class="n">AddNeighborInformation</span>              <span class="c">!</span>
<a name="ln-147"></a>    <span class="k">PRIVATE </span><span class="n">SetupPipeCircuitInOutCells</span>          <span class="c">!</span>
<a name="ln-148"></a>    <span class="k">PRIVATE </span><span class="n">GetCellWidthsCount</span>                  <span class="c">!</span>
<a name="ln-149"></a>    <span class="k">PRIVATE </span><span class="n">GetCellWidths</span>                       <span class="c">!</span>
<a name="ln-150"></a>    <span class="c">!   Simulation algorithms                   !</span>
<a name="ln-151"></a>    <span class="k">PRIVATE </span><span class="n">PerformIterationLoop</span>                <span class="c">!</span>
<a name="ln-152"></a>    <span class="k">PRIVATE </span><span class="n">PerformTemperatureFieldUpdate</span>       <span class="c">!</span>
<a name="ln-153"></a>    <span class="k">PRIVATE </span><span class="n">EvaluateFieldCellTemperature</span>        <span class="c">!</span>
<a name="ln-154"></a>    <span class="k">PRIVATE </span><span class="n">EvaluateGroundSurfaceTemperature</span>    <span class="c">!</span>
<a name="ln-155"></a>    <span class="k">PRIVATE </span><span class="n">EvaluateAdiabaticSurfaceTemperature</span> <span class="c">!</span>
<a name="ln-156"></a>    <span class="k">PRIVATE </span><span class="n">EvaluateBasementCellTemperature</span>     <span class="c">!</span>
<a name="ln-157"></a>    <span class="k">PRIVATE </span><span class="n">GetBasementWallHeatFlux</span>             <span class="c">!</span>
<a name="ln-158"></a>    <span class="k">PRIVATE </span><span class="n">GetBasementFloorHeatFlux</span>            <span class="c">!</span>
<a name="ln-159"></a>    <span class="k">PRIVATE </span><span class="n">UpdateBasementSurfaceTemperatures</span>   <span class="c">!</span>
<a name="ln-160"></a>    <span class="k">PRIVATE </span><span class="n">GetAverageTempByType</span>                <span class="c">!</span>
<a name="ln-161"></a>    <span class="k">PRIVATE </span><span class="n">EvaluateFarfieldBoundaryTemperature</span> <span class="c">!</span>
<a name="ln-162"></a>    <span class="k">PRIVATE </span><span class="n">EvaluateFarfieldCharacteristics</span>     <span class="c">!</span>
<a name="ln-163"></a>    <span class="k">PRIVATE </span><span class="n">GetFarfieldTemp</span>                     <span class="c">!</span>
<a name="ln-164"></a>    <span class="k">PRIVATE </span><span class="n">PreparePipeCircuitSimulation</span>        <span class="c">!</span>
<a name="ln-165"></a>    <span class="k">PRIVATE </span><span class="n">PerformPipeCircuitSimulation</span>        <span class="c">!</span>
<a name="ln-166"></a>    <span class="k">PRIVATE </span><span class="n">PerformPipeCellSimulation</span>           <span class="c">!</span>
<a name="ln-167"></a>    <span class="k">PRIVATE </span><span class="n">SimulateRadialToCartesianInterface</span>  <span class="c">!</span>
<a name="ln-168"></a>    <span class="k">PRIVATE </span><span class="n">SimulateOuterMostRadialSoilSlice</span>    <span class="c">!</span>
<a name="ln-169"></a>    <span class="k">PRIVATE </span><span class="n">SimulateAllInteriorRadialSoilSlices</span> <span class="c">!</span>
<a name="ln-170"></a>    <span class="k">PRIVATE </span><span class="n">SimulateInnerMostRadialSoilSlice</span>    <span class="c">!</span>
<a name="ln-171"></a>    <span class="k">PRIVATE </span><span class="n">SimulateRadialInsulationCell</span>        <span class="c">!</span>
<a name="ln-172"></a>    <span class="k">PRIVATE </span><span class="n">SimulateRadialPipeCell</span>              <span class="c">!</span>
<a name="ln-173"></a>    <span class="k">PRIVATE </span><span class="n">SimulateFluidCell</span>                   <span class="c">!</span>
<a name="ln-174"></a>    <span class="k">PRIVATE </span><span class="n">DoOneTimeInitializations</span>            <span class="c">!</span>
<a name="ln-175"></a>    <span class="k">PRIVATE </span><span class="n">DoStartOfTimeSTepInitializations</span>    <span class="c">!</span>
<a name="ln-176"></a>    <span class="k">PRIVATE </span><span class="n">DoEndOfIterationOperations</span>          <span class="c">!</span>
<a name="ln-177"></a>    <span class="k">PRIVATE </span><span class="n">EvaluateSoilRhoCp</span>                   <span class="c">!</span>
<a name="ln-178"></a>    <span class="k">PRIVATE </span><span class="n">SetAdditionalNeighborData</span>           <span class="c">!</span>
<a name="ln-179"></a>    <span class="k">PRIVATE </span><span class="n">EvaluateNeighborCharacteristics</span>     <span class="c">!</span>
<a name="ln-180"></a>    <span class="k">PRIVATE </span><span class="n">EvaluateCellNeighborDirections</span>      <span class="c">!</span>
<a name="ln-181"></a>    <span class="c">! ***************************************** !</span>
<a name="ln-182"></a>    <span class="c">! ***************************************** !</span>
<a name="ln-183"></a>
<a name="ln-184"></a>    <span class="k">CONTAINS</span>
<a name="ln-185"></a>
<a name="ln-186"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-187"></a>
<a name="ln-188"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-189"></a><span class="k">SUBROUTINE </span><span class="n">SimPipingSystemCircuit</span><span class="p">(</span><span class="n">EquipName</span><span class="p">,</span> <span class="n">EqNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">InitLoopEquip</span><span class="p">)</span>
<a name="ln-190"></a>
<a name="ln-191"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-192"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-193"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-194"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-195"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-196"></a>
<a name="ln-197"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-198"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-199"></a>
<a name="ln-200"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-201"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-202"></a>
<a name="ln-203"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-204"></a>          <span class="c">! na</span>
<a name="ln-205"></a>
<a name="ln-206"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-207"></a>    <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>                  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-208"></a>    <span class="k">USE </span><span class="n">General</span><span class="p">,</span>                         <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-209"></a>
<a name="ln-210"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-211"></a>
<a name="ln-212"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-213"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">EquipName</span>        <span class="c">! name of the Pipe Heat Transfer.</span>
<a name="ln-214"></a>    <span class="kt">INTEGER</span><span class="p">,</span>          <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EqNum</span>            <span class="c">! index in local derived types for external calling</span>
<a name="ln-215"></a>    <span class="kt">LOGICAL</span><span class="p">,</span>          <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FirstHVACIteration</span>       <span class="c">! component number</span>
<a name="ln-216"></a>    <span class="kt">LOGICAL</span><span class="p">,</span>          <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">InitLoopEquip</span>
<a name="ln-217"></a>
<a name="ln-218"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-219"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RoutineName</span> <span class="o">=</span> <span class="s1">&#39;SimPipingSystems&#39;</span>
<a name="ln-220"></a>
<a name="ln-221"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-222"></a>    <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">SAVE</span>  <span class="kd">::</span> <span class="n">GetInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>  <span class="c">! First time, input is &quot;gotten&quot;</span>
<a name="ln-223"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CircuitNum</span>
<a name="ln-224"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DomainNum</span>
<a name="ln-225"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumOfPipeCircuits</span>
<a name="ln-226"></a>
<a name="ln-227"></a>    <span class="c">!Read input if necessary</span>
<a name="ln-228"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">GetInputFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-229"></a><span class="k">        CALL </span><span class="n">GetPipingSystemsInput</span><span class="p">()</span>
<a name="ln-230"></a>        <span class="n">GetInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-231"></a>    <span class="n">ENDIF</span>
<a name="ln-232"></a>
<a name="ln-233"></a>    <span class="c">!Look for circuit index</span>
<a name="ln-234"></a>    <span class="n">NumOfPipeCircuits</span> <span class="o">=</span> <span class="n">SIZE</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">)</span>
<a name="ln-235"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">EqNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-236"></a><span class="k">        </span><span class="n">CircuitNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">EquipName</span><span class="p">,</span><span class="n">PipingSystemCircuits</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumOfPipeCircuits</span><span class="p">)</span>
<a name="ln-237"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">CircuitNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-238"></a>            <span class="c">! Catch any bad names before crashing</span>
<a name="ln-239"></a>            <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;: Piping circuit requested not found=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">EquipName</span><span class="p">))</span>
<a name="ln-240"></a>        <span class="n">ENDIF</span>
<a name="ln-241"></a>        <span class="n">EqNum</span><span class="o">=</span><span class="n">CircuitNum</span>
<a name="ln-242"></a>    <span class="k">ELSE</span>
<a name="ln-243"></a><span class="k">        </span><span class="n">CircuitNum</span><span class="o">=</span><span class="n">EqNum</span>
<a name="ln-244"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">CircuitNum</span> <span class="o">&gt;</span> <span class="n">NumOfPipeCircuits</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">CircuitNum</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-245"></a><span class="k">            CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;:  Invalid component index passed=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-246"></a>                              <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-247"></a>                              <span class="s1">&#39;, Number of Units=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumOfPipeCircuits</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-248"></a>                              <span class="s1">&#39;, Entered Unit name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">EquipName</span><span class="p">))</span>
<a name="ln-249"></a>        <span class="n">ENDIF</span>
<a name="ln-250"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">CheckEquipName</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-251"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">EquipName</span> <span class="o">/=</span> <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-252"></a><span class="k">                CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;: Invalid component name passed=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-253"></a>                                <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-254"></a>                                <span class="s1">&#39;, Unit name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">EquipName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, stored Unit Name for that index=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-255"></a>                                <span class="nb">TRIM</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-256"></a>            <span class="n">ENDIF</span>
<a name="ln-257"></a>            <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">CheckEquipName</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-258"></a>        <span class="n">ENDIF</span>
<a name="ln-259"></a>    <span class="n">ENDIF</span>
<a name="ln-260"></a>
<a name="ln-261"></a>    <span class="c">!If we are just initializing data structures, then return</span>
<a name="ln-262"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">InitLoopEquip</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-263"></a>
<a name="ln-264"></a>    <span class="c">!Retrieve the parent domain index for this pipe circuit</span>
<a name="ln-265"></a>    <span class="n">DomainNum</span> <span class="o">=</span> <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">ParentDomainIndex</span>
<a name="ln-266"></a>
<a name="ln-267"></a>    <span class="c">!Do any initialization here</span>
<a name="ln-268"></a>    <span class="k">CALL </span><span class="n">InitPipingSystems</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">CircuitNum</span><span class="p">)</span>
<a name="ln-269"></a>
<a name="ln-270"></a>    <span class="c">!Update the temperature field</span>
<a name="ln-271"></a>    <span class="k">CALL </span><span class="n">PerformIterationLoop</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">CircuitNum</span><span class="p">)</span>
<a name="ln-272"></a>
<a name="ln-273"></a>    <span class="c">!Update outlet nodes, etc.</span>
<a name="ln-274"></a>    <span class="k">CALL </span><span class="n">UpdatePipingSystems</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">CircuitNum</span><span class="p">)</span>
<a name="ln-275"></a>
<a name="ln-276"></a>  <span class="k">RETURN</span>
<a name="ln-277"></a>
<a name="ln-278"></a><span class="k">END SUBROUTINE </span><span class="n">SimPipingSystemCircuit</span>
<a name="ln-279"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-280"></a>
<a name="ln-281"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-282"></a><span class="k">SUBROUTINE </span><span class="n">GetPipingSystemsInput</span>
<a name="ln-283"></a>
<a name="ln-284"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-285"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-286"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-287"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-288"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-289"></a>
<a name="ln-290"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-291"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-292"></a>
<a name="ln-293"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-294"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-295"></a>
<a name="ln-296"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-297"></a>          <span class="c">! na</span>
<a name="ln-298"></a>
<a name="ln-299"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-300"></a>    <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">FindItemInList</span><span class="p">,</span> <span class="n">SameString</span>
<a name="ln-301"></a>    <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>    <span class="n">ONLY</span> <span class="p">:</span> <span class="n">MaxNameLength</span>
<a name="ln-302"></a>    <span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">SetupOutputVariable</span>
<a name="ln-303"></a>    <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-304"></a>
<a name="ln-305"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-306"></a>
<a name="ln-307"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-308"></a>          <span class="c">! na</span>
<a name="ln-309"></a>
<a name="ln-310"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-311"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;GetPipingSystemsInput&#39;</span>
<a name="ln-312"></a>
<a name="ln-313"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-314"></a>          <span class="c">! na</span>
<a name="ln-315"></a>
<a name="ln-316"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-317"></a>          <span class="c">! na</span>
<a name="ln-318"></a>
<a name="ln-319"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-320"></a>    <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>  <span class="c">! Set to true if errors in input, fatal at end of routine</span>
<a name="ln-321"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">NumGeneralizedDomains</span>
<a name="ln-322"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">PipeCtr</span>
<a name="ln-323"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">CircuitCtr</span>
<a name="ln-324"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">CircuitIndex</span>
<a name="ln-325"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">ThisSegmentIndex</span>
<a name="ln-326"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">NumPipeCircuits</span>
<a name="ln-327"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">NumPipeSegmentsInInput</span>
<a name="ln-328"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">NumCircuitsInThisDomain</span>
<a name="ln-329"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">NumHorizontalTrenches</span>
<a name="ln-330"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">NumSegmentsInHorizontalTrenches</span>
<a name="ln-331"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">DomainNum</span>
<a name="ln-332"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">TotalNumDomains</span>
<a name="ln-333"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">TotalNumCircuits</span>
<a name="ln-334"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">TotalNumSegments</span>
<a name="ln-335"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">ThisCircuitPipeSegmentCounter</span>
<a name="ln-336"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisSegmentName</span>
<a name="ln-337"></a>    <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">InputPipeSegmentCounter</span>
<a name="ln-338"></a>
<a name="ln-339"></a>    <span class="c">!Read number of objects and allocate main data structures - first domains</span>
<a name="ln-340"></a>    <span class="n">NumGeneralizedDomains</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">ObjName_ug_GeneralDomain</span><span class="p">)</span>
<a name="ln-341"></a>    <span class="n">NumHorizontalTrenches</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">objName_HorizTrench</span><span class="p">)</span>
<a name="ln-342"></a>    <span class="n">TotalNumDomains</span> <span class="o">=</span> <span class="n">NumGeneralizedDomains</span> <span class="o">+</span> <span class="n">NumHorizontalTrenches</span>
<a name="ln-343"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">TotalNumDomains</span><span class="p">))</span>
<a name="ln-344"></a>
<a name="ln-345"></a>    <span class="c">! then circuits</span>
<a name="ln-346"></a>    <span class="n">NumPipeCircuits</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">ObjName_Circuit</span><span class="p">)</span>
<a name="ln-347"></a>    <span class="n">TotalNumCircuits</span> <span class="o">=</span> <span class="n">NumPipeCircuits</span> <span class="o">+</span> <span class="n">NumHorizontalTrenches</span>
<a name="ln-348"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">TotalNumCircuits</span><span class="p">))</span>
<a name="ln-349"></a>
<a name="ln-350"></a>    <span class="c">! then segments</span>
<a name="ln-351"></a>    <span class="n">NumPipeSegmentsInInput</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">objName_Segment</span><span class="p">)</span>
<a name="ln-352"></a>    <span class="n">NumSegmentsInHorizontalTrenches</span> <span class="o">=</span> <span class="n">GetNumSegmentsForHorizontalTrenches</span><span class="p">(</span><span class="n">NumHorizontalTrenches</span><span class="p">)</span>
<a name="ln-353"></a>    <span class="n">TotalNumSegments</span> <span class="o">=</span> <span class="n">NumPipeSegmentsInInput</span> <span class="o">+</span> <span class="n">NumSegmentsInHorizontalTrenches</span>
<a name="ln-354"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">TotalNumSegments</span><span class="p">))</span>
<a name="ln-355"></a>
<a name="ln-356"></a>    <span class="c">!Read in raw inputs, don&#39;t try to interpret dependencies yet</span>
<a name="ln-357"></a>    <span class="k">CALL </span><span class="n">ReadGeneralDomainInputs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">NumGeneralizedDomains</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-358"></a>    <span class="k">CALL </span><span class="n">ReadPipeCircuitInputs</span><span class="p">(</span><span class="n">NumPipeCircuits</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-359"></a>    <span class="k">CALL </span><span class="n">ReadPipeSegmentInputs</span><span class="p">(</span><span class="n">NumPipeSegmentsInInput</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-360"></a>    <span class="k">CALL </span><span class="n">ReadHorizontalTrenchInputs</span><span class="p">(</span><span class="n">NumGeneralizedDomains</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">NumPipeCircuits</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">NumPipeSegmentsInInput</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-361"></a>                                                                               <span class="n">NumHorizontalTrenches</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-362"></a>
<a name="ln-363"></a>    <span class="c">!Report errors that are purely input problems</span>
<a name="ln-364"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;: Preceding input errors cause program termination.&#39;</span><span class="p">)</span>
<a name="ln-365"></a>
<a name="ln-366"></a>    <span class="c">!Setup output variables</span>
<a name="ln-367"></a>    <span class="k">CALL </span><span class="n">SetupAllOutputVariables</span><span class="p">(</span><span class="n">TotalNumSegments</span><span class="p">,</span> <span class="n">TotalNumCircuits</span><span class="p">)</span>
<a name="ln-368"></a>
<a name="ln-369"></a>    <span class="c">!Validate CIRCUIT-SEGMENT cross references</span>
<a name="ln-370"></a>    <span class="k">DO </span><span class="n">CircuitCtr</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-371"></a>
<a name="ln-372"></a>        <span class="c">!validate circuit-segment name-to-index references</span>
<a name="ln-373"></a>        <span class="k">DO </span><span class="n">ThisCircuitPipeSegmentCounter</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitCtr</span><span class="p">)%</span><span class="n">PipeSegmentNames</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-374"></a>                                           <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitCtr</span><span class="p">)%</span><span class="n">PipeSegmentNames</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-375"></a>
<a name="ln-376"></a>            <span class="n">ThisSegmentName</span> <span class="o">=</span> <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitCtr</span><span class="p">)%</span><span class="n">PipeSegmentNames</span><span class="p">(</span><span class="n">ThisCircuitPipeSegmentCounter</span><span class="p">)</span>
<a name="ln-377"></a>            <span class="n">ThisSegmentIndex</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">ThisSegmentName</span><span class="p">,</span><span class="n">PipingSystemSegments</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotalNumSegments</span><span class="p">)</span>
<a name="ln-378"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ThisSegmentIndex</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-379"></a><span class="k">                </span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitCtr</span><span class="p">)%</span><span class="n">PipeSegmentIndeces</span><span class="p">(</span><span class="n">ThisCircuitPipeSegmentCounter</span><span class="p">)</span> <span class="o">=</span> <span class="n">ThisSegmentIndex</span>
<a name="ln-380"></a>                <span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">ThisSegmentIndex</span><span class="p">)%</span><span class="n">ParentCircuitIndex</span> <span class="o">=</span> <span class="n">CircuitCtr</span>
<a name="ln-381"></a>            <span class="k">ELSE</span>
<a name="ln-382"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;: Could not match a pipe segment for: &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-383"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">ObjName_Circuit</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitCtr</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-384"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;: Looking for: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">objName_Segment</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ThisSegmentName</span><span class="p">))</span>
<a name="ln-385"></a>                <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-386"></a>            <span class="k">END IF</span>
<a name="ln-387"></a>
<a name="ln-388"></a><span class="k">        END DO</span> <span class="c">!Segment loop</span>
<a name="ln-389"></a>
<a name="ln-390"></a>    <span class="k">END DO</span> <span class="c">!Circuit loop</span>
<a name="ln-391"></a>
<a name="ln-392"></a>    <span class="c">!Validate DOMAIN-CIRCUIT cross references</span>
<a name="ln-393"></a>    <span class="k">DO </span><span class="n">DomainNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotalNumDomains</span>
<a name="ln-394"></a>
<a name="ln-395"></a>        <span class="c">!Convenience</span>
<a name="ln-396"></a>        <span class="n">NumCircuitsInThisDomain</span> <span class="o">=</span> <span class="n">SIZE</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">CircuitNames</span><span class="p">)</span>
<a name="ln-397"></a>
<a name="ln-398"></a>        <span class="c">!validate pipe domain-circuit name-to-index references</span>
<a name="ln-399"></a>        <span class="k">DO </span><span class="n">CircuitCtr</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumCircuitsInThisDomain</span>
<a name="ln-400"></a>            <span class="n">CircuitIndex</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">CircuitNames</span><span class="p">(</span><span class="n">CircuitCtr</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-401"></a>                                          <span class="n">PipingSystemCircuits</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">SIZE</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">))</span>
<a name="ln-402"></a>            <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">CircuitIndeces</span><span class="p">(</span><span class="n">CircuitCtr</span><span class="p">)</span> <span class="o">=</span> <span class="n">CircuitIndex</span>
<a name="ln-403"></a>            <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitIndex</span><span class="p">)%</span><span class="n">ParentDomainIndex</span> <span class="o">=</span> <span class="n">DomainNum</span>
<a name="ln-404"></a>        <span class="k">END DO</span>
<a name="ln-405"></a>
<a name="ln-406"></a>        <span class="c">!correct segment locations for: INTERNAL DATA STRUCTURE Y VALUE MEASURED FROM BOTTOM OF DOMAIN,</span>
<a name="ln-407"></a>        <span class="c">!                               INPUT WAS MEASURED FROM GROUND SURFACE</span>
<a name="ln-408"></a>        <span class="k">DO </span><span class="n">CircuitCtr</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumCircuitsInThisDomain</span>
<a name="ln-409"></a>            <span class="n">CircuitIndex</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">CircuitIndeces</span><span class="p">(</span><span class="n">CircuitCtr</span><span class="p">)</span>
<a name="ln-410"></a>            <span class="k">DO </span><span class="n">PipeCtr</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitIndex</span><span class="p">)%</span><span class="n">PipeSegmentIndeces</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-411"></a>                         <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitIndex</span><span class="p">)%</span><span class="n">PipeSegmentIndeces</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-412"></a>                <span class="n">ThisSegmentIndex</span> <span class="o">=</span> <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitCtr</span><span class="p">)%</span><span class="n">PipeSegmentIndeces</span><span class="p">(</span><span class="n">PipeCtr</span><span class="p">)</span>
<a name="ln-413"></a>                <span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">ThisSegmentIndex</span><span class="p">)%</span><span class="n">PipeLocation</span><span class="p">%</span><span class="n">Y</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-414"></a>                       <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Extents</span><span class="p">%</span><span class="n">Ymax</span> <span class="o">-</span> <span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">ThisSegmentIndex</span><span class="p">)%</span><span class="n">PipeLocation</span><span class="p">%</span><span class="n">Y</span>
<a name="ln-415"></a>            <span class="k">END DO</span> <span class="c">!segment loop</span>
<a name="ln-416"></a>        <span class="k">END DO</span> <span class="c">!circuit loop</span>
<a name="ln-417"></a>
<a name="ln-418"></a>        <span class="c">!correct segment locations for: BASEMENT X SHIFT</span>
<a name="ln-419"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">HasBasement</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BasementZone</span><span class="p">%</span><span class="n">ShiftPipesByWidth</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-420"></a><span class="k">            DO </span><span class="n">CircuitCtr</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumCircuitsInThisDomain</span>
<a name="ln-421"></a>                <span class="n">CircuitIndex</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">CircuitIndeces</span><span class="p">(</span><span class="n">CircuitCtr</span><span class="p">)</span>
<a name="ln-422"></a>                <span class="k">DO </span><span class="n">PipeCtr</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitIndex</span><span class="p">)%</span><span class="n">PipeSegmentIndeces</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-423"></a>                             <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitIndex</span><span class="p">)%</span><span class="n">PipeSegmentIndeces</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-424"></a>                    <span class="n">ThisSegmentIndex</span> <span class="o">=</span> <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitCtr</span><span class="p">)%</span><span class="n">PipeSegmentIndeces</span><span class="p">(</span><span class="n">PipeCtr</span><span class="p">)</span>
<a name="ln-425"></a>                    <span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">ThisSegmentIndex</span><span class="p">)%</span><span class="n">PipeLocation</span><span class="p">%</span><span class="n">X</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-426"></a>                           <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BasementZone</span><span class="p">%</span><span class="n">Width</span> <span class="o">+</span> <span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">ThisSegmentIndex</span><span class="p">)%</span><span class="n">PipeLocation</span><span class="p">%</span><span class="n">X</span>
<a name="ln-427"></a>                <span class="k">END DO</span> <span class="c">!segment loop</span>
<a name="ln-428"></a>            <span class="k">END DO</span> <span class="c">!circuit loop</span>
<a name="ln-429"></a>        <span class="k">END IF</span>
<a name="ln-430"></a>
<a name="ln-431"></a>        <span class="c">!now we will have good values of pipe segment locations, we can validate them</span>
<a name="ln-432"></a>        <span class="k">DO </span><span class="n">CircuitCtr</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumCircuitsInThisDomain</span>
<a name="ln-433"></a>
<a name="ln-434"></a>            <span class="c">!retrieve the index</span>
<a name="ln-435"></a>            <span class="n">CircuitIndex</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">CircuitIndeces</span><span class="p">(</span><span class="n">CircuitCtr</span><span class="p">)</span>
<a name="ln-436"></a>
<a name="ln-437"></a>            <span class="c">!check to make sure it isn&#39;t outside the domain</span>
<a name="ln-438"></a>            <span class="k">DO </span><span class="n">PipeCtr</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitIndex</span><span class="p">)%</span><span class="n">PipeSegmentIndeces</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-439"></a>                         <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitIndex</span><span class="p">)%</span><span class="n">PipeSegmentIndeces</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-440"></a>                <span class="n">ThisSegmentIndex</span> <span class="o">=</span> <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitCtr</span><span class="p">)%</span><span class="n">PipeSegmentIndeces</span><span class="p">(</span><span class="n">PipeCtr</span><span class="p">)</span>
<a name="ln-441"></a>                <span class="k">IF</span> <span class="p">((</span><span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">ThisSegmentIndex</span><span class="p">)%</span><span class="n">PipeLocation</span><span class="p">%</span><span class="n">X</span> <span class="o">&gt;</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Extents</span><span class="p">%</span><span class="n">Xmax</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-442"></a>                    <span class="p">(</span><span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">ThisSegmentIndex</span><span class="p">)%</span><span class="n">PipeLocation</span><span class="p">%</span><span class="n">X</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-443"></a>                    <span class="p">(</span><span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">ThisSegmentIndex</span><span class="p">)%</span><span class="n">PipeLocation</span><span class="p">%</span><span class="n">Y</span> <span class="o">&gt;</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Extents</span><span class="p">%</span><span class="n">Ymax</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-444"></a>                    <span class="p">(</span><span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">ThisSegmentIndex</span><span class="p">)%</span><span class="n">PipeLocation</span><span class="p">%</span><span class="n">Y</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-445"></a><span class="k">                    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;PipingSystems::&#39;</span><span class="o">//</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;:A pipe was found to be outside of the domain extents&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-446"></a>                                                                 <span class="s1">&#39; after performing any corrections for basement or burial depth.&#39;</span><span class="p">)</span>
<a name="ln-447"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Pipe segment name:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">ThisSegmentIndex</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-448"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Corrected pipe location: (x,y)=(&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-449"></a>                                       <span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">ThisSegmentIndex</span><span class="p">)%</span><span class="n">PipeLocation</span><span class="p">%</span><span class="n">X</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-450"></a>                                       <span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">ThisSegmentIndex</span><span class="p">)%</span><span class="n">PipeLocation</span><span class="p">%</span><span class="n">Y</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">)</span>
<a name="ln-451"></a>                <span class="k">END IF</span>
<a name="ln-452"></a><span class="k">            END DO</span> <span class="c">!segment loop</span>
<a name="ln-453"></a>
<a name="ln-454"></a>        <span class="k">END DO</span> <span class="c">!circuit loop</span>
<a name="ln-455"></a>
<a name="ln-456"></a>    <span class="k">END DO</span> <span class="c">!domain loop</span>
<a name="ln-457"></a>
<a name="ln-458"></a>    <span class="c">!If we encountered any other errors that we couldn&#39;t handle separately than stop now</span>
<a name="ln-459"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-460"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="n">ObjName_ug_GeneralDomain</span><span class="o">//</span><span class="s1">&#39;: Errors found in input.&#39;</span><span class="p">)</span>
<a name="ln-461"></a>    <span class="n">ENDIF</span>
<a name="ln-462"></a>
<a name="ln-463"></a>  <span class="k">RETURN</span>
<a name="ln-464"></a>
<a name="ln-465"></a><span class="k">END SUBROUTINE </span><span class="n">GetPipingSystemsInput</span>
<a name="ln-466"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-467"></a>
<a name="ln-468"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-469"></a><span class="kt">INTEGER </span><span class="k">FUNCTION </span><span class="n">GetNumSegmentsForHorizontalTrenches</span><span class="p">(</span><span class="n">NumHorizontalTrenches</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">Total</span><span class="p">)</span>
<a name="ln-470"></a>
<a name="ln-471"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-472"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-473"></a>          <span class="c">!       DATE WRITTEN   September 2012</span>
<a name="ln-474"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-475"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-476"></a>
<a name="ln-477"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-478"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-479"></a>
<a name="ln-480"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-481"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-482"></a>
<a name="ln-483"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-484"></a>          <span class="c">! na</span>
<a name="ln-485"></a>
<a name="ln-486"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-487"></a>    <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetObjectItem</span>
<a name="ln-488"></a>    <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-489"></a>
<a name="ln-490"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-491"></a>
<a name="ln-492"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-493"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NumHorizontalTrenches</span>
<a name="ln-494"></a>
<a name="ln-495"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-496"></a>          <span class="c">! na</span>
<a name="ln-497"></a>
<a name="ln-498"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-499"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HorizontalCtr</span>
<a name="ln-500"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumPipesInThisHorizontal</span>
<a name="ln-501"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumAlphas</span><span class="p">,</span> <span class="n">NumNumbers</span>
<a name="ln-502"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IOStatus</span>
<a name="ln-503"></a>
<a name="ln-504"></a>    <span class="n">Total</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-505"></a>
<a name="ln-506"></a>    <span class="k">DO </span><span class="n">HorizontalCtr</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumHorizontalTrenches</span>
<a name="ln-507"></a>
<a name="ln-508"></a>        <span class="c">!Set up all the inputs for this domain object</span>
<a name="ln-509"></a>        <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">objName_HorizTrench</span><span class="p">,</span><span class="n">HorizontalCtr</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-510"></a>                             <span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">IOStatus</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-511"></a>                             <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-512"></a>                             <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-513"></a>
<a name="ln-514"></a>        <span class="n">NumPipesInThisHorizontal</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-515"></a>
<a name="ln-516"></a>        <span class="n">Total</span> <span class="o">=</span> <span class="n">Total</span> <span class="o">+</span> <span class="n">NumPipesInThisHorizontal</span>
<a name="ln-517"></a>
<a name="ln-518"></a>    <span class="k">END DO</span>
<a name="ln-519"></a>
<a name="ln-520"></a><span class="k">  RETURN</span>
<a name="ln-521"></a>
<a name="ln-522"></a><span class="k">END FUNCTION</span>
<a name="ln-523"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-524"></a>
<a name="ln-525"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-526"></a><span class="k">SUBROUTINE </span><span class="n">ReadGeneralDomainInputs</span><span class="p">(</span><span class="n">IndexStart</span><span class="p">,</span> <span class="n">NumGeneralizedDomains</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-527"></a>
<a name="ln-528"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-529"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-530"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-531"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-532"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-533"></a>
<a name="ln-534"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-535"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-536"></a>
<a name="ln-537"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-538"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-539"></a>
<a name="ln-540"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-541"></a>          <span class="c">! na</span>
<a name="ln-542"></a>
<a name="ln-543"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-544"></a>    <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">FindItemInList</span><span class="p">,</span> <span class="n">SameString</span><span class="p">,</span> <span class="n">VerifyName</span><span class="p">,</span> <span class="n">MakeUPPERCase</span>
<a name="ln-545"></a>    <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-546"></a>    <span class="k">USE </span><span class="n">DataSurfaces</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">Surface</span><span class="p">,</span> <span class="n">OSCM</span><span class="p">,</span> <span class="n">TotOSCM</span><span class="p">,</span> <span class="n">TotSurfaces</span><span class="p">,</span> <span class="n">OtherSideCondModeledExt</span> <span class="c">!not sure if we need all these...</span>
<a name="ln-547"></a>    <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-548"></a>    <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SecsInDay</span>
<a name="ln-549"></a>
<a name="ln-550"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-551"></a>
<a name="ln-552"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-553"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">IndexStart</span>
<a name="ln-554"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">NumGeneralizedDomains</span>
<a name="ln-555"></a>    <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span> <span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrorsFound</span>
<a name="ln-556"></a>
<a name="ln-557"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-558"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;ReadGeneralDomainInputs&#39;</span>
<a name="ln-559"></a>
<a name="ln-560"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-561"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DomainNum</span>    <span class="c">! Item to be &quot;gotten&quot;</span>
<a name="ln-562"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumAlphas</span>  <span class="c">! Number of Alphas for each GetObjectItem call</span>
<a name="ln-563"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumNumbers</span> <span class="c">! Number of Numbers for each GetObjectItem call</span>
<a name="ln-564"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IOStatus</span>   <span class="c">! Used in GetObjectItem</span>
<a name="ln-565"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumCircuitsInThisDomain</span>
<a name="ln-566"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CircuitCtr</span>
<a name="ln-567"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">BasementInputError</span>
<a name="ln-568"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumSurfacesWithThisOSCM</span>
<a name="ln-569"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumAlphasBeforePipeCircOne</span>
<a name="ln-570"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CurIndex</span>
<a name="ln-571"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">IsBlank</span>
<a name="ln-572"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">IsNotOK</span>
<a name="ln-573"></a>
<a name="ln-574"></a>
<a name="ln-575"></a>    <span class="k">DO </span><span class="n">DomainNum</span> <span class="o">=</span> <span class="n">IndexStart</span><span class="p">,</span> <span class="n">NumGeneralizedDomains</span>
<a name="ln-576"></a>
<a name="ln-577"></a>        <span class="c">!Set up all the inputs for this domain object</span>
<a name="ln-578"></a>        <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">ObjName_ug_GeneralDomain</span><span class="p">,</span><span class="n">DomainNum</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-579"></a>                             <span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">IOStatus</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-580"></a>                             <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-581"></a>                             <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-582"></a>
<a name="ln-583"></a>        <span class="c">!Get the name, validate</span>
<a name="ln-584"></a>        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-585"></a>        <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-586"></a>        <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-587"></a>        <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">PipingSystemDomains</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">DomainNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ObjName_ug_GeneralDomain</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-588"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-589"></a><span class="k">            </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-590"></a>            <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;Duplicate name encountered&#39;</span>
<a name="ln-591"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-592"></a><span class="k">            </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-593"></a>            <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;Blank name encountered&#39;</span>
<a name="ln-594"></a>        <span class="n">ENDIF</span>
<a name="ln-595"></a>
<a name="ln-596"></a>        <span class="c">!Mesh extents, validated by IP</span>
<a name="ln-597"></a>        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Extents</span><span class="p">%</span><span class="n">Xmax</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-598"></a>        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Extents</span><span class="p">%</span><span class="n">Ymax</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-599"></a>        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Extents</span><span class="p">%</span><span class="n">Zmax</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-600"></a>
<a name="ln-601"></a>        <span class="c">!X direction mesh inputs, validated by IP</span>
<a name="ln-602"></a>        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Mesh</span><span class="p">%</span><span class="n">X</span><span class="p">%</span><span class="n">RegionMeshCount</span>  <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-603"></a>        <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">MakeUPPERCase</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-604"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;UNIFORM&#39;</span><span class="p">)</span>
<a name="ln-605"></a>            <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Mesh</span><span class="p">%</span><span class="n">X</span><span class="p">%</span><span class="n">MeshDistribution</span> <span class="o">=</span> <span class="n">MeshDistribution_Uniform</span>
<a name="ln-606"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;SYMMETRICGEOMETRIC&#39;</span><span class="p">)</span>
<a name="ln-607"></a>            <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Mesh</span><span class="p">%</span><span class="n">X</span><span class="p">%</span><span class="n">MeshDistribution</span> <span class="o">=</span> <span class="n">MeshDistribution_SymmetricGeometric</span>
<a name="ln-608"></a>            <span class="k">IF</span> <span class="p">(</span><span class="nb">MOD</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Mesh</span><span class="p">%</span><span class="n">X</span><span class="p">%</span><span class="n">RegionMeshCount</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-609"></a><span class="k">                CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;PipingSystems:&#39;</span><span class="o">//</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;: Invalid mesh type-count combination.&#39;</span><span class="p">)</span>
<a name="ln-610"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Instance:&#39;</span><span class="o">//</span><span class="n">ObjName_ug_GeneralDomain</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-611"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;An ODD-valued X mesh count was found in the input for symmetric geometric configuration.&#39;</span><span class="p">)</span>
<a name="ln-612"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This is invalid, mesh count incremented UP by one to next EVEN value.&#39;</span><span class="p">)</span>
<a name="ln-613"></a>                <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Mesh</span><span class="p">%</span><span class="n">X</span><span class="p">%</span><span class="n">RegionMeshCount</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Mesh</span><span class="p">%</span><span class="n">X</span><span class="p">%</span><span class="n">RegionMeshCount</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-614"></a>                <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Mesh</span><span class="p">%</span><span class="n">X</span><span class="p">%</span><span class="n">GeometricSeriesCoefficient</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-615"></a>            <span class="k">ELSE</span>
<a name="ln-616"></a><span class="k">                </span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Mesh</span><span class="p">%</span><span class="n">X</span><span class="p">%</span><span class="n">GeometricSeriesCoefficient</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-617"></a>            <span class="k">END IF</span>
<a name="ln-618"></a><span class="k">        CASE </span><span class="n">DEFAULT</span>
<a name="ln-619"></a>            <span class="k">CALL </span><span class="n">IssueSevereInputFieldError</span><span class="p">(</span><span class="n">RoutineName</span><span class="p">,</span> <span class="n">ObjName_ug_GeneralDomain</span><span class="p">,</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-620"></a>                                            <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;Use a choice from the available mesh type keys.&#39;</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-621"></a>        <span class="k">END SELECT</span>
<a name="ln-622"></a>
<a name="ln-623"></a>        <span class="c">!Y direction mesh inputs, validated by IP</span>
<a name="ln-624"></a>        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Mesh</span><span class="p">%</span><span class="n">Y</span><span class="p">%</span><span class="n">RegionMeshCount</span>  <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-625"></a>        <span class="k">SELECT CASE</span> <span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))))</span>
<a name="ln-626"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;UNIFORM&#39;</span><span class="p">)</span>
<a name="ln-627"></a>            <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Mesh</span><span class="p">%</span><span class="n">Y</span><span class="p">%</span><span class="n">MeshDistribution</span> <span class="o">=</span> <span class="n">MeshDistribution_Uniform</span>
<a name="ln-628"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;SYMMETRICGEOMETRIC&#39;</span><span class="p">)</span>
<a name="ln-629"></a>            <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Mesh</span><span class="p">%</span><span class="n">Y</span><span class="p">%</span><span class="n">MeshDistribution</span> <span class="o">=</span> <span class="n">MeshDistribution_SymmetricGeometric</span>
<a name="ln-630"></a>            <span class="k">IF</span> <span class="p">(</span><span class="nb">MOD</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Mesh</span><span class="p">%</span><span class="n">Y</span><span class="p">%</span><span class="n">RegionMeshCount</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-631"></a><span class="k">                CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;PipingSystems:&#39;</span><span class="o">//</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;: Invalid mesh type-count combination.&#39;</span><span class="p">)</span>
<a name="ln-632"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Instance:&#39;</span><span class="o">//</span><span class="n">ObjName_ug_GeneralDomain</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-633"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;An ODD-valued Y mesh count was found in the input for symmetric geometric configuration.&#39;</span><span class="p">)</span>
<a name="ln-634"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This is invalid, mesh count incremented UP by one to next EVEN value.&#39;</span><span class="p">)</span>
<a name="ln-635"></a>                <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Mesh</span><span class="p">%</span><span class="n">Y</span><span class="p">%</span><span class="n">RegionMeshCount</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Mesh</span><span class="p">%</span><span class="n">Y</span><span class="p">%</span><span class="n">RegionMeshCount</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-636"></a>                <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Mesh</span><span class="p">%</span><span class="n">Y</span><span class="p">%</span><span class="n">GeometricSeriesCoefficient</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-637"></a>            <span class="k">ELSE</span>
<a name="ln-638"></a><span class="k">                </span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Mesh</span><span class="p">%</span><span class="n">Y</span><span class="p">%</span><span class="n">GeometricSeriesCoefficient</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-639"></a>            <span class="k">END IF</span>
<a name="ln-640"></a><span class="k">        CASE </span><span class="n">DEFAULT</span>
<a name="ln-641"></a>            <span class="k">CALL </span><span class="n">IssueSevereInputFieldError</span><span class="p">(</span><span class="n">RoutineName</span><span class="p">,</span> <span class="n">ObjName_ug_GeneralDomain</span><span class="p">,</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-642"></a>                                            <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;Use a choice from the available mesh type keys.&#39;</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-643"></a>        <span class="k">END SELECT</span>
<a name="ln-644"></a>
<a name="ln-645"></a>        <span class="c">!Z direction mesh inputs, validated by IP</span>
<a name="ln-646"></a>        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Mesh</span><span class="p">%</span><span class="n">Z</span><span class="p">%</span><span class="n">RegionMeshCount</span>  <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-647"></a>        <span class="k">SELECT CASE</span> <span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))))</span>
<a name="ln-648"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;UNIFORM&#39;</span><span class="p">)</span>
<a name="ln-649"></a>            <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Mesh</span><span class="p">%</span><span class="n">Z</span><span class="p">%</span><span class="n">MeshDistribution</span> <span class="o">=</span> <span class="n">MeshDistribution_Uniform</span>
<a name="ln-650"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;SYMMETRICGEOMETRIC&#39;</span><span class="p">)</span>
<a name="ln-651"></a>            <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Mesh</span><span class="p">%</span><span class="n">Z</span><span class="p">%</span><span class="n">MeshDistribution</span> <span class="o">=</span> <span class="n">MeshDistribution_SymmetricGeometric</span>
<a name="ln-652"></a>            <span class="k">IF</span> <span class="p">(</span><span class="nb">MOD</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Mesh</span><span class="p">%</span><span class="n">Z</span><span class="p">%</span><span class="n">RegionMeshCount</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-653"></a><span class="k">                CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;PipingSystems:&#39;</span><span class="o">//</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;: Invalid mesh type-count combination.&#39;</span><span class="p">)</span>
<a name="ln-654"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Instance:&#39;</span><span class="o">//</span><span class="n">ObjName_ug_GeneralDomain</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-655"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;An ODD-valued Z mesh count was found in the input for symmetric geometric configuration.&#39;</span><span class="p">)</span>
<a name="ln-656"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This is invalid, mesh count incremented UP by one to next EVEN value.&#39;</span><span class="p">)</span>
<a name="ln-657"></a>                <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Mesh</span><span class="p">%</span><span class="n">Z</span><span class="p">%</span><span class="n">RegionMeshCount</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Mesh</span><span class="p">%</span><span class="n">Z</span><span class="p">%</span><span class="n">RegionMeshCount</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-658"></a>                <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Mesh</span><span class="p">%</span><span class="n">Z</span><span class="p">%</span><span class="n">GeometricSeriesCoefficient</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-659"></a>            <span class="k">ELSE</span>
<a name="ln-660"></a><span class="k">                </span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Mesh</span><span class="p">%</span><span class="n">Z</span><span class="p">%</span><span class="n">GeometricSeriesCoefficient</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-661"></a>            <span class="k">END IF</span>
<a name="ln-662"></a><span class="k">        CASE </span><span class="n">DEFAULT</span>
<a name="ln-663"></a>            <span class="k">CALL </span><span class="n">IssueSevereInputFieldError</span><span class="p">(</span><span class="n">RoutineName</span><span class="p">,</span> <span class="n">ObjName_ug_GeneralDomain</span><span class="p">,</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-664"></a>                                            <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="s1">&#39;Use a choice from the available mesh type keys.&#39;</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-665"></a>        <span class="k">END SELECT</span>
<a name="ln-666"></a>
<a name="ln-667"></a>        <span class="c">!Soil properties, validated min/max by IP</span>
<a name="ln-668"></a>        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">GroundProperties</span><span class="p">%</span><span class="n">Conductivity</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-669"></a>        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">GroundProperties</span><span class="p">%</span><span class="n">Density</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-670"></a>        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">GroundProperties</span><span class="p">%</span><span class="n">SpecificHeat</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-671"></a>
<a name="ln-672"></a>        <span class="c">!Moisture properties, validated min/max by IP, and converted to a fraction for computation here</span>
<a name="ln-673"></a>        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Moisture</span><span class="p">%</span><span class="n">Theta_Liq</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10</span><span class="mf">0.0d0</span>
<a name="ln-674"></a>        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Moisture</span><span class="p">%</span><span class="n">Theta_Sat</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10</span><span class="mf">0.0d0</span>
<a name="ln-675"></a>
<a name="ln-676"></a>        <span class="c">!Farfield model parameters, validated min/max by IP</span>
<a name="ln-677"></a>        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Farfield</span><span class="p">%</span><span class="n">AverageGroundTemperature</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<a name="ln-678"></a>        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Farfield</span><span class="p">%</span><span class="n">AverageGroundTemperatureAmplitude</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<a name="ln-679"></a>        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Farfield</span><span class="p">%</span><span class="n">PhaseShiftOfMinGroundTempDays</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<a name="ln-680"></a>
<a name="ln-681"></a>        <span class="c">!Unit conversion</span>
<a name="ln-682"></a>        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Farfield</span><span class="p">%</span><span class="n">PhaseShiftOfMinGroundTemp</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-683"></a>                    <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Farfield</span><span class="p">%</span><span class="n">PhaseShiftOfMinGroundTempDays</span> <span class="o">*</span> <span class="n">SecsInDay</span>
<a name="ln-684"></a>
<a name="ln-685"></a>        <span class="c">!check if there is a basement</span>
<a name="ln-686"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="s1">&#39;YES&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-687"></a><span class="k">            </span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">HasBasement</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-688"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="s1">&#39;NO&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-689"></a><span class="k">            </span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">HasBasement</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-690"></a>        <span class="k">ELSE</span>
<a name="ln-691"></a><span class="k">            CALL </span><span class="n">IssueSevereInputFieldError</span><span class="p">(</span><span class="n">RoutineName</span><span class="p">,</span> <span class="n">ObjName_ug_GeneralDomain</span><span class="p">,</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-692"></a>                                            <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="s1">&#39;Must enter either yes or no.&#39;</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-693"></a>        <span class="k">END IF</span>
<a name="ln-694"></a>
<a name="ln-695"></a>        <span class="c">!more work to do if there is a basement</span>
<a name="ln-696"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">HasBasement</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-697"></a>
<a name="ln-698"></a>            <span class="c">! check if there are blank inputs related to the basement,</span>
<a name="ln-699"></a>            <span class="c">! IP can&#39;t catch this because they are inherently optional if there ISN&#39;T a basement</span>
<a name="ln-700"></a>            <span class="k">IF</span> <span class="p">(</span>       <span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-701"></a>                  <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-702"></a>                  <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>    <span class="p">&amp;</span>
<a name="ln-703"></a>                  <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>    <span class="p">&amp;</span>
<a name="ln-704"></a>                  <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>    <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-705"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Erroneous basement inputs for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ObjName_ug_GeneralDomain</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-706"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Object specified to have a basement, while at least one basement input was left blank.&#39;</span><span class="p">)</span>
<a name="ln-707"></a>                <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-708"></a>            <span class="k">END IF</span>
<a name="ln-709"></a>
<a name="ln-710"></a>            <span class="c">! get dimensions for meshing</span>
<a name="ln-711"></a>            <span class="n">CurIndex</span> <span class="o">=</span> <span class="mi">18</span>
<a name="ln-712"></a>            <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BasementZone</span><span class="p">%</span><span class="n">Width</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="n">CurIndex</span><span class="p">)</span>
<a name="ln-713"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BasementZone</span><span class="p">%</span><span class="n">Width</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-714"></a><span class="k">                CALL </span><span class="n">IssueSevereInputFieldError</span><span class="p">(</span><span class="n">RoutineName</span><span class="p">,</span><span class="n">ObjName_ug_GeneralDomain</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="n">CurIndex</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-715"></a>                                           <span class="n">rNumericArgs</span><span class="p">(</span><span class="n">CurIndex</span><span class="p">),</span> <span class="s1">&#39;Basement width must be a positive nonzero value.&#39;</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-716"></a>            <span class="k">END IF</span>
<a name="ln-717"></a>
<a name="ln-718"></a><span class="k">            </span><span class="n">CurIndex</span> <span class="o">=</span> <span class="mi">19</span>
<a name="ln-719"></a>            <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BasementZone</span><span class="p">%</span><span class="n">Depth</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="n">CurIndex</span><span class="p">)</span>
<a name="ln-720"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BasementZone</span><span class="p">%</span><span class="n">Depth</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-721"></a><span class="k">                CALL </span><span class="n">IssueSevereInputFieldError</span><span class="p">(</span><span class="n">RoutineName</span><span class="p">,</span><span class="n">ObjName_ug_GeneralDomain</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="n">CurIndex</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-722"></a>                                           <span class="n">rNumericArgs</span><span class="p">(</span><span class="n">CurIndex</span><span class="p">),</span> <span class="s1">&#39;Basement depth must be a positive nonzero value.&#39;</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-723"></a>            <span class="k">END IF</span>
<a name="ln-724"></a>
<a name="ln-725"></a>            <span class="c">! check for dimension shift</span>
<a name="ln-726"></a>            <span class="n">CurIndex</span> <span class="o">=</span> <span class="mi">6</span>
<a name="ln-727"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">CurIndex</span><span class="p">),</span> <span class="s1">&#39;YES&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-728"></a><span class="k">                </span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BasementZone</span><span class="p">%</span><span class="n">ShiftPipesByWidth</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-729"></a>            <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">CurIndex</span><span class="p">),</span> <span class="s1">&#39;NO&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-730"></a><span class="k">                </span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BasementZone</span><span class="p">%</span><span class="n">ShiftPipesByWidth</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-731"></a>            <span class="k">ELSE</span>
<a name="ln-732"></a><span class="k">                CALL </span><span class="n">IssueSevereInputFieldError</span><span class="p">(</span><span class="n">RoutineName</span><span class="p">,</span> <span class="n">ObjName_ug_GeneralDomain</span><span class="p">,</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">CurIndex</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-733"></a>                                                <span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">CurIndex</span><span class="p">),</span> <span class="s1">&#39;Must enter either yes or no.&#39;</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-734"></a>            <span class="k">END IF</span>
<a name="ln-735"></a>
<a name="ln-736"></a>            <span class="c">! get boundary condition model names and indeces --error check</span>
<a name="ln-737"></a>            <span class="n">CurIndex</span> <span class="o">=</span> <span class="mi">7</span>
<a name="ln-738"></a>            <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BasementZone</span><span class="p">%</span><span class="n">WallBoundaryOSCMName</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">CurIndex</span><span class="p">)</span>
<a name="ln-739"></a>            <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BasementZone</span><span class="p">%</span><span class="n">WallBoundaryOSCMIndex</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-740"></a>                <span class="n">FindItemInList</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BasementZone</span><span class="p">%</span><span class="n">WallBoundaryOSCMName</span><span class="p">,</span><span class="n">OSCM</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotOSCM</span><span class="p">)</span>
<a name="ln-741"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BasementZone</span><span class="p">%</span><span class="n">WallBoundaryOSCMIndex</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-742"></a><span class="k">                CALL </span><span class="n">IssueSevereInputFieldError</span><span class="p">(</span><span class="n">RoutineName</span><span class="p">,</span> <span class="n">ObjName_ug_GeneralDomain</span><span class="p">,</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">CurIndex</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-743"></a>                            <span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">CurIndex</span><span class="p">),</span> <span class="s1">&#39;Could not match with an Other Side Conditions Model input object.&#39;</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-744"></a>            <span class="k">ELSE</span>
<a name="ln-745"></a><span class="k">                </span><span class="n">NumSurfacesWithThisOSCM</span> <span class="o">=</span> <span class="n">GetSurfaceCountForOSCM</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BasementZone</span><span class="p">%</span><span class="n">WallBoundaryOSCMIndex</span><span class="p">)</span>
<a name="ln-746"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">NumSurfacesWithThisOSCM</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-747"></a><span class="k">                    CALL </span><span class="n">IssueSevereInputFieldError</span><span class="p">(</span><span class="n">RoutineName</span><span class="p">,</span><span class="n">ObjName_ug_GeneralDomain</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">CurIndex</span><span class="p">),&amp;</span>
<a name="ln-748"></a>                               <span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">CurIndex</span><span class="p">),</span> <span class="s1">&#39;Entry matched an Other Side Conditions Model, but no surfaces were found&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-749"></a>                                                     <span class="s1">&#39; to be using this Other Side Conditions Model.&#39;</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-750"></a>                <span class="k">ELSE</span>
<a name="ln-751"></a><span class="k">                    ALLOCATE</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BasementZone</span><span class="p">%</span><span class="n">WallSurfacePointers</span><span class="p">(</span><span class="n">NumSurfacesWithThisOSCM</span><span class="p">))</span>
<a name="ln-752"></a>                    <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BasementZone</span><span class="p">%</span><span class="n">WallSurfacePointers</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-753"></a>                        <span class="n">GetSurfaceIndecesForOSCM</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BasementZone</span><span class="p">%</span><span class="n">WallBoundaryOSCMIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-754"></a>                                                 <span class="n">NumSurfacesWithThisOSCM</span><span class="p">)</span>
<a name="ln-755"></a>                <span class="k">END IF</span>
<a name="ln-756"></a><span class="k">            END IF</span>
<a name="ln-757"></a>
<a name="ln-758"></a><span class="k">            </span><span class="n">CurIndex</span> <span class="o">=</span> <span class="mi">8</span>
<a name="ln-759"></a>            <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BasementZone</span><span class="p">%</span><span class="n">FloorBoundaryOSCMName</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">CurIndex</span><span class="p">)</span>
<a name="ln-760"></a>            <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BasementZone</span><span class="p">%</span><span class="n">FloorBoundaryOSCMIndex</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-761"></a>                <span class="n">FindItemInList</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BasementZone</span><span class="p">%</span><span class="n">FloorBoundaryOSCMName</span><span class="p">,</span><span class="n">OSCM</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotOSCM</span><span class="p">)</span>
<a name="ln-762"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BasementZone</span><span class="p">%</span><span class="n">FloorBoundaryOSCMIndex</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-763"></a><span class="k">                CALL </span><span class="n">IssueSevereInputFieldError</span><span class="p">(</span><span class="n">RoutineName</span><span class="p">,</span> <span class="n">ObjName_ug_GeneralDomain</span><span class="p">,</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">CurIndex</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-764"></a>                            <span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">CurIndex</span><span class="p">),</span> <span class="s1">&#39;Could not match with an Other Side Conditions Model input object.&#39;</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-765"></a>            <span class="k">ELSE</span>
<a name="ln-766"></a><span class="k">                </span><span class="n">NumSurfacesWithThisOSCM</span> <span class="o">=</span> <span class="n">GetSurfaceCountForOSCM</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BasementZone</span><span class="p">%</span><span class="n">FloorBoundaryOSCMIndex</span><span class="p">)</span>
<a name="ln-767"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">NumSurfacesWithThisOSCM</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-768"></a><span class="k">                    CALL </span><span class="n">IssueSevereInputFieldError</span><span class="p">(</span><span class="n">RoutineName</span><span class="p">,</span><span class="n">ObjName_ug_GeneralDomain</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">CurIndex</span><span class="p">),&amp;</span>
<a name="ln-769"></a>                               <span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">CurIndex</span><span class="p">),</span> <span class="s1">&#39;Entry matched an Other Side Conditions Model, but no surfaces were found&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-770"></a>                                                     <span class="s1">&#39; to be using this Other Side Conditions Model.&#39;</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-771"></a>                <span class="k">ELSE</span>
<a name="ln-772"></a><span class="k">                    ALLOCATE</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BasementZone</span><span class="p">%</span><span class="n">FloorSurfacePointers</span><span class="p">(</span><span class="n">NumSurfacesWithThisOSCM</span><span class="p">))</span>
<a name="ln-773"></a>                    <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BasementZone</span><span class="p">%</span><span class="n">FloorSurfacePointers</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-774"></a>                        <span class="n">GetSurfaceIndecesForOSCM</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BasementZone</span><span class="p">%</span><span class="n">FloorBoundaryOSCMIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-775"></a>                                                 <span class="n">NumSurfacesWithThisOSCM</span><span class="p">)</span>
<a name="ln-776"></a>                <span class="k">END IF</span>
<a name="ln-777"></a><span class="k">            END IF</span>
<a name="ln-778"></a>
<a name="ln-779"></a>
<a name="ln-780"></a><span class="k">        END IF</span>
<a name="ln-781"></a>
<a name="ln-782"></a>        <span class="c">!get some convergence tolerances, minimum/maximum are enforced by the IP, along with default values if user left them blank</span>
<a name="ln-783"></a>        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">SimControls</span><span class="p">%</span><span class="n">Convergence_CurrentToPrevIteration</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<a name="ln-784"></a>        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">SimControls</span><span class="p">%</span><span class="n">MaxIterationsPerTS</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span>
<a name="ln-785"></a>
<a name="ln-786"></a>        <span class="c">!additional evapotranspiration parameter, min/max validated by IP</span>
<a name="ln-787"></a>        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Moisture</span><span class="p">%</span><span class="n">GroundCoverCoefficient</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span>
<a name="ln-788"></a>
<a name="ln-789"></a>        <span class="c">!Allocate the circuit placeholder arrays</span>
<a name="ln-790"></a>        <span class="n">NumCircuitsInThisDomain</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">23</span><span class="p">))</span>
<a name="ln-791"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">CircuitNames</span><span class="p">(</span><span class="n">NumCircuitsInThisDomain</span><span class="p">))</span>
<a name="ln-792"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">CircuitIndeces</span><span class="p">(</span><span class="n">NumCircuitsInThisDomain</span><span class="p">))</span>
<a name="ln-793"></a>
<a name="ln-794"></a>        <span class="c">!Check for blank or missing or mismatched number...</span>
<a name="ln-795"></a>        <span class="n">NumAlphasBeforePipeCircOne</span> <span class="o">=</span> <span class="mi">8</span>
<a name="ln-796"></a>        <span class="k">DO </span><span class="n">CircuitCtr</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumCircuitsInThisDomain</span>
<a name="ln-797"></a>            <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">CircuitNames</span><span class="p">(</span><span class="n">CircuitCtr</span><span class="p">)</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">CircuitCtr</span> <span class="o">+</span> <span class="n">NumAlphasBeforePipeCircOne</span><span class="p">)</span>
<a name="ln-798"></a>        <span class="k">END DO</span>
<a name="ln-799"></a>
<a name="ln-800"></a><span class="k">    </span><span class="n">ENDDO</span>
<a name="ln-801"></a>
<a name="ln-802"></a>  <span class="k">RETURN</span>
<a name="ln-803"></a>
<a name="ln-804"></a><span class="k">END SUBROUTINE</span>
<a name="ln-805"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-806"></a>
<a name="ln-807"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-808"></a><span class="k">SUBROUTINE </span><span class="n">ReadPipeCircuitInputs</span><span class="p">(</span><span class="n">NumPipeCircuits</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-809"></a>
<a name="ln-810"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-811"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-812"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-813"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-814"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-815"></a>
<a name="ln-816"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-817"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-818"></a>
<a name="ln-819"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-820"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-821"></a>
<a name="ln-822"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-823"></a>          <span class="c">! na</span>
<a name="ln-824"></a>
<a name="ln-825"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-826"></a>    <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">VerifyName</span>
<a name="ln-827"></a>    <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-828"></a>    <span class="k">USE </span><span class="n">DataLoopNode</span>
<a name="ln-829"></a>    <span class="k">USE </span><span class="n">NodeInputManager</span><span class="p">,</span>      <span class="n">ONLY</span> <span class="p">:</span> <span class="n">GetOnlySingleNode</span>
<a name="ln-830"></a>    <span class="k">USE </span><span class="n">BranchNodeConnections</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">TestCompSet</span>
<a name="ln-831"></a>    <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TypeOf_PipingSystemPipeCircuit</span>
<a name="ln-832"></a>    <span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">SetupOutputVariable</span>
<a name="ln-833"></a>
<a name="ln-834"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-835"></a>
<a name="ln-836"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-837"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">NumPipeCircuits</span>
<a name="ln-838"></a>    <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span> <span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrorsFound</span>
<a name="ln-839"></a>
<a name="ln-840"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-841"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;ReadPipeCircuitInputs&#39;</span>
<a name="ln-842"></a>
<a name="ln-843"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-844"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumPipeSegments</span>
<a name="ln-845"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumAlphas</span>
<a name="ln-846"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumNumbers</span>
<a name="ln-847"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IOStatus</span>
<a name="ln-848"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">PipeCircuitCounter</span>
<a name="ln-849"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ThisCircuitPipeSegmentCounter</span>
<a name="ln-850"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">IsNotOK</span>
<a name="ln-851"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">IsBlank</span>
<a name="ln-852"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CurIndex</span>
<a name="ln-853"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumAlphasBeforeSegmentOne</span>
<a name="ln-854"></a>
<a name="ln-855"></a>    <span class="k">DO </span><span class="n">PipeCircuitCounter</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumPipeCircuits</span>
<a name="ln-856"></a>
<a name="ln-857"></a>        <span class="c">!Read all the inputs for this pipe circuit</span>
<a name="ln-858"></a>        <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">ObjName_Circuit</span><span class="p">,</span><span class="n">PipeCircuitCounter</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-859"></a>                             <span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">IOStatus</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-860"></a>                             <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-861"></a>                             <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-862"></a>
<a name="ln-863"></a>        <span class="c">!Get the name, validate</span>
<a name="ln-864"></a>        <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">PipeCircuitCounter</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-865"></a>        <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-866"></a>        <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-867"></a>        <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">PipingSystemCircuits</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span> <span class="n">PipeCircuitCounter</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-868"></a>                        <span class="n">IsNotOK</span><span class="p">,</span> <span class="n">IsBlank</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">ObjName_Circuit</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-869"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-870"></a><span class="k">            </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-871"></a>            <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;Duplicate name encountered&#39;</span>
<a name="ln-872"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-873"></a><span class="k">            </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-874"></a>            <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;Blank name encountered&#39;</span>
<a name="ln-875"></a>        <span class="n">ENDIF</span>
<a name="ln-876"></a>
<a name="ln-877"></a>        <span class="c">!Read pipe thermal properties, validated by IP</span>
<a name="ln-878"></a>        <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">PipeCircuitCounter</span><span class="p">)%</span><span class="n">PipeProperties</span><span class="p">%</span><span class="n">Conductivity</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-879"></a>        <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">PipeCircuitCounter</span><span class="p">)%</span><span class="n">PipeProperties</span><span class="p">%</span><span class="n">Density</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-880"></a>        <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">PipeCircuitCounter</span><span class="p">)%</span><span class="n">PipeProperties</span><span class="p">%</span><span class="n">SpecificHeat</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-881"></a>
<a name="ln-882"></a>        <span class="c">!Read pipe sizing, validated individually by IP, validated comparison here</span>
<a name="ln-883"></a>        <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">PipeCircuitCounter</span><span class="p">)%</span><span class="n">PipeSize</span><span class="p">%</span><span class="n">InnerDia</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-884"></a>        <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">PipeCircuitCounter</span><span class="p">)%</span><span class="n">PipeSize</span><span class="p">%</span><span class="n">OuterDia</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-885"></a>        <span class="k">IF</span> <span class="p">(</span>   <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">PipeCircuitCounter</span><span class="p">)%</span><span class="n">PipeSize</span><span class="p">%</span><span class="n">InnerDia</span> <span class="o">&gt;=</span> <span class="p">&amp;</span>
<a name="ln-886"></a>               <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">PipeCircuitCounter</span><span class="p">)%</span><span class="n">PipeSize</span><span class="p">%</span><span class="n">OuterDia</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-887"></a><span class="k">            </span><span class="n">CurIndex</span> <span class="o">=</span> <span class="mi">5</span>
<a name="ln-888"></a>            <span class="k">CALL </span><span class="n">IssueSevereInputFieldError</span><span class="p">(</span><span class="n">RoutineName</span><span class="p">,</span> <span class="n">ObjName_Circuit</span><span class="p">,</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">CurIndex</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-889"></a>                                          <span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">CurIndex</span><span class="p">),</span> <span class="s1">&#39;Outer diameter must be greater than inner diameter.&#39;</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-890"></a>        <span class="k">END IF</span>
<a name="ln-891"></a>
<a name="ln-892"></a>        <span class="c">!Read design flow rate, validated positive by IP</span>
<a name="ln-893"></a>        <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">PipeCircuitCounter</span><span class="p">)%</span><span class="n">DesignVolumeFlowRate</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-894"></a>
<a name="ln-895"></a>        <span class="c">!Read inlet and outlet node names and validate them</span>
<a name="ln-896"></a>        <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">PipeCircuitCounter</span><span class="p">)%</span><span class="n">InletNodeName</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-897"></a>        <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">PipeCircuitCounter</span><span class="p">)%</span><span class="n">InletNodeNum</span>  <span class="o">=</span> <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-898"></a>                                                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">ObjName_Circuit</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-899"></a>                                                                   <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-900"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">PipeCircuitCounter</span><span class="p">)%</span><span class="n">InletNodeNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-901"></a><span class="k">            </span><span class="n">CurIndex</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-902"></a>            <span class="k">CALL </span><span class="n">IssueSevereInputFieldError</span><span class="p">(</span><span class="n">RoutineName</span><span class="p">,</span> <span class="n">ObjName_Circuit</span><span class="p">,</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">CurIndex</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-903"></a>                                            <span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">CurIndex</span><span class="p">),</span> <span class="s1">&#39;Bad node name.&#39;</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-904"></a>        <span class="k">END IF</span>
<a name="ln-905"></a><span class="k">        </span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">PipeCircuitCounter</span><span class="p">)%</span><span class="n">OutletNodeName</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-906"></a>        <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">PipeCircuitCounter</span><span class="p">)%</span><span class="n">OutletNodeNum</span>  <span class="o">=</span> <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-907"></a>                                                                    <span class="nb">TRIM</span><span class="p">(</span><span class="n">ObjName_Circuit</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-908"></a>                                                                    <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-909"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">PipeCircuitCounter</span><span class="p">)%</span><span class="n">OutletNodeNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-910"></a><span class="k">            </span><span class="n">CurIndex</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-911"></a>            <span class="k">CALL </span><span class="n">IssueSevereInputFieldError</span><span class="p">(</span><span class="n">RoutineName</span><span class="p">,</span> <span class="n">ObjName_Circuit</span><span class="p">,</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">CurIndex</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-912"></a>                                            <span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">CurIndex</span><span class="p">),</span> <span class="s1">&#39;Bad node name.&#39;</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-913"></a>        <span class="k">END IF</span>
<a name="ln-914"></a><span class="k">        CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ObjName_Circuit</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;Piping System Circuit Nodes&#39;</span><span class="p">)</span>
<a name="ln-915"></a>
<a name="ln-916"></a>        <span class="c">!Convergence tolerance values, validated by IP</span>
<a name="ln-917"></a>        <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">PipeCircuitCounter</span><span class="p">)%</span><span class="n">Convergence_CurrentToPrevIteration</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-918"></a>        <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">PipeCircuitCounter</span><span class="p">)%</span><span class="n">MaxIterationsPerTS</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-919"></a>
<a name="ln-920"></a>        <span class="c">!Radial mesh inputs, validated by IP</span>
<a name="ln-921"></a>        <span class="c">! -- mesh thickness should be considered slightly dangerous until mesh dev engine can trap erroneous values</span>
<a name="ln-922"></a>        <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">PipeCircuitCounter</span><span class="p">)%</span><span class="n">NumRadialCells</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-923"></a>        <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">PipeCircuitCounter</span><span class="p">)%</span><span class="n">RadialMeshThickness</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-924"></a>
<a name="ln-925"></a>        <span class="c">!Read number of pipe segments for this circuit, allocate arrays</span>
<a name="ln-926"></a>        <span class="n">NumPipeSegments</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-927"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">PipeCircuitCounter</span><span class="p">)%</span><span class="n">PipeSegmentIndeces</span><span class="p">(</span><span class="n">NumPipeSegments</span><span class="p">))</span>
<a name="ln-928"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">PipeCircuitCounter</span><span class="p">)%</span><span class="n">PipeSegmentNames</span><span class="p">(</span><span class="n">NumPipeSegments</span><span class="p">))</span>
<a name="ln-929"></a>
<a name="ln-930"></a>        <span class="c">!Check for blank or missing or mismatched number...</span>
<a name="ln-931"></a>        <span class="n">NumAlphasBeforeSegmentOne</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-932"></a>        <span class="k">DO </span><span class="n">ThisCircuitPipeSegmentCounter</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumPipeSegments</span>
<a name="ln-933"></a>            <span class="n">CurIndex</span> <span class="o">=</span> <span class="n">ThisCircuitPipeSegmentCounter</span> <span class="o">+</span> <span class="n">NumAlphasBeforeSegmentOne</span>
<a name="ln-934"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="n">CurIndex</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-935"></a><span class="k">                CALL </span><span class="n">IssueSevereInputFieldError</span><span class="p">(</span><span class="n">RoutineName</span><span class="p">,</span> <span class="n">ObjName_Circuit</span><span class="p">,</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">CurIndex</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-936"></a>                          <span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">CurIndex</span><span class="p">),</span> <span class="s1">&#39;Expected a pipe segment name, check pipe segment count input field.&#39;</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-937"></a>            <span class="k">END IF</span>
<a name="ln-938"></a><span class="k">            </span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">PipeCircuitCounter</span><span class="p">)%</span><span class="n">PipeSegmentNames</span><span class="p">(</span><span class="n">ThisCircuitPipeSegmentCounter</span><span class="p">)</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">CurIndex</span><span class="p">)</span>
<a name="ln-939"></a>        <span class="k">END DO</span>
<a name="ln-940"></a>
<a name="ln-941"></a><span class="k">    END DO</span> <span class="c">!All pipe circuits in input</span>
<a name="ln-942"></a>
<a name="ln-943"></a>  <span class="k">RETURN</span>
<a name="ln-944"></a>
<a name="ln-945"></a><span class="k">END SUBROUTINE</span>
<a name="ln-946"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-947"></a>
<a name="ln-948"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-949"></a><span class="k">SUBROUTINE </span><span class="n">ReadPipeSegmentInputs</span><span class="p">(</span><span class="n">NumPipeSegmentsInInput</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-950"></a>
<a name="ln-951"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-952"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-953"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-954"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-955"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-956"></a>
<a name="ln-957"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-958"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-959"></a>
<a name="ln-960"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-961"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-962"></a>
<a name="ln-963"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-964"></a>          <span class="c">! na</span>
<a name="ln-965"></a>
<a name="ln-966"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-967"></a>    <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">VerifyName</span>
<a name="ln-968"></a>    <span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SetupOutputVariable</span>
<a name="ln-969"></a>    <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-970"></a>
<a name="ln-971"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-972"></a>
<a name="ln-973"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-974"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">NumPipeSegmentsInInput</span>
<a name="ln-975"></a>    <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span> <span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrorsFound</span>
<a name="ln-976"></a>
<a name="ln-977"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-978"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;ReadPipeSegmentInputs&#39;</span>
<a name="ln-979"></a>
<a name="ln-980"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-981"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SegmentCtr</span>
<a name="ln-982"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumAlphas</span>  <span class="c">! Number of Alphas for each GetObjectItem call</span>
<a name="ln-983"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumNumbers</span> <span class="c">! Number of Numbers for each GetObjectItem call</span>
<a name="ln-984"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IOStatus</span>   <span class="c">! Used in GetObjectItem</span>
<a name="ln-985"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CurIndex</span>
<a name="ln-986"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">IsNotOK</span>
<a name="ln-987"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">IsBlank</span>
<a name="ln-988"></a>
<a name="ln-989"></a>    <span class="c">!Read in all pipe segments</span>
<a name="ln-990"></a>    <span class="k">DO </span><span class="n">SegmentCtr</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumPipeSegmentsInInput</span>
<a name="ln-991"></a>
<a name="ln-992"></a>        <span class="c">!Read all inputs for this pipe segment</span>
<a name="ln-993"></a>        <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">ObjName_Segment</span><span class="p">,</span><span class="n">SegmentCtr</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-994"></a>                 <span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">IOStatus</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-995"></a>                 <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-996"></a>                 <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-997"></a>
<a name="ln-998"></a>        <span class="c">!Get the name, validate</span>
<a name="ln-999"></a>        <span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">SegmentCtr</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1000"></a>        <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1001"></a>        <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1002"></a>        <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">PipingSystemSegments</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">SegmentCtr</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ObjName_Segment</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-1003"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1004"></a><span class="k">            </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1005"></a>            <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;Duplicate name encountered&#39;</span>
<a name="ln-1006"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1007"></a><span class="k">            </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1008"></a>            <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;Blank name encountered&#39;</span>
<a name="ln-1009"></a>        <span class="n">ENDIF</span>
<a name="ln-1010"></a>
<a name="ln-1011"></a>        <span class="c">!Read in the pipe location, validated as positive by IP</span>
<a name="ln-1012"></a>        <span class="c">! -- note that these values will be altered by the main GetInput routine in two ways:</span>
<a name="ln-1013"></a>        <span class="c">!   1) shift for basement wall if selected</span>
<a name="ln-1014"></a>        <span class="c">!   2) invert y direction to be measured from domain bottom surface for calculations</span>
<a name="ln-1015"></a>        <span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">SegmentCtr</span><span class="p">)%</span><span class="n">PipeLocation</span> <span class="o">=</span> <span class="n">PointF</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-1016"></a>
<a name="ln-1017"></a>        <span class="c">!Read in the flow direction</span>
<a name="ln-1018"></a>        <span class="k">SELECT CASE</span> <span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))))</span>
<a name="ln-1019"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;INCREASINGZ&#39;</span><span class="p">)</span>
<a name="ln-1020"></a>            <span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">SegmentCtr</span><span class="p">)%</span><span class="n">FlowDirection</span> <span class="o">=</span> <span class="n">SegmentFlow_IncreasingZ</span>
<a name="ln-1021"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;DECREASINGZ&#39;</span><span class="p">)</span>
<a name="ln-1022"></a>            <span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">SegmentCtr</span><span class="p">)%</span><span class="n">FlowDirection</span> <span class="o">=</span> <span class="n">SegmentFlow_DecreasingZ</span>
<a name="ln-1023"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1024"></a>            <span class="n">CurIndex</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-1025"></a>            <span class="k">CALL </span><span class="n">IssueSevereInputFieldError</span><span class="p">(</span><span class="n">RoutineName</span><span class="p">,</span> <span class="n">ObjName_Segment</span><span class="p">,</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">CurIndex</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1026"></a>                                     <span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">CurIndex</span><span class="p">),</span> <span class="s1">&#39;Invalid flow direction, use one of the available keys.&#39;</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-1027"></a>        <span class="k">END SELECT</span>
<a name="ln-1028"></a>
<a name="ln-1029"></a><span class="k">    END DO</span>
<a name="ln-1030"></a>
<a name="ln-1031"></a><span class="k">  RETURN</span>
<a name="ln-1032"></a>
<a name="ln-1033"></a><span class="k">END SUBROUTINE</span>
<a name="ln-1034"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-1035"></a>
<a name="ln-1036"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-1037"></a><span class="k">SUBROUTINE </span><span class="n">ReadHorizontalTrenchInputs</span><span class="p">(</span><span class="n">StartingDomainNumForHorizontal</span><span class="p">,</span> <span class="n">StartingCircuitNumForHorizontal</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1038"></a>                              <span class="n">StartingSegmentNumForHorizontal</span><span class="p">,</span> <span class="n">NumHorizontalTrenchesInInput</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-1039"></a>
<a name="ln-1040"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1041"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-1042"></a>          <span class="c">!       DATE WRITTEN   September 2012</span>
<a name="ln-1043"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-1044"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1045"></a>
<a name="ln-1046"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1047"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-1048"></a>
<a name="ln-1049"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1050"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-1051"></a>
<a name="ln-1052"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1053"></a>          <span class="c">! na</span>
<a name="ln-1054"></a>
<a name="ln-1055"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1056"></a>    <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">VerifyName</span>
<a name="ln-1057"></a>    <span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SetupOutputVariable</span>
<a name="ln-1058"></a>    <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-1059"></a>    <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SecsInDay</span>
<a name="ln-1060"></a>    <span class="k">USE </span><span class="n">DataLoopNode</span>
<a name="ln-1061"></a>    <span class="k">USE </span><span class="n">NodeInputManager</span><span class="p">,</span>      <span class="n">ONLY</span> <span class="p">:</span> <span class="n">GetOnlySingleNode</span>
<a name="ln-1062"></a>    <span class="k">USE </span><span class="n">BranchNodeConnections</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">TestCompSet</span>
<a name="ln-1063"></a>    <span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">PubGroundTempSurfFlag</span><span class="p">,</span> <span class="n">PubGroundTempSurface</span>
<a name="ln-1064"></a>
<a name="ln-1065"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1066"></a>
<a name="ln-1067"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1068"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">StartingDomainNumForHorizontal</span>
<a name="ln-1069"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">StartingCircuitNumForHorizontal</span>
<a name="ln-1070"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">StartingSegmentNumForHorizontal</span>
<a name="ln-1071"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">NumHorizontalTrenchesInInput</span>
<a name="ln-1072"></a>    <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span> <span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrorsFound</span>
<a name="ln-1073"></a>
<a name="ln-1074"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1075"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RoutineName</span> <span class="o">=</span> <span class="s1">&#39;ReadHorizontalTrenchInputs&#39;</span>
<a name="ln-1076"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span>          <span class="kd">::</span> <span class="n">MonthsInYear</span> <span class="o">=</span> <span class="mi">12</span>
<a name="ln-1077"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>        <span class="kd">::</span> <span class="n">LargeNumber</span> <span class="o">=</span> <span class="mi">1000</span><span class="mf">0.0d0</span>
<a name="ln-1078"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>        <span class="kd">::</span> <span class="n">AvgDaysInMonth</span> <span class="o">=</span> <span class="mi">36</span><span class="mf">5.0d0</span><span class="o">/</span><span class="mi">1</span><span class="mf">2.0d0</span>
<a name="ln-1079"></a>
<a name="ln-1080"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-1081"></a>    <span class="k">TYPE </span><span class="n">HorizontalTrenchData</span>
<a name="ln-1082"></a>        <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ObjName</span>                   <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-1083"></a>        <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletNodeName</span>             <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-1084"></a>        <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletNodeName</span>            <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-1085"></a>        <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">AxialLength</span>               <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1086"></a>        <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">PipeID</span>                    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1087"></a>        <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">PipeOD</span>                    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1088"></a>        <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">NumPipes</span>                  <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1089"></a>        <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">BurialDepth</span>               <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1090"></a>        <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">DesignFlowRate</span>            <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1091"></a>        <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">SoilConductivity</span>          <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1092"></a>        <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">SoilDensity</span>               <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1093"></a>        <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">SoilSpecificHeat</span>          <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1094"></a>        <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">PipeConductivity</span>          <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1095"></a>        <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">PipeDensity</span>               <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1096"></a>        <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">PipeSpecificHeat</span>          <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1097"></a>        <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">InterPipeSpacing</span>          <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1098"></a>        <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">MoistureContent</span>           <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1099"></a>        <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">SaturationMoistureContent</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1100"></a>        <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">KusudaAvgSurfTemp</span>         <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1101"></a>        <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">KusudaAvgAmplitude</span>        <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1102"></a>        <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">KusudaPhaseShift</span>          <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1103"></a>        <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">EvapotranspirationCoeff</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1104"></a>        <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">UseGroundTempDataForKusuda</span><span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1105"></a>        <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">MinSurfTemp</span>               <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1106"></a>        <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">MonthOfMinSurfTemp</span>        <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1107"></a>    <span class="k">END TYPE</span>
<a name="ln-1108"></a>
<a name="ln-1109"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1110"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HorizontalGHXCtr</span>
<a name="ln-1111"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumAlphas</span>  <span class="c">! Number of Alphas for each GetObjectItem call</span>
<a name="ln-1112"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumNumbers</span> <span class="c">! Number of Numbers for each GetObjectItem call</span>
<a name="ln-1113"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IOStatus</span>   <span class="c">! Used in GetObjectItem</span>
<a name="ln-1114"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CurIndex</span>
<a name="ln-1115"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">IsNotOK</span>
<a name="ln-1116"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">IsBlank</span>
<a name="ln-1117"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">HorizontalTrenchData</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">NumHorizontalTrenchesInInput</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HGHX</span>
<a name="ln-1118"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DomainCtr</span>
<a name="ln-1119"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CircuitCtr</span>
<a name="ln-1120"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SegmentCtr</span>
<a name="ln-1121"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumPipeSegments</span>
<a name="ln-1122"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ThisCircuitPipeSegmentCounter</span>
<a name="ln-1123"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MonthIndex</span>
<a name="ln-1124"></a>
<a name="ln-1125"></a>    <span class="c">! initialize these counters properly so they can be incremented within the DO loop</span>
<a name="ln-1126"></a>    <span class="n">DomainCtr</span> <span class="o">=</span> <span class="n">StartingDomainNumForHorizontal</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-1127"></a>    <span class="n">CircuitCtr</span><span class="o">=</span> <span class="n">StartingCircuitNumForHorizontal</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-1128"></a>    <span class="n">SegmentCtr</span><span class="o">=</span> <span class="n">StartingSegmentNumForHorizontal</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-1129"></a>
<a name="ln-1130"></a>    <span class="c">! For each horizontal, we need to process the inputs into a local array of derived type,</span>
<a name="ln-1131"></a>    <span class="c">!  then resolve each one, creating definitions for a pipe domain, pipe circuit, and series of pipe segments</span>
<a name="ln-1132"></a>    <span class="c">! This way, the outer get input routines can handle it as though they were generalized routines</span>
<a name="ln-1133"></a>
<a name="ln-1134"></a>    <span class="c">!Read in all pipe segments</span>
<a name="ln-1135"></a>    <span class="k">DO </span><span class="n">HorizontalGHXCtr</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumHorizontalTrenchesInInput</span>
<a name="ln-1136"></a>
<a name="ln-1137"></a>        <span class="c">!Increment the domain and circuit counters here</span>
<a name="ln-1138"></a>        <span class="n">DomainCtr</span> <span class="o">=</span> <span class="n">DomainCtr</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1139"></a>        <span class="n">CircuitCtr</span> <span class="o">=</span> <span class="n">CircuitCtr</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1140"></a>
<a name="ln-1141"></a>        <span class="c">!Read all inputs for this pipe segment</span>
<a name="ln-1142"></a>        <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">objName_HorizTrench</span><span class="p">,</span><span class="n">HorizontalGHXCtr</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1143"></a>                 <span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">IOStatus</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1144"></a>                 <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1145"></a>                 <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-1146"></a>
<a name="ln-1147"></a>        <span class="c">!Get the name, validate</span>
<a name="ln-1148"></a>        <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">ObjName</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1149"></a>        <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1150"></a>        <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1151"></a>        <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">HGHX</span><span class="p">%</span><span class="n">ObjName</span><span class="p">,</span><span class="n">HorizontalGHXCtr</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">objName_HorizTrench</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-1152"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1153"></a><span class="k">            </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1154"></a>            <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;Duplicate name encountered&#39;</span>
<a name="ln-1155"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1156"></a><span class="k">            </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1157"></a>            <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;Blank name encountered&#39;</span>
<a name="ln-1158"></a>        <span class="n">ENDIF</span>
<a name="ln-1159"></a>
<a name="ln-1160"></a>        <span class="c">!Read in the rest of the inputs into the local type for clarity during transition</span>
<a name="ln-1161"></a>        <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">InletNodeName</span>             <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1162"></a>        <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">OutletNodeName</span>            <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1163"></a>        <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">DesignFlowRate</span>            <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1164"></a>        <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">AxialLength</span>               <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1165"></a>        <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">NumPipes</span>                  <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1166"></a>        <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">InterPipeSpacing</span>          <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1167"></a>        <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">PipeID</span>                    <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-1168"></a>        <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">PipeOD</span>                    <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-1169"></a>        <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">BurialDepth</span>               <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-1170"></a>        <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">SoilConductivity</span>          <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-1171"></a>        <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">SoilDensity</span>               <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-1172"></a>        <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">SoilSpecificHeat</span>          <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-1173"></a>        <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">PipeConductivity</span>          <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-1174"></a>        <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">PipeDensity</span>               <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-1175"></a>        <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">PipeSpecificHeat</span>          <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-1176"></a>        <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">MoistureContent</span>           <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<a name="ln-1177"></a>        <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">SaturationMoistureContent</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<a name="ln-1178"></a>        <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">KusudaAvgSurfTemp</span>         <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<a name="ln-1179"></a>        <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">KusudaAvgAmplitude</span>        <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<a name="ln-1180"></a>        <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">KusudaPhaseShift</span>          <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
<a name="ln-1181"></a>        <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">EvapotranspirationCoeff</span>   <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
<a name="ln-1182"></a>        <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">UseGroundTempDataForKusuda</span><span class="o">=</span> <span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1183"></a>                                                           <span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1184"></a>                                                           <span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
<a name="ln-1185"></a>
<a name="ln-1186"></a>        <span class="c">!******* We&#39;ll first set up the domain ********</span>
<a name="ln-1187"></a>        <span class="c">!the extents will be: Zmax = axial length; Ymax = burial depth*2; Xmax = (NumPipes+1)*HorizontalPipeSpacing</span>
<a name="ln-1188"></a>        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainCtr</span><span class="p">)%</span><span class="n">IsActuallyPartOfAHorizontalTrench</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1189"></a>        <span class="k">WRITE</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainCtr</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="s1">&#39;(&quot;HorizontalTrenchDomain&quot;,I4)&#39;</span><span class="p">)</span> <span class="n">HorizontalGHXCtr</span>
<a name="ln-1190"></a>        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainCtr</span><span class="p">)%</span><span class="n">Extents</span><span class="p">%</span><span class="n">Xmax</span> <span class="o">=</span> <span class="p">(</span><span class="kt">REAL</span><span class="p">(</span><span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">NumPipes</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-1191"></a>                                                                            <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">InterPipeSpacing</span>
<a name="ln-1192"></a>        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainCtr</span><span class="p">)%</span><span class="n">Extents</span><span class="p">%</span><span class="n">Ymax</span> <span class="o">=</span> <span class="mf">2.0d0</span> <span class="o">*</span> <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">BurialDepth</span>
<a name="ln-1193"></a>        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainCtr</span><span class="p">)%</span><span class="n">Extents</span><span class="p">%</span><span class="n">Zmax</span> <span class="o">=</span> <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">AxialLength</span>
<a name="ln-1194"></a>
<a name="ln-1195"></a>        <span class="c">!set up the mesh with some default parameters</span>
<a name="ln-1196"></a>        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainCtr</span><span class="p">)%</span><span class="n">Mesh</span><span class="p">%</span><span class="n">X</span><span class="p">%</span><span class="n">RegionMeshCount</span>  <span class="o">=</span> <span class="mi">4</span>
<a name="ln-1197"></a>        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainCtr</span><span class="p">)%</span><span class="n">Mesh</span><span class="p">%</span><span class="n">X</span><span class="p">%</span><span class="n">MeshDistribution</span> <span class="o">=</span> <span class="n">MeshDistribution_Uniform</span>
<a name="ln-1198"></a>        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainCtr</span><span class="p">)%</span><span class="n">Mesh</span><span class="p">%</span><span class="n">Y</span><span class="p">%</span><span class="n">RegionMeshCount</span>  <span class="o">=</span> <span class="mi">4</span>
<a name="ln-1199"></a>        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainCtr</span><span class="p">)%</span><span class="n">Mesh</span><span class="p">%</span><span class="n">Y</span><span class="p">%</span><span class="n">MeshDistribution</span> <span class="o">=</span> <span class="n">MeshDistribution_Uniform</span>
<a name="ln-1200"></a>        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainCtr</span><span class="p">)%</span><span class="n">Mesh</span><span class="p">%</span><span class="n">Z</span><span class="p">%</span><span class="n">RegionMeshCount</span>  <span class="o">=</span> <span class="mi">4</span>
<a name="ln-1201"></a>        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainCtr</span><span class="p">)%</span><span class="n">Mesh</span><span class="p">%</span><span class="n">Z</span><span class="p">%</span><span class="n">MeshDistribution</span> <span class="o">=</span> <span class="n">MeshDistribution_Uniform</span>
<a name="ln-1202"></a>
<a name="ln-1203"></a>        <span class="c">!Soil properties</span>
<a name="ln-1204"></a>        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainCtr</span><span class="p">)%</span><span class="n">GroundProperties</span><span class="p">%</span><span class="n">Conductivity</span> <span class="o">=</span> <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">SoilConductivity</span>
<a name="ln-1205"></a>        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainCtr</span><span class="p">)%</span><span class="n">GroundProperties</span><span class="p">%</span><span class="n">Density</span>      <span class="o">=</span> <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">SoilDensity</span>
<a name="ln-1206"></a>        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainCtr</span><span class="p">)%</span><span class="n">GroundProperties</span><span class="p">%</span><span class="n">SpecificHeat</span> <span class="o">=</span> <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">SoilSpecificHeat</span>
<a name="ln-1207"></a>
<a name="ln-1208"></a>        <span class="c">!Moisture properties</span>
<a name="ln-1209"></a>        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainCtr</span><span class="p">)%</span><span class="n">Moisture</span><span class="p">%</span><span class="n">Theta_Liq</span> <span class="o">=</span> <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">MoistureContent</span> <span class="o">/</span> <span class="mi">10</span><span class="mf">0.0d0</span>
<a name="ln-1210"></a>        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainCtr</span><span class="p">)%</span><span class="n">Moisture</span><span class="p">%</span><span class="n">Theta_Sat</span> <span class="o">=</span> <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">SaturationMoistureContent</span> <span class="o">/</span> <span class="mi">10</span><span class="mf">0.0d0</span>
<a name="ln-1211"></a>
<a name="ln-1212"></a>        <span class="c">!Farfield model parameters</span>
<a name="ln-1213"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">UseGroundTempDataForKusuda</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1214"></a><span class="k">            </span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainCtr</span><span class="p">)%</span><span class="n">Farfield</span><span class="p">%</span><span class="n">AverageGroundTemperature</span> <span class="o">=</span> <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">KusudaAvgSurfTemp</span>
<a name="ln-1215"></a>            <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainCtr</span><span class="p">)%</span><span class="n">Farfield</span><span class="p">%</span><span class="n">AverageGroundTemperatureAmplitude</span> <span class="o">=</span> <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">KusudaAvgAmplitude</span>
<a name="ln-1216"></a>            <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainCtr</span><span class="p">)%</span><span class="n">Farfield</span><span class="p">%</span><span class="n">PhaseShiftOfMinGroundTempDays</span> <span class="o">=</span> <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">KusudaPhaseShift</span>
<a name="ln-1217"></a>        <span class="k">ELSE</span>
<a name="ln-1218"></a>            <span class="c">!If ground temp data was not brought in manually in GETINPUT,</span>
<a name="ln-1219"></a>            <span class="c">! then we must get it from the surface ground temperatures</span>
<a name="ln-1220"></a>
<a name="ln-1221"></a>            <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">PubGroundTempSurfFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1222"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s2">&quot;Input problem for &quot;</span><span class="o">//</span><span class="n">objName_HorizTrench</span><span class="o">//</span><span class="s2">&quot;=&quot;</span><span class="o">//</span><span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">ObjName</span><span class="p">)</span>
<a name="ln-1223"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s2">&quot;No Site:GroundTemperature:Shallow object found in the input file&quot;</span><span class="p">)</span>
<a name="ln-1224"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s2">&quot;This is required for the horizontal ground heat exchanger if farfield parameters are&quot;</span><span class="p">)</span>
<a name="ln-1225"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s2">&quot; not directly entered into the input object.&quot;</span><span class="p">)</span>
<a name="ln-1226"></a>                <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1227"></a>            <span class="k">END IF</span>
<a name="ln-1228"></a>
<a name="ln-1229"></a>            <span class="c">!Calculate Average Ground Temperature for all 12 months of the year:</span>
<a name="ln-1230"></a>            <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainCtr</span><span class="p">)%</span><span class="n">Farfield</span><span class="p">%</span><span class="n">AverageGroundTemperature</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1231"></a>            <span class="k">DO </span><span class="n">MonthIndex</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MonthsInYear</span>
<a name="ln-1232"></a>                <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainCtr</span><span class="p">)%</span><span class="n">Farfield</span><span class="p">%</span><span class="n">AverageGroundTemperature</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1233"></a>                                 <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainCtr</span><span class="p">)%</span><span class="n">Farfield</span><span class="p">%</span><span class="n">AverageGroundTemperature</span> <span class="o">+</span> <span class="n">PubGroundTempSurface</span><span class="p">(</span><span class="n">MonthIndex</span><span class="p">)</span>
<a name="ln-1234"></a>            <span class="k">END DO</span>
<a name="ln-1235"></a><span class="k">            </span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainCtr</span><span class="p">)%</span><span class="n">Farfield</span><span class="p">%</span><span class="n">AverageGroundTemperature</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1236"></a>                                 <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainCtr</span><span class="p">)%</span><span class="n">Farfield</span><span class="p">%</span><span class="n">AverageGroundTemperature</span> <span class="o">/</span> <span class="n">MonthsInYear</span>
<a name="ln-1237"></a>
<a name="ln-1238"></a>            <span class="c">!Calculate Average Amplitude from Average:</span>
<a name="ln-1239"></a>            <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainCtr</span><span class="p">)%</span><span class="n">Farfield</span><span class="p">%</span><span class="n">AverageGroundTemperatureAmplitude</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1240"></a>            <span class="k">DO </span><span class="n">MonthIndex</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MonthsInYear</span>
<a name="ln-1241"></a>                <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainCtr</span><span class="p">)%</span><span class="n">Farfield</span><span class="p">%</span><span class="n">AverageGroundTemperatureAmplitude</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1242"></a>                            <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainCtr</span><span class="p">)%</span><span class="n">Farfield</span><span class="p">%</span><span class="n">AverageGroundTemperatureAmplitude</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-1243"></a>                            <span class="nb">ABS</span><span class="p">(</span><span class="n">PubGroundTempSurface</span><span class="p">(</span><span class="n">MonthIndex</span><span class="p">)</span> <span class="o">-</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainCtr</span><span class="p">)%</span><span class="n">Farfield</span><span class="p">%</span><span class="n">AverageGroundTemperature</span><span class="p">)</span>
<a name="ln-1244"></a>            <span class="k">END DO</span>
<a name="ln-1245"></a><span class="k">            </span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainCtr</span><span class="p">)%</span><span class="n">Farfield</span><span class="p">%</span><span class="n">AverageGroundTemperatureAmplitude</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1246"></a>                                             <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainCtr</span><span class="p">)%</span><span class="n">Farfield</span><span class="p">%</span><span class="n">AverageGroundTemperatureAmplitude</span> <span class="o">/</span><span class="n">MonthsInYear</span>
<a name="ln-1247"></a>
<a name="ln-1248"></a>            <span class="c">!Also need to get the month of minimum surface temperature to set phase shift for Kusuda and Achenbach:</span>
<a name="ln-1249"></a>            <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">MonthOfMinSurfTemp</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1250"></a>            <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">MinSurfTemp</span> <span class="o">=</span> <span class="n">LargeNumber</span> <span class="c">!Set high month 1 temp will be lower and actually get updated</span>
<a name="ln-1251"></a>            <span class="k">DO </span><span class="n">MonthIndex</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MonthsInYear</span>
<a name="ln-1252"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">PubGroundTempSurface</span><span class="p">(</span><span class="n">MonthIndex</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">MinSurfTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1253"></a><span class="k">                    </span><span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">MonthOfMinSurfTemp</span> <span class="o">=</span> <span class="n">MonthIndex</span>
<a name="ln-1254"></a>                    <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">MinSurfTemp</span> <span class="o">=</span> <span class="n">PubGroundTempSurface</span><span class="p">(</span><span class="n">MonthIndex</span><span class="p">)</span>
<a name="ln-1255"></a>                <span class="k">END IF</span>
<a name="ln-1256"></a><span class="k">            END DO</span>
<a name="ln-1257"></a><span class="k">            </span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainCtr</span><span class="p">)%</span><span class="n">Farfield</span><span class="p">%</span><span class="n">PhaseShiftOfMinGroundTempDays</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1258"></a>                            <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">MonthOfMinSurfTemp</span> <span class="o">*</span> <span class="n">AvgDaysInMonth</span>
<a name="ln-1259"></a>        <span class="k">END IF</span>
<a name="ln-1260"></a>
<a name="ln-1261"></a>        <span class="c">!Unit conversion</span>
<a name="ln-1262"></a>        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainCtr</span><span class="p">)%</span><span class="n">Farfield</span><span class="p">%</span><span class="n">PhaseShiftOfMinGroundTemp</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1263"></a>                    <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainCtr</span><span class="p">)%</span><span class="n">Farfield</span><span class="p">%</span><span class="n">PhaseShiftOfMinGroundTempDays</span> <span class="o">*</span> <span class="n">SecsInDay</span>
<a name="ln-1264"></a>
<a name="ln-1265"></a>        <span class="c">!Other parameters</span>
<a name="ln-1266"></a>        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainCtr</span><span class="p">)%</span><span class="n">SimControls</span><span class="p">%</span><span class="n">Convergence_CurrentToPrevIteration</span> <span class="o">=</span> <span class="mf">0.001d0</span>
<a name="ln-1267"></a>        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainCtr</span><span class="p">)%</span><span class="n">SimControls</span><span class="p">%</span><span class="n">MaxIterationsPerTS</span> <span class="o">=</span> <span class="mi">250</span>
<a name="ln-1268"></a>
<a name="ln-1269"></a>        <span class="c">!additional evapotranspiration parameter, min/max validated by IP</span>
<a name="ln-1270"></a>        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainCtr</span><span class="p">)%</span><span class="n">Moisture</span><span class="p">%</span><span class="n">GroundCoverCoefficient</span> <span class="o">=</span> <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">EvapotranspirationCoeff</span>
<a name="ln-1271"></a>
<a name="ln-1272"></a>        <span class="c">!Allocate the circuit placeholder arrays</span>
<a name="ln-1273"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainCtr</span><span class="p">)%</span><span class="n">CircuitNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-1274"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainCtr</span><span class="p">)%</span><span class="n">CircuitIndeces</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-1275"></a>        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainCtr</span><span class="p">)%</span><span class="n">CircuitNames</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">ObjName</span>
<a name="ln-1276"></a>
<a name="ln-1277"></a>        <span class="c">!******* We&#39;ll next set up the circuit ********</span>
<a name="ln-1278"></a>        <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitCtr</span><span class="p">)%</span><span class="n">IsActuallyPartOfAHorizontalTrench</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1279"></a>        <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitCtr</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">ObjName</span>
<a name="ln-1280"></a>
<a name="ln-1281"></a>        <span class="c">!Read pipe thermal properties</span>
<a name="ln-1282"></a>        <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitCtr</span><span class="p">)%</span><span class="n">PipeProperties</span><span class="p">%</span><span class="n">Conductivity</span> <span class="o">=</span> <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">PipeConductivity</span>
<a name="ln-1283"></a>        <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitCtr</span><span class="p">)%</span><span class="n">PipeProperties</span><span class="p">%</span><span class="n">Density</span>      <span class="o">=</span> <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">PipeDensity</span>
<a name="ln-1284"></a>        <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitCtr</span><span class="p">)%</span><span class="n">PipeProperties</span><span class="p">%</span><span class="n">SpecificHeat</span> <span class="o">=</span> <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">PipeSpecificHeat</span>
<a name="ln-1285"></a>
<a name="ln-1286"></a>        <span class="c">!Pipe sizing</span>
<a name="ln-1287"></a>        <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitCtr</span><span class="p">)%</span><span class="n">PipeSize</span><span class="p">%</span><span class="n">InnerDia</span> <span class="o">=</span> <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">PipeID</span>
<a name="ln-1288"></a>        <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitCtr</span><span class="p">)%</span><span class="n">PipeSize</span><span class="p">%</span><span class="n">OuterDia</span> <span class="o">=</span> <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">PipeOD</span>
<a name="ln-1289"></a>        <span class="k">IF</span> <span class="p">(</span>   <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitCtr</span><span class="p">)%</span><span class="n">PipeSize</span><span class="p">%</span><span class="n">InnerDia</span> <span class="o">&gt;=</span> <span class="p">&amp;</span>
<a name="ln-1290"></a>               <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitCtr</span><span class="p">)%</span><span class="n">PipeSize</span><span class="p">%</span><span class="n">OuterDia</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1291"></a>            <span class="c">!CurIndex = 5</span>
<a name="ln-1292"></a>            <span class="c">!CALL IssueSevereInputFieldError(RoutineName, ObjName_Circuit, cAlphaArgs(1), cAlphaFieldNames(CurIndex), &amp;</span>
<a name="ln-1293"></a>            <span class="c">!                            cAlphaArgs(CurIndex), &#39;Outer diameter must be greater than inner diameter.&#39;, ErrorsFound)</span>
<a name="ln-1294"></a>        <span class="k">END IF</span>
<a name="ln-1295"></a>
<a name="ln-1296"></a>        <span class="c">!Read design flow rate, validated positive by IP</span>
<a name="ln-1297"></a>        <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitCtr</span><span class="p">)%</span><span class="n">DesignVolumeFlowRate</span> <span class="o">=</span> <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">DesignFlowRate</span>
<a name="ln-1298"></a>
<a name="ln-1299"></a>        <span class="c">!Read inlet and outlet node names and validate them</span>
<a name="ln-1300"></a>        <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitCtr</span><span class="p">)%</span><span class="n">InletNodeName</span> <span class="o">=</span> <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">InletNodeName</span>
<a name="ln-1301"></a>        <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitCtr</span><span class="p">)%</span><span class="n">InletNodeNum</span>  <span class="o">=</span> <span class="n">GetOnlySingleNode</span><span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-1302"></a>                                <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitCtr</span><span class="p">)%</span><span class="n">InletNodeName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1303"></a>                                <span class="nb">TRIM</span><span class="p">(</span><span class="n">objName_HorizTrench</span><span class="p">),</span><span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">ObjName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1304"></a>                                <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-1305"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitCtr</span><span class="p">)%</span><span class="n">InletNodeNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1306"></a><span class="k">            </span><span class="n">CurIndex</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-1307"></a>            <span class="c">!CALL IssueSevereInputFieldError(RoutineName, ObjName_Circuit, cAlphaArgs(1), cAlphaFieldNames(CurIndex), &amp;</span>
<a name="ln-1308"></a>            <span class="c">!                                cAlphaArgs(CurIndex), &#39;Bad node name.&#39;, ErrorsFound)</span>
<a name="ln-1309"></a>        <span class="k">END IF</span>
<a name="ln-1310"></a><span class="k">        </span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitCtr</span><span class="p">)%</span><span class="n">OutletNodeName</span> <span class="o">=</span> <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">OutletNodeName</span>
<a name="ln-1311"></a>        <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitCtr</span><span class="p">)%</span><span class="n">OutletNodeNum</span>  <span class="o">=</span> <span class="n">GetOnlySingleNode</span><span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-1312"></a>                                <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitCtr</span><span class="p">)%</span><span class="n">OutletNodeName</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1313"></a>                                <span class="nb">TRIM</span><span class="p">(</span><span class="n">objName_HorizTrench</span><span class="p">),</span><span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">ObjName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1314"></a>                                <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-1315"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitCtr</span><span class="p">)%</span><span class="n">OutletNodeNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1316"></a><span class="k">            </span><span class="n">CurIndex</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-1317"></a>            <span class="c">!CALL IssueSevereInputFieldError(RoutineName, ObjName_Circuit, cAlphaArgs(1), cAlphaFieldNames(CurIndex), &amp;</span>
<a name="ln-1318"></a>            <span class="c">!                                cAlphaArgs(CurIndex), &#39;Bad node name.&#39;, ErrorsFound)</span>
<a name="ln-1319"></a>        <span class="k">END IF</span>
<a name="ln-1320"></a><span class="k">        CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">objName_HorizTrench</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1321"></a>                        <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">ObjName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1322"></a>                        <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitCtr</span><span class="p">)%</span><span class="n">InletNodeName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1323"></a>                        <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitCtr</span><span class="p">)%</span><span class="n">OutletNodeName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1324"></a>                        <span class="s1">&#39;Piping System Circuit Nodes&#39;</span><span class="p">)</span>
<a name="ln-1325"></a>
<a name="ln-1326"></a>        <span class="c">!Convergence tolerance values, validated by IP</span>
<a name="ln-1327"></a>        <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitCtr</span><span class="p">)%</span><span class="n">Convergence_CurrentToPrevIteration</span> <span class="o">=</span> <span class="mf">0.001d0</span>
<a name="ln-1328"></a>        <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitCtr</span><span class="p">)%</span><span class="n">MaxIterationsPerTS</span> <span class="o">=</span> <span class="mi">100</span>
<a name="ln-1329"></a>
<a name="ln-1330"></a>        <span class="c">!Radial mesh inputs, validated by IP</span>
<a name="ln-1331"></a>        <span class="c">! -- mesh thickness should be considered slightly dangerous until mesh dev engine can trap erroneous values</span>
<a name="ln-1332"></a>        <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitCtr</span><span class="p">)%</span><span class="n">NumRadialCells</span> <span class="o">=</span> <span class="mi">4</span>
<a name="ln-1333"></a>        <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitCtr</span><span class="p">)%</span><span class="n">RadialMeshThickness</span> <span class="o">=</span> <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitCtr</span><span class="p">)%</span><span class="n">PipeSize</span><span class="p">%</span><span class="n">InnerDia</span> <span class="o">/</span> <span class="mf">2.0d0</span>
<a name="ln-1334"></a>
<a name="ln-1335"></a>        <span class="c">!Read number of pipe segments for this circuit, allocate arrays</span>
<a name="ln-1336"></a>        <span class="n">NumPipeSegments</span> <span class="o">=</span> <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">NumPipes</span>
<a name="ln-1337"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitCtr</span><span class="p">)%</span><span class="n">PipeSegmentIndeces</span><span class="p">(</span><span class="n">NumPipeSegments</span><span class="p">))</span>
<a name="ln-1338"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitCtr</span><span class="p">)%</span><span class="n">PipeSegmentNames</span><span class="p">(</span><span class="n">NumPipeSegments</span><span class="p">))</span>
<a name="ln-1339"></a>
<a name="ln-1340"></a>        <span class="c">!Hard-code the segments</span>
<a name="ln-1341"></a>        <span class="k">DO </span><span class="n">ThisCircuitPipeSegmentCounter</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumPipeSegments</span>
<a name="ln-1342"></a>            <span class="k">WRITE</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitCtr</span><span class="p">)%</span><span class="n">PipeSegmentNames</span><span class="p">(</span><span class="n">ThisCircuitPipeSegmentCounter</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1343"></a>                    <span class="s1">&#39;(&quot;HorizontalTrenchCircuit&quot;,I4,&quot;Segment&quot;,I4)&#39;</span><span class="p">)</span> <span class="n">HorizontalGHXCtr</span><span class="p">,</span> <span class="n">ThisCircuitPipeSegmentCounter</span>
<a name="ln-1344"></a>        <span class="k">END DO</span>
<a name="ln-1345"></a>
<a name="ln-1346"></a>        <span class="c">!******* Then we&#39;ll do the segments *******!</span>
<a name="ln-1347"></a>        <span class="k">DO </span><span class="n">ThisCircuitPipeSegmentCounter</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumPipeSegments</span>
<a name="ln-1348"></a>            <span class="n">SegmentCtr</span> <span class="o">=</span> <span class="n">SegmentCtr</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1349"></a>            <span class="k">WRITE</span><span class="p">(</span><span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">SegmentCtr</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="s1">&#39;(&quot;HorizontalTrenchCircuit&quot;,I4,&quot;Segment&quot;,I4)&#39;</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1350"></a>                                                                             <span class="n">HorizontalGHXCtr</span><span class="p">,</span> <span class="n">ThisCircuitPipeSegmentCounter</span>
<a name="ln-1351"></a>
<a name="ln-1352"></a>            <span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">SegmentCtr</span><span class="p">)%</span><span class="n">IsActuallyPartOfAHorizontalTrench</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1353"></a>            <span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">SegmentCtr</span><span class="p">)%</span><span class="n">PipeLocation</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1354"></a>                                       <span class="n">PointF</span><span class="p">(</span> <span class="n">ThisCircuitPipeSegmentCounter</span><span class="o">*</span><span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">InterPipeSpacing</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1355"></a>                                               <span class="n">HGHX</span><span class="p">(</span><span class="n">HorizontalGHXCtr</span><span class="p">)%</span><span class="n">BurialDepth</span> <span class="p">)</span>
<a name="ln-1356"></a>
<a name="ln-1357"></a>            <span class="k">IF</span> <span class="p">(</span><span class="nb">MOD</span><span class="p">(</span><span class="n">ThisCircuitPipeSegmentCounter</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1358"></a><span class="k">                </span><span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">SegmentCtr</span><span class="p">)%</span><span class="n">FlowDirection</span> <span class="o">=</span> <span class="n">SegmentFlow_IncreasingZ</span>
<a name="ln-1359"></a>            <span class="k">ELSE</span>
<a name="ln-1360"></a><span class="k">                </span><span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">SegmentCtr</span><span class="p">)%</span><span class="n">FlowDirection</span> <span class="o">=</span> <span class="n">SegmentFlow_DecreasingZ</span>
<a name="ln-1361"></a>            <span class="k">END IF</span>
<a name="ln-1362"></a>
<a name="ln-1363"></a><span class="k">        END DO</span>
<a name="ln-1364"></a>
<a name="ln-1365"></a><span class="k">    END DO</span>
<a name="ln-1366"></a>
<a name="ln-1367"></a><span class="k">  RETURN</span>
<a name="ln-1368"></a>
<a name="ln-1369"></a><span class="k">END SUBROUTINE</span>
<a name="ln-1370"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-1371"></a>
<a name="ln-1372"></a><span class="k">SUBROUTINE </span><span class="n">SetupAllOutputVariables</span><span class="p">(</span><span class="n">TotalNumSegments</span><span class="p">,</span> <span class="n">TotalNumCircuits</span><span class="p">)</span>
<a name="ln-1373"></a>
<a name="ln-1374"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1375"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-1376"></a>          <span class="c">!       DATE WRITTEN   September 2012</span>
<a name="ln-1377"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-1378"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1379"></a>
<a name="ln-1380"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1381"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-1382"></a>
<a name="ln-1383"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1384"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-1385"></a>
<a name="ln-1386"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1387"></a>          <span class="c">! na</span>
<a name="ln-1388"></a>
<a name="ln-1389"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1390"></a>    <span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SetupOutputVariable</span>
<a name="ln-1391"></a>
<a name="ln-1392"></a>    <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1393"></a>
<a name="ln-1394"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1395"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotalNumSegments</span>
<a name="ln-1396"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotalNumCircuits</span>
<a name="ln-1397"></a>
<a name="ln-1398"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1399"></a>          <span class="c">! na</span>
<a name="ln-1400"></a>
<a name="ln-1401"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-1402"></a>          <span class="c">! na</span>
<a name="ln-1403"></a>
<a name="ln-1404"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-1405"></a>          <span class="c">! na</span>
<a name="ln-1406"></a>
<a name="ln-1407"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1408"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">PipeCircuitCounter</span>
<a name="ln-1409"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SegmentCtr</span>
<a name="ln-1410"></a>
<a name="ln-1411"></a>    <span class="k">DO </span><span class="n">SegmentCtr</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotalNumSegments</span>
<a name="ln-1412"></a>
<a name="ln-1413"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">SegmentCtr</span><span class="p">)%</span><span class="n">IsActuallyPartOfAHorizontalTrench</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1414"></a>
<a name="ln-1415"></a><span class="k">            CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Pipe Segment Inlet Temperature [C]&#39;</span><span class="p">,</span>      <span class="p">&amp;</span>
<a name="ln-1416"></a>                                     <span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">SegmentCtr</span><span class="p">)%</span><span class="n">InletTemperature</span><span class="p">,</span><span class="s1">&#39;Plant&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1417"></a>                                     <span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">SegmentCtr</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1418"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Pipe Segment Outlet Temperature [C]&#39;</span><span class="p">,</span>      <span class="p">&amp;</span>
<a name="ln-1419"></a>                                     <span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">SegmentCtr</span><span class="p">)%</span><span class="n">OutletTemperature</span><span class="p">,</span><span class="s1">&#39;Plant&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1420"></a>                                     <span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">SegmentCtr</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1421"></a>
<a name="ln-1422"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Pipe Segment Fluid Heat Transfer Rate [W]&#39;</span><span class="p">,</span>      <span class="p">&amp;</span>
<a name="ln-1423"></a>                                     <span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">SegmentCtr</span><span class="p">)%</span><span class="n">FluidHeatLoss</span><span class="p">,</span><span class="s1">&#39;Plant&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1424"></a>                                     <span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">SegmentCtr</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1425"></a>
<a name="ln-1426"></a>        <span class="k">END IF</span>
<a name="ln-1427"></a>
<a name="ln-1428"></a><span class="k">    END DO</span>
<a name="ln-1429"></a>
<a name="ln-1430"></a><span class="k">    DO </span><span class="n">PipeCircuitCounter</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotalNumCircuits</span>
<a name="ln-1431"></a>
<a name="ln-1432"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">PipeCircuitCounter</span><span class="p">)%</span><span class="n">IsActuallyPartOfAHorizontalTrench</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1433"></a>
<a name="ln-1434"></a><span class="k">            CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Pipe Circuit Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span>      <span class="p">&amp;</span>
<a name="ln-1435"></a>                                     <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">PipeCircuitCounter</span><span class="p">)%</span><span class="n">CurCircuitFlowRate</span><span class="p">,</span><span class="s1">&#39;Plant&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1436"></a>                                     <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">PipeCircuitCounter</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1437"></a>
<a name="ln-1438"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Pipe Circuit Inlet Temperature [C]&#39;</span><span class="p">,</span>      <span class="p">&amp;</span>
<a name="ln-1439"></a>                                     <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">PipeCircuitCounter</span><span class="p">)%</span><span class="n">InletTemperature</span><span class="p">,</span><span class="s1">&#39;Plant&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1440"></a>                                     <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">PipeCircuitCounter</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1441"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Pipe Circuit Outlet Temperature [C]&#39;</span><span class="p">,</span>      <span class="p">&amp;</span>
<a name="ln-1442"></a>                                     <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">PipeCircuitCounter</span><span class="p">)%</span><span class="n">OutletTemperature</span><span class="p">,</span><span class="s1">&#39;Plant&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1443"></a>                                     <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">PipeCircuitCounter</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1444"></a>
<a name="ln-1445"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Pipe Circuit Fluid Heat Transfer Rate [W]&#39;</span><span class="p">,</span>      <span class="p">&amp;</span>
<a name="ln-1446"></a>                                     <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">PipeCircuitCounter</span><span class="p">)%</span><span class="n">FluidHeatLoss</span><span class="p">,</span><span class="s1">&#39;Plant&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1447"></a>                                     <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">PipeCircuitCounter</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1448"></a>
<a name="ln-1449"></a>        <span class="k">ELSE</span> <span class="c">! it is a horizontal trench</span>
<a name="ln-1450"></a>
<a name="ln-1451"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Ground Heat Exchanger Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span>      <span class="p">&amp;</span>
<a name="ln-1452"></a>                                     <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">PipeCircuitCounter</span><span class="p">)%</span><span class="n">CurCircuitFlowRate</span><span class="p">,</span><span class="s1">&#39;Plant&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1453"></a>                                     <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">PipeCircuitCounter</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1454"></a>
<a name="ln-1455"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Ground Heat Exchanger Inlet Temperature [C]&#39;</span><span class="p">,</span>      <span class="p">&amp;</span>
<a name="ln-1456"></a>                                     <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">PipeCircuitCounter</span><span class="p">)%</span><span class="n">InletTemperature</span><span class="p">,</span><span class="s1">&#39;Plant&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1457"></a>                                     <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">PipeCircuitCounter</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1458"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Ground Heat Exchanger Outlet Temperature [C]&#39;</span><span class="p">,</span>      <span class="p">&amp;</span>
<a name="ln-1459"></a>                                     <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">PipeCircuitCounter</span><span class="p">)%</span><span class="n">OutletTemperature</span><span class="p">,</span><span class="s1">&#39;Plant&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1460"></a>                                     <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">PipeCircuitCounter</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1461"></a>
<a name="ln-1462"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Ground Heat Exchanger Fluid Heat Transfer Rate [W]&#39;</span><span class="p">,</span>      <span class="p">&amp;</span>
<a name="ln-1463"></a>                                     <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">PipeCircuitCounter</span><span class="p">)%</span><span class="n">FluidHeatLoss</span><span class="p">,</span><span class="s1">&#39;Plant&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1464"></a>                                     <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">PipeCircuitCounter</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1465"></a>
<a name="ln-1466"></a>        <span class="k">END IF</span>
<a name="ln-1467"></a>
<a name="ln-1468"></a><span class="k">    END DO</span>
<a name="ln-1469"></a>
<a name="ln-1470"></a><span class="k">  RETURN</span>
<a name="ln-1471"></a>
<a name="ln-1472"></a><span class="k">END SUBROUTINE</span>
<a name="ln-1473"></a>
<a name="ln-1474"></a>
<a name="ln-1475"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-1476"></a><span class="k">SUBROUTINE </span><span class="n">InitPipingSystems</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">CircuitNum</span><span class="p">)</span>
<a name="ln-1477"></a>
<a name="ln-1478"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1479"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-1480"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-1481"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-1482"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1483"></a>
<a name="ln-1484"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1485"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-1486"></a>
<a name="ln-1487"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1488"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-1489"></a>
<a name="ln-1490"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1491"></a>          <span class="c">! na</span>
<a name="ln-1492"></a>
<a name="ln-1493"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1494"></a>    <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span>   <span class="n">ONLY</span> <span class="p">:</span> <span class="n">TimeStepSys</span><span class="p">,</span> <span class="n">SysTimeElapsed</span>
<a name="ln-1495"></a>    <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ScanPlantLoopsForObject</span><span class="p">,</span> <span class="n">TypeOf_PipingSystemPipeCircuit</span><span class="p">,</span> <span class="n">PlantLoop</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1496"></a>                        <span class="n">TypeOf_GrndHtExchgHorizTrench</span>
<a name="ln-1497"></a>    <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>       <span class="n">ONLY</span> <span class="p">:</span> <span class="n">BeginSimFlag</span><span class="p">,</span> <span class="n">BeginEnvrnFlag</span><span class="p">,</span> <span class="n">DayOfSim</span><span class="p">,</span> <span class="n">HourOfDay</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1498"></a>                                  <span class="n">TimeStep</span><span class="p">,</span> <span class="n">TimeStepZone</span><span class="p">,</span> <span class="n">SecInHour</span><span class="p">,</span> <span class="n">InitConvTemp</span>
<a name="ln-1499"></a>    <span class="k">USE </span><span class="n">DataLoopNode</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">Node</span>
<a name="ln-1500"></a>    <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SetComponentFlowRate</span>
<a name="ln-1501"></a>    <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetDensityGlycol</span>
<a name="ln-1502"></a>
<a name="ln-1503"></a>    <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1504"></a>
<a name="ln-1505"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1506"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DomainNum</span>
<a name="ln-1507"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CircuitNum</span>
<a name="ln-1508"></a>
<a name="ln-1509"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1510"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RoutineName</span> <span class="o">=</span> <span class="s1">&#39;InitPipingSystems&#39;</span>
<a name="ln-1511"></a>
<a name="ln-1512"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-1513"></a>          <span class="c">! na</span>
<a name="ln-1514"></a>
<a name="ln-1515"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-1516"></a>          <span class="c">! na</span>
<a name="ln-1517"></a>
<a name="ln-1518"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1519"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">errFlag</span>
<a name="ln-1520"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">InletNodeNum</span>
<a name="ln-1521"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">OutletNodeNum</span>
<a name="ln-1522"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CircCtr</span>
<a name="ln-1523"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SegCtr</span>
<a name="ln-1524"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SegmentIndex</span>
<a name="ln-1525"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rho</span>
<a name="ln-1526"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TypeToLookFor</span>
<a name="ln-1527"></a>
<a name="ln-1528"></a>    <span class="c">!Do any one-time initializations</span>
<a name="ln-1529"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">NeedToFindOnPlantLoop</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1530"></a>
<a name="ln-1531"></a><span class="k">        </span><span class="n">errFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1532"></a>
<a name="ln-1533"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">IsActuallyPartOfAHorizontalTrench</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1534"></a><span class="k">            </span><span class="n">TypeToLookFor</span> <span class="o">=</span> <span class="n">TypeOf_GrndHtExchgHorizTrench</span>
<a name="ln-1535"></a>        <span class="k">ELSE</span>
<a name="ln-1536"></a><span class="k">            </span><span class="n">TypeToLookFor</span> <span class="o">=</span> <span class="n">TypeOf_PipingSystemPipeCircuit</span>
<a name="ln-1537"></a>        <span class="k">END IF</span>
<a name="ln-1538"></a>
<a name="ln-1539"></a><span class="k">        CALL </span><span class="n">ScanPlantLoopsForObject</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1540"></a>                                     <span class="n">TypeToLookFor</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1541"></a>                                     <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1542"></a>                                     <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">LoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1543"></a>                                     <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">BranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1544"></a>                                     <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">CompNum</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1545"></a>                                     <span class="n">errFlag</span><span class="o">=</span><span class="n">errFlag</span><span class="p">)</span>
<a name="ln-1546"></a>
<a name="ln-1547"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">errFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1548"></a><span class="k">            CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;PipingSystems:&#39;</span><span class="o">//</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;: Program terminated due to previous condition(s).&#39;</span><span class="p">)</span>
<a name="ln-1549"></a>        <span class="k">END IF</span>
<a name="ln-1550"></a>
<a name="ln-1551"></a>        <span class="c">!Once we find ourselves on the plant loop, we can do other things</span>
<a name="ln-1552"></a>        <span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1553"></a>                                <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1554"></a>                                <span class="n">PlantLoop</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,&amp;</span>
<a name="ln-1555"></a>                                <span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-1556"></a>        <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">DesignMassFlowRate</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1557"></a>                                <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">DesignVolumeFlowRate</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-1558"></a>
<a name="ln-1559"></a>        <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">NeedToFindOnPlantLoop</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1560"></a>
<a name="ln-1561"></a>    <span class="k">END IF</span>
<a name="ln-1562"></a>
<a name="ln-1563"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">DomainNeedsToBeMeshed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1564"></a>
<a name="ln-1565"></a><span class="k">        CALL </span><span class="n">DevelopMesh</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)</span>
<a name="ln-1566"></a>
<a name="ln-1567"></a>        <span class="c">! would be OK to do some post-mesh error handling here I think</span>
<a name="ln-1568"></a>        <span class="k">DO </span><span class="n">CircCtr</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">SIZE</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">CircuitIndeces</span><span class="p">)</span>
<a name="ln-1569"></a>            <span class="k">DO </span><span class="n">SegCtr</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">SIZE</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">CircuitIndeces</span><span class="p">(</span><span class="n">CircCtr</span><span class="p">))%</span><span class="n">PipeSegmentIndeces</span><span class="p">)</span>
<a name="ln-1570"></a>             <span class="n">SegmentIndex</span> <span class="o">=</span> <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">CircuitIndeces</span><span class="p">(</span><span class="n">CircCtr</span><span class="p">))%</span><span class="n">PipeSegmentIndeces</span><span class="p">(</span><span class="n">SegCtr</span><span class="p">)</span>
<a name="ln-1571"></a>                <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">SegmentIndex</span><span class="p">)%</span><span class="n">PipeCellCoordinatesSet</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1572"></a><span class="k">                    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;PipingSystems:&#39;</span><span class="o">//</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;:Pipe segment index not set.&#39;</span><span class="p">)</span>
<a name="ln-1573"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Possibly because pipe segment was placed outside of the domain.&#39;</span><span class="p">)</span>
<a name="ln-1574"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Verify piping system domain inputs, circuits, and segments.&#39;</span><span class="p">)</span>
<a name="ln-1575"></a>                    <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Preceding error causes program termination&#39;</span><span class="p">)</span>
<a name="ln-1576"></a>                <span class="k">END IF</span>
<a name="ln-1577"></a><span class="k">            END DO</span>
<a name="ln-1578"></a><span class="k">        END DO</span>
<a name="ln-1579"></a>
<a name="ln-1580"></a><span class="k">        </span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">DomainNeedsToBeMeshed</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1581"></a>
<a name="ln-1582"></a>    <span class="k">END IF</span>
<a name="ln-1583"></a>
<a name="ln-1584"></a>    <span class="c">!The time init should be done here before we DoOneTimeInits because the DoOneTimeInits</span>
<a name="ln-1585"></a>    <span class="c">! includes a ground temperature initialization, which is based on the Cur%CurSimTimeSeconds variable</span>
<a name="ln-1586"></a>    <span class="c">! which would be carried over from the previous environment</span>
<a name="ln-1587"></a>    <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cur</span><span class="p">%</span><span class="n">CurSimTimeStepSize</span> <span class="o">=</span> <span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-1588"></a>    <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cur</span><span class="p">%</span><span class="n">CurSimTimeSeconds</span> <span class="o">=</span>   <span class="p">(</span><span class="n">dayofSim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">24</span>           <span class="p">&amp;</span>
<a name="ln-1589"></a>                                                           <span class="o">+</span> <span class="p">(</span><span class="n">hourofday</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>               <span class="p">&amp;</span>
<a name="ln-1590"></a>                                                           <span class="o">+</span> <span class="p">(</span><span class="n">timestep</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">timestepZone</span> <span class="p">&amp;</span>
<a name="ln-1591"></a>                                                           <span class="o">+</span> <span class="n">SysTimeElapsed</span>
<a name="ln-1592"></a>
<a name="ln-1593"></a>    <span class="c">!There are also some inits that are &quot;close to one time&quot; inits...(one-time in standalone, each envrn in E+)</span>
<a name="ln-1594"></a>    <span class="k">IF</span><span class="p">(</span>     <span class="p">(</span><span class="n">BeginSimFlag</span>   <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BeginSimInit</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1595"></a>       <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">BeginEnvrnFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BeginSimEnvrn</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1596"></a>
<a name="ln-1597"></a>        <span class="c">! this seemed to clean up a lot of reverse DD stuff because fluid thermal properties were</span>
<a name="ln-1598"></a>        <span class="c">! being based on the inlet temperature, which wasn&#39;t updated until later</span>
<a name="ln-1599"></a>        <span class="n">InletNodeNum</span> <span class="o">=</span> <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">InletNodeNum</span>
<a name="ln-1600"></a>        <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">CurCircuitInletTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">InletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-1601"></a>        <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">InletTemperature</span> <span class="o">=</span> <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">CurCircuitInletTemp</span>
<a name="ln-1602"></a>
<a name="ln-1603"></a>        <span class="k">CALL </span><span class="n">DoOneTimeInitializations</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">CircuitNum</span><span class="p">)</span>
<a name="ln-1604"></a>
<a name="ln-1605"></a>        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BeginSimInit</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1606"></a>        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BeginSimEnvrn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1607"></a>
<a name="ln-1608"></a>    <span class="k">END IF</span>
<a name="ln-1609"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">BeginSimFlag</span><span class="p">)</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BeginSimInit</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1610"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">BeginEnvrnFlag</span><span class="p">)</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BeginSimEnvrn</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1611"></a>
<a name="ln-1612"></a>    <span class="c">!Shift history arrays only if necessary</span>
<a name="ln-1613"></a>    <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cur</span><span class="p">%</span><span class="n">CurSimTimeSeconds</span><span class="o">-</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cur</span><span class="p">%</span><span class="n">PrevSimTimeSeconds</span><span class="p">)</span><span class="o">&gt;</span><span class="mf">1.0d-6</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1614"></a><span class="k">        </span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cur</span><span class="p">%</span><span class="n">PrevSimTimeSeconds</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cur</span><span class="p">%</span><span class="n">CurSimTimeSeconds</span>
<a name="ln-1615"></a>        <span class="k">CALL </span><span class="n">ShiftTemperaturesForNewTimeStep</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)</span>
<a name="ln-1616"></a>        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">DomainNeedsSimulation</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1617"></a>    <span class="k">END IF</span>
<a name="ln-1618"></a>
<a name="ln-1619"></a>    <span class="c">!Get the mass flow and inlet temperature to use for this time step</span>
<a name="ln-1620"></a>    <span class="n">InletNodeNum</span> <span class="o">=</span> <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">InletNodeNum</span>
<a name="ln-1621"></a>    <span class="n">OutletNodeNum</span> <span class="o">=</span> <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">OutletNodeNum</span>
<a name="ln-1622"></a>    <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">CurCircuitInletTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">InletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-1623"></a>
<a name="ln-1624"></a>    <span class="c">!request design, set component flow will decide what to give us based on restrictions and flow lock status</span>
<a name="ln-1625"></a>    <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">CurCircuitFlowRate</span> <span class="o">=</span> <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">DesignMassFlowRate</span>
<a name="ln-1626"></a>    <span class="k">CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span> <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">CurCircuitFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1627"></a>                               <span class="n">InletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1628"></a>                               <span class="n">OutletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1629"></a>                               <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1630"></a>                               <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">LoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1631"></a>                               <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">BranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1632"></a>                               <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">CompNum</span><span class="p">)</span>
<a name="ln-1633"></a>
<a name="ln-1634"></a>  <span class="k">RETURN</span>
<a name="ln-1635"></a>
<a name="ln-1636"></a><span class="k">END SUBROUTINE </span><span class="n">InitPipingSystems</span>
<a name="ln-1637"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-1638"></a>
<a name="ln-1639"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-1640"></a><span class="k">SUBROUTINE </span><span class="n">UpdatePipingSystems</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">CircuitNum</span><span class="p">)</span>
<a name="ln-1641"></a>
<a name="ln-1642"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1643"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-1644"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-1645"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-1646"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1647"></a>
<a name="ln-1648"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1649"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-1650"></a>
<a name="ln-1651"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1652"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-1653"></a>
<a name="ln-1654"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1655"></a>          <span class="c">! na</span>
<a name="ln-1656"></a>
<a name="ln-1657"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1658"></a>    <span class="k">USE </span><span class="n">DataLoopNode</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">Node</span>
<a name="ln-1659"></a>
<a name="ln-1660"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1661"></a>
<a name="ln-1662"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1663"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DomainNum</span>
<a name="ln-1664"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CircuitNum</span>
<a name="ln-1665"></a>
<a name="ln-1666"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1667"></a>          <span class="c">! na</span>
<a name="ln-1668"></a>
<a name="ln-1669"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-1670"></a>          <span class="c">! na</span>
<a name="ln-1671"></a>
<a name="ln-1672"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-1673"></a>          <span class="c">! na</span>
<a name="ln-1674"></a>
<a name="ln-1675"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1676"></a>        <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">OutletNodeNum</span>
<a name="ln-1677"></a>
<a name="ln-1678"></a>        <span class="n">OutletNodeNum</span> <span class="o">=</span> <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">OutletNodeNum</span>
<a name="ln-1679"></a>        <span class="n">Node</span><span class="p">(</span><span class="n">OutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span>    <span class="p">&amp;</span>
<a name="ln-1680"></a>            <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">CircuitOutletCell</span><span class="p">%</span><span class="n">X</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1681"></a>            <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">CircuitOutletCell</span><span class="p">%</span><span class="n">Y</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1682"></a>            <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">CircuitOutletCell</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1683"></a>                <span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Fluid</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span>
<a name="ln-1684"></a>  <span class="k">RETURN</span>
<a name="ln-1685"></a>
<a name="ln-1686"></a><span class="k">END SUBROUTINE </span><span class="n">UpdatePipingSystems</span>
<a name="ln-1687"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-1688"></a>
<a name="ln-1689"></a><span class="c">!=====================  Utility/Other routines for module.</span>
<a name="ln-1690"></a>
<a name="ln-1691"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-1692"></a><span class="k">SUBROUTINE </span><span class="n">IssueSevereAlphaInputFieldError</span><span class="p">(</span><span class="n">RoutineName</span><span class="p">,</span> <span class="n">ObjectName</span><span class="p">,</span> <span class="n">InstanceName</span><span class="p">,</span> <span class="n">FieldName</span><span class="p">,</span> <span class="n">FieldEntry</span><span class="p">,</span> <span class="n">Condition</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-1693"></a>
<a name="ln-1694"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1695"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-1696"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-1697"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-1698"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1699"></a>
<a name="ln-1700"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1701"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-1702"></a>
<a name="ln-1703"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1704"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-1705"></a>
<a name="ln-1706"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1707"></a>          <span class="c">! na</span>
<a name="ln-1708"></a>
<a name="ln-1709"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1710"></a>    <span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ShowSevereError</span>
<a name="ln-1711"></a>
<a name="ln-1712"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1713"></a>
<a name="ln-1714"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1715"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">LEN</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RoutineName</span>
<a name="ln-1716"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">LEN</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ObjectName</span>
<a name="ln-1717"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">LEN</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InstanceName</span>
<a name="ln-1718"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">LEN</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FieldName</span>
<a name="ln-1719"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">LEN</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FieldEntry</span>
<a name="ln-1720"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">LEN</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Condition</span>
<a name="ln-1721"></a>    <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span> <span class="n">OUT</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">ErrorsFound</span>
<a name="ln-1722"></a>
<a name="ln-1723"></a>    <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoutineName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ObjectName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">InstanceName</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1724"></a>          <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">FieldName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">FieldEntry</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, Condition: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Condition</span><span class="p">))</span>
<a name="ln-1725"></a>
<a name="ln-1726"></a>    <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1727"></a>
<a name="ln-1728"></a>  <span class="k">RETURN</span>
<a name="ln-1729"></a>
<a name="ln-1730"></a><span class="k">END SUBROUTINE </span><span class="n">IssueSevereAlphaInputFieldError</span>
<a name="ln-1731"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-1732"></a>
<a name="ln-1733"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-1734"></a><span class="k">SUBROUTINE </span><span class="n">IssueSevereRealInputFieldError</span><span class="p">(</span><span class="n">RoutineName</span><span class="p">,</span> <span class="n">ObjectName</span><span class="p">,</span> <span class="n">InstanceName</span><span class="p">,</span> <span class="n">FieldName</span><span class="p">,</span> <span class="n">FieldEntry</span><span class="p">,</span> <span class="n">Condition</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-1735"></a>
<a name="ln-1736"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1737"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-1738"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-1739"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-1740"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1741"></a>
<a name="ln-1742"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1743"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-1744"></a>
<a name="ln-1745"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1746"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-1747"></a>
<a name="ln-1748"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1749"></a>          <span class="c">! na</span>
<a name="ln-1750"></a>
<a name="ln-1751"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1752"></a>    <span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ShowSevereError</span>
<a name="ln-1753"></a>    <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-1754"></a>
<a name="ln-1755"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1756"></a>
<a name="ln-1757"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1758"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">LEN</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">RoutineName</span>
<a name="ln-1759"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">LEN</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">ObjectName</span>
<a name="ln-1760"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">LEN</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">InstanceName</span>
<a name="ln-1761"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">LEN</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">FieldName</span>
<a name="ln-1762"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>        <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">FieldEntry</span>
<a name="ln-1763"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">LEN</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">Condition</span>
<a name="ln-1764"></a>    <span class="kt">LOGICAL</span><span class="p">,</span>          <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span> <span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrorsFound</span>
<a name="ln-1765"></a>
<a name="ln-1766"></a>    <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoutineName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ObjectName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">InstanceName</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1767"></a>          <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">FieldName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">FieldEntry</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, Condition: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Condition</span><span class="p">))</span>
<a name="ln-1768"></a>
<a name="ln-1769"></a>    <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1770"></a>
<a name="ln-1771"></a>  <span class="k">RETURN</span>
<a name="ln-1772"></a>
<a name="ln-1773"></a><span class="k">END SUBROUTINE </span><span class="n">IssueSevereRealInputFieldError</span>
<a name="ln-1774"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-1775"></a>
<a name="ln-1776"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-1777"></a><span class="kt">INTEGER </span><span class="k">FUNCTION </span><span class="n">GetSurfaceCountForOSCM</span><span class="p">(</span><span class="n">OSCMIndex</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">RetVal</span><span class="p">)</span>
<a name="ln-1778"></a>
<a name="ln-1779"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-1780"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-1781"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-1782"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-1783"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1784"></a>
<a name="ln-1785"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-1786"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-1787"></a>
<a name="ln-1788"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1789"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-1790"></a>
<a name="ln-1791"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1792"></a>          <span class="c">! na</span>
<a name="ln-1793"></a>
<a name="ln-1794"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1795"></a>    <span class="k">USE </span><span class="n">DataSurfaces</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">Surface</span>
<a name="ln-1796"></a>
<a name="ln-1797"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1798"></a>
<a name="ln-1799"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-1800"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OSCMIndex</span>
<a name="ln-1801"></a>
<a name="ln-1802"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1803"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SurfCtr</span>
<a name="ln-1804"></a>
<a name="ln-1805"></a>    <span class="n">RetVal</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1806"></a>    <span class="k">DO </span><span class="n">SurfCtr</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">SIZE</span><span class="p">(</span><span class="n">Surface</span><span class="p">)</span>
<a name="ln-1807"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfCtr</span><span class="p">)%</span><span class="n">OSCMPtr</span> <span class="o">==</span> <span class="n">OSCMIndex</span><span class="p">)</span> <span class="n">RetVal</span> <span class="o">=</span> <span class="n">RetVal</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1808"></a>    <span class="k">END DO</span>
<a name="ln-1809"></a>
<a name="ln-1810"></a><span class="k">  RETURN</span>
<a name="ln-1811"></a>
<a name="ln-1812"></a><span class="k">END FUNCTION </span><span class="n">GetSurfaceCountForOSCM</span>
<a name="ln-1813"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-1814"></a>
<a name="ln-1815"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-1816"></a><span class="k">FUNCTION </span><span class="n">GetSurfaceIndecesForOSCM</span><span class="p">(</span><span class="n">OSCMIndex</span><span class="p">,</span> <span class="n">SurfCount</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">RetVal</span><span class="p">)</span>
<a name="ln-1817"></a>
<a name="ln-1818"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-1819"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-1820"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-1821"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-1822"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1823"></a>
<a name="ln-1824"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-1825"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-1826"></a>
<a name="ln-1827"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1828"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-1829"></a>
<a name="ln-1830"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1831"></a>          <span class="c">! na</span>
<a name="ln-1832"></a>
<a name="ln-1833"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1834"></a>    <span class="k">USE </span><span class="n">DataSurfaces</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">Surface</span>
<a name="ln-1835"></a>
<a name="ln-1836"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1837"></a>
<a name="ln-1838"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-1839"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OSCMIndex</span>
<a name="ln-1840"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfCount</span>
<a name="ln-1841"></a>
<a name="ln-1842"></a>          <span class="c">! FUNCTION RETURN VALUE DEFINITION:</span>
<a name="ln-1843"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">SurfCount</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RetVal</span>
<a name="ln-1844"></a>
<a name="ln-1845"></a>            <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1846"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SurfCtr</span>
<a name="ln-1847"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">FoundSurfIndexCtr</span>
<a name="ln-1848"></a>
<a name="ln-1849"></a>    <span class="n">FoundSurfIndexCtr</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1850"></a>    <span class="k">DO </span><span class="n">SurfCtr</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">SIZE</span><span class="p">(</span><span class="n">Surface</span><span class="p">)</span>
<a name="ln-1851"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfCtr</span><span class="p">)%</span><span class="n">OSCMPtr</span> <span class="o">==</span> <span class="n">OSCMIndex</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1852"></a><span class="k">            </span><span class="n">FoundSurfIndexCtr</span> <span class="o">=</span> <span class="n">FoundSurfIndexCtr</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1853"></a>            <span class="n">RetVal</span><span class="p">(</span><span class="n">FoundSurfIndexCtr</span><span class="p">)</span> <span class="o">=</span> <span class="n">SurfCtr</span>
<a name="ln-1854"></a>        <span class="k">END IF</span>
<a name="ln-1855"></a><span class="k">    END DO</span>
<a name="ln-1856"></a>
<a name="ln-1857"></a><span class="k">  RETURN</span>
<a name="ln-1858"></a>
<a name="ln-1859"></a><span class="k">END FUNCTION </span><span class="n">GetSurfaceIndecesForOSCM</span>
<a name="ln-1860"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-1861"></a>
<a name="ln-1862"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-1863"></a><span class="kt">LOGICAL </span><span class="k">FUNCTION </span><span class="n">Integer_IsInRange</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">RetVal</span><span class="p">)</span>
<a name="ln-1864"></a>
<a name="ln-1865"></a>      <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-1866"></a>      <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-1867"></a>      <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-1868"></a>      <span class="c">!       MODIFIED       na</span>
<a name="ln-1869"></a>      <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1870"></a>
<a name="ln-1871"></a>      <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-1872"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-1873"></a>
<a name="ln-1874"></a>      <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1875"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-1876"></a>
<a name="ln-1877"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1878"></a>
<a name="ln-1879"></a>      <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-1880"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-1881"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lower</span>
<a name="ln-1882"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">upper</span>
<a name="ln-1883"></a>
<a name="ln-1884"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">i</span> <span class="o">&gt;=</span> <span class="n">lower</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;=</span> <span class="n">upper</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1885"></a><span class="k">        </span><span class="n">RetVal</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1886"></a>    <span class="k">ELSE</span>
<a name="ln-1887"></a><span class="k">        </span><span class="n">RetVal</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1888"></a>    <span class="k">END IF</span>
<a name="ln-1889"></a>
<a name="ln-1890"></a><span class="k">    RETURN</span>
<a name="ln-1891"></a>
<a name="ln-1892"></a><span class="k">END FUNCTION</span>
<a name="ln-1893"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-1894"></a>
<a name="ln-1895"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-1896"></a><span class="kt">LOGICAL </span><span class="k">FUNCTION </span><span class="n">Real_IsInRange</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">RetVal</span><span class="p">)</span>
<a name="ln-1897"></a>
<a name="ln-1898"></a>      <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-1899"></a>      <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-1900"></a>      <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-1901"></a>      <span class="c">!       MODIFIED       na</span>
<a name="ln-1902"></a>      <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1903"></a>
<a name="ln-1904"></a>      <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-1905"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-1906"></a>
<a name="ln-1907"></a>      <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1908"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-1909"></a>
<a name="ln-1910"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1911"></a>
<a name="ln-1912"></a>      <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-1913"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">r</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span>
<a name="ln-1914"></a>
<a name="ln-1915"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">r</span> <span class="o">&gt;=</span> <span class="n">lower</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">r</span> <span class="o">&lt;=</span> <span class="n">upper</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1916"></a><span class="k">        </span><span class="n">RetVal</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1917"></a>    <span class="k">ELSE</span>
<a name="ln-1918"></a><span class="k">        </span><span class="n">RetVal</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1919"></a>    <span class="k">END IF</span>
<a name="ln-1920"></a>
<a name="ln-1921"></a><span class="k">    RETURN</span>
<a name="ln-1922"></a>
<a name="ln-1923"></a><span class="k">END FUNCTION</span>
<a name="ln-1924"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-1925"></a>
<a name="ln-1926"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-1927"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">Real_ConstrainTo</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="nb">MinVal</span><span class="p">,</span> <span class="nb">MaxVal</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">RetVal</span><span class="p">)</span>
<a name="ln-1928"></a>
<a name="ln-1929"></a>      <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-1930"></a>      <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-1931"></a>      <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-1932"></a>      <span class="c">!       MODIFIED       na</span>
<a name="ln-1933"></a>      <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1934"></a>
<a name="ln-1935"></a>      <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-1936"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-1937"></a>
<a name="ln-1938"></a>      <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1939"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-1940"></a>
<a name="ln-1941"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1942"></a>
<a name="ln-1943"></a>      <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-1944"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">r</span><span class="p">,</span> <span class="nb">MinVal</span><span class="p">,</span> <span class="nb">MaxVal</span>
<a name="ln-1945"></a>
<a name="ln-1946"></a><span class="nb">    </span><span class="n">RetVal</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="nb">MaxVal</span><span class="p">)</span>
<a name="ln-1947"></a>    <span class="n">RetVal</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="nb">MinVal</span><span class="p">)</span>
<a name="ln-1948"></a>
<a name="ln-1949"></a>    <span class="k">RETURN</span>
<a name="ln-1950"></a>
<a name="ln-1951"></a><span class="k">END FUNCTION</span>
<a name="ln-1952"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-1953"></a>
<a name="ln-1954"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-1955"></a><span class="kt">LOGICAL </span><span class="k">FUNCTION </span><span class="n">CellType_IsFieldCell</span><span class="p">(</span><span class="n">CellType</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">RetVal</span><span class="p">)</span>
<a name="ln-1956"></a>
<a name="ln-1957"></a>      <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-1958"></a>      <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-1959"></a>      <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-1960"></a>      <span class="c">!       MODIFIED       na</span>
<a name="ln-1961"></a>      <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1962"></a>
<a name="ln-1963"></a>      <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-1964"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-1965"></a>
<a name="ln-1966"></a>      <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1967"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-1968"></a>
<a name="ln-1969"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1970"></a>
<a name="ln-1971"></a>      <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-1972"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CellType</span> <span class="c">!From Enum: CellType</span>
<a name="ln-1973"></a>
<a name="ln-1974"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">CellType</span><span class="p">)</span>
<a name="ln-1975"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">CellType_GeneralField</span><span class="p">,</span> <span class="n">CellType_BasementCorner</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1976"></a>          <span class="n">CellType_BasementWall</span><span class="p">,</span> <span class="n">CellType_BasementFloor</span><span class="p">)</span>
<a name="ln-1977"></a>        <span class="n">RetVal</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1978"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1979"></a>        <span class="n">RetVal</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1980"></a>    <span class="k">END SELECT</span>
<a name="ln-1981"></a>
<a name="ln-1982"></a><span class="k">    RETURN</span>
<a name="ln-1983"></a>
<a name="ln-1984"></a><span class="k">END FUNCTION</span>
<a name="ln-1985"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-1986"></a>
<a name="ln-1987"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-1988"></a><span class="kt">LOGICAL </span><span class="k">FUNCTION </span><span class="n">MeshPartitionArray_Contains</span><span class="p">(</span><span class="n">meshes</span><span class="p">,</span> <span class="k">value</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">RetVal</span><span class="p">)</span>
<a name="ln-1989"></a>
<a name="ln-1990"></a>      <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-1991"></a>      <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-1992"></a>      <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-1993"></a>      <span class="c">!       MODIFIED       na</span>
<a name="ln-1994"></a>      <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1995"></a>
<a name="ln-1996"></a>      <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-1997"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-1998"></a>
<a name="ln-1999"></a>      <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2000"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2001"></a>
<a name="ln-2002"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2003"></a>
<a name="ln-2004"></a>      <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-2005"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">MeshPartition</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">meshes</span>
<a name="ln-2006"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="k">value</span>
<a name="ln-2007"></a>
<a name="ln-2008"></a>      <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2009"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">meshnum</span>
<a name="ln-2010"></a>
<a name="ln-2011"></a>    <span class="n">RetVal</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2012"></a>
<a name="ln-2013"></a>    <span class="k">DO </span><span class="n">meshnum</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">meshes</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">meshes</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-2014"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">meshes</span><span class="p">(</span><span class="n">meshnum</span><span class="p">)%</span><span class="n">rDimension</span> <span class="o">==</span> <span class="k">value</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2015"></a><span class="k">            </span><span class="n">RetVal</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2016"></a>            <span class="k">EXIT</span>
<a name="ln-2017"></a><span class="k">        END IF</span>
<a name="ln-2018"></a><span class="k">    END DO</span>
<a name="ln-2019"></a>
<a name="ln-2020"></a><span class="k">    RETURN</span>
<a name="ln-2021"></a>
<a name="ln-2022"></a><span class="k">END FUNCTION</span>
<a name="ln-2023"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2024"></a>
<a name="ln-2025"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2026"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">RadialCellInfo_XY_CrossSectArea</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">RetVal</span><span class="p">)</span>
<a name="ln-2027"></a>
<a name="ln-2028"></a>      <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-2029"></a>      <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-2030"></a>      <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-2031"></a>      <span class="c">!       MODIFIED       na</span>
<a name="ln-2032"></a>      <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2033"></a>
<a name="ln-2034"></a>      <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-2035"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2036"></a>
<a name="ln-2037"></a>      <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2038"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2039"></a>
<a name="ln-2040"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2041"></a>
<a name="ln-2042"></a>      <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-2043"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">RadialCellInformation</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">r</span>
<a name="ln-2044"></a>
<a name="ln-2045"></a>    <span class="n">RetVal</span> <span class="o">=</span> <span class="mf">3.14159d0</span> <span class="o">*</span> <span class="p">((</span><span class="n">r</span><span class="p">%</span><span class="n">OuterRadius</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">r</span><span class="p">%</span><span class="n">InnerRadius</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-2046"></a>
<a name="ln-2047"></a>    <span class="k">RETURN</span>
<a name="ln-2048"></a>
<a name="ln-2049"></a><span class="k">END FUNCTION</span>
<a name="ln-2050"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2051"></a>
<a name="ln-2052"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2053"></a><span class="kt">LOGICAL </span><span class="k">FUNCTION </span><span class="n">DomainRectangle_Contains</span><span class="p">(</span><span class="n">Rect</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">RetVal</span><span class="p">)</span>
<a name="ln-2054"></a>
<a name="ln-2055"></a>      <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-2056"></a>      <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-2057"></a>      <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-2058"></a>      <span class="c">!       MODIFIED       na</span>
<a name="ln-2059"></a>      <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2060"></a>
<a name="ln-2061"></a>      <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-2062"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2063"></a>
<a name="ln-2064"></a>      <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2065"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2066"></a>
<a name="ln-2067"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2068"></a>
<a name="ln-2069"></a>      <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-2070"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">DomainRectangle</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Rect</span>
<a name="ln-2071"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Point</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2072"></a>
<a name="ln-2073"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IsInRange</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">X</span><span class="p">,</span> <span class="n">Rect</span><span class="p">%</span><span class="n">XMin</span><span class="p">,</span> <span class="n">Rect</span><span class="p">%</span><span class="n">XMax</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">IsInRange</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">Y</span><span class="p">,</span> <span class="n">Rect</span><span class="p">%</span><span class="n">YMin</span><span class="p">,</span> <span class="n">Rect</span><span class="p">%</span><span class="n">YMax</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2074"></a><span class="k">        </span><span class="n">RetVal</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2075"></a>    <span class="k">ELSE</span>
<a name="ln-2076"></a><span class="k">        </span><span class="n">RetVal</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2077"></a>    <span class="k">END IF</span>
<a name="ln-2078"></a>
<a name="ln-2079"></a><span class="k">    RETURN</span>
<a name="ln-2080"></a>
<a name="ln-2081"></a><span class="k">END FUNCTION</span>
<a name="ln-2082"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2083"></a>
<a name="ln-2084"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2085"></a><span class="k">SUBROUTINE </span><span class="n">MeshPartition_SelectionSort</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<a name="ln-2086"></a>
<a name="ln-2087"></a>      <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2088"></a>      <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-2089"></a>      <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-2090"></a>      <span class="c">!       MODIFIED       na</span>
<a name="ln-2091"></a>      <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2092"></a>
<a name="ln-2093"></a>      <span class="c">! SUBROUTINE OF THIS FUNCTION:</span>
<a name="ln-2094"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2095"></a>
<a name="ln-2096"></a>      <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2097"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2098"></a>
<a name="ln-2099"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2100"></a>
<a name="ln-2101"></a>      <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2102"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">MeshPartition</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span> <span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">X</span>
<a name="ln-2103"></a>
<a name="ln-2104"></a>      <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2105"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">MeshPartition</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TEMP</span>
<a name="ln-2106"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">I</span>
<a name="ln-2107"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ISWAP</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2108"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ISWAP1</span>
<a name="ln-2109"></a>
<a name="ln-2110"></a>    <span class="k">DO </span><span class="n">I</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-2111"></a>        <span class="n">ISWAP</span><span class="o">=</span><span class="nb">MINLOC</span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">I</span><span class="p">:)%</span><span class="n">rDimension</span><span class="p">)</span>
<a name="ln-2112"></a>        <span class="n">ISWAP1</span><span class="o">=</span><span class="n">ISWAP</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-2113"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">ISWAP1</span><span class="p">.</span><span class="n">NE</span><span class="p">.</span><span class="n">I</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2114"></a><span class="k">            </span><span class="n">TEMP</span><span class="o">=</span><span class="n">X</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<a name="ln-2115"></a>            <span class="n">X</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">=</span><span class="n">X</span><span class="p">(</span><span class="n">ISWAP1</span><span class="p">)</span>
<a name="ln-2116"></a>            <span class="n">X</span><span class="p">(</span><span class="n">ISWAP1</span><span class="p">)</span><span class="o">=</span><span class="n">TEMP</span>
<a name="ln-2117"></a>        <span class="n">ENDIF</span>
<a name="ln-2118"></a>    <span class="k">END DO</span>
<a name="ln-2119"></a>
<a name="ln-2120"></a><span class="k">    RETURN</span>
<a name="ln-2121"></a>
<a name="ln-2122"></a><span class="k">END SUBROUTINE</span>
<a name="ln-2123"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2124"></a>
<a name="ln-2125"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2126"></a><span class="kt">INTEGER </span><span class="k">FUNCTION </span><span class="n">MeshPartition_CompareByDimension</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">RetVal</span><span class="p">)</span>
<a name="ln-2127"></a>
<a name="ln-2128"></a>      <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-2129"></a>      <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-2130"></a>      <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-2131"></a>      <span class="c">!       MODIFIED       na</span>
<a name="ln-2132"></a>      <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2133"></a>
<a name="ln-2134"></a>      <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-2135"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2136"></a>
<a name="ln-2137"></a>      <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2138"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2139"></a>
<a name="ln-2140"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2141"></a>
<a name="ln-2142"></a>      <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-2143"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">MeshPartition</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">x</span>
<a name="ln-2144"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">MeshPartition</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">y</span>
<a name="ln-2145"></a>
<a name="ln-2146"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">x</span><span class="p">%</span><span class="n">rDimension</span> <span class="o">&lt;</span> <span class="n">y</span><span class="p">%</span><span class="n">rDimension</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2147"></a><span class="k">      </span><span class="n">RetVal</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-2148"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">x</span><span class="p">%</span><span class="n">rDimension</span> <span class="o">&gt;</span> <span class="n">y</span><span class="p">%</span><span class="n">rDimension</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2149"></a><span class="k">      </span><span class="n">RetVal</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-2150"></a>    <span class="k">ELSE</span>
<a name="ln-2151"></a><span class="k">      </span><span class="n">RetVal</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2152"></a>    <span class="n">ENDIF</span>
<a name="ln-2153"></a>
<a name="ln-2154"></a>    <span class="k">RETURN</span>
<a name="ln-2155"></a>
<a name="ln-2156"></a><span class="k">END FUNCTION</span>
<a name="ln-2157"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2158"></a>
<a name="ln-2159"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2160"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">BaseThermalPropertySet_Diffusivity</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">RetVal</span><span class="p">)</span>
<a name="ln-2161"></a>
<a name="ln-2162"></a>      <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-2163"></a>      <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-2164"></a>      <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-2165"></a>      <span class="c">!       MODIFIED       na</span>
<a name="ln-2166"></a>      <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2167"></a>
<a name="ln-2168"></a>      <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-2169"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2170"></a>
<a name="ln-2171"></a>      <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2172"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2173"></a>
<a name="ln-2174"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2175"></a>
<a name="ln-2176"></a>      <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-2177"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">BaseThermalPropertySet</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2178"></a>
<a name="ln-2179"></a>    <span class="n">RetVal</span> <span class="o">=</span> <span class="n">p</span><span class="p">%</span><span class="n">Conductivity</span> <span class="o">/</span> <span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">Density</span> <span class="o">*</span> <span class="n">p</span><span class="p">%</span><span class="n">SpecificHeat</span><span class="p">)</span>
<a name="ln-2180"></a>
<a name="ln-2181"></a>    <span class="k">RETURN</span>
<a name="ln-2182"></a>
<a name="ln-2183"></a><span class="k">END FUNCTION</span>
<a name="ln-2184"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2185"></a>
<a name="ln-2186"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2187"></a><span class="kt">LOGICAL </span><span class="k">FUNCTION </span><span class="n">RectangleF_Contains</span><span class="p">(</span><span class="n">rect</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">RetVal</span><span class="p">)</span>
<a name="ln-2188"></a>
<a name="ln-2189"></a>      <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-2190"></a>      <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-2191"></a>      <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-2192"></a>      <span class="c">!       MODIFIED       na</span>
<a name="ln-2193"></a>      <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2194"></a>
<a name="ln-2195"></a>      <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-2196"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2197"></a>
<a name="ln-2198"></a>      <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2199"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2200"></a>
<a name="ln-2201"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2202"></a>
<a name="ln-2203"></a>      <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-2204"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">RectangleF</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rect</span>
<a name="ln-2205"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">PointF</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2206"></a>
<a name="ln-2207"></a>    <span class="n">RetVal</span> <span class="o">=</span> <span class="p">(</span>      <span class="p">(</span><span class="n">Rect</span><span class="p">%</span><span class="n">X_min</span> <span class="o">&lt;=</span> <span class="n">p</span><span class="p">%</span><span class="n">X</span><span class="p">)</span>                <span class="p">&amp;</span>
<a name="ln-2208"></a>              <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">X</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">Rect</span><span class="p">%</span><span class="n">X_min</span> <span class="o">+</span> <span class="n">rect</span><span class="p">%</span><span class="n">Width</span><span class="p">))</span>  <span class="p">&amp;</span>
<a name="ln-2209"></a>              <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">rect</span><span class="p">%</span><span class="n">Y_min</span> <span class="o">&lt;=</span> <span class="n">p</span><span class="p">%</span><span class="n">Y</span><span class="p">)</span>                <span class="p">&amp;</span>
<a name="ln-2210"></a>              <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">Y</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">rect</span><span class="p">%</span><span class="n">Y_min</span> <span class="o">+</span> <span class="n">rect</span><span class="p">%</span><span class="n">Height</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-2211"></a>             <span class="p">)</span>
<a name="ln-2212"></a>
<a name="ln-2213"></a>    <span class="k">RETURN</span>
<a name="ln-2214"></a>
<a name="ln-2215"></a><span class="k">END FUNCTION</span>
<a name="ln-2216"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2217"></a>
<a name="ln-2218"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2219"></a><span class="c">!Extension methods for Sim classes</span>
<a name="ln-2220"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2221"></a>
<a name="ln-2222"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2223"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">RadialSizing_Thickness</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">RetVal</span><span class="p">)</span>
<a name="ln-2224"></a>
<a name="ln-2225"></a>      <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-2226"></a>      <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-2227"></a>      <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-2228"></a>      <span class="c">!       MODIFIED       na</span>
<a name="ln-2229"></a>      <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2230"></a>
<a name="ln-2231"></a>      <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-2232"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2233"></a>
<a name="ln-2234"></a>      <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2235"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2236"></a>
<a name="ln-2237"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2238"></a>
<a name="ln-2239"></a>      <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-2240"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">RadialSizing</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">r</span>
<a name="ln-2241"></a>
<a name="ln-2242"></a>    <span class="n">RetVal</span> <span class="o">=</span> <span class="p">(</span><span class="n">r</span><span class="p">%</span><span class="n">OuterDia</span> <span class="o">-</span> <span class="n">r</span><span class="p">%</span><span class="n">InnerDia</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0d0</span>
<a name="ln-2243"></a>
<a name="ln-2244"></a>    <span class="k">RETURN</span>
<a name="ln-2245"></a>
<a name="ln-2246"></a><span class="k">END FUNCTION</span>
<a name="ln-2247"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2248"></a>
<a name="ln-2249"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2250"></a><span class="k">SUBROUTINE </span><span class="n">PipeSegmentInfo_InitPipeCells</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<a name="ln-2251"></a>
<a name="ln-2252"></a>      <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2253"></a>      <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-2254"></a>      <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-2255"></a>      <span class="c">!       MODIFIED       na</span>
<a name="ln-2256"></a>      <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2257"></a>
<a name="ln-2258"></a>      <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2259"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2260"></a>
<a name="ln-2261"></a>      <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2262"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2263"></a>
<a name="ln-2264"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2265"></a>
<a name="ln-2266"></a>      <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2267"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">PipeSegmentInfo</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span> <span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">s</span>
<a name="ln-2268"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">x</span>
<a name="ln-2269"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">y</span>
<a name="ln-2270"></a>
<a name="ln-2271"></a>      <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2272"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Point</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TempPt</span>
<a name="ln-2273"></a>
<a name="ln-2274"></a>    <span class="n">TempPt</span><span class="p">%</span><span class="n">X</span> <span class="o">=</span> <span class="n">x</span>
<a name="ln-2275"></a>    <span class="n">TempPt</span><span class="p">%</span><span class="n">Y</span> <span class="o">=</span> <span class="n">y</span>
<a name="ln-2276"></a>
<a name="ln-2277"></a>    <span class="n">s</span><span class="p">%</span><span class="n">PipeCellCoordinates</span> <span class="o">=</span> <span class="n">TempPt</span>
<a name="ln-2278"></a>    <span class="n">s</span><span class="p">%</span><span class="n">PipeCellCoordinatesSet</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2279"></a>
<a name="ln-2280"></a>    <span class="k">RETURN</span>
<a name="ln-2281"></a>
<a name="ln-2282"></a><span class="k">END SUBROUTINE</span>
<a name="ln-2283"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2284"></a>
<a name="ln-2285"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2286"></a><span class="k">SUBROUTINE </span><span class="n">PipeCircuitInfo_InitInOutCells</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">in</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
<a name="ln-2287"></a>
<a name="ln-2288"></a>      <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2289"></a>      <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-2290"></a>      <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-2291"></a>      <span class="c">!       MODIFIED       na</span>
<a name="ln-2292"></a>      <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2293"></a>
<a name="ln-2294"></a>      <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2295"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2296"></a>
<a name="ln-2297"></a>      <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2298"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2299"></a>
<a name="ln-2300"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2301"></a>
<a name="ln-2302"></a>      <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2303"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">PipeCircuitInfo</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span> <span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">c</span>
<a name="ln-2304"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">CartesianCell</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">in</span>
<a name="ln-2305"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">CartesianCell</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">out</span>
<a name="ln-2306"></a>
<a name="ln-2307"></a>    <span class="n">c</span><span class="p">%</span><span class="n">CircuitInletCell</span> <span class="o">=</span> <span class="n">Point3DInteger</span><span class="p">(</span><span class="n">in</span><span class="p">%</span><span class="n">X_index</span><span class="p">,</span> <span class="n">in</span><span class="p">%</span><span class="n">Y_index</span><span class="p">,</span> <span class="n">in</span><span class="p">%</span><span class="n">Z_index</span><span class="p">)</span>
<a name="ln-2308"></a>    <span class="n">c</span><span class="p">%</span><span class="n">CircuitOutletCell</span> <span class="o">=</span> <span class="n">Point3DInteger</span><span class="p">(</span><span class="n">out</span><span class="p">%</span><span class="n">X_index</span><span class="p">,</span> <span class="n">out</span><span class="p">%</span><span class="n">Y_index</span><span class="p">,</span> <span class="n">out</span><span class="p">%</span><span class="n">Z_index</span><span class="p">)</span>
<a name="ln-2309"></a>
<a name="ln-2310"></a>    <span class="k">RETURN</span>
<a name="ln-2311"></a>
<a name="ln-2312"></a><span class="k">END SUBROUTINE</span>
<a name="ln-2313"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2314"></a>
<a name="ln-2315"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2316"></a><span class="c">! Convergence checking</span>
<a name="ln-2317"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2318"></a>
<a name="ln-2319"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2320"></a><span class="kt">LOGICAL </span><span class="k">FUNCTION </span><span class="n">IsConverged_CurrentToPrevIteration</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">RetVal</span><span class="p">)</span>
<a name="ln-2321"></a>
<a name="ln-2322"></a>      <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-2323"></a>      <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-2324"></a>      <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-2325"></a>      <span class="c">!       MODIFIED       na</span>
<a name="ln-2326"></a>      <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2327"></a>
<a name="ln-2328"></a>      <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-2329"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2330"></a>
<a name="ln-2331"></a>      <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2332"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2333"></a>
<a name="ln-2334"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2335"></a>
<a name="ln-2336"></a>      <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-2337"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DomainNum</span>
<a name="ln-2338"></a>
<a name="ln-2339"></a>      <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2340"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LocalMax</span>
<a name="ln-2341"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisCellMax</span>
<a name="ln-2342"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">X</span>
<a name="ln-2343"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Y</span>
<a name="ln-2344"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Z</span>
<a name="ln-2345"></a>
<a name="ln-2346"></a>    <span class="n">LocalMax</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2347"></a>    <span class="k">DO </span><span class="n">Z</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-2348"></a>        <span class="k">DO </span><span class="n">Y</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-2349"></a>            <span class="k">DO </span><span class="n">X</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2350"></a>                <span class="n">ThisCellMax</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-2351"></a>                                          <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature_PrevIteration</span><span class="p">)</span>
<a name="ln-2352"></a>                <span class="n">LocalMax</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">LocalMax</span><span class="p">,</span> <span class="n">ThisCellMax</span><span class="p">)</span>
<a name="ln-2353"></a>            <span class="k">END DO</span>
<a name="ln-2354"></a><span class="k">        END DO</span>
<a name="ln-2355"></a><span class="k">    END DO</span>
<a name="ln-2356"></a>
<a name="ln-2357"></a><span class="k">    </span><span class="n">RetVal</span> <span class="o">=</span> <span class="p">(</span><span class="n">LocalMax</span> <span class="o">&lt;</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">SimControls</span><span class="p">%</span><span class="n">Convergence_CurrentToPrevIteration</span><span class="p">)</span>
<a name="ln-2358"></a>
<a name="ln-2359"></a>    <span class="k">RETURN</span>
<a name="ln-2360"></a>
<a name="ln-2361"></a><span class="k">END FUNCTION</span>
<a name="ln-2362"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2363"></a>
<a name="ln-2364"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2365"></a><span class="kt">LOGICAL </span><span class="k">FUNCTION </span><span class="n">IsConverged_PipeCurrentToPrevIteration</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">,</span> <span class="n">CellToCheck</span><span class="p">,</span> <span class="n">MaxDivAmount</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">RetVal</span><span class="p">)</span>
<a name="ln-2366"></a>
<a name="ln-2367"></a>      <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-2368"></a>      <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-2369"></a>      <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-2370"></a>      <span class="c">!       MODIFIED       na</span>
<a name="ln-2371"></a>      <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2372"></a>
<a name="ln-2373"></a>      <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-2374"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2375"></a>
<a name="ln-2376"></a>      <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2377"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2378"></a>
<a name="ln-2379"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2380"></a>
<a name="ln-2381"></a>      <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-2382"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CircuitNum</span>
<a name="ln-2383"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">CartesianCell</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CellToCheck</span>
<a name="ln-2384"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span> <span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MaxDivAmount</span>
<a name="ln-2385"></a>
<a name="ln-2386"></a>      <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2387"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">RadialCtr</span>
<a name="ln-2388"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisCellMax</span>
<a name="ln-2389"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">RadialCellInformation</span><span class="p">)</span> <span class="kd">::</span> <span class="n">radCell</span>
<a name="ln-2390"></a>
<a name="ln-2391"></a>    <span class="n">MaxDivAmount</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2392"></a>    <span class="k">DO </span><span class="n">RadialCtr</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">CellToCheck</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">CellToCheck</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2393"></a>        <span class="n">radCell</span> <span class="o">=</span> <span class="n">CellToCheck</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">RadialCtr</span><span class="p">)</span>
<a name="ln-2394"></a>        <span class="n">ThisCellMax</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">radCell</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span> <span class="o">-</span> <span class="n">radCell</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature_PrevIteration</span><span class="p">)</span>
<a name="ln-2395"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ThisCellMax</span> <span class="o">&gt;</span> <span class="n">MaxDivAmount</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2396"></a><span class="k">            </span><span class="n">MaxDivAmount</span> <span class="o">=</span> <span class="n">ThisCellMax</span>
<a name="ln-2397"></a>        <span class="k">END IF</span>
<a name="ln-2398"></a><span class="k">    END DO</span>
<a name="ln-2399"></a>    <span class="c">!&#39;also do the pipe cell</span>
<a name="ln-2400"></a>    <span class="n">ThisCellMax</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span>  <span class="n">CellToCheck</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Pipe</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span> <span class="p">&amp;</span>
<a name="ln-2401"></a>                      <span class="o">-</span> <span class="n">CellToCheck</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Pipe</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature_PrevIteration</span><span class="p">)</span>
<a name="ln-2402"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ThisCellMax</span> <span class="o">&gt;</span> <span class="n">MaxDivAmount</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2403"></a><span class="k">        </span><span class="n">MaxDivAmount</span> <span class="o">=</span> <span class="n">ThisCellMax</span>
<a name="ln-2404"></a>    <span class="k">END IF</span>
<a name="ln-2405"></a>    <span class="c">!&#39;also do the water cell</span>
<a name="ln-2406"></a>    <span class="n">ThisCellMax</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span>  <span class="n">CellToCheck</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Fluid</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span> <span class="p">&amp;</span>
<a name="ln-2407"></a>                      <span class="o">-</span> <span class="n">CellToCheck</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Fluid</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature_PrevIteration</span><span class="p">)</span>
<a name="ln-2408"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ThisCellMax</span> <span class="o">&gt;</span> <span class="n">MaxDivAmount</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2409"></a><span class="k">        </span><span class="n">MaxDivAmount</span> <span class="o">=</span> <span class="n">ThisCellMax</span>
<a name="ln-2410"></a>    <span class="k">END IF</span>
<a name="ln-2411"></a>    <span class="c">!&#39;also do insulation if it exists</span>
<a name="ln-2412"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">HasInsulation</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2413"></a><span class="k">        </span><span class="n">ThisCellMax</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span>  <span class="n">CellToCheck</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Insulation</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span> <span class="p">&amp;</span>
<a name="ln-2414"></a>                          <span class="o">-</span> <span class="n">CellToCheck</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Insulation</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature_PrevIteration</span><span class="p">)</span>
<a name="ln-2415"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ThisCellMax</span> <span class="o">&gt;</span> <span class="n">MaxDivAmount</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2416"></a><span class="k">            </span><span class="n">MaxDivAmount</span> <span class="o">=</span> <span class="n">ThisCellMax</span>
<a name="ln-2417"></a>        <span class="k">END IF</span>
<a name="ln-2418"></a><span class="k">    END IF</span>
<a name="ln-2419"></a>
<a name="ln-2420"></a><span class="k">    </span><span class="n">RetVal</span> <span class="o">=</span> <span class="p">(</span><span class="n">MaxDivAmount</span> <span class="o">&lt;</span> <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">Convergence_CurrentToPrevIteration</span><span class="p">)</span>
<a name="ln-2421"></a>
<a name="ln-2422"></a>    <span class="k">RETURN</span>
<a name="ln-2423"></a>
<a name="ln-2424"></a><span class="k">END FUNCTION</span>
<a name="ln-2425"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2426"></a>
<a name="ln-2427"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2428"></a><span class="k">SUBROUTINE </span><span class="n">ShiftTemperaturesForNewTimeStep</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)</span>
<a name="ln-2429"></a>
<a name="ln-2430"></a>      <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2431"></a>      <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-2432"></a>      <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-2433"></a>      <span class="c">!       MODIFIED       na</span>
<a name="ln-2434"></a>      <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2435"></a>
<a name="ln-2436"></a>      <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2437"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2438"></a>
<a name="ln-2439"></a>      <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2440"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2441"></a>
<a name="ln-2442"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2443"></a>
<a name="ln-2444"></a>      <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2445"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DomainNum</span>
<a name="ln-2446"></a>
<a name="ln-2447"></a>      <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2448"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">X</span>
<a name="ln-2449"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Y</span>
<a name="ln-2450"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Z</span>
<a name="ln-2451"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">RadCtr</span>
<a name="ln-2452"></a>
<a name="ln-2453"></a>    <span class="k">DO </span><span class="n">Z</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-2454"></a>        <span class="k">DO </span><span class="n">Y</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-2455"></a>            <span class="k">DO </span><span class="n">X</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2456"></a>
<a name="ln-2457"></a>                <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature_PrevTimeStep</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2458"></a>                                                      <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span>
<a name="ln-2459"></a>
<a name="ln-2460"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">CellType</span> <span class="o">==</span> <span class="n">CellType_Pipe</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2461"></a>
<a name="ln-2462"></a><span class="k">                    DO </span><span class="n">RadCtr</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2463"></a>                                <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-2464"></a>
<a name="ln-2465"></a>                        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">RadCtr</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature_PrevTimeStep</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2466"></a>                                        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">RadCtr</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span>
<a name="ln-2467"></a>
<a name="ln-2468"></a>                    <span class="k">END DO</span>
<a name="ln-2469"></a>
<a name="ln-2470"></a><span class="k">                    </span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Fluid</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature_PrevTimeStep</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2471"></a>                                           <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Fluid</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span>
<a name="ln-2472"></a>
<a name="ln-2473"></a>                    <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Pipe</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature_PrevTimeStep</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2474"></a>                                           <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Pipe</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span>
<a name="ln-2475"></a>
<a name="ln-2476"></a>                    <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Insulation</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature_PrevTimeStep</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2477"></a>                                           <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Insulation</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span>
<a name="ln-2478"></a>
<a name="ln-2479"></a>                <span class="k">END IF</span>
<a name="ln-2480"></a>
<a name="ln-2481"></a><span class="k">            END DO</span>
<a name="ln-2482"></a><span class="k">        END DO</span>
<a name="ln-2483"></a><span class="k">    END DO</span>
<a name="ln-2484"></a>
<a name="ln-2485"></a><span class="k">    RETURN</span>
<a name="ln-2486"></a>
<a name="ln-2487"></a><span class="k">END SUBROUTINE</span>
<a name="ln-2488"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2489"></a>
<a name="ln-2490"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2491"></a><span class="k">SUBROUTINE </span><span class="n">ShiftTemperaturesForNewIteration</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)</span>
<a name="ln-2492"></a>
<a name="ln-2493"></a>      <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2494"></a>      <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-2495"></a>      <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-2496"></a>      <span class="c">!       MODIFIED       na</span>
<a name="ln-2497"></a>      <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2498"></a>
<a name="ln-2499"></a>      <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2500"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2501"></a>
<a name="ln-2502"></a>      <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2503"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2504"></a>
<a name="ln-2505"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2506"></a>
<a name="ln-2507"></a>      <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2508"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DomainNum</span>
<a name="ln-2509"></a>
<a name="ln-2510"></a>      <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2511"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">X</span>
<a name="ln-2512"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Y</span>
<a name="ln-2513"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Z</span>
<a name="ln-2514"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">RadCtr</span>
<a name="ln-2515"></a>
<a name="ln-2516"></a>    <span class="k">DO </span><span class="n">Z</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-2517"></a>        <span class="k">DO </span><span class="n">Y</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-2518"></a>            <span class="k">DO </span><span class="n">X</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2519"></a>
<a name="ln-2520"></a>                <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature_PrevIteration</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2521"></a>                                            <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span>
<a name="ln-2522"></a>
<a name="ln-2523"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">CellType</span> <span class="o">==</span> <span class="n">CellType_Pipe</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2524"></a>
<a name="ln-2525"></a><span class="k">                    DO </span><span class="n">RadCtr</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2526"></a>                                <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-2527"></a>
<a name="ln-2528"></a>                        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">RadCtr</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature_PrevIteration</span><span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2529"></a>                                  <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">RadCtr</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span>
<a name="ln-2530"></a>
<a name="ln-2531"></a>                    <span class="k">END DO</span>
<a name="ln-2532"></a>
<a name="ln-2533"></a><span class="k">                    </span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Fluid</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature_PrevIteration</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2534"></a>                                   <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Fluid</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span>
<a name="ln-2535"></a>
<a name="ln-2536"></a>                    <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Pipe</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature_PrevIteration</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2537"></a>                                   <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Pipe</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span>
<a name="ln-2538"></a>
<a name="ln-2539"></a>                    <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Insulation</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature_PrevIteration</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2540"></a>                                   <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Insulation</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span>
<a name="ln-2541"></a>
<a name="ln-2542"></a>                <span class="k">END IF</span>
<a name="ln-2543"></a>
<a name="ln-2544"></a><span class="k">            END DO</span>
<a name="ln-2545"></a><span class="k">        END DO</span>
<a name="ln-2546"></a><span class="k">    END DO</span>
<a name="ln-2547"></a>
<a name="ln-2548"></a><span class="k">    RETURN</span>
<a name="ln-2549"></a>
<a name="ln-2550"></a><span class="k">END SUBROUTINE</span>
<a name="ln-2551"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2552"></a>
<a name="ln-2553"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2554"></a><span class="k">SUBROUTINE </span><span class="n">ShiftPipeTemperaturesForNewIteration</span><span class="p">(</span><span class="n">ThisPipeCell</span><span class="p">)</span>
<a name="ln-2555"></a>
<a name="ln-2556"></a>      <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2557"></a>      <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-2558"></a>      <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-2559"></a>      <span class="c">!       MODIFIED       na</span>
<a name="ln-2560"></a>      <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2561"></a>
<a name="ln-2562"></a>      <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2563"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2564"></a>
<a name="ln-2565"></a>      <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2566"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2567"></a>
<a name="ln-2568"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2569"></a>
<a name="ln-2570"></a>      <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2571"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">CartesianCell</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span> <span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisPipeCell</span>
<a name="ln-2572"></a>
<a name="ln-2573"></a>      <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2574"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">RadCtr</span>
<a name="ln-2575"></a>
<a name="ln-2576"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ThisPipeCell</span><span class="p">%</span><span class="n">CellType</span> <span class="o">==</span> <span class="n">CellType_Pipe</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">!It better be!</span>
<a name="ln-2577"></a>
<a name="ln-2578"></a>        <span class="k">DO </span><span class="n">RadCtr</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">ThisPipeCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">ThisPipeCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-2579"></a>            <span class="n">ThisPipeCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">RadCtr</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature_PrevIteration</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2580"></a>                                              <span class="n">ThisPipeCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">RadCtr</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span>
<a name="ln-2581"></a>        <span class="k">END DO</span>
<a name="ln-2582"></a>
<a name="ln-2583"></a><span class="k">        </span><span class="n">ThisPipeCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Fluid</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature_PrevIteration</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2584"></a>                                              <span class="n">ThisPipeCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Fluid</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span>
<a name="ln-2585"></a>
<a name="ln-2586"></a>        <span class="n">ThisPipeCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Pipe</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature_PrevIteration</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2587"></a>                                              <span class="n">ThisPipeCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Pipe</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span>
<a name="ln-2588"></a>
<a name="ln-2589"></a>        <span class="n">ThisPipeCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Insulation</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature_PrevIteration</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2590"></a>                                              <span class="n">ThisPipeCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Insulation</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span>
<a name="ln-2591"></a>
<a name="ln-2592"></a>    <span class="k">END IF</span>
<a name="ln-2593"></a>
<a name="ln-2594"></a><span class="k">    RETURN</span>
<a name="ln-2595"></a>
<a name="ln-2596"></a><span class="k">END SUBROUTINE</span>
<a name="ln-2597"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2598"></a>
<a name="ln-2599"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2600"></a><span class="kt">LOGICAL </span><span class="k">FUNCTION </span><span class="n">CheckForOutOfRangeTemps</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">RetVal</span><span class="p">)</span>
<a name="ln-2601"></a>
<a name="ln-2602"></a>      <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-2603"></a>      <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-2604"></a>      <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-2605"></a>      <span class="c">!       MODIFIED       na</span>
<a name="ln-2606"></a>      <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2607"></a>
<a name="ln-2608"></a>      <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-2609"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2610"></a>
<a name="ln-2611"></a>      <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2612"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2613"></a>
<a name="ln-2614"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2615"></a>
<a name="ln-2616"></a>      <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-2617"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DomainNum</span>
<a name="ln-2618"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MaxLimit</span>
<a name="ln-2619"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MinLimit</span>
<a name="ln-2620"></a>
<a name="ln-2621"></a>    <span class="n">MaxLimit</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">SimControls</span><span class="p">%</span><span class="n">MaximumTemperatureLimit</span>
<a name="ln-2622"></a>    <span class="n">MinLimit</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">SimControls</span><span class="p">%</span><span class="n">MinimumTemperatureLimit</span>
<a name="ln-2623"></a>
<a name="ln-2624"></a>    <span class="n">RetVal</span> <span class="o">=</span> <span class="p">(</span><span class="nb">ANY</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">MaxLimit</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2625"></a>              <span class="nb">ANY</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">MinLimit</span><span class="p">))</span>
<a name="ln-2626"></a>
<a name="ln-2627"></a>    <span class="k">RETURN</span>
<a name="ln-2628"></a>
<a name="ln-2629"></a><span class="k">END FUNCTION</span>
<a name="ln-2630"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2631"></a>
<a name="ln-2632"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2633"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">Width</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">RetVal</span><span class="p">)</span>
<a name="ln-2634"></a>
<a name="ln-2635"></a>      <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-2636"></a>      <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-2637"></a>      <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-2638"></a>      <span class="c">!       MODIFIED       na</span>
<a name="ln-2639"></a>      <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2640"></a>
<a name="ln-2641"></a>      <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-2642"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2643"></a>
<a name="ln-2644"></a>      <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2645"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2646"></a>
<a name="ln-2647"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2648"></a>
<a name="ln-2649"></a>      <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-2650"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">CartesianCell</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">c</span>
<a name="ln-2651"></a>
<a name="ln-2652"></a>    <span class="n">RetVal</span> <span class="o">=</span> <span class="n">c</span><span class="p">%</span><span class="n">X_max</span> <span class="o">-</span> <span class="n">c</span><span class="p">%</span><span class="n">X_min</span>
<a name="ln-2653"></a>
<a name="ln-2654"></a>    <span class="k">RETURN</span>
<a name="ln-2655"></a>
<a name="ln-2656"></a><span class="k">END FUNCTION</span>
<a name="ln-2657"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2658"></a>
<a name="ln-2659"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2660"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">Height</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">RetVal</span><span class="p">)</span>
<a name="ln-2661"></a>
<a name="ln-2662"></a>      <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-2663"></a>      <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-2664"></a>      <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-2665"></a>      <span class="c">!       MODIFIED       na</span>
<a name="ln-2666"></a>      <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2667"></a>
<a name="ln-2668"></a>      <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-2669"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2670"></a>
<a name="ln-2671"></a>      <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2672"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2673"></a>
<a name="ln-2674"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2675"></a>
<a name="ln-2676"></a>      <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-2677"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">CartesianCell</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">c</span>
<a name="ln-2678"></a>
<a name="ln-2679"></a>    <span class="n">RetVal</span> <span class="o">=</span> <span class="n">c</span><span class="p">%</span><span class="n">Y_max</span> <span class="o">-</span> <span class="n">c</span><span class="p">%</span><span class="n">Y_min</span>
<a name="ln-2680"></a>
<a name="ln-2681"></a>    <span class="k">RETURN</span>
<a name="ln-2682"></a>
<a name="ln-2683"></a><span class="k">END FUNCTION</span>
<a name="ln-2684"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2685"></a>
<a name="ln-2686"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2687"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">Depth</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">RetVal</span><span class="p">)</span>
<a name="ln-2688"></a>
<a name="ln-2689"></a>      <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-2690"></a>      <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-2691"></a>      <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-2692"></a>      <span class="c">!       MODIFIED       na</span>
<a name="ln-2693"></a>      <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2694"></a>
<a name="ln-2695"></a>      <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-2696"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2697"></a>
<a name="ln-2698"></a>      <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2699"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2700"></a>
<a name="ln-2701"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2702"></a>
<a name="ln-2703"></a>      <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-2704"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">CartesianCell</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">c</span>
<a name="ln-2705"></a>
<a name="ln-2706"></a>    <span class="n">RetVal</span> <span class="o">=</span> <span class="n">c</span><span class="p">%</span><span class="n">Z_max</span> <span class="o">-</span> <span class="n">c</span><span class="p">%</span><span class="n">Z_min</span>
<a name="ln-2707"></a>
<a name="ln-2708"></a>    <span class="k">RETURN</span>
<a name="ln-2709"></a>
<a name="ln-2710"></a><span class="k">END FUNCTION</span>
<a name="ln-2711"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2712"></a>
<a name="ln-2713"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2714"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">XNormalArea</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">RetVal</span><span class="p">)</span>
<a name="ln-2715"></a>
<a name="ln-2716"></a>      <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-2717"></a>      <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-2718"></a>      <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-2719"></a>      <span class="c">!       MODIFIED       na</span>
<a name="ln-2720"></a>      <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2721"></a>
<a name="ln-2722"></a>      <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-2723"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2724"></a>
<a name="ln-2725"></a>      <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2726"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2727"></a>
<a name="ln-2728"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2729"></a>
<a name="ln-2730"></a>      <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-2731"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">CartesianCell</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">c</span>
<a name="ln-2732"></a>
<a name="ln-2733"></a>    <span class="n">RetVal</span> <span class="o">=</span> <span class="n">Depth</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">*</span> <span class="n">Height</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<a name="ln-2734"></a>
<a name="ln-2735"></a>    <span class="k">RETURN</span>
<a name="ln-2736"></a>
<a name="ln-2737"></a><span class="k">END FUNCTION</span>
<a name="ln-2738"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2739"></a>
<a name="ln-2740"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2741"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">YNormalArea</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">RetVal</span><span class="p">)</span>
<a name="ln-2742"></a>
<a name="ln-2743"></a>      <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-2744"></a>      <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-2745"></a>      <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-2746"></a>      <span class="c">!       MODIFIED       na</span>
<a name="ln-2747"></a>      <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2748"></a>
<a name="ln-2749"></a>      <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-2750"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2751"></a>
<a name="ln-2752"></a>      <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2753"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2754"></a>
<a name="ln-2755"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2756"></a>
<a name="ln-2757"></a>      <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-2758"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">CartesianCell</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">c</span>
<a name="ln-2759"></a>
<a name="ln-2760"></a>    <span class="n">RetVal</span> <span class="o">=</span> <span class="n">Depth</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">*</span> <span class="n">Width</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<a name="ln-2761"></a>
<a name="ln-2762"></a>    <span class="k">RETURN</span>
<a name="ln-2763"></a>
<a name="ln-2764"></a><span class="k">END FUNCTION</span>
<a name="ln-2765"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2766"></a>
<a name="ln-2767"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2768"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">ZNormalArea</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">RetVal</span><span class="p">)</span>
<a name="ln-2769"></a>
<a name="ln-2770"></a>      <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-2771"></a>      <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-2772"></a>      <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-2773"></a>      <span class="c">!       MODIFIED       na</span>
<a name="ln-2774"></a>      <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2775"></a>
<a name="ln-2776"></a>      <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-2777"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2778"></a>
<a name="ln-2779"></a>      <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2780"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2781"></a>
<a name="ln-2782"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2783"></a>
<a name="ln-2784"></a>      <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-2785"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">CartesianCell</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">c</span>
<a name="ln-2786"></a>
<a name="ln-2787"></a>    <span class="n">RetVal</span> <span class="o">=</span> <span class="n">Width</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">*</span> <span class="n">Height</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<a name="ln-2788"></a>
<a name="ln-2789"></a>    <span class="k">RETURN</span>
<a name="ln-2790"></a>
<a name="ln-2791"></a><span class="k">END FUNCTION</span>
<a name="ln-2792"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2793"></a>
<a name="ln-2794"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2795"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">Volume</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">RetVal</span><span class="p">)</span>
<a name="ln-2796"></a>
<a name="ln-2797"></a>      <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-2798"></a>      <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-2799"></a>      <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-2800"></a>      <span class="c">!       MODIFIED       na</span>
<a name="ln-2801"></a>      <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2802"></a>
<a name="ln-2803"></a>      <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-2804"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2805"></a>
<a name="ln-2806"></a>      <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2807"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2808"></a>
<a name="ln-2809"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2810"></a>
<a name="ln-2811"></a>      <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-2812"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">CartesianCell</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">c</span>
<a name="ln-2813"></a>
<a name="ln-2814"></a>    <span class="n">RetVal</span> <span class="o">=</span> <span class="n">Width</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">*</span> <span class="n">Depth</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">*</span> <span class="n">Height</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<a name="ln-2815"></a>
<a name="ln-2816"></a>    <span class="k">RETURN</span>
<a name="ln-2817"></a>
<a name="ln-2818"></a><span class="k">END FUNCTION</span>
<a name="ln-2819"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2820"></a>
<a name="ln-2821"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2822"></a><span class="k">TYPE</span><span class="p">(</span><span class="n">RectangleF</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">XYRectangle</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">RetVal</span><span class="p">)</span>
<a name="ln-2823"></a>
<a name="ln-2824"></a>      <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-2825"></a>      <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-2826"></a>      <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-2827"></a>      <span class="c">!       MODIFIED       na</span>
<a name="ln-2828"></a>      <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2829"></a>
<a name="ln-2830"></a>      <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-2831"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2832"></a>
<a name="ln-2833"></a>      <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2834"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2835"></a>
<a name="ln-2836"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2837"></a>
<a name="ln-2838"></a>      <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-2839"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">CartesianCell</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">c</span>
<a name="ln-2840"></a>
<a name="ln-2841"></a>    <span class="n">RetVal</span> <span class="o">=</span> <span class="n">RectangleF</span><span class="p">(</span><span class="n">c</span><span class="p">%</span><span class="n">X_min</span><span class="p">,</span> <span class="n">c</span><span class="p">%</span><span class="n">Y_min</span><span class="p">,</span> <span class="n">Width</span><span class="p">(</span><span class="n">c</span><span class="p">),</span> <span class="n">Height</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
<a name="ln-2842"></a>
<a name="ln-2843"></a>    <span class="k">RETURN</span>
<a name="ln-2844"></a>
<a name="ln-2845"></a><span class="k">END FUNCTION</span>
<a name="ln-2846"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2847"></a>
<a name="ln-2848"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2849"></a><span class="k">TYPE</span><span class="p">(</span><span class="n">RectangleF</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">XZRectangle</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">RetVal</span><span class="p">)</span>
<a name="ln-2850"></a>
<a name="ln-2851"></a>      <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-2852"></a>      <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-2853"></a>      <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-2854"></a>      <span class="c">!       MODIFIED       na</span>
<a name="ln-2855"></a>      <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2856"></a>
<a name="ln-2857"></a>      <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-2858"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2859"></a>
<a name="ln-2860"></a>      <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2861"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2862"></a>
<a name="ln-2863"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2864"></a>
<a name="ln-2865"></a>      <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-2866"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">CartesianCell</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">c</span>
<a name="ln-2867"></a>
<a name="ln-2868"></a>    <span class="n">RetVal</span> <span class="o">=</span> <span class="n">RectangleF</span><span class="p">(</span><span class="n">c</span><span class="p">%</span><span class="n">X_min</span><span class="p">,</span> <span class="n">c</span><span class="p">%</span><span class="n">Z_min</span><span class="p">,</span> <span class="n">Width</span><span class="p">(</span><span class="n">c</span><span class="p">),</span> <span class="n">Depth</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
<a name="ln-2869"></a>
<a name="ln-2870"></a>    <span class="k">RETURN</span>
<a name="ln-2871"></a>
<a name="ln-2872"></a><span class="k">END FUNCTION</span>
<a name="ln-2873"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2874"></a>
<a name="ln-2875"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2876"></a><span class="k">TYPE</span><span class="p">(</span><span class="n">RectangleF</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">YZRectangle</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">RetVal</span><span class="p">)</span>
<a name="ln-2877"></a>
<a name="ln-2878"></a>      <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-2879"></a>      <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-2880"></a>      <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-2881"></a>      <span class="c">!       MODIFIED       na</span>
<a name="ln-2882"></a>      <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2883"></a>
<a name="ln-2884"></a>      <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-2885"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2886"></a>
<a name="ln-2887"></a>      <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2888"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2889"></a>
<a name="ln-2890"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2891"></a>
<a name="ln-2892"></a>      <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-2893"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">CartesianCell</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">c</span>
<a name="ln-2894"></a>
<a name="ln-2895"></a>    <span class="n">RetVal</span> <span class="o">=</span> <span class="n">RectangleF</span><span class="p">(</span><span class="n">c</span><span class="p">%</span><span class="n">Y_min</span><span class="p">,</span> <span class="n">c</span><span class="p">%</span><span class="n">Z_min</span><span class="p">,</span> <span class="n">Height</span><span class="p">(</span><span class="n">c</span><span class="p">),</span> <span class="n">Depth</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
<a name="ln-2896"></a>
<a name="ln-2897"></a>    <span class="k">RETURN</span>
<a name="ln-2898"></a>
<a name="ln-2899"></a><span class="k">END FUNCTION</span>
<a name="ln-2900"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2901"></a>
<a name="ln-2902"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2903"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">NormalArea</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">Direction</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">RetVal</span><span class="p">)</span>
<a name="ln-2904"></a>
<a name="ln-2905"></a>      <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-2906"></a>      <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-2907"></a>      <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-2908"></a>      <span class="c">!       MODIFIED       na</span>
<a name="ln-2909"></a>      <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2910"></a>
<a name="ln-2911"></a>      <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-2912"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2913"></a>
<a name="ln-2914"></a>      <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2915"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2916"></a>
<a name="ln-2917"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2918"></a>
<a name="ln-2919"></a>      <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-2920"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">CartesianCell</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">c</span>
<a name="ln-2921"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Direction</span> <span class="c">!From Enum: Direction</span>
<a name="ln-2922"></a>
<a name="ln-2923"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">Direction</span><span class="p">)</span>
<a name="ln-2924"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">Direction_PositiveY</span><span class="p">,</span> <span class="n">Direction_NegativeY</span><span class="p">)</span>
<a name="ln-2925"></a>        <span class="n">RetVal</span> <span class="o">=</span> <span class="n">YNormalArea</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<a name="ln-2926"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">Direction_PositiveX</span><span class="p">,</span> <span class="n">Direction_NegativeX</span><span class="p">)</span>
<a name="ln-2927"></a>        <span class="n">RetVal</span> <span class="o">=</span> <span class="n">XNormalArea</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<a name="ln-2928"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">Direction_PositiveZ</span><span class="p">,</span> <span class="n">Direction_NegativeZ</span><span class="p">)</span>
<a name="ln-2929"></a>        <span class="n">RetVal</span> <span class="o">=</span> <span class="n">ZNormalArea</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<a name="ln-2930"></a>    <span class="k">END SELECT</span>
<a name="ln-2931"></a>    <span class="c">!Objexx:Return Check/enforce that one of these CASEs holds to assure return value is set</span>
<a name="ln-2932"></a>
<a name="ln-2933"></a>    <span class="k">RETURN</span>
<a name="ln-2934"></a>
<a name="ln-2935"></a><span class="k">END FUNCTION</span>
<a name="ln-2936"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2937"></a>
<a name="ln-2938"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2939"></a><span class="k">TYPE</span><span class="p">(</span><span class="n">NeighborInformation</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">NeighborInformationArray_Value</span><span class="p">(</span><span class="n">dict</span><span class="p">,</span> <span class="n">direction</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">RetVal</span><span class="p">)</span>
<a name="ln-2940"></a>
<a name="ln-2941"></a>      <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-2942"></a>      <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-2943"></a>      <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-2944"></a>      <span class="c">!       MODIFIED       na</span>
<a name="ln-2945"></a>      <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2946"></a>
<a name="ln-2947"></a>      <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-2948"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2949"></a>
<a name="ln-2950"></a>      <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2951"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2952"></a>
<a name="ln-2953"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2954"></a>
<a name="ln-2955"></a>      <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-2956"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">DirectionNeighbor_Dictionary</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dict</span>
<a name="ln-2957"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Direction</span> <span class="c">!From Enum: Direction</span>
<a name="ln-2958"></a>
<a name="ln-2959"></a>      <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2960"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="nb">Index</span>
<a name="ln-2961"></a>
<a name="ln-2962"></a><span class="nb">    </span><span class="k">DO </span><span class="nb">Index</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">dict</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">dict</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2963"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">dict</span><span class="p">(</span><span class="nb">Index</span><span class="p">)%</span><span class="n">Direction</span> <span class="o">==</span> <span class="n">direction</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2964"></a><span class="k">            </span><span class="n">RetVal</span> <span class="o">=</span> <span class="n">dict</span><span class="p">(</span><span class="nb">Index</span><span class="p">)%</span><span class="k">Value</span>
<a name="ln-2965"></a><span class="k">            EXIT</span>
<a name="ln-2966"></a><span class="k">        END IF</span>
<a name="ln-2967"></a><span class="k">    END DO</span>
<a name="ln-2968"></a>    <span class="c">!Objexx:Return Check/enforce that return value is set</span>
<a name="ln-2969"></a>
<a name="ln-2970"></a>    <span class="k">RETURN</span>
<a name="ln-2971"></a>
<a name="ln-2972"></a><span class="k">END FUNCTION</span>
<a name="ln-2973"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2974"></a>
<a name="ln-2975"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2976"></a><span class="c">! Constructors for generic classes</span>
<a name="ln-2977"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2978"></a>
<a name="ln-2979"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-2980"></a><span class="k">SUBROUTINE </span><span class="n">CartesianPipeCellInformation_ctor</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">GridCellWidth</span><span class="p">,</span> <span class="n">PipeSizes</span><span class="p">,</span> <span class="n">NumRadialNodes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2981"></a>                                             <span class="n">CellDepth</span><span class="p">,</span> <span class="n">InsulationThickness</span><span class="p">,</span> <span class="n">RadialGridExtent</span><span class="p">,</span> <span class="n">SimHasInsulation</span><span class="p">)</span>
<a name="ln-2982"></a>
<a name="ln-2983"></a>      <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2984"></a>      <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-2985"></a>      <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-2986"></a>      <span class="c">!       MODIFIED       na</span>
<a name="ln-2987"></a>      <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2988"></a>
<a name="ln-2989"></a>      <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2990"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2991"></a>
<a name="ln-2992"></a>      <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2993"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-2994"></a>
<a name="ln-2995"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2996"></a>
<a name="ln-2997"></a>      <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2998"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">CartesianPipeCellInformation</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span> <span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">c</span>
<a name="ln-2999"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GridCellWidth</span>
<a name="ln-3000"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">RadialSizing</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PipeSizes</span>
<a name="ln-3001"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NumRadialNodes</span>
<a name="ln-3002"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CellDepth</span>
<a name="ln-3003"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InsulationThickness</span>
<a name="ln-3004"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RadialGridExtent</span>
<a name="ln-3005"></a>    <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SimHasInsulation</span>
<a name="ln-3006"></a>
<a name="ln-3007"></a>      <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3008"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InsulationInnerRadius</span>
<a name="ln-3009"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InsulationOuterRadius</span>
<a name="ln-3010"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InsulationCentroid</span>
<a name="ln-3011"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PipeOuterRadius</span>
<a name="ln-3012"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PipeInnerRadius</span>
<a name="ln-3013"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MinimumSoilRadius</span>
<a name="ln-3014"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisSliceInnerRadius</span>
<a name="ln-3015"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Rval</span>
<a name="ln-3016"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">RadialCellCtr</span>
<a name="ln-3017"></a>
<a name="ln-3018"></a>     <span class="c">!&#39;calculate pipe radius</span>
<a name="ln-3019"></a>    <span class="n">PipeOuterRadius</span> <span class="o">=</span> <span class="n">PipeSizes</span><span class="p">%</span><span class="n">OuterDia</span> <span class="o">/</span> <span class="mi">2</span>
<a name="ln-3020"></a>    <span class="n">PipeInnerRadius</span> <span class="o">=</span> <span class="n">PipeSizes</span><span class="p">%</span><span class="n">InnerDia</span> <span class="o">/</span> <span class="mi">2</span>
<a name="ln-3021"></a>
<a name="ln-3022"></a>    <span class="c">!&#39;--we will work from inside out, calculating dimensions and instantiating variables--</span>
<a name="ln-3023"></a>    <span class="c">!&#39;first instantiate the water cell</span>
<a name="ln-3024"></a>    <span class="k">CALL </span><span class="n">FluidCellInformation_ctor</span><span class="p">(</span><span class="n">c</span><span class="p">%</span><span class="n">Fluid</span><span class="p">,</span> <span class="n">PipeInnerRadius</span><span class="p">,</span> <span class="n">CellDepth</span><span class="p">)</span>
<a name="ln-3025"></a>
<a name="ln-3026"></a>    <span class="c">!&#39;then the pipe cell</span>
<a name="ln-3027"></a>    <span class="k">CALL </span><span class="n">RadialCellInformation_ctor</span><span class="p">(</span><span class="n">c</span><span class="p">%</span><span class="n">Pipe</span><span class="p">,</span> <span class="p">(</span><span class="n">PipeOuterRadius</span> <span class="o">+</span> <span class="n">PipeInnerRadius</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0d0</span><span class="p">,</span> <span class="n">PipeInnerRadius</span><span class="p">,</span> <span class="n">PipeOuterRadius</span><span class="p">)</span>
<a name="ln-3028"></a>
<a name="ln-3029"></a>    <span class="c">!&#39;then the insulation if we have it</span>
<a name="ln-3030"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">InsulationThickness</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3031"></a><span class="k">        </span><span class="n">InsulationInnerRadius</span> <span class="o">=</span> <span class="n">PipeOuterRadius</span>
<a name="ln-3032"></a>        <span class="n">InsulationOuterRadius</span> <span class="o">=</span> <span class="n">InsulationInnerRadius</span> <span class="o">+</span> <span class="n">InsulationThickness</span>
<a name="ln-3033"></a>        <span class="n">InsulationCentroid</span> <span class="o">=</span> <span class="p">(</span><span class="n">InsulationInnerRadius</span> <span class="o">+</span> <span class="n">InsulationOuterRadius</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0d0</span>
<a name="ln-3034"></a>        <span class="k">CALL </span><span class="n">RadialCellInformation_ctor</span><span class="p">(</span><span class="n">c</span><span class="p">%</span><span class="n">Insulation</span><span class="p">,</span> <span class="n">InsulationCentroid</span><span class="p">,</span> <span class="n">InsulationInnerRadius</span><span class="p">,</span> <span class="n">InsulationOuterRadius</span><span class="p">)</span>
<a name="ln-3035"></a>    <span class="k">END IF</span>
<a name="ln-3036"></a>
<a name="ln-3037"></a>    <span class="c">!&#39;determine where to start applying the radial soil cells based on whether we have insulation or not</span>
<a name="ln-3038"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SimHasInsulation</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3039"></a><span class="k">        </span><span class="n">MinimumSoilRadius</span> <span class="o">=</span> <span class="n">PipeOuterRadius</span>
<a name="ln-3040"></a>    <span class="k">ELSE</span>
<a name="ln-3041"></a><span class="k">        </span><span class="n">MinimumSoilRadius</span> <span class="o">=</span> <span class="n">c</span><span class="p">%</span><span class="n">Insulation</span><span class="p">%</span><span class="n">OuterRadius</span>
<a name="ln-3042"></a>    <span class="k">END IF</span>
<a name="ln-3043"></a>
<a name="ln-3044"></a>    <span class="c">!&#39;the radial cells are distributed evenly throughout this region</span>
<a name="ln-3045"></a>    <span class="n">c</span><span class="p">%</span><span class="n">RadialSliceWidth</span> <span class="o">=</span> <span class="n">RadialGridExtent</span> <span class="o">/</span> <span class="n">NumRadialNodes</span>
<a name="ln-3046"></a>
<a name="ln-3047"></a>    <span class="c">!allocate the array of radial soil nodes</span>
<a name="ln-3048"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">c</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">NumRadialNodes</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<a name="ln-3049"></a>
<a name="ln-3050"></a>    <span class="c">!first set Rval to the minimum soil radius plus half a slice thickness for the innermost radial node</span>
<a name="ln-3051"></a>    <span class="n">Rval</span> <span class="o">=</span> <span class="n">MinimumSoilRadius</span> <span class="o">+</span> <span class="p">(</span><span class="n">c</span><span class="p">%</span><span class="n">RadialSliceWidth</span> <span class="o">/</span> <span class="mf">2.0d0</span><span class="p">)</span>
<a name="ln-3052"></a>    <span class="n">ThisSliceInnerRadius</span> <span class="o">=</span> <span class="n">MinimumSoilRadius</span>
<a name="ln-3053"></a>    <span class="k">CALL </span><span class="n">RadialCellInformation_ctor</span><span class="p">(</span><span class="n">c</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Rval</span><span class="p">,</span> <span class="n">ThisSliceInnerRadius</span><span class="p">,</span> <span class="n">ThisSliceInnerRadius</span> <span class="o">+</span> <span class="n">c</span><span class="p">%</span><span class="n">RadialSliceWidth</span><span class="p">)</span>
<a name="ln-3054"></a>
<a name="ln-3055"></a>    <span class="c">!&#39;then loop through the rest and assign them, each radius is simply one more slice thickness</span>
<a name="ln-3056"></a>    <span class="k">DO </span><span class="n">RadialCellCtr</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">c</span><span class="p">%</span><span class="n">Soil</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3057"></a>        <span class="n">Rval</span> <span class="o">=</span> <span class="n">Rval</span> <span class="o">+</span> <span class="n">c</span><span class="p">%</span><span class="n">RadialSliceWidth</span>
<a name="ln-3058"></a>        <span class="n">ThisSliceInnerRadius</span> <span class="o">=</span> <span class="n">ThisSliceInnerRadius</span> <span class="o">+</span> <span class="n">c</span><span class="p">%</span><span class="n">RadialSliceWidth</span>
<a name="ln-3059"></a>        <span class="k">CALL </span><span class="n">RadialCellInformation_ctor</span><span class="p">(</span><span class="n">c</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">RadialCellCtr</span><span class="p">),</span> <span class="n">Rval</span><span class="p">,</span> <span class="n">ThisSliceInnerRadius</span><span class="p">,</span> <span class="n">ThisSliceInnerRadius</span><span class="o">+</span><span class="n">c</span><span class="p">%</span><span class="n">RadialSliceWidth</span><span class="p">)</span>
<a name="ln-3060"></a>    <span class="k">END DO</span>
<a name="ln-3061"></a>
<a name="ln-3062"></a>    <span class="c">!&#39;also assign the interface cell surrounding the radial system</span>
<a name="ln-3063"></a>    <span class="n">c</span><span class="p">%</span><span class="n">InterfaceVolume</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="p">(</span><span class="mf">3.1415926535d0</span> <span class="o">/</span> <span class="mf">4.0d0</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">GridCellWidth</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">CellDepth</span>
<a name="ln-3064"></a>
<a name="ln-3065"></a>    <span class="k">RETURN</span>
<a name="ln-3066"></a>
<a name="ln-3067"></a><span class="k">END SUBROUTINE</span>
<a name="ln-3068"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-3069"></a>
<a name="ln-3070"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-3071"></a><span class="k">SUBROUTINE </span><span class="n">RadialCellInformation_ctor</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">m_RadialCentroid</span><span class="p">,</span> <span class="n">m_MinRadius</span><span class="p">,</span> <span class="n">m_MaxRadius</span><span class="p">)</span>
<a name="ln-3072"></a>
<a name="ln-3073"></a>      <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3074"></a>      <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-3075"></a>      <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-3076"></a>      <span class="c">!       MODIFIED       na</span>
<a name="ln-3077"></a>      <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3078"></a>
<a name="ln-3079"></a>      <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3080"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-3081"></a>
<a name="ln-3082"></a>      <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3083"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-3084"></a>
<a name="ln-3085"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3086"></a>
<a name="ln-3087"></a>      <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3088"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">RadialCellInformation</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span> <span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">c</span>
<a name="ln-3089"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">m_RadialCentroid</span>
<a name="ln-3090"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">m_MinRadius</span>
<a name="ln-3091"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">m_MaxRadius</span>
<a name="ln-3092"></a>
<a name="ln-3093"></a>    <span class="n">c</span><span class="p">%</span><span class="n">RadialCentroid</span> <span class="o">=</span> <span class="n">m_RadialCentroid</span>
<a name="ln-3094"></a>    <span class="n">c</span><span class="p">%</span><span class="n">InnerRadius</span> <span class="o">=</span> <span class="n">m_MinRadius</span>
<a name="ln-3095"></a>    <span class="n">c</span><span class="p">%</span><span class="n">OuterRadius</span> <span class="o">=</span> <span class="n">m_MaxRadius</span>
<a name="ln-3096"></a>
<a name="ln-3097"></a>    <span class="k">RETURN</span>
<a name="ln-3098"></a>
<a name="ln-3099"></a><span class="k">END SUBROUTINE</span>
<a name="ln-3100"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-3101"></a>
<a name="ln-3102"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-3103"></a><span class="k">SUBROUTINE </span><span class="n">FluidCellInformation_ctor</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">m_PipeInnerRadius</span><span class="p">,</span> <span class="n">m_CellDepth</span><span class="p">)</span>
<a name="ln-3104"></a>
<a name="ln-3105"></a>      <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3106"></a>      <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-3107"></a>      <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-3108"></a>      <span class="c">!       MODIFIED       na</span>
<a name="ln-3109"></a>      <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3110"></a>
<a name="ln-3111"></a>      <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3112"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-3113"></a>
<a name="ln-3114"></a>      <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3115"></a>      <span class="c">! &lt;description&gt;</span>
<a name="ln-3116"></a>
<a name="ln-3117"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3118"></a>
<a name="ln-3119"></a>      <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3120"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">FluidCellInformation</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span> <span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">c</span>
<a name="ln-3121"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">m_PipeInnerRadius</span>
<a name="ln-3122"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">m_CellDepth</span>
<a name="ln-3123"></a>
<a name="ln-3124"></a>    <span class="n">c</span><span class="p">%</span><span class="n">PipeInnerRadius</span> <span class="o">=</span> <span class="n">m_PipeInnerRadius</span>
<a name="ln-3125"></a>    <span class="n">c</span><span class="p">%</span><span class="n">Volume</span> <span class="o">=</span> <span class="mf">3.1415926535d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">m_PipeInnerRadius</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">m_CellDepth</span>
<a name="ln-3126"></a>
<a name="ln-3127"></a>    <span class="k">RETURN</span>
<a name="ln-3128"></a>
<a name="ln-3129"></a><span class="k">END SUBROUTINE</span>
<a name="ln-3130"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-3131"></a>
<a name="ln-3132"></a><span class="c">! ==================================================</span>
<a name="ln-3133"></a><span class="c">! =========== Mesh Development routines ============</span>
<a name="ln-3134"></a><span class="c">! ==================================================</span>
<a name="ln-3135"></a>
<a name="ln-3136"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-3137"></a><span class="k">SUBROUTINE </span><span class="n">DevelopMesh</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)</span>
<a name="ln-3138"></a>
<a name="ln-3139"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3140"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-3141"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-3142"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-3143"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3144"></a>
<a name="ln-3145"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3146"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-3147"></a>
<a name="ln-3148"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3149"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-3150"></a>
<a name="ln-3151"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3152"></a>          <span class="c">! na</span>
<a name="ln-3153"></a>
<a name="ln-3154"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3155"></a>          <span class="c">! na</span>
<a name="ln-3156"></a>
<a name="ln-3157"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3158"></a>
<a name="ln-3159"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3160"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DomainNum</span>
<a name="ln-3161"></a>
<a name="ln-3162"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3163"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">GridRegion</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">XPartitionRegions</span>
<a name="ln-3164"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">GridRegion</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">YPartitionRegions</span>
<a name="ln-3165"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">GridRegion</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">ZPartitionRegions</span>
<a name="ln-3166"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">GridRegion</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">XRegions</span>
<a name="ln-3167"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">GridRegion</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">YRegions</span>
<a name="ln-3168"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">GridRegion</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">ZRegions</span>
<a name="ln-3169"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>        <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">XBoundaryPoints</span>
<a name="ln-3170"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>        <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">YBoundaryPoints</span>
<a name="ln-3171"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>        <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">ZBoundaryPoints</span>
<a name="ln-3172"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">RegionListCount</span>
<a name="ln-3173"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">BoundaryListCount</span>
<a name="ln-3174"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">XPartitionsExist</span>
<a name="ln-3175"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">YPartitionsExist</span>
<a name="ln-3176"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ZPartitionsExist</span>
<a name="ln-3177"></a>
<a name="ln-3178"></a>    <span class="c">!&#39;****** LAYOUT PARTITIONS ******&#39;</span>
<a name="ln-3179"></a>    <span class="k">CALL </span><span class="n">CreatePartitionCenterList</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)</span>
<a name="ln-3180"></a>
<a name="ln-3181"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">X</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3182"></a><span class="k">        ALLOCATE</span><span class="p">(</span><span class="n">XPartitionRegions</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">X</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3183"></a>        <span class="n">XPartitionsExist</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3184"></a>    <span class="k">ELSE</span>
<a name="ln-3185"></a><span class="k">        ALLOCATE</span><span class="p">(</span><span class="n">XPartitionRegions</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">))</span>
<a name="ln-3186"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">X</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">))</span>
<a name="ln-3187"></a>        <span class="n">XPartitionsExist</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3188"></a>    <span class="k">END IF</span>
<a name="ln-3189"></a><span class="k">    </span><span class="n">XPartitionRegions</span> <span class="o">=</span> <span class="n">CreatePartitionRegionList</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3190"></a>                                                  <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">X</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3191"></a>                                                  <span class="n">XPartitionsExist</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3192"></a>                                                  <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Extents</span><span class="p">%</span><span class="n">XMax</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3193"></a>                                                  <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">X</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<a name="ln-3194"></a>
<a name="ln-3195"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">Y</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3196"></a><span class="k">        ALLOCATE</span><span class="p">(</span><span class="n">YPartitionRegions</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">Y</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3197"></a>        <span class="n">YPartitionsExist</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3198"></a>    <span class="k">ELSE</span>
<a name="ln-3199"></a><span class="k">        ALLOCATE</span><span class="p">(</span><span class="n">YPartitionRegions</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">))</span>
<a name="ln-3200"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">Y</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">))</span>
<a name="ln-3201"></a>        <span class="n">YPartitionsExist</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3202"></a>    <span class="k">END IF</span>
<a name="ln-3203"></a><span class="k">    </span><span class="n">YPartitionRegions</span> <span class="o">=</span> <span class="n">CreatePartitionRegionList</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3204"></a>                                                  <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">Y</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3205"></a>                                                  <span class="n">YPartitionsExist</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3206"></a>                                                  <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Extents</span><span class="p">%</span><span class="n">YMax</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3207"></a>                                                  <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">Y</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<a name="ln-3208"></a>
<a name="ln-3209"></a>    <span class="n">ZPartitionsExist</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3210"></a>
<a name="ln-3211"></a>    <span class="c">!&#39;***** LAYOUT MESH REGIONS *****&#39;</span>
<a name="ln-3212"></a>    <span class="n">RegionListCount</span> <span class="o">=</span> <span class="n">CreateRegionListCount</span><span class="p">(</span><span class="n">XPartitionRegions</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3213"></a>                                            <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Extents</span><span class="p">%</span><span class="n">XMax</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3214"></a>                                            <span class="n">XPartitionsExist</span><span class="p">)</span>
<a name="ln-3215"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">XRegions</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">RegionListCount</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-3216"></a>
<a name="ln-3217"></a>    <span class="n">XRegions</span> <span class="o">=</span> <span class="n">CreateRegionList</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3218"></a>                                <span class="n">XPartitionRegions</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3219"></a>                                <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Extents</span><span class="p">%</span><span class="n">XMax</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3220"></a>                                <span class="n">RegionType_XDirection</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3221"></a>                                <span class="n">RegionListCount</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3222"></a>                                <span class="n">XPartitionsExist</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3223"></a>                                <span class="n">BasementWallXIndex</span><span class="o">=</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BasementZone</span><span class="p">%</span><span class="n">BasementWallXIndex</span><span class="p">)</span>
<a name="ln-3224"></a>
<a name="ln-3225"></a>    <span class="n">RegionListCount</span> <span class="o">=</span> <span class="n">CreateRegionListCount</span><span class="p">(</span><span class="n">YPartitionRegions</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3226"></a>                                            <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Extents</span><span class="p">%</span><span class="n">YMax</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3227"></a>                                            <span class="n">YPartitionsExist</span><span class="p">)</span>
<a name="ln-3228"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">YRegions</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">RegionListCount</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-3229"></a>    <span class="n">YRegions</span> <span class="o">=</span> <span class="n">CreateRegionList</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3230"></a>                                <span class="n">YPartitionRegions</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3231"></a>                                <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Extents</span><span class="p">%</span><span class="n">YMax</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3232"></a>                                <span class="n">RegionType_YDirection</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3233"></a>                                <span class="n">RegionListCount</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3234"></a>                                <span class="n">YPartitionsExist</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3235"></a>                                <span class="n">BasementFloorYIndex</span><span class="o">=</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BasementZone</span><span class="p">%</span><span class="n">BasementFloorYIndex</span><span class="p">)</span>
<a name="ln-3236"></a>
<a name="ln-3237"></a>     <span class="n">RegionListCount</span> <span class="o">=</span> <span class="n">CreateRegionListCount</span><span class="p">(</span><span class="n">ZPartitionRegions</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3238"></a>                                            <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Extents</span><span class="p">%</span><span class="n">ZMax</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3239"></a>                                            <span class="n">ZPartitionsExist</span><span class="p">)</span>
<a name="ln-3240"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ZRegions</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">RegionListCount</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-3241"></a>    <span class="n">ZRegions</span> <span class="o">=</span> <span class="n">CreateRegionList</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3242"></a>                                <span class="n">ZPartitionRegions</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3243"></a>                                <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Extents</span><span class="p">%</span><span class="n">ZMax</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3244"></a>                                <span class="n">RegionType_ZDirection</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3245"></a>                                <span class="n">RegionListCount</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3246"></a>                                <span class="n">ZPartitionsExist</span><span class="p">)</span>
<a name="ln-3247"></a>
<a name="ln-3248"></a>
<a name="ln-3249"></a>    <span class="c">!&#39;** MAKE REGIONS &gt; BOUNDARIES **&#39;</span>
<a name="ln-3250"></a>    <span class="n">BoundaryListCount</span> <span class="o">=</span> <span class="n">CreateBoundaryListCount</span><span class="p">(</span><span class="n">XRegions</span><span class="p">,</span> <span class="n">RegionType_XDirection</span><span class="p">)</span>
<a name="ln-3251"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">XBoundaryPoints</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">BoundaryListCount</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-3252"></a>    <span class="n">XBoundaryPoints</span> <span class="o">=</span> <span class="n">CreateBoundaryList</span><span class="p">(</span><span class="n">XRegions</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3253"></a>                                         <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Extents</span><span class="p">%</span><span class="n">XMax</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3254"></a>                                         <span class="n">RegionType_XDirection</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3255"></a>                                         <span class="mi">0</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3256"></a>                                         <span class="n">BoundaryListCount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3257"></a>
<a name="ln-3258"></a>    <span class="n">BoundaryListCount</span> <span class="o">=</span> <span class="n">CreateBoundaryListCount</span><span class="p">(</span><span class="n">YRegions</span><span class="p">,</span> <span class="n">RegionTYpe_YDirection</span><span class="p">)</span>
<a name="ln-3259"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">YBoundaryPoints</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">BoundaryListCount</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-3260"></a>    <span class="n">YBoundaryPoints</span> <span class="o">=</span> <span class="n">CreateBoundaryList</span><span class="p">(</span><span class="n">YRegions</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3261"></a>                                         <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Extents</span><span class="p">%</span><span class="n">YMax</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3262"></a>                                         <span class="n">RegionType_YDirection</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3263"></a>                                         <span class="mi">0</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3264"></a>                                         <span class="n">BoundaryListCount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3265"></a>
<a name="ln-3266"></a>    <span class="n">BoundaryListCount</span> <span class="o">=</span> <span class="n">CreateBoundaryListCount</span><span class="p">(</span><span class="n">ZRegions</span><span class="p">,</span> <span class="n">RegionTYpe_ZDirection</span><span class="p">)</span>
<a name="ln-3267"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ZBoundaryPoints</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">BoundaryListCount</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-3268"></a>    <span class="n">ZBoundaryPoints</span> <span class="o">=</span> <span class="n">CreateBoundaryList</span><span class="p">(</span><span class="n">ZRegions</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3269"></a>                                         <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Extents</span><span class="p">%</span><span class="n">ZMax</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3270"></a>                                         <span class="n">RegionType_ZDirection</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3271"></a>                                         <span class="mi">0</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3272"></a>                                         <span class="n">BoundaryListCount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3273"></a>
<a name="ln-3274"></a>    <span class="c">!&#39;****** DEVELOP CELL ARRAY *****&#39;</span>
<a name="ln-3275"></a>    <span class="k">CALL </span><span class="n">CreateCellArray</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3276"></a>                         <span class="n">XBoundaryPoints</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3277"></a>                         <span class="n">YBoundaryPoints</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3278"></a>                         <span class="n">ZBoundaryPoints</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3279"></a>                         <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BasementZone</span><span class="p">%</span><span class="n">BasementWallXIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3280"></a>                         <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BasementZone</span><span class="p">%</span><span class="n">BasementFloorYIndex</span><span class="p">)</span>
<a name="ln-3281"></a>
<a name="ln-3282"></a>    <span class="c">!&#39;***** SETUP CELL NEIGHBORS ****&#39;</span>
<a name="ln-3283"></a>    <span class="k">CALL </span><span class="n">SetupCellNeighbors</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)</span>
<a name="ln-3284"></a>
<a name="ln-3285"></a>    <span class="c">!&#39;** SET UP PIPE CIRCUIT CELLS **&#39;</span>
<a name="ln-3286"></a>    <span class="k">CALL </span><span class="n">SetupPipeCircuitInOutCells</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)</span>
<a name="ln-3287"></a>
<a name="ln-3288"></a>    <span class="k">IF</span><span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">XPartitionRegions</span><span class="p">))</span> <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">XPartitionRegions</span><span class="p">)</span>
<a name="ln-3289"></a>    <span class="k">IF</span><span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">YPartitionRegions</span><span class="p">))</span> <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">YPartitionRegions</span><span class="p">)</span>
<a name="ln-3290"></a>    <span class="k">IF</span><span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">ZPartitionRegions</span><span class="p">))</span> <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">ZPartitionRegions</span><span class="p">)</span>
<a name="ln-3291"></a>    <span class="k">IF</span><span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">XRegions</span><span class="p">))</span> <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">XRegions</span><span class="p">)</span>
<a name="ln-3292"></a>    <span class="k">IF</span><span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">YRegions</span><span class="p">))</span> <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">YRegions</span><span class="p">)</span>
<a name="ln-3293"></a>    <span class="k">IF</span><span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">ZRegions</span><span class="p">))</span> <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">ZRegions</span><span class="p">)</span>
<a name="ln-3294"></a>    <span class="k">IF</span><span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">XBoundaryPoints</span><span class="p">))</span> <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">XBoundaryPoints</span><span class="p">)</span>
<a name="ln-3295"></a>    <span class="k">IF</span><span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">YBoundaryPoints</span><span class="p">))</span> <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">YBoundaryPoints</span><span class="p">)</span>
<a name="ln-3296"></a>    <span class="k">IF</span><span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">ZBoundaryPoints</span><span class="p">))</span> <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">ZBoundaryPoints</span><span class="p">)</span>
<a name="ln-3297"></a>
<a name="ln-3298"></a>    <span class="k">RETURN</span>
<a name="ln-3299"></a>
<a name="ln-3300"></a><span class="k">END SUBROUTINE</span>
<a name="ln-3301"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-3302"></a>
<a name="ln-3303"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-3304"></a><span class="k">SUBROUTINE </span><span class="n">CreatePartitionCenterList</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)</span>
<a name="ln-3305"></a>
<a name="ln-3306"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3307"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-3308"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-3309"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-3310"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3311"></a>
<a name="ln-3312"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3313"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-3314"></a>
<a name="ln-3315"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3316"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-3317"></a>
<a name="ln-3318"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3319"></a>          <span class="c">! na</span>
<a name="ln-3320"></a>
<a name="ln-3321"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3322"></a>          <span class="c">! na</span>
<a name="ln-3323"></a>
<a name="ln-3324"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3325"></a>
<a name="ln-3326"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3327"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DomainNum</span>
<a name="ln-3328"></a>
<a name="ln-3329"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3330"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BasementCellFraction</span> <span class="o">=</span> <span class="mf">0.001d0</span> <span class="c">!the fraction of domain extent to use for the basement cells</span>
<a name="ln-3331"></a>                                                <span class="c">!actual dimension shouldn&#39;t matter for calculation purposes</span>
<a name="ln-3332"></a>
<a name="ln-3333"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3334"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BasementDistFromBottom</span>
<a name="ln-3335"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CircuitCtr</span>
<a name="ln-3336"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CircuitIndex</span>
<a name="ln-3337"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">PipeCtr</span>
<a name="ln-3338"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">PreviousUbound</span>
<a name="ln-3339"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">MeshPartition</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">PreviousEntries</span>
<a name="ln-3340"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PipeCellWidth</span>
<a name="ln-3341"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfCellWidth</span> <span class="c">!Basement surface...</span>
<a name="ln-3342"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">PipeSegmentInfo</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisSegment</span>
<a name="ln-3343"></a>
<a name="ln-3344"></a>    <span class="c">!&#39;NOTE: pipe location y values have already been corrected to be measured from the bottom surface</span>
<a name="ln-3345"></a>    <span class="c">!&#39;in input they are measured by depth, but internally they are referred to by distance from y = 0, or the bottom boundary</span>
<a name="ln-3346"></a>    <span class="k">DO </span><span class="n">CircuitCtr</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">CircuitIndeces</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3347"></a>                    <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">CircuitIndeces</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-3348"></a>        <span class="n">CircuitIndex</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">CircuitIndeces</span><span class="p">(</span><span class="n">CircuitCtr</span><span class="p">)</span>
<a name="ln-3349"></a>
<a name="ln-3350"></a>        <span class="c">!set up a convenience variable here</span>
<a name="ln-3351"></a>        <span class="c">!&#39;account for the pipe and insulation if necessary</span>
<a name="ln-3352"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitIndex</span><span class="p">)%</span><span class="n">HasInsulation</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3353"></a><span class="k">            </span><span class="n">PipeCellWidth</span> <span class="o">=</span> <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitIndex</span><span class="p">)%</span><span class="n">PipeSize</span><span class="p">%</span><span class="n">OuterDia</span>
<a name="ln-3354"></a>        <span class="k">ELSE</span>
<a name="ln-3355"></a><span class="k">            </span><span class="n">PipeCellWidth</span> <span class="o">=</span> <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitIndex</span><span class="p">)%</span><span class="n">InsulationSize</span><span class="p">%</span><span class="n">OuterDia</span>
<a name="ln-3356"></a>        <span class="k">END IF</span>
<a name="ln-3357"></a>        <span class="c">!&#39;then add the radial mesh thickness on both sides of the pipe/insulation construct</span>
<a name="ln-3358"></a>        <span class="n">PipeCellWidth</span> <span class="o">=</span> <span class="n">PipeCellWidth</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitIndex</span><span class="p">)%</span><span class="n">RadialMeshThickness</span>
<a name="ln-3359"></a>
<a name="ln-3360"></a>        <span class="k">DO </span><span class="n">PipeCtr</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitIndex</span><span class="p">)%</span><span class="n">PipeSegmentIndeces</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3361"></a>                     <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitIndex</span><span class="p">)%</span><span class="n">PipeSegmentIndeces</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-3362"></a>
<a name="ln-3363"></a>            <span class="n">ThisSegment</span> <span class="o">=</span> <span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitIndex</span><span class="p">)%</span><span class="n">PipeSegmentIndeces</span><span class="p">(</span><span class="n">PipeCtr</span><span class="p">))</span>
<a name="ln-3364"></a>            <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">X</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3365"></a><span class="k">                ALLOCATE</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">X</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">))</span>
<a name="ln-3366"></a>                <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">X</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3367"></a>                            <span class="n">MeshPartition</span><span class="p">(</span><span class="n">ThisSegment</span><span class="p">%</span><span class="n">PipeLocation</span><span class="p">%</span><span class="n">X</span><span class="p">,</span> <span class="n">PartitionType_Pipe</span><span class="p">,</span> <span class="n">PipeCellWidth</span><span class="p">)</span>
<a name="ln-3368"></a>            <span class="n">ELSEIF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">MeshPartitionArray_Contains</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">X</span><span class="p">,</span> <span class="n">ThisSegment</span><span class="p">%</span><span class="n">PipeLocation</span><span class="p">%</span><span class="n">X</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3369"></a><span class="k">                </span><span class="n">PreviousUbound</span> <span class="o">=</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">X</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-3370"></a>                <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">PreviousEntries</span><span class="p">))</span> <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">PreviousEntries</span><span class="p">)</span>
<a name="ln-3371"></a>                <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">PreviousEntries</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">PreviousUbound</span><span class="p">))</span>
<a name="ln-3372"></a>                <span class="n">PreviousEntries</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">X</span>
<a name="ln-3373"></a>                <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">X</span><span class="p">)</span>
<a name="ln-3374"></a>                <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">X</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">PreviousUbound</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-3375"></a>                <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">X</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">PreviousUbound</span><span class="p">)</span> <span class="o">=</span> <span class="n">PreviousEntries</span>
<a name="ln-3376"></a>                <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">X</span><span class="p">(</span><span class="n">PreviousUbound</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3377"></a>                            <span class="n">MeshPartition</span><span class="p">(</span><span class="n">ThisSegment</span><span class="p">%</span><span class="n">PipeLocation</span><span class="p">%</span><span class="n">X</span><span class="p">,</span> <span class="n">PartitionType_Pipe</span><span class="p">,</span> <span class="n">PipeCellWidth</span><span class="p">)</span>
<a name="ln-3378"></a>            <span class="k">END IF</span>
<a name="ln-3379"></a><span class="k">            IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">Y</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3380"></a><span class="k">                ALLOCATE</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">Y</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">))</span>
<a name="ln-3381"></a>                <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">Y</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3382"></a>                            <span class="n">MeshPartition</span><span class="p">(</span><span class="n">ThisSegment</span><span class="p">%</span><span class="n">PipeLocation</span><span class="p">%</span><span class="n">Y</span><span class="p">,</span> <span class="n">PartitionType_Pipe</span><span class="p">,</span> <span class="n">PipeCellWidth</span><span class="p">)</span>
<a name="ln-3383"></a>            <span class="n">ELSEIF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">MeshPartitionArray_Contains</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">Y</span><span class="p">,</span> <span class="n">ThisSegment</span><span class="p">%</span><span class="n">PipeLocation</span><span class="p">%</span><span class="n">Y</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3384"></a><span class="k">                </span><span class="n">PreviousUbound</span> <span class="o">=</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">Y</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-3385"></a>                <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">PreviousEntries</span><span class="p">))</span> <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">PreviousEntries</span><span class="p">)</span>
<a name="ln-3386"></a>                <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">PreviousEntries</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">PreviousUbound</span><span class="p">))</span>
<a name="ln-3387"></a>                <span class="n">PreviousEntries</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">Y</span>
<a name="ln-3388"></a>                <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">Y</span><span class="p">)</span>
<a name="ln-3389"></a>                <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">Y</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">PreviousUbound</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-3390"></a>                <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">Y</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">PreviousUbound</span><span class="p">)</span> <span class="o">=</span> <span class="n">PreviousEntries</span>
<a name="ln-3391"></a>                <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">Y</span><span class="p">(</span><span class="n">PreviousUbound</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3392"></a>                            <span class="n">MeshPartition</span><span class="p">(</span><span class="n">ThisSegment</span><span class="p">%</span><span class="n">PipeLocation</span><span class="p">%</span><span class="n">Y</span><span class="p">,</span> <span class="n">PartitionType_Pipe</span><span class="p">,</span> <span class="n">PipeCellWidth</span><span class="p">)</span>
<a name="ln-3393"></a>            <span class="k">END IF</span>
<a name="ln-3394"></a>
<a name="ln-3395"></a><span class="k">        END DO</span>
<a name="ln-3396"></a>
<a name="ln-3397"></a><span class="k">    END DO</span>
<a name="ln-3398"></a>
<a name="ln-3399"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">HasBasement</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3400"></a>        <span class="c">!&#39;NOTE: the basement depth is still a depth from the ground surface, need to correct for this here</span>
<a name="ln-3401"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BasementZone</span><span class="p">%</span><span class="n">Width</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3402"></a><span class="k">            </span><span class="n">SurfCellWidth</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Extents</span><span class="p">%</span><span class="n">Xmax</span> <span class="o">*</span> <span class="n">BasementCellFraction</span>
<a name="ln-3403"></a>            <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">X</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3404"></a><span class="k">                ALLOCATE</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">X</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">))</span>
<a name="ln-3405"></a>                <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">X</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3406"></a>                        <span class="n">MeshPartition</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BasementZone</span><span class="p">%</span><span class="n">Width</span><span class="p">,</span> <span class="n">PartitionType_BasementWall</span><span class="p">,</span> <span class="n">SurfCellWidth</span><span class="p">)</span>
<a name="ln-3407"></a>            <span class="n">ELSEIF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">MeshPartitionArray_Contains</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">X</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3408"></a>                                                      <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BasementZone</span><span class="p">%</span><span class="n">Width</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3409"></a><span class="k">                </span><span class="n">PreviousUbound</span> <span class="o">=</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">X</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-3410"></a>                <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">PreviousEntries</span><span class="p">))</span> <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">PreviousEntries</span><span class="p">)</span>
<a name="ln-3411"></a>                <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">PreviousEntries</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">PreviousUbound</span><span class="p">))</span>
<a name="ln-3412"></a>                <span class="n">PreviousEntries</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">X</span>
<a name="ln-3413"></a>                <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">X</span><span class="p">)</span>
<a name="ln-3414"></a>                <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">X</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">PreviousUbound</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-3415"></a>                <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">X</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">PreviousUbound</span><span class="p">)</span> <span class="o">=</span> <span class="n">PreviousEntries</span>
<a name="ln-3416"></a>                <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">X</span><span class="p">(</span><span class="n">PreviousUbound</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3417"></a>                        <span class="n">MeshPartition</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BasementZone</span><span class="p">%</span><span class="n">Width</span><span class="p">,</span> <span class="n">PartitionType_BasementWall</span><span class="p">,</span> <span class="n">SurfCellWidth</span><span class="p">)</span>
<a name="ln-3418"></a>            <span class="k">END IF</span>
<a name="ln-3419"></a><span class="k">        END IF</span>
<a name="ln-3420"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BasementZone</span><span class="p">%</span><span class="n">Depth</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3421"></a><span class="k">            </span><span class="n">SurfCellWidth</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Extents</span><span class="p">%</span><span class="n">Ymax</span> <span class="o">*</span> <span class="n">BasementCellFraction</span>
<a name="ln-3422"></a>            <span class="n">BasementDistFromBottom</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Extents</span><span class="p">%</span><span class="n">Ymax</span><span class="o">-</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BasementZone</span><span class="p">%</span><span class="n">Depth</span>
<a name="ln-3423"></a>            <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">Y</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3424"></a><span class="k">                ALLOCATE</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">Y</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">))</span>
<a name="ln-3425"></a>                <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">Y</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3426"></a>                        <span class="n">MeshPartition</span><span class="p">(</span><span class="n">BasementDistFromBottom</span><span class="p">,</span> <span class="n">PartitionType_BasementFloor</span><span class="p">,</span> <span class="n">SurfCellWidth</span><span class="p">)</span>
<a name="ln-3427"></a>            <span class="n">ELSEIF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">MeshPartitionArray_Contains</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">Y</span><span class="p">,</span> <span class="n">BasementDistFromBottom</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3428"></a><span class="k">                </span><span class="n">PreviousUbound</span> <span class="o">=</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">Y</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-3429"></a>                <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">PreviousEntries</span><span class="p">))</span> <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">PreviousEntries</span><span class="p">)</span>
<a name="ln-3430"></a>                <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">PreviousEntries</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">PreviousUbound</span><span class="p">))</span>
<a name="ln-3431"></a>                <span class="n">PreviousEntries</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">Y</span>
<a name="ln-3432"></a>                <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">Y</span><span class="p">)</span>
<a name="ln-3433"></a>                <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">Y</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">PreviousUbound</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-3434"></a>                <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">Y</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">PreviousUbound</span><span class="p">)</span> <span class="o">=</span> <span class="n">PreviousEntries</span>
<a name="ln-3435"></a>                <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">Y</span><span class="p">(</span><span class="n">PreviousUbound</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3436"></a>                        <span class="n">MeshPartition</span><span class="p">(</span><span class="n">BasementDistFromBottom</span><span class="p">,</span> <span class="n">PartitionType_BasementFloor</span><span class="p">,</span> <span class="n">SurfCellWidth</span><span class="p">)</span>
<a name="ln-3437"></a>            <span class="k">END IF</span>
<a name="ln-3438"></a><span class="k">        END IF</span>
<a name="ln-3439"></a><span class="k">    END IF</span>
<a name="ln-3440"></a>
<a name="ln-3441"></a><span class="k">    CALL </span><span class="n">MeshPartition_SelectionSort</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">X</span><span class="p">)</span>
<a name="ln-3442"></a>    <span class="k">CALL </span><span class="n">MeshPartition_SelectionSort</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Partitions</span><span class="p">%</span><span class="n">Y</span><span class="p">)</span>
<a name="ln-3443"></a>
<a name="ln-3444"></a><span class="k">END SUBROUTINE</span>
<a name="ln-3445"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-3446"></a>
<a name="ln-3447"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-3448"></a><span class="k">FUNCTION </span><span class="n">CreatePartitionRegionList</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">ThesePartitionCenters</span><span class="p">,</span> <span class="n">PartitionsExist</span><span class="p">,</span> <span class="n">DirExtentMax</span><span class="p">,</span> <span class="n">PartitionsUBound</span><span class="p">)</span>   <span class="p">&amp;</span>
<a name="ln-3449"></a>             <span class="k">RESULT</span><span class="p">(</span><span class="n">ThesePartitionRegions</span><span class="p">)</span>
<a name="ln-3450"></a>
<a name="ln-3451"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-3452"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-3453"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-3454"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-3455"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3456"></a>
<a name="ln-3457"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-3458"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-3459"></a>
<a name="ln-3460"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3461"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-3462"></a>
<a name="ln-3463"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3464"></a>          <span class="c">! na</span>
<a name="ln-3465"></a>
<a name="ln-3466"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3467"></a>          <span class="c">! na</span>
<a name="ln-3468"></a>
<a name="ln-3469"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3470"></a>
<a name="ln-3471"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-3472"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DomainNum</span>
<a name="ln-3473"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">MeshPartition</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThesePartitionCenters</span>
<a name="ln-3474"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartitionsUbound</span>
<a name="ln-3475"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DirExtentMax</span>
<a name="ln-3476"></a>    <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartitionsExist</span>
<a name="ln-3477"></a>
<a name="ln-3478"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-3479"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RoutineName</span> <span class="o">=</span> <span class="s1">&#39;CreatePartitionRegionList&#39;</span>
<a name="ln-3480"></a>
<a name="ln-3481"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3482"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="nb">Index</span>
<a name="ln-3483"></a><span class="nb">    </span><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisCellWidthBy2</span>
<a name="ln-3484"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ThisPartitionType</span> <span class="c">!From Enum: RegionType</span>
<a name="ln-3485"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CellLeft</span>
<a name="ln-3486"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CellRight</span>
<a name="ln-3487"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SubIndex</span>
<a name="ln-3488"></a>
<a name="ln-3489"></a>          <span class="c">! FUNCTION RETURN VALUE</span>
<a name="ln-3490"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">GridRegion</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">PartitionsUBound</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThesePartitionRegions</span>
<a name="ln-3491"></a>
<a name="ln-3492"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">PartitionsExist</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3493"></a><span class="k">        RETURN</span>
<a name="ln-3494"></a><span class="k">    END IF</span>
<a name="ln-3495"></a>
<a name="ln-3496"></a>    <span class="c">!&#39;loop across all partitions</span>
<a name="ln-3497"></a>    <span class="k">DO </span><span class="nb">Index</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">ThesePartitionCenters</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">ThesePartitionCenters</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-3498"></a>
<a name="ln-3499"></a>        <span class="n">ThisCellWidthBy2</span> <span class="o">=</span> <span class="n">ThesePartitionCenters</span><span class="p">(</span><span class="nb">Index</span><span class="p">)%</span><span class="n">TotalWidth</span> <span class="o">/</span> <span class="mf">2.0d0</span>
<a name="ln-3500"></a>        <span class="n">ThisPartitionType</span> <span class="o">=</span> <span class="n">ThesePartitionCenters</span><span class="p">(</span><span class="nb">Index</span><span class="p">)%</span><span class="n">PartitionType</span>
<a name="ln-3501"></a>
<a name="ln-3502"></a>        <span class="c">!&#39;use this half width to validate the region and add it to the collection</span>
<a name="ln-3503"></a>        <span class="n">CellLeft</span> <span class="o">=</span> <span class="n">ThesePartitionCenters</span><span class="p">(</span><span class="nb">Index</span><span class="p">)%</span><span class="n">rDimension</span> <span class="o">-</span> <span class="n">ThisCellWidthBy2</span>
<a name="ln-3504"></a>        <span class="n">CellRight</span> <span class="o">=</span> <span class="n">ThesePartitionCenters</span><span class="p">(</span><span class="nb">Index</span><span class="p">)%</span><span class="n">rDimension</span> <span class="o">+</span> <span class="n">ThisCellWidthBy2</span>
<a name="ln-3505"></a>
<a name="ln-3506"></a>        <span class="c">!check to make sure this location is valid</span>
<a name="ln-3507"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">CellLeft</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CellRight</span> <span class="o">&gt;</span> <span class="n">DirExtentMax</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3508"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;PlantPipingSystems::&#39;</span><span class="o">//</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;: Invalid partition location in domain.&#39;</span><span class="p">)</span>
<a name="ln-3509"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs during mesh development for domain=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3510"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;A pipe or basement is located outside of the domain extents.&#39;</span><span class="p">)</span>
<a name="ln-3511"></a>            <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Preceding error causes program termination.&#39;</span><span class="p">)</span>
<a name="ln-3512"></a>        <span class="k">END IF</span>
<a name="ln-3513"></a>
<a name="ln-3514"></a>        <span class="c">!Scan all grid regions to make sure this range doesn&#39;t fall within an already entered range</span>
<a name="ln-3515"></a>        <span class="k">DO </span><span class="n">SubIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">Index</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-3516"></a>            <span class="k">IF</span> <span class="p">(</span>     <span class="n">IsInRange</span><span class="p">(</span><span class="n">CellLeft</span><span class="p">,</span> <span class="n">ThesePartitionRegions</span><span class="p">(</span><span class="n">SubIndex</span><span class="p">)%</span><span class="nb">Min</span><span class="p">,</span> <span class="n">ThesePartitionRegions</span><span class="p">(</span><span class="n">SubIndex</span><span class="p">)%</span><span class="nb">Max</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-3517"></a>                <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">IsInRange</span><span class="p">(</span><span class="n">CellRight</span><span class="p">,</span> <span class="n">ThesePartitionRegions</span><span class="p">(</span><span class="n">SubIndex</span><span class="p">)%</span><span class="nb">Min</span><span class="p">,</span> <span class="n">ThesePartitionRegions</span><span class="p">(</span><span class="n">SubIndex</span><span class="p">)%</span><span class="nb">Max</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3518"></a>
<a name="ln-3519"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;PlantPipingSystems::&#39;</span><span class="o">//</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;: Invalid partition location in domain.&#39;</span><span class="p">)</span>
<a name="ln-3520"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs during mesh development for domain=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3521"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;A mesh conflict was encountered where partitions were overlapping.&#39;</span><span class="p">)</span>
<a name="ln-3522"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Ensure that all pipes exactly line up or are separated to allow meshing in between them&#39;</span><span class="p">)</span>
<a name="ln-3523"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Also verify the pipe and basement dimensions to avoid conflicts there.&#39;</span><span class="p">)</span>
<a name="ln-3524"></a>                <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Preceding error causes program termination&#39;</span><span class="p">)</span>
<a name="ln-3525"></a>
<a name="ln-3526"></a>            <span class="k">END IF</span>
<a name="ln-3527"></a><span class="k">        END DO</span>
<a name="ln-3528"></a>
<a name="ln-3529"></a><span class="k">        </span><span class="n">ThesePartitionRegions</span><span class="p">(</span><span class="nb">Index</span><span class="p">)%</span><span class="nb">Min</span> <span class="o">=</span> <span class="n">CellLeft</span>
<a name="ln-3530"></a>        <span class="n">ThesePartitionRegions</span><span class="p">(</span><span class="nb">Index</span><span class="p">)%</span><span class="nb">Max</span> <span class="o">=</span> <span class="n">CellRight</span>
<a name="ln-3531"></a>
<a name="ln-3532"></a>        <span class="c">!Need to map partition type into region type parameters, since they are different enumerations</span>
<a name="ln-3533"></a>        <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">ThisPartitionType</span><span class="p">)</span>
<a name="ln-3534"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">PartitionType_BasementWall</span><span class="p">)</span>
<a name="ln-3535"></a>            <span class="n">ThesePartitionRegions</span><span class="p">(</span><span class="nb">Index</span><span class="p">)%</span><span class="n">RegionType</span> <span class="o">=</span> <span class="n">RegionType_BasementWall</span>
<a name="ln-3536"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">PartitionType_BasementFloor</span><span class="p">)</span>
<a name="ln-3537"></a>            <span class="n">ThesePartitionRegions</span><span class="p">(</span><span class="nb">Index</span><span class="p">)%</span><span class="n">RegionType</span> <span class="o">=</span> <span class="n">RegionType_BasementFloor</span>
<a name="ln-3538"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">PartitionType_Pipe</span><span class="p">)</span>
<a name="ln-3539"></a>            <span class="n">ThesePartitionRegions</span><span class="p">(</span><span class="nb">Index</span><span class="p">)%</span><span class="n">RegionType</span> <span class="o">=</span> <span class="n">RegionType_Pipe</span>
<a name="ln-3540"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-3541"></a>            <span class="c">!diagnostic error</span>
<a name="ln-3542"></a>        <span class="k">END SELECT</span>
<a name="ln-3543"></a>
<a name="ln-3544"></a><span class="k">    END DO</span>
<a name="ln-3545"></a>
<a name="ln-3546"></a><span class="k">    RETURN</span>
<a name="ln-3547"></a>
<a name="ln-3548"></a><span class="k">END FUNCTION</span>
<a name="ln-3549"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-3550"></a>
<a name="ln-3551"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-3552"></a><span class="kt">INTEGER </span><span class="k">FUNCTION </span><span class="n">CreateRegionListCount</span><span class="p">(</span><span class="n">ThesePartitionRegions</span><span class="p">,</span> <span class="n">DirExtentMax</span><span class="p">,</span> <span class="n">PartitionsExist</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">RetVal</span><span class="p">)</span>
<a name="ln-3553"></a>
<a name="ln-3554"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-3555"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-3556"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-3557"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-3558"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3559"></a>
<a name="ln-3560"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-3561"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-3562"></a>
<a name="ln-3563"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3564"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-3565"></a>
<a name="ln-3566"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3567"></a>          <span class="c">! na</span>
<a name="ln-3568"></a>
<a name="ln-3569"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3570"></a>          <span class="c">! na</span>
<a name="ln-3571"></a>
<a name="ln-3572"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3573"></a>
<a name="ln-3574"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-3575"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">GridRegion</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThesePartitionRegions</span>
<a name="ln-3576"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DirExtentMax</span>
<a name="ln-3577"></a>    <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartitionsExist</span>
<a name="ln-3578"></a>
<a name="ln-3579"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3580"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="nb">Index</span>
<a name="ln-3581"></a>
<a name="ln-3582"></a><span class="nb">    </span><span class="n">RetVal</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3583"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PartitionsExist</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3584"></a><span class="k">        DO </span><span class="nb">Index</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">ThesePartitionRegions</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">ThesePartitionRegions</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3585"></a>            <span class="c">!&#39;add a mesh region to the &quot;left&quot; of the partition</span>
<a name="ln-3586"></a>            <span class="n">RetVal</span> <span class="o">=</span> <span class="n">RetVal</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-3587"></a>            <span class="c">!&#39;then add the pipe node itself</span>
<a name="ln-3588"></a>            <span class="n">RetVal</span> <span class="o">=</span> <span class="n">RetVal</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-3589"></a>            <span class="c">!some cleanup based on where we are</span>
<a name="ln-3590"></a>            <span class="k">IF</span> <span class="p">((</span><span class="nb">Index</span><span class="o">==</span><span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SIZE</span><span class="p">(</span><span class="n">ThesePartitionRegions</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3591"></a>                <span class="p">(</span><span class="nb">Index</span> <span class="o">==</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">ThesePartitionRegions</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ThesePartitionRegions</span><span class="p">(</span><span class="nb">Index</span><span class="p">)%</span><span class="nb">Max</span> <span class="o">&lt;</span> <span class="n">DirExtentMax</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3592"></a>                <span class="c">!&#39;if there is only one partition, add a mesh region to the &quot;right&quot; before we leave</span>
<a name="ln-3593"></a>                <span class="c">!&#39;or if we are on the last partition, and we have room on the &quot;right&quot; side then add a mesh region</span>
<a name="ln-3594"></a>                <span class="n">RetVal</span> <span class="o">=</span> <span class="n">RetVal</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-3595"></a>            <span class="k">END IF</span>
<a name="ln-3596"></a><span class="k">        END DO</span>
<a name="ln-3597"></a><span class="k">    ELSE</span> <span class="c">!Input partitions were not allocate</span>
<a name="ln-3598"></a>        <span class="c">!&#39;if we don&#39;t have a region, we still need to make a single mesh region</span>
<a name="ln-3599"></a>        <span class="n">RetVal</span> <span class="o">=</span> <span class="n">RetVal</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-3600"></a>    <span class="k">END IF</span>
<a name="ln-3601"></a>
<a name="ln-3602"></a><span class="k">    RETURN</span>
<a name="ln-3603"></a>
<a name="ln-3604"></a><span class="k">END FUNCTION</span>
<a name="ln-3605"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-3606"></a>
<a name="ln-3607"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-3608"></a><span class="k">FUNCTION </span><span class="n">CreateRegionList</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">ThesePartitionRegions</span><span class="p">,</span> <span class="n">DirExtentMax</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3609"></a>                          <span class="n">DirDirection</span><span class="p">,</span> <span class="n">RetValUbound</span><span class="p">,</span> <span class="n">PartitionsExist</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3610"></a>                          <span class="n">BasementWallXIndex</span><span class="p">,</span> <span class="n">BasementFloorYIndex</span><span class="p">)</span>   <span class="k">RESULT</span><span class="p">(</span><span class="n">RetVal</span><span class="p">)</span>
<a name="ln-3611"></a>
<a name="ln-3612"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-3613"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-3614"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-3615"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-3616"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3617"></a>
<a name="ln-3618"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-3619"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-3620"></a>
<a name="ln-3621"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3622"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-3623"></a>
<a name="ln-3624"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3625"></a>          <span class="c">! na</span>
<a name="ln-3626"></a>
<a name="ln-3627"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3628"></a>          <span class="c">! na</span>
<a name="ln-3629"></a>
<a name="ln-3630"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3631"></a>
<a name="ln-3632"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-3633"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DomainNum</span>
<a name="ln-3634"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">GridRegion</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThesePartitionRegions</span>
<a name="ln-3635"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DirExtentMax</span>
<a name="ln-3636"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DirDirection</span>
<a name="ln-3637"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RetValUBound</span>
<a name="ln-3638"></a>    <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartitionsExist</span>
<a name="ln-3639"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span> <span class="n">OUT</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">BasementWallXIndex</span>
<a name="ln-3640"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span> <span class="n">OUT</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">BasementFloorYIndex</span>
<a name="ln-3641"></a>
<a name="ln-3642"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3643"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">GridRegion</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">RetValUbound</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RetVal</span>
<a name="ln-3644"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">TempGridRegionData</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">RetValUbound</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TempRegions</span>
<a name="ln-3645"></a>
<a name="ln-3646"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">GridRegion</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisRegion</span>
<a name="ln-3647"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">TempGridRegionData</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PreviousRegion</span>
<a name="ln-3648"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LeftRegionExtent</span>
<a name="ln-3649"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">PreviousUbound</span>
<a name="ln-3650"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="nb">Index</span>
<a name="ln-3651"></a><span class="nb">    </span><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SubIndex</span>
<a name="ln-3652"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CellCountUpToNow</span>
<a name="ln-3653"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumCellWidths</span>
<a name="ln-3654"></a>
<a name="ln-3655"></a>    <span class="n">PreviousUbound</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-3656"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PartitionsExist</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3657"></a><span class="k">        DO </span><span class="nb">Index</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">ThesePartitionRegions</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">ThesePartitionRegions</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3658"></a>
<a name="ln-3659"></a>            <span class="n">ThisRegion</span> <span class="o">=</span> <span class="n">ThesePartitionRegions</span><span class="p">(</span><span class="nb">Index</span><span class="p">)</span>
<a name="ln-3660"></a>
<a name="ln-3661"></a>            <span class="k">IF</span> <span class="p">(</span><span class="nb">Index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3662"></a><span class="k">                </span><span class="n">LeftRegionExtent</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3663"></a>            <span class="k">ELSE</span>
<a name="ln-3664"></a><span class="k">                </span><span class="n">LeftRegionExtent</span> <span class="o">=</span> <span class="n">ThesePartitionRegions</span><span class="p">(</span><span class="nb">Index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)%</span><span class="nb">Max</span>
<a name="ln-3665"></a><span class="nb">            </span><span class="k">END IF</span>
<a name="ln-3666"></a>
<a name="ln-3667"></a>            <span class="c">!&#39;add a mesh region to the &quot;left&quot; of the partition</span>
<a name="ln-3668"></a>            <span class="n">PreviousUbound</span> <span class="o">=</span> <span class="n">PreviousUbound</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-3669"></a>            <span class="n">TempRegions</span><span class="p">(</span><span class="n">PreviousUbound</span><span class="p">)</span> <span class="o">=</span> <span class="n">TempGridRegionData</span><span class="p">(</span><span class="n">LeftRegionExtent</span><span class="p">,</span> <span class="n">ThisRegion</span><span class="p">%</span><span class="nb">Min</span><span class="p">,</span> <span class="n">DirDirection</span><span class="p">)</span>
<a name="ln-3670"></a>
<a name="ln-3671"></a>            <span class="c">!&#39;alert calling routines to the location of the basement cells within the domain</span>
<a name="ln-3672"></a>            <span class="n">CellCountUpToNow</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3673"></a>
<a name="ln-3674"></a>            <span class="k">DO </span><span class="n">SubIndex</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">TempRegions</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">PreviousUbound</span>
<a name="ln-3675"></a>                <span class="n">PreviousRegion</span> <span class="o">=</span> <span class="n">TempRegions</span><span class="p">(</span><span class="n">SubIndex</span><span class="p">)</span>
<a name="ln-3676"></a>
<a name="ln-3677"></a>                <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">PreviousRegion</span><span class="p">%</span><span class="n">RegionType</span><span class="p">)</span>
<a name="ln-3678"></a>                <span class="k">CASE</span> <span class="p">(</span><span class="n">RegionType_Pipe</span><span class="p">,</span> <span class="n">RegionType_BasementFloor</span><span class="p">,</span> <span class="n">RegionType_BasementWall</span><span class="p">)</span>
<a name="ln-3679"></a>                    <span class="n">CellCountUpToNow</span> <span class="o">=</span> <span class="n">CellCountUpToNow</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-3680"></a>                <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-3681"></a>                    <span class="n">CellCountUpToNow</span> <span class="o">=</span> <span class="n">CellCountUpToNow</span> <span class="o">+</span> <span class="n">GetCellWidthsCount</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">DirDirection</span><span class="p">)</span>
<a name="ln-3682"></a>                <span class="k">END SELECT</span>
<a name="ln-3683"></a>
<a name="ln-3684"></a><span class="k">            END DO</span>
<a name="ln-3685"></a>
<a name="ln-3686"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">ThisRegion</span><span class="p">%</span><span class="n">RegionType</span> <span class="o">==</span> <span class="n">RegionType_BasementWall</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3687"></a><span class="k">                IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">BasementWallXIndex</span><span class="p">))</span> <span class="n">BasementWallXIndex</span> <span class="o">=</span> <span class="n">CellCountUpToNow</span>
<a name="ln-3688"></a>            <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">ThisRegion</span><span class="p">%</span><span class="n">RegionType</span> <span class="o">==</span> <span class="n">RegionType_BasementFloor</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3689"></a><span class="k">                IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">BasementFloorYIndex</span><span class="p">))</span> <span class="n">BasementFloorYIndex</span> <span class="o">=</span> <span class="n">CellCountUpToNow</span>
<a name="ln-3690"></a>            <span class="k">END IF</span>
<a name="ln-3691"></a>
<a name="ln-3692"></a>            <span class="c">!&#39;then add the pipe node itself</span>
<a name="ln-3693"></a>            <span class="n">PreviousUbound</span> <span class="o">=</span> <span class="n">PreviousUbound</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-3694"></a>            <span class="n">TempRegions</span><span class="p">(</span><span class="n">PreviousUbound</span><span class="p">)</span> <span class="o">=</span> <span class="n">TempGridRegionData</span><span class="p">(</span><span class="n">ThisRegion</span><span class="p">%</span><span class="nb">Min</span><span class="p">,</span> <span class="n">ThisRegion</span><span class="p">%</span><span class="nb">Max</span><span class="p">,</span> <span class="n">ThisRegion</span><span class="p">%</span><span class="n">RegionType</span><span class="p">)</span>
<a name="ln-3695"></a>
<a name="ln-3696"></a>            <span class="c">!some cleanup based on where we are</span>
<a name="ln-3697"></a>            <span class="k">IF</span> <span class="p">((</span><span class="nb">Index</span><span class="o">==</span><span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SIZE</span><span class="p">(</span><span class="n">ThesePartitionRegions</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3698"></a>                <span class="p">(</span><span class="nb">Index</span> <span class="o">==</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">ThesePartitionRegions</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ThisRegion</span><span class="p">%</span><span class="nb">Max</span> <span class="o">&lt;</span> <span class="n">DirExtentMax</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3699"></a>                <span class="c">!&#39;if there is only one partition, add a mesh region to the &quot;right&quot; before we leave</span>
<a name="ln-3700"></a>                <span class="c">!&#39;or if we are on the last partition, and we have room on the &quot;right&quot; side then add a mesh region</span>
<a name="ln-3701"></a>                <span class="n">PreviousUbound</span> <span class="o">=</span> <span class="n">PreviousUbound</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-3702"></a>                <span class="n">TempRegions</span><span class="p">(</span><span class="n">PreviousUbound</span><span class="p">)</span> <span class="o">=</span> <span class="n">TempGridRegionData</span><span class="p">(</span><span class="n">ThisRegion</span><span class="p">%</span><span class="nb">Max</span><span class="p">,</span> <span class="n">DirExtentMax</span><span class="p">,</span> <span class="n">DirDirection</span><span class="p">)</span>
<a name="ln-3703"></a>            <span class="k">END IF</span>
<a name="ln-3704"></a>
<a name="ln-3705"></a><span class="k">        END DO</span>
<a name="ln-3706"></a><span class="k">    ELSE</span> <span class="c">!Input partitions were not allocate</span>
<a name="ln-3707"></a>        <span class="c">!&#39;if we don&#39;t have a region, we still need to make a single mesh region</span>
<a name="ln-3708"></a>        <span class="n">TempRegions</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">TempGridRegionData</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="n">DirExtentMax</span><span class="p">,</span> <span class="n">DirDirection</span><span class="p">)</span>
<a name="ln-3709"></a>    <span class="k">END IF</span>
<a name="ln-3710"></a>
<a name="ln-3711"></a>    <span class="c">!&#39;finally repackage the grid regions into the final class form with cell counts included</span>
<a name="ln-3712"></a>    <span class="k">DO </span><span class="nb">Index</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">TempRegions</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">TempRegions</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3713"></a>        <span class="n">RetVal</span><span class="p">(</span><span class="nb">Index</span><span class="p">)%</span><span class="nb">Min</span> <span class="o">=</span> <span class="n">TempRegions</span><span class="p">(</span><span class="nb">Index</span><span class="p">)%</span><span class="nb">Min</span>
<a name="ln-3714"></a><span class="nb">        </span><span class="n">RetVal</span><span class="p">(</span><span class="nb">Index</span><span class="p">)%</span><span class="nb">Max</span> <span class="o">=</span> <span class="n">TempRegions</span><span class="p">(</span><span class="nb">Index</span><span class="p">)%</span><span class="nb">Max</span>
<a name="ln-3715"></a><span class="nb">        </span><span class="n">RetVal</span><span class="p">(</span><span class="nb">Index</span><span class="p">)%</span><span class="n">RegionType</span> <span class="o">=</span> <span class="n">TempRegions</span><span class="p">(</span><span class="nb">Index</span><span class="p">)%</span><span class="n">RegionType</span>
<a name="ln-3716"></a>        <span class="n">NumCellWidths</span> <span class="o">=</span> <span class="n">GetCellWidthsCount</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">DirDirection</span><span class="p">)</span>
<a name="ln-3717"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">RetVal</span><span class="p">(</span><span class="nb">Index</span><span class="p">)%</span><span class="n">CellWidths</span><span class="p">))</span> <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">RetVal</span><span class="p">(</span><span class="nb">Index</span><span class="p">)%</span><span class="n">CellWidths</span><span class="p">)</span>
<a name="ln-3718"></a>        <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">RetVal</span><span class="p">(</span><span class="nb">Index</span><span class="p">)%</span><span class="n">CellWidths</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">NumCellWidths</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-3719"></a><span class="c">!        write(outputfiledebug,*) &#39;3332,index,retval&#39;,index, retval(index)%regiontype, &amp;</span>
<a name="ln-3720"></a><span class="c">!          numcellwidths</span>
<a name="ln-3721"></a>        <span class="k">CALL </span><span class="n">GetCellWidths</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span><span class="n">RetVal</span><span class="p">(</span><span class="nb">Index</span><span class="p">))</span>
<a name="ln-3722"></a><span class="c">!        RetVal(Index)%CellWidths = GetCellWidths(DomainNum, RetVal(Index))</span>
<a name="ln-3723"></a>    <span class="k">END DO</span>
<a name="ln-3724"></a>
<a name="ln-3725"></a><span class="k">    RETURN</span>
<a name="ln-3726"></a>
<a name="ln-3727"></a><span class="k">END FUNCTION</span>
<a name="ln-3728"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-3729"></a>
<a name="ln-3730"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-3731"></a><span class="kt">INTEGER </span><span class="k">FUNCTION </span><span class="n">CreateBoundaryListCount</span><span class="p">(</span><span class="n">RegionList</span><span class="p">,</span> <span class="n">dirDirection</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">RetVal</span><span class="p">)</span>
<a name="ln-3732"></a>
<a name="ln-3733"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-3734"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-3735"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-3736"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-3737"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3738"></a>
<a name="ln-3739"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-3740"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-3741"></a>
<a name="ln-3742"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3743"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-3744"></a>
<a name="ln-3745"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3746"></a>          <span class="c">! na</span>
<a name="ln-3747"></a>
<a name="ln-3748"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3749"></a>          <span class="c">! na</span>
<a name="ln-3750"></a>
<a name="ln-3751"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3752"></a>
<a name="ln-3753"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-3754"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">GridRegion</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RegionList</span>
<a name="ln-3755"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dirDirection</span>
<a name="ln-3756"></a>
<a name="ln-3757"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-3758"></a>          <span class="c">! na</span>
<a name="ln-3759"></a>
<a name="ln-3760"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-3761"></a>          <span class="c">! na</span>
<a name="ln-3762"></a>
<a name="ln-3763"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-3764"></a>          <span class="c">! na</span>
<a name="ln-3765"></a>
<a name="ln-3766"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3767"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="nb">Index</span>
<a name="ln-3768"></a><span class="nb">    </span><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CellWidthCtr</span>
<a name="ln-3769"></a>
<a name="ln-3770"></a>    <span class="n">RetVal</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3771"></a>
<a name="ln-3772"></a>    <span class="k">DO </span><span class="nb">Index</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">RegionList</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">RegionList</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3773"></a>        <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">RegionList</span><span class="p">(</span><span class="nb">Index</span><span class="p">)%</span><span class="n">RegionType</span><span class="p">)</span>
<a name="ln-3774"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">RegionType_Pipe</span><span class="p">,</span> <span class="n">RegionType_BasementFloor</span><span class="p">,</span> <span class="n">RegionType_BasementWall</span><span class="p">)</span>
<a name="ln-3775"></a>            <span class="n">RetVal</span> <span class="o">=</span> <span class="n">RetVal</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-3776"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-3777"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">RegionList</span><span class="p">(</span><span class="nb">Index</span><span class="p">)%</span><span class="n">RegionType</span> <span class="o">==</span> <span class="n">dirDirection</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3778"></a><span class="k">                DO </span><span class="n">CellWidthCtr</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">RegionList</span><span class="p">(</span><span class="nb">Index</span><span class="p">)%</span><span class="n">CellWidths</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">RegionList</span><span class="p">(</span><span class="nb">Index</span><span class="p">)%</span><span class="n">CellWidths</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3779"></a>                    <span class="n">RetVal</span> <span class="o">=</span> <span class="n">RetVal</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-3780"></a>                <span class="k">END DO</span>
<a name="ln-3781"></a><span class="k">            END IF</span>
<a name="ln-3782"></a><span class="k">        END SELECT</span>
<a name="ln-3783"></a><span class="k">    END DO</span>
<a name="ln-3784"></a><span class="k">    </span><span class="n">RetVal</span> <span class="o">=</span> <span class="n">RetVal</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-3785"></a>
<a name="ln-3786"></a>    <span class="k">RETURN</span>
<a name="ln-3787"></a>
<a name="ln-3788"></a><span class="k">END FUNCTION</span>
<a name="ln-3789"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-3790"></a>
<a name="ln-3791"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-3792"></a><span class="k">FUNCTION </span><span class="n">CreateBoundaryList</span><span class="p">(</span><span class="n">RegionList</span><span class="p">,</span> <span class="n">DirExtentMax</span><span class="p">,</span> <span class="n">DirDirection</span><span class="p">,</span> <span class="n">RetValLbound</span><span class="p">,</span> <span class="n">RetValUbound</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">RetVal</span><span class="p">)</span>
<a name="ln-3793"></a>
<a name="ln-3794"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-3795"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-3796"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-3797"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-3798"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3799"></a>
<a name="ln-3800"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-3801"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-3802"></a>
<a name="ln-3803"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3804"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-3805"></a>
<a name="ln-3806"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3807"></a>          <span class="c">! na</span>
<a name="ln-3808"></a>
<a name="ln-3809"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3810"></a>          <span class="c">! na</span>
<a name="ln-3811"></a>
<a name="ln-3812"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3813"></a>
<a name="ln-3814"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-3815"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">GridRegion</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RegionList</span>
<a name="ln-3816"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DirExtentMax</span>
<a name="ln-3817"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DirDirection</span>
<a name="ln-3818"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RetValLbound</span>
<a name="ln-3819"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RetValUbound</span>
<a name="ln-3820"></a>
<a name="ln-3821"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3822"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">StartingPointCounter</span>
<a name="ln-3823"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="nb">Index</span>
<a name="ln-3824"></a><span class="nb">    </span><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Counter</span>
<a name="ln-3825"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CellWidthCtr</span>
<a name="ln-3826"></a>
<a name="ln-3827"></a>          <span class="c">! FUNCTION RETURN VALUE</span>
<a name="ln-3828"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RetVal</span><span class="p">(</span><span class="n">RetValLbound</span><span class="p">:</span><span class="n">RetValUbound</span><span class="p">)</span>
<a name="ln-3829"></a>
<a name="ln-3830"></a>    <span class="n">Counter</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-3831"></a>    <span class="k">DO </span><span class="nb">Index</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">RegionList</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">RegionList</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3832"></a>        <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">RegionList</span><span class="p">(</span><span class="nb">Index</span><span class="p">)%</span><span class="n">RegionType</span><span class="p">)</span>
<a name="ln-3833"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">RegionType_Pipe</span><span class="p">,</span> <span class="n">RegionType_BasementFloor</span><span class="p">,</span> <span class="n">RegionType_BasementWall</span><span class="p">)</span>
<a name="ln-3834"></a>            <span class="n">Counter</span> <span class="o">=</span> <span class="n">Counter</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-3835"></a>            <span class="n">RetVal</span><span class="p">(</span><span class="n">Counter</span><span class="p">)</span> <span class="o">=</span> <span class="n">RegionList</span><span class="p">(</span><span class="nb">Index</span><span class="p">)%</span><span class="nb">Min</span>
<a name="ln-3836"></a><span class="nb">        </span><span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-3837"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">RegionList</span><span class="p">(</span><span class="nb">Index</span><span class="p">)%</span><span class="n">RegionType</span> <span class="o">==</span> <span class="n">dirDirection</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3838"></a><span class="k">                </span><span class="n">StartingPointCounter</span> <span class="o">=</span> <span class="n">RegionList</span><span class="p">(</span><span class="nb">Index</span><span class="p">)%</span><span class="nb">Min</span>
<a name="ln-3839"></a><span class="nb">                </span><span class="k">DO </span><span class="n">CellWidthCtr</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">RegionList</span><span class="p">(</span><span class="nb">Index</span><span class="p">)%</span><span class="n">CellWidths</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">RegionList</span><span class="p">(</span><span class="nb">Index</span><span class="p">)%</span><span class="n">CellWidths</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3840"></a>                    <span class="n">Counter</span> <span class="o">=</span> <span class="n">Counter</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-3841"></a>                    <span class="n">RetVal</span><span class="p">(</span><span class="n">Counter</span><span class="p">)</span> <span class="o">=</span> <span class="n">StartingPointCounter</span>
<a name="ln-3842"></a>                    <span class="n">StartingPointCounter</span> <span class="o">=</span> <span class="n">StartingPointCounter</span> <span class="o">+</span> <span class="n">RegionList</span><span class="p">(</span><span class="nb">Index</span><span class="p">)%</span><span class="n">CellWidths</span><span class="p">(</span><span class="n">CellWidthCtr</span><span class="p">)</span>
<a name="ln-3843"></a>                <span class="k">END DO</span>
<a name="ln-3844"></a><span class="k">            END IF</span>
<a name="ln-3845"></a><span class="k">        END SELECT</span>
<a name="ln-3846"></a><span class="k">    END DO</span>
<a name="ln-3847"></a><span class="k">    </span><span class="n">RetVal</span><span class="p">(</span><span class="nb">UBOUND</span><span class="p">(</span><span class="n">RetVal</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="o">=</span> <span class="n">dirExtentMax</span>
<a name="ln-3848"></a>
<a name="ln-3849"></a>    <span class="k">RETURN</span>
<a name="ln-3850"></a>
<a name="ln-3851"></a><span class="k">END FUNCTION</span>
<a name="ln-3852"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-3853"></a>
<a name="ln-3854"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-3855"></a><span class="k">SUBROUTINE </span><span class="n">CreateCellArray</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">XBoundaryPoints</span><span class="p">,</span> <span class="n">YBoundaryPoints</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3856"></a>                           <span class="n">ZBoundaryPoints</span><span class="p">,</span> <span class="n">MaxBasementXNodeIndex</span><span class="p">,</span> <span class="n">MinBasementYNodeIndex</span><span class="p">)</span>
<a name="ln-3857"></a>
<a name="ln-3858"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3859"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-3860"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-3861"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-3862"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3863"></a>
<a name="ln-3864"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3865"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-3866"></a>
<a name="ln-3867"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3868"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-3869"></a>
<a name="ln-3870"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3871"></a>          <span class="c">! na</span>
<a name="ln-3872"></a>
<a name="ln-3873"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3874"></a>          <span class="c">! na</span>
<a name="ln-3875"></a>
<a name="ln-3876"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3877"></a>
<a name="ln-3878"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3879"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DomainNum</span>
<a name="ln-3880"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">XBoundaryPoints</span>
<a name="ln-3881"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">YBoundaryPoints</span>
<a name="ln-3882"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ZBoundaryPoints</span>
<a name="ln-3883"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MaxBasementXNodeIndex</span>
<a name="ln-3884"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MinBasementYNodeIndex</span>
<a name="ln-3885"></a>
<a name="ln-3886"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-3887"></a>    <span class="k">TYPE </span><span class="n">tCellExtents</span>
<a name="ln-3888"></a>        <span class="k">TYPE</span><span class="p">(</span><span class="n">MeshExtents</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MyBase</span>
<a name="ln-3889"></a>        <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">Xmin</span>
<a name="ln-3890"></a>        <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">Ymin</span>
<a name="ln-3891"></a>        <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">Zmin</span>
<a name="ln-3892"></a>    <span class="k">END TYPE </span><span class="n">tCellExtents</span>
<a name="ln-3893"></a>
<a name="ln-3894"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3895"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">YIndexMax</span>
<a name="ln-3896"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">DomainRectangle</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BasementRectangle</span>
<a name="ln-3897"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">tCellExtents</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CellExtents</span>
<a name="ln-3898"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Point3DReal</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Centroid</span>
<a name="ln-3899"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">Point3DInteger</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CellIndeces</span>
<a name="ln-3900"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">RectangleF</span><span class="p">)</span> <span class="kd">::</span> <span class="n">XYRectangle</span>
<a name="ln-3901"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CellType</span> <span class="c">!From Enum: CellType</span>
<a name="ln-3902"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ZWallCellType</span> <span class="c">!From Enum: CellType</span>
<a name="ln-3903"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">UnderBasementBoundary</span> <span class="c">!From Enum: CellType</span>
<a name="ln-3904"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">PipeCounter</span>
<a name="ln-3905"></a>
<a name="ln-3906"></a>    <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">X</span>
<a name="ln-3907"></a>    <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CellXIndex</span>
<a name="ln-3908"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CellXMinValue</span>
<a name="ln-3909"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CellXMaxValue</span>
<a name="ln-3910"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CellXCenter</span>
<a name="ln-3911"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CellWidth</span>
<a name="ln-3912"></a>
<a name="ln-3913"></a>    <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">Y</span>
<a name="ln-3914"></a>    <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CellYIndex</span>
<a name="ln-3915"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CellYMinValue</span>
<a name="ln-3916"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CellYMaxValue</span>
<a name="ln-3917"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CellYCenter</span>
<a name="ln-3918"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CellHeight</span>
<a name="ln-3919"></a>
<a name="ln-3920"></a>    <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">Z</span>
<a name="ln-3921"></a>    <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CellZIndex</span>
<a name="ln-3922"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CellZMinValue</span>
<a name="ln-3923"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CellZMaxValue</span>
<a name="ln-3924"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CellZCenter</span>
<a name="ln-3925"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CellDepth</span>
<a name="ln-3926"></a>
<a name="ln-3927"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">PipeIndex</span>
<a name="ln-3928"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumRadialCells</span>
<a name="ln-3929"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InsulationThickness</span>
<a name="ln-3930"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CircuitCtr</span>
<a name="ln-3931"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CircuitIndex</span>
<a name="ln-3932"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">FoundOnCircuitIndex</span>
<a name="ln-3933"></a>
<a name="ln-3934"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">RadialSizing</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PipeSizing</span>
<a name="ln-3935"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">PipeSegmentInfo</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisSegment</span>
<a name="ln-3936"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RadialMeshThickness</span>
<a name="ln-3937"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">HasInsulation</span>
<a name="ln-3938"></a>
<a name="ln-3939"></a>    <span class="c">!&#39;subtract 2 in each dimension:</span>
<a name="ln-3940"></a>    <span class="c">!&#39;     one for zero based array</span>
<a name="ln-3941"></a>    <span class="c">!&#39;     one because the boundary points contain one entry more than the number of cells WITHIN the domain</span>
<a name="ln-3942"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span> <span class="mi">0</span><span class="p">:</span><span class="n">SIZE</span><span class="p">(</span><span class="n">XBoundaryPoints</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3943"></a>                                                   <span class="mi">0</span><span class="p">:</span><span class="n">SIZE</span><span class="p">(</span><span class="n">YBoundaryPoints</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3944"></a>                                                   <span class="mi">0</span><span class="p">:</span><span class="n">SIZE</span><span class="p">(</span><span class="n">ZBoundaryPoints</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>  <span class="p">)</span>
<a name="ln-3945"></a>
<a name="ln-3946"></a>    <span class="n">YIndexMax</span> <span class="o">=</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<a name="ln-3947"></a>    <span class="n">BasementRectangle</span> <span class="o">=</span> <span class="n">DomainRectangle</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">MaxBasementXNodeIndex</span><span class="p">,</span> <span class="n">MinBasementYNodeIndex</span><span class="p">,</span> <span class="n">YIndexMax</span><span class="p">)</span>
<a name="ln-3948"></a>
<a name="ln-3949"></a>    <span class="k">DO </span><span class="n">Z</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-3950"></a>        <span class="k">DO </span><span class="n">Y</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-3951"></a>            <span class="k">DO </span><span class="n">X</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3952"></a>
<a name="ln-3953"></a>                <span class="c">!&#39;set up x-direction variables</span>
<a name="ln-3954"></a>                <span class="n">CellXIndex</span> <span class="o">=</span> <span class="n">X</span>  <span class="c">!&#39;zero based index</span>
<a name="ln-3955"></a>                <span class="n">CellXMinValue</span> <span class="o">=</span> <span class="n">XBoundaryPoints</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>  <span class="c">!&#39;left wall x-value</span>
<a name="ln-3956"></a>                <span class="n">CellXMaxValue</span> <span class="o">=</span> <span class="n">XBoundaryPoints</span><span class="p">(</span><span class="n">X</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>  <span class="c">!&#39;right wall x-value</span>
<a name="ln-3957"></a>                <span class="n">CellXCenter</span> <span class="o">=</span> <span class="p">(</span><span class="n">CellXMinValue</span> <span class="o">+</span> <span class="n">CellXMaxValue</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
<a name="ln-3958"></a>                <span class="n">CellWidth</span> <span class="o">=</span> <span class="n">CellXMaxValue</span> <span class="o">-</span> <span class="n">CellXMinValue</span>
<a name="ln-3959"></a>
<a name="ln-3960"></a>                <span class="c">!&#39;set up y-direction variables</span>
<a name="ln-3961"></a>                <span class="n">CellYIndex</span> <span class="o">=</span> <span class="n">Y</span> <span class="c">!&#39;zero based index</span>
<a name="ln-3962"></a>                <span class="n">CellYMinValue</span> <span class="o">=</span> <span class="n">YBoundaryPoints</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>  <span class="c">!&#39;bottom wall y-value</span>
<a name="ln-3963"></a>                <span class="n">CellYMaxValue</span> <span class="o">=</span> <span class="n">YBoundaryPoints</span><span class="p">(</span><span class="n">Y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>  <span class="c">!&#39;top wall y-value</span>
<a name="ln-3964"></a>                <span class="n">CellYCenter</span> <span class="o">=</span> <span class="p">(</span><span class="n">CellYMinValue</span> <span class="o">+</span> <span class="n">CellYMaxValue</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
<a name="ln-3965"></a>                <span class="n">CellHeight</span> <span class="o">=</span> <span class="n">CellYMaxValue</span> <span class="o">-</span> <span class="n">CellYMinValue</span>
<a name="ln-3966"></a>
<a name="ln-3967"></a>                <span class="c">!&#39;set up z-direction variables</span>
<a name="ln-3968"></a>                <span class="n">CellZIndex</span> <span class="o">=</span> <span class="n">Z</span>  <span class="c">!&#39;zero based index</span>
<a name="ln-3969"></a>                <span class="n">CellZMinValue</span> <span class="o">=</span> <span class="n">ZBoundaryPoints</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>  <span class="c">!&#39;lower z value</span>
<a name="ln-3970"></a>                <span class="n">CellZMaxValue</span> <span class="o">=</span> <span class="n">ZBoundaryPoints</span><span class="p">(</span><span class="n">Z</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>  <span class="c">!&#39;higher z value</span>
<a name="ln-3971"></a>                <span class="n">CellZCenter</span> <span class="o">=</span> <span class="p">(</span><span class="n">CellZMinValue</span> <span class="o">+</span> <span class="n">CellZMaxValue</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
<a name="ln-3972"></a>                <span class="n">CellDepth</span> <span class="o">=</span> <span class="n">CellZMaxValue</span> <span class="o">-</span> <span class="n">CellZMinValue</span>
<a name="ln-3973"></a>
<a name="ln-3974"></a>                <span class="c">!&#39;set up an extent class for this cell</span>
<a name="ln-3975"></a>                <span class="n">CellExtents</span> <span class="o">=</span> <span class="n">tCellExtents</span><span class="p">(</span><span class="n">MeshExtents</span><span class="p">(</span><span class="n">CellXMaxValue</span><span class="p">,</span> <span class="n">CellYMaxValue</span><span class="p">,</span> <span class="n">CellZMaxValue</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3976"></a>                                                                <span class="n">CellXMinValue</span><span class="p">,</span> <span class="n">CellYMinValue</span><span class="p">,</span> <span class="n">CellZMinValue</span><span class="p">)</span>
<a name="ln-3977"></a>
<a name="ln-3978"></a>                <span class="c">!&#39;set up centroid, index, and overall size</span>
<a name="ln-3979"></a>                <span class="n">Centroid</span> <span class="o">=</span> <span class="n">Point3DReal</span><span class="p">(</span><span class="n">CellXCenter</span><span class="p">,</span> <span class="n">CellYCenter</span><span class="p">,</span> <span class="n">CellZCenter</span><span class="p">)</span>
<a name="ln-3980"></a>                <span class="n">CellIndeces</span> <span class="o">=</span> <span class="n">Point3DInteger</span><span class="p">(</span><span class="n">CellXIndex</span><span class="p">,</span> <span class="n">CellYIndex</span><span class="p">,</span> <span class="n">CellZIndex</span><span class="p">)</span>
<a name="ln-3981"></a>                <span class="n">XYRectangle</span> <span class="o">=</span> <span class="n">RectangleF</span><span class="p">(</span><span class="n">CellXMinValue</span><span class="p">,</span> <span class="n">CellYMinValue</span><span class="p">,</span> <span class="n">CellWidth</span><span class="p">,</span> <span class="n">CellHeight</span><span class="p">)</span>
<a name="ln-3982"></a>
<a name="ln-3983"></a>                <span class="c">!&#39;determine cell type</span>
<a name="ln-3984"></a>                <span class="n">CellType</span> <span class="o">=</span> <span class="n">CellType_Unknown</span>
<a name="ln-3985"></a>
<a name="ln-3986"></a>                <span class="c">!&#39;if this is a pipe node, some flags are needed</span>
<a name="ln-3987"></a>                <span class="n">PipeIndex</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-3988"></a>                <span class="n">NumRadialCells</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-3989"></a>                <span class="n">CircuitIndex</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-3990"></a>
<a name="ln-3991"></a>                <span class="c">!Since we removed the z wall cell type to always be adiabatic, this is only temporary</span>
<a name="ln-3992"></a>                <span class="n">ZWallCellType</span> <span class="o">=</span> <span class="n">CellType_AdiabaticWall</span>
<a name="ln-3993"></a>                <span class="n">UnderBasementBoundary</span> <span class="o">=</span> <span class="n">CellType_AdiabaticWall</span>
<a name="ln-3994"></a>
<a name="ln-3995"></a>                <span class="c">!&#39;apply boundary conditions</span>
<a name="ln-3996"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">CellXIndex</span> <span class="o">==</span> <span class="n">MaxBasementXNodeIndex</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">CellYIndex</span> <span class="o">==</span> <span class="n">MinBasementYNodeIndex</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3997"></a><span class="k">                    </span><span class="n">CellType</span> <span class="o">=</span> <span class="n">CellType_BasementCorner</span>
<a name="ln-3998"></a>                <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">CellXIndex</span> <span class="o">==</span> <span class="n">MaxBasementXNodeIndex</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">CellYIndex</span> <span class="o">&gt;</span> <span class="n">MinBasementYNodeIndex</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3999"></a><span class="k">                    </span><span class="n">CellType</span> <span class="o">=</span> <span class="n">CellType_BasementWall</span>
<a name="ln-4000"></a>                <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">CellXIndex</span> <span class="o">&lt;</span> <span class="n">MaxBasementXNodeIndex</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">CellYIndex</span> <span class="o">==</span> <span class="n">MinBasementYNodeIndex</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4001"></a><span class="k">                    </span><span class="n">CellType</span> <span class="o">=</span> <span class="n">CellType_BasementFloor</span>
<a name="ln-4002"></a>                <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">CellXIndex</span> <span class="o">&lt;</span> <span class="n">MaxBasementXNodeIndex</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">CellYIndex</span> <span class="o">&gt;</span> <span class="n">MinBasementYNodeIndex</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4003"></a><span class="k">                    </span><span class="n">CellType</span> <span class="o">=</span> <span class="n">CellType_BasementCutAway</span>
<a name="ln-4004"></a>                <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">CellYIndex</span> <span class="o">==</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4005"></a><span class="k">                    </span><span class="n">CellType</span> <span class="o">=</span> <span class="n">CellType_GroundSurface</span>
<a name="ln-4006"></a>                <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">CellXIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4007"></a><span class="k">                    IF</span> <span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">HasBasement</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Y</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4008"></a><span class="k">                        </span><span class="n">CellType</span> <span class="o">=</span> <span class="n">UnderBasementBoundary</span> <span class="c">!&#39;this must come after the basement cutaway ELSEIF branch</span>
<a name="ln-4009"></a>                    <span class="k">ELSE</span>
<a name="ln-4010"></a><span class="k">                        </span><span class="n">CellType</span> <span class="o">=</span> <span class="n">CellType_FarfieldBoundary</span>
<a name="ln-4011"></a>                    <span class="k">END IF</span>
<a name="ln-4012"></a><span class="k">                ELSE IF</span> <span class="p">(</span><span class="n">CellXIndex</span> <span class="o">==</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CellYIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4013"></a><span class="k">                    </span><span class="n">CellType</span> <span class="o">=</span> <span class="n">CellType_FarfieldBoundary</span>
<a name="ln-4014"></a>                <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">CellZIndex</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CellZIndex</span> <span class="o">==</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4015"></a><span class="k">                    </span><span class="n">CellType</span> <span class="o">=</span> <span class="n">ZWallCellType</span>
<a name="ln-4016"></a>                <span class="k">END IF</span>
<a name="ln-4017"></a>
<a name="ln-4018"></a>                <span class="c">!&#39;check to see if this is a pipe node...</span>
<a name="ln-4019"></a><span class="n">CircuitLoop</span><span class="p">:</span>    <span class="k">DO </span><span class="n">CircuitCtr</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">CircuitIndeces</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4020"></a>                                <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">CircuitIndeces</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-4021"></a>
<a name="ln-4022"></a>                    <span class="n">FoundOnCircuitIndex</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">CircuitIndeces</span><span class="p">(</span><span class="n">CircuitCtr</span><span class="p">)</span>
<a name="ln-4023"></a><span class="n">SegmentLoop</span><span class="p">:</span>        <span class="k">DO </span><span class="n">PipeCounter</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">FoundOnCircuitIndex</span><span class="p">)%</span><span class="n">PipeSegmentIndeces</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4024"></a>                                     <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">FoundOnCircuitIndex</span><span class="p">)%</span><span class="n">PipeSegmentIndeces</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4025"></a>
<a name="ln-4026"></a>                        <span class="n">ThisSegment</span><span class="o">=</span><span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">FoundOnCircuitIndex</span><span class="p">)%</span><span class="n">PipeSegmentIndeces</span><span class="p">(</span><span class="n">PipeCounter</span><span class="p">))</span>
<a name="ln-4027"></a>                        <span class="k">IF</span> <span class="p">(</span><span class="n">RectangleF_Contains</span><span class="p">(</span><span class="n">XYRectangle</span><span class="p">,</span> <span class="n">ThisSegment</span><span class="p">%</span><span class="n">PipeLocation</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4028"></a>                            <span class="c">!&#39;inform the cell that it is a pipe node</span>
<a name="ln-4029"></a>                            <span class="n">CellType</span> <span class="o">=</span> <span class="n">CellType_Pipe</span>
<a name="ln-4030"></a>                            <span class="c">!&#39;inform the cell of which pipe it contains</span>
<a name="ln-4031"></a>                            <span class="n">PipeIndex</span> <span class="o">=</span> <span class="n">PipeCounter</span>
<a name="ln-4032"></a>                            <span class="c">!&#39;inform the cell of which pipe circuit contains it</span>
<a name="ln-4033"></a>                            <span class="n">CircuitIndex</span> <span class="o">=</span> <span class="n">FoundOnCircuitIndex</span>
<a name="ln-4034"></a>                            <span class="c">!&#39;inform the pipe of what cell it is inside</span>
<a name="ln-4035"></a>                            <span class="k">CALL </span><span class="n">PipeSegmentInfo_InitPipeCells</span><span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-4036"></a>                                 <span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">FoundOnCircuitIndex</span><span class="p">)%</span><span class="n">PipeSegmentIndeces</span><span class="p">(</span><span class="n">PipeCounter</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-4037"></a>                                 <span class="n">CellXIndex</span><span class="p">,</span> <span class="n">CellYIndex</span><span class="p">)</span>
<a name="ln-4038"></a>                            <span class="c">!&#39;set the number of cells to be generated in this near-pipe region</span>
<a name="ln-4039"></a>                            <span class="n">NumRadialCells</span> <span class="o">=</span> <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">FoundOnCircuitIndex</span><span class="p">)%</span><span class="n">NumRadialCells</span>
<a name="ln-4040"></a>                            <span class="c">!&#39;exit the pipe counter loop</span>
<a name="ln-4041"></a>                            <span class="k">EXIT </span><span class="n">CircuitLoop</span>
<a name="ln-4042"></a>                        <span class="k">END IF</span>
<a name="ln-4043"></a>
<a name="ln-4044"></a><span class="k">                    END DO </span><span class="n">SegmentLoop</span>
<a name="ln-4045"></a>
<a name="ln-4046"></a>                <span class="k">END DO </span><span class="n">CircuitLoop</span>
<a name="ln-4047"></a>
<a name="ln-4048"></a>                <span class="c">!&#39;if it still isn&#39;t anything, then it is just an interior node</span>
<a name="ln-4049"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">CellType</span> <span class="o">==</span> <span class="n">CellType_Unknown</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4050"></a><span class="k">                    </span><span class="n">CellType</span> <span class="o">=</span> <span class="n">CellType_GeneralField</span>
<a name="ln-4051"></a>                <span class="k">END IF</span>
<a name="ln-4052"></a>
<a name="ln-4053"></a>                <span class="c">! if we were found on a pipe circuit, get some things for convenience</span>
<a name="ln-4054"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">CircuitIndex</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4055"></a><span class="k">                    IF</span> <span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitIndex</span><span class="p">)%</span><span class="n">HasInsulation</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4056"></a><span class="k">                        </span><span class="n">InsulationThickness</span> <span class="o">=</span> <span class="n">RadialSizing_Thickness</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitIndex</span><span class="p">)%</span><span class="n">InsulationSize</span><span class="p">)</span>
<a name="ln-4057"></a>                    <span class="k">END IF</span>
<a name="ln-4058"></a><span class="k">                    </span><span class="n">PipeSizing</span> <span class="o">=</span> <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitIndex</span><span class="p">)%</span><span class="n">PipeSize</span>
<a name="ln-4059"></a>                    <span class="n">RadialMeshThickness</span> <span class="o">=</span> <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitIndex</span><span class="p">)%</span><span class="n">RadialMeshThickness</span>
<a name="ln-4060"></a>                    <span class="n">HasInsulation</span> <span class="o">=</span> <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitIndex</span><span class="p">)%</span><span class="n">HasInsulation</span>
<a name="ln-4061"></a>                <span class="k">END IF</span>
<a name="ln-4062"></a>
<a name="ln-4063"></a>                <span class="c">!&#39;instantiate the cell class</span>
<a name="ln-4064"></a>                <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">X_min</span> <span class="o">=</span> <span class="n">CellExtents</span><span class="p">%</span><span class="n">Xmin</span>
<a name="ln-4065"></a>                <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">X_max</span> <span class="o">=</span> <span class="n">CellExtents</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Xmax</span>
<a name="ln-4066"></a>                <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">Y_min</span> <span class="o">=</span> <span class="n">CellExtents</span><span class="p">%</span><span class="n">Ymin</span>
<a name="ln-4067"></a>                <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">Y_max</span> <span class="o">=</span> <span class="n">CellExtents</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Ymax</span>
<a name="ln-4068"></a>                <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">Z_min</span> <span class="o">=</span> <span class="n">CellExtents</span><span class="p">%</span><span class="n">Zmin</span>
<a name="ln-4069"></a>                <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">Z_max</span> <span class="o">=</span> <span class="n">CellExtents</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Zmax</span>
<a name="ln-4070"></a>                <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">X_index</span> <span class="o">=</span> <span class="n">CellIndeces</span><span class="p">%</span><span class="n">X</span>
<a name="ln-4071"></a>                <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">Y_index</span> <span class="o">=</span> <span class="n">CellIndeces</span><span class="p">%</span><span class="n">Y</span>
<a name="ln-4072"></a>                <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">Z_index</span> <span class="o">=</span> <span class="n">CellIndeces</span><span class="p">%</span><span class="n">Z</span>
<a name="ln-4073"></a>                <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">Centroid</span> <span class="o">=</span> <span class="n">Centroid</span>
<a name="ln-4074"></a>                <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">CellType</span> <span class="o">=</span> <span class="n">CellType</span>
<a name="ln-4075"></a>
<a name="ln-4076"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">PipeIndex</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4077"></a><span class="k">                    </span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeIndex</span> <span class="o">=</span> <span class="n">PipeIndex</span>
<a name="ln-4078"></a>                    <span class="k">CALL </span><span class="n">CartesianPipeCellInformation_ctor</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4079"></a>                      <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">X_max</span> <span class="o">-</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">X_min</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4080"></a>                      <span class="n">PipeSizing</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4081"></a>                      <span class="n">NumRadialCells</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4082"></a>                      <span class="n">Depth</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-4083"></a>                      <span class="n">InsulationThickness</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4084"></a>                      <span class="n">RadialMeshThickness</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4085"></a>                      <span class="n">HasInsulation</span><span class="p">)</span>
<a name="ln-4086"></a>                <span class="k">END IF</span>
<a name="ln-4087"></a>
<a name="ln-4088"></a><span class="k">            END DO</span> <span class="c">!&#39;z</span>
<a name="ln-4089"></a>        <span class="k">END DO</span> <span class="c">!&#39;y</span>
<a name="ln-4090"></a>    <span class="k">END DO</span> <span class="c">!&#39;x</span>
<a name="ln-4091"></a>
<a name="ln-4092"></a><span class="k">END SUBROUTINE</span>
<a name="ln-4093"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-4094"></a>
<a name="ln-4095"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-4096"></a><span class="k">SUBROUTINE </span><span class="n">SetupCellNeighbors</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)</span>
<a name="ln-4097"></a>
<a name="ln-4098"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4099"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-4100"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-4101"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4102"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4103"></a>
<a name="ln-4104"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4105"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-4106"></a>
<a name="ln-4107"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4108"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-4109"></a>
<a name="ln-4110"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4111"></a>          <span class="c">! na</span>
<a name="ln-4112"></a>
<a name="ln-4113"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4114"></a>          <span class="c">! na</span>
<a name="ln-4115"></a>
<a name="ln-4116"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4117"></a>
<a name="ln-4118"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4119"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DomainNum</span>
<a name="ln-4120"></a>
<a name="ln-4121"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4122"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span>
<a name="ln-4123"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisCellCentroidX</span>
<a name="ln-4124"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisCellCentroidY</span>
<a name="ln-4125"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisCellCentroidZ</span>
<a name="ln-4126"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CellRightCentroidX</span>
<a name="ln-4127"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CellRightLeftWallX</span>
<a name="ln-4128"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CellLeftCentroidX</span>
<a name="ln-4129"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CellLeftRightWallX</span>
<a name="ln-4130"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LeftCellCentroidX</span>
<a name="ln-4131"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LeftCellRightWallX</span>
<a name="ln-4132"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RightCellCentroidX</span>
<a name="ln-4133"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RightCellLeftWallX</span>
<a name="ln-4134"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UpperCellCentroidY</span>
<a name="ln-4135"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UpperCellLowerWallY</span>
<a name="ln-4136"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LowerCellCentroidY</span>
<a name="ln-4137"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LowerCellUpperWallY</span>
<a name="ln-4138"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UpperZCellCentroidZ</span>
<a name="ln-4139"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UpperZCellLowerWallZ</span>
<a name="ln-4140"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LowerZCellCentroidZ</span>
<a name="ln-4141"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LowerZCellUpperWallZ</span>
<a name="ln-4142"></a>
<a name="ln-4143"></a>    <span class="k">DO </span><span class="n">X</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-4144"></a>        <span class="k">DO </span><span class="n">Y</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<a name="ln-4145"></a>            <span class="k">DO </span><span class="n">Z</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a name="ln-4146"></a>
<a name="ln-4147"></a>                <span class="c">!&#39;for convenience</span>
<a name="ln-4148"></a>                <span class="n">ThisCellCentroidX</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">X</span>
<a name="ln-4149"></a>                <span class="n">ThisCellCentroidY</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">Y</span>
<a name="ln-4150"></a>                <span class="n">ThisCellCentroidZ</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">Z</span>
<a name="ln-4151"></a>
<a name="ln-4152"></a>                <span class="c">!&#39;setup east/west cell neighbors</span>
<a name="ln-4153"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">X</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4154"></a><span class="k">                    </span><span class="n">CellRightCentroidX</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">X</span>
<a name="ln-4155"></a>                    <span class="n">CellRightLeftWallX</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">X_min</span>
<a name="ln-4156"></a>                    <span class="k">CALL </span><span class="n">AddNeighborInformation</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span> <span class="n">Direction_PositiveX</span><span class="p">,</span> <span class="n">CellRightCentroidX</span> <span class="o">-</span> <span class="n">ThisCellCentroidX</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4157"></a>                                                                                         <span class="n">CellRightLeftWallX</span> <span class="o">-</span> <span class="n">ThisCellCentroidX</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4158"></a>                                                                                         <span class="n">CellRightCentroidX</span> <span class="o">-</span> <span class="n">CellRightLeftWallX</span><span class="p">)</span>
<a name="ln-4159"></a>                    <span class="k">CALL </span><span class="n">AddNeighborInformation</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span> <span class="n">Direction_NegativeX</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-4160"></a>                <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">X</span> <span class="o">==</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4161"></a><span class="k">                    </span><span class="n">CellLeftCentroidX</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">X</span>
<a name="ln-4162"></a>                    <span class="n">CellLeftRightWallX</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">X_max</span>
<a name="ln-4163"></a>                    <span class="k">CALL </span><span class="n">AddNeighborInformation</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span> <span class="n">Direction_NegativeX</span><span class="p">,</span> <span class="n">ThisCellCentroidX</span> <span class="o">-</span> <span class="n">CellLeftCentroidX</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4164"></a>                                                                                         <span class="n">ThisCellCentroidX</span> <span class="o">-</span> <span class="n">CellLeftRightWallX</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4165"></a>                                                                                         <span class="n">CellLeftRightWallX</span> <span class="o">-</span> <span class="n">CellLeftCentroidX</span><span class="p">)</span>
<a name="ln-4166"></a>                    <span class="k">CALL </span><span class="n">AddNeighborInformation</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span> <span class="n">Direction_PositiveX</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-4167"></a>                <span class="k">ELSE</span>
<a name="ln-4168"></a><span class="k">                    </span><span class="n">LeftCellCentroidX</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">X</span>
<a name="ln-4169"></a>                    <span class="n">LeftCellRightWallX</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">X_max</span>
<a name="ln-4170"></a>                    <span class="n">RightCellCentroidX</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">X</span>
<a name="ln-4171"></a>                    <span class="n">RightCellLeftWallX</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">X_min</span>
<a name="ln-4172"></a>                    <span class="k">CALL </span><span class="n">AddNeighborInformation</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span> <span class="n">Direction_NegativeX</span><span class="p">,</span> <span class="n">ThisCellCentroidX</span> <span class="o">-</span> <span class="n">LeftCellCentroidX</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4173"></a>                                                                                         <span class="n">ThisCellCentroidX</span> <span class="o">-</span> <span class="n">LeftCellRightWallX</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4174"></a>                                                                                         <span class="n">LeftCellRightWallX</span> <span class="o">-</span> <span class="n">LeftCellCentroidX</span><span class="p">)</span>
<a name="ln-4175"></a>                    <span class="k">CALL </span><span class="n">AddNeighborInformation</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span> <span class="n">Direction_PositiveX</span><span class="p">,</span> <span class="n">RightCellCentroidX</span> <span class="o">-</span> <span class="n">ThisCellCentroidX</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4176"></a>                                                                                         <span class="n">RightCellLeftWallX</span> <span class="o">-</span> <span class="n">ThisCellCentroidX</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4177"></a>                                                                                         <span class="n">RightCellCentroidX</span> <span class="o">-</span> <span class="n">RightCellLeftWallX</span><span class="p">)</span>
<a name="ln-4178"></a>                <span class="k">END IF</span>
<a name="ln-4179"></a>
<a name="ln-4180"></a>                <span class="c">!&#39;setup north/south cell neighbors</span>
<a name="ln-4181"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">Y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4182"></a><span class="k">                    </span><span class="n">UpperCellCentroidY</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">Y</span>
<a name="ln-4183"></a>                    <span class="n">UpperCellLowerWallY</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">Y_min</span>
<a name="ln-4184"></a>                    <span class="k">CALL </span><span class="n">AddNeighborInformation</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span> <span class="n">Direction_PositiveY</span><span class="p">,</span> <span class="n">UpperCellCentroidY</span> <span class="o">-</span> <span class="n">ThisCellCentroidY</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4185"></a>                                                                                         <span class="n">UpperCellLowerWallY</span> <span class="o">-</span> <span class="n">ThisCellCentroidY</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4186"></a>                                                                                         <span class="n">UpperCellCentroidY</span> <span class="o">-</span> <span class="n">UpperCellLowerWallY</span><span class="p">)</span>
<a name="ln-4187"></a>                    <span class="k">CALL </span><span class="n">AddNeighborInformation</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span> <span class="n">Direction_NegativeY</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-4188"></a>                <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Y</span> <span class="o">==</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4189"></a><span class="k">                    </span><span class="n">LowerCellCentroidY</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">Y</span>
<a name="ln-4190"></a>                    <span class="n">LowerCellUpperWallY</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">Y_max</span>
<a name="ln-4191"></a>                    <span class="k">CALL </span><span class="n">AddNeighborInformation</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span> <span class="n">Direction_NegativeY</span><span class="p">,</span> <span class="n">ThisCellCentroidY</span> <span class="o">-</span> <span class="n">LowerCellCentroidY</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4192"></a>                                                                                         <span class="n">ThisCellCentroidY</span> <span class="o">-</span> <span class="n">LowerCellUpperWallY</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4193"></a>                                                                                         <span class="n">LowerCellUpperWallY</span> <span class="o">-</span> <span class="n">LowerCellCentroidY</span><span class="p">)</span>
<a name="ln-4194"></a>                    <span class="k">CALL </span><span class="n">AddNeighborInformation</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span> <span class="n">Direction_PositiveY</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-4195"></a>                <span class="k">ELSE</span>
<a name="ln-4196"></a><span class="k">                    </span><span class="n">UpperCellCentroidY</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">Y</span>
<a name="ln-4197"></a>                    <span class="n">LowerCellCentroidY</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">Y</span>
<a name="ln-4198"></a>                    <span class="n">UpperCellLowerWallY</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">Y_min</span>
<a name="ln-4199"></a>                    <span class="n">LowerCellUpperWallY</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">Y_max</span>
<a name="ln-4200"></a>                    <span class="k">CALL </span><span class="n">AddNeighborInformation</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span> <span class="n">Direction_NegativeY</span><span class="p">,</span> <span class="n">ThisCellCentroidY</span> <span class="o">-</span> <span class="n">LowerCellCentroidY</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4201"></a>                                                                                         <span class="n">ThisCellCentroidY</span> <span class="o">-</span> <span class="n">LowerCellUpperWallY</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4202"></a>                                                                                         <span class="n">LowerCellUpperWallY</span> <span class="o">-</span> <span class="n">LowerCellCentroidY</span><span class="p">)</span>
<a name="ln-4203"></a>                    <span class="k">CALL </span><span class="n">AddNeighborInformation</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span> <span class="n">Direction_PositiveY</span><span class="p">,</span> <span class="n">UpperCellCentroidY</span> <span class="o">-</span> <span class="n">ThisCellCentroidY</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4204"></a>                                                                                         <span class="n">UpperCellLowerWallY</span> <span class="o">-</span> <span class="n">ThisCellCentroidY</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4205"></a>                                                                                         <span class="n">UpperCellCentroidY</span> <span class="o">-</span> <span class="n">UpperCellLowerWallY</span><span class="p">)</span>
<a name="ln-4206"></a>                <span class="k">END IF</span>
<a name="ln-4207"></a>
<a name="ln-4208"></a>                <span class="c">!&#39;setup forward/backward cell neighbors</span>
<a name="ln-4209"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">Z</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4210"></a><span class="k">                    </span><span class="n">UpperZCellCentroidZ</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">Z</span>
<a name="ln-4211"></a>                    <span class="n">UpperZCellLowerWallZ</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)%</span><span class="n">Z_min</span>
<a name="ln-4212"></a>                    <span class="k">CALL </span><span class="n">AddNeighborInformation</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span> <span class="n">Direction_PositiveZ</span><span class="p">,</span> <span class="n">UpperZCellCentroidZ</span> <span class="o">-</span> <span class="n">ThisCellCentroidZ</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4213"></a>                                                                                         <span class="n">UpperZCellLowerWallZ</span> <span class="o">-</span> <span class="n">ThisCellCentroidZ</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4214"></a>                                                                                         <span class="n">UpperZCellCentroidZ</span> <span class="o">-</span> <span class="n">UpperZCellLowerWallZ</span><span class="p">)</span>
<a name="ln-4215"></a>                    <span class="k">CALL </span><span class="n">AddNeighborInformation</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span> <span class="n">Direction_NegativeZ</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-4216"></a>                <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Z</span> <span class="o">==</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4217"></a><span class="k">                    </span><span class="n">LowerZCellCentroidZ</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">Z</span>
<a name="ln-4218"></a>                    <span class="n">LowerZCellUpperWallZ</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)%</span><span class="n">Z_max</span>
<a name="ln-4219"></a>                    <span class="k">CALL </span><span class="n">AddNeighborInformation</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span> <span class="n">Direction_NegativeZ</span><span class="p">,</span> <span class="n">ThisCellCentroidZ</span> <span class="o">-</span> <span class="n">LowerZCellCentroidZ</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4220"></a>                                                                                         <span class="n">ThisCellCentroidZ</span> <span class="o">-</span> <span class="n">LowerZCellUpperWallZ</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4221"></a>                                                                                         <span class="n">LowerZCellUpperWallZ</span> <span class="o">-</span> <span class="n">LowerZCellCentroidZ</span><span class="p">)</span>
<a name="ln-4222"></a>                    <span class="k">CALL </span><span class="n">AddNeighborInformation</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span> <span class="n">Direction_PositiveZ</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-4223"></a>                <span class="k">ELSE</span>
<a name="ln-4224"></a><span class="k">                    </span><span class="n">LowerZCellCentroidZ</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">Z</span>
<a name="ln-4225"></a>                    <span class="n">UpperZCellCentroidZ</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">Z</span>
<a name="ln-4226"></a>                    <span class="n">UpperZCellLowerWallZ</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)%</span><span class="n">Z_min</span>
<a name="ln-4227"></a>                    <span class="n">LowerZCellUpperWallZ</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)%</span><span class="n">Z_max</span>
<a name="ln-4228"></a>                    <span class="k">CALL </span><span class="n">AddNeighborInformation</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span> <span class="n">Direction_NegativeZ</span><span class="p">,</span> <span class="n">ThisCellCentroidZ</span> <span class="o">-</span> <span class="n">LowerZCellCentroidZ</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4229"></a>                                                                                         <span class="n">ThisCellCentroidZ</span> <span class="o">-</span> <span class="n">LowerZCellUpperWallZ</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4230"></a>                                                                                         <span class="n">LowerZCellUpperWallZ</span> <span class="o">-</span> <span class="n">LowerZCellCentroidZ</span><span class="p">)</span>
<a name="ln-4231"></a>                    <span class="k">CALL </span><span class="n">AddNeighborInformation</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span> <span class="n">Direction_PositiveZ</span><span class="p">,</span> <span class="n">UpperZCellCentroidZ</span> <span class="o">-</span> <span class="n">ThisCellCentroidZ</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4232"></a>                                                                                         <span class="n">UpperZCellLowerWallZ</span> <span class="o">-</span> <span class="n">ThisCellCentroidZ</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4233"></a>                                                                                         <span class="n">UpperZCellCentroidZ</span> <span class="o">-</span> <span class="n">UpperZCellLowerWallZ</span><span class="p">)</span>
<a name="ln-4234"></a>                <span class="k">END IF</span>
<a name="ln-4235"></a>
<a name="ln-4236"></a><span class="k">            END DO</span>
<a name="ln-4237"></a><span class="k">        END DO</span>
<a name="ln-4238"></a><span class="k">    END DO</span>
<a name="ln-4239"></a>
<a name="ln-4240"></a><span class="k">END SUBROUTINE</span>
<a name="ln-4241"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-4242"></a>
<a name="ln-4243"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-4244"></a><span class="k">SUBROUTINE </span><span class="n">AddNeighborInformation</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">Direction</span><span class="p">,</span> <span class="n">ThisCentroidToNeighborCentroid</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4245"></a>                                                                    <span class="n">ThisCentroidToNeighborWall</span><span class="p">,</span> <span class="n">ThisWallToNeighborCentroid</span><span class="p">)</span>
<a name="ln-4246"></a>
<a name="ln-4247"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4248"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-4249"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-4250"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4251"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4252"></a>
<a name="ln-4253"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4254"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-4255"></a>
<a name="ln-4256"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4257"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-4258"></a>
<a name="ln-4259"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4260"></a>          <span class="c">! na</span>
<a name="ln-4261"></a>
<a name="ln-4262"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4263"></a>          <span class="c">! na</span>
<a name="ln-4264"></a>
<a name="ln-4265"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4266"></a>
<a name="ln-4267"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4268"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DomainNum</span>
<a name="ln-4269"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">X</span>
<a name="ln-4270"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Y</span>
<a name="ln-4271"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Z</span>
<a name="ln-4272"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Direction</span> <span class="c">!From Enum: Direction</span>
<a name="ln-4273"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisCentroidToNeighborCentroid</span>
<a name="ln-4274"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisCentroidToNeighborWall</span>
<a name="ln-4275"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisWallToNeighborCentroid</span>
<a name="ln-4276"></a>
<a name="ln-4277"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4278"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">DirectionNeighbor_Dictionary</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">PrevValues</span>
<a name="ln-4279"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">PrevUbound</span>
<a name="ln-4280"></a>
<a name="ln-4281"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)%</span><span class="n">NeighborInformation</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4282"></a><span class="k">        ALLOCATE</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)%</span><span class="n">NeighborInformation</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">))</span>
<a name="ln-4283"></a>        <span class="n">PrevUBound</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-4284"></a>    <span class="k">ELSE</span>
<a name="ln-4285"></a><span class="k">        </span><span class="n">PrevUbound</span> <span class="o">=</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)%</span><span class="n">NeighborInformation</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-4286"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">PrevValues</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">PrevUbound</span><span class="p">))</span>
<a name="ln-4287"></a>        <span class="n">PrevValues</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)%</span><span class="n">NeighborInformation</span>
<a name="ln-4288"></a>        <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)%</span><span class="n">NeighborInformation</span><span class="p">)</span>
<a name="ln-4289"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)%</span><span class="n">NeighborInformation</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">PrevUbound</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-4290"></a>        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)%</span><span class="n">NeighborInformation</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">PrevUbound</span><span class="p">)</span> <span class="o">=</span> <span class="n">PrevValues</span>
<a name="ln-4291"></a>        <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">PrevValues</span><span class="p">)</span>
<a name="ln-4292"></a>    <span class="k">END IF</span>
<a name="ln-4293"></a>
<a name="ln-4294"></a><span class="k">    </span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)%</span><span class="n">NeighborInformation</span><span class="p">(</span><span class="n">PrevUbound</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">Direction</span> <span class="o">=</span> <span class="n">Direction</span>
<a name="ln-4295"></a>
<a name="ln-4296"></a>    <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)%</span><span class="n">NeighborInformation</span><span class="p">(</span><span class="n">PrevUbound</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="k">Value</span><span class="p">%</span><span class="n">ThisCentroidToNeighborCentroid</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4297"></a>                                                                                                <span class="n">ThisCentroidToNeighborCentroid</span>
<a name="ln-4298"></a>
<a name="ln-4299"></a>    <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)%</span><span class="n">NeighborInformation</span><span class="p">(</span><span class="n">PrevUbound</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="k">Value</span><span class="p">%</span><span class="n">ThisCentroidToNeighborWall</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4300"></a>                                                                                                <span class="n">ThisCentroidToNeighborWall</span>
<a name="ln-4301"></a>
<a name="ln-4302"></a>    <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)%</span><span class="n">NeighborInformation</span><span class="p">(</span><span class="n">PrevUbound</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="k">Value</span><span class="p">%</span><span class="n">ThisWallToNeighborCentroid</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4303"></a>                                                                                                <span class="n">ThisWallToNeighborCentroid</span>
<a name="ln-4304"></a>
<a name="ln-4305"></a>    <span class="k">RETURN</span>
<a name="ln-4306"></a>
<a name="ln-4307"></a><span class="k">END SUBROUTINE</span>
<a name="ln-4308"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-4309"></a>
<a name="ln-4310"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-4311"></a><span class="k">SUBROUTINE </span><span class="n">SetupPipeCircuitInOutCells</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)</span>
<a name="ln-4312"></a>
<a name="ln-4313"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4314"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-4315"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-4316"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4317"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4318"></a>
<a name="ln-4319"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4320"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-4321"></a>
<a name="ln-4322"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4323"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-4324"></a>
<a name="ln-4325"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4326"></a>          <span class="c">! na</span>
<a name="ln-4327"></a>
<a name="ln-4328"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4329"></a>          <span class="c">! na</span>
<a name="ln-4330"></a>
<a name="ln-4331"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4332"></a>
<a name="ln-4333"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4334"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DomainNum</span>
<a name="ln-4335"></a>
<a name="ln-4336"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4337"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CircuitNum</span>
<a name="ln-4338"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CircuitIndex</span>
<a name="ln-4339"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span>  <span class="n">CircuitInletCellSet</span>
<a name="ln-4340"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">CartesianCell</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CircuitInletCell</span>
<a name="ln-4341"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">CartesianCell</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CircuitOutletCell</span>
<a name="ln-4342"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">CartesianCell</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SegmentInletCell</span>
<a name="ln-4343"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">CartesianCell</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SegmentOutletCell</span>
<a name="ln-4344"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">PipeSegmentInfo</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Segment</span>
<a name="ln-4345"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SegmentCtr</span>
<a name="ln-4346"></a>
<a name="ln-4347"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SegmentInletCellX</span><span class="p">,</span> <span class="n">SegmentInletCellY</span><span class="p">,</span> <span class="n">SegmentInletCellZ</span> <span class="p">,</span><span class="n">SegmentOutletCellX</span><span class="p">,</span> <span class="n">SegmentOutletCellY</span><span class="p">,</span> <span class="n">SegmentOutletCellZ</span>
<a name="ln-4348"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CircuitInletCellX</span><span class="p">,</span> <span class="n">CircuitInletCellY</span><span class="p">,</span> <span class="n">CircuitInletCellZ</span> <span class="p">,</span><span class="n">CircuitOutletCellX</span><span class="p">,</span> <span class="n">CircuitOutletCellY</span><span class="p">,</span> <span class="n">CircuitOutletCellZ</span>
<a name="ln-4349"></a>
<a name="ln-4350"></a>    <span class="k">DO </span><span class="n">CircuitNum</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">CircuitIndeces</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4351"></a>                    <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">CircuitIndeces</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-4352"></a>
<a name="ln-4353"></a>        <span class="n">CircuitIndex</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">CircuitIndeces</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)</span>
<a name="ln-4354"></a>        <span class="n">CircuitInletCellSet</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4355"></a>
<a name="ln-4356"></a>        <span class="k">DO </span><span class="n">SegmentCtr</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitIndex</span><span class="p">)%</span><span class="n">PipeSegmentIndeces</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4357"></a>                        <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitIndex</span><span class="p">)%</span><span class="n">PipeSegmentIndeces</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-4358"></a>
<a name="ln-4359"></a>            <span class="n">Segment</span> <span class="o">=</span> <span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitIndex</span><span class="p">)%</span><span class="n">PipeSegmentIndeces</span><span class="p">(</span><span class="n">SegmentCtr</span><span class="p">))</span>
<a name="ln-4360"></a>            <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">Segment</span><span class="p">%</span><span class="n">FlowDirection</span><span class="p">)</span>
<a name="ln-4361"></a>                <span class="k">CASE</span> <span class="p">(</span><span class="n">SegmentFlow_IncreasingZ</span><span class="p">)</span>
<a name="ln-4362"></a>
<a name="ln-4363"></a>                  <span class="n">SegmentInletCellX</span> <span class="o">=</span> <span class="n">segment</span><span class="p">%</span><span class="n">PipeCellCoordinates</span><span class="p">%</span><span class="n">X</span>
<a name="ln-4364"></a>                  <span class="n">SegmentInletCellY</span> <span class="o">=</span> <span class="n">segment</span><span class="p">%</span><span class="n">PipeCellCoordinates</span><span class="p">%</span><span class="n">Y</span>
<a name="ln-4365"></a>                  <span class="n">SegmentInletCellZ</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4366"></a>
<a name="ln-4367"></a>                  <span class="n">SegmentOutletCellX</span> <span class="o">=</span> <span class="n">segment</span><span class="p">%</span><span class="n">PipeCellCoordinates</span><span class="p">%</span><span class="n">X</span>
<a name="ln-4368"></a>                  <span class="n">SegmentOutletCellY</span> <span class="o">=</span> <span class="n">segment</span><span class="p">%</span><span class="n">PipeCellCoordinates</span><span class="p">%</span><span class="n">Y</span>
<a name="ln-4369"></a>                  <span class="n">SegmentOutletCellZ</span> <span class="o">=</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a name="ln-4370"></a>
<a name="ln-4371"></a>                <span class="k">CASE</span> <span class="p">(</span><span class="n">SegmentFlow_DecreasingZ</span><span class="p">)</span>
<a name="ln-4372"></a>
<a name="ln-4373"></a>                  <span class="n">SegmentInletCellX</span> <span class="o">=</span> <span class="n">segment</span><span class="p">%</span><span class="n">PipeCellCoordinates</span><span class="p">%</span><span class="n">X</span>
<a name="ln-4374"></a>                  <span class="n">SegmentInletCellY</span> <span class="o">=</span> <span class="n">segment</span><span class="p">%</span><span class="n">PipeCellCoordinates</span><span class="p">%</span><span class="n">Y</span>
<a name="ln-4375"></a>                  <span class="n">SegmentInletCellZ</span> <span class="o">=</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a name="ln-4376"></a>
<a name="ln-4377"></a>                  <span class="n">SegmentOutletCellX</span> <span class="o">=</span> <span class="n">segment</span><span class="p">%</span><span class="n">PipeCellCoordinates</span><span class="p">%</span><span class="n">X</span>
<a name="ln-4378"></a>                  <span class="n">SegmentOutletCellY</span> <span class="o">=</span> <span class="n">segment</span><span class="p">%</span><span class="n">PipeCellCoordinates</span><span class="p">%</span><span class="n">Y</span>
<a name="ln-4379"></a>                  <span class="n">SegmentOutletCellZ</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4380"></a>
<a name="ln-4381"></a>            <span class="k">END SELECT</span>
<a name="ln-4382"></a><span class="k">            IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">CircuitInletCellSet</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4383"></a><span class="k">                </span><span class="n">CircuitInletCellX</span> <span class="o">=</span> <span class="n">SegmentInletCellX</span>
<a name="ln-4384"></a>                <span class="n">CircuitInletCellY</span> <span class="o">=</span> <span class="n">SegmentInletCellY</span>
<a name="ln-4385"></a>                <span class="n">CircuitInletCellZ</span> <span class="o">=</span> <span class="n">SegmentInletCellZ</span>
<a name="ln-4386"></a>                <span class="n">CircuitInletCellSet</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4387"></a>            <span class="k">END IF</span>
<a name="ln-4388"></a><span class="k">            </span><span class="n">CircuitOutletCellX</span> <span class="o">=</span> <span class="n">SegmentOutletCellX</span>
<a name="ln-4389"></a>            <span class="n">CircuitOutletCellY</span> <span class="o">=</span> <span class="n">SegmentOutletCellY</span>
<a name="ln-4390"></a>            <span class="n">CircuitOutletCellZ</span> <span class="o">=</span> <span class="n">SegmentOutletCellZ</span>
<a name="ln-4391"></a>
<a name="ln-4392"></a>        <span class="k">END DO</span>
<a name="ln-4393"></a>
<a name="ln-4394"></a><span class="k">        CALL </span><span class="n">PipeCircuitInfo_InitInOutCells</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitIndex</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4395"></a>                                             <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">CircuitInletCellX</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4396"></a>                                                                                  <span class="n">CircuitInletCellY</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4397"></a>                                                                                  <span class="n">CircuitInletCellZ</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4398"></a>                                             <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">CircuitOutletCellX</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4399"></a>                                                                                  <span class="n">CircuitOutletCellY</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4400"></a>                                                                                  <span class="n">CircuitOutletCellZ</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4401"></a>                                            <span class="p">)</span>
<a name="ln-4402"></a>
<a name="ln-4403"></a>    <span class="k">END DO</span>
<a name="ln-4404"></a>
<a name="ln-4405"></a><span class="k">END SUBROUTINE</span>
<a name="ln-4406"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-4407"></a>
<a name="ln-4408"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-4409"></a><span class="kt">INTEGER </span><span class="k">FUNCTION </span><span class="n">GetCellWidthsCount</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">dir</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">RetVal</span><span class="p">)</span>
<a name="ln-4410"></a>
<a name="ln-4411"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-4412"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-4413"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-4414"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4415"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4416"></a>
<a name="ln-4417"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-4418"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-4419"></a>
<a name="ln-4420"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4421"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-4422"></a>
<a name="ln-4423"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4424"></a>          <span class="c">! na</span>
<a name="ln-4425"></a>
<a name="ln-4426"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4427"></a>          <span class="c">! na</span>
<a name="ln-4428"></a>
<a name="ln-4429"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4430"></a>
<a name="ln-4431"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-4432"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DomainNum</span>
<a name="ln-4433"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dir</span> <span class="c">!From Enum: RegionType</span>
<a name="ln-4434"></a>
<a name="ln-4435"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">dir</span><span class="p">)</span>
<a name="ln-4436"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">RegionType_XDirection</span><span class="p">)</span>
<a name="ln-4437"></a>        <span class="n">RetVal</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Mesh</span><span class="p">%</span><span class="n">X</span><span class="p">%</span><span class="n">RegionMeshCount</span>
<a name="ln-4438"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">RegionType_YDirection</span><span class="p">)</span>
<a name="ln-4439"></a>        <span class="n">RetVal</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Mesh</span><span class="p">%</span><span class="n">Y</span><span class="p">%</span><span class="n">RegionMeshCount</span>
<a name="ln-4440"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">RegionType_ZDirection</span><span class="p">)</span>
<a name="ln-4441"></a>        <span class="n">RetVal</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Mesh</span><span class="p">%</span><span class="n">Z</span><span class="p">%</span><span class="n">RegionMeshCount</span>
<a name="ln-4442"></a>    <span class="k">END SELECT</span>
<a name="ln-4443"></a>    <span class="c">!Objexx:Return Check/enforce that one of these CASEs holds to assure return value is set</span>
<a name="ln-4444"></a>
<a name="ln-4445"></a>    <span class="k">RETURN</span>
<a name="ln-4446"></a>
<a name="ln-4447"></a><span class="k">END FUNCTION</span>
<a name="ln-4448"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-4449"></a>
<a name="ln-4450"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-4451"></a><span class="c">!FUNCTION GetCellWidths(DomainNum, g) RESULT(RetVal)</span>
<a name="ln-4452"></a><span class="k">SUBROUTINE </span><span class="n">GetCellWidths</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
<a name="ln-4453"></a>
<a name="ln-4454"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-4455"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-4456"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-4457"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4458"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4459"></a>
<a name="ln-4460"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-4461"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-4462"></a>
<a name="ln-4463"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4464"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-4465"></a>
<a name="ln-4466"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4467"></a>          <span class="c">! na</span>
<a name="ln-4468"></a>
<a name="ln-4469"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4470"></a>          <span class="c">! na</span>
<a name="ln-4471"></a>
<a name="ln-4472"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4473"></a>
<a name="ln-4474"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-4475"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DomainNum</span>
<a name="ln-4476"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">GridRegion</span><span class="p">)</span> <span class="kd">::</span> <span class="n">g</span>
<a name="ln-4477"></a>
<a name="ln-4478"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4479"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">DistributionStructure</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisMesh</span>
<a name="ln-4480"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GridWidth</span>
<a name="ln-4481"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumCellsOnEachSide</span>
<a name="ln-4482"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SummationTerm</span>
<a name="ln-4483"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">I</span>
<a name="ln-4484"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CellWidth</span>
<a name="ln-4485"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SubIndex</span>
<a name="ln-4486"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">RetVal</span>
<a name="ln-4487"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">RetMaxIndex</span>
<a name="ln-4488"></a><span class="c">!write(outputfiledebug,*) &#39; regiontype=&#39;,g%RegionType</span>
<a name="ln-4489"></a>    <span class="c">!&#39;determine which mesh &quot;direction&quot; we are going to be using</span>
<a name="ln-4490"></a>
<a name="ln-4491"></a>    <span class="n">ThisMesh</span><span class="p">%</span><span class="n">MeshDistribution</span> <span class="o">=</span><span class="mi">0</span> <span class="c">!From Enum: MeshDistribution</span>
<a name="ln-4492"></a>    <span class="n">ThisMesh</span><span class="p">%</span><span class="n">RegionMeshCount</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4493"></a>    <span class="n">ThisMesh</span><span class="p">%</span><span class="n">GeometricSeriesCoefficient</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4494"></a>
<a name="ln-4495"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">g</span><span class="p">%</span><span class="n">RegionType</span><span class="p">)</span>
<a name="ln-4496"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">RegionType_XDirection</span><span class="p">)</span>
<a name="ln-4497"></a>        <span class="n">ThisMesh</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Mesh</span><span class="p">%</span><span class="n">X</span>
<a name="ln-4498"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">RegionType_YDirection</span><span class="p">)</span>
<a name="ln-4499"></a>        <span class="n">ThisMesh</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Mesh</span><span class="p">%</span><span class="n">Y</span>
<a name="ln-4500"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">RegionType_ZDirection</span><span class="p">)</span>
<a name="ln-4501"></a>        <span class="n">ThisMesh</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Mesh</span><span class="p">%</span><span class="n">Z</span>
<a name="ln-4502"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-4503"></a>        <span class="c">!Error</span>
<a name="ln-4504"></a>    <span class="k">END SELECT</span>
<a name="ln-4505"></a>
<a name="ln-4506"></a><span class="c">!write(outputfiledebug,*) &#39;thismesh%regionmeshcount=&#39;,ThisMesh%RegionMeshCount</span>
<a name="ln-4507"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ThisMesh</span><span class="p">%</span><span class="n">RegionMeshCount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4508"></a><span class="k">      ALLOCATE</span><span class="p">(</span><span class="n">RetVal</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">ThisMesh</span><span class="p">%</span><span class="n">RegionMeshCount</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-4509"></a>      <span class="n">RetMaxIndex</span><span class="o">=</span><span class="n">ThisMesh</span><span class="p">%</span><span class="n">RegionMeshCount</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-4510"></a>    <span class="k">ELSE</span>
<a name="ln-4511"></a><span class="k">      ALLOCATE</span><span class="p">(</span><span class="n">RetVal</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">))</span>
<a name="ln-4512"></a>      <span class="n">RetMaxIndex</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4513"></a>    <span class="n">ENDIF</span>
<a name="ln-4514"></a>
<a name="ln-4515"></a>    <span class="n">GridWidth</span> <span class="o">=</span> <span class="n">g</span><span class="p">%</span><span class="nb">Max</span> <span class="o">-</span> <span class="n">g</span><span class="p">%</span><span class="nb">Min</span>
<a name="ln-4516"></a>
<a name="ln-4517"></a><span class="nb">    </span><span class="k">IF</span> <span class="p">(</span><span class="n">ThisMesh</span><span class="p">%</span><span class="n">MeshDistribution</span> <span class="o">==</span> <span class="n">MeshDistribution_Uniform</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4518"></a>
<a name="ln-4519"></a>        <span class="c">!we have it quite simple</span>
<a name="ln-4520"></a>
<a name="ln-4521"></a>        <span class="n">CellWidth</span> <span class="o">=</span> <span class="n">GridWidth</span> <span class="o">/</span> <span class="n">ThisMesh</span><span class="p">%</span><span class="n">RegionMeshCount</span>
<a name="ln-4522"></a>
<a name="ln-4523"></a>        <span class="k">DO </span><span class="n">I</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ThisMesh</span><span class="p">%</span><span class="n">RegionMeshCount</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-4524"></a>            <span class="n">RetVal</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">CellWidth</span>
<a name="ln-4525"></a>        <span class="k">END DO</span>
<a name="ln-4526"></a>
<a name="ln-4527"></a><span class="k">    </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">ThisMesh</span><span class="p">%</span><span class="n">MeshDistribution</span> <span class="o">==</span> <span class="n">MeshDistribution_SymmetricGeometric</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4528"></a>
<a name="ln-4529"></a>        <span class="c">!&#39;then apply this &quot;direction&quot;&#39;s conditions to generate a cell width array</span>
<a name="ln-4530"></a>        <span class="c">!&#39;first get the total number of cells on this half of the region</span>
<a name="ln-4531"></a>        <span class="n">NumCellsOnEachSide</span> <span class="o">=</span> <span class="n">ThisMesh</span><span class="p">%</span><span class="n">RegionMeshCount</span> <span class="o">/</span> <span class="mi">2</span>  <span class="c">!Already validated to be an even #</span>
<a name="ln-4532"></a>
<a name="ln-4533"></a>        <span class="c">!&#39;calculate geometric series</span>
<a name="ln-4534"></a>        <span class="n">SummationTerm</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4535"></a>        <span class="k">DO </span><span class="n">I</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumCellsOnEachSide</span>
<a name="ln-4536"></a>            <span class="n">SummationTerm</span> <span class="o">=</span> <span class="n">SummationTerm</span> <span class="o">+</span> <span class="n">ThisMesh</span><span class="p">%</span><span class="n">GeometricSeriesCoefficient</span> <span class="o">**</span> <span class="p">(</span><span class="n">I</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-4537"></a>        <span class="k">END DO</span>
<a name="ln-4538"></a>
<a name="ln-4539"></a>        <span class="c">!&#39;set up a list of cell widths for this region</span>
<a name="ln-4540"></a>        <span class="n">CellWidth</span> <span class="o">=</span> <span class="p">(</span><span class="n">GridWidth</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">SummationTerm</span>
<a name="ln-4541"></a>        <span class="n">RetVal</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">CellWidth</span>
<a name="ln-4542"></a>        <span class="k">DO </span><span class="n">I</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumCellsOnEachSide</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-4543"></a>            <span class="n">CellWidth</span> <span class="o">=</span> <span class="n">CellWidth</span> <span class="o">*</span> <span class="n">ThisMesh</span><span class="p">%</span><span class="n">GeometricSeriesCoefficient</span>
<a name="ln-4544"></a>            <span class="n">RetVal</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">CellWidth</span>
<a name="ln-4545"></a>        <span class="k">END DO</span>
<a name="ln-4546"></a><span class="k">        </span><span class="n">SubIndex</span> <span class="o">=</span> <span class="n">NumCellsOnEachSide</span>
<a name="ln-4547"></a>        <span class="k">DO </span><span class="n">I</span> <span class="o">=</span> <span class="n">NumCellsOnEachSide</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-4548"></a>            <span class="n">SubIndex</span> <span class="o">=</span> <span class="n">SubIndex</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-4549"></a>            <span class="n">RetVal</span><span class="p">(</span><span class="n">SubIndex</span><span class="p">)</span> <span class="o">=</span> <span class="n">RetVal</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<a name="ln-4550"></a>        <span class="k">END DO</span>
<a name="ln-4551"></a>
<a name="ln-4552"></a><span class="k">    END IF</span>
<a name="ln-4553"></a>
<a name="ln-4554"></a><span class="k">    </span><span class="n">g</span><span class="p">%</span><span class="n">CellWidths</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">RetMaxIndex</span><span class="p">)</span><span class="o">=</span><span class="n">RetVal</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">RetMaxIndex</span><span class="p">)</span>
<a name="ln-4555"></a>    <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">RetVal</span><span class="p">)</span>
<a name="ln-4556"></a><span class="c">!END FUNCTION</span>
<a name="ln-4557"></a><span class="k">END SUBROUTINE</span>
<a name="ln-4558"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-4559"></a>
<a name="ln-4560"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-4561"></a><span class="k">SUBROUTINE </span><span class="n">PerformIterationLoop</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">CircuitNum</span><span class="p">)</span>
<a name="ln-4562"></a>
<a name="ln-4563"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4564"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-4565"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-4566"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4567"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4568"></a>
<a name="ln-4569"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4570"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-4571"></a>
<a name="ln-4572"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4573"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-4574"></a>
<a name="ln-4575"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4576"></a>          <span class="c">! na</span>
<a name="ln-4577"></a>
<a name="ln-4578"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4579"></a>          <span class="c">! na</span>
<a name="ln-4580"></a>
<a name="ln-4581"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4582"></a>
<a name="ln-4583"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4584"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DomainNum</span>
<a name="ln-4585"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CircuitNum</span>
<a name="ln-4586"></a>
<a name="ln-4587"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4588"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IterationIndex</span>
<a name="ln-4589"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">FinishedIterationLoop</span>
<a name="ln-4590"></a>
<a name="ln-4591"></a>    <span class="c">! Always do start of time step inits</span>
<a name="ln-4592"></a>    <span class="k">CALL </span><span class="n">DoStartOfTimeStepInitializations</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">CircuitNum</span><span class="p">)</span>
<a name="ln-4593"></a>
<a name="ln-4594"></a>    <span class="c">! Prepare the pipe circuit for calculations, but we&#39;ll actually do calcs at the iteration level</span>
<a name="ln-4595"></a>    <span class="k">CALL </span><span class="n">PreparePipeCircuitSimulation</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">CircuitNum</span><span class="p">)</span>
<a name="ln-4596"></a>
<a name="ln-4597"></a>    <span class="c">! Begin iterating for this time step</span>
<a name="ln-4598"></a>    <span class="k">DO </span><span class="n">IterationIndex</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">SimControls</span><span class="p">%</span><span class="n">MaxIterationsPerTS</span>
<a name="ln-4599"></a>
<a name="ln-4600"></a>        <span class="k">CALL </span><span class="n">ShiftTemperaturesForNewIteration</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)</span>
<a name="ln-4601"></a>
<a name="ln-4602"></a>        <span class="k">CALL </span><span class="n">PerformPipeCircuitSimulation</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">CircuitNum</span><span class="p">)</span>
<a name="ln-4603"></a>
<a name="ln-4604"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">DomainNeedsSimulation</span><span class="p">)</span> <span class="k">CALL </span><span class="n">PerformTemperatureFieldUpdate</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)</span>
<a name="ln-4605"></a>
<a name="ln-4606"></a>        <span class="n">FinishedIterationLoop</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4607"></a>        <span class="k">CALL </span><span class="n">DoEndOfIterationOperations</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">FinishedIterationLoop</span><span class="p">)</span>
<a name="ln-4608"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">FinishedIterationLoop</span><span class="p">)</span> <span class="k">EXIT</span>
<a name="ln-4609"></a>
<a name="ln-4610"></a><span class="k">    END DO</span>
<a name="ln-4611"></a>
<a name="ln-4612"></a>    <span class="c">! Update the basement surface temperatures, if any</span>
<a name="ln-4613"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">HasBasement</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4614"></a><span class="k">        CALL </span><span class="n">UpdateBasementSurfaceTemperatures</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)</span>
<a name="ln-4615"></a>    <span class="k">END IF</span>
<a name="ln-4616"></a>
<a name="ln-4617"></a><span class="k">    RETURN</span>
<a name="ln-4618"></a>
<a name="ln-4619"></a><span class="k">END SUBROUTINE</span>
<a name="ln-4620"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-4621"></a>
<a name="ln-4622"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-4623"></a><span class="k">SUBROUTINE </span><span class="n">PerformTemperatureFieldUpdate</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)</span>
<a name="ln-4624"></a>
<a name="ln-4625"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4626"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-4627"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-4628"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4629"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4630"></a>
<a name="ln-4631"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4632"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-4633"></a>
<a name="ln-4634"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4635"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-4636"></a>
<a name="ln-4637"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4638"></a>          <span class="c">! na</span>
<a name="ln-4639"></a>
<a name="ln-4640"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4641"></a>          <span class="c">! na</span>
<a name="ln-4642"></a>
<a name="ln-4643"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4644"></a>
<a name="ln-4645"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4646"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DomainNum</span>
<a name="ln-4647"></a>
<a name="ln-4648"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4649"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span>
<a name="ln-4650"></a>
<a name="ln-4651"></a>    <span class="k">DO </span><span class="n">Z</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a name="ln-4652"></a>        <span class="k">DO </span><span class="n">Y</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<a name="ln-4653"></a>            <span class="k">DO </span><span class="n">X</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-4654"></a>
<a name="ln-4655"></a>                <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)%</span><span class="n">CellType</span><span class="p">)</span>
<a name="ln-4656"></a>                <span class="k">CASE</span> <span class="p">(</span><span class="n">CellType_Pipe</span><span class="p">)</span>
<a name="ln-4657"></a>                    <span class="c">!&#39;pipes are simulated separately</span>
<a name="ln-4658"></a>                <span class="k">CASE</span> <span class="p">(</span><span class="n">CellType_GeneralField</span><span class="p">)</span>
<a name="ln-4659"></a>                    <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4660"></a>                                <span class="n">EvaluateFieldCellTemperature</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">))</span>
<a name="ln-4661"></a>                <span class="k">CASE</span> <span class="p">(</span><span class="n">CellType_GroundSurface</span><span class="p">)</span>
<a name="ln-4662"></a>                    <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4663"></a>                                <span class="n">EvaluateGroundSurfaceTemperature</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">))</span>
<a name="ln-4664"></a>                <span class="k">CASE</span> <span class="p">(</span><span class="n">CellType_FarfieldBoundary</span><span class="p">)</span>
<a name="ln-4665"></a>                    <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4666"></a>                                <span class="n">EvaluateFarfieldBoundaryTemperature</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">))</span>
<a name="ln-4667"></a>                <span class="k">CASE</span> <span class="p">(</span><span class="n">CellType_BasementWall</span><span class="p">,</span> <span class="n">CellType_BasementCorner</span><span class="p">,</span> <span class="n">CellType_BasementFloor</span><span class="p">)</span>
<a name="ln-4668"></a>                    <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4669"></a>                                <span class="n">EvaluateBasementCellTemperature</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">))</span>
<a name="ln-4670"></a>                <span class="k">CASE</span> <span class="p">(</span><span class="n">CellType_AdiabaticWall</span><span class="p">)</span>
<a name="ln-4671"></a>                    <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4672"></a>                                <span class="n">EvaluateAdiabaticSurfaceTemperature</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">))</span>
<a name="ln-4673"></a>                <span class="k">END SELECT</span>
<a name="ln-4674"></a>
<a name="ln-4675"></a><span class="k">            END DO</span>
<a name="ln-4676"></a><span class="k">        END DO</span>
<a name="ln-4677"></a><span class="k">    END DO</span>
<a name="ln-4678"></a>
<a name="ln-4679"></a><span class="k">END SUBROUTINE</span>
<a name="ln-4680"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-4681"></a>
<a name="ln-4682"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-4683"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">EvaluateFieldCellTemperature</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">ThisCell</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">RetVal</span><span class="p">)</span>
<a name="ln-4684"></a>
<a name="ln-4685"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-4686"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-4687"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-4688"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4689"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4690"></a>
<a name="ln-4691"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-4692"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-4693"></a>
<a name="ln-4694"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4695"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-4696"></a>
<a name="ln-4697"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4698"></a>          <span class="c">! na</span>
<a name="ln-4699"></a>
<a name="ln-4700"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4701"></a>          <span class="c">! na</span>
<a name="ln-4702"></a>
<a name="ln-4703"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4704"></a>
<a name="ln-4705"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-4706"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DomainNum</span>
<a name="ln-4707"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">CartesianCell</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisCell</span>
<a name="ln-4708"></a>
<a name="ln-4709"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4710"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Numerator</span>
<a name="ln-4711"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Denominator</span>
<a name="ln-4712"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Beta</span>
<a name="ln-4713"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NeighborTemp</span>
<a name="ln-4714"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Resistance</span>
<a name="ln-4715"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DirectionCounter</span>
<a name="ln-4716"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CurDirection</span> <span class="c">!From Enum: Direction</span>
<a name="ln-4717"></a>
<a name="ln-4718"></a>    <span class="c">!Set up once-per-cell items</span>
<a name="ln-4719"></a>    <span class="n">Numerator</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4720"></a>    <span class="n">Denominator</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4721"></a>    <span class="n">Beta</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Beta</span>
<a name="ln-4722"></a>
<a name="ln-4723"></a>    <span class="c">!add effect from cell history</span>
<a name="ln-4724"></a>    <span class="n">Numerator</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">+</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature_PrevTimeStep</span>
<a name="ln-4725"></a>    <span class="n">Denominator</span> <span class="o">=</span> <span class="n">Denominator</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-4726"></a>
<a name="ln-4727"></a>    <span class="c">!determine the neighbor types based on cell location</span>
<a name="ln-4728"></a>    <span class="k">CALL </span><span class="n">EvaluateCellNeighborDirections</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">ThisCell</span><span class="p">)</span>
<a name="ln-4729"></a>
<a name="ln-4730"></a>    <span class="c">!loop across each direction in the simulation</span>
<a name="ln-4731"></a>    <span class="k">DO </span><span class="n">DirectionCounter</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">NeighborFieldCells</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">NeighborFieldCells</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4732"></a>
<a name="ln-4733"></a>        <span class="n">CurDirection</span> <span class="o">=</span> <span class="n">NeighborFieldCells</span><span class="p">(</span><span class="n">DirectionCounter</span><span class="p">)</span>
<a name="ln-4734"></a>
<a name="ln-4735"></a>        <span class="c">!&#39;evaluate the transient expression terms</span>
<a name="ln-4736"></a>        <span class="k">CALL </span><span class="n">EvaluateNeighborCharacteristics</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">ThisCell</span><span class="p">,</span> <span class="n">CurDirection</span><span class="p">,</span> <span class="n">NeighborTemp</span><span class="p">,</span> <span class="n">Resistance</span><span class="p">)</span>
<a name="ln-4737"></a>        <span class="n">Numerator</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span><span class="p">)</span> <span class="o">*</span> <span class="n">NeighborTemp</span>
<a name="ln-4738"></a>        <span class="n">Denominator</span> <span class="o">=</span> <span class="n">Denominator</span> <span class="o">+</span> <span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span>
<a name="ln-4739"></a>
<a name="ln-4740"></a>    <span class="k">END DO</span>
<a name="ln-4741"></a>
<a name="ln-4742"></a>    <span class="c">!&#39;now that we have passed all directions, update the temperature</span>
<a name="ln-4743"></a>    <span class="n">RetVal</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">/</span> <span class="n">Denominator</span>
<a name="ln-4744"></a>
<a name="ln-4745"></a><span class="k">END FUNCTION</span>
<a name="ln-4746"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-4747"></a>
<a name="ln-4748"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-4749"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">EvaluateGroundSurfaceTemperature</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">cell</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">RetVal</span><span class="p">)</span>
<a name="ln-4750"></a>
<a name="ln-4751"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-4752"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-4753"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-4754"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4755"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4756"></a>
<a name="ln-4757"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-4758"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-4759"></a>
<a name="ln-4760"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4761"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-4762"></a>
<a name="ln-4763"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4764"></a>          <span class="c">! na</span>
<a name="ln-4765"></a>
<a name="ln-4766"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4767"></a>    <span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">Latitude</span><span class="p">,</span> <span class="n">Longitude</span><span class="p">,</span> <span class="n">Elevation</span><span class="p">,</span> <span class="n">TimeZoneMeridian</span><span class="p">,</span> <span class="n">WindSpeed</span>
<a name="ln-4768"></a>    <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SecsInDay</span><span class="p">,</span> <span class="n">SecInHour</span>
<a name="ln-4769"></a>
<a name="ln-4770"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4771"></a>
<a name="ln-4772"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-4773"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DomainNum</span>
<a name="ln-4774"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">CartesianCell</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cell</span>
<a name="ln-4775"></a>
<a name="ln-4776"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-4777"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">AirDensity</span> <span class="o">=</span> <span class="mf">1.22521d0</span> <span class="c">!&#39;[kg/m3]</span>
<a name="ln-4778"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">AirSpecificHeat</span> <span class="o">=</span> <span class="mi">1003</span><span class="n">d0</span> <span class="c">!&#39;[J/kg-K]</span>
<a name="ln-4779"></a>    <span class="c">!evapotranspiration parameters</span>
<a name="ln-4780"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">MeanSolarConstant</span> <span class="o">=</span> <span class="mf">0.08196d0</span>  <span class="c">! 1367 [W/m2], entered in [MJ/m2-minute]</span>
<a name="ln-4781"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">A_s</span>  <span class="o">=</span> <span class="mf">0.25d0</span> <span class="c">!?</span>
<a name="ln-4782"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">B_s</span>  <span class="o">=</span> <span class="mf">0.5d0</span>  <span class="c">!?</span>
<a name="ln-4783"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Absor_Corrected</span> <span class="o">=</span> <span class="mf">0.77d0</span>
<a name="ln-4784"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Convert_Wm2_To_MJhrmin</span> <span class="o">=</span> <span class="mi">360</span><span class="mf">0.0d0</span> <span class="o">/</span> <span class="mi">100000</span><span class="mf">0.0d0</span>
<a name="ln-4785"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Convert_MJhrmin_To_Wm2</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="o">/</span> <span class="n">Convert_Wm2_To_MJhrmin</span>
<a name="ln-4786"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Rho_water</span> <span class="o">=</span> <span class="mi">99</span><span class="mf">8.0d0</span>  <span class="c">![kg/m3]</span>
<a name="ln-4787"></a>
<a name="ln-4788"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-4789"></a>          <span class="c">! na</span>
<a name="ln-4790"></a>
<a name="ln-4791"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-4792"></a>          <span class="c">! na</span>
<a name="ln-4793"></a>
<a name="ln-4794"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4795"></a>    <span class="c">!declare some variables</span>
<a name="ln-4796"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Numerator</span>
<a name="ln-4797"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Denominator</span>
<a name="ln-4798"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Resistance</span>
<a name="ln-4799"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NeighborTemp</span>
<a name="ln-4800"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisNormalArea</span>
<a name="ln-4801"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IncidentHeatGain</span>
<a name="ln-4802"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DirectionCounter</span>
<a name="ln-4803"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CurDirection</span>
<a name="ln-4804"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AdiabaticMultiplier</span>
<a name="ln-4805"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Beta</span>
<a name="ln-4806"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Latitude_Degrees</span>   <span class="c">!Latitude, degrees N</span>
<a name="ln-4807"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">StMeridian_Degrees</span> <span class="c">!Standard meridian, degrees W -- note it is degrees E in DataEnvironment</span>
<a name="ln-4808"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Longitude_Degrees</span>  <span class="c">!Longitude, degrees W -- note it is degrees E in DataEnvironment</span>
<a name="ln-4809"></a>    <span class="c">!evapotranspiration calculated values</span>
<a name="ln-4810"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Latitude_Radians</span>
<a name="ln-4811"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DayOfYear</span>
<a name="ln-4812"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HourOfDay</span>
<a name="ln-4813"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CurSecondsIntoToday</span>
<a name="ln-4814"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dr</span>
<a name="ln-4815"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Declination</span>
<a name="ln-4816"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">b_sc</span>
<a name="ln-4817"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Sc</span>
<a name="ln-4818"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Hour_Angle</span>
<a name="ln-4819"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">X_sunset</span>
<a name="ln-4820"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Sunset_Angle</span>
<a name="ln-4821"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Altitude_Angle</span>
<a name="ln-4822"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Solar_Angle_1</span>
<a name="ln-4823"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Solar_Angle_2</span>
<a name="ln-4824"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QRAD_A</span>
<a name="ln-4825"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QRAD_SO</span>
<a name="ln-4826"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Ratio_SO</span>
<a name="ln-4827"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IncidentSolar_MJhrmin</span>
<a name="ln-4828"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AbsorbedIncidentSolar_MJhrmin</span>
<a name="ln-4829"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">VaporPressureSaturated_kPa</span>
<a name="ln-4830"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">VaporPressureActual_kPa</span>
<a name="ln-4831"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QRAD_NL</span>
<a name="ln-4832"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NetIncidentRadiation_MJhr</span> <span class="c">![MJ/hr]</span>
<a name="ln-4833"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NetIncidentRadiation_Wm2</span> <span class="c">![W/m2]</span>
<a name="ln-4834"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CN</span>
<a name="ln-4835"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">G_hr</span>
<a name="ln-4836"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Cd</span>
<a name="ln-4837"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Slope_S</span>
<a name="ln-4838"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Pressure</span>
<a name="ln-4839"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PsychrometricConstant</span>
<a name="ln-4840"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapotransFluidLoss_mmhr</span>
<a name="ln-4841"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapotransFluidLoss_mhr</span>
<a name="ln-4842"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LatentHeatVaporization</span>
<a name="ln-4843"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapotransHeatLoss_MJhrmin</span>  <span class="c">![MJ/m2-hr]</span>
<a name="ln-4844"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapotransHeatLoss_Wm2</span>       <span class="c">![W/m2]</span>
<a name="ln-4845"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CurAirTempK</span>
<a name="ln-4846"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MyLatitude</span>
<a name="ln-4847"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MyLongitude</span>
<a name="ln-4848"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MyTimeZoneMeridian</span>
<a name="ln-4849"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MyElevation</span>
<a name="ln-4850"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GroundCoverCoefficient</span>
<a name="ln-4851"></a>
<a name="ln-4852"></a>    <span class="c">!retrieve information from E+ globals</span>
<a name="ln-4853"></a>    <span class="n">Latitude_Degrees</span>   <span class="o">=</span> <span class="n">Latitude</span>
<a name="ln-4854"></a>    <span class="n">StMeridian_Degrees</span> <span class="o">=</span> <span class="o">-</span><span class="n">TimeZoneMeridian</span>  <span class="c">!Standard meridian, degrees W</span>
<a name="ln-4855"></a>    <span class="n">Longitude_Degrees</span>  <span class="o">=</span> <span class="o">-</span><span class="n">Longitude</span>         <span class="c">!Longitude, degrees W</span>
<a name="ln-4856"></a>
<a name="ln-4857"></a>    <span class="c">!retrieve any information from input data structure</span>
<a name="ln-4858"></a>    <span class="n">GroundCoverCoefficient</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Moisture</span><span class="p">%</span><span class="n">GroundCoverCoefficient</span>
<a name="ln-4859"></a>
<a name="ln-4860"></a>    <span class="c">!initialize values</span>
<a name="ln-4861"></a>    <span class="n">Numerator</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4862"></a>    <span class="n">Denominator</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4863"></a>    <span class="n">Resistance</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4864"></a>    <span class="n">Beta</span> <span class="o">=</span> <span class="n">cell</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Beta</span>
<a name="ln-4865"></a>    <span class="n">ThisNormalArea</span> <span class="o">=</span> <span class="n">NormalArea</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">Direction_PositiveY</span><span class="p">)</span>
<a name="ln-4866"></a>
<a name="ln-4867"></a>    <span class="c">!&#39;add effect from previous time step</span>
<a name="ln-4868"></a>    <span class="n">Numerator</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">+</span> <span class="n">cell</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature_PrevTimeStep</span>
<a name="ln-4869"></a>    <span class="n">Denominator</span> <span class="o">=</span> <span class="n">Denominator</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-4870"></a>
<a name="ln-4871"></a>    <span class="c">!now that we aren&#39;t infinitesimal, we need to determine the neighbor types based on cell location</span>
<a name="ln-4872"></a>    <span class="k">CALL </span><span class="n">EvaluateCellNeighborDirections</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">cell</span><span class="p">)</span>
<a name="ln-4873"></a>
<a name="ln-4874"></a>    <span class="c">!loop over all regular neighbor cells, check if we have adiabatic on opposite surface</span>
<a name="ln-4875"></a>    <span class="k">DO </span><span class="n">DirectionCounter</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">NeighborFieldCells</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">NeighborFieldCells</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4876"></a>        <span class="n">CurDirection</span> <span class="o">=</span> <span class="n">NeighborFieldCells</span><span class="p">(</span><span class="n">DirectionCounter</span><span class="p">)</span>
<a name="ln-4877"></a>
<a name="ln-4878"></a>        <span class="c">!We have adiabatic z-faces, check if we are adjacent to one in the opposite direction</span>
<a name="ln-4879"></a>        <span class="k">IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">CurDirection</span><span class="o">==</span><span class="n">Direction_NegativeZ</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">cell</span><span class="p">%</span><span class="n">Z_index</span><span class="o">==</span><span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4880"></a><span class="k">            </span><span class="n">AdiabaticMultiplier</span> <span class="o">=</span> <span class="mf">2.0d0</span>
<a name="ln-4881"></a>        <span class="k">ELSE IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">CurDirection</span><span class="o">==</span><span class="n">Direction_PositiveZ</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">cell</span><span class="p">%</span><span class="n">Z_index</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4882"></a><span class="k">            </span><span class="n">AdiabaticMultiplier</span> <span class="o">=</span> <span class="mf">2.0d0</span>
<a name="ln-4883"></a>        <span class="k">ELSE</span>
<a name="ln-4884"></a><span class="k">            </span><span class="n">AdiabaticMultiplier</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4885"></a>        <span class="k">END IF</span>
<a name="ln-4886"></a>
<a name="ln-4887"></a>        <span class="c">!Use the multiplier (either 1 or 2) to calculate the neighbor cell effects</span>
<a name="ln-4888"></a>        <span class="k">CALL </span><span class="n">EvaluateNeighborCharacteristics</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">CurDirection</span><span class="p">,</span> <span class="n">NeighborTemp</span><span class="p">,</span> <span class="n">Resistance</span><span class="p">)</span>
<a name="ln-4889"></a>        <span class="n">Numerator</span> <span class="o">=</span> <span class="n">AdiabaticMultiplier</span> <span class="o">*</span> <span class="n">Numerator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span><span class="p">)</span> <span class="o">*</span> <span class="n">NeighborTemp</span>
<a name="ln-4890"></a>        <span class="n">Denominator</span> <span class="o">=</span> <span class="n">AdiabaticMultiplier</span> <span class="o">*</span> <span class="n">Denominator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span><span class="p">)</span>
<a name="ln-4891"></a>
<a name="ln-4892"></a>    <span class="k">END DO</span>
<a name="ln-4893"></a>
<a name="ln-4894"></a>    <span class="c">!do all non-adiabatic boundary types here</span>
<a name="ln-4895"></a>    <span class="k">DO </span><span class="n">DirectionCounter</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">NeighborBoundaryCells</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">NeighborBoundaryCells</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4896"></a>        <span class="n">CurDirection</span> <span class="o">=</span> <span class="n">NeighborBoundaryCells</span><span class="p">(</span><span class="n">DirectionCounter</span><span class="p">)</span>
<a name="ln-4897"></a>
<a name="ln-4898"></a>        <span class="c">!x-direction will always be a farfield boundary</span>
<a name="ln-4899"></a>        <span class="c">!z-direction will be handled above -- adiabatic</span>
<a name="ln-4900"></a>        <span class="c">!-y we don&#39;t handle here because -y will always be a neighbor cell, so handled above</span>
<a name="ln-4901"></a>        <span class="c">!+y will always be the outdoor air</span>
<a name="ln-4902"></a>        <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">CurDirection</span><span class="p">)</span>
<a name="ln-4903"></a>            <span class="k">CASE</span> <span class="p">(</span><span class="n">Direction_PositiveX</span><span class="p">,</span> <span class="n">Direction_NegativeX</span><span class="p">)</span>
<a name="ln-4904"></a>                <span class="c">! always farfield</span>
<a name="ln-4905"></a>                <span class="k">CALL </span><span class="n">EvaluateFarfieldCharacteristics</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">CurDirection</span><span class="p">,</span> <span class="n">NeighborTemp</span><span class="p">,</span> <span class="n">Resistance</span><span class="p">)</span>
<a name="ln-4906"></a>                <span class="n">Numerator</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span><span class="p">)</span> <span class="o">*</span> <span class="n">NeighborTemp</span>
<a name="ln-4907"></a>                <span class="n">Denominator</span> <span class="o">=</span> <span class="n">Denominator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span><span class="p">)</span>
<a name="ln-4908"></a>            <span class="k">CASE</span> <span class="p">(</span><span class="n">Direction_PositiveZ</span><span class="p">,</span> <span class="n">Direction_NegativeZ</span><span class="p">)</span>
<a name="ln-4909"></a>                <span class="c">! debug error, can&#39;t get here</span>
<a name="ln-4910"></a>            <span class="k">CASE</span> <span class="p">(</span><span class="n">Direction_PositiveY</span><span class="p">)</span>
<a name="ln-4911"></a>                <span class="c">! convection at the surface</span>
<a name="ln-4912"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">WindSpeed</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.1d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4913"></a><span class="k">                    </span><span class="n">Resistance</span> <span class="o">=</span> <span class="mi">20</span><span class="mf">8.0d0</span> <span class="o">/</span> <span class="p">(</span><span class="n">AirDensity</span> <span class="o">*</span> <span class="n">AirSpecificHeat</span> <span class="o">*</span> <span class="n">WindSpeed</span> <span class="o">*</span> <span class="n">ThisNormalArea</span><span class="p">)</span>
<a name="ln-4914"></a>                    <span class="n">Numerator</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span><span class="p">)</span> <span class="o">*</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cur</span><span class="p">%</span><span class="n">CurAirTemp</span>
<a name="ln-4915"></a>                    <span class="n">Denominator</span> <span class="o">=</span> <span class="n">Denominator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span><span class="p">)</span>
<a name="ln-4916"></a>                <span class="k">ELSE</span>
<a name="ln-4917"></a>                    <span class="c">!Future development should include additional natural convection effects here</span>
<a name="ln-4918"></a>                <span class="k">END IF</span>
<a name="ln-4919"></a><span class="k">            CASE</span> <span class="p">(</span><span class="n">Direction_NegativeY</span><span class="p">)</span>
<a name="ln-4920"></a>                <span class="c">!debug error, can&#39;t get here!</span>
<a name="ln-4921"></a>        <span class="k">END SELECT</span>
<a name="ln-4922"></a>
<a name="ln-4923"></a>
<a name="ln-4924"></a><span class="k">    END DO</span>
<a name="ln-4925"></a>
<a name="ln-4926"></a>    <span class="c">! Initialize, this variable is used for both evapotranspiration and non-ET cases, [W]</span>
<a name="ln-4927"></a>    <span class="n">IncidentHeatGain</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4928"></a>
<a name="ln-4929"></a>    <span class="c">! Latitude, converted to radians...positive for northern hemisphere, [radians]</span>
<a name="ln-4930"></a>    <span class="n">Latitude_Radians</span> <span class="o">=</span> <span class="n">Pi</span> <span class="o">/</span> <span class="mi">18</span><span class="mf">0.0d0</span> <span class="o">*</span> <span class="n">Latitude_Degrees</span>
<a name="ln-4931"></a>
<a name="ln-4932"></a>    <span class="c">! The day of year at this point in the simulation</span>
<a name="ln-4933"></a>    <span class="n">DayOfYear</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cur</span><span class="p">%</span><span class="n">CurSimTimeSeconds</span> <span class="o">/</span> <span class="n">SecsInDay</span> <span class="p">)</span>
<a name="ln-4934"></a>
<a name="ln-4935"></a>    <span class="c">! The number of seconds into the current day</span>
<a name="ln-4936"></a>    <span class="n">CurSecondsIntoToday</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span> <span class="nb">MOD</span><span class="p">(</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cur</span><span class="p">%</span><span class="n">CurSimTimeSeconds</span><span class="p">,</span> <span class="n">SecsInDay</span> <span class="p">)</span> <span class="p">)</span>
<a name="ln-4937"></a>
<a name="ln-4938"></a>    <span class="c">! The number of hours into today</span>
<a name="ln-4939"></a>    <span class="n">HourOfDay</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span> <span class="n">CurSecondsIntoToday</span> <span class="o">/</span> <span class="n">SecInHour</span> <span class="p">)</span>
<a name="ln-4940"></a>
<a name="ln-4941"></a>    <span class="c">! For convenience convert to Kelvin once</span>
<a name="ln-4942"></a>    <span class="n">CurAirTempK</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cur</span><span class="p">%</span><span class="n">CurAirTemp</span> <span class="o">+</span> <span class="mi">27</span><span class="mf">3.15d0</span>
<a name="ln-4943"></a>
<a name="ln-4944"></a>    <span class="c">! Calculate some angles</span>
<a name="ln-4945"></a>    <span class="n">dr</span>   <span class="o">=</span> <span class="mf">1.0d0</span> <span class="o">+</span> <span class="mf">0.033d0</span> <span class="o">*</span> <span class="nb">COS</span><span class="p">(</span><span class="mf">2.0d0</span> <span class="o">*</span> <span class="n">Pi</span> <span class="o">*</span> <span class="n">DayOfYear</span> <span class="o">/</span> <span class="mi">36</span><span class="mf">5.0d0</span><span class="p">)</span>
<a name="ln-4946"></a>    <span class="n">Declination</span> <span class="o">=</span> <span class="mf">0.409d0</span> <span class="o">*</span> <span class="nb">SIN</span><span class="p">(</span><span class="mf">2.0d0</span> <span class="o">*</span> <span class="n">Pi</span> <span class="o">/</span> <span class="mi">36</span><span class="mf">5.0d0</span> <span class="o">*</span> <span class="n">DayOfYear</span> <span class="o">-</span> <span class="mf">1.39d0</span><span class="p">)</span>
<a name="ln-4947"></a>    <span class="n">b_SC</span> <span class="o">=</span> <span class="mf">2.0d0</span> <span class="o">*</span> <span class="n">Pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">DayOfYear</span> <span class="o">-</span> <span class="mi">8</span><span class="mf">1.0d0</span><span class="p">)</span><span class="o">/</span><span class="mi">36</span><span class="mf">4.0d0</span>
<a name="ln-4948"></a>    <span class="n">Sc</span>   <span class="o">=</span> <span class="mf">0.1645d0</span> <span class="o">*</span> <span class="nb">SIN</span><span class="p">(</span><span class="mf">2.0d0</span> <span class="o">*</span> <span class="n">b_SC</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.1255d0</span> <span class="o">*</span> <span class="nb">COS</span><span class="p">(</span><span class="n">b_SC</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.025d0</span> <span class="o">*</span> <span class="nb">SIN</span><span class="p">(</span><span class="n">b_SC</span><span class="p">)</span>
<a name="ln-4949"></a>    <span class="n">Hour_Angle</span> <span class="o">=</span> <span class="n">Pi</span> <span class="o">/</span> <span class="mi">1</span><span class="mf">2.0d0</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span> <span class="p">(</span><span class="n">HourOfDay</span> <span class="o">-</span> <span class="mf">0.5d0</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.06667d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">StMeridian_Degrees</span> <span class="o">-</span> <span class="n">Longitude_Degrees</span><span class="p">)</span> <span class="o">+</span> <span class="n">Sc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="mf">2.0d0</span><span class="p">)</span>
<a name="ln-4950"></a>
<a name="ln-4951"></a>    <span class="c">! Calculate sunset something, and constrain to a minimum of 0.000001</span>
<a name="ln-4952"></a>    <span class="n">X_sunset</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="o">-</span> <span class="nb">TAN</span><span class="p">(</span><span class="n">Latitude_Radians</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="nb">TAN</span><span class="p">(</span><span class="n">Declination</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<a name="ln-4953"></a>    <span class="n">X_sunset</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">X_sunset</span><span class="p">,</span> <span class="mf">0.000001d0</span><span class="p">)</span>
<a name="ln-4954"></a>
<a name="ln-4955"></a>    <span class="c">! Find sunset angle</span>
<a name="ln-4956"></a>    <span class="n">Sunset_angle</span> <span class="o">=</span> <span class="n">Pi</span> <span class="o">/</span> <span class="mf">2.0d0</span> <span class="o">-</span> <span class="nb">ATAN</span><span class="p">(</span><span class="o">-</span><span class="nb">TAN</span><span class="p">(</span><span class="n">Latitude_Radians</span><span class="p">)</span> <span class="o">*</span> <span class="nb">TAN</span><span class="p">(</span><span class="n">Declination</span><span class="p">)</span> <span class="o">/</span> <span class="n">X_sunset</span><span class="o">**</span><span class="mf">0.5d0</span> <span class="p">)</span>
<a name="ln-4957"></a>
<a name="ln-4958"></a>    <span class="c">! Find the current sun angle</span>
<a name="ln-4959"></a>    <span class="n">Altitude_Angle</span> <span class="o">=</span> <span class="nb">ASIN</span><span class="p">(</span> <span class="nb">SIN</span><span class="p">(</span><span class="n">Latitude_Radians</span><span class="p">)</span> <span class="o">*</span> <span class="nb">SIN</span><span class="p">(</span><span class="n">Declination</span><span class="p">)</span> <span class="o">+</span> <span class="nb">COS</span><span class="p">(</span><span class="n">Latitude_Radians</span><span class="p">)</span> <span class="o">*</span> <span class="nb">COS</span><span class="p">(</span><span class="n">Declination</span><span class="p">)</span> <span class="o">*</span> <span class="nb">COS</span><span class="p">(</span><span class="n">Hour_Angle</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-4960"></a>
<a name="ln-4961"></a>    <span class="c">! Find solar angles</span>
<a name="ln-4962"></a>    <span class="n">Solar_angle_1</span> <span class="o">=</span> <span class="n">Hour_Angle</span> <span class="o">-</span> <span class="n">Pi</span> <span class="o">/</span> <span class="mi">2</span><span class="mf">4.0d0</span>
<a name="ln-4963"></a>    <span class="n">Solar_angle_2</span> <span class="o">=</span> <span class="n">Hour_Angle</span> <span class="o">+</span> <span class="n">Pi</span> <span class="o">/</span> <span class="mi">2</span><span class="mf">4.0d0</span>
<a name="ln-4964"></a>
<a name="ln-4965"></a>    <span class="c">! Constrain solar angles</span>
<a name="ln-4966"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Solar_angle_1</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="o">-</span><span class="n">Sunset_angle</span> <span class="p">)</span> <span class="n">Solar_angle_1</span> <span class="o">=</span> <span class="o">-</span><span class="n">Sunset_angle</span>
<a name="ln-4967"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Solar_angle_2</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="o">-</span><span class="n">Sunset_angle</span> <span class="p">)</span> <span class="n">Solar_angle_2</span> <span class="o">=</span> <span class="o">-</span><span class="n">Sunset_angle</span>
<a name="ln-4968"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Solar_angle_1</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span>  <span class="n">Sunset_angle</span> <span class="p">)</span> <span class="n">Solar_angle_1</span> <span class="o">=</span>  <span class="n">Sunset_angle</span>
<a name="ln-4969"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Solar_angle_2</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span>  <span class="n">Sunset_angle</span> <span class="p">)</span> <span class="n">Solar_angle_2</span> <span class="o">=</span>  <span class="n">Sunset_angle</span>
<a name="ln-4970"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Solar_angle_1</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span>  <span class="n">Solar_angle_2</span><span class="p">)</span> <span class="n">Solar_angle_1</span> <span class="o">=</span>  <span class="n">Solar_angle_2</span>
<a name="ln-4971"></a>
<a name="ln-4972"></a>    <span class="c">! Convert input solar radiation [w/m2] into units for ET model, [MJ/hr-min]</span>
<a name="ln-4973"></a>    <span class="n">IncidentSolar_MJhrmin</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cur</span><span class="p">%</span><span class="n">CurIncidentSolar</span> <span class="o">*</span> <span class="n">Convert_Wm2_To_MJhrmin</span>
<a name="ln-4974"></a>
<a name="ln-4975"></a>    <span class="c">! Calculate another Q term...</span>
<a name="ln-4976"></a>    <span class="n">QRAD_a</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">2.0d0</span> <span class="o">*</span> <span class="mi">6</span><span class="mf">0.0d0</span> <span class="o">/</span> <span class="n">Pi</span> <span class="o">*</span> <span class="n">MeanSolarConstant</span> <span class="o">*</span> <span class="n">dr</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-4977"></a>        <span class="p">(</span>   <span class="p">(</span><span class="n">Solar_angle_2</span> <span class="o">-</span> <span class="n">Solar_angle_1</span><span class="p">)</span> <span class="o">*</span> <span class="nb">SIN</span><span class="p">(</span><span class="n">Latitude_Radians</span><span class="p">)</span> <span class="o">*</span> <span class="nb">SIN</span><span class="p">(</span><span class="n">Declination</span><span class="p">)</span>         <span class="p">&amp;</span>
<a name="ln-4978"></a>          <span class="o">+</span> <span class="nb">COS</span><span class="p">(</span><span class="n">Latitude_Radians</span><span class="p">)</span> <span class="o">*</span> <span class="nb">COS</span><span class="p">(</span><span class="n">Declination</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="nb">SIN</span><span class="p">(</span><span class="n">Solar_angle_2</span><span class="p">)</span><span class="o">-</span><span class="nb">SIN</span><span class="p">(</span><span class="n">Solar_angle_1</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-4979"></a>        <span class="p">)</span>
<a name="ln-4980"></a>
<a name="ln-4981"></a>    <span class="c">! Calculate another Q term...</span>
<a name="ln-4982"></a>    <span class="n">QRAD_SO</span> <span class="o">=</span> <span class="p">(</span> <span class="n">A_s</span> <span class="o">+</span> <span class="n">B_s</span> <span class="o">+</span> <span class="mf">0.00002d0</span> <span class="o">*</span> <span class="n">Elevation</span> <span class="p">)</span> <span class="o">*</span> <span class="n">QRAD_a</span>
<a name="ln-4983"></a>
<a name="ln-4984"></a>    <span class="c">! Correct the Qrad term ... better way??</span>
<a name="ln-4985"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IncidentSolar_MJhrmin</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.01d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4986"></a><span class="k">        </span><span class="n">Ratio_SO</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4987"></a>    <span class="k">ELSE</span>
<a name="ln-4988"></a><span class="k">        IF</span><span class="p">(</span><span class="n">QRAD_SO</span> <span class="o">/=</span> <span class="mf">0.d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4989"></a><span class="k">          </span><span class="n">Ratio_SO</span> <span class="o">=</span> <span class="n">IncidentSolar_MJhrmin</span> <span class="o">/</span> <span class="n">QRAD_SO</span>
<a name="ln-4990"></a>        <span class="k">ELSE</span>
<a name="ln-4991"></a>    <span class="c">! I used logic below to choose value, divide by 0 = infinity, so value = 1, not sure if correct...</span>
<a name="ln-4992"></a>          <span class="n">Ratio_SO</span> <span class="o">=</span> <span class="mf">1.d0</span>
<a name="ln-4993"></a>        <span class="k">END IF</span>
<a name="ln-4994"></a>
<a name="ln-4995"></a><span class="k">    END IF</span>
<a name="ln-4996"></a>
<a name="ln-4997"></a>    <span class="c">! Constrain Ratio_SO</span>
<a name="ln-4998"></a>    <span class="n">Ratio_SO</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">Ratio_SO</span><span class="p">,</span> <span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-4999"></a>    <span class="n">Ratio_SO</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">Ratio_SO</span><span class="p">,</span> <span class="mf">0.3d0</span><span class="p">)</span>
<a name="ln-5000"></a>
<a name="ln-5001"></a>    <span class="c">! Calculate another Q term, [MJ/hr-min]</span>
<a name="ln-5002"></a>    <span class="n">AbsorbedIncidentSolar_MJhrmin</span> <span class="o">=</span> <span class="n">ABSOR_CORRECTED</span> <span class="o">*</span> <span class="n">IncidentSolar_MJhrmin</span>
<a name="ln-5003"></a>
<a name="ln-5004"></a>    <span class="c">! Calculate saturated vapor pressure, [kPa]</span>
<a name="ln-5005"></a>    <span class="n">VaporPressureSaturated_kPa</span> <span class="o">=</span> <span class="mf">0.6108d0</span> <span class="o">*</span> <span class="nb">EXP</span><span class="p">(</span><span class="mi">1</span><span class="mf">7.27d0</span> <span class="o">*</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cur</span><span class="p">%</span><span class="n">CurAirTemp</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-5006"></a>                                                            <span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cur</span><span class="p">%</span><span class="n">CurAirTemp</span> <span class="o">+</span> <span class="mi">23</span><span class="mf">7.3d0</span><span class="p">))</span>
<a name="ln-5007"></a>
<a name="ln-5008"></a>    <span class="c">! Calculate actual vapor pressure, [kPa]</span>
<a name="ln-5009"></a>    <span class="n">VaporPressureActual_kPa</span> <span class="o">=</span> <span class="n">VaporPressureSaturated_kPa</span> <span class="o">*</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cur</span><span class="p">%</span><span class="n">CurRelativeHumidity</span> <span class="o">/</span> <span class="mi">10</span><span class="mf">0.0d0</span>
<a name="ln-5010"></a>
<a name="ln-5011"></a>    <span class="c">! Calculate another Q term, [MJ/m2-hr]</span>
<a name="ln-5012"></a>    <span class="n">QRAD_NL</span> <span class="o">=</span> <span class="mf">2.042D-10</span> <span class="o">*</span> <span class="n">CurAirTempK</span><span class="o">**</span><span class="mi">4</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.34d0</span> <span class="o">-</span> <span class="mf">0.14d0</span> <span class="o">*</span> <span class="nb">SQRT</span><span class="p">(</span><span class="n">VaporPressureActual_kPa</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.35d0</span> <span class="o">*</span> <span class="n">Ratio_SO</span> <span class="o">-</span> <span class="mf">0.35d0</span><span class="p">)</span>
<a name="ln-5013"></a>
<a name="ln-5014"></a>    <span class="c">! Calculate another Q term, [MJ/hr]</span>
<a name="ln-5015"></a>    <span class="n">NetIncidentRadiation_MJhr</span> <span class="o">=</span> <span class="n">AbsorbedIncidentSolar_MJhrmin</span> <span class="o">-</span> <span class="n">QRAD_NL</span>
<a name="ln-5016"></a>
<a name="ln-5017"></a>    <span class="c">! ?</span>
<a name="ln-5018"></a>    <span class="n">Cn</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">7.0d0</span>
<a name="ln-5019"></a>
<a name="ln-5020"></a>    <span class="c">! Check whether there was sun</span>
<a name="ln-5021"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NetIncidentRadiation_MJhr</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5022"></a><span class="k">        </span><span class="n">G_hr</span> <span class="o">=</span> <span class="mf">0.5d0</span> <span class="o">*</span> <span class="n">NetIncidentRadiation_MJhr</span>
<a name="ln-5023"></a>        <span class="n">Cd</span> <span class="o">=</span> <span class="mf">0.96d0</span>
<a name="ln-5024"></a>    <span class="k">ELSE</span>
<a name="ln-5025"></a><span class="k">        </span><span class="n">G_hr</span> <span class="o">=</span> <span class="mf">0.1d0</span> <span class="o">*</span> <span class="n">NetIncidentRadiation_MJhr</span>
<a name="ln-5026"></a>        <span class="n">Cd</span> <span class="o">=</span> <span class="mf">0.24d0</span>
<a name="ln-5027"></a>    <span class="k">END IF</span>
<a name="ln-5028"></a>
<a name="ln-5029"></a>    <span class="c">! Just For Check</span>
<a name="ln-5030"></a>    <span class="c">! Lu Xing Sep 22 2009</span>
<a name="ln-5031"></a>
<a name="ln-5032"></a>    <span class="n">Slope_S</span> <span class="o">=</span> <span class="mi">250</span><span class="mf">3.0d0</span> <span class="o">*</span> <span class="nb">EXP</span><span class="p">(</span> <span class="mi">1</span><span class="mf">7.27d0</span> <span class="o">*</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cur</span><span class="p">%</span><span class="n">CurAirTemp</span> <span class="o">/</span>     <span class="p">&amp;</span>
<a name="ln-5033"></a>                                <span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cur</span><span class="p">%</span><span class="n">CurAirTemp</span> <span class="o">+</span> <span class="mi">23</span><span class="mf">7.3d0</span><span class="p">)</span>   <span class="p">&amp;</span>
<a name="ln-5034"></a>                            <span class="p">)</span>  <span class="o">/</span> <span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cur</span><span class="p">%</span><span class="n">CurAirTemp</span><span class="o">+</span><span class="mi">23</span><span class="mf">7.3d0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<a name="ln-5035"></a>    <span class="n">Pressure</span> <span class="o">=</span> <span class="mi">9</span><span class="mf">8.0d0</span>
<a name="ln-5036"></a>    <span class="n">PsychrometricConstant</span> <span class="o">=</span> <span class="mf">0.665d-3</span> <span class="o">*</span> <span class="n">Pressure</span>
<a name="ln-5037"></a>
<a name="ln-5038"></a>    <span class="c">! Evapotranspiration constant, [mm/hr]</span>
<a name="ln-5039"></a>    <span class="n">EvapotransFluidLoss_mmhr</span> <span class="o">=</span> <span class="p">(</span><span class="n">GroundCoverCoefficient</span> <span class="o">*</span> <span class="n">Slope_s</span> <span class="o">*</span> <span class="p">(</span><span class="n">NetIncidentRadiation_MJhr</span> <span class="o">-</span> <span class="n">G_hr</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5040"></a>                                <span class="o">+</span> <span class="n">PsychrometricConstant</span> <span class="o">*</span> <span class="p">(</span><span class="n">Cn</span> <span class="o">/</span> <span class="n">CurAirTempK</span><span class="p">)</span> <span class="o">*</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cur</span><span class="p">%</span><span class="n">Curwindspeed</span> <span class="p">&amp;</span>
<a name="ln-5041"></a>                                  <span class="o">*</span> <span class="p">(</span><span class="n">VaporPressureSaturated_kPa</span> <span class="o">-</span> <span class="n">VaporPressureActual_kPa</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5042"></a>                               <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5043"></a>             <span class="o">/</span> <span class="p">(</span><span class="n">Slope_s</span> <span class="o">+</span> <span class="n">PsychrometricConstant</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Cd</span> <span class="o">*</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cur</span><span class="p">%</span><span class="n">CurWindSpeed</span><span class="p">))</span>
<a name="ln-5044"></a>
<a name="ln-5045"></a>    <span class="c">! Convert units, [m/hr]</span>
<a name="ln-5046"></a>    <span class="n">EvapotransFluidLoss_mhr</span> <span class="o">=</span> <span class="n">EvapotransFluidLoss_mmhr</span> <span class="o">/</span> <span class="mi">100</span><span class="mf">0.0d0</span>
<a name="ln-5047"></a>
<a name="ln-5048"></a>    <span class="c">! Calculate latent heat, [MJ/kg]</span>
<a name="ln-5049"></a>    <span class="c">! Full formulation is cubic: L(T) = -0.0000614342 * T**3 + 0.00158927 * T**2 - 2.36418 * T + 2500.79[5]</span>
<a name="ln-5050"></a>    <span class="c">! In: Cubic fit to Table 2.1,p.16, Textbook: R.R.Rogers &amp; M.K. Yau, A Short Course in Cloud Physics, 3e,(1989), Pergamon press</span>
<a name="ln-5051"></a>    <span class="c">! But a linear relation should suffice;</span>
<a name="ln-5052"></a>    <span class="c">! note-for now using the previous time step temperature as an approximation to help ensure stability</span>
<a name="ln-5053"></a>    <span class="n">LatentHeatVaporization</span> <span class="o">=</span> <span class="mf">2.501d0</span> <span class="o">-</span> <span class="mf">2.361d-3</span> <span class="o">*</span> <span class="n">cell</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature_PrevTimeStep</span>
<a name="ln-5054"></a>
<a name="ln-5055"></a>    <span class="c">! Calculate evapotranspiration heat loss, [MJ/m2-hr]</span>
<a name="ln-5056"></a>    <span class="n">EvapotransHeatLoss_MJhrmin</span> <span class="o">=</span> <span class="n">RHO_water</span> <span class="o">*</span> <span class="n">EvapotransFluidLoss_mhr</span> <span class="o">*</span> <span class="n">LatentHeatVaporization</span>
<a name="ln-5057"></a>
<a name="ln-5058"></a>    <span class="c">! Convert net incident solar units, [W/m2]</span>
<a name="ln-5059"></a>    <span class="n">NetIncidentRadiation_Wm2</span> <span class="o">=</span> <span class="n">NetIncidentRadiation_MJhr</span> <span class="o">*</span> <span class="n">Convert_MJhrmin_To_Wm2</span>
<a name="ln-5060"></a>
<a name="ln-5061"></a>    <span class="c">! Convert evapotranspiration units, [W/m2]</span>
<a name="ln-5062"></a>    <span class="n">EvapotransHeatLoss_Wm2</span> <span class="o">=</span> <span class="n">EvapotransHeatLoss_MJhrmin</span> <span class="o">*</span> <span class="n">Convert_MJhrmin_To_Wm2</span>
<a name="ln-5063"></a>
<a name="ln-5064"></a>    <span class="c">! Calculate overall net heat ?gain? into the cell, [W]</span>
<a name="ln-5065"></a>    <span class="n">IncidentHeatGain</span> <span class="o">=</span> <span class="p">(</span><span class="n">NetIncidentRadiation_Wm2</span> <span class="o">-</span> <span class="n">EvapotransHeatLoss_Wm2</span><span class="p">)</span> <span class="o">*</span> <span class="n">ThisNormalArea</span>
<a name="ln-5066"></a>
<a name="ln-5067"></a>    <span class="c">! Add any solar/evapotranspiration heat gain here</span>
<a name="ln-5068"></a>    <span class="n">Numerator</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">+</span> <span class="n">Beta</span> <span class="o">*</span> <span class="n">IncidentHeatGain</span>
<a name="ln-5069"></a>
<a name="ln-5070"></a>    <span class="c">! Calculate the return temperature and leave</span>
<a name="ln-5071"></a>    <span class="n">RetVal</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">/</span> <span class="n">Denominator</span>
<a name="ln-5072"></a>
<a name="ln-5073"></a>    <span class="k">RETURN</span>
<a name="ln-5074"></a>
<a name="ln-5075"></a><span class="k">END FUNCTION</span>
<a name="ln-5076"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-5077"></a>
<a name="ln-5078"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-5079"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">EvaluateAdiabaticSurfaceTemperature</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">cell</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">RetVal</span><span class="p">)</span>
<a name="ln-5080"></a>
<a name="ln-5081"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-5082"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-5083"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-5084"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5085"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5086"></a>
<a name="ln-5087"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-5088"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-5089"></a>
<a name="ln-5090"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5091"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-5092"></a>
<a name="ln-5093"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5094"></a>          <span class="c">! na</span>
<a name="ln-5095"></a>
<a name="ln-5096"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5097"></a>          <span class="c">! na</span>
<a name="ln-5098"></a>
<a name="ln-5099"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5100"></a>
<a name="ln-5101"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-5102"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DomainNum</span>
<a name="ln-5103"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">CartesianCell</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cell</span>
<a name="ln-5104"></a>
<a name="ln-5105"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5106"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Numerator</span>
<a name="ln-5107"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Denominator</span>
<a name="ln-5108"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Resistance</span>
<a name="ln-5109"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NeighborTemp</span>
<a name="ln-5110"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Beta</span>
<a name="ln-5111"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DirectionCounter</span>
<a name="ln-5112"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CurDirection</span>
<a name="ln-5113"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AdiabaticMultiplier</span>
<a name="ln-5114"></a>
<a name="ln-5115"></a>    <span class="n">Numerator</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5116"></a>    <span class="n">Denominator</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5117"></a>    <span class="n">Resistance</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5118"></a>    <span class="n">Beta</span> <span class="o">=</span> <span class="n">cell</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Beta</span>
<a name="ln-5119"></a>
<a name="ln-5120"></a>    <span class="c">!&#39;add effect from previous time step</span>
<a name="ln-5121"></a>    <span class="n">Numerator</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">+</span> <span class="n">cell</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature_PrevTimeStep</span>
<a name="ln-5122"></a>    <span class="n">Denominator</span> <span class="o">=</span> <span class="n">Denominator</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-5123"></a>
<a name="ln-5124"></a>    <span class="c">!now that we aren&#39;t infinitesimal, we need to determine the neighbor types based on cell location</span>
<a name="ln-5125"></a>    <span class="k">CALL </span><span class="n">EvaluateCellNeighborDirections</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">cell</span><span class="p">)</span>
<a name="ln-5126"></a>
<a name="ln-5127"></a>    <span class="k">DO </span><span class="n">DirectionCounter</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">NeighborFieldCells</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">NeighborFieldCells</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5128"></a>        <span class="n">CurDirection</span> <span class="o">=</span> <span class="n">NeighborFieldCells</span><span class="p">(</span><span class="n">DirectionCounter</span><span class="p">)</span>
<a name="ln-5129"></a>        <span class="n">AdiabaticMultiplier</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-5130"></a>
<a name="ln-5131"></a>        <span class="c">! There are only a few cases for adiabatic cells to be handled here</span>
<a name="ln-5132"></a>        <span class="c">! These cases must be validated during mesh development as they aren&#39;t here</span>
<a name="ln-5133"></a>        <span class="c">! For example, the +x case below will only be hit if the celltype is actually</span>
<a name="ln-5134"></a>        <span class="c">!   assigned to be Adiabatic...which only happens if the mesh dev engine</span>
<a name="ln-5135"></a>        <span class="c">!   recognizes that there is in fact a basement, and the boundary type is</span>
<a name="ln-5136"></a>        <span class="c">!   specified as adiabatic.</span>
<a name="ln-5137"></a>        <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">CurDirection</span><span class="p">)</span>
<a name="ln-5138"></a>            <span class="k">CASE</span> <span class="p">(</span><span class="n">Direction_PositiveZ</span><span class="p">)</span> <span class="c">! Case: front face looking in +z direction</span>
<a name="ln-5139"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">cell</span><span class="p">%</span><span class="n">Z_index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">AdiabaticMultiplier</span> <span class="o">=</span> <span class="mf">2.0d0</span>
<a name="ln-5140"></a>            <span class="k">CASE</span> <span class="p">(</span><span class="n">Direction_NegativeZ</span><span class="p">)</span> <span class="c">! Case: back face looking in -z direction</span>
<a name="ln-5141"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">cell</span><span class="p">%</span><span class="n">Z_index</span> <span class="o">==</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span> <span class="n">AdiabaticMultiplier</span> <span class="o">=</span> <span class="mf">2.0d0</span>
<a name="ln-5142"></a>            <span class="k">CASE</span> <span class="p">(</span><span class="n">Direction_PositiveX</span><span class="p">)</span> <span class="c">! Case: Under basement floor, far left cell</span>
<a name="ln-5143"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">cell</span><span class="p">%</span><span class="n">X_index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">AdiabaticMultiplier</span> <span class="o">=</span> <span class="mf">2.0d0</span>
<a name="ln-5144"></a>            <span class="k">CASE</span> <span class="p">(</span><span class="n">Direction_NegativeY</span><span class="p">)</span> <span class="c">! Case: basement wall ground surface boundary</span>
<a name="ln-5145"></a>                <span class="c">!Not sure if this is ever hit (it should be a basement wall celltype)</span>
<a name="ln-5146"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">cell</span><span class="p">%</span><span class="n">Y_index</span> <span class="o">==</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="n">AdiabaticMultiplier</span> <span class="o">=</span> <span class="mf">2.0d0</span>
<a name="ln-5147"></a>        <span class="k">END SELECT</span>
<a name="ln-5148"></a>
<a name="ln-5149"></a>        <span class="c">!Use the multiplier (either 1 or 2) to calculate the neighbor cell effects</span>
<a name="ln-5150"></a>        <span class="k">CALL </span><span class="n">EvaluateNeighborCharacteristics</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">CurDirection</span><span class="p">,</span> <span class="n">NeighborTemp</span><span class="p">,</span> <span class="n">Resistance</span><span class="p">)</span>
<a name="ln-5151"></a>        <span class="n">Numerator</span> <span class="o">=</span> <span class="n">AdiabaticMultiplier</span> <span class="o">*</span> <span class="n">Numerator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span><span class="p">)</span> <span class="o">*</span> <span class="n">NeighborTemp</span>
<a name="ln-5152"></a>        <span class="n">Denominator</span> <span class="o">=</span> <span class="n">AdiabaticMultiplier</span> <span class="o">*</span> <span class="n">Denominator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span><span class="p">)</span>
<a name="ln-5153"></a>
<a name="ln-5154"></a>    <span class="k">END DO</span>
<a name="ln-5155"></a>
<a name="ln-5156"></a><span class="k">    </span><span class="n">RetVal</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">/</span> <span class="n">Denominator</span>
<a name="ln-5157"></a>
<a name="ln-5158"></a>  <span class="k">RETURN</span>
<a name="ln-5159"></a>
<a name="ln-5160"></a><span class="k">END FUNCTION</span>
<a name="ln-5161"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-5162"></a>
<a name="ln-5163"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-5164"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">EvaluateBasementCellTemperature</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">cell</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">RetVal</span><span class="p">)</span>
<a name="ln-5165"></a>
<a name="ln-5166"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-5167"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-5168"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-5169"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5170"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5171"></a>
<a name="ln-5172"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-5173"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-5174"></a>
<a name="ln-5175"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5176"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-5177"></a>
<a name="ln-5178"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5179"></a>          <span class="c">! na</span>
<a name="ln-5180"></a>
<a name="ln-5181"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5182"></a>          <span class="c">! na</span>
<a name="ln-5183"></a>
<a name="ln-5184"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5185"></a>
<a name="ln-5186"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-5187"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DomainNum</span>
<a name="ln-5188"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">CartesianCell</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cell</span>
<a name="ln-5189"></a>
<a name="ln-5190"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5191"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Numerator</span>
<a name="ln-5192"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Denominator</span>
<a name="ln-5193"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Beta</span>
<a name="ln-5194"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Resistance</span>
<a name="ln-5195"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NeighborTemp</span>
<a name="ln-5196"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatFlux</span>
<a name="ln-5197"></a>
<a name="ln-5198"></a>    <span class="c">!Initialize</span>
<a name="ln-5199"></a>    <span class="n">Numerator</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5200"></a>    <span class="n">Denominator</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5201"></a>    <span class="n">Resistance</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5202"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">cell</span><span class="p">%</span><span class="n">CellType</span><span class="p">)</span>
<a name="ln-5203"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">CellType_BasementWall</span><span class="p">,</span> <span class="n">CellType_BasementFloor</span><span class="p">)</span>
<a name="ln-5204"></a>        <span class="c">!This is actually only a half-cell since the basement wall slices right through the middle in one direction</span>
<a name="ln-5205"></a>        <span class="n">Beta</span> <span class="o">=</span> <span class="n">cell</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Beta</span> <span class="o">/</span> <span class="mf">2.0d0</span>
<a name="ln-5206"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">CellType_BasementCorner</span><span class="p">)</span>
<a name="ln-5207"></a>        <span class="c">!This is actually only a three-quarter-cell since the basement wall slices right through the middle in both directions</span>
<a name="ln-5208"></a>        <span class="n">Beta</span> <span class="o">=</span> <span class="n">cell</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Beta</span> <span class="o">*</span> <span class="mf">3.0d0</span><span class="o">/</span><span class="mf">4.0d0</span>
<a name="ln-5209"></a>    <span class="k">END SELECT</span>
<a name="ln-5210"></a>
<a name="ln-5211"></a>    <span class="c">!add effect from previous time step</span>
<a name="ln-5212"></a>    <span class="n">Numerator</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">+</span> <span class="n">cell</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature_PrevTimeStep</span>
<a name="ln-5213"></a>    <span class="n">Denominator</span> <span class="o">=</span> <span class="n">Denominator</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-5214"></a>
<a name="ln-5215"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">cell</span><span class="p">%</span><span class="n">CellType</span><span class="p">)</span>
<a name="ln-5216"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">CellType_BasementWall</span><span class="p">)</span>
<a name="ln-5217"></a>
<a name="ln-5218"></a>        <span class="c">!we will only have heat flux from the basement wall and heat conduction to the +x cell</span>
<a name="ln-5219"></a>
<a name="ln-5220"></a>        <span class="c">!get the average basement wall heat flux and add it to the tally</span>
<a name="ln-5221"></a>        <span class="n">HeatFlux</span> <span class="o">=</span> <span class="n">GetBasementWallHeatFlux</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)</span>
<a name="ln-5222"></a>        <span class="n">Numerator</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">+</span> <span class="n">Beta</span> <span class="o">*</span> <span class="n">HeatFlux</span> <span class="o">*</span> <span class="n">Height</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
<a name="ln-5223"></a>
<a name="ln-5224"></a>        <span class="c">! then get the +x conduction to continue the heat balance</span>
<a name="ln-5225"></a>        <span class="k">CALL </span><span class="n">EvaluateNeighborCharacteristics</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">Direction_PositiveX</span><span class="p">,</span> <span class="n">NeighborTemp</span><span class="p">,</span> <span class="n">Resistance</span><span class="p">)</span>
<a name="ln-5226"></a>        <span class="n">Numerator</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span><span class="p">)</span> <span class="o">*</span> <span class="n">NeighborTemp</span>
<a name="ln-5227"></a>        <span class="n">Denominator</span> <span class="o">=</span> <span class="n">Denominator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span><span class="p">)</span>
<a name="ln-5228"></a>
<a name="ln-5229"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">CellType_BasementFloor</span><span class="p">)</span>
<a name="ln-5230"></a>
<a name="ln-5231"></a>        <span class="c">!we will only have heat flux from the basement floor and heat conduction to the lower cell</span>
<a name="ln-5232"></a>
<a name="ln-5233"></a>        <span class="c">!get the average basement floor heat flux and add it to the tally</span>
<a name="ln-5234"></a>        <span class="n">HeatFlux</span> <span class="o">=</span> <span class="n">GetBasementFloorHeatFlux</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)</span>
<a name="ln-5235"></a>        <span class="n">Numerator</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">+</span> <span class="n">Beta</span> <span class="o">*</span> <span class="n">HeatFlux</span> <span class="o">*</span> <span class="n">Width</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
<a name="ln-5236"></a>
<a name="ln-5237"></a>        <span class="c">! then get the -y conduction to continue the heat balance</span>
<a name="ln-5238"></a>        <span class="k">CALL </span><span class="n">EvaluateNeighborCharacteristics</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">Direction_NegativeY</span><span class="p">,</span> <span class="n">NeighborTemp</span><span class="p">,</span> <span class="n">Resistance</span><span class="p">)</span>
<a name="ln-5239"></a>        <span class="n">Numerator</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span><span class="p">)</span> <span class="o">*</span> <span class="n">NeighborTemp</span>
<a name="ln-5240"></a>        <span class="n">Denominator</span> <span class="o">=</span> <span class="n">Denominator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span><span class="p">)</span>
<a name="ln-5241"></a>
<a name="ln-5242"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">CellType_BasementCorner</span><span class="p">)</span>
<a name="ln-5243"></a>
<a name="ln-5244"></a>        <span class="c">!we will only have heat conduction to the +x and -y cells</span>
<a name="ln-5245"></a>        <span class="k">CALL </span><span class="n">EvaluateNeighborCharacteristics</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">Direction_PositiveX</span><span class="p">,</span> <span class="n">NeighborTemp</span><span class="p">,</span> <span class="n">Resistance</span><span class="p">)</span>
<a name="ln-5246"></a>        <span class="n">Numerator</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span><span class="p">)</span> <span class="o">*</span> <span class="n">NeighborTemp</span>
<a name="ln-5247"></a>        <span class="n">Denominator</span> <span class="o">=</span> <span class="n">Denominator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span><span class="p">)</span>
<a name="ln-5248"></a>
<a name="ln-5249"></a>        <span class="k">CALL </span><span class="n">EvaluateNeighborCharacteristics</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">Direction_NegativeY</span><span class="p">,</span> <span class="n">NeighborTemp</span><span class="p">,</span> <span class="n">Resistance</span><span class="p">)</span>
<a name="ln-5250"></a>        <span class="n">Numerator</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span><span class="p">)</span> <span class="o">*</span> <span class="n">NeighborTemp</span>
<a name="ln-5251"></a>        <span class="n">Denominator</span> <span class="o">=</span> <span class="n">Denominator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span><span class="p">)</span>
<a name="ln-5252"></a>
<a name="ln-5253"></a>    <span class="k">END SELECT</span>
<a name="ln-5254"></a>
<a name="ln-5255"></a><span class="k">    </span><span class="n">RetVal</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">/</span> <span class="n">Denominator</span>
<a name="ln-5256"></a>
<a name="ln-5257"></a>  <span class="k">RETURN</span>
<a name="ln-5258"></a>
<a name="ln-5259"></a><span class="k">END FUNCTION</span>
<a name="ln-5260"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-5261"></a>
<a name="ln-5262"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-5263"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">GetBasementWallHeatFlux</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">RetVal</span><span class="p">)</span>
<a name="ln-5264"></a>
<a name="ln-5265"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-5266"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-5267"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-5268"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5269"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5270"></a>
<a name="ln-5271"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-5272"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-5273"></a>
<a name="ln-5274"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5275"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-5276"></a>
<a name="ln-5277"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5278"></a>          <span class="c">! na</span>
<a name="ln-5279"></a>
<a name="ln-5280"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5281"></a>    <span class="k">USE </span><span class="n">DataHeatBalSurface</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">QdotConvOutRepPerArea</span>
<a name="ln-5282"></a>
<a name="ln-5283"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5284"></a>
<a name="ln-5285"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-5286"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DomainNum</span>
<a name="ln-5287"></a>
<a name="ln-5288"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-5289"></a>          <span class="c">! na</span>
<a name="ln-5290"></a>
<a name="ln-5291"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5292"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RunningSummation</span>
<a name="ln-5293"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SurfaceCounter</span>
<a name="ln-5294"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SurfacePointer</span>
<a name="ln-5295"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumSurfaces</span>
<a name="ln-5296"></a>
<a name="ln-5297"></a>    <span class="n">RunningSummation</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5298"></a>    <span class="n">NumSurfaces</span> <span class="o">=</span> <span class="n">SIZE</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BasementZone</span><span class="p">%</span><span class="n">WallSurfacePointers</span><span class="p">)</span>
<a name="ln-5299"></a>
<a name="ln-5300"></a>    <span class="k">DO </span><span class="n">SurfaceCounter</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumSurfaces</span>
<a name="ln-5301"></a>        <span class="n">SurfacePointer</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BasementZone</span><span class="p">%</span><span class="n">WallSurfacePointers</span><span class="p">(</span><span class="n">SurfaceCounter</span><span class="p">)</span>
<a name="ln-5302"></a>        <span class="n">RunningSummation</span> <span class="o">=</span> <span class="n">RunningSummation</span> <span class="o">+</span> <span class="n">QdotConvOutRepPerArea</span><span class="p">(</span><span class="n">SurfacePointer</span><span class="p">)</span>
<a name="ln-5303"></a>    <span class="k">END DO</span>
<a name="ln-5304"></a>
<a name="ln-5305"></a><span class="k">    </span><span class="n">RetVal</span> <span class="o">=</span> <span class="o">-</span><span class="n">RunningSummation</span> <span class="o">/</span> <span class="n">NumSurfaces</span> <span class="c">! heat flux is negative here</span>
<a name="ln-5306"></a>
<a name="ln-5307"></a>  <span class="k">RETURN</span>
<a name="ln-5308"></a>
<a name="ln-5309"></a><span class="k">END FUNCTION </span><span class="n">GetBasementWallHeatFlux</span>
<a name="ln-5310"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-5311"></a>
<a name="ln-5312"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-5313"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">GetBasementFloorHeatFlux</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">RetVal</span><span class="p">)</span>
<a name="ln-5314"></a>
<a name="ln-5315"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-5316"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-5317"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-5318"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5319"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5320"></a>
<a name="ln-5321"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-5322"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-5323"></a>
<a name="ln-5324"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5325"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-5326"></a>
<a name="ln-5327"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5328"></a>          <span class="c">! na</span>
<a name="ln-5329"></a>
<a name="ln-5330"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5331"></a>    <span class="k">USE </span><span class="n">DataHeatBalSurface</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">QdotConvOutRepPerArea</span>
<a name="ln-5332"></a>
<a name="ln-5333"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5334"></a>
<a name="ln-5335"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-5336"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DomainNum</span>
<a name="ln-5337"></a>
<a name="ln-5338"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-5339"></a>          <span class="c">! na</span>
<a name="ln-5340"></a>
<a name="ln-5341"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5342"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RunningSummation</span>
<a name="ln-5343"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SurfaceCounter</span>
<a name="ln-5344"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SurfacePointer</span>
<a name="ln-5345"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumSurfaces</span>
<a name="ln-5346"></a>
<a name="ln-5347"></a>    <span class="n">RunningSummation</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5348"></a>    <span class="n">NumSurfaces</span> <span class="o">=</span> <span class="n">SIZE</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BasementZone</span><span class="p">%</span><span class="n">FloorSurfacePointers</span><span class="p">)</span>
<a name="ln-5349"></a>
<a name="ln-5350"></a>    <span class="k">DO </span><span class="n">SurfaceCounter</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumSurfaces</span>
<a name="ln-5351"></a>        <span class="n">SurfacePointer</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BasementZone</span><span class="p">%</span><span class="n">FloorSurfacePointers</span><span class="p">(</span><span class="n">SurfaceCounter</span><span class="p">)</span>
<a name="ln-5352"></a>        <span class="n">RunningSummation</span> <span class="o">=</span> <span class="n">RunningSummation</span> <span class="o">+</span> <span class="n">QdotConvOutRepPerArea</span><span class="p">(</span><span class="n">SurfacePointer</span><span class="p">)</span>
<a name="ln-5353"></a>    <span class="k">END DO</span>
<a name="ln-5354"></a>
<a name="ln-5355"></a><span class="k">    </span><span class="n">RetVal</span> <span class="o">=</span> <span class="o">-</span><span class="n">RunningSummation</span> <span class="o">/</span> <span class="n">NumSurfaces</span>   <span class="c">! heat flux is negative here</span>
<a name="ln-5356"></a>
<a name="ln-5357"></a>  <span class="k">RETURN</span>
<a name="ln-5358"></a>
<a name="ln-5359"></a><span class="k">END FUNCTION </span><span class="n">GetBasementFloorHeatFlux</span>
<a name="ln-5360"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-5361"></a>
<a name="ln-5362"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-5363"></a><span class="k">SUBROUTINE </span><span class="n">UpdateBasementSurfaceTemperatures</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)</span>
<a name="ln-5364"></a>
<a name="ln-5365"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5366"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-5367"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-5368"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5369"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5370"></a>
<a name="ln-5371"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5372"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-5373"></a>
<a name="ln-5374"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5375"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-5376"></a>
<a name="ln-5377"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5378"></a>          <span class="c">! na</span>
<a name="ln-5379"></a>
<a name="ln-5380"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5381"></a>    <span class="k">USE </span><span class="n">DataSurfaces</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">OSCM</span>
<a name="ln-5382"></a>
<a name="ln-5383"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5384"></a>
<a name="ln-5385"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5386"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DomainNum</span>
<a name="ln-5387"></a>
<a name="ln-5388"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-5389"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">BigNumber</span> <span class="o">=</span> <span class="mi">1000</span><span class="mf">0.0d0</span>
<a name="ln-5390"></a>
<a name="ln-5391"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5392"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AvgTemp</span>
<a name="ln-5393"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">OSCMIndex</span>
<a name="ln-5394"></a>
<a name="ln-5395"></a>    <span class="c">!First the wall</span>
<a name="ln-5396"></a>    <span class="n">AvgTemp</span> <span class="o">=</span> <span class="n">GetAverageTempByType</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">CellType_BasementWall</span><span class="p">)</span>
<a name="ln-5397"></a>    <span class="n">OSCMIndex</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BasementZone</span><span class="p">%</span><span class="n">WallBoundaryOSCMIndex</span>
<a name="ln-5398"></a>    <span class="n">OSCM</span><span class="p">(</span><span class="n">OSCMIndex</span><span class="p">)%</span><span class="n">TConv</span>   <span class="o">=</span> <span class="n">AvgTemp</span>
<a name="ln-5399"></a>    <span class="n">OSCM</span><span class="p">(</span><span class="n">OSCMIndex</span><span class="p">)%</span><span class="n">HConv</span>   <span class="o">=</span> <span class="n">BigNumber</span>
<a name="ln-5400"></a>    <span class="n">OSCM</span><span class="p">(</span><span class="n">OSCMIndex</span><span class="p">)%</span><span class="n">TRad</span>    <span class="o">=</span> <span class="n">AvgTemp</span>
<a name="ln-5401"></a>    <span class="n">OSCM</span><span class="p">(</span><span class="n">OSCMIndex</span><span class="p">)%</span><span class="n">HRad</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5402"></a>
<a name="ln-5403"></a>    <span class="c">!Then the floor</span>
<a name="ln-5404"></a>    <span class="n">AvgTemp</span> <span class="o">=</span> <span class="n">GetAverageTempByType</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">CellType_BasementFloor</span><span class="p">)</span>
<a name="ln-5405"></a>    <span class="n">OSCMIndex</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">BasementZone</span><span class="p">%</span><span class="n">FloorBoundaryOSCMIndex</span>
<a name="ln-5406"></a>    <span class="n">OSCM</span><span class="p">(</span><span class="n">OSCMIndex</span><span class="p">)%</span><span class="n">TConv</span>   <span class="o">=</span> <span class="n">AvgTemp</span>
<a name="ln-5407"></a>    <span class="n">OSCM</span><span class="p">(</span><span class="n">OSCMIndex</span><span class="p">)%</span><span class="n">HConv</span>   <span class="o">=</span> <span class="n">BigNumber</span>
<a name="ln-5408"></a>    <span class="n">OSCM</span><span class="p">(</span><span class="n">OSCMIndex</span><span class="p">)%</span><span class="n">TRad</span>    <span class="o">=</span> <span class="n">AvgTemp</span>
<a name="ln-5409"></a>    <span class="n">OSCM</span><span class="p">(</span><span class="n">OSCMIndex</span><span class="p">)%</span><span class="n">HRad</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5410"></a>
<a name="ln-5411"></a>  <span class="k">RETURN</span>
<a name="ln-5412"></a>
<a name="ln-5413"></a><span class="k">END SUBROUTINE </span><span class="n">UpdateBasementSurfaceTemperatures</span>
<a name="ln-5414"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-5415"></a>
<a name="ln-5416"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-5417"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">GetAverageTempByType</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">CellType</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">RetVal</span><span class="p">)</span>
<a name="ln-5418"></a>
<a name="ln-5419"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-5420"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-5421"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-5422"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5423"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5424"></a>
<a name="ln-5425"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-5426"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-5427"></a>
<a name="ln-5428"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5429"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-5430"></a>
<a name="ln-5431"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5432"></a>          <span class="c">! na</span>
<a name="ln-5433"></a>
<a name="ln-5434"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5435"></a>          <span class="c">! na</span>
<a name="ln-5436"></a>
<a name="ln-5437"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5438"></a>
<a name="ln-5439"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-5440"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DomainNum</span>
<a name="ln-5441"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CellType</span>
<a name="ln-5442"></a>
<a name="ln-5443"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-5444"></a>          <span class="c">! na</span>
<a name="ln-5445"></a>
<a name="ln-5446"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5447"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RunningSummation</span>
<a name="ln-5448"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">RunningCounter</span>
<a name="ln-5449"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span>
<a name="ln-5450"></a>
<a name="ln-5451"></a>    <span class="n">RunningSummation</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5452"></a>    <span class="n">RunningCounter</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5453"></a>
<a name="ln-5454"></a>    <span class="k">DO </span><span class="n">Z</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-5455"></a>        <span class="k">DO </span><span class="n">Y</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-5456"></a>            <span class="k">DO </span><span class="n">X</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5457"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">CellType</span> <span class="o">==</span> <span class="n">CellType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5458"></a><span class="k">                    </span><span class="n">RunningCounter</span> <span class="o">=</span> <span class="n">RunningCounter</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-5459"></a>                    <span class="n">RunningSummation</span> <span class="o">=</span> <span class="n">RunningSummation</span> <span class="o">+</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span>
<a name="ln-5460"></a>                <span class="k">END IF</span>
<a name="ln-5461"></a><span class="k">            END DO</span>
<a name="ln-5462"></a><span class="k">        END DO</span>
<a name="ln-5463"></a><span class="k">    END DO</span>
<a name="ln-5464"></a>
<a name="ln-5465"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">RunningCounter</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5466"></a><span class="k">        </span><span class="n">RetVal</span> <span class="o">=</span> <span class="n">RunningSummation</span> <span class="o">/</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">RunningCounter</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-5467"></a>    <span class="k">ELSE</span>
<a name="ln-5468"></a>        <span class="c">!ERROR!!!</span>
<a name="ln-5469"></a>        <span class="n">RetVal</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!Objexx:Return Line added to assure return value is set: Proper error handling needed here!</span>
<a name="ln-5470"></a>    <span class="k">END IF</span>
<a name="ln-5471"></a>
<a name="ln-5472"></a><span class="k">  RETURN</span>
<a name="ln-5473"></a>
<a name="ln-5474"></a><span class="k">END FUNCTION </span><span class="n">GetAverageTempByType</span>
<a name="ln-5475"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-5476"></a>
<a name="ln-5477"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-5478"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">EvaluateFarfieldBoundaryTemperature</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">cell</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">RetVal</span><span class="p">)</span>
<a name="ln-5479"></a>
<a name="ln-5480"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-5481"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-5482"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-5483"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5484"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5485"></a>
<a name="ln-5486"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-5487"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-5488"></a>
<a name="ln-5489"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5490"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-5491"></a>
<a name="ln-5492"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5493"></a>          <span class="c">! na</span>
<a name="ln-5494"></a>
<a name="ln-5495"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5496"></a>          <span class="c">! na</span>
<a name="ln-5497"></a>
<a name="ln-5498"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5499"></a>
<a name="ln-5500"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-5501"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DomainNum</span>
<a name="ln-5502"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">CartesianCell</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cell</span>
<a name="ln-5503"></a>
<a name="ln-5504"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5505"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Numerator</span>
<a name="ln-5506"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Denominator</span>
<a name="ln-5507"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Beta</span>
<a name="ln-5508"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Resistance</span>
<a name="ln-5509"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DirectionCounter</span>
<a name="ln-5510"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CurDirection</span>
<a name="ln-5511"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NeighborTemp</span>
<a name="ln-5512"></a>
<a name="ln-5513"></a>    <span class="n">Numerator</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5514"></a>    <span class="n">Denominator</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5515"></a>    <span class="n">Resistance</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5516"></a>    <span class="n">Beta</span> <span class="o">=</span> <span class="n">cell</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Beta</span>
<a name="ln-5517"></a>
<a name="ln-5518"></a>    <span class="c">!add effect from previous time step</span>
<a name="ln-5519"></a>    <span class="n">Numerator</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">+</span> <span class="n">cell</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature_PrevTimeStep</span>
<a name="ln-5520"></a>    <span class="n">Denominator</span> <span class="o">=</span> <span class="n">Denominator</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-5521"></a>
<a name="ln-5522"></a>    <span class="c">!now that we aren&#39;t infinitesimal, we need to determine the neighbor types based on cell location</span>
<a name="ln-5523"></a>    <span class="k">CALL </span><span class="n">EvaluateCellNeighborDirections</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">cell</span><span class="p">)</span>
<a name="ln-5524"></a>
<a name="ln-5525"></a>    <span class="c">!This may be incomplete, as there may need to be adiabatic conditions to be handled here as well</span>
<a name="ln-5526"></a>
<a name="ln-5527"></a>    <span class="c">!Do all neighbor cells</span>
<a name="ln-5528"></a>    <span class="k">DO </span><span class="n">DirectionCounter</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">NeighborFieldCells</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">NeighborFieldCells</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5529"></a>        <span class="n">CurDirection</span> <span class="o">=</span> <span class="n">NeighborFieldCells</span><span class="p">(</span><span class="n">DirectionCounter</span><span class="p">)</span>
<a name="ln-5530"></a>        <span class="k">CALL </span><span class="n">EvaluateNeighborCharacteristics</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">CurDirection</span><span class="p">,</span> <span class="n">NeighborTemp</span><span class="p">,</span> <span class="n">Resistance</span><span class="p">)</span>
<a name="ln-5531"></a>        <span class="n">Numerator</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span><span class="p">)</span> <span class="o">*</span> <span class="n">NeighborTemp</span>
<a name="ln-5532"></a>        <span class="n">Denominator</span> <span class="o">=</span> <span class="n">Denominator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span><span class="p">)</span>
<a name="ln-5533"></a>    <span class="k">END DO</span>
<a name="ln-5534"></a>
<a name="ln-5535"></a>    <span class="c">!Then all farfield boundaries</span>
<a name="ln-5536"></a>    <span class="k">DO </span><span class="n">DirectionCounter</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">NeighborBoundaryCells</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">NeighborBoundaryCells</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5537"></a>        <span class="n">CurDirection</span> <span class="o">=</span> <span class="n">NeighborBoundaryCells</span><span class="p">(</span><span class="n">DirectionCounter</span><span class="p">)</span>
<a name="ln-5538"></a>        <span class="k">CALL </span><span class="n">EvaluateFarfieldCharacteristics</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">CurDirection</span><span class="p">,</span> <span class="n">NeighborTemp</span><span class="p">,</span> <span class="n">Resistance</span><span class="p">)</span>
<a name="ln-5539"></a>        <span class="n">Numerator</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span><span class="p">)</span> <span class="o">*</span> <span class="n">NeighborTemp</span>
<a name="ln-5540"></a>        <span class="n">Denominator</span> <span class="o">=</span> <span class="n">Denominator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span><span class="p">)</span>
<a name="ln-5541"></a>    <span class="k">END DO</span>
<a name="ln-5542"></a>
<a name="ln-5543"></a><span class="k">    </span><span class="n">RetVal</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">/</span> <span class="n">Denominator</span>
<a name="ln-5544"></a>
<a name="ln-5545"></a>    <span class="k">RETURN</span>
<a name="ln-5546"></a>
<a name="ln-5547"></a><span class="k">END FUNCTION</span>
<a name="ln-5548"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-5549"></a>
<a name="ln-5550"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-5551"></a><span class="k">SUBROUTINE </span><span class="n">EvaluateFarfieldCharacteristics</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="n">neighbortemp</span><span class="p">,</span> <span class="n">resistance</span><span class="p">)</span>
<a name="ln-5552"></a>
<a name="ln-5553"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5554"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-5555"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-5556"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5557"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5558"></a>
<a name="ln-5559"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5560"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-5561"></a>
<a name="ln-5562"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5563"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-5564"></a>
<a name="ln-5565"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5566"></a>          <span class="c">! na</span>
<a name="ln-5567"></a>
<a name="ln-5568"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5569"></a>          <span class="c">! na</span>
<a name="ln-5570"></a>
<a name="ln-5571"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5572"></a>
<a name="ln-5573"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5574"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DomainNum</span>
<a name="ln-5575"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">CartesianCell</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cell</span>
<a name="ln-5576"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">direction</span>
<a name="ln-5577"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">neighbortemp</span>
<a name="ln-5578"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">resistance</span>
<a name="ln-5579"></a>
<a name="ln-5580"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5581"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">distance</span>
<a name="ln-5582"></a>
<a name="ln-5583"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">direction</span><span class="p">)</span>
<a name="ln-5584"></a>    <span class="k">CASE</span><span class="p">(</span><span class="n">Direction_NegativeX</span><span class="p">,</span> <span class="n">Direction_PositiveX</span><span class="p">)</span>
<a name="ln-5585"></a>        <span class="n">distance</span> <span class="o">=</span> <span class="p">(</span><span class="n">width</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0d0</span><span class="p">)</span>
<a name="ln-5586"></a>    <span class="k">CASE</span><span class="p">(</span><span class="n">Direction_NegativeY</span><span class="p">,</span> <span class="n">Direction_PositiveY</span><span class="p">)</span>
<a name="ln-5587"></a>        <span class="n">distance</span> <span class="o">=</span> <span class="p">(</span><span class="n">height</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0d0</span><span class="p">)</span>
<a name="ln-5588"></a>    <span class="k">CASE</span><span class="p">(</span><span class="n">Direction_NegativeZ</span><span class="p">,</span> <span class="n">Direction_PositiveZ</span><span class="p">)</span>
<a name="ln-5589"></a>        <span class="n">distance</span> <span class="o">=</span> <span class="p">(</span><span class="n">depth</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0d0</span><span class="p">)</span>
<a name="ln-5590"></a>    <span class="k">END SELECT</span>
<a name="ln-5591"></a>
<a name="ln-5592"></a><span class="k">    </span><span class="n">resistance</span> <span class="o">=</span> <span class="p">(</span><span class="n">distance</span> <span class="o">/</span> <span class="mf">2.0d0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">cell</span><span class="p">%</span><span class="n">mybase</span><span class="p">%</span><span class="n">properties</span><span class="p">%</span><span class="n">conductivity</span> <span class="o">*</span> <span class="n">NormalArea</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">direction</span><span class="p">))</span>
<a name="ln-5593"></a>    <span class="n">neighbortemp</span> <span class="o">=</span> <span class="n">GetFarfieldTemp</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">cell</span><span class="p">)</span>
<a name="ln-5594"></a>
<a name="ln-5595"></a>    <span class="k">RETURN</span>
<a name="ln-5596"></a>
<a name="ln-5597"></a><span class="k">END SUBROUTINE</span>
<a name="ln-5598"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-5599"></a>
<a name="ln-5600"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-5601"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">GetFarfieldTemp</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">cell</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">RetVal</span><span class="p">)</span>
<a name="ln-5602"></a>
<a name="ln-5603"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-5604"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-5605"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-5606"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5607"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5608"></a>
<a name="ln-5609"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-5610"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-5611"></a>
<a name="ln-5612"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5613"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-5614"></a>
<a name="ln-5615"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5616"></a>          <span class="c">! na</span>
<a name="ln-5617"></a>
<a name="ln-5618"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5619"></a>    <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SecsInDay</span>
<a name="ln-5620"></a>
<a name="ln-5621"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5622"></a>
<a name="ln-5623"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-5624"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DomainNum</span>
<a name="ln-5625"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">CartesianCell</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cell</span>
<a name="ln-5626"></a>
<a name="ln-5627"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5628"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">z</span>
<a name="ln-5629"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Term1</span>
<a name="ln-5630"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Term2</span>
<a name="ln-5631"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Diffusivity</span>
<a name="ln-5632"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SecondsInYear</span>
<a name="ln-5633"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">KATemp</span>
<a name="ln-5634"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">KAAmp</span>
<a name="ln-5635"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">KAPhase</span>
<a name="ln-5636"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CurTime</span>
<a name="ln-5637"></a>
<a name="ln-5638"></a>    <span class="n">KATemp</span>  <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Farfield</span><span class="p">%</span><span class="n">AverageGroundTemperature</span>
<a name="ln-5639"></a>    <span class="n">KAAmp</span>   <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Farfield</span><span class="p">%</span><span class="n">AverageGroundTemperatureAmplitude</span>
<a name="ln-5640"></a>    <span class="n">KAPhase</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Farfield</span><span class="p">%</span><span class="n">PhaseShiftOfMinGroundTemp</span>
<a name="ln-5641"></a>    <span class="n">CurTime</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cur</span><span class="p">%</span><span class="n">CurSimTimeSeconds</span>
<a name="ln-5642"></a>
<a name="ln-5643"></a>    <span class="n">SecondsInYear</span> <span class="o">=</span> <span class="n">SecsInDay</span> <span class="o">*</span> <span class="mi">36</span><span class="mf">5.0d0</span>
<a name="ln-5644"></a>    <span class="n">z</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Extents</span><span class="p">%</span><span class="n">Ymax</span> <span class="o">-</span> <span class="n">cell</span><span class="p">%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">Y</span>
<a name="ln-5645"></a>    <span class="n">Diffusivity</span> <span class="o">=</span> <span class="n">BaseThermalPropertySet_Diffusivity</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">GroundProperties</span><span class="p">)</span>
<a name="ln-5646"></a>
<a name="ln-5647"></a>    <span class="n">Term1</span> <span class="o">=</span> <span class="o">-</span><span class="n">z</span> <span class="o">*</span> <span class="nb">SQRT</span><span class="p">(</span><span class="n">PI</span> <span class="o">/</span> <span class="p">(</span><span class="n">SecondsInYear</span> <span class="o">*</span> <span class="n">Diffusivity</span><span class="p">))</span>
<a name="ln-5648"></a>    <span class="n">Term2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">PI</span> <span class="o">/</span> <span class="n">SecondsInYear</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">CurTime</span> <span class="o">-</span> <span class="n">KAPhase</span> <span class="o">-</span> <span class="p">(</span><span class="n">z</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="nb">SQRT</span><span class="p">(</span><span class="n">SecondsInYear</span> <span class="o">/</span> <span class="p">(</span><span class="n">PI</span> <span class="o">*</span> <span class="n">Diffusivity</span><span class="p">)))</span>
<a name="ln-5649"></a>    <span class="n">RetVal</span> <span class="o">=</span> <span class="n">KATemp</span> <span class="o">-</span> <span class="n">KAAmp</span> <span class="o">*</span> <span class="nb">EXP</span><span class="p">(</span><span class="n">Term1</span><span class="p">)</span> <span class="o">*</span> <span class="nb">COS</span><span class="p">(</span><span class="n">Term2</span><span class="p">)</span>
<a name="ln-5650"></a>
<a name="ln-5651"></a>    <span class="k">RETURN</span>
<a name="ln-5652"></a>
<a name="ln-5653"></a><span class="k">END FUNCTION</span>
<a name="ln-5654"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-5655"></a>
<a name="ln-5656"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-5657"></a><span class="k">SUBROUTINE </span><span class="n">PreparePipeCircuitSimulation</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">CircuitNum</span><span class="p">)</span>
<a name="ln-5658"></a>
<a name="ln-5659"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5660"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-5661"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-5662"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5663"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5664"></a>
<a name="ln-5665"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5666"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-5667"></a>
<a name="ln-5668"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5669"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-5670"></a>
<a name="ln-5671"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5672"></a>          <span class="c">! na</span>
<a name="ln-5673"></a>
<a name="ln-5674"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5675"></a>          <span class="c">! na</span>
<a name="ln-5676"></a>
<a name="ln-5677"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5678"></a>
<a name="ln-5679"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5680"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DomainNum</span>
<a name="ln-5681"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CircuitNum</span>
<a name="ln-5682"></a>
<a name="ln-5683"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5684"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">StagnantFluidConvCoeff</span> <span class="o">=</span> <span class="mi">20</span><span class="mf">0.0d0</span>
<a name="ln-5685"></a>
<a name="ln-5686"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5687"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Density</span>
<a name="ln-5688"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Viscosity</span>
<a name="ln-5689"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Conductivity</span>
<a name="ln-5690"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Prandtl</span>
<a name="ln-5691"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Area_c</span>
<a name="ln-5692"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Velocity</span>
<a name="ln-5693"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ConvCoefficient</span>
<a name="ln-5694"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Reynolds</span>
<a name="ln-5695"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ExponentTerm</span>
<a name="ln-5696"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Nusselt</span>
<a name="ln-5697"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SpecificHeat</span>
<a name="ln-5698"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CellX</span>
<a name="ln-5699"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CellY</span>
<a name="ln-5700"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CellZ</span>
<a name="ln-5701"></a>
<a name="ln-5702"></a>    <span class="c">!Setup circuit flow conditions -- convection coefficient</span>
<a name="ln-5703"></a>    <span class="n">CellX</span> <span class="o">=</span> <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">CircuitInletCell</span><span class="p">%</span><span class="n">X</span>
<a name="ln-5704"></a>    <span class="n">CellY</span> <span class="o">=</span> <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">CircuitInletCell</span><span class="p">%</span><span class="n">Y</span>
<a name="ln-5705"></a>    <span class="n">CellZ</span> <span class="o">=</span> <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">CircuitInletCell</span><span class="p">%</span><span class="n">Z</span>
<a name="ln-5706"></a>
<a name="ln-5707"></a>    <span class="c">!Look up current fluid properties</span>
<a name="ln-5708"></a>    <span class="n">Density</span> <span class="o">=</span> <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">CurFluidPropertySet</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Density</span>
<a name="ln-5709"></a>    <span class="n">Viscosity</span> <span class="o">=</span> <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">CurFluidPropertySet</span><span class="p">%</span><span class="n">Viscosity</span>
<a name="ln-5710"></a>    <span class="n">Conductivity</span> <span class="o">=</span> <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">CurFluidPropertySet</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Conductivity</span>
<a name="ln-5711"></a>    <span class="n">Prandtl</span> <span class="o">=</span> <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">CurFluidPropertySet</span><span class="p">%</span><span class="n">Prandtl</span>
<a name="ln-5712"></a>    <span class="n">SpecificHeat</span> <span class="o">=</span> <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">CurFluidPropertySet</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">SpecificHeat</span>
<a name="ln-5713"></a>
<a name="ln-5714"></a>    <span class="c">!Flow calculations</span>
<a name="ln-5715"></a>    <span class="n">Area_c</span> <span class="o">=</span> <span class="p">(</span><span class="n">Pi</span><span class="o">/</span><span class="mf">4.0d0</span><span class="p">)</span> <span class="o">*</span> <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">PipeSize</span><span class="p">%</span><span class="n">InnerDia</span><span class="o">**</span><span class="mi">2</span>
<a name="ln-5716"></a>    <span class="n">Velocity</span> <span class="o">=</span> <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">CurCircuitFlowRate</span> <span class="o">/</span> <span class="p">(</span><span class="n">Density</span> <span class="o">*</span> <span class="n">Area_c</span><span class="p">)</span>
<a name="ln-5717"></a>
<a name="ln-5718"></a>    <span class="c">!Determine convection coefficient based on flow conditions</span>
<a name="ln-5719"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Velocity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5720"></a><span class="k">        </span><span class="n">Reynolds</span> <span class="o">=</span> <span class="n">Density</span> <span class="o">*</span> <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">PipeSize</span><span class="p">%</span><span class="n">InnerDia</span> <span class="o">*</span> <span class="n">Velocity</span> <span class="o">/</span> <span class="n">Viscosity</span>
<a name="ln-5721"></a>        <span class="k">IF</span> <span class="p">(</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">CellX</span><span class="p">,</span> <span class="n">CellY</span><span class="p">,</span> <span class="n">CellZ</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Fluid</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span> <span class="o">&gt;</span> <span class="p">&amp;</span>
<a name="ln-5722"></a>               <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">CellX</span><span class="p">,</span> <span class="n">CellY</span><span class="p">,</span> <span class="n">CellZ</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Pipe</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5723"></a><span class="k">            </span><span class="n">ExponentTerm</span> <span class="o">=</span> <span class="mf">0.3d0</span>
<a name="ln-5724"></a>        <span class="k">ELSE</span>
<a name="ln-5725"></a><span class="k">            </span><span class="n">ExponentTerm</span> <span class="o">=</span> <span class="mf">0.4d0</span>
<a name="ln-5726"></a>        <span class="k">END IF</span>
<a name="ln-5727"></a><span class="k">        </span><span class="n">Nusselt</span> <span class="o">=</span> <span class="mf">0.023d0</span> <span class="o">*</span> <span class="n">Reynolds</span><span class="o">**</span><span class="p">(</span><span class="mf">4.0d0</span><span class="o">/</span><span class="mf">5.0d0</span><span class="p">)</span> <span class="o">*</span> <span class="n">Prandtl</span><span class="o">**</span><span class="n">ExponentTerm</span>
<a name="ln-5728"></a>        <span class="n">ConvCoefficient</span> <span class="o">=</span> <span class="n">Nusselt</span> <span class="o">*</span> <span class="n">Conductivity</span> <span class="o">/</span> <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">PipeSize</span><span class="p">%</span><span class="n">InnerDia</span>
<a name="ln-5729"></a>    <span class="k">ELSE</span>
<a name="ln-5730"></a><span class="k">        </span><span class="n">ConvCoefficient</span> <span class="o">=</span> <span class="n">StagnantFluidConvCoeff</span>
<a name="ln-5731"></a>    <span class="k">END IF</span>
<a name="ln-5732"></a>
<a name="ln-5733"></a>    <span class="c">!Assign the convection coefficient</span>
<a name="ln-5734"></a>    <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">CurCircuitConvectionCoefficient</span> <span class="o">=</span> <span class="n">ConvCoefficient</span>
<a name="ln-5735"></a>
<a name="ln-5736"></a>    <span class="k">RETURN</span>
<a name="ln-5737"></a>
<a name="ln-5738"></a><span class="k">END SUBROUTINE</span>
<a name="ln-5739"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-5740"></a>
<a name="ln-5741"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-5742"></a><span class="k">SUBROUTINE </span><span class="n">PerformPipeCircuitSimulation</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">CircuitNum</span><span class="p">)</span>
<a name="ln-5743"></a>
<a name="ln-5744"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5745"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-5746"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-5747"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5748"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5749"></a>
<a name="ln-5750"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5751"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-5752"></a>
<a name="ln-5753"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5754"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-5755"></a>
<a name="ln-5756"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5757"></a>          <span class="c">! na</span>
<a name="ln-5758"></a>
<a name="ln-5759"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5760"></a>    <span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ShowFatalError</span>
<a name="ln-5761"></a>
<a name="ln-5762"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5763"></a>
<a name="ln-5764"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5765"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DomainNum</span>
<a name="ln-5766"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CircuitNum</span>
<a name="ln-5767"></a>
<a name="ln-5768"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5769"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CircuitCrossTemp</span>
<a name="ln-5770"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FlowRate</span>
<a name="ln-5771"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EnteringTemp</span>
<a name="ln-5772"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SegmentCtr</span>
<a name="ln-5773"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SegmentCellCtr</span>
<a name="ln-5774"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">StartingSegment</span>
<a name="ln-5775"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">EndingSegment</span>
<a name="ln-5776"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">StartingZ</span>
<a name="ln-5777"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">EndingZ</span>
<a name="ln-5778"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Increment</span>
<a name="ln-5779"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">PipeX</span>
<a name="ln-5780"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">PipeY</span>
<a name="ln-5781"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Zindex</span>
<a name="ln-5782"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SegmentIndex</span>
<a name="ln-5783"></a>
<a name="ln-5784"></a>    <span class="c">!retrieve initial conditions from the data structure</span>
<a name="ln-5785"></a>    <span class="c">!these have been set either by the init routine or by the heat pump routine</span>
<a name="ln-5786"></a>    <span class="n">FlowRate</span> <span class="o">=</span> <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">CurCircuitFlowRate</span>
<a name="ln-5787"></a>    <span class="n">EnteringTemp</span> <span class="o">=</span> <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">CurCircuitInletTemp</span>
<a name="ln-5788"></a>
<a name="ln-5789"></a>    <span class="c">!initialize</span>
<a name="ln-5790"></a>    <span class="n">SegmentCellCtr</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5791"></a>    <span class="n">StartingSegment</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">PipeSegmentIndeces</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5792"></a>    <span class="n">EndingSegment</span> <span class="o">=</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">PipeSegmentIndeces</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5793"></a>
<a name="ln-5794"></a>    <span class="c">!&#39;loop across all segments (pipes) of the circuit</span>
<a name="ln-5795"></a>    <span class="k">DO </span><span class="n">SegmentCtr</span> <span class="o">=</span> <span class="n">StartingSegment</span><span class="p">,</span> <span class="n">EndingSegment</span>
<a name="ln-5796"></a>
<a name="ln-5797"></a>        <span class="n">SegmentIndex</span> <span class="o">=</span> <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">PipeSegmentIndeces</span><span class="p">(</span><span class="n">SegmentCtr</span><span class="p">)</span>
<a name="ln-5798"></a>
<a name="ln-5799"></a>        <span class="c">!&#39;set simulation flow direction</span>
<a name="ln-5800"></a>        <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">SegmentIndex</span><span class="p">)%</span><span class="n">FlowDirection</span><span class="p">)</span>
<a name="ln-5801"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">SegmentFlow_IncreasingZ</span><span class="p">)</span>
<a name="ln-5802"></a>            <span class="n">StartingZ</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5803"></a>            <span class="n">EndingZ</span> <span class="o">=</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a name="ln-5804"></a>            <span class="n">Increment</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-5805"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">SegmentFlow_DecreasingZ</span><span class="p">)</span>
<a name="ln-5806"></a>            <span class="n">StartingZ</span> <span class="o">=</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a name="ln-5807"></a>            <span class="n">EndingZ</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5808"></a>            <span class="n">Increment</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-5809"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-5810"></a>            <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Debug error: invalid flow direction on piping system segment&#39;</span><span class="p">)</span>
<a name="ln-5811"></a>        <span class="k">END SELECT</span>
<a name="ln-5812"></a>
<a name="ln-5813"></a>        <span class="c">!&#39;find the cell we are working on in order to retrieve cell and neighbor information</span>
<a name="ln-5814"></a>        <span class="n">PipeX</span> <span class="o">=</span> <span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">SegmentIndex</span><span class="p">)%</span><span class="n">PipeCellCoordinates</span><span class="p">%</span><span class="n">X</span>
<a name="ln-5815"></a>        <span class="n">PipeY</span> <span class="o">=</span> <span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">SegmentIndex</span><span class="p">)%</span><span class="n">PipeCellCoordinates</span><span class="p">%</span><span class="n">Y</span>
<a name="ln-5816"></a>
<a name="ln-5817"></a>        <span class="c">!&#39;loop across all z-direction indeces</span>
<a name="ln-5818"></a>        <span class="k">DO </span><span class="n">Zindex</span> <span class="o">=</span> <span class="n">StartingZ</span><span class="p">,</span> <span class="n">EndingZ</span><span class="p">,</span> <span class="n">Increment</span>
<a name="ln-5819"></a>
<a name="ln-5820"></a>            <span class="c">!&#39;overall cell segment counter</span>
<a name="ln-5821"></a>            <span class="n">SegmentCellCtr</span> <span class="o">=</span> <span class="n">SegmentCellCtr</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-5822"></a>
<a name="ln-5823"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">SegmentCellCtr</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5824"></a>                <span class="c">!&#39;we have the very first cell, need to pass in circuiting entering temperature</span>
<a name="ln-5825"></a>                <span class="k">CALL </span><span class="n">PerformPipeCellSimulation</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5826"></a>                                               <span class="n">CircuitNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5827"></a>                                               <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">PipeX</span><span class="p">,</span> <span class="n">PipeY</span><span class="p">,</span> <span class="n">Zindex</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-5828"></a>                                               <span class="n">FlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5829"></a>                                               <span class="n">EnteringTemp</span><span class="p">)</span>
<a name="ln-5830"></a>            <span class="k">ELSE</span>
<a name="ln-5831"></a>                <span class="c">!&#39;we don&#39;t have the first cell so just normal simulation</span>
<a name="ln-5832"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">Zindex</span> <span class="o">==</span> <span class="n">EndingZ</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5833"></a>                    <span class="c">!simulate current cell using upstream as entering conditions</span>
<a name="ln-5834"></a>                    <span class="k">CALL </span><span class="n">PerformPipeCellSimulation</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5835"></a>                          <span class="n">CircuitNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5836"></a>                          <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">PipeX</span><span class="p">,</span> <span class="n">PipeY</span><span class="p">,</span> <span class="n">Zindex</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-5837"></a>                          <span class="n">FlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5838"></a>                          <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">PipeX</span><span class="p">,</span><span class="n">PipeY</span><span class="p">,</span><span class="n">Zindex</span><span class="o">-</span><span class="n">Increment</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Fluid</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span><span class="p">)</span>
<a name="ln-5839"></a>                    <span class="c">!store this outlet condition to be passed to the next segment</span>
<a name="ln-5840"></a>                    <span class="n">CircuitCrossTemp</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5841"></a>                            <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">PipeX</span><span class="p">,</span> <span class="n">PipeY</span><span class="p">,</span> <span class="n">Zindex</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Fluid</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span>
<a name="ln-5842"></a>                <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Zindex</span> <span class="o">==</span> <span class="n">StartingZ</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5843"></a>                    <span class="c">!we are starting another segment, use the previous cross temperature</span>
<a name="ln-5844"></a>                    <span class="k">CALL </span><span class="n">PerformPipeCellSimulation</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5845"></a>                                                   <span class="n">CircuitNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5846"></a>                                                   <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">PipeX</span><span class="p">,</span> <span class="n">PipeY</span><span class="p">,</span> <span class="n">Zindex</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-5847"></a>                                                   <span class="n">FlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5848"></a>                                                   <span class="n">CircuitCrossTemp</span><span class="p">)</span>
<a name="ln-5849"></a>                <span class="k">ELSE</span>
<a name="ln-5850"></a>                    <span class="c">!we are in an interior node, so just get the upstream cell and use the main simulation</span>
<a name="ln-5851"></a>                    <span class="k">CALL </span><span class="n">PerformPipeCellSimulation</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5852"></a>                          <span class="n">CircuitNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5853"></a>                          <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">PipeX</span><span class="p">,</span> <span class="n">PipeY</span><span class="p">,</span> <span class="n">Zindex</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-5854"></a>                          <span class="n">FlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5855"></a>                          <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">PipeX</span><span class="p">,</span><span class="n">PipeY</span><span class="p">,</span><span class="n">Zindex</span><span class="o">-</span><span class="n">Increment</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Fluid</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span><span class="p">)</span>
<a name="ln-5856"></a>                <span class="k">END IF</span>
<a name="ln-5857"></a><span class="k">            END IF</span>
<a name="ln-5858"></a>
<a name="ln-5859"></a>            <span class="c">!Bookkeeping: segment fluid temperature updates</span>
<a name="ln-5860"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">Zindex</span> <span class="o">==</span> <span class="n">StartingZ</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5861"></a><span class="k">                IF</span> <span class="p">(</span><span class="n">SegmentCtr</span> <span class="o">==</span> <span class="n">StartingSegment</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5862"></a><span class="k">                    </span><span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">SegmentIndex</span><span class="p">)%</span><span class="n">InletTemperature</span> <span class="o">=</span> <span class="n">EnteringTemp</span>
<a name="ln-5863"></a>                <span class="k">ELSE</span>
<a name="ln-5864"></a><span class="k">                    </span><span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">SegmentIndex</span><span class="p">)%</span><span class="n">InletTemperature</span> <span class="o">=</span> <span class="n">CircuitCrossTemp</span>
<a name="ln-5865"></a>                <span class="k">END IF</span>
<a name="ln-5866"></a><span class="k">            </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Zindex</span> <span class="o">==</span> <span class="n">EndingZ</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5867"></a><span class="k">                </span><span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">SegmentIndex</span><span class="p">)%</span><span class="n">OutletTemperature</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5868"></a>                       <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">PipeX</span><span class="p">,</span> <span class="n">PipeY</span><span class="p">,</span> <span class="n">Zindex</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Fluid</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span>
<a name="ln-5869"></a>                <span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">SegmentIndex</span><span class="p">)%</span><span class="n">FluidHeatLoss</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5870"></a>                       <span class="n">FlowRate</span> <span class="o">*</span> <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">CurFluidPropertySet</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">SpecificHeat</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-5871"></a>                       <span class="p">(</span><span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">SegmentIndex</span><span class="p">)%</span><span class="n">InletTemperature</span> <span class="o">-</span> <span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">SegmentIndex</span><span class="p">)%</span><span class="n">OutletTemperature</span><span class="p">)</span>
<a name="ln-5872"></a>            <span class="k">END IF</span>
<a name="ln-5873"></a>
<a name="ln-5874"></a>            <span class="c">!Bookkeeping: circuit fluid temperature updates</span>
<a name="ln-5875"></a>            <span class="k">IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">SegmentCtr</span> <span class="o">==</span> <span class="n">StartingSegment</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Zindex</span> <span class="o">==</span> <span class="n">StartingZ</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5876"></a><span class="k">                </span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">InletTemperature</span> <span class="o">=</span> <span class="n">EnteringTemp</span>
<a name="ln-5877"></a>            <span class="n">ELSEIF</span> <span class="p">(</span> <span class="p">(</span><span class="n">SegmentCtr</span> <span class="o">==</span> <span class="n">EndingSegment</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Zindex</span> <span class="o">==</span> <span class="n">EndingZ</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5878"></a><span class="k">                </span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">OutletTemperature</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5879"></a>                            <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">PipeX</span><span class="p">,</span> <span class="n">PipeY</span><span class="p">,</span> <span class="n">Zindex</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Fluid</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span>
<a name="ln-5880"></a>                <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">FluidHeatLoss</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5881"></a>                       <span class="n">FlowRate</span> <span class="o">*</span> <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">CurFluidPropertySet</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">SpecificHeat</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-5882"></a>                       <span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">InletTemperature</span> <span class="o">-</span> <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">OutletTemperature</span><span class="p">)</span>
<a name="ln-5883"></a>            <span class="k">END IF</span>
<a name="ln-5884"></a>
<a name="ln-5885"></a><span class="k">        END DO</span>
<a name="ln-5886"></a>
<a name="ln-5887"></a><span class="k">    END DO</span>
<a name="ln-5888"></a>
<a name="ln-5889"></a><span class="k">    RETURN</span>
<a name="ln-5890"></a>
<a name="ln-5891"></a><span class="k">END SUBROUTINE</span>
<a name="ln-5892"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-5893"></a>
<a name="ln-5894"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-5895"></a><span class="k">SUBROUTINE </span><span class="n">PerformPipeCellSimulation</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">CircuitNum</span><span class="p">,</span> <span class="n">ThisCell</span><span class="p">,</span> <span class="n">FlowRate</span><span class="p">,</span> <span class="n">EnteringTemp</span><span class="p">)</span>
<a name="ln-5896"></a>
<a name="ln-5897"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5898"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-5899"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-5900"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5901"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5902"></a>
<a name="ln-5903"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5904"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-5905"></a>
<a name="ln-5906"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5907"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-5908"></a>
<a name="ln-5909"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5910"></a>          <span class="c">! na</span>
<a name="ln-5911"></a>
<a name="ln-5912"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5913"></a>          <span class="c">! na</span>
<a name="ln-5914"></a>
<a name="ln-5915"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5916"></a>
<a name="ln-5917"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5918"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DomainNum</span>
<a name="ln-5919"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CircuitNum</span>
<a name="ln-5920"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">CartesianCell</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span> <span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisCell</span>
<a name="ln-5921"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FlowRate</span>
<a name="ln-5922"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EnteringTemp</span>
<a name="ln-5923"></a>
<a name="ln-5924"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5925"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Iter</span>
<a name="ln-5926"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MaxDeviationAmount</span>
<a name="ln-5927"></a>
<a name="ln-5928"></a>    <span class="k">DO </span><span class="n">Iter</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">MaxIterationsPerTS</span>
<a name="ln-5929"></a>
<a name="ln-5930"></a>        <span class="c">!&#39;shift all the pipe related temperatures for the next internal pipe iteration</span>
<a name="ln-5931"></a>        <span class="k">CALL </span><span class="n">ShiftPipeTemperaturesForNewIteration</span><span class="p">(</span><span class="n">ThisCell</span><span class="p">)</span>
<a name="ln-5932"></a>
<a name="ln-5933"></a>        <span class="c">!&#39;simulate the funny interface soil cell between the radial and cartesian systems</span>
<a name="ln-5934"></a>        <span class="k">CALL </span><span class="n">SimulateRadialToCartesianInterface</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">ThisCell</span><span class="p">)</span>
<a name="ln-5935"></a>
<a name="ln-5936"></a>        <span class="c">!&#39;simulate the outermost radial slice</span>
<a name="ln-5937"></a>        <span class="k">CALL </span><span class="n">SimulateOuterMostRadialSoilSlice</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">CircuitNum</span><span class="p">,</span> <span class="n">ThisCell</span><span class="p">)</span>
<a name="ln-5938"></a>
<a name="ln-5939"></a>        <span class="c">!&#39;we only need to simulate these if they actually exist!</span>
<a name="ln-5940"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SIZE</span><span class="p">(</span><span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5941"></a>
<a name="ln-5942"></a>            <span class="c">!&#39;simulate all interior radial slices</span>
<a name="ln-5943"></a>            <span class="k">CALL </span><span class="n">SimulateAllInteriorRadialSoilSlices</span><span class="p">(</span><span class="n">ThisCell</span><span class="p">)</span>
<a name="ln-5944"></a>
<a name="ln-5945"></a>            <span class="c">!&#39;simulate the innermost radial soil slice</span>
<a name="ln-5946"></a>            <span class="k">CALL </span><span class="n">SimulateInnerMostRadialSoilSlice</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">CircuitNum</span><span class="p">,</span> <span class="n">ThisCell</span><span class="p">)</span>
<a name="ln-5947"></a>
<a name="ln-5948"></a>        <span class="k">END IF</span>
<a name="ln-5949"></a>
<a name="ln-5950"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">HasInsulation</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5951"></a><span class="k">            CALL </span><span class="n">SimulateRadialInsulationCell</span><span class="p">(</span><span class="n">ThisCell</span><span class="p">)</span>
<a name="ln-5952"></a>        <span class="k">END IF</span>
<a name="ln-5953"></a>
<a name="ln-5954"></a>        <span class="c">!&#39;simulate the pipe cell</span>
<a name="ln-5955"></a>        <span class="k">CALL </span><span class="n">SimulateRadialPipeCell</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">CircuitNum</span><span class="p">,</span> <span class="n">ThisCell</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5956"></a>                                    <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">CurCircuitConvectionCoefficient</span><span class="p">)</span>
<a name="ln-5957"></a>
<a name="ln-5958"></a>        <span class="c">!&#39;simulate the water cell</span>
<a name="ln-5959"></a>        <span class="k">CALL </span><span class="n">SimulateFluidCell</span><span class="p">(</span><span class="n">ThisCell</span><span class="p">,</span> <span class="n">FlowRate</span><span class="p">,</span> <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">CurCircuitConvectionCoefficient</span><span class="p">,</span> <span class="n">EnteringTemp</span><span class="p">)</span>
<a name="ln-5960"></a>
<a name="ln-5961"></a>        <span class="c">!&#39;check convergence</span>
<a name="ln-5962"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsConverged_PipeCurrentToPrevIteration</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">ThisCell</span><span class="p">,</span> <span class="n">MaxDeviationAmount</span><span class="p">))</span> <span class="k">EXIT</span>
<a name="ln-5963"></a>
<a name="ln-5964"></a><span class="k">    END DO</span>
<a name="ln-5965"></a>
<a name="ln-5966"></a><span class="k">    RETURN</span>
<a name="ln-5967"></a>
<a name="ln-5968"></a><span class="k">END SUBROUTINE</span>
<a name="ln-5969"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-5970"></a>
<a name="ln-5971"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-5972"></a><span class="k">SUBROUTINE </span><span class="n">SimulateRadialToCartesianInterface</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">ThisCell</span><span class="p">)</span>
<a name="ln-5973"></a>
<a name="ln-5974"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5975"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-5976"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-5977"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5978"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5979"></a>
<a name="ln-5980"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5981"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-5982"></a>
<a name="ln-5983"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5984"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-5985"></a>
<a name="ln-5986"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5987"></a>          <span class="c">! na</span>
<a name="ln-5988"></a>
<a name="ln-5989"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5990"></a>          <span class="c">! na</span>
<a name="ln-5991"></a>
<a name="ln-5992"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5993"></a>
<a name="ln-5994"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5995"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DomainNum</span>
<a name="ln-5996"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">CartesianCell</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span> <span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisCell</span>
<a name="ln-5997"></a>
<a name="ln-5998"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-5999"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Directions</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">Direction_NegativeX</span><span class="p">,</span> <span class="n">Direction_NegativeY</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6000"></a>                                                       <span class="n">Direction_PositiveX</span><span class="p">,</span> <span class="n">Direction_PositiveY</span><span class="o">/</span><span class="p">)</span>
<a name="ln-6001"></a>
<a name="ln-6002"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6003"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Numerator</span>
<a name="ln-6004"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Denominator</span>
<a name="ln-6005"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Resistance</span>
<a name="ln-6006"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Beta</span>
<a name="ln-6007"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DirCtr</span>
<a name="ln-6008"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Dir</span>
<a name="ln-6009"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NeighborTemp</span>
<a name="ln-6010"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutermostRadialCellOuterRadius</span>
<a name="ln-6011"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutermostRadialCellRadialCentroid</span>
<a name="ln-6012"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutermostRadialCellTemperature</span>
<a name="ln-6013"></a>
<a name="ln-6014"></a>    <span class="n">Numerator</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6015"></a>    <span class="n">Denominator</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6016"></a>
<a name="ln-6017"></a>    <span class="c">!&#39;retrieve beta</span>
<a name="ln-6018"></a>    <span class="n">Beta</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Beta</span>
<a name="ln-6019"></a>
<a name="ln-6020"></a>    <span class="c">!&#39;add effects from this cell history</span>
<a name="ln-6021"></a>    <span class="n">Numerator</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">+</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature_PrevTimeStep</span>
<a name="ln-6022"></a>    <span class="n">Denominator</span> <span class="o">=</span> <span class="n">Denominator</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-6023"></a>
<a name="ln-6024"></a>    <span class="c">!&#39;add effects from outermost radial cell</span>
<a name="ln-6025"></a>    <span class="n">OutermostRadialCellOuterRadius</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="nb">UBOUND</span><span class="p">(</span><span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">,</span><span class="mi">1</span><span class="p">))%</span><span class="n">OuterRadius</span>
<a name="ln-6026"></a>    <span class="n">OutermostRadialCellRadialCentroid</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="nb">UBOUND</span><span class="p">(</span><span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">,</span><span class="mi">1</span><span class="p">))%</span><span class="n">RadialCentroid</span>
<a name="ln-6027"></a>    <span class="n">OutermostRadialCellTemperature</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="nb">UBOUND</span><span class="p">(</span><span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">,</span><span class="mi">1</span><span class="p">))%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span>
<a name="ln-6028"></a>    <span class="n">Resistance</span> <span class="o">=</span> <span class="nb">LOG</span><span class="p">(</span><span class="n">OutermostRadialCellOuterRadius</span> <span class="o">/</span> <span class="n">OutermostRadialCellRadialCentroid</span><span class="p">)</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-6029"></a>                 <span class="p">(</span><span class="mf">2.0d0</span> <span class="o">*</span> <span class="n">Pi</span> <span class="o">*</span> <span class="n">Depth</span><span class="p">(</span><span class="n">ThisCell</span><span class="p">)</span> <span class="o">*</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Properties</span><span class="p">%</span><span class="n">Conductivity</span><span class="p">)</span>
<a name="ln-6030"></a>    <span class="n">Numerator</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span><span class="p">)</span> <span class="o">*</span> <span class="n">OutermostRadialCellTemperature</span>
<a name="ln-6031"></a>    <span class="n">Denominator</span> <span class="o">=</span> <span class="n">Denominator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span><span class="p">)</span>
<a name="ln-6032"></a>
<a name="ln-6033"></a>    <span class="c">!&#39;add effects from neighboring Cartesian cells</span>
<a name="ln-6034"></a>    <span class="k">DO </span><span class="n">DirCtr</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">Directions</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">Directions</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-6035"></a>        <span class="n">Dir</span> <span class="o">=</span> <span class="n">Directions</span><span class="p">(</span><span class="n">DirCtr</span><span class="p">)</span>
<a name="ln-6036"></a>
<a name="ln-6037"></a>        <span class="c">!&#39;get info about cartesian neighbors</span>
<a name="ln-6038"></a>        <span class="k">CALL </span><span class="n">EvaluateNeighborCharacteristics</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">ThisCell</span><span class="p">,</span> <span class="n">Dir</span><span class="p">,</span> <span class="n">NeighborTemp</span><span class="p">,</span> <span class="n">Resistance</span><span class="p">)</span>
<a name="ln-6039"></a>
<a name="ln-6040"></a>        <span class="c">!&#39;add to the numerator and denominator expressions</span>
<a name="ln-6041"></a>        <span class="n">Numerator</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span><span class="p">)</span> <span class="o">*</span> <span class="n">NeighborTemp</span>
<a name="ln-6042"></a>        <span class="n">Denominator</span> <span class="o">=</span> <span class="n">Denominator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span><span class="p">)</span>
<a name="ln-6043"></a>
<a name="ln-6044"></a>    <span class="k">END DO</span>
<a name="ln-6045"></a>
<a name="ln-6046"></a>    <span class="c">!&#39;calculate the new temperature</span>
<a name="ln-6047"></a>    <span class="n">ThisCell</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">/</span> <span class="n">Denominator</span>
<a name="ln-6048"></a>
<a name="ln-6049"></a>    <span class="k">RETURN</span>
<a name="ln-6050"></a>
<a name="ln-6051"></a><span class="k">END SUBROUTINE</span>
<a name="ln-6052"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-6053"></a>
<a name="ln-6054"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-6055"></a><span class="k">SUBROUTINE </span><span class="n">SimulateOuterMostRadialSoilSlice</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">CircuitNum</span><span class="p">,</span> <span class="n">ThisCell</span><span class="p">)</span>
<a name="ln-6056"></a>
<a name="ln-6057"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6058"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-6059"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-6060"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6061"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6062"></a>
<a name="ln-6063"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6064"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-6065"></a>
<a name="ln-6066"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6067"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-6068"></a>
<a name="ln-6069"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6070"></a>          <span class="c">! na</span>
<a name="ln-6071"></a>
<a name="ln-6072"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6073"></a>          <span class="c">! na</span>
<a name="ln-6074"></a>
<a name="ln-6075"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6076"></a>
<a name="ln-6077"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6078"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DomainNum</span>
<a name="ln-6079"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CircuitNum</span>
<a name="ln-6080"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">CartesianCell</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span> <span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisCell</span>
<a name="ln-6081"></a>
<a name="ln-6082"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6083"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Numerator</span>
<a name="ln-6084"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Denominator</span>
<a name="ln-6085"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Resistance</span>
<a name="ln-6086"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Beta</span>
<a name="ln-6087"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MaxRadialIndex</span>
<a name="ln-6088"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisRadialCellOuterRadius</span>
<a name="ln-6089"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisRadialCellRadialCentroid</span>
<a name="ln-6090"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisRadialCellConductivity</span>
<a name="ln-6091"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisRadialCellInnerRadius</span>
<a name="ln-6092"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisRadialCellTemperature_PrevTimeStep</span>
<a name="ln-6093"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisRadialCellTemperature</span>
<a name="ln-6094"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NextOuterRadialCellOuterRadius</span>
<a name="ln-6095"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NextOuterRadialCellRadialCentroid</span>
<a name="ln-6096"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NextOuterRadialCellConductivity</span>
<a name="ln-6097"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NextOuterRadialCellInnerRadius</span>
<a name="ln-6098"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NextOuterRadialCellTemperature</span>
<a name="ln-6099"></a>
<a name="ln-6100"></a>    <span class="n">Numerator</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6101"></a>    <span class="n">Denominator</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6102"></a>    <span class="n">Resistance</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6103"></a>
<a name="ln-6104"></a>    <span class="c">!&#39;convenience variables</span>
<a name="ln-6105"></a>    <span class="n">MaxRadialIndex</span> <span class="o">=</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-6106"></a>    <span class="n">ThisRadialCellOuterRadius</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">MaxRadialIndex</span><span class="p">)%</span><span class="n">OuterRadius</span>
<a name="ln-6107"></a>    <span class="n">ThisRadialCellRadialCentroid</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">MaxRadialIndex</span><span class="p">)%</span><span class="n">RadialCentroid</span>
<a name="ln-6108"></a>    <span class="n">ThisRadialCellConductivity</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">MaxRadialIndex</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Properties</span><span class="p">%</span><span class="n">Conductivity</span>
<a name="ln-6109"></a>    <span class="n">ThisRadialCellInnerRadius</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">MaxRadialIndex</span><span class="p">)%</span><span class="n">InnerRadius</span>
<a name="ln-6110"></a>    <span class="n">ThisRadialCellTemperature_PrevTimeStep</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">MaxRadialIndex</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature_PrevTimeStep</span>
<a name="ln-6111"></a>    <span class="n">ThisRadialCellTemperature</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">MaxRadialIndex</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span>
<a name="ln-6112"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SIZE</span><span class="p">(</span><span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6113"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">HasInsulation</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6114"></a><span class="k">            </span><span class="n">NextOuterRadialCellOuterRadius</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Insulation</span><span class="p">%</span><span class="n">OuterRadius</span>
<a name="ln-6115"></a>            <span class="n">NextOuterRadialCellRadialCentroid</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Insulation</span><span class="p">%</span><span class="n">RadialCentroid</span>
<a name="ln-6116"></a>            <span class="n">NextOuterRadialCellConductivity</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Insulation</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Properties</span><span class="p">%</span><span class="n">Conductivity</span>
<a name="ln-6117"></a>            <span class="n">NextOuterRadialCellInnerRadius</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Insulation</span><span class="p">%</span><span class="n">InnerRadius</span>
<a name="ln-6118"></a>            <span class="n">NextOuterRadialCellTemperature</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Insulation</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span>
<a name="ln-6119"></a>        <span class="k">ELSE</span>
<a name="ln-6120"></a><span class="k">            </span><span class="n">NextOuterRadialCellOuterRadius</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Pipe</span><span class="p">%</span><span class="n">OuterRadius</span>
<a name="ln-6121"></a>            <span class="n">NextOuterRadialCellRadialCentroid</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Pipe</span><span class="p">%</span><span class="n">RadialCentroid</span>
<a name="ln-6122"></a>            <span class="n">NextOuterRadialCellConductivity</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Pipe</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Properties</span><span class="p">%</span><span class="n">Conductivity</span>
<a name="ln-6123"></a>            <span class="n">NextOuterRadialCellInnerRadius</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Pipe</span><span class="p">%</span><span class="n">InnerRadius</span>
<a name="ln-6124"></a>            <span class="n">NextOuterRadialCellTemperature</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Pipe</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span>
<a name="ln-6125"></a>        <span class="k">END IF</span>
<a name="ln-6126"></a><span class="k">    ELSE</span>
<a name="ln-6127"></a><span class="k">        </span><span class="n">NextOuterRadialCellOuterRadius</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">MaxRadialIndex</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)%</span><span class="n">OuterRadius</span>
<a name="ln-6128"></a>        <span class="n">NextOuterRadialCellRadialCentroid</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">MaxRadialIndex</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)%</span><span class="n">RadialCentroid</span>
<a name="ln-6129"></a>        <span class="n">NextOuterRadialCellConductivity</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">MaxRadialIndex</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Properties</span><span class="p">%</span><span class="n">Conductivity</span>
<a name="ln-6130"></a>        <span class="n">NextOuterRadialCellInnerRadius</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">MaxRadialIndex</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)%</span><span class="n">InnerRadius</span>
<a name="ln-6131"></a>        <span class="n">NextOuterRadialCellTemperature</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">MaxRadialIndex</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span>
<a name="ln-6132"></a>    <span class="k">END IF</span>
<a name="ln-6133"></a>
<a name="ln-6134"></a>    <span class="c">!&#39;any broadly defined variables</span>
<a name="ln-6135"></a>    <span class="n">Beta</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">MaxRadialIndex</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Beta</span>
<a name="ln-6136"></a>
<a name="ln-6137"></a>    <span class="c">!&#39;add effects from this cell history</span>
<a name="ln-6138"></a>    <span class="n">Numerator</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">+</span> <span class="n">ThisRadialCellTemperature_PrevTimeStep</span>
<a name="ln-6139"></a>    <span class="n">Denominator</span> <span class="o">=</span> <span class="n">Denominator</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-6140"></a>
<a name="ln-6141"></a>    <span class="c">!&#39;add effects from interface cell</span>
<a name="ln-6142"></a>    <span class="n">Resistance</span> <span class="o">=</span> <span class="nb">LOG</span><span class="p">(</span><span class="n">ThisRadialCellOuterRadius</span> <span class="o">/</span> <span class="n">ThisRadialCellRadialCentroid</span><span class="p">)</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-6143"></a>                    <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Pi</span> <span class="o">*</span> <span class="n">Depth</span><span class="p">(</span><span class="n">ThisCell</span><span class="p">)</span> <span class="o">*</span> <span class="n">ThisRadialCellConductivity</span><span class="p">)</span>
<a name="ln-6144"></a>    <span class="n">Numerator</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span><span class="p">)</span> <span class="o">*</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span>
<a name="ln-6145"></a>    <span class="n">Denominator</span> <span class="o">=</span> <span class="n">Denominator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span><span class="p">)</span>
<a name="ln-6146"></a>
<a name="ln-6147"></a>    <span class="c">!&#39;add effects from inner radial cell</span>
<a name="ln-6148"></a>    <span class="n">Resistance</span> <span class="o">=</span> <span class="p">(</span><span class="nb">LOG</span><span class="p">(</span><span class="n">ThisRadialCellRadialCentroid</span> <span class="o">/</span> <span class="n">ThisRadialCellInnerRadius</span><span class="p">)</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-6149"></a>                    <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Pi</span> <span class="o">*</span> <span class="n">Depth</span><span class="p">(</span><span class="n">ThisCell</span><span class="p">)</span> <span class="o">*</span> <span class="n">ThisRadialCellConductivity</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-6150"></a>                <span class="o">+</span> <span class="p">(</span><span class="nb">LOG</span><span class="p">(</span><span class="n">NextOuterRadialCellOuterRadius</span><span class="o">/</span><span class="n">NextOuterRadialCellRadialCentroid</span><span class="p">)</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-6151"></a>                    <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Pi</span> <span class="o">*</span> <span class="n">Depth</span><span class="p">(</span><span class="n">ThisCell</span><span class="p">)</span> <span class="o">*</span> <span class="n">NextOuterRadialCellConductivity</span><span class="p">))</span>
<a name="ln-6152"></a>    <span class="n">Numerator</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span><span class="p">)</span> <span class="o">*</span> <span class="n">NextOuterRadialCellTemperature</span>
<a name="ln-6153"></a>    <span class="n">Denominator</span> <span class="o">=</span> <span class="n">Denominator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span><span class="p">)</span>
<a name="ln-6154"></a>
<a name="ln-6155"></a>    <span class="c">!&#39;calculate the new temperature</span>
<a name="ln-6156"></a>    <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">MaxRadialIndex</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">/</span> <span class="n">Denominator</span>
<a name="ln-6157"></a>
<a name="ln-6158"></a><span class="k">END SUBROUTINE</span>
<a name="ln-6159"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-6160"></a>
<a name="ln-6161"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-6162"></a><span class="k">SUBROUTINE </span><span class="n">SimulateAllInteriorRadialSoilSlices</span><span class="p">(</span><span class="n">ThisCell</span><span class="p">)</span>
<a name="ln-6163"></a>
<a name="ln-6164"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6165"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-6166"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-6167"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6168"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6169"></a>
<a name="ln-6170"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6171"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-6172"></a>
<a name="ln-6173"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6174"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-6175"></a>
<a name="ln-6176"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6177"></a>          <span class="c">! na</span>
<a name="ln-6178"></a>
<a name="ln-6179"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6180"></a>          <span class="c">! na</span>
<a name="ln-6181"></a>
<a name="ln-6182"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6183"></a>
<a name="ln-6184"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6185"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">CartesianCell</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span> <span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisCell</span>
<a name="ln-6186"></a>
<a name="ln-6187"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6188"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Numerator</span>
<a name="ln-6189"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Denominator</span>
<a name="ln-6190"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Resistance</span>
<a name="ln-6191"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Beta</span>
<a name="ln-6192"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">rCtr</span>
<a name="ln-6193"></a>
<a name="ln-6194"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisRadialCellOuterRadius</span>
<a name="ln-6195"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisRadialCellRadialCentroid</span>
<a name="ln-6196"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisRadialCellConductivity</span>
<a name="ln-6197"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisRadialCellInnerRadius</span>
<a name="ln-6198"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisRadialCellTemperature_PrevTimeStep</span>
<a name="ln-6199"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisRadialCellTemperature</span>
<a name="ln-6200"></a>
<a name="ln-6201"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InnerRadialCellOuterRadius</span>
<a name="ln-6202"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InnerRadialCellRadialCentroid</span>
<a name="ln-6203"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InnerRadialCellConductivity</span>
<a name="ln-6204"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InnerRadialCellInnerRadius</span>
<a name="ln-6205"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InnerRadialCellTemperature</span>
<a name="ln-6206"></a>
<a name="ln-6207"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OuterRadialCellOuterRadius</span>
<a name="ln-6208"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OuterRadialCellRadialCentroid</span>
<a name="ln-6209"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OuterRadialCellConductivity</span>
<a name="ln-6210"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OuterRadialCellInnerRadius</span>
<a name="ln-6211"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OuterRadialCellTemperature</span>
<a name="ln-6212"></a>
<a name="ln-6213"></a>    <span class="n">Numerator</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6214"></a>    <span class="n">Denominator</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6215"></a>
<a name="ln-6216"></a>    <span class="k">DO </span><span class="n">rCtr</span> <span class="o">=</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-6217"></a>
<a name="ln-6218"></a>        <span class="n">Numerator</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6219"></a>        <span class="n">Denominator</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6220"></a>        <span class="n">Resistance</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6221"></a>
<a name="ln-6222"></a>        <span class="c">!&#39;convenience variables</span>
<a name="ln-6223"></a>        <span class="n">ThisRadialCellOuterRadius</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">rCtr</span><span class="p">)%</span><span class="n">OuterRadius</span>
<a name="ln-6224"></a>        <span class="n">ThisRadialCellRadialCentroid</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">rCtr</span><span class="p">)%</span><span class="n">RadialCentroid</span>
<a name="ln-6225"></a>        <span class="n">ThisRadialCellConductivity</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">rCtr</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Properties</span><span class="p">%</span><span class="n">Conductivity</span>
<a name="ln-6226"></a>        <span class="n">ThisRadialCellInnerRadius</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">rCtr</span><span class="p">)%</span><span class="n">InnerRadius</span>
<a name="ln-6227"></a>        <span class="n">ThisRadialCellTemperature_PrevTimeStep</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">rCtr</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature_PrevTimeStep</span>
<a name="ln-6228"></a>        <span class="n">ThisRadialCellTemperature</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">rCtr</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span>
<a name="ln-6229"></a>
<a name="ln-6230"></a>        <span class="n">InnerRadialCellOuterRadius</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">rCtr</span><span class="o">-</span><span class="mi">1</span><span class="p">)%</span><span class="n">OuterRadius</span>
<a name="ln-6231"></a>        <span class="n">InnerRadialCellRadialCentroid</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">rCtr</span><span class="o">-</span><span class="mi">1</span><span class="p">)%</span><span class="n">RadialCentroid</span>
<a name="ln-6232"></a>        <span class="n">InnerRadialCellConductivity</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">rCtr</span><span class="o">-</span><span class="mi">1</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Properties</span><span class="p">%</span><span class="n">Conductivity</span>
<a name="ln-6233"></a>        <span class="n">InnerRadialCellInnerRadius</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">rCtr</span><span class="o">-</span><span class="mi">1</span><span class="p">)%</span><span class="n">InnerRadius</span>
<a name="ln-6234"></a>        <span class="n">InnerRadialCellTemperature</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">rCtr</span><span class="o">-</span><span class="mi">1</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span>
<a name="ln-6235"></a>
<a name="ln-6236"></a>        <span class="n">OuterRadialCellOuterRadius</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">rCtr</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">OuterRadius</span>
<a name="ln-6237"></a>        <span class="n">OuterRadialCellRadialCentroid</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">rCtr</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">RadialCentroid</span>
<a name="ln-6238"></a>        <span class="n">OuterRadialCellConductivity</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">rCtr</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Properties</span><span class="p">%</span><span class="n">Conductivity</span>
<a name="ln-6239"></a>        <span class="n">OuterRadialCellInnerRadius</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">rCtr</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">InnerRadius</span>
<a name="ln-6240"></a>        <span class="n">OuterRadialCellTemperature</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">rCtr</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span>
<a name="ln-6241"></a>
<a name="ln-6242"></a>
<a name="ln-6243"></a>        <span class="c">!&#39;any broadly defined variables</span>
<a name="ln-6244"></a>        <span class="n">Beta</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">rCtr</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Beta</span>
<a name="ln-6245"></a>
<a name="ln-6246"></a>        <span class="c">!&#39;add effects from this cell history</span>
<a name="ln-6247"></a>        <span class="n">Numerator</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">+</span> <span class="n">ThisRadialCellTemperature_PrevTimeStep</span>
<a name="ln-6248"></a>        <span class="n">Denominator</span> <span class="o">=</span> <span class="n">Denominator</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-6249"></a>
<a name="ln-6250"></a>        <span class="c">!&#39;add effects from outer cell</span>
<a name="ln-6251"></a>        <span class="n">Resistance</span> <span class="o">=</span> <span class="p">(</span><span class="nb">LOG</span><span class="p">(</span><span class="n">OuterRadialCellRadialCentroid</span> <span class="o">/</span> <span class="n">OuterRadialCellInnerRadius</span><span class="p">)</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-6252"></a>                        <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Pi</span> <span class="o">*</span> <span class="n">Depth</span><span class="p">(</span><span class="n">ThisCell</span><span class="p">)</span> <span class="o">*</span> <span class="n">OuterRadialCellConductivity</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-6253"></a>                <span class="o">+</span> <span class="p">(</span><span class="nb">LOG</span><span class="p">(</span><span class="n">ThisRadialCellOuterRadius</span><span class="o">/</span><span class="n">ThisRadialCellRadialCentroid</span><span class="p">)</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-6254"></a>                        <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Pi</span> <span class="o">*</span> <span class="n">Depth</span><span class="p">(</span><span class="n">ThisCell</span><span class="p">)</span> <span class="o">*</span> <span class="n">ThisRadialCellConductivity</span><span class="p">))</span>
<a name="ln-6255"></a>        <span class="n">Numerator</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span><span class="p">)</span> <span class="o">*</span> <span class="n">OuterRadialCellTemperature</span>
<a name="ln-6256"></a>        <span class="n">Denominator</span> <span class="o">=</span> <span class="n">Denominator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span><span class="p">)</span>
<a name="ln-6257"></a>
<a name="ln-6258"></a>        <span class="c">!&#39;add effects from inner cell</span>
<a name="ln-6259"></a>        <span class="n">Resistance</span> <span class="o">=</span> <span class="p">(</span><span class="nb">LOG</span><span class="p">(</span><span class="n">ThisRadialCellRadialCentroid</span> <span class="o">/</span> <span class="n">ThisRadialCellInnerRadius</span><span class="p">)</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-6260"></a>                        <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Pi</span> <span class="o">*</span> <span class="n">Depth</span><span class="p">(</span><span class="n">ThisCell</span><span class="p">)</span> <span class="o">*</span> <span class="n">ThisRadialCellConductivity</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-6261"></a>                <span class="o">+</span> <span class="p">(</span><span class="nb">LOG</span><span class="p">(</span><span class="n">InnerRadialCellOuterRadius</span><span class="o">/</span><span class="n">InnerRadialCellRadialCentroid</span><span class="p">)</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-6262"></a>                        <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Pi</span> <span class="o">*</span> <span class="n">Depth</span><span class="p">(</span><span class="n">ThisCell</span><span class="p">)</span> <span class="o">*</span> <span class="n">InnerRadialCellConductivity</span><span class="p">))</span>
<a name="ln-6263"></a>        <span class="n">Numerator</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span><span class="p">)</span> <span class="o">*</span> <span class="n">InnerRadialCellTemperature</span>
<a name="ln-6264"></a>        <span class="n">Denominator</span> <span class="o">=</span> <span class="n">Denominator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span><span class="p">)</span>
<a name="ln-6265"></a>
<a name="ln-6266"></a>        <span class="c">!&#39;calculate the new temperature</span>
<a name="ln-6267"></a>        <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">rCtr</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">/</span> <span class="n">Denominator</span>
<a name="ln-6268"></a>
<a name="ln-6269"></a>    <span class="k">END DO</span>
<a name="ln-6270"></a>
<a name="ln-6271"></a><span class="k">END SUBROUTINE</span>
<a name="ln-6272"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-6273"></a>
<a name="ln-6274"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-6275"></a><span class="k">SUBROUTINE </span><span class="n">SimulateInnerMostRadialSoilSlice</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">CircuitNum</span><span class="p">,</span> <span class="n">ThisCell</span><span class="p">)</span>
<a name="ln-6276"></a>
<a name="ln-6277"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6278"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-6279"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-6280"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6281"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6282"></a>
<a name="ln-6283"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6284"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-6285"></a>
<a name="ln-6286"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6287"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-6288"></a>
<a name="ln-6289"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6290"></a>          <span class="c">! na</span>
<a name="ln-6291"></a>
<a name="ln-6292"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6293"></a>          <span class="c">! na</span>
<a name="ln-6294"></a>
<a name="ln-6295"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6296"></a>
<a name="ln-6297"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6298"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DomainNum</span>
<a name="ln-6299"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CircuitNum</span>
<a name="ln-6300"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">CartesianCell</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span> <span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisCell</span>
<a name="ln-6301"></a>
<a name="ln-6302"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6303"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Numerator</span>
<a name="ln-6304"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Denominator</span>
<a name="ln-6305"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Resistance</span>
<a name="ln-6306"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Beta</span>
<a name="ln-6307"></a>
<a name="ln-6308"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisRadialCellOuterRadius</span>
<a name="ln-6309"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisRadialCellRadialCentroid</span>
<a name="ln-6310"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisRadialCellConductivity</span>
<a name="ln-6311"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisRadialCellInnerRadius</span>
<a name="ln-6312"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisRadialCellTemperature_PrevTimeStep</span>
<a name="ln-6313"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisRadialCellTemperature</span>
<a name="ln-6314"></a>
<a name="ln-6315"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InnerNeighborRadialCellOuterRadius</span>
<a name="ln-6316"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InnerNeighborRadialCellRadialCentroid</span>
<a name="ln-6317"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InnerNeighborRadialCellConductivity</span>
<a name="ln-6318"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InnerNeighborRadialCellInnerRadius</span>
<a name="ln-6319"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InnerNeighborRadialCellTemperature</span>
<a name="ln-6320"></a>
<a name="ln-6321"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OuterNeighborRadialCellOuterRadius</span>
<a name="ln-6322"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OuterNeighborRadialCellRadialCentroid</span>
<a name="ln-6323"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OuterNeighborRadialCellConductivity</span>
<a name="ln-6324"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OuterNeighborRadialCellInnerRadius</span>
<a name="ln-6325"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OuterNeighborRadialCellTemperature</span>
<a name="ln-6326"></a>
<a name="ln-6327"></a>    <span class="n">Numerator</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6328"></a>    <span class="n">Denominator</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6329"></a>
<a name="ln-6330"></a>    <span class="c">!&#39;convenience variables</span>
<a name="ln-6331"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">HasInsulation</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6332"></a><span class="k">        </span><span class="n">InnerNeighborRadialCellOuterRadius</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Insulation</span><span class="p">%</span><span class="n">OuterRadius</span>
<a name="ln-6333"></a>        <span class="n">InnerNeighborRadialCellRadialCentroid</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Insulation</span><span class="p">%</span><span class="n">RadialCentroid</span>
<a name="ln-6334"></a>        <span class="n">InnerNeighborRadialCellConductivity</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Insulation</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Properties</span><span class="p">%</span><span class="n">Conductivity</span>
<a name="ln-6335"></a>        <span class="n">InnerNeighborRadialCellInnerRadius</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Insulation</span><span class="p">%</span><span class="n">InnerRadius</span>
<a name="ln-6336"></a>        <span class="n">InnerNeighborRadialCellTemperature</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Insulation</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span>
<a name="ln-6337"></a>    <span class="k">ELSE</span>
<a name="ln-6338"></a><span class="k">        </span><span class="n">InnerNeighborRadialCellOuterRadius</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Pipe</span><span class="p">%</span><span class="n">OuterRadius</span>
<a name="ln-6339"></a>        <span class="n">InnerNeighborRadialCellRadialCentroid</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Pipe</span><span class="p">%</span><span class="n">RadialCentroid</span>
<a name="ln-6340"></a>        <span class="n">InnerNeighborRadialCellConductivity</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Pipe</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Properties</span><span class="p">%</span><span class="n">Conductivity</span>
<a name="ln-6341"></a>        <span class="n">InnerNeighborRadialCellInnerRadius</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Pipe</span><span class="p">%</span><span class="n">InnerRadius</span>
<a name="ln-6342"></a>        <span class="n">InnerNeighborRadialCellTemperature</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Pipe</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span>
<a name="ln-6343"></a>    <span class="k">END IF</span>
<a name="ln-6344"></a>
<a name="ln-6345"></a><span class="k">    </span><span class="n">ThisRadialCellOuterRadius</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="mi">0</span><span class="p">)%</span><span class="n">OuterRadius</span>
<a name="ln-6346"></a>    <span class="n">ThisRadialCellRadialCentroid</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="mi">0</span><span class="p">)%</span><span class="n">RadialCentroid</span>
<a name="ln-6347"></a>    <span class="n">ThisRadialCellConductivity</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="mi">0</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Properties</span><span class="p">%</span><span class="n">Conductivity</span>
<a name="ln-6348"></a>    <span class="n">ThisRadialCellInnerRadius</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="mi">0</span><span class="p">)%</span><span class="n">InnerRadius</span>
<a name="ln-6349"></a>    <span class="n">ThisRadialCellTemperature_PrevTimeStep</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="mi">0</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature_PrevTimeStep</span>
<a name="ln-6350"></a>    <span class="n">ThisRadialCellTemperature</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="mi">0</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span>
<a name="ln-6351"></a>
<a name="ln-6352"></a>    <span class="n">OuterNeighborRadialCellOuterRadius</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">OuterRadius</span>
<a name="ln-6353"></a>    <span class="n">OuterNeighborRadialCellRadialCentroid</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">RadialCentroid</span>
<a name="ln-6354"></a>    <span class="n">OuterNeighborRadialCellConductivity</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Properties</span><span class="p">%</span><span class="n">Conductivity</span>
<a name="ln-6355"></a>    <span class="n">OuterNeighborRadialCellInnerRadius</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">InnerRadius</span>
<a name="ln-6356"></a>    <span class="n">OuterNeighborRadialCellTemperature</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span>
<a name="ln-6357"></a>
<a name="ln-6358"></a>    <span class="c">!&#39;any broadly defined variables</span>
<a name="ln-6359"></a>    <span class="n">Beta</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="mi">0</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Beta</span>
<a name="ln-6360"></a>
<a name="ln-6361"></a>    <span class="c">!&#39;add effects from this cell history</span>
<a name="ln-6362"></a>    <span class="n">Numerator</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">+</span> <span class="n">ThisRadialCellTemperature_PrevTimeStep</span>
<a name="ln-6363"></a>    <span class="n">Denominator</span> <span class="o">=</span> <span class="n">Denominator</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-6364"></a>
<a name="ln-6365"></a>    <span class="c">!&#39;add effects from outer radial cell</span>
<a name="ln-6366"></a>    <span class="n">Resistance</span> <span class="o">=</span> <span class="p">(</span><span class="nb">LOG</span><span class="p">(</span><span class="n">OuterNeighborRadialCellRadialCentroid</span> <span class="o">/</span> <span class="n">OuterNeighborRadialCellInnerRadius</span><span class="p">)</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-6367"></a>                    <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">PI</span> <span class="o">*</span> <span class="n">Depth</span><span class="p">(</span><span class="n">ThisCell</span><span class="p">)</span> <span class="o">*</span> <span class="n">OuterNeighborRadialCellConductivity</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-6368"></a>                <span class="o">+</span><span class="p">(</span><span class="nb">LOG</span><span class="p">(</span><span class="n">ThisRadialCellOuterRadius</span> <span class="o">/</span> <span class="n">ThisRadialCellRadialCentroid</span><span class="p">)</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-6369"></a>                    <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">PI</span> <span class="o">*</span> <span class="n">Depth</span><span class="p">(</span><span class="n">ThisCell</span><span class="p">)</span> <span class="o">*</span> <span class="n">ThisRadialCellConductivity</span><span class="p">))</span>
<a name="ln-6370"></a>    <span class="n">Numerator</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span><span class="p">)</span> <span class="o">*</span> <span class="n">OuterNeighborRadialCellTemperature</span>
<a name="ln-6371"></a>    <span class="n">Denominator</span> <span class="o">=</span> <span class="n">Denominator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span><span class="p">)</span>
<a name="ln-6372"></a>
<a name="ln-6373"></a>    <span class="c">!&#39;add effects from pipe cell</span>
<a name="ln-6374"></a>    <span class="n">Resistance</span> <span class="o">=</span> <span class="p">(</span><span class="nb">LOG</span><span class="p">(</span><span class="n">ThisRadialCellRadialCentroid</span> <span class="o">/</span> <span class="n">ThisRadialCellInnerRadius</span><span class="p">)</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-6375"></a>                    <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">PI</span> <span class="o">*</span> <span class="n">Depth</span><span class="p">(</span><span class="n">ThisCell</span><span class="p">)</span> <span class="o">*</span> <span class="n">ThisRadialCellConductivity</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-6376"></a>                <span class="o">+</span> <span class="p">(</span><span class="nb">LOG</span><span class="p">(</span><span class="n">InnerNeighborRadialCellOuterRadius</span> <span class="o">/</span> <span class="n">InnerNeighborRadialCellRadialCentroid</span><span class="p">)</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-6377"></a>                    <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">PI</span> <span class="o">*</span> <span class="n">Depth</span><span class="p">(</span><span class="n">ThisCell</span><span class="p">)</span> <span class="o">*</span> <span class="n">InnerNeighborRadialCellConductivity</span><span class="p">))</span>
<a name="ln-6378"></a>    <span class="n">Numerator</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span><span class="p">)</span> <span class="o">*</span> <span class="n">InnerNeighborRadialCellTemperature</span>
<a name="ln-6379"></a>    <span class="n">Denominator</span> <span class="o">=</span> <span class="n">Denominator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span><span class="p">)</span>
<a name="ln-6380"></a>
<a name="ln-6381"></a>    <span class="c">!&#39;calculate the new temperature</span>
<a name="ln-6382"></a>    <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="mi">0</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">/</span> <span class="n">Denominator</span>
<a name="ln-6383"></a>
<a name="ln-6384"></a><span class="k">END SUBROUTINE</span>
<a name="ln-6385"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-6386"></a>
<a name="ln-6387"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-6388"></a><span class="k">SUBROUTINE </span><span class="n">SimulateRadialInsulationCell</span><span class="p">(</span><span class="n">ThisCell</span><span class="p">)</span>
<a name="ln-6389"></a>
<a name="ln-6390"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6391"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-6392"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-6393"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6394"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6395"></a>
<a name="ln-6396"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6397"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-6398"></a>
<a name="ln-6399"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6400"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-6401"></a>
<a name="ln-6402"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6403"></a>          <span class="c">! na</span>
<a name="ln-6404"></a>
<a name="ln-6405"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6406"></a>          <span class="c">! na</span>
<a name="ln-6407"></a>
<a name="ln-6408"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6409"></a>
<a name="ln-6410"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6411"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">CartesianCell</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span> <span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisCell</span>
<a name="ln-6412"></a>
<a name="ln-6413"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6414"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Numerator</span>
<a name="ln-6415"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Denominator</span>
<a name="ln-6416"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Resistance</span>
<a name="ln-6417"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Beta</span>
<a name="ln-6418"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">RadialCellInformation</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PipeCell</span>
<a name="ln-6419"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">RadialCellInformation</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisInsulationCell</span>
<a name="ln-6420"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">RadialCellInformation</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NextInnerRadialCell</span>
<a name="ln-6421"></a>
<a name="ln-6422"></a>    <span class="n">Numerator</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6423"></a>    <span class="n">Denominator</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6424"></a>
<a name="ln-6425"></a>    <span class="c">!&#39;convenience variables</span>
<a name="ln-6426"></a>    <span class="n">PipeCell</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Pipe</span>
<a name="ln-6427"></a>    <span class="n">ThisInsulationCell</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Insulation</span>
<a name="ln-6428"></a>    <span class="n">NextInnerRadialCell</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a name="ln-6429"></a>
<a name="ln-6430"></a>    <span class="c">!&#39;any broadly defined variables</span>
<a name="ln-6431"></a>    <span class="n">Beta</span> <span class="o">=</span> <span class="n">ThisInsulationCell</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Beta</span>
<a name="ln-6432"></a>
<a name="ln-6433"></a>    <span class="c">!&#39;add effects from this cell history</span>
<a name="ln-6434"></a>    <span class="n">Numerator</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">+</span> <span class="n">ThisInsulationCell</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature_PrevTimeStep</span>
<a name="ln-6435"></a>    <span class="n">Denominator</span> <span class="o">=</span> <span class="n">Denominator</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-6436"></a>
<a name="ln-6437"></a>    <span class="c">!&#39;add effects from outer radial cell</span>
<a name="ln-6438"></a>    <span class="n">Resistance</span> <span class="o">=</span> <span class="p">(</span><span class="nb">LOG</span><span class="p">(</span><span class="n">NextInnerRadialCell</span><span class="p">%</span><span class="n">RadialCentroid</span> <span class="o">/</span> <span class="n">NextInnerRadialCell</span><span class="p">%</span><span class="n">InnerRadius</span><span class="p">)</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-6439"></a>                    <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">PI</span> <span class="o">*</span> <span class="n">Depth</span><span class="p">(</span><span class="n">ThisCell</span><span class="p">)</span> <span class="o">*</span> <span class="n">NextInnerRadialCell</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Properties</span><span class="p">%</span><span class="n">Conductivity</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-6440"></a>                <span class="o">+</span> <span class="p">(</span><span class="nb">LOG</span><span class="p">(</span><span class="n">ThisInsulationCell</span><span class="p">%</span><span class="n">OuterRadius</span> <span class="o">/</span> <span class="n">ThisInsulationCell</span><span class="p">%</span><span class="n">RadialCentroid</span><span class="p">)</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-6441"></a>                    <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">PI</span> <span class="o">*</span> <span class="n">Depth</span><span class="p">(</span><span class="n">ThisCell</span><span class="p">)</span> <span class="o">*</span> <span class="n">ThisInsulationCell</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Properties</span><span class="p">%</span><span class="n">Conductivity</span><span class="p">))</span>
<a name="ln-6442"></a>    <span class="n">Numerator</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span><span class="p">)</span> <span class="o">*</span> <span class="n">NextInnerRadialCell</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span>
<a name="ln-6443"></a>    <span class="n">Denominator</span> <span class="o">=</span> <span class="n">Denominator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span><span class="p">)</span>
<a name="ln-6444"></a>
<a name="ln-6445"></a>    <span class="c">!&#39;add effects from pipe cell</span>
<a name="ln-6446"></a>    <span class="n">Resistance</span> <span class="o">=</span> <span class="p">(</span><span class="nb">LOG</span><span class="p">(</span><span class="n">ThisInsulationCell</span><span class="p">%</span><span class="n">RadialCentroid</span> <span class="o">/</span> <span class="n">ThisInsulationCell</span><span class="p">%</span><span class="n">InnerRadius</span><span class="p">)</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-6447"></a>                    <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">PI</span> <span class="o">*</span> <span class="n">Depth</span><span class="p">(</span><span class="n">ThisCell</span><span class="p">)</span> <span class="o">*</span> <span class="n">ThisInsulationCell</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Properties</span><span class="p">%</span><span class="n">Conductivity</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-6448"></a>                <span class="o">+</span> <span class="p">(</span><span class="nb">LOG</span><span class="p">(</span><span class="n">PipeCell</span><span class="p">%</span><span class="n">OuterRadius</span> <span class="o">/</span> <span class="n">PipeCell</span><span class="p">%</span><span class="n">RadialCentroid</span><span class="p">)</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-6449"></a>                    <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">PI</span> <span class="o">*</span> <span class="n">Depth</span><span class="p">(</span><span class="n">ThisCell</span><span class="p">)</span> <span class="o">*</span> <span class="n">PipeCell</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Properties</span><span class="p">%</span><span class="n">Conductivity</span><span class="p">))</span>
<a name="ln-6450"></a>    <span class="n">Numerator</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span><span class="p">)</span> <span class="o">*</span> <span class="n">PipeCell</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span>
<a name="ln-6451"></a>    <span class="n">Denominator</span> <span class="o">=</span> <span class="n">Denominator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span><span class="p">)</span>
<a name="ln-6452"></a>
<a name="ln-6453"></a>    <span class="c">!&#39;calculate the new temperature</span>
<a name="ln-6454"></a>    <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Insulation</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">/</span> <span class="n">Denominator</span>
<a name="ln-6455"></a>
<a name="ln-6456"></a><span class="k">END SUBROUTINE</span>
<a name="ln-6457"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-6458"></a>
<a name="ln-6459"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-6460"></a><span class="k">SUBROUTINE </span><span class="n">SimulateRadialPipeCell</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">CircuitNum</span><span class="p">,</span> <span class="n">ThisCell</span><span class="p">,</span> <span class="n">ConvectionCoefficient</span><span class="p">)</span>
<a name="ln-6461"></a>
<a name="ln-6462"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6463"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-6464"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-6465"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6466"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6467"></a>
<a name="ln-6468"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6469"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-6470"></a>
<a name="ln-6471"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6472"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-6473"></a>
<a name="ln-6474"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6475"></a>          <span class="c">! na</span>
<a name="ln-6476"></a>
<a name="ln-6477"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6478"></a>          <span class="c">! na</span>
<a name="ln-6479"></a>
<a name="ln-6480"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6481"></a>
<a name="ln-6482"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6483"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DomainNum</span>
<a name="ln-6484"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CircuitNum</span>
<a name="ln-6485"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">CartesianCell</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span> <span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisCell</span>
<a name="ln-6486"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ConvectionCoefficient</span>
<a name="ln-6487"></a>
<a name="ln-6488"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6489"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Numerator</span>
<a name="ln-6490"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Denominator</span>
<a name="ln-6491"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Resistance</span>
<a name="ln-6492"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Beta</span>
<a name="ln-6493"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PipeConductionResistance</span>
<a name="ln-6494"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ConvectiveResistance</span>
<a name="ln-6495"></a>
<a name="ln-6496"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisPipeCellOuterRadius</span>
<a name="ln-6497"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisPipeCellRadialCentroid</span>
<a name="ln-6498"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisPipeCellConductivity</span>
<a name="ln-6499"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisPipeCellInnerRadius</span>
<a name="ln-6500"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisPipeCellTemperature_PrevTimeStep</span>
<a name="ln-6501"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisPipeCellTemperature</span>
<a name="ln-6502"></a>
<a name="ln-6503"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FluidCellOuterRadius</span>
<a name="ln-6504"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FluidCellRadialCentroid</span>
<a name="ln-6505"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FluidCellConductivity</span>
<a name="ln-6506"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FluidCellInnerRadius</span>
<a name="ln-6507"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FluidCellTemperature</span>
<a name="ln-6508"></a>
<a name="ln-6509"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OuterNeighborRadialCellOuterRadius</span>
<a name="ln-6510"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OuterNeighborRadialCellRadialCentroid</span>
<a name="ln-6511"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OuterNeighborRadialCellConductivity</span>
<a name="ln-6512"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OuterNeighborRadialCellInnerRadius</span>
<a name="ln-6513"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OuterNeighborRadialCellTemperature</span>
<a name="ln-6514"></a>
<a name="ln-6515"></a>    <span class="n">Numerator</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6516"></a>    <span class="n">Denominator</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6517"></a>    <span class="n">Resistance</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6518"></a>
<a name="ln-6519"></a>    <span class="c">!&#39;convenience variables</span>
<a name="ln-6520"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">HasInsulation</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6521"></a><span class="k">        </span><span class="n">OuterNeighborRadialCellOuterRadius</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Insulation</span><span class="p">%</span><span class="n">OuterRadius</span>
<a name="ln-6522"></a>        <span class="n">OuterNeighborRadialCellRadialCentroid</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Insulation</span><span class="p">%</span><span class="n">RadialCentroid</span>
<a name="ln-6523"></a>        <span class="n">OuterNeighborRadialCellConductivity</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Insulation</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Properties</span><span class="p">%</span><span class="n">Conductivity</span>
<a name="ln-6524"></a>        <span class="n">OuterNeighborRadialCellInnerRadius</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Insulation</span><span class="p">%</span><span class="n">InnerRadius</span>
<a name="ln-6525"></a>        <span class="n">OuterNeighborRadialCellTemperature</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Insulation</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span>
<a name="ln-6526"></a>    <span class="k">ELSE</span>
<a name="ln-6527"></a><span class="k">        </span><span class="n">OuterNeighborRadialCellOuterRadius</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="mi">0</span><span class="p">)%</span><span class="n">OuterRadius</span>
<a name="ln-6528"></a>        <span class="n">OuterNeighborRadialCellRadialCentroid</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="mi">0</span><span class="p">)%</span><span class="n">RadialCentroid</span>
<a name="ln-6529"></a>        <span class="n">OuterNeighborRadialCellConductivity</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="mi">0</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Properties</span><span class="p">%</span><span class="n">Conductivity</span>
<a name="ln-6530"></a>        <span class="n">OuterNeighborRadialCellInnerRadius</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="mi">0</span><span class="p">)%</span><span class="n">InnerRadius</span>
<a name="ln-6531"></a>        <span class="n">OuterNeighborRadialCellTemperature</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="mi">0</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span>
<a name="ln-6532"></a>    <span class="k">END IF</span>
<a name="ln-6533"></a>
<a name="ln-6534"></a><span class="k">    </span><span class="n">ThisPipeCellOuterRadius</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Pipe</span><span class="p">%</span><span class="n">OuterRadius</span>
<a name="ln-6535"></a>    <span class="n">ThisPipeCellRadialCentroid</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Pipe</span><span class="p">%</span><span class="n">RadialCentroid</span>
<a name="ln-6536"></a>    <span class="n">ThisPipeCellConductivity</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Pipe</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Properties</span><span class="p">%</span><span class="n">Conductivity</span>
<a name="ln-6537"></a>    <span class="n">ThisPipeCellInnerRadius</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Pipe</span><span class="p">%</span><span class="n">InnerRadius</span>
<a name="ln-6538"></a>    <span class="n">ThisPipeCellTemperature_PrevTimeStep</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Pipe</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature_PrevTimeStep</span>
<a name="ln-6539"></a>    <span class="n">ThisPipeCellTemperature</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Pipe</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span>
<a name="ln-6540"></a>
<a name="ln-6541"></a>    <span class="n">FluidCellTemperature</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Fluid</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span>
<a name="ln-6542"></a>
<a name="ln-6543"></a>    <span class="c">!&#39;any broadly defined variables</span>
<a name="ln-6544"></a>    <span class="n">Beta</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Pipe</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Beta</span>
<a name="ln-6545"></a>
<a name="ln-6546"></a>    <span class="c">!&#39;add effects from this cell history</span>
<a name="ln-6547"></a>    <span class="n">Numerator</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">+</span> <span class="n">ThisPipeCellTemperature_PrevTimeStep</span>
<a name="ln-6548"></a>    <span class="n">Denominator</span> <span class="o">=</span> <span class="n">Denominator</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-6549"></a>
<a name="ln-6550"></a>    <span class="c">!&#39;add effects from outer radial cell</span>
<a name="ln-6551"></a>    <span class="n">Resistance</span> <span class="o">=</span> <span class="p">(</span><span class="nb">LOG</span><span class="p">(</span><span class="n">OuterNeighborRadialCellRadialCentroid</span> <span class="o">/</span> <span class="n">OuterNeighborRadialCellInnerRadius</span><span class="p">)</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-6552"></a>                 <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">PI</span> <span class="o">*</span> <span class="n">Depth</span><span class="p">(</span><span class="n">ThisCell</span><span class="p">)</span> <span class="o">*</span> <span class="n">OuterNeighborRadialCellConductivity</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-6553"></a>               <span class="o">+</span> <span class="p">(</span><span class="nb">LOG</span><span class="p">(</span><span class="n">ThisPipeCellOuterRadius</span> <span class="o">/</span> <span class="n">ThisPipeCellRadialCentroid</span><span class="p">)</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-6554"></a>                 <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">PI</span> <span class="o">*</span> <span class="n">Depth</span><span class="p">(</span><span class="n">ThisCell</span><span class="p">)</span> <span class="o">*</span> <span class="n">ThisPipeCellConductivity</span><span class="p">))</span>
<a name="ln-6555"></a>    <span class="n">Numerator</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span><span class="p">)</span> <span class="o">*</span> <span class="n">OuterNeighborRadialCellTemperature</span>
<a name="ln-6556"></a>    <span class="n">Denominator</span> <span class="o">=</span> <span class="n">Denominator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span><span class="p">)</span>
<a name="ln-6557"></a>
<a name="ln-6558"></a>    <span class="c">!&#39;add effects from water cell</span>
<a name="ln-6559"></a>    <span class="n">PipeConductionResistance</span> <span class="o">=</span> <span class="nb">LOG</span><span class="p">(</span><span class="n">ThisPipeCellRadialCentroid</span> <span class="o">/</span> <span class="n">ThisPipeCellInnerRadius</span><span class="p">)</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-6560"></a>                               <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">PI</span> <span class="o">*</span> <span class="n">Depth</span><span class="p">(</span><span class="n">ThisCell</span><span class="p">)</span> <span class="o">*</span> <span class="n">ThisPipeCellConductivity</span><span class="p">)</span>
<a name="ln-6561"></a>    <span class="n">ConvectiveResistance</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="o">/</span> <span class="p">(</span><span class="n">ConvectionCoefficient</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">PI</span> <span class="o">*</span> <span class="n">ThisPipeCellInnerRadius</span> <span class="o">*</span> <span class="n">Depth</span><span class="p">(</span><span class="n">ThisCell</span><span class="p">))</span>
<a name="ln-6562"></a>    <span class="n">Resistance</span> <span class="o">=</span> <span class="n">PipeConductionResistance</span> <span class="o">+</span> <span class="n">ConvectiveResistance</span>
<a name="ln-6563"></a>    <span class="n">Numerator</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span><span class="p">)</span> <span class="o">*</span> <span class="n">FluidCellTemperature</span>
<a name="ln-6564"></a>    <span class="n">Denominator</span> <span class="o">=</span> <span class="n">Denominator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">Resistance</span><span class="p">)</span>
<a name="ln-6565"></a>
<a name="ln-6566"></a>    <span class="c">!&#39;calculate new temperature</span>
<a name="ln-6567"></a>    <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Pipe</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">/</span> <span class="n">Denominator</span>
<a name="ln-6568"></a>
<a name="ln-6569"></a><span class="k">END SUBROUTINE</span>
<a name="ln-6570"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-6571"></a>
<a name="ln-6572"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-6573"></a><span class="k">SUBROUTINE </span><span class="n">SimulateFluidCell</span><span class="p">(</span><span class="n">ThisCell</span><span class="p">,</span> <span class="n">FlowRate</span><span class="p">,</span> <span class="n">ConvectionCoefficient</span><span class="p">,</span> <span class="n">EnteringFluidTemp</span><span class="p">)</span>
<a name="ln-6574"></a>
<a name="ln-6575"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6576"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-6577"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-6578"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6579"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6580"></a>
<a name="ln-6581"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6582"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-6583"></a>
<a name="ln-6584"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6585"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-6586"></a>
<a name="ln-6587"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6588"></a>          <span class="c">! na</span>
<a name="ln-6589"></a>
<a name="ln-6590"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6591"></a>          <span class="c">! na</span>
<a name="ln-6592"></a>
<a name="ln-6593"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6594"></a>
<a name="ln-6595"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6596"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">CartesianCell</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span> <span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisCell</span>
<a name="ln-6597"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FlowRate</span>
<a name="ln-6598"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ConvectionCoefficient</span>
<a name="ln-6599"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EnteringFluidTemp</span>
<a name="ln-6600"></a>
<a name="ln-6601"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6602"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Beta</span>
<a name="ln-6603"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Numerator</span>
<a name="ln-6604"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Denominator</span>
<a name="ln-6605"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotalPipeResistance</span>
<a name="ln-6606"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PipeConductionResistance</span>
<a name="ln-6607"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ConvectiveResistance</span>
<a name="ln-6608"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UpstreamResistance</span>
<a name="ln-6609"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EnteringFluidConductance</span>
<a name="ln-6610"></a>
<a name="ln-6611"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FluidCellTemperature_PrevTimeStep</span>
<a name="ln-6612"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FluidCellSpecificHeat</span>
<a name="ln-6613"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PipeCellOuterRadius</span>
<a name="ln-6614"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PipeCellRadialCentroid</span>
<a name="ln-6615"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PipeCellConductivity</span>
<a name="ln-6616"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PipeCellInnerRadius</span>
<a name="ln-6617"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PipeCellTemperature</span>
<a name="ln-6618"></a>
<a name="ln-6619"></a>    <span class="n">Numerator</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6620"></a>    <span class="n">Denominator</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6621"></a>
<a name="ln-6622"></a>    <span class="c">!&#39;convenience variables</span>
<a name="ln-6623"></a>    <span class="n">FluidCellTemperature_PrevTimeStep</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Fluid</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature_PrevTimeStep</span>
<a name="ln-6624"></a>    <span class="n">FluidCellSpecificHeat</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Fluid</span><span class="p">%</span><span class="n">Properties</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">SpecificHeat</span>
<a name="ln-6625"></a>
<a name="ln-6626"></a>    <span class="n">PipeCellOuterRadius</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Pipe</span><span class="p">%</span><span class="n">OuterRadius</span>
<a name="ln-6627"></a>    <span class="n">PipeCellRadialCentroid</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Pipe</span><span class="p">%</span><span class="n">RadialCentroid</span>
<a name="ln-6628"></a>    <span class="n">PipeCellConductivity</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Pipe</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Properties</span><span class="p">%</span><span class="n">Conductivity</span>
<a name="ln-6629"></a>    <span class="n">PipeCellInnerRadius</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Pipe</span><span class="p">%</span><span class="n">InnerRadius</span>
<a name="ln-6630"></a>    <span class="n">PipeCellTemperature</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Pipe</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span>
<a name="ln-6631"></a>
<a name="ln-6632"></a>    <span class="n">Beta</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Fluid</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Beta</span>
<a name="ln-6633"></a>
<a name="ln-6634"></a>    <span class="c">!&#39;add effects from this cell history</span>
<a name="ln-6635"></a>    <span class="n">Numerator</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">+</span> <span class="n">FluidCellTemperature_PrevTimeStep</span>
<a name="ln-6636"></a>    <span class="n">Denominator</span> <span class="o">=</span> <span class="n">Denominator</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-6637"></a>
<a name="ln-6638"></a>    <span class="c">!&#39;add effects from outer pipe cell</span>
<a name="ln-6639"></a>    <span class="n">PipeConductionResistance</span> <span class="o">=</span> <span class="nb">LOG</span><span class="p">(</span><span class="n">PipeCellRadialCentroid</span> <span class="o">/</span> <span class="n">PipeCellInnerRadius</span><span class="p">)</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-6640"></a>                    <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">PI</span> <span class="o">*</span> <span class="n">Depth</span><span class="p">(</span><span class="n">ThisCell</span><span class="p">)</span> <span class="o">*</span> <span class="n">PipeCellConductivity</span><span class="p">)</span>
<a name="ln-6641"></a>    <span class="n">ConvectiveResistance</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="o">/</span> <span class="p">(</span><span class="n">ConvectionCoefficient</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">PI</span> <span class="o">*</span> <span class="n">PipeCellInnerRadius</span> <span class="o">*</span> <span class="n">Depth</span><span class="p">(</span><span class="n">ThisCell</span><span class="p">))</span>
<a name="ln-6642"></a>    <span class="n">TotalPipeResistance</span> <span class="o">=</span> <span class="n">PipeConductionResistance</span> <span class="o">+</span> <span class="n">ConvectiveResistance</span>
<a name="ln-6643"></a>    <span class="n">Numerator</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">TotalPipeResistance</span><span class="p">)</span> <span class="o">*</span> <span class="n">PipeCellTemperature</span>
<a name="ln-6644"></a>    <span class="n">Denominator</span> <span class="o">=</span> <span class="n">Denominator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">TotalPipeResistance</span><span class="p">)</span>
<a name="ln-6645"></a>
<a name="ln-6646"></a>    <span class="c">!&#39;add effects from upstream flow</span>
<a name="ln-6647"></a>    <span class="n">EnteringFluidConductance</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6648"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">FlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6649"></a><span class="k">        </span><span class="n">UpstreamResistance</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">FlowRate</span> <span class="o">*</span> <span class="n">FluidCellSpecificHeat</span><span class="p">)</span>
<a name="ln-6650"></a>        <span class="c">!EnteringFluidConductance = ( (1/UpstreamResistance) - (0.5*TotalPipeResistance) )</span>
<a name="ln-6651"></a>        <span class="n">Numerator</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">UpstreamResistance</span><span class="p">)</span> <span class="o">*</span> <span class="n">EnteringFluidTemp</span>
<a name="ln-6652"></a>        <span class="n">Denominator</span> <span class="o">=</span> <span class="n">Denominator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Beta</span> <span class="o">/</span> <span class="n">UpstreamResistance</span><span class="p">)</span>
<a name="ln-6653"></a>    <span class="k">END IF</span>
<a name="ln-6654"></a>
<a name="ln-6655"></a>    <span class="c">!&#39;calculate new temperature</span>
<a name="ln-6656"></a>    <span class="n">ThisCell</span><span class="p">%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Fluid</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">/</span> <span class="n">Denominator</span>
<a name="ln-6657"></a>
<a name="ln-6658"></a><span class="k">END SUBROUTINE</span>
<a name="ln-6659"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-6660"></a>
<a name="ln-6661"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-6662"></a><span class="k">SUBROUTINE </span><span class="n">DoOneTimeInitializations</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">CircuitNum</span><span class="p">)</span>
<a name="ln-6663"></a>
<a name="ln-6664"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6665"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-6666"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-6667"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6668"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6669"></a>
<a name="ln-6670"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6671"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-6672"></a>
<a name="ln-6673"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6674"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-6675"></a>
<a name="ln-6676"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6677"></a>          <span class="c">! na</span>
<a name="ln-6678"></a>
<a name="ln-6679"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6680"></a>          <span class="c">! na</span>
<a name="ln-6681"></a>
<a name="ln-6682"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6683"></a>
<a name="ln-6684"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6685"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DomainNum</span>
<a name="ln-6686"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CircuitNum</span>
<a name="ln-6687"></a>
<a name="ln-6688"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6689"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">rCtr</span>
<a name="ln-6690"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NX</span><span class="p">,</span> <span class="n">NY</span><span class="p">,</span> <span class="n">NZ</span>
<a name="ln-6691"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SegIndex</span>
<a name="ln-6692"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">StartingZ</span>
<a name="ln-6693"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">EndingZ</span>
<a name="ln-6694"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Increment</span>
<a name="ln-6695"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ZIndex</span>
<a name="ln-6696"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">PipeX</span><span class="p">,</span> <span class="n">PipeY</span>
<a name="ln-6697"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NeighborTemp</span>
<a name="ln-6698"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Resistance</span>
<a name="ln-6699"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DirectionCtr</span>
<a name="ln-6700"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CurDirection</span>
<a name="ln-6701"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Dummy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6702"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotalSegments</span>
<a name="ln-6703"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SegCtr2</span>
<a name="ln-6704"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisCellTemp</span>
<a name="ln-6705"></a>
<a name="ln-6706"></a>    <span class="c">!&#39;initialize cell properties</span>
<a name="ln-6707"></a>    <span class="k">DO </span><span class="n">Z</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a name="ln-6708"></a>        <span class="k">DO </span><span class="n">Y</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<a name="ln-6709"></a>            <span class="k">DO </span><span class="n">X</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-6710"></a>
<a name="ln-6711"></a>                <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">CellType</span><span class="p">)</span>
<a name="ln-6712"></a>                <span class="k">CASE</span> <span class="p">(</span><span class="n">CellType_Pipe</span><span class="p">)</span>
<a name="ln-6713"></a>                    <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Properties</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-6714"></a>                                                <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">GroundProperties</span>
<a name="ln-6715"></a>                    <span class="k">DO </span><span class="n">rctr</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-6716"></a>                        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">rctr</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Properties</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-6717"></a>                                                <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">GroundProperties</span>
<a name="ln-6718"></a>                    <span class="k">END DO</span>
<a name="ln-6719"></a><span class="k">                    </span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Pipe</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Properties</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-6720"></a>                                                <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">PipeProperties</span>
<a name="ln-6721"></a>                    <span class="k">IF</span> <span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">HasInsulation</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6722"></a><span class="k">                        </span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Insulation</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Properties</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-6723"></a>                                                <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">InsulationProperties</span>
<a name="ln-6724"></a>                    <span class="k">END IF</span>
<a name="ln-6725"></a><span class="k">                CASE</span> <span class="p">(</span><span class="n">CellType_GeneralField</span><span class="p">,</span> <span class="n">CellType_GroundSurface</span><span class="p">,</span> <span class="n">CellType_AdiabaticWall</span><span class="p">,</span> <span class="n">CellType_FarfieldBoundary</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6726"></a>                      <span class="n">CellType_BasementWall</span><span class="p">,</span> <span class="n">CellType_BasementFloor</span><span class="p">,</span> <span class="n">CellType_BasementCorner</span><span class="p">)</span>
<a name="ln-6727"></a>                    <span class="c">!basement cells are partially ground, give them some props</span>
<a name="ln-6728"></a>                    <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Properties</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-6729"></a>                                                <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">GroundProperties</span>
<a name="ln-6730"></a>                <span class="k">END SELECT</span>
<a name="ln-6731"></a>
<a name="ln-6732"></a><span class="k">            END DO</span>
<a name="ln-6733"></a><span class="k">        END DO</span>
<a name="ln-6734"></a><span class="k">    END DO</span>
<a name="ln-6735"></a>
<a name="ln-6736"></a>    <span class="c">!&#39;calculate one-time resistance terms for cartesian cells</span>
<a name="ln-6737"></a>    <span class="k">DO </span><span class="n">Z</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a name="ln-6738"></a>        <span class="k">DO </span><span class="n">Y</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<a name="ln-6739"></a>            <span class="k">DO </span><span class="n">X</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-6740"></a>                <span class="k">CALL </span><span class="n">EvaluateCellNeighborDirections</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">))</span>
<a name="ln-6741"></a>                <span class="k">DO </span><span class="n">DirectionCtr</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">NeighborFieldCells</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-6742"></a>                    <span class="n">CurDirection</span> <span class="o">=</span> <span class="n">NeighborFieldCells</span><span class="p">(</span><span class="n">DirectionCtr</span><span class="p">)</span>
<a name="ln-6743"></a>                    <span class="k">CALL </span><span class="n">EvaluateNeighborCharacteristics</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-6744"></a>                                                         <span class="n">CurDirection</span><span class="p">,</span> <span class="n">NeighborTemp</span><span class="p">,</span> <span class="n">Resistance</span><span class="p">,</span> <span class="n">NX</span><span class="p">,</span> <span class="n">NY</span><span class="p">,</span> <span class="n">NZ</span><span class="p">)</span>
<a name="ln-6745"></a>                    <span class="k">CALL </span><span class="n">SetAdditionalNeighborData</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">CurDirection</span><span class="p">,</span> <span class="n">Resistance</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6746"></a>                                                   <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">NX</span><span class="p">,</span> <span class="n">NY</span><span class="p">,</span> <span class="n">NZ</span><span class="p">))</span>
<a name="ln-6747"></a>                <span class="k">END DO</span>
<a name="ln-6748"></a><span class="k">            END DO</span>
<a name="ln-6749"></a><span class="k">        END DO</span>
<a name="ln-6750"></a><span class="k">    END DO</span>
<a name="ln-6751"></a>
<a name="ln-6752"></a>    <span class="c">!&#39;create circuit array for convenience</span>
<a name="ln-6753"></a>
<a name="ln-6754"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">ListOfCircuitPoints</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6755"></a>
<a name="ln-6756"></a><span class="k">        </span><span class="n">SegCtr2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-6757"></a>
<a name="ln-6758"></a>        <span class="n">TotalSegments</span> <span class="o">=</span> <span class="n">SIZE</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">SIZE</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">PipeSegmentIndeces</span><span class="p">)</span>
<a name="ln-6759"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">ListOfCircuitPoints</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">TotalSegments</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-6760"></a>
<a name="ln-6761"></a>        <span class="k">DO </span><span class="n">SegIndex</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">PipeSegmentIndeces</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-6762"></a>                      <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">PipeSegmentIndeces</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-6763"></a>
<a name="ln-6764"></a>            <span class="c">!&#39;set simulation flow direction</span>
<a name="ln-6765"></a>            <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">PipeSegmentIndeces</span><span class="p">(</span><span class="n">SegIndex</span><span class="p">))%</span><span class="n">FlowDirection</span><span class="p">)</span>
<a name="ln-6766"></a>            <span class="k">CASE</span> <span class="p">(</span><span class="n">SegmentFlow_IncreasingZ</span><span class="p">)</span>
<a name="ln-6767"></a>                <span class="n">StartingZ</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-6768"></a>                <span class="n">EndingZ</span> <span class="o">=</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-6769"></a>                <span class="n">Increment</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-6770"></a>            <span class="k">CASE</span> <span class="p">(</span><span class="n">SegmentFlow_DecreasingZ</span><span class="p">)</span>
<a name="ln-6771"></a>                <span class="n">StartingZ</span> <span class="o">=</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-6772"></a>                <span class="n">EndingZ</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-6773"></a>                <span class="n">Increment</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-6774"></a>            <span class="k">END SELECT</span>
<a name="ln-6775"></a>
<a name="ln-6776"></a><span class="k">            </span><span class="n">PipeX</span> <span class="o">=</span> <span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">PipeSegmentIndeces</span><span class="p">(</span><span class="n">SegIndex</span><span class="p">))%</span><span class="n">PipeCellCoordinates</span><span class="p">%</span><span class="n">X</span>
<a name="ln-6777"></a>            <span class="n">PipeY</span> <span class="o">=</span> <span class="n">PipingSystemSegments</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">PipeSegmentIndeces</span><span class="p">(</span><span class="n">SegIndex</span><span class="p">))%</span><span class="n">PipeCellCoordinates</span><span class="p">%</span><span class="n">Y</span>
<a name="ln-6778"></a>
<a name="ln-6779"></a>            <span class="c">!&#39;loop across all z-direction indeces</span>
<a name="ln-6780"></a>            <span class="k">DO </span><span class="n">Zindex</span> <span class="o">=</span> <span class="n">StartingZ</span><span class="p">,</span> <span class="n">EndingZ</span><span class="p">,</span> <span class="n">Increment</span>
<a name="ln-6781"></a>                <span class="n">SegCtr2</span> <span class="o">=</span> <span class="n">SegCtr2</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-6782"></a>                <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">ListOfCircuitPoints</span><span class="p">(</span><span class="n">SegCtr2</span><span class="p">)</span> <span class="o">=</span> <span class="n">Point3DInteger</span><span class="p">(</span><span class="n">PipeX</span><span class="p">,</span> <span class="n">PipeY</span><span class="p">,</span> <span class="n">Zindex</span><span class="p">)</span>
<a name="ln-6783"></a>            <span class="k">END DO</span>
<a name="ln-6784"></a>
<a name="ln-6785"></a><span class="k">        END DO</span>
<a name="ln-6786"></a>
<a name="ln-6787"></a><span class="k">    END IF</span>
<a name="ln-6788"></a>
<a name="ln-6789"></a>    <span class="c">!&#39;initialize freezing calculation variables</span>
<a name="ln-6790"></a>    <span class="k">CALL </span><span class="n">EvaluateSoilRhoCp</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">InitOnly</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.)</span>
<a name="ln-6791"></a>
<a name="ln-6792"></a>    <span class="c">!&#39;we can also initialize the domain based on the farfield temperature here</span>
<a name="ln-6793"></a>    <span class="k">DO </span><span class="n">Z</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a name="ln-6794"></a>        <span class="k">DO </span><span class="n">Y</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<a name="ln-6795"></a>            <span class="k">DO </span><span class="n">X</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-6796"></a>
<a name="ln-6797"></a>                <span class="c">!On OneTimeInit, the cur sim time should be zero, so this will be OK</span>
<a name="ln-6798"></a>                <span class="n">ThisCellTemp</span> <span class="o">=</span> <span class="n">GetFarfieldTemp</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">))</span>
<a name="ln-6799"></a>                <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span> <span class="o">=</span> <span class="n">ThisCellTemp</span>
<a name="ln-6800"></a>                <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature_PrevIteration</span> <span class="o">=</span> <span class="n">ThisCellTemp</span>
<a name="ln-6801"></a>                <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature_PrevTimeStep</span> <span class="o">=</span> <span class="n">ThisCellTemp</span>
<a name="ln-6802"></a>
<a name="ln-6803"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">CellType</span> <span class="o">==</span> <span class="n">CellType_Pipe</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6804"></a>
<a name="ln-6805"></a><span class="k">                    DO </span><span class="n">rctr</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-6806"></a>                        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">rctr</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span> <span class="o">=</span> <span class="n">ThisCellTemp</span>
<a name="ln-6807"></a>                        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">rctr</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature_PrevIteration</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-6808"></a>                                                                                                                        <span class="n">ThisCellTemp</span>
<a name="ln-6809"></a>                        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">rctr</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature_PrevTimeStep</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-6810"></a>                                                                                                                        <span class="n">ThisCellTemp</span>
<a name="ln-6811"></a>                    <span class="k">END DO</span>
<a name="ln-6812"></a><span class="k">                    </span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Pipe</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span> <span class="o">=</span> <span class="n">ThisCellTemp</span>
<a name="ln-6813"></a>                    <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Pipe</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature_PrevIteration</span> <span class="o">=</span> <span class="n">ThisCellTemp</span>
<a name="ln-6814"></a>                    <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Pipe</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature_PrevTimeStep</span> <span class="o">=</span> <span class="n">ThisCellTemp</span>
<a name="ln-6815"></a>                    <span class="k">IF</span> <span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">HasInsulation</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6816"></a><span class="k">                        </span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Insulation</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span> <span class="o">=</span> <span class="n">ThisCellTemp</span>
<a name="ln-6817"></a>                        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Insulation</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature_PrevIteration</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-6818"></a>                                                                                                                        <span class="n">ThisCellTemp</span>
<a name="ln-6819"></a>                        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Insulation</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature_PrevTimeStep</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-6820"></a>                                                                                                                        <span class="n">ThisCellTemp</span>
<a name="ln-6821"></a>                    <span class="k">END IF</span>
<a name="ln-6822"></a><span class="k">                    </span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Fluid</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span> <span class="o">=</span> <span class="n">ThisCellTemp</span>
<a name="ln-6823"></a>                    <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Fluid</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature_PrevIteration</span> <span class="o">=</span> <span class="n">ThisCellTemp</span>
<a name="ln-6824"></a>                    <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Fluid</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature_PrevTimeStep</span> <span class="o">=</span> <span class="n">ThisCellTemp</span>
<a name="ln-6825"></a>
<a name="ln-6826"></a>                <span class="k">END IF</span>
<a name="ln-6827"></a>
<a name="ln-6828"></a><span class="k">            END DO</span>
<a name="ln-6829"></a><span class="k">        END DO</span>
<a name="ln-6830"></a><span class="k">    END DO</span>
<a name="ln-6831"></a>
<a name="ln-6832"></a><span class="k">END SUBROUTINE</span>
<a name="ln-6833"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-6834"></a>
<a name="ln-6835"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-6836"></a><span class="k">SUBROUTINE </span><span class="n">DoStartOfTimeStepInitializations</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">CircuitNum</span><span class="p">)</span>
<a name="ln-6837"></a>
<a name="ln-6838"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6839"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-6840"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-6841"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6842"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6843"></a>
<a name="ln-6844"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6845"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-6846"></a>
<a name="ln-6847"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6848"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-6849"></a>
<a name="ln-6850"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6851"></a>          <span class="c">! na</span>
<a name="ln-6852"></a>
<a name="ln-6853"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6854"></a>    <span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">OutDryBulbTemp</span><span class="p">,</span> <span class="n">OutRelHum</span><span class="p">,</span> <span class="n">WindSpeed</span><span class="p">,</span> <span class="n">BeamSolarRad</span>
<a name="ln-6855"></a>    <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">,</span> <span class="n">GetDensityGlycol</span><span class="p">,</span> <span class="n">GetConductivityGlycol</span><span class="p">,</span> <span class="n">GetViscosityGlycol</span>
<a name="ln-6856"></a>    <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">PlantLoop</span> <span class="c">!only for fluid name/index</span>
<a name="ln-6857"></a>
<a name="ln-6858"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6859"></a>
<a name="ln-6860"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6861"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DomainNum</span>
<a name="ln-6862"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CircuitNum</span>
<a name="ln-6863"></a>
<a name="ln-6864"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6865"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span>
<a name="ln-6866"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Temperature</span>
<a name="ln-6867"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Beta</span>
<a name="ln-6868"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CellTemp</span>
<a name="ln-6869"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CellRhoCp</span>
<a name="ln-6870"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">radialctr</span>
<a name="ln-6871"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">rCtr</span>
<a name="ln-6872"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FluidCp</span>
<a name="ln-6873"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FluidDensity</span>
<a name="ln-6874"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FluidConductivity</span>
<a name="ln-6875"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FluidViscosity</span>
<a name="ln-6876"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FluidPrandtl</span>
<a name="ln-6877"></a>
<a name="ln-6878"></a>    <span class="c">!Update environmental conditions</span>
<a name="ln-6879"></a>    <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cur</span><span class="p">%</span><span class="n">CurAirTemp</span> <span class="o">=</span> <span class="n">OutDryBulbTemp</span>
<a name="ln-6880"></a>    <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cur</span><span class="p">%</span><span class="n">CurWindSpeed</span> <span class="o">=</span> <span class="n">WindSpeed</span>
<a name="ln-6881"></a>    <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cur</span><span class="p">%</span><span class="n">CurRelativeHumidity</span> <span class="o">=</span> <span class="n">OutRelHum</span>
<a name="ln-6882"></a>    <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cur</span><span class="p">%</span><span class="n">CurIncidentSolar</span> <span class="o">=</span> <span class="n">BeamSolarRad</span>
<a name="ln-6883"></a>
<a name="ln-6884"></a>    <span class="c">!retreive fluid properties based on the circuit inlet temperature -- which varies during the simulation</span>
<a name="ln-6885"></a>    <span class="c">! but need to verify the value of inlet temperature during warmup, etc.</span>
<a name="ln-6886"></a>    <span class="n">FluidCp</span>      <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6887"></a>                                         <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">InletTemperature</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6888"></a>                                         <span class="n">PlantLoop</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6889"></a>                                         <span class="s1">&#39;PipingSystemCircuit::DoStartOfTimeStepInitializations&#39;</span><span class="p">)</span>
<a name="ln-6890"></a>    <span class="n">FluidDensity</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6891"></a>                                        <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">InletTemperature</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6892"></a>                                        <span class="n">PlantLoop</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6893"></a>                                        <span class="s1">&#39;PipingSystemCircuit::DoStartOfTimeStepInitializations&#39;</span><span class="p">)</span>
<a name="ln-6894"></a>    <span class="n">FluidConductivity</span> <span class="o">=</span> <span class="n">GetConductivityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6895"></a>                                        <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">InletTemperature</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6896"></a>                                        <span class="n">PlantLoop</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6897"></a>                                        <span class="s1">&#39;PipingSystemCircuit::DoStartOfTimeStepInitializations&#39;</span><span class="p">)</span>
<a name="ln-6898"></a>    <span class="n">FluidViscosity</span> <span class="o">=</span> <span class="n">GetViscosityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6899"></a>                                        <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">InletTemperature</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6900"></a>                                        <span class="n">PlantLoop</span><span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6901"></a>                                        <span class="s1">&#39;PipingSystemCircuit::DoStartOfTimeStepInitializations&#39;</span><span class="p">)</span>
<a name="ln-6902"></a>
<a name="ln-6903"></a>    <span class="c">!Doesn&#39;t anyone care about poor Ludwig Prandtl?</span>
<a name="ln-6904"></a>    <span class="n">FluidPrandtl</span> <span class="o">=</span> <span class="mf">3.0d0</span>
<a name="ln-6905"></a>
<a name="ln-6906"></a>    <span class="c">!then assign these fluid properties to the current fluid property set for easy lookup as needed</span>
<a name="ln-6907"></a>    <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">CurFluidPropertySet</span> <span class="o">=</span> <span class="n">ExtendedFluidProperties</span><span class="p">(</span>  <span class="p">&amp;</span>
<a name="ln-6908"></a>                                        <span class="n">BaseThermalPropertySet</span><span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-6909"></a>                                            <span class="n">FluidConductivity</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6910"></a>                                            <span class="n">FluidDensity</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-6911"></a>                                            <span class="n">FluidCp</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-6912"></a>                                        <span class="n">FluidViscosity</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6913"></a>                                        <span class="n">FluidPrandtl</span><span class="p">)</span>
<a name="ln-6914"></a>
<a name="ln-6915"></a>    <span class="c">!&#39;now update cell properties</span>
<a name="ln-6916"></a>    <span class="k">DO </span><span class="n">Z</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-6917"></a>        <span class="k">DO </span><span class="n">Y</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-6918"></a>            <span class="k">DO </span><span class="n">X</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-6919"></a>
<a name="ln-6920"></a>                <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">CellType</span><span class="p">)</span>
<a name="ln-6921"></a>                <span class="k">CASE</span><span class="p">(</span><span class="n">CellType_GeneralField</span><span class="p">,</span> <span class="n">CellType_AdiabaticWall</span><span class="p">,</span> <span class="n">CellType_FarfieldBoundary</span><span class="p">,</span> <span class="n">CellType_GroundSurface</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6922"></a>                     <span class="n">CellType_BasementCorner</span><span class="p">,</span> <span class="n">CellType_BasementFloor</span><span class="p">,</span> <span class="n">CellType_BasementWall</span><span class="p">)</span>
<a name="ln-6923"></a>
<a name="ln-6924"></a>                    <span class="c">!UPDATE CELL PROPERTY SETS</span>
<a name="ln-6925"></a>                    <span class="c">!&#39;main ground cells, update with soil properties</span>
<a name="ln-6926"></a>                    <span class="n">CellTemp</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span>
<a name="ln-6927"></a>                    <span class="k">CALL </span><span class="n">EvaluateSoilRhoCp</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">CellTemp</span><span class="p">,</span> <span class="n">CellRhoCp</span><span class="p">)</span>
<a name="ln-6928"></a>                    <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Properties</span><span class="p">%</span><span class="n">SpecificHeat</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-6929"></a>                            <span class="n">CellRhoCp</span> <span class="o">/</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Properties</span><span class="p">%</span><span class="n">Density</span>
<a name="ln-6930"></a>
<a name="ln-6931"></a>                    <span class="c">!UPDATE BETA VALUE</span>
<a name="ln-6932"></a>                    <span class="c">!&#39;these are basic cartesian calculation cells</span>
<a name="ln-6933"></a>                    <span class="n">Beta</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cur</span><span class="p">%</span><span class="n">CurSimTimeStepSize</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-6934"></a>                        <span class="p">(</span>  <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Properties</span><span class="p">%</span><span class="n">Density</span> <span class="p">&amp;</span>
<a name="ln-6935"></a>                         <span class="o">*</span> <span class="n">Volume</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-6936"></a>                         <span class="o">*</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Properties</span><span class="p">%</span><span class="n">SpecificHeat</span><span class="p">)</span>
<a name="ln-6937"></a>                    <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Beta</span> <span class="o">=</span> <span class="n">Beta</span>
<a name="ln-6938"></a>
<a name="ln-6939"></a>                <span class="k">CASE</span><span class="p">(</span><span class="n">CellType_Pipe</span><span class="p">)</span>
<a name="ln-6940"></a>
<a name="ln-6941"></a>                    <span class="c">!UPDATE CELL PROPERTY SETS</span>
<a name="ln-6942"></a>                    <span class="c">!&#39;first update the outer cell itself</span>
<a name="ln-6943"></a>                    <span class="n">CellTemp</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span>
<a name="ln-6944"></a>                    <span class="k">CALL </span><span class="n">EvaluateSoilRhoCp</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">CellTemp</span><span class="p">,</span> <span class="n">CellRhoCp</span><span class="p">)</span>
<a name="ln-6945"></a>                    <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Properties</span><span class="p">%</span><span class="n">SpecificHeat</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-6946"></a>                            <span class="n">CellRhoCp</span> <span class="o">/</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Properties</span><span class="p">%</span><span class="n">Density</span>
<a name="ln-6947"></a>                    <span class="c">!&#39;then update all the soil radial cells</span>
<a name="ln-6948"></a>                    <span class="k">DO </span><span class="n">radialctr</span> <span class="o">=</span> <span class="nb">LBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-6949"></a>                                   <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-6950"></a>                        <span class="n">CellTemp</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">radialctr</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span>
<a name="ln-6951"></a>                        <span class="k">CALL </span><span class="n">EvaluateSoilRhoCp</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">CellTemp</span><span class="p">,</span> <span class="n">CellRhoCp</span><span class="p">)</span>
<a name="ln-6952"></a>                        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">radialctr</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Properties</span><span class="p">%</span><span class="n">SpecificHeat</span><span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-6953"></a>                           <span class="n">CellRhoCp</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-6954"></a>                            <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">radialctr</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Properties</span><span class="p">%</span><span class="n">Density</span>
<a name="ln-6955"></a>                    <span class="k">END DO</span>
<a name="ln-6956"></a>
<a name="ln-6957"></a>                    <span class="c">!UPDATE BETA VALUES</span>
<a name="ln-6958"></a>                    <span class="c">!&#39;set the interface cell</span>
<a name="ln-6959"></a>                    <span class="n">Beta</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cur</span><span class="p">%</span><span class="n">CurSimTimeStepSize</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-6960"></a>                            <span class="p">(</span>  <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Properties</span><span class="p">%</span><span class="n">Density</span> <span class="p">&amp;</span>
<a name="ln-6961"></a>                             <span class="o">*</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">InterfaceVolume</span> <span class="p">&amp;</span>
<a name="ln-6962"></a>                             <span class="o">*</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Properties</span><span class="p">%</span><span class="n">SpecificHeat</span><span class="p">)</span>
<a name="ln-6963"></a>                    <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Beta</span> <span class="o">=</span> <span class="n">Beta</span>
<a name="ln-6964"></a>
<a name="ln-6965"></a>                    <span class="c">!&#39;set the radial soil cells</span>
<a name="ln-6966"></a>                    <span class="k">DO </span><span class="n">rctr</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-6967"></a>                        <span class="n">Beta</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cur</span><span class="p">%</span><span class="n">CurSimTimeStepSize</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-6968"></a>                            <span class="p">(</span>  <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">rctr</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Properties</span><span class="p">%</span><span class="n">Density</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-6969"></a>                          <span class="n">RadialCellInfo_XY_CrossSectArea</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">rctr</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-6970"></a>                             <span class="o">*</span> <span class="n">Depth</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-6971"></a>                             <span class="o">*</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">rctr</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Properties</span><span class="p">%</span><span class="n">SpecificHeat</span><span class="p">)</span>
<a name="ln-6972"></a>                        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Soil</span><span class="p">(</span><span class="n">rctr</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Beta</span> <span class="o">=</span> <span class="n">Beta</span>
<a name="ln-6973"></a>                    <span class="k">END DO</span>
<a name="ln-6974"></a>
<a name="ln-6975"></a>                    <span class="c">!&#39;then insulation if it exists</span>
<a name="ln-6976"></a>                    <span class="k">IF</span> <span class="p">(</span><span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">HasInsulation</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6977"></a><span class="k">                        </span><span class="n">Beta</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cur</span><span class="p">%</span><span class="n">CurSimTimeStepSize</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-6978"></a>                          <span class="p">(</span>  <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Insulation</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Properties</span><span class="p">%</span><span class="n">Density</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-6979"></a>                           <span class="n">RadialCellInfo_XY_CrossSectArea</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Insulation</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-6980"></a>                           <span class="n">Depth</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">))</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-6981"></a>                           <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Insulation</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Properties</span><span class="p">%</span><span class="n">SpecificHeat</span><span class="p">)</span>
<a name="ln-6982"></a>                        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Insulation</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Beta</span> <span class="o">=</span> <span class="n">Beta</span>
<a name="ln-6983"></a>                    <span class="k">END IF</span>
<a name="ln-6984"></a>
<a name="ln-6985"></a>                    <span class="c">!&#39;set the pipe cell</span>
<a name="ln-6986"></a>                    <span class="n">Beta</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cur</span><span class="p">%</span><span class="n">CurSimTimeStepSize</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-6987"></a>                            <span class="p">(</span>  <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Pipe</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Properties</span><span class="p">%</span><span class="n">Density</span> <span class="p">&amp;</span>
<a name="ln-6988"></a>                             <span class="o">*</span> <span class="n">RadialCellInfo_XY_CrossSectArea</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Pipe</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-6989"></a>                             <span class="o">*</span> <span class="n">Depth</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-6990"></a>                             <span class="o">*</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Pipe</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Properties</span><span class="p">%</span><span class="n">SpecificHeat</span><span class="p">)</span>
<a name="ln-6991"></a>                    <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Pipe</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Beta</span> <span class="o">=</span> <span class="n">Beta</span>
<a name="ln-6992"></a>
<a name="ln-6993"></a>                    <span class="c">! now the fluid cell also</span>
<a name="ln-6994"></a>                    <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Fluid</span><span class="p">%</span><span class="n">Properties</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-6995"></a>                            <span class="n">PipingSystemCircuits</span><span class="p">(</span><span class="n">CircuitNum</span><span class="p">)%</span><span class="n">CurFluidPropertySet</span>
<a name="ln-6996"></a>                    <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Fluid</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Beta</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-6997"></a>                        <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cur</span><span class="p">%</span><span class="n">CurSimTimeStepSize</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-6998"></a>                            <span class="p">(</span>  <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Fluid</span><span class="p">%</span><span class="n">Properties</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Density</span> <span class="p">&amp;</span>
<a name="ln-6999"></a>                             <span class="o">*</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Fluid</span><span class="p">%</span><span class="n">Volume</span> <span class="p">&amp;</span>
<a name="ln-7000"></a>                             <span class="o">*</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">PipeCellData</span><span class="p">%</span><span class="n">Fluid</span><span class="p">%</span><span class="n">Properties</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">SpecificHeat</span><span class="p">)</span>
<a name="ln-7001"></a>
<a name="ln-7002"></a>
<a name="ln-7003"></a>                <span class="k">END SELECT</span>
<a name="ln-7004"></a><span class="k">            END DO</span>
<a name="ln-7005"></a><span class="k">        END DO</span>
<a name="ln-7006"></a><span class="k">    END DO</span>
<a name="ln-7007"></a>
<a name="ln-7008"></a>    <span class="c">!&#39;conductivity calculations</span>
<a name="ln-7009"></a>    <span class="c">!&#39;Dim K_quartz As Double = 7.7! &#39;W / mk</span>
<a name="ln-7010"></a>    <span class="c">!&#39;Dim RHO_b As Double = 1290 &#39;!Kg / m3</span>
<a name="ln-7011"></a>    <span class="c">!&#39;Dim qua As Double = 0.32</span>
<a name="ln-7012"></a>    <span class="c">!&#39;Dim porosity As Double = Theta_sat</span>
<a name="ln-7013"></a>    <span class="c">!&#39;Dim K_water As Double = 0.594 &#39;w / mk</span>
<a name="ln-7014"></a>    <span class="c">!&#39;&#39;&quot;Performance Evaluation of Soil Thermal Conductivity Models&quot;</span>
<a name="ln-7015"></a>    <span class="c">!&#39;Dim K_dry As Double = (0.135 * RHO_b + 64.7) / (2700 - 0.947 * RHO_b)</span>
<a name="ln-7016"></a>    <span class="c">!&#39;&#39;from(&quot; An improved model for predicting soil thermal conductivity from water content at room temperature, Fig 4&quot;)</span>
<a name="ln-7017"></a>    <span class="c">!&#39;Dim K_other As Double = 2.0</span>
<a name="ln-7018"></a>    <span class="c">!&#39;Dim K_s As Double = K_quartz ^ qua * K_other ^ (1 - qua)</span>
<a name="ln-7019"></a>    <span class="c">!&#39;Dim K_sat As Double = K_s ^ (1 - porosity) * K_water ^ porosity</span>
<a name="ln-7020"></a>    <span class="c">!&#39;Dim Sr As Double = Theta_liq / Theta_sat</span>
<a name="ln-7021"></a>    <span class="c">!&#39;Dim Ke As Double = Math.Log10(Sr) + 1.0</span>
<a name="ln-7022"></a>    <span class="c">!&#39;If Ke &lt; 0.0 Then</span>
<a name="ln-7023"></a>    <span class="c">!&#39;  Ke = 0.01</span>
<a name="ln-7024"></a>    <span class="c">!&#39;End If</span>
<a name="ln-7025"></a>    <span class="c">!&#39;Dim K_soil As Double = (K_sat - K_dry) * Ke + K_dry</span>
<a name="ln-7026"></a>    <span class="c">!&#39;Dim K1 As Double = K_soil</span>
<a name="ln-7027"></a>
<a name="ln-7028"></a>
<a name="ln-7029"></a>
<a name="ln-7030"></a><span class="k">END SUBROUTINE</span>
<a name="ln-7031"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-7032"></a>
<a name="ln-7033"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-7034"></a><span class="k">SUBROUTINE </span><span class="n">DoEndOfIterationOperations</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">Finished</span><span class="p">)</span>
<a name="ln-7035"></a>
<a name="ln-7036"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-7037"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-7038"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-7039"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-7040"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-7041"></a>
<a name="ln-7042"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-7043"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-7044"></a>
<a name="ln-7045"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7046"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-7047"></a>
<a name="ln-7048"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-7049"></a>          <span class="c">! na</span>
<a name="ln-7050"></a>
<a name="ln-7051"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7052"></a>          <span class="c">! na</span>
<a name="ln-7053"></a>
<a name="ln-7054"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7055"></a>
<a name="ln-7056"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-7057"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DomainNum</span>
<a name="ln-7058"></a>    <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span> <span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Finished</span>
<a name="ln-7059"></a>
<a name="ln-7060"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-7061"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RoutineName</span> <span class="o">=</span> <span class="s1">&#39;DoEndOfIterationOperations&#39;</span>
<a name="ln-7062"></a>
<a name="ln-7063"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7064"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">OutOfRange</span>
<a name="ln-7065"></a>
<a name="ln-7066"></a>    <span class="c">!&#39;check if we have converged for this iteration if we are doing implicit transient</span>
<a name="ln-7067"></a>    <span class="n">Finished</span> <span class="o">=</span> <span class="n">IsConverged_CurrentToPrevIteration</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)</span>
<a name="ln-7068"></a>
<a name="ln-7069"></a>    <span class="c">!&#39;check for out of range temperatures here so they aren&#39;t plotted</span>
<a name="ln-7070"></a>    <span class="c">!&#39;this routine should be *much* more restrictive than the exceptions, so we should be safe with this location</span>
<a name="ln-7071"></a>    <span class="n">OutOfRange</span> <span class="o">=</span> <span class="n">CheckForOutOfRangeTemps</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)</span>
<a name="ln-7072"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">OutOfRange</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7073"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;PipingSystems:&#39;</span><span class="o">//</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;: Out of range temperatures detected in piping system simulation.&#39;</span><span class="p">)</span>
<a name="ln-7074"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This could be due to the size of the pipe circuit in relation to the loads being imposed.&#39;</span><span class="p">)</span>
<a name="ln-7075"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Try increasing the size of the pipe circuit and investigate sizing effects.&#39;</span><span class="p">)</span>
<a name="ln-7076"></a>        <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Preceding error(s) cause program termination&#39;</span><span class="p">)</span>
<a name="ln-7077"></a>    <span class="k">END IF</span>
<a name="ln-7078"></a>
<a name="ln-7079"></a><span class="k">END SUBROUTINE</span>
<a name="ln-7080"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-7081"></a>
<a name="ln-7082"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-7083"></a><span class="k">SUBROUTINE </span><span class="n">EvaluateSoilRhoCp</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">CellTemp</span><span class="p">,</span> <span class="n">rhoCp</span><span class="p">,</span> <span class="n">InitOnly</span><span class="p">)</span>
<a name="ln-7084"></a>
<a name="ln-7085"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-7086"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-7087"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-7088"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-7089"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-7090"></a>
<a name="ln-7091"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-7092"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-7093"></a>
<a name="ln-7094"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7095"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-7096"></a>
<a name="ln-7097"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-7098"></a>          <span class="c">! na</span>
<a name="ln-7099"></a>
<a name="ln-7100"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7101"></a>          <span class="c">! na</span>
<a name="ln-7102"></a>
<a name="ln-7103"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7104"></a>
<a name="ln-7105"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-7106"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DomainNum</span>
<a name="ln-7107"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span><span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">CellTemp</span>
<a name="ln-7108"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">),</span><span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">rhoCp</span>
<a name="ln-7109"></a>    <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">InitOnly</span>
<a name="ln-7110"></a>
<a name="ln-7111"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7112"></a>    <span class="c">!&#39;static variables only calculated once per simulation run</span>
<a name="ln-7113"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span>  <span class="n">Theta_ice</span>
<a name="ln-7114"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span>  <span class="n">Theta_liq</span>
<a name="ln-7115"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span>  <span class="n">Theta_sat</span>
<a name="ln-7116"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span>  <span class="n">rho_ice</span>
<a name="ln-7117"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span>  <span class="n">rho_liq</span>
<a name="ln-7118"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span>  <span class="n">rhoCp_soil_liq_1</span>
<a name="ln-7119"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span>  <span class="n">CP_liq</span>
<a name="ln-7120"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span>  <span class="n">CP_ice</span>
<a name="ln-7121"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span>  <span class="n">Lat_fus</span>
<a name="ln-7122"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span>  <span class="n">Cp_transient</span>
<a name="ln-7123"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span>  <span class="n">rhoCP_soil_liq</span>
<a name="ln-7124"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span>  <span class="n">rhoCP_soil_transient</span>
<a name="ln-7125"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span>  <span class="n">rhoCP_soil_ice</span>
<a name="ln-7126"></a>    <span class="c">!other variables</span>
<a name="ln-7127"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">frzAllIce</span>
<a name="ln-7128"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">frzIceTrans</span>
<a name="ln-7129"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">frzLiqTrans</span>
<a name="ln-7130"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">frzAllLiq</span>
<a name="ln-7131"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhoCP_soil</span>
<a name="ln-7132"></a>
<a name="ln-7133"></a>    <span class="c">!These vary by domain now, so we must be careful to retrieve them every time</span>
<a name="ln-7134"></a>    <span class="n">Theta_liq</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Moisture</span><span class="p">%</span><span class="n">Theta_Liq</span>
<a name="ln-7135"></a>    <span class="n">Theta_sat</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Moisture</span><span class="p">%</span><span class="n">Theta_Sat</span>
<a name="ln-7136"></a>
<a name="ln-7137"></a>    <span class="c">!Assumption</span>
<a name="ln-7138"></a>    <span class="n">Theta_ice</span> <span class="o">=</span> <span class="n">Theta_liq</span>
<a name="ln-7139"></a>
<a name="ln-7140"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">InitOnly</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7141"></a>        <span class="c">!&#39;Cp (freezing) calculations</span>
<a name="ln-7142"></a>        <span class="n">rho_ice</span> <span class="o">=</span> <span class="mi">91</span><span class="mf">7.d0</span> <span class="c">!&#39;Kg / m3</span>
<a name="ln-7143"></a>        <span class="n">rho_liq</span> <span class="o">=</span> <span class="mi">100</span><span class="mf">0.d0</span> <span class="c">!&#39;kg / m3</span>
<a name="ln-7144"></a>        <span class="n">rhoCp_soil_liq_1</span> <span class="o">=</span> <span class="mi">122500</span><span class="mf">0.0d0</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">Theta_sat</span><span class="p">)</span> <span class="c">!&#39;J/m3K</span>
<a name="ln-7145"></a>        <span class="c">!&#39;from(&quot; An improved model for predicting soil thermal conductivity from water content at room temperature, Fig 4&quot;)</span>
<a name="ln-7146"></a>        <span class="n">CP_liq</span> <span class="o">=</span> <span class="mi">418</span><span class="mf">0.0d0</span> <span class="c">!&#39;J / KgK</span>
<a name="ln-7147"></a>        <span class="n">CP_ice</span> <span class="o">=</span> <span class="mi">206</span><span class="mf">6.0d0</span> <span class="c">!&#39;J / KgK</span>
<a name="ln-7148"></a>        <span class="n">Lat_fus</span> <span class="o">=</span> <span class="mi">33400</span><span class="mf">0.d0</span> <span class="c">!&#39;J / Kg</span>
<a name="ln-7149"></a>        <span class="n">Cp_transient</span> <span class="o">=</span> <span class="n">Lat_fus</span> <span class="o">/</span> <span class="mf">0.4d0</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.5d0</span> <span class="o">*</span> <span class="n">CP_ice</span> <span class="o">-</span> <span class="p">(</span><span class="n">CP_liq</span> <span class="o">+</span> <span class="n">CP_ice</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.d0</span> <span class="o">*</span> <span class="mf">0.1d0</span><span class="p">)</span> <span class="o">/</span> <span class="mf">0.4d0</span>
<a name="ln-7150"></a>        <span class="c">!&#39;from(&quot; Numerical and experimental investigation of melting and freezing processes in phase change material storage&quot;)</span>
<a name="ln-7151"></a>        <span class="n">rhoCP_soil_liq</span> <span class="o">=</span> <span class="n">rhoCp_soil_liq_1</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="n">Theta_sat</span><span class="p">)</span> <span class="o">+</span> <span class="n">rho_liq</span> <span class="o">*</span> <span class="n">CP_liq</span> <span class="o">*</span> <span class="n">Theta_liq</span>
<a name="ln-7152"></a>        <span class="n">rhoCP_soil_transient</span> <span class="o">=</span> <span class="n">rhoCp_soil_liq_1</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="n">Theta_sat</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="n">rho_liq</span> <span class="o">+</span> <span class="n">rho_ice</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0d0</span><span class="p">)</span> <span class="o">*</span> <span class="n">Cp_transient</span> <span class="o">*</span> <span class="n">Theta_ice</span>
<a name="ln-7153"></a>        <span class="n">rhoCP_soil_ice</span> <span class="o">=</span> <span class="n">rhoCp_soil_liq_1</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="n">Theta_sat</span><span class="p">)</span> <span class="o">+</span> <span class="n">rho_ice</span> <span class="o">*</span> <span class="n">CP_ice</span> <span class="o">*</span> <span class="n">Theta_ice</span>  <span class="c">!&#39;!J / m3K</span>
<a name="ln-7154"></a>        <span class="k">RETURN</span>
<a name="ln-7155"></a><span class="k">    END IF</span>
<a name="ln-7156"></a>
<a name="ln-7157"></a>    <span class="c">!&#39;set some temperatures here for generalization -- these could be set in the input file</span>
<a name="ln-7158"></a>    <span class="n">frzAllIce</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5d0</span>
<a name="ln-7159"></a>    <span class="n">frzIceTrans</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.4d0</span>
<a name="ln-7160"></a>    <span class="n">frzLiqTrans</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.1d0</span>
<a name="ln-7161"></a>    <span class="n">frzAllLiq</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7162"></a>
<a name="ln-7163"></a>    <span class="c">!&#39;calculate this cell&#39;s new Cp value based on the cell temperature</span>
<a name="ln-7164"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CellTemp</span> <span class="o">&gt;=</span> <span class="n">frzAllLiq</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7165"></a><span class="k">        </span><span class="n">rhoCP_soil</span> <span class="o">=</span> <span class="n">rhoCp_soil_liq_1</span>
<a name="ln-7166"></a>    <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">CellTemp</span> <span class="o">&lt;=</span> <span class="n">frzAllIce</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7167"></a><span class="k">        </span><span class="n">rhoCP_soil</span> <span class="o">=</span> <span class="n">rhoCP_soil_ice</span>
<a name="ln-7168"></a>    <span class="k">ELSE IF</span> <span class="p">((</span><span class="n">CellTemp</span> <span class="o">&lt;</span> <span class="n">frzAllLiq</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">CellTemp</span> <span class="o">&gt;</span> <span class="n">frzLiqTrans</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7169"></a><span class="k">        </span><span class="n">rhoCP_soil</span> <span class="o">=</span> <span class="n">rhoCp_soil_liq_1</span> <span class="o">+</span> <span class="p">(</span><span class="n">rhoCP_soil_transient</span> <span class="o">-</span> <span class="n">rhoCP_soil_liq</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">frzAllLiq</span><span class="o">-</span><span class="n">frzLiqTrans</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">frzAllLiq</span><span class="o">-</span><span class="n">CellTemp</span><span class="p">)</span>
<a name="ln-7170"></a>    <span class="k">ELSE IF</span> <span class="p">((</span><span class="n">CellTemp</span> <span class="o">&lt;=</span> <span class="n">frzLiqTrans</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">CellTemp</span> <span class="o">&gt;=</span> <span class="n">frzIceTrans</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7171"></a><span class="k">        </span><span class="n">rhoCP_soil</span> <span class="o">=</span> <span class="n">rhoCP_soil_transient</span>
<a name="ln-7172"></a>    <span class="k">ELSE IF</span> <span class="p">((</span><span class="n">CellTemp</span> <span class="o">&lt;</span> <span class="n">frzIceTrans</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">CellTemp</span> <span class="o">&gt;</span> <span class="n">frzAllIce</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7173"></a><span class="k">        </span><span class="n">rhoCP_soil</span> <span class="o">=</span> <span class="n">rhoCP_soil_transient</span> <span class="o">+</span> <span class="p">(</span><span class="n">rhoCP_soil_transient</span> <span class="o">-</span> <span class="n">rhoCP_soil_ice</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">frzIceTrans</span><span class="o">-</span><span class="n">frzAllIce</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">CellTemp</span><span class="o">-</span><span class="n">frzAllIce</span><span class="p">)</span>
<a name="ln-7174"></a>    <span class="k">End If</span>
<a name="ln-7175"></a><span class="k">    </span><span class="n">rhoCp</span> <span class="o">=</span> <span class="n">rhoCP_soil</span>
<a name="ln-7176"></a>
<a name="ln-7177"></a><span class="k">END SUBROUTINE</span>
<a name="ln-7178"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-7179"></a>
<a name="ln-7180"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-7181"></a><span class="k">SUBROUTINE </span><span class="n">SetAdditionalNeighborData</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">Direction</span><span class="p">,</span> <span class="n">Resistance</span><span class="p">,</span> <span class="n">NeighborCell</span><span class="p">)</span>
<a name="ln-7182"></a>
<a name="ln-7183"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-7184"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-7185"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-7186"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-7187"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-7188"></a>
<a name="ln-7189"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-7190"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-7191"></a>
<a name="ln-7192"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7193"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-7194"></a>
<a name="ln-7195"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-7196"></a>          <span class="c">! na</span>
<a name="ln-7197"></a>
<a name="ln-7198"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7199"></a>          <span class="c">! na</span>
<a name="ln-7200"></a>
<a name="ln-7201"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7202"></a>
<a name="ln-7203"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-7204"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DomainNum</span>
<a name="ln-7205"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span>
<a name="ln-7206"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Direction</span>
<a name="ln-7207"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Resistance</span>
<a name="ln-7208"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">CartesianCell</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NeighborCell</span>
<a name="ln-7209"></a>
<a name="ln-7210"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7211"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NeighborIndex</span>
<a name="ln-7212"></a>
<a name="ln-7213"></a>    <span class="k">DO </span><span class="n">NeighborIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">NeighborInformation</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-7214"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">NeighborInformation</span><span class="p">(</span><span class="n">NeighborIndex</span><span class="p">)%</span><span class="n">Direction</span> <span class="o">==</span> <span class="n">Direction</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7215"></a><span class="k">           </span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">NeighborInformation</span><span class="p">(</span><span class="n">NeighborIndex</span><span class="p">)%</span><span class="k">Value</span><span class="p">%</span><span class="n">ConductionResistance</span> <span class="o">=</span> <span class="n">Resistance</span>
<a name="ln-7216"></a>           <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)%</span><span class="n">NeighborInformation</span><span class="p">(</span><span class="n">NeighborIndex</span><span class="p">)%</span><span class="k">Value</span><span class="p">%</span><span class="n">NeighborCellIndeces</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-7217"></a>                    <span class="n">Point3DInteger</span><span class="p">(</span><span class="n">NeighborCell</span><span class="p">%</span><span class="n">X_index</span><span class="p">,</span> <span class="n">NeighborCell</span><span class="p">%</span><span class="n">Y_index</span><span class="p">,</span> <span class="n">NeighborCell</span><span class="p">%</span><span class="n">Z_index</span><span class="p">)</span>
<a name="ln-7218"></a>        <span class="k">END IF</span>
<a name="ln-7219"></a><span class="k">    END DO</span>
<a name="ln-7220"></a>
<a name="ln-7221"></a><span class="k">END SUBROUTINE</span>
<a name="ln-7222"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-7223"></a>
<a name="ln-7224"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-7225"></a><span class="k">SUBROUTINE </span><span class="n">EvaluateNeighborCharacteristics</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">ThisCell</span><span class="p">,</span> <span class="n">CurDirection</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7226"></a>                                           <span class="n">NeighborTemp</span><span class="p">,</span> <span class="n">Resistance</span><span class="p">,</span> <span class="n">NeighborX</span><span class="p">,</span> <span class="n">NeighborY</span><span class="p">,</span> <span class="n">NeighborZ</span><span class="p">)</span>
<a name="ln-7227"></a>
<a name="ln-7228"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-7229"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-7230"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-7231"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-7232"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-7233"></a>
<a name="ln-7234"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-7235"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-7236"></a>
<a name="ln-7237"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7238"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-7239"></a>
<a name="ln-7240"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-7241"></a>          <span class="c">! na</span>
<a name="ln-7242"></a>
<a name="ln-7243"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7244"></a>          <span class="c">! na</span>
<a name="ln-7245"></a>
<a name="ln-7246"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7247"></a>
<a name="ln-7248"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-7249"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DomainNum</span>
<a name="ln-7250"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">CartesianCell</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisCell</span>
<a name="ln-7251"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CurDirection</span>
<a name="ln-7252"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NeighborTemp</span>
<a name="ln-7253"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Resistance</span>
<a name="ln-7254"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">NeighborX</span>
<a name="ln-7255"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">NeighborY</span>
<a name="ln-7256"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">NeighborZ</span>
<a name="ln-7257"></a>
<a name="ln-7258"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7259"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisCellLength</span>
<a name="ln-7260"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NeighborCellLength</span>
<a name="ln-7261"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisCellConductivity</span>
<a name="ln-7262"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NeighborConductivity</span>
<a name="ln-7263"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThisNormalArea</span>
<a name="ln-7264"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">NeighborInformation</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TempNeighborInfo</span>
<a name="ln-7265"></a>
<a name="ln-7266"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NX</span><span class="p">,</span> <span class="n">NY</span><span class="p">,</span> <span class="n">NZ</span>
<a name="ln-7267"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span>
<a name="ln-7268"></a>
<a name="ln-7269"></a>    <span class="n">X</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">X_index</span>
<a name="ln-7270"></a>    <span class="n">Y</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">Y_index</span>
<a name="ln-7271"></a>    <span class="n">Z</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">Z_index</span>
<a name="ln-7272"></a>
<a name="ln-7273"></a>    <span class="c">!&#39;get neighbor data</span>
<a name="ln-7274"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">CurDirection</span><span class="p">)</span>
<a name="ln-7275"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">Direction_PositiveY</span><span class="p">)</span>
<a name="ln-7276"></a>        <span class="n">NX</span> <span class="o">=</span> <span class="n">X</span>
<a name="ln-7277"></a>        <span class="n">NY</span> <span class="o">=</span> <span class="n">Y</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-7278"></a>        <span class="n">NZ</span> <span class="o">=</span> <span class="n">Z</span>
<a name="ln-7279"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">Direction_NegativeY</span><span class="p">)</span>
<a name="ln-7280"></a>        <span class="n">NX</span> <span class="o">=</span> <span class="n">X</span>
<a name="ln-7281"></a>        <span class="n">NY</span> <span class="o">=</span> <span class="n">Y</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-7282"></a>        <span class="n">NZ</span> <span class="o">=</span> <span class="n">Z</span>
<a name="ln-7283"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">Direction_PositiveX</span><span class="p">)</span>
<a name="ln-7284"></a>        <span class="n">NX</span> <span class="o">=</span> <span class="n">X</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-7285"></a>        <span class="n">NY</span> <span class="o">=</span> <span class="n">Y</span>
<a name="ln-7286"></a>        <span class="n">NZ</span> <span class="o">=</span> <span class="n">Z</span>
<a name="ln-7287"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">Direction_NegativeX</span><span class="p">)</span>
<a name="ln-7288"></a>        <span class="n">NX</span> <span class="o">=</span> <span class="n">X</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-7289"></a>        <span class="n">NY</span> <span class="o">=</span> <span class="n">Y</span>
<a name="ln-7290"></a>        <span class="n">NZ</span> <span class="o">=</span> <span class="n">Z</span>
<a name="ln-7291"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">Direction_PositiveZ</span><span class="p">)</span>
<a name="ln-7292"></a>        <span class="n">NX</span> <span class="o">=</span> <span class="n">X</span>
<a name="ln-7293"></a>        <span class="n">NY</span> <span class="o">=</span> <span class="n">Y</span>
<a name="ln-7294"></a>        <span class="n">NZ</span> <span class="o">=</span> <span class="n">Z</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-7295"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">Direction_NegativeZ</span><span class="p">)</span>
<a name="ln-7296"></a>        <span class="n">NX</span> <span class="o">=</span> <span class="n">X</span>
<a name="ln-7297"></a>        <span class="n">NY</span> <span class="o">=</span> <span class="n">Y</span>
<a name="ln-7298"></a>        <span class="n">NZ</span> <span class="o">=</span> <span class="n">Z</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-7299"></a>    <span class="k">END SELECT</span>
<a name="ln-7300"></a>
<a name="ln-7301"></a>    <span class="c">!&#39;split effects between the two cells so we can carefully calculate resistance values</span>
<a name="ln-7302"></a>    <span class="n">ThisCellLength</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7303"></a>    <span class="n">NeighborCellLength</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7304"></a>    <span class="n">ThisCellConductivity</span> <span class="o">=</span> <span class="mi">1000</span><span class="mf">0.0D0</span>
<a name="ln-7305"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ThisCell</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Properties</span><span class="p">%</span><span class="n">Conductivity</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">ThisCellConductivity</span> <span class="o">=</span> <span class="n">ThisCell</span><span class="p">%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Properties</span><span class="p">%</span><span class="n">Conductivity</span>
<a name="ln-7306"></a>    <span class="n">NeighborConductivity</span> <span class="o">=</span> <span class="mi">1000</span><span class="mf">0.0D0</span>
<a name="ln-7307"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">NX</span><span class="p">,</span> <span class="n">NY</span><span class="p">,</span> <span class="n">NZ</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Properties</span><span class="p">%</span><span class="n">Conductivity</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">NeighborConductivity</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-7308"></a>                                                <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">NX</span><span class="p">,</span> <span class="n">NY</span><span class="p">,</span> <span class="n">NZ</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Properties</span><span class="p">%</span><span class="n">Conductivity</span>
<a name="ln-7309"></a>
<a name="ln-7310"></a>    <span class="c">!&#39;calculate normal surface area</span>
<a name="ln-7311"></a>    <span class="n">ThisNormalArea</span> <span class="o">=</span> <span class="n">NormalArea</span><span class="p">(</span><span class="n">ThisCell</span><span class="p">,</span> <span class="n">CurDirection</span><span class="p">)</span>
<a name="ln-7312"></a>
<a name="ln-7313"></a>    <span class="c">!&#39;set distance based on cell types</span>
<a name="ln-7314"></a>    <span class="n">TempNeighborInfo</span> <span class="o">=</span> <span class="n">NeighborInformationArray_Value</span><span class="p">(</span><span class="n">ThisCell</span><span class="p">%</span><span class="n">NeighborInformation</span><span class="p">,</span> <span class="n">CurDirection</span><span class="p">)</span>
<a name="ln-7315"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ThisCell</span><span class="p">%</span><span class="n">CellType</span> <span class="o">==</span> <span class="n">CellType_Pipe</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7316"></a>        <span class="c">!&#39;we need to be a bit careful with pipes, as they are full centroid to centroid in the z direction,</span>
<a name="ln-7317"></a>        <span class="c">!&#39; but only centroid to wall in the x and y directions</span>
<a name="ln-7318"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">CurDirection</span> <span class="o">==</span> <span class="n">Direction_NegativeZ</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurDirection</span> <span class="o">==</span> <span class="n">Direction_PositiveZ</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7319"></a><span class="k">            </span><span class="n">ThisCellLength</span> <span class="o">=</span> <span class="n">TempNeighborInfo</span><span class="p">%</span><span class="n">ThisCentroidToNeighborWall</span>
<a name="ln-7320"></a>            <span class="n">NeighborCellLength</span> <span class="o">=</span> <span class="n">TempNeighborInfo</span><span class="p">%</span><span class="n">ThisWallToNeighborCentroid</span>
<a name="ln-7321"></a>        <span class="k">ELSE</span>
<a name="ln-7322"></a><span class="k">            </span><span class="n">ThisCellLength</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7323"></a>            <span class="n">NeighborCellLength</span> <span class="o">=</span> <span class="n">TempNeighborInfo</span><span class="p">%</span><span class="n">ThisWallToNeighborCentroid</span>
<a name="ln-7324"></a>        <span class="k">END IF</span>
<a name="ln-7325"></a><span class="k">    ELSE IF</span> <span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">NX</span><span class="p">,</span> <span class="n">NY</span><span class="p">,</span> <span class="n">NZ</span><span class="p">)%</span><span class="n">CellType</span> <span class="o">==</span> <span class="n">CellType_Pipe</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7326"></a><span class="k">        </span><span class="n">ThisCellLength</span> <span class="o">=</span> <span class="n">TempNeighborInfo</span><span class="p">%</span><span class="n">ThisCentroidToNeighborWall</span>
<a name="ln-7327"></a>        <span class="n">NeighborCellLength</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7328"></a>    <span class="k">ELSE</span>
<a name="ln-7329"></a><span class="k">        </span><span class="n">ThisCellLength</span> <span class="o">=</span> <span class="n">TempNeighborInfo</span><span class="p">%</span><span class="n">ThisCentroidToNeighborWall</span>
<a name="ln-7330"></a>        <span class="n">NeighborCellLength</span> <span class="o">=</span> <span class="n">TempNeighborInfo</span><span class="p">%</span><span class="n">ThisWallToNeighborCentroid</span>
<a name="ln-7331"></a>    <span class="k">END IF</span>
<a name="ln-7332"></a>
<a name="ln-7333"></a>    <span class="c">!&#39;calculate resistance based on different conductivities between the two cells</span>
<a name="ln-7334"></a>    <span class="n">Resistance</span> <span class="o">=</span> <span class="p">(</span><span class="n">ThisCellLength</span> <span class="o">/</span> <span class="p">(</span><span class="n">ThisNormalArea</span> <span class="o">*</span> <span class="n">ThisCellConductivity</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-7335"></a>     <span class="p">(</span><span class="n">NeighborCellLength</span> <span class="o">/</span> <span class="p">(</span><span class="n">ThisNormalArea</span> <span class="o">*</span> <span class="n">NeighborConductivity</span><span class="p">))</span>
<a name="ln-7336"></a>
<a name="ln-7337"></a>    <span class="c">!&#39;return proper temperature for the given simulation type</span>
<a name="ln-7338"></a>    <span class="n">NeighborTemp</span> <span class="o">=</span> <span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">(</span><span class="n">NX</span><span class="p">,</span> <span class="n">NY</span><span class="p">,</span> <span class="n">NZ</span><span class="p">)%</span><span class="n">MyBase</span><span class="p">%</span><span class="n">Temperature</span>
<a name="ln-7339"></a>
<a name="ln-7340"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">NeighborX</span><span class="p">))</span> <span class="n">NeighborX</span> <span class="o">=</span> <span class="n">NX</span>
<a name="ln-7341"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">NeighborX</span><span class="p">))</span> <span class="n">NeighborY</span> <span class="o">=</span> <span class="n">NY</span>
<a name="ln-7342"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">NeighborX</span><span class="p">))</span> <span class="n">NeighborZ</span> <span class="o">=</span> <span class="n">NZ</span>
<a name="ln-7343"></a>
<a name="ln-7344"></a><span class="k">END SUBROUTINE</span>
<a name="ln-7345"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-7346"></a>
<a name="ln-7347"></a><span class="c">!*********************************************************************************************!</span>
<a name="ln-7348"></a><span class="k">SUBROUTINE </span><span class="n">EvaluateCellNeighborDirections</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">,</span> <span class="n">cell</span><span class="p">)</span>
<a name="ln-7349"></a>
<a name="ln-7350"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-7351"></a>          <span class="c">!       AUTHOR         Edwin Lee</span>
<a name="ln-7352"></a>          <span class="c">!       DATE WRITTEN   Summer 2011</span>
<a name="ln-7353"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-7354"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-7355"></a>
<a name="ln-7356"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-7357"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-7358"></a>
<a name="ln-7359"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7360"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-7361"></a>
<a name="ln-7362"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-7363"></a>          <span class="c">! na</span>
<a name="ln-7364"></a>
<a name="ln-7365"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7366"></a>          <span class="c">! na</span>
<a name="ln-7367"></a>
<a name="ln-7368"></a>    <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7369"></a>
<a name="ln-7370"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-7371"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DomainNum</span>
<a name="ln-7372"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">CartesianCell</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cell</span>
<a name="ln-7373"></a>
<a name="ln-7374"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7375"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Xmax</span><span class="p">,</span> <span class="n">Ymax</span><span class="p">,</span> <span class="n">Zmax</span>
<a name="ln-7376"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Xindex</span><span class="p">,</span> <span class="n">Yindex</span><span class="p">,</span> <span class="n">Zindex</span>
<a name="ln-7377"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumFieldCells</span><span class="p">,</span> <span class="n">NumBoundaryCells</span>
<a name="ln-7378"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">FieldCellCtr</span><span class="p">,</span> <span class="n">BoundaryCellCtr</span>
<a name="ln-7379"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">TotalNumDimensions</span> <span class="o">=</span> <span class="mi">6</span>
<a name="ln-7380"></a>
<a name="ln-7381"></a>    <span class="n">Xmax</span> <span class="o">=</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-7382"></a>    <span class="n">Ymax</span> <span class="o">=</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-7383"></a>    <span class="n">Zmax</span> <span class="o">=</span> <span class="nb">UBOUND</span><span class="p">(</span><span class="n">PipingSystemDomains</span><span class="p">(</span><span class="n">DomainNum</span><span class="p">)%</span><span class="n">Cells</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-7384"></a>    <span class="n">Xindex</span> <span class="o">=</span> <span class="n">cell</span><span class="p">%</span><span class="n">X_index</span>
<a name="ln-7385"></a>    <span class="n">Yindex</span> <span class="o">=</span> <span class="n">cell</span><span class="p">%</span><span class="n">Y_index</span>
<a name="ln-7386"></a>    <span class="n">Zindex</span> <span class="o">=</span> <span class="n">cell</span><span class="p">%</span><span class="n">Z_index</span>
<a name="ln-7387"></a>    <span class="c">!Initialize the counters</span>
<a name="ln-7388"></a>
<a name="ln-7389"></a>    <span class="n">NumFieldCells</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-7390"></a>    <span class="n">NumBoundaryCells</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-7391"></a>
<a name="ln-7392"></a>    <span class="c">!First get the count for each array</span>
<a name="ln-7393"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Xindex</span> <span class="o">&lt;</span> <span class="n">Xmax</span><span class="p">)</span>  <span class="n">NumFieldCells</span> <span class="o">=</span> <span class="n">NumFieldCells</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-7394"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Xindex</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>     <span class="n">NumFieldCells</span> <span class="o">=</span> <span class="n">NumFieldCells</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-7395"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Yindex</span> <span class="o">&lt;</span> <span class="n">Ymax</span><span class="p">)</span>  <span class="n">NumFieldCells</span> <span class="o">=</span> <span class="n">NumFieldCells</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-7396"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Yindex</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>     <span class="n">NumFieldCells</span> <span class="o">=</span> <span class="n">NumFieldCells</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-7397"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Zindex</span> <span class="o">&lt;</span> <span class="n">Zmax</span><span class="p">)</span>  <span class="n">NumFieldCells</span> <span class="o">=</span> <span class="n">NumFieldCells</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-7398"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Zindex</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>     <span class="n">NumFieldCells</span> <span class="o">=</span> <span class="n">NumFieldCells</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-7399"></a>    <span class="n">NumBoundaryCells</span> <span class="o">=</span> <span class="n">TotalNumDimensions</span> <span class="o">-</span> <span class="n">NumFieldCells</span>
<a name="ln-7400"></a>
<a name="ln-7401"></a>    <span class="c">!Allocate the arrays</span>
<a name="ln-7402"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">NeighborFieldCells</span><span class="p">))</span> <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">NeighborFieldCells</span><span class="p">)</span>
<a name="ln-7403"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">NeighborFieldCells</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">NumFieldCells</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-7404"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">NeighborBoundaryCells</span><span class="p">))</span> <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">NeighborBoundaryCells</span><span class="p">)</span>
<a name="ln-7405"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">NeighborBoundaryCells</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">NumBoundaryCells</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-7406"></a>
<a name="ln-7407"></a>    <span class="c">!Then add to each array appropriately</span>
<a name="ln-7408"></a>    <span class="n">FieldCellCtr</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-7409"></a>    <span class="n">BoundaryCellCtr</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-7410"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Xindex</span> <span class="o">&lt;</span> <span class="n">Xmax</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7411"></a><span class="k">        </span><span class="n">FieldCellCtr</span> <span class="o">=</span> <span class="n">FieldCellCtr</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-7412"></a>        <span class="n">NeighborFieldCells</span><span class="p">(</span><span class="n">FieldCellCtr</span><span class="p">)</span> <span class="o">=</span> <span class="n">Direction_PositiveX</span>
<a name="ln-7413"></a>    <span class="k">ELSE</span>
<a name="ln-7414"></a><span class="k">        </span><span class="n">BoundaryCellCtr</span> <span class="o">=</span> <span class="n">BoundaryCellCtr</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-7415"></a>        <span class="n">NeighborBoundaryCells</span><span class="p">(</span><span class="n">BoundaryCellCtr</span><span class="p">)</span> <span class="o">=</span> <span class="n">Direction_PositiveX</span>
<a name="ln-7416"></a>    <span class="k">END IF</span>
<a name="ln-7417"></a>
<a name="ln-7418"></a><span class="k">    IF</span><span class="p">(</span><span class="n">Xindex</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>    <span class="k">THEN</span>
<a name="ln-7419"></a><span class="k">        </span><span class="n">FieldCellCtr</span> <span class="o">=</span> <span class="n">FieldCellCtr</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-7420"></a>        <span class="n">NeighborFieldCells</span><span class="p">(</span><span class="n">FieldCellCtr</span><span class="p">)</span> <span class="o">=</span> <span class="n">Direction_NegativeX</span>
<a name="ln-7421"></a>    <span class="k">ELSE</span>
<a name="ln-7422"></a><span class="k">        </span><span class="n">BoundaryCellCtr</span> <span class="o">=</span> <span class="n">BoundaryCellCtr</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-7423"></a>        <span class="n">NeighborBoundaryCells</span><span class="p">(</span><span class="n">BoundaryCellCtr</span><span class="p">)</span> <span class="o">=</span> <span class="n">Direction_NegativeX</span>
<a name="ln-7424"></a>    <span class="k">END IF</span>
<a name="ln-7425"></a>
<a name="ln-7426"></a><span class="k">    IF</span><span class="p">(</span><span class="n">Yindex</span> <span class="o">&lt;</span> <span class="n">Ymax</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7427"></a><span class="k">        </span><span class="n">FieldCellCtr</span> <span class="o">=</span> <span class="n">FieldCellCtr</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-7428"></a>        <span class="n">NeighborFieldCells</span><span class="p">(</span><span class="n">FieldCellCtr</span><span class="p">)</span> <span class="o">=</span> <span class="n">Direction_PositiveY</span>
<a name="ln-7429"></a>    <span class="k">ELSE</span>
<a name="ln-7430"></a><span class="k">        </span><span class="n">BoundaryCellCtr</span> <span class="o">=</span> <span class="n">BoundaryCellCtr</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-7431"></a>        <span class="n">NeighborBoundaryCells</span><span class="p">(</span><span class="n">BoundaryCellCtr</span><span class="p">)</span> <span class="o">=</span> <span class="n">Direction_PositiveY</span>
<a name="ln-7432"></a>    <span class="k">END IF</span>
<a name="ln-7433"></a>
<a name="ln-7434"></a><span class="k">    IF</span><span class="p">(</span><span class="n">Yindex</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>    <span class="k">THEN</span>
<a name="ln-7435"></a><span class="k">        </span><span class="n">FieldCellCtr</span> <span class="o">=</span> <span class="n">FieldCellCtr</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-7436"></a>        <span class="n">NeighborFieldCells</span><span class="p">(</span><span class="n">FieldCellCtr</span><span class="p">)</span> <span class="o">=</span> <span class="n">Direction_NegativeY</span>
<a name="ln-7437"></a>    <span class="k">ELSE</span>
<a name="ln-7438"></a><span class="k">        </span><span class="n">BoundaryCellCtr</span> <span class="o">=</span> <span class="n">BoundaryCellCtr</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-7439"></a>        <span class="n">NeighborBoundaryCells</span><span class="p">(</span><span class="n">BoundaryCellCtr</span><span class="p">)</span> <span class="o">=</span> <span class="n">Direction_NegativeY</span>
<a name="ln-7440"></a>    <span class="k">END IF</span>
<a name="ln-7441"></a>
<a name="ln-7442"></a><span class="k">    IF</span><span class="p">(</span><span class="n">Zindex</span> <span class="o">&lt;</span> <span class="n">Zmax</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7443"></a><span class="k">        </span><span class="n">FieldCellCtr</span> <span class="o">=</span> <span class="n">FieldCellCtr</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-7444"></a>        <span class="n">NeighborFieldCells</span><span class="p">(</span><span class="n">FieldCellCtr</span><span class="p">)</span> <span class="o">=</span> <span class="n">Direction_PositiveZ</span>
<a name="ln-7445"></a>    <span class="k">ELSE</span>
<a name="ln-7446"></a><span class="k">        </span><span class="n">BoundaryCellCtr</span> <span class="o">=</span> <span class="n">BoundaryCellCtr</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-7447"></a>        <span class="n">NeighborBoundaryCells</span><span class="p">(</span><span class="n">BoundaryCellCtr</span><span class="p">)</span> <span class="o">=</span> <span class="n">Direction_PositiveZ</span>
<a name="ln-7448"></a>    <span class="k">END IF</span>
<a name="ln-7449"></a>
<a name="ln-7450"></a><span class="k">    IF</span><span class="p">(</span><span class="n">Zindex</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>    <span class="k">THEN</span>
<a name="ln-7451"></a><span class="k">        </span><span class="n">FieldCellCtr</span> <span class="o">=</span> <span class="n">FieldCellCtr</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-7452"></a>        <span class="n">NeighborFieldCells</span><span class="p">(</span><span class="n">FieldCellCtr</span><span class="p">)</span> <span class="o">=</span> <span class="n">Direction_NegativeZ</span>
<a name="ln-7453"></a>    <span class="k">ELSE</span>
<a name="ln-7454"></a><span class="k">        </span><span class="n">BoundaryCellCtr</span> <span class="o">=</span> <span class="n">BoundaryCellCtr</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-7455"></a>        <span class="n">NeighborBoundaryCells</span><span class="p">(</span><span class="n">BoundaryCellCtr</span><span class="p">)</span> <span class="o">=</span> <span class="n">Direction_NegativeZ</span>
<a name="ln-7456"></a>    <span class="k">END IF</span>
<a name="ln-7457"></a>
<a name="ln-7458"></a><span class="k">END SUBROUTINE</span>
<a name="ln-7459"></a>
<a name="ln-7460"></a>
<a name="ln-7461"></a><span class="c">!     NOTICE</span>
<a name="ln-7462"></a><span class="c">!</span>
<a name="ln-7463"></a><span class="c">!     Copyright © 1996-2013 The Board of Trustees of the University of Illinois</span>
<a name="ln-7464"></a><span class="c">!     and The Regents of the University of California through Ernest Orlando Lawrence</span>
<a name="ln-7465"></a><span class="c">!     Berkeley National Laboratory.  All rights reserved.</span>
<a name="ln-7466"></a><span class="c">!</span>
<a name="ln-7467"></a><span class="c">!     Portions of the EnergyPlus software package have been developed and copyrighted</span>
<a name="ln-7468"></a><span class="c">!     by other individuals, companies and institutions.  These portions have been</span>
<a name="ln-7469"></a><span class="c">!     incorporated into the EnergyPlus software package under license.   For a complete</span>
<a name="ln-7470"></a><span class="c">!     list of contributors, see &quot;Notice&quot; located in EnergyPlus.f90.</span>
<a name="ln-7471"></a><span class="c">!</span>
<a name="ln-7472"></a><span class="c">!     NOTICE: The U.S. Government is granted for itself and others acting on its</span>
<a name="ln-7473"></a><span class="c">!     behalf a paid-up, nonexclusive, irrevocable, worldwide license in this data to</span>
<a name="ln-7474"></a><span class="c">!     reproduce, prepare derivative works, and perform publicly and display publicly.</span>
<a name="ln-7475"></a><span class="c">!     Beginning five (5) years after permission to assert copyright is granted,</span>
<a name="ln-7476"></a><span class="c">!     subject to two possible five year renewals, the U.S. Government is granted for</span>
<a name="ln-7477"></a><span class="c">!     itself and others acting on its behalf a paid-up, non-exclusive, irrevocable</span>
<a name="ln-7478"></a><span class="c">!     worldwide license in this data to reproduce, prepare derivative works,</span>
<a name="ln-7479"></a><span class="c">!     distribute copies to the public, perform publicly and display publicly, and to</span>
<a name="ln-7480"></a><span class="c">!     permit others to do so.</span>
<a name="ln-7481"></a><span class="c">!</span>
<a name="ln-7482"></a><span class="c">!     TRADEMARKS: EnergyPlus is a trademark of the US Department of Energy.</span>
<a name="ln-7483"></a><span class="c">!</span>
<a name="ln-7484"></a><span class="k">END MODULE</span>
</pre></div>

    </section>
    </div>
  </div>

  <section class="visible-xs visible-sm hidden-md">
    <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-1">All Source Files</a></h3></div>
  <div id="allfiles-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


  </section>

    <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2017 </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by
            <a href="https://github.com/cmacmackin/ford">FORD</a>

          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> EnergyPlusFortran</p></div>
      </div>
      <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': {
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>
