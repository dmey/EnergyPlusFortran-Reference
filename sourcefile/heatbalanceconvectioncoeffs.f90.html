<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

	 <meta name="description" content="">

    <meta name="author" content="dmey (forked from NREL)" >
    <link rel="icon" href="../favicon.png">

    <title>HeatBalanceConvectionCoeffs.f90 &ndash; EnergyPlusFortran</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>


    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>


  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">EnergyPlusFortran <small>8.1.0.009</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">

            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
		 aria-expanded="false">Contents <span class="caret"></span></a>
	      <ul class="dropdown-menu">

            <li><a href="../lists/files.html">Source Files</a></li>


            <li><a href="../lists/modules.html">Modules</a></li>


            <li><a href="../lists/procedures.html">Procedures</a></li>


            <li><a href="../lists/types.html">Derived Types</a></li>


            <li><a href="../program/energyplus.html">Program</a></li>

            </ul>
            </li>

<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/energyplus.html">Program</a></li>

          </ul>


        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">


  <div class="row">
    <h1>HeatBalanceConvectionCoeffs.f90
    <small>Source File</small>

    </h1>

<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">


     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
	  data-placement="bottom" data-html="true"
	  title=" 1.6% of total for source files.">6130 statements</a>
     </li>


    <li><i class="fa fa-code"></i><a href="../src/HeatBalanceConvectionCoeffs.f90"> Source File</a></li>

  </ul>
  <ol class="breadcrumb in-well text-right">

     <li class="active">HeatBalanceConvectionCoeffs.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">

<div id="sidebar">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/convectioncoefficients.html">ConvectionCoefficients</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html#src">HeatBalanceConvectionCoeffs.f90</a>
  </div>
</div>


  <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-0">All Source Files</a></h3></div>
  <div id="allfiles-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


</div>

    </div>
    <div class="col-md-9" id='text'>


    <h3>This File Depends On</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefileheatbalanceconvectioncoeffsf90EfferentGraph" width="641pt" height="769pt"
 viewBox="0.00 0.00 641.00 768.68" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph" class="graph" transform="scale(.3102 .3102) rotate(0) translate(4 2473.7471)">
<title>sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-2473.7471 2062.178,-2473.7471 2062.178,4 -4,4"/>
<!-- sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~heatbalanceconvectioncoeffs.f90</title>
<polygon fill="none" stroke="#000000" points="2058.3433,-1846.4138 1885.6825,-1846.4138 1885.6825,-1824.4029 2058.3433,-1824.4029 2058.3433,-1846.4138"/>
<text text-anchor="middle" x="1972.0129" y="-1832.2583" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">HeatBalanceConvectionCoeffs.f90</text>
</g>
<!-- sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~schedulemanager.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node2"><a xlink:href="../sourcefile/schedulemanager.f90.html" xlink:title="ScheduleManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1203.0723,-1828.4138 1088.7424,-1828.4138 1088.7424,-1806.4029 1203.0723,-1806.4029 1203.0723,-1828.4138"/>
<text text-anchor="middle" x="1145.9073" y="-1814.2583" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ScheduleManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge172" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1469.339,-1892.4083C1506.6386,-1887.9328 1505.26,-1861.1936 1526.7905,-1830.4083 1563.135,-1778.4415 1747.287,-1272.9167 1786.9362,-1322.4083"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1163.572,-1828.5925C1213.0877,-1858.4534 1356.9466,-1934.9721 1469.339,-1892.4083"/>
</g>
<!-- sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~datazoneequipment.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node11"><a xlink:href="../sourcefile/datazoneequipment.f90.html" xlink:title="DataZoneEquipment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1849.7598,-1846.4138 1724.1125,-1846.4138 1724.1125,-1824.4029 1849.7598,-1824.4029 1849.7598,-1846.4138"/>
<text text-anchor="middle" x="1786.9362" y="-1832.2583" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataZoneEquipment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge120" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#00ffb2" stroke-dasharray="5,2" d="M1469.339,-1892.4083C1538.2088,-1884.1448 1557.0391,-1904.1174 1625.4075,-1892.4083"/>
</g>
<!-- sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node28" class="node">
<title>sourcefile~nodeinputmanager.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node28"><a xlink:href="../sourcefile/nodeinputmanager.f90.html" xlink:title="NodeInputManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1684.743,-1447.4138 1566.0719,-1447.4138 1566.0719,-1425.4029 1684.743,-1425.4029 1684.743,-1447.4138"/>
<text text-anchor="middle" x="1625.4075" y="-1433.2583" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">NodeInputManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge97" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1176.0199,-1806.4019C1209.6645,-1793.3646 1264.9783,-1769.6776 1307.4386,-1740.4083"/>
</g>
<!-- sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node31" class="node">
<title>sourcefile~outputprocessor.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node31"><a xlink:href="../sourcefile/outputprocessor.f90.html" xlink:title="OutputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1523.0647,-1294.4138 1415.6133,-1294.4138 1415.6133,-1272.4029 1523.0647,-1272.4029 1523.0647,-1294.4138"/>
<text text-anchor="middle" x="1469.339" y="-1280.2583" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge73" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1181.0027,-1806.3655C1188.8429,-1802.7769 1196.6904,-1798.1848 1202.9897,-1792.4083 1227.6165,-1769.8258 1216.1013,-1750.7509 1238.9897,-1726.4083 1288.21,-1674.0611 1333.384,-1698.3421 1375.8875,-1640.4083 1396.3895,-1612.4633 1449.0025,-1376.6853 1464.7924,-1304.395"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1468.2163,-1305.1204 1466.9236,-1294.6047 1461.3765,-1303.6314 1468.2163,-1305.1204"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node36" class="node">
<title>sourcefile~sqlitefortranroutines.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node36"><a xlink:href="../sourcefile/sqlitefortranroutines.f90.html" xlink:title="SQLiteFortranRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1375.8363,-1372.4138 1239.0409,-1372.4138 1239.0409,-1350.4029 1375.8363,-1350.4029 1375.8363,-1372.4138"/>
<text text-anchor="middle" x="1307.4386" y="-1358.2583" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SQLiteFortranRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge57" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1185,-1806.337C1191.8218,-1802.8505 1198.2413,-1798.308 1202.9897,-1792.4083 1254.1431,-1728.8526 1220.2464,-1691.8104 1238.9897,-1612.4083 1259.2702,-1526.495 1288.4788,-1425.4706 1301.1637,-1382.4797"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1304.5334,-1383.427 1304.0172,-1372.8447 1297.8215,-1381.4392 1304.5334,-1383.427"/>
</g>
<!-- sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~dataloopnode.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node3"><a xlink:href="../sourcefile/dataloopnode.f90.html" xlink:title="DataLoopNode.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="846.1377,-2172.4138 745.8318,-2172.4138 745.8318,-2150.4029 846.1377,-2150.4029 846.1377,-2172.4138"/>
<text text-anchor="middle" x="795.9847" y="-2158.2583" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataLoopNode.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge173" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1625.4075,-2238.4083C1692.2256,-2212.1554 1739.4827,-2292.279 1786.9362,-2238.4083"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1786.9362,-2238.4083C1894.6973,-2116.0744 1950.8144,-1920.3948 1966.9945,-1856.4028"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1970.4012,-1857.2064 1969.404,-1846.6586 1963.6058,-1855.5261 1970.4012,-1857.2064"/>
</g>
<!-- sourcefile~curvemanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~curvemanager.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node7"><a xlink:href="../sourcefile/curvemanager.f90.html" xlink:title="CurveManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1029.0877,-2288.4138 930.3078,-2288.4138 930.3078,-2266.4029 1029.0877,-2266.4029 1029.0877,-2288.4138"/>
<text text-anchor="middle" x="979.6978" y="-2274.2583" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CurveManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M846.062,-2172.4037C854.8531,-2175.8842 863.4523,-2180.4439 870.5706,-2186.4083 896.1816,-2207.8681 881.024,-2230.8719 906.5706,-2252.4083 911.0393,-2256.1756 916.1047,-2259.3847 921.4343,-2262.1164"/>
<polygon fill="#7fff00" stroke="#7fff00" points="920.0421,-2265.3281 930.5943,-2266.2774 922.9372,-2258.9549 920.0421,-2265.3281"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge121" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#00ffb2" stroke-dasharray="5,2" d="M979.6978,-2198.4083C1221.6112,-2171.6741 1284.6778,-2197.5434 1526.7905,-2222.4083 1570.9611,-2226.9447 1583.2879,-2252.4637 1625.4075,-2238.4083"/>
<path fill="none" stroke="#00ffb2" stroke-dasharray="5,2" d="M1625.4075,-2238.4083C1702.1372,-2208.2612 1765.6746,-1935.401 1782.5436,-1856.6163"/>
<polygon fill="#00ffb2" stroke="#00ffb2" points="1786.0481,-1856.9599 1784.6898,-1846.4526 1779.1992,-1855.5136 1786.0481,-1856.9599"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge98" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-2198.4083C1022.0261,-2193.5163 1025.9178,-2169.4481 1052.825,-2136.4083 1073.9245,-2110.4998 1062.8703,-2091.4512 1088.825,-2070.4083 1192.2807,-1986.5313 1280.0161,-2076.8591 1375.8875,-1984.4083 1411.7019,-1949.8717 1393.031,-1924.4506 1411.8875,-1878.4083 1480.2671,-1711.444 1581.5809,-1518.3392 1614.5877,-1456.5244"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1617.8124,-1457.9164 1619.4476,-1447.4485 1611.6415,-1454.612 1617.8124,-1457.9164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M836.1515,-2172.4763C881.4831,-2184.437 952.4528,-2201.4192 979.6978,-2198.4083"/>
</g>
<!-- sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node30" class="node">
<title>sourcefile~branchnodeconnections.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node30"><a xlink:href="../sourcefile/branchnodeconnections.f90.html" xlink:title="BranchNodeConnections.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1052.9524,-1714.4138 906.4431,-1714.4138 906.4431,-1692.4029 1052.9524,-1692.4029 1052.9524,-1714.4138"/>
<text text-anchor="middle" x="979.6978" y="-1700.2583" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">BranchNodeConnections.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge114" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M797.4042,-2150.1525C805.367,-2088.6546 846.2951,-1793.6679 906.5706,-1728.4083 909.7283,-1724.9895 913.3729,-1722.0381 917.3145,-1719.4903"/>
<polygon fill="#0000ff" stroke="#0000ff" points="919.2628,-1722.4135 926.3439,-1714.5326 915.8937,-1716.2776 919.2628,-1722.4135"/>
</g>
<!-- sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~vectorutilities.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node4"><a xlink:href="../sourcefile/vectorutilities.f90.html" xlink:title="VectorUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1026.3216,-303.4138 933.0739,-303.4138 933.0739,-281.4029 1026.3216,-281.4029 1026.3216,-303.4138"/>
<text text-anchor="middle" x="979.6978" y="-289.2583" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">VectorUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~vectorutilities.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge174" class="edge">
<title>sourcefile~vectorutilities.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M989.1108,-303.542C1012.3836,-329.8889 1075.8425,-394.7282 1145.9073,-406.4083"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-406.4083C1216.7218,-418.2135 1236.7423,-393.9151 1307.4386,-406.4083"/>
</g>
<!-- sourcefile~general.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~general.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node5"><a xlink:href="../sourcefile/general.f90.html" xlink:title="General.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="829.3535,-1334.4138 762.616,-1334.4138 762.616,-1312.4029 829.3535,-1312.4029 829.3535,-1334.4138"/>
<text text-anchor="middle" x="795.9847" y="-1320.2583" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">General.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge175" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-1360.4083C1188.0617,-1358.0023 1197.0975,-1346.6826 1238.9897,-1341.4083 1324.2907,-1330.6689 1545.1149,-1291.6725 1625.4075,-1322.4083"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M829.6575,-1330.2589C891.917,-1342.1906 1029.3212,-1365.0922 1145.9073,-1360.4083"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M829.5074,-1327.9621C843.7508,-1331.4434 859.5719,-1337.583 870.5706,-1348.4083 904.8328,-1382.1309 884.1432,-1407.8863 906.5706,-1450.4083 957.9437,-1547.8111 1005.9355,-1550.7697 1052.825,-1650.4083 1080.548,-1709.3188 1046.7251,-1742.7433 1088.825,-1792.4083 1091.6189,-1795.7043 1094.9303,-1798.5803 1098.5298,-1801.0873"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1096.9528,-1804.2206 1107.3434,-1806.2907 1100.5116,-1798.1928 1096.9528,-1804.2206"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#ff9900" stroke-dasharray="5,2" d="M802.2187,-1312.1411C816.7935,-1285.2474 853.1756,-1214.8121 870.5706,-1151.4083 959.714,-826.485 976.4132,-412.0855 979.1896,-313.9305"/>
<polygon fill="#ff9900" stroke="#ff9900" points="982.6923,-313.8729 979.4576,-303.7839 975.6947,-313.688 982.6923,-313.8729"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M829.5927,-1326.2107C844.5789,-1329.3059 860.9822,-1335.6263 870.5706,-1348.4083 930.8923,-1428.8222 846.4903,-2171.814 906.5706,-2252.4083 910.4648,-2257.6322 915.5131,-2261.7738 921.1374,-2265.0558"/>
<polygon fill="#7fff00" stroke="#7fff00" points="919.8423,-2268.3177 930.3667,-2269.5375 922.9001,-2262.0209 919.8423,-2268.3177"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge123" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#00ffb2" stroke-dasharray="5,2" d="M979.6978,-1436.4083C1008.1401,-1453.3217 1025.6119,-1431.5808 1052.825,-1450.4083 1117.9698,-1495.4792 1172.9042,-1710.7285 1238.9897,-1754.4083 1315.5358,-1805.0022 1582.4426,-1825.1768 1713.3711,-1832.1696"/>
<polygon fill="#00ffb2" stroke="#00ffb2" points="1713.5336,-1835.6827 1723.7026,-1832.709 1713.8987,-1828.6923 1713.5336,-1835.6827"/>
</g>
<!-- sourcefile~psychroutines.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~psychroutines.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node15"><a xlink:href="../sourcefile/psychroutines.f90.html" xlink:title="PsychRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1195.4562,-836.4138 1096.3585,-836.4138 1096.3585,-814.4029 1195.4562,-814.4029 1195.4562,-836.4138"/>
<text text-anchor="middle" x="1145.9073" y="-822.2583" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PsychRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge136" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M809.7029,-1312.3062C824.8542,-1299.9332 849.8487,-1279.1911 870.5706,-1260.4083 887.1045,-1245.4216 888.6522,-1238.709 906.5706,-1225.4083 966.2348,-1181.1203 1010.757,-1205.6582 1052.825,-1144.4083 1118.3725,-1048.9727 1038.942,-990.8886 1088.825,-886.4083 1096.8731,-869.5515 1111.2705,-854.2168 1123.592,-843.1391"/>
<polygon fill="#0019ff" stroke="#0019ff" points="1126.0072,-845.6782 1131.3015,-836.501 1121.4398,-840.3736 1126.0072,-845.6782"/>
</g>
<!-- sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~dataheatbalance.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node19"><a xlink:href="../sourcefile/dataheatbalance.f90.html" xlink:title="DataHeatBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1201.7241,-568.4138 1090.0905,-568.4138 1090.0905,-546.4029 1201.7241,-546.4029 1201.7241,-568.4138"/>
<text text-anchor="middle" x="1145.9073" y="-554.2583" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge149" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00e5" stroke-dasharray="5,2" d="M814.2262,-1312.3832C831.1494,-1301.2614 855.872,-1282.5923 870.5706,-1260.4083 900.3864,-1215.4084 866.3277,-1180.3874 906.5706,-1144.4083 931.2399,-1122.3527 961.6478,-1158.1433 979.6978,-1130.4083"/>
</g>
<!-- sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node21" class="node">
<title>sourcefile~dataenvironment.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node21"><a xlink:href="../sourcefile/dataenvironment.f90.html" xlink:title="DataEnvironment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1034.8358,-1256.4138 924.5597,-1256.4138 924.5597,-1234.4029 1034.8358,-1234.4029 1034.8358,-1256.4138"/>
<text text-anchor="middle" x="979.6978" y="-1242.2583" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEnvironment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge168" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M817.2612,-1312.2891C839.2841,-1300.9999 874.8437,-1283.3819 906.5706,-1270.4083 915.6034,-1266.7147 925.4065,-1263.1018 934.813,-1259.822"/>
<polygon fill="#ff004c" stroke="#ff004c" points="936.0939,-1263.083 944.4232,-1256.5352 933.8286,-1256.4597 936.0939,-1263.083"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge101" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M829.4194,-1329.0866C843.3139,-1332.7652 858.8879,-1338.7483 870.5706,-1348.4083 895.7217,-1369.2051 881.354,-1391.6909 906.5706,-1412.4083 933.0009,-1434.123 949.5187,-1420.3051 979.6978,-1436.4083"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-1436.4083C1008.8928,-1451.9865 1020.4773,-1443.4327 1052.825,-1450.4083 1076.0874,-1455.4248 1446.644,-1557.5671 1469.339,-1550.4083"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge115" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M829.591,-1326.5911C844.3878,-1329.7805 860.6336,-1336.0703 870.5706,-1348.4083 963.1135,-1463.3123 814.3727,-1563.2273 906.5706,-1678.4083 909.2588,-1681.7668 912.4208,-1684.6761 915.8957,-1687.1962"/>
<polygon fill="#0000ff" stroke="#0000ff" points="914.1278,-1690.2173 924.4958,-1692.398 917.7507,-1684.2277 914.1278,-1690.2173"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge76" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M829.4979,-1318.2117C942.3003,-1300.7391 1301.4936,-1245.2643 1307.4386,-1246.4083"/>
</g>
<!-- sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node32" class="node">
<title>sourcefile~fluidproperties.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node32"><a xlink:href="../sourcefile/fluidproperties.f90.html" xlink:title="FluidProperties.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1029.825,-1064.4138 929.5705,-1064.4138 929.5705,-1042.4029 1029.825,-1042.4029 1029.825,-1064.4138"/>
<text text-anchor="middle" x="979.6978" y="-1050.2583" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">FluidProperties.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge89" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M802,-1312.2489C814.7055,-1288.6668 845.1941,-1232.0194 870.5706,-1184.4083 886.655,-1154.231 885.2474,-1143.1424 906.5706,-1116.4083 920.6768,-1098.7225 940.2414,-1082.17 955.5847,-1070.4737"/>
<polygon fill="#00ff00" stroke="#00ff00" points="957.6803,-1073.2771 963.613,-1064.499 953.5011,-1067.6615 957.6803,-1073.2771"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge59" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1145.9073,-1360.4083C1172.8494,-1358.8706 1202.3599,-1358.6301 1228.7014,-1358.929"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1228.9619,-1362.4329 1239.0104,-1359.0748 1229.0609,-1355.4336 1228.9619,-1362.4329"/>
</g>
<!-- sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~datasurfaces.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node6"><a xlink:href="../sourcefile/datasurfaces.f90.html" xlink:title="DataSurfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="647.8111,-456.4138 554.5531,-456.4138 554.5531,-434.4029 647.8111,-434.4029 647.8111,-456.4138"/>
<text text-anchor="middle" x="601.1821" y="-442.2583" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSurfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge176" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M611.0702,-434.3653C667.9613,-372.1301 957.6031,-72.9741 1145.9073,-215.4083"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#ff9900" stroke-dasharray="5,2" d="M642.2024,-434.3173C656.0414,-430.2888 671.4988,-425.473 685.3989,-420.4083 782.7325,-384.9439 893.9208,-333.4759 947.4972,-307.9573"/>
<polygon fill="#ff9900" stroke="#ff9900" points="949.3012,-310.9744 956.8143,-303.5042 946.2825,-304.6587 949.3012,-310.9744"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M605.3333,-456.5776C619.3776,-494.9034 665.3504,-624.8556 685.3989,-736.4083 723.7114,-949.5847 646.1115,-1019.3227 721.3989,-1222.4083 733.4652,-1254.9566 759.3819,-1286.0944 777.2479,-1304.9813"/>
<polygon fill="#ffe500" stroke="#ffe500" points="774.8708,-1307.5575 784.3479,-1312.294 779.893,-1302.6812 774.8708,-1307.5575"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge150" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00e5" stroke-dasharray="5,2" d="M648.1404,-442.5407C687.6711,-440.7552 745.6517,-439.6078 795.9847,-444.4083"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node33" class="node">
<title>sourcefile~datacontaminantbalance.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node33"><a xlink:href="../sourcefile/datacontaminantbalance.f90.html" xlink:title="DataContaminantBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="870.6565,-494.4138 721.313,-494.4138 721.313,-472.4029 870.6565,-472.4029 870.6565,-494.4138"/>
<text text-anchor="middle" x="795.9847" y="-480.2583" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataContaminantBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge95" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M647.8422,-454.5103C672.1956,-459.2609 702.4206,-465.1569 729.206,-470.3819"/>
<polygon fill="#0000ff" stroke="#0000ff" points="728.7988,-473.8683 739.284,-472.3478 730.1391,-466.9978 728.7988,-473.8683"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge60" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M622.2044,-456.493C724.4896,-510.6183 1166.6834,-746.8933 1202.9897,-805.4083 1256.4645,-891.5937 1205.425,-1164.6959 1238.9897,-1260.4083 1250.1639,-1292.2724 1273.9629,-1323.616 1290.3311,-1342.732"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1287.8162,-1345.1725 1297.0445,-1350.3772 1293.0762,-1340.5536 1287.8162,-1345.1725"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge177" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1029.2041,-2279.0365C1062.2803,-2279.7239 1106.7412,-2279.8783 1145.9073,-2277.4083"/>
</g>
<!-- sourcefile~dataerrortracking.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~dataerrortracking.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node8"><a xlink:href="../sourcefile/dataerrortracking.f90.html" xlink:title="DataErrorTracking.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1526.7421,-2286.4138 1411.9359,-2286.4138 1411.9359,-2264.4029 1526.7421,-2264.4029 1526.7421,-2286.4138"/>
<text text-anchor="middle" x="1469.339" y="-2272.2583" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataErrorTracking.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge178" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1625.4075,-2352.4083C1711.7552,-2336.1276 1728.6779,-2304.188 1786.9362,-2238.4083"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1479.9517,-2286.4573C1504.1718,-2310.3096 1566.0267,-2363.6045 1625.4075,-2352.4083"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge103" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1471.4272,-2264.1824C1488.0544,-2174.7974 1598.94,-1578.6935 1621.4321,-1457.7795"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1624.9387,-1458.066 1623.3266,-1447.5946 1618.0568,-1456.7858 1624.9387,-1458.066"/>
</g>
<!-- sourcefile~dataroomair.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~dataroomair.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node9"><a xlink:href="../sourcefile/dataroomair.f90.html" xlink:title="DataRoomAir.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="647.1421,-767.4138 555.2222,-767.4138 555.2222,-745.4029 647.1421,-745.4029 647.1421,-767.4138"/>
<text text-anchor="middle" x="601.1821" y="-753.2583" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRoomAir.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataroomair.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge179" class="edge">
<title>sourcefile~dataroomair.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M620.1748,-745.2954C724.927,-684.233 1230.2062,-392.76 1307.4386,-406.4083"/>
</g>
<!-- sourcefile~dataroomair.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge61" class="edge">
<title>sourcefile~dataroomair.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M628.5945,-767.4968C678.4861,-788.1808 786.7122,-835.3848 870.5706,-888.4083 958.059,-943.7272 994.0728,-948.1875 1052.825,-1033.4083 1082.7426,-1076.8043 1058.3363,-1103.4117 1088.825,-1146.4083 1125.57,-1198.228 1157.2912,-1188.2822 1202.9897,-1232.4083 1239.5206,-1267.6822 1275.2514,-1315.5202 1293.9733,-1341.9101"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1291.2491,-1344.1211 1299.8596,-1350.2943 1296.9781,-1340.0989 1291.2491,-1344.1211"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~dataprecisionglobals.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node10"><a xlink:href="../sourcefile/dataprecisionglobals.f90.html" xlink:title="DataPrecisionGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="130.719,-820.4138 -.2403,-820.4138 -.2403,-798.4029 130.719,-798.4029 130.719,-820.4138"/>
<text text-anchor="middle" x="65.2394" y="-806.2583" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPrecisionGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge180" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-2429.4083C1188.2182,-2429.9321 1197.1318,-2443.2117 1238.9897,-2449.4083 1340.6074,-2464.4517 1366.701,-2472.6378 1469.339,-2468.4083"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-2049.4083C273.5119,-2097.7916 256.5773,-2140.7515 317.2024,-2174.4083 427.9443,-2235.8883 475.7786,-2216.227 601.1821,-2198.4083"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-2198.4083C629.4035,-2194.6828 1031.7329,-1975.5251 1052.825,-1956.4083 1091.5172,-1921.3398 1121.7754,-1866.9644 1136.3603,-1837.7013"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1139.6237,-1838.9939 1140.8536,-1828.4707 1133.3298,-1835.9301 1139.6237,-1838.9939"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataloopnode.f90</title>
<path fill="none" stroke="#ff4c00" stroke-dasharray="5,2" d="M601.1821,-2198.4083C638.7481,-2193.0706 648.1023,-2191.384 685.3989,-2184.4083 701.7605,-2181.3482 719.4299,-2177.7887 735.741,-2174.3975"/>
<polygon fill="#ff4c00" stroke="#ff4c00" points="736.6267,-2177.7881 745.6976,-2172.3137 735.1927,-2170.9365 736.6267,-2177.7881"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#ff9900" stroke-dasharray="5,2" d="M223.8406,-140.4083C327.3404,-38.8809 736.1187,-172.1614 870.5706,-226.4083 902.1913,-239.1663 935.259,-260.4587 956.59,-275.4008"/>
<polygon fill="#ff9900" stroke="#ff9900" points="954.799,-278.4222 964.9748,-281.3724 958.8597,-272.7204 954.799,-278.4222"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M399.0839,-1278.4083C527.9179,-1268.4283 679.4806,-1296.8178 752.4282,-1313.0078"/>
<polygon fill="#ffe500" stroke="#ffe500" points="752.0837,-1316.5179 762.6085,-1315.302 753.6226,-1309.6891 752.0837,-1316.5179"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M223.8406,-566.4083C277.3201,-530.2252 455.2536,-482.0479 546.3744,-458.9202"/>
<polygon fill="#cbff00" stroke="#cbff00" points="547.4067,-462.2695 556.2449,-456.4268 545.6922,-455.4827 547.4067,-462.2695"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M795.9847,-2390.4083C831.6526,-2386.8523 916.721,-2325.4148 957.3518,-2294.6592"/>
<polygon fill="#7fff00" stroke="#7fff00" points="959.7078,-2297.2643 965.5408,-2288.4196 955.4654,-2291.6963 959.7078,-2297.2643"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M223.8406,-2049.4083C297.2718,-2119.2338 240.3528,-2191.3638 317.2024,-2257.4083 484.6971,-2401.3533 576.2245,-2412.3184 795.9847,-2390.4083"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataerrortracking.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge52" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataerrortracking.f90</title>
<path fill="none" stroke="#33ff00" stroke-dasharray="5,2" d="M795.9847,-2390.4083C995.9573,-2370.9894 1040.4626,-2331.2802 1238.9897,-2300.4083 1293.4962,-2291.9324 1355.7032,-2285.3636 1401.7215,-2281.0908"/>
<polygon fill="#33ff00" stroke="#33ff00" points="1402.2354,-2284.5585 1411.8745,-2280.1609 1401.5969,-2277.5876 1402.2354,-2284.5585"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataroomair.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge54" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataroomair.f90</title>
<path fill="none" stroke="#00ff19" stroke-dasharray="5,2" d="M223.8406,-566.4083C271.8313,-534.492 268.1526,-626.1449 317.2024,-656.4083 389.8456,-701.2288 485.3669,-729.559 545.0185,-744.199"/>
<polygon fill="#00ff19" stroke="#00ff19" points="544.4582,-747.6641 554.9998,-746.6029 546.0973,-740.8587 544.4582,-747.6641"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge124" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#00ffb2" stroke-dasharray="5,2" d="M979.6978,-2429.4083C1060.8182,-2428.7763 1631.4627,-2310.5608 1688.0244,-2252.4083 1744.4003,-2194.4469 1776.3454,-1934.3328 1784.7076,-1857.0975"/>
<polygon fill="#00ffb2" stroke="#00ffb2" points="1788.2359,-1857.014 1785.809,-1846.7009 1781.2749,-1856.2764 1788.2359,-1857.014"/>
<path fill="none" stroke="#00ffb2" stroke-dasharray="5,2" d="M795.9847,-2390.4083C879.0914,-2382.6309 896.4073,-2423.9397 979.6978,-2429.4083"/>
</g>
<!-- sourcefile~dataglobals.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~dataglobals.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node12"><a xlink:href="../sourcefile/dataglobals.f90.html" xlink:title="DataGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="267.6355,-1064.4138 180.0456,-1064.4138 180.0456,-1042.4029 267.6355,-1042.4029 267.6355,-1064.4138"/>
<text text-anchor="middle" x="223.8406" y="-1050.2583" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge132" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M72.4663,-820.5266C97.288,-858.7135 179.2751,-984.8466 211.0766,-1033.7716"/>
<polygon fill="#00ffff" stroke="#00ffff" points="208.1867,-1035.7479 216.5712,-1042.2248 214.0558,-1031.9329 208.1867,-1035.7479"/>
</g>
<!-- sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~datavectortypes.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node13"><a xlink:href="../sourcefile/datavectortypes.f90.html" xlink:title="DataVectorTypes.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="278.8255,-285.4138 168.8556,-285.4138 168.8556,-263.4029 278.8255,-263.4029 278.8255,-285.4138"/>
<text text-anchor="middle" x="223.8406" y="-271.2583" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataVectorTypes.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge133" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90</title>
<path fill="none" stroke="#00b2ff" stroke-dasharray="5,2" d="M68.552,-798.2341C88.366,-731.3967 191.2334,-384.4002 217.6512,-295.2867"/>
<polygon fill="#00b2ff" stroke="#00b2ff" points="221.0595,-296.1035 220.5462,-285.5211 214.3482,-294.1139 221.0595,-296.1035"/>
</g>
<!-- sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~dataipshortcuts.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node14"><a xlink:href="../sourcefile/dataipshortcuts.f90.html" xlink:title="DataIPShortCuts.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="453.3838,-2099.4138 344.7839,-2099.4138 344.7839,-2077.4029 453.3838,-2077.4029 453.3838,-2099.4138"/>
<text text-anchor="middle" x="399.0839" y="-2085.2583" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataIPShortCuts.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge135" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M223.8406,-2049.4083C252.2076,-2078.4518 297.0754,-2088.0368 334.3089,-2090.4456"/>
<polygon fill="#0066ff" stroke="#0066ff" points="334.4301,-2093.9555 344.5882,-2090.9449 334.7698,-2086.9638 334.4301,-2093.9555"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge137" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M223.8406,-566.4083C310.9068,-507.7332 229.5102,-407.1437 317.2024,-349.4083 451.1527,-261.2173 803.4574,-417.237 870.5706,-463.4083 1008.2961,-558.1585 1106.5357,-743.7772 1136.4036,-805.163"/>
<polygon fill="#0019ff" stroke="#0019ff" points="1133.2692,-806.7214 1140.7511,-814.2229 1139.5802,-803.693 1133.2692,-806.7214"/>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M68.9339,-798.1796C82.461,-758.964 133.2821,-627.1959 223.8406,-566.4083"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~dataheatbalfansys.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node16"><a xlink:href="../sourcefile/dataheatbalfansys.f90.html" xlink:title="DataHeatBalFanSys.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1369.5834,-2440.4138 1245.2938,-2440.4138 1245.2938,-2418.4029 1369.5834,-2418.4029 1369.5834,-2440.4138"/>
<text text-anchor="middle" x="1307.4386" y="-2426.2583" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalFanSys.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalfansys.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge141" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalfansys.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M1145.9073,-2429.4083C1175.0048,-2429.4083 1207.0506,-2429.4083 1234.8749,-2429.4083"/>
<polygon fill="#3200ff" stroke="#3200ff" points="1234.9217,-2432.9084 1244.9216,-2429.4083 1234.9216,-2425.9084 1234.9217,-2432.9084"/>
</g>
<!-- sourcefile~dataheatbalsurface.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~dataheatbalsurface.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node17"><a xlink:href="../sourcefile/dataheatbalsurface.f90.html" xlink:title="DataHeatBalSurface.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1688.1416,-2402.4138 1562.6734,-2402.4138 1562.6734,-2380.4029 1688.1416,-2380.4029 1688.1416,-2402.4138"/>
<text text-anchor="middle" x="1625.4075" y="-2388.2583" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalSurface.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalsurface.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge142" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalsurface.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M979.6978,-2429.4083C1053.5664,-2428.8328 1072.0364,-2429.4083 1145.9073,-2429.4083"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1145.9073,-2429.4083C1188.2215,-2429.4083 1197.0277,-2414.8558 1238.9897,-2409.4083 1347.5047,-2395.3211 1474.4202,-2391.8743 1552.356,-2391.23"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1552.5757,-2394.7287 1562.5512,-2391.1595 1552.5272,-2387.7289 1552.5757,-2394.7287"/>
</g>
<!-- sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~datainterfaces.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node18"><a xlink:href="../sourcefile/datainterfaces.f90.html" xlink:title="DataInterfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="447.8836,-1328.4138 350.2841,-1328.4138 350.2841,-1306.4029 447.8836,-1306.4029 447.8836,-1328.4138"/>
<text text-anchor="middle" x="399.0839" y="-1314.2583" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataInterfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge143" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M223.8406,-1278.4083C256.9377,-1303.8371 303.3595,-1313.3341 340.11,-1316.609"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="339.9635,-1320.1079 350.2,-1317.3757 340.494,-1313.128 339.9635,-1320.1079"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge151" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00e5" stroke-dasharray="5,2" d="M601.1821,-102.4083C733.1462,-96.2188 934.9601,-84.0574 1052.825,-211.4083 1116.8484,-280.5845 1062.5339,-329.8925 1088.825,-420.4083 1101.2609,-463.2233 1122.9637,-510.7485 1135.725,-537.0568"/>
<polygon fill="#ff00e5" stroke="#ff00e5" points="1132.7406,-538.9196 1140.2917,-546.3514 1139.0232,-535.8327 1132.7406,-538.9196"/>
<path fill="none" stroke="#ff00e5" stroke-dasharray="5,2" d="M399.0839,-64.4083C488.573,-45.8389 509.8479,-105.753 601.1821,-102.4083"/>
</g>
<!-- sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~inputprocessor.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node20"><a xlink:href="../sourcefile/inputprocessor.f90.html" xlink:title="InputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="650.7412,-1596.4138 551.623,-1596.4138 551.623,-1574.4029 650.7412,-1574.4029 650.7412,-1596.4138"/>
<text text-anchor="middle" x="601.1821" y="-1582.2583" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">InputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge161" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M223.8406,-2049.4083C226.4019,-2052.0308 514.0148,-1612.5837 516.9653,-1610.4083 524.3576,-1604.9581 532.9321,-1600.6886 541.7236,-1597.346"/>
<polygon fill="#ff0098" stroke="#ff0098" points="542.9729,-1600.6178 551.3027,-1594.0707 540.7082,-1593.9943 542.9729,-1600.6178"/>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M65.8331,-820.753C72.1763,-939.9043 129.081,-1959.3018 223.8406,-2049.4083"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge171" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M67.3086,-820.6451C79.6128,-886.165 145.2872,-1218.0553 223.8406,-1278.4083"/>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M223.8406,-1278.4083C250.8574,-1299.1655 483.2725,-1193.4643 516.9653,-1188.4083 639.9155,-1169.9583 674.051,-1184.1326 795.9847,-1208.4083"/>
</g>
<!-- sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node23" class="node">
<title>sourcefile~datasystemvariables.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node23"><a xlink:href="../sourcefile/datasystemvariables.f90.html" xlink:title="DataSystemVariables.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.7837,-2021.4138 334.3841,-2021.4138 334.3841,-1999.4029 463.7837,-1999.4029 463.7837,-2021.4138"/>
<text text-anchor="middle" x="399.0839" y="-2007.2583" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSystemVariables.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-2049.4083C264.1644,-2090.6937 337.8308,-2051.857 375.5146,-2027.2004"/>
<polygon fill="#00ffff" stroke="#00ffff" points="377.506,-2030.0791 383.8483,-2021.5924 373.5978,-2024.2716 377.506,-2030.0791"/>
</g>
<!-- sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node24" class="node">
<title>sourcefile~datahvacglobals.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node24"><a xlink:href="../sourcefile/datahvacglobals.f90.html" xlink:title="DataHVACGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="658.8752,-1752.4138 543.4891,-1752.4138 543.4891,-1730.4029 658.8752,-1730.4029 658.8752,-1752.4138"/>
<text text-anchor="middle" x="601.1821" y="-1738.2583" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHVACGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-2049.4083C259.4115,-2083.2326 271.9118,-2009.3328 317.2024,-1990.4083 386.1433,-1961.6017 429.1139,-2006.2052 480.9653,-1952.4083 539.3981,-1891.7833 460.3948,-1828.7746 516.9653,-1766.4083 521.7157,-1761.1713 527.5074,-1757.0112 533.8074,-1753.7097"/>
<polygon fill="#ff0000" stroke="#ff0000" points="535.6303,-1756.7292 543.3394,-1749.4615 532.7807,-1750.3354 535.6303,-1756.7292"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node25" class="node">
<title>sourcefile~dataruntimelanguage.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node25"><a xlink:href="../sourcefile/dataruntimelanguage.f90.html" xlink:title="DataRuntimeLanguage.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="669.6908,-1219.4138 532.6734,-1219.4138 532.6734,-1197.4029 669.6908,-1197.4029 669.6908,-1219.4138"/>
<text text-anchor="middle" x="601.1821" y="-1205.2583" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRuntimeLanguage.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-1278.4083C285.6024,-1325.8603 321.4306,-1284.4237 399.0839,-1278.4083"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-1278.4083C454.9957,-1274.0771 463.8507,-1251.4009 516.9653,-1233.4083 528.1379,-1229.6237 540.2466,-1225.8439 551.7061,-1222.4115"/>
<polygon fill="#00ffff" stroke="#00ffff" points="552.9735,-1225.6866 561.5695,-1219.4933 550.9874,-1218.9743 552.9735,-1225.6866"/>
</g>
<!-- sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node26" class="node">
<title>sourcefile~databsdfwindow.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node26"><a xlink:href="../sourcefile/databsdfwindow.f90.html" xlink:title="DataBSDFWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="457.5516,-380.4138 340.6161,-380.4138 340.6161,-358.4029 457.5516,-358.4029 457.5516,-380.4138"/>
<text text-anchor="middle" x="399.0839" y="-366.2583" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBSDFWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-566.4083C297.5706,-517.3741 247.6367,-445.1906 317.2024,-390.4083 321.526,-387.0035 326.34,-384.1456 331.4078,-381.7474"/>
<polygon fill="#ff0000" stroke="#ff0000" points="332.8331,-384.9458 340.753,-377.9083 330.1731,-378.4708 332.8331,-384.9458"/>
</g>
<!-- sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node27" class="node">
<title>sourcefile~databranchairloopplant.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node27"><a xlink:href="../sourcefile/databranchairloopplant.f90.html" xlink:title="DataBranchAirLoopPlant.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="471.6693,-2248.4138 326.4984,-2248.4138 326.4984,-2226.4029 471.6693,-2226.4029 471.6693,-2248.4138"/>
<text text-anchor="middle" x="399.0839" y="-2234.2583" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBranchAirLoopPlant.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-2049.4083C282.1747,-2109.1335 251.945,-2160.3369 317.2024,-2212.4083 322.082,-2216.3019 327.5644,-2219.5909 333.3205,-2222.3687"/>
<polygon fill="#ff0000" stroke="#ff0000" points="331.9739,-2225.5995 342.5438,-2226.3267 334.7344,-2219.1668 331.9739,-2225.5995"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge105" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-64.4083C684.617,-5.1589 828.6731,66.1275 1052.825,-120.4083 1092.0404,-153.0429 1064.696,-184.4566 1088.825,-229.4083 1139.8953,-324.5512 1158.7192,-348.1797 1238.9897,-420.4083 1292.4026,-468.4701 1319.7895,-461.5098 1375.8875,-506.4083 1413.0479,-536.1501 1507.4949,-614.898 1526.7905,-658.4083 1587.9563,-796.333 1517.3037,-1192.5494 1562.7905,-1336.4083 1572.5907,-1367.4028 1594.303,-1398.3981 1609.3927,-1417.4827"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1606.7743,-1419.8106 1615.7932,-1425.3704 1612.2099,-1415.3999 1606.7743,-1419.8106"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M66.0921,-798.1597C70.764,-739.7552 95.6872,-465.6868 166.4788,-254.4083 184.4986,-200.6278 185.028,-181.7683 223.8406,-140.4083"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-140.4083C281.9336,-78.5024 316.0679,-82.1708 399.0839,-64.4083"/>
</g>
<!-- sourcefile~datasizing.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node29" class="node">
<title>sourcefile~datasizing.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node29"><a xlink:href="../sourcefile/datasizing.f90.html" xlink:title="DataSizing.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="439.3754,-1943.4138 358.7923,-1943.4138 358.7923,-1921.4029 439.3754,-1921.4029 439.3754,-1943.4138"/>
<text text-anchor="middle" x="399.0839" y="-1929.2583" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSizing.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge112" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M223.8406,-2049.4083C264.545,-2091.0835 267.1525,-1987.2189 317.2024,-1957.4083 326.8815,-1951.6433 338.0071,-1947.1005 348.8741,-1943.5615"/>
<polygon fill="#00ff00" stroke="#00ff00" points="350.1695,-1946.8266 358.7324,-1940.5874 348.1477,-1940.1249 350.1695,-1946.8266"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge78" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-566.4083C449.6246,-563.8516 1271.468,-598.8132 1307.4386,-634.4083"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge90" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M223.8406,-566.4083C263.268,-539.9251 272.8878,-601.3174 317.2024,-618.4083 386.9147,-645.2945 409.5964,-634.2917 480.9653,-656.4083 574.1615,-685.2891 601.2244,-687.07 685.3989,-736.4083 777.2567,-790.2502 799.2573,-809.3437 870.5706,-888.4083 913.0968,-935.5569 951.1136,-1000.659 968.9555,-1033.1945"/>
<polygon fill="#00ff00" stroke="#00ff00" points="965.9876,-1035.0639 973.8276,-1042.1902 972.1428,-1031.7302 965.9876,-1035.0639"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge96" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M399.0839,-566.4083C436.9349,-564.0761 448.0736,-561.2836 480.9653,-542.4083 500.0535,-531.4544 496.8981,-517.4445 516.9653,-508.4083 577.9392,-480.9522 653.9034,-475.7772 711.1669,-476.8696"/>
<polygon fill="#0000ff" stroke="#0000ff" points="711.1848,-480.3711 721.2719,-477.1307 711.3657,-473.3735 711.1848,-480.3711"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M223.8406,-566.4083C288.4951,-522.9802 321.2974,-570.3434 399.0839,-566.4083"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge62" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M223.8406,-1278.4083C484.263,-1497.2187 639.6159,-1391.9159 979.6978,-1398.4083"/>
</g>
<!-- sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node38" class="node">
<title>sourcefile~outputreportpredefined.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node38"><a xlink:href="../sourcefile/outputreportpredefined.f90.html" xlink:title="OutputReportPredefined.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="470.9214,-840.4138 327.2463,-840.4138 327.2463,-818.4029 470.9214,-818.4029 470.9214,-840.4138"/>
<text text-anchor="middle" x="399.0839" y="-826.2583" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputReportPredefined.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge72" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M223.8406,-566.4083C306.8667,-511.1918 253.9018,-693.3678 317.2024,-770.4083 331.4681,-787.7706 351.9907,-802.5443 368.9206,-812.9656"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="367.509,-816.198 377.894,-818.2962 371.0841,-810.1798 367.509,-816.198"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node40" class="node">
<title>sourcefile~datacomplexfenestration.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node40"><a xlink:href="../sourcefile/datacomplexfenestration.f90.html" xlink:title="DataComplexFenestration.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="475.0737,-421.4138 323.0941,-421.4138 323.0941,-399.4029 475.0737,-399.4029 475.0737,-421.4138"/>
<text text-anchor="middle" x="399.0839" y="-407.2583" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataComplexFenestration.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge145" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-566.4083C284.5843,-526.0107 257.3421,-473.1038 317.2024,-431.4083 320.2732,-429.2694 323.5446,-427.3482 326.9463,-425.6227"/>
<polygon fill="#ff0000" stroke="#ff0000" points="328.4967,-428.7636 336.2065,-421.4965 325.6477,-422.3696 328.4967,-428.7636"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node41" class="node">
<title>sourcefile~dataequivalentlayerwindow.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node41"><a xlink:href="../sourcefile/dataequivalentlayerwindow.f90.html" xlink:title="DataEquivalentLayerWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="480.847,-462.4138 317.3208,-462.4138 317.3208,-440.4029 480.847,-440.4029 480.847,-462.4138"/>
<text text-anchor="middle" x="399.0839" y="-448.2583" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEquivalentLayerWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge147" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-566.4083C271.8313,-534.492 267.5243,-505.629 317.2024,-476.4083 324.2157,-472.2831 331.9736,-468.779 339.8372,-465.819"/>
<polygon fill="#00ffff" stroke="#00ffff" points="341.1471,-469.069 349.4384,-462.4731 338.8435,-462.4589 341.1471,-469.069"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge181" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1849.853,-1835.4083C1858.1382,-1835.4083 1866.7775,-1835.4083 1875.4641,-1835.4083"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1875.6647,-1838.9084 1885.6646,-1835.4083 1875.6646,-1831.9084 1875.6647,-1838.9084"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge182" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-604.4083C407.7394,-594.1868 857.6794,-507.0438 870.5706,-503.4083 995.4437,-468.1927 1017.9297,-385.0738 1145.9073,-406.4083"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-1702.4083C631.8713,-1725.4401 658.0619,-1694.483 685.3989,-1721.4083 733.9366,-1769.215 675.0465,-1820.48 721.3989,-1870.4083 745.0917,-1895.929 761.2426,-1892.0344 795.9847,-1894.4083"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9847,-1894.4083C797.8128,-1894.5333 986.7202,-1852.7152 1086.1749,-1830.6623"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1087.089,-1834.0447 1096.094,-1828.4626 1085.5734,-1827.2107 1087.089,-1834.0447"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataloopnode.f90</title>
<path fill="none" stroke="#ff4c00" stroke-dasharray="5,2" d="M227.8565,-1064.6513C238.7917,-1095.856 269.0878,-1186.3833 281.2024,-1264.4083 295.6035,-1357.1601 270.2537,-2027.1305 317.2024,-2108.4083 338.7654,-2145.7383 369.0434,-2129.4883 399.0839,-2160.4083"/>
<path fill="none" stroke="#ff4c00" stroke-dasharray="5,2" d="M399.0839,-2160.4083C421.9408,-2183.9345 630.3694,-2173.017 735.6733,-2165.8782"/>
<polygon fill="#ff4c00" stroke="#ff4c00" points="736.103,-2169.357 745.8393,-2165.179 735.6227,-2162.3735 736.103,-2169.357"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#ff9900" stroke-dasharray="5,2" d="M224.5734,-1042.3391C229.1402,-976.2497 255.5331,-633.8932 317.2024,-552.4083 366.2045,-487.6609 417.982,-522.6581 480.9653,-471.4083 501.1022,-455.0229 496.2716,-441.0846 516.9653,-425.4083 595.2656,-366.0933 627.2329,-369.3721 721.3989,-341.4083 789.2872,-321.2481 869.7655,-307.526 922.6353,-299.8435"/>
<polygon fill="#ff9900" stroke="#ff9900" points="923.4246,-303.2664 932.8292,-298.3874 922.4347,-296.3367 923.4246,-303.2664"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M237.8181,-1064.5678C255.3361,-1077.983 286.7686,-1100.2098 317.2024,-1112.4083 472.3,-1174.5748 560.9875,-1076.8658 685.3989,-1188.4083 723.6997,-1222.7474 685.1549,-1261.905 721.3989,-1298.4083 729.8088,-1306.8784 741.1697,-1312.4789 752.4864,-1316.1821"/>
<polygon fill="#ffe500" stroke="#ffe500" points="751.7696,-1319.6166 762.3448,-1318.9723 753.676,-1312.8812 751.7696,-1319.6166"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M225.5091,-1042.1614C234.0591,-985.564 274.2311,-732.0373 317.2024,-666.4083 342.2073,-628.219 369.5855,-639.2439 399.0839,-604.4083"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M399.0839,-604.4083C423.5905,-575.4677 451.8662,-604.7266 480.9653,-580.4083 508.418,-557.4661 494.0243,-535.8621 516.9653,-508.4083 532.6187,-489.6758 554.8917,-473.3265 572.6008,-461.9804"/>
<polygon fill="#cbff00" stroke="#cbff00" points="574.7427,-464.7701 581.3863,-456.517 571.0461,-458.8257 574.7427,-464.7701"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M399.0839,-2160.4083C465.0481,-2230.1045 511.1793,-2203.1169 601.1821,-2236.4083"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataroomair.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge53" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataroomair.f90</title>
<path fill="none" stroke="#00ff19" stroke-dasharray="5,2" d="M399.0839,-756.4083C420.9878,-739.2973 493.1894,-743.3662 545.0408,-748.9527"/>
<polygon fill="#00ff19" stroke="#00ff19" points="544.7906,-752.4466 555.1187,-750.0845 545.5718,-745.4903 544.7906,-752.4466"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge125" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#00ffb2" stroke-dasharray="5,2" d="M1625.4075,-596.4083C1630.0054,-602.9574 1763.4963,-1651.1454 1784.2389,-1814.1974"/>
<polygon fill="#00ffb2" stroke="#00ffb2" points="1780.8003,-1814.9026 1785.5342,-1824.381 1787.7443,-1814.0193 1780.8003,-1814.9026"/>
<path fill="none" stroke="#00ffb2" stroke-dasharray="5,2" d="M225.5774,-1042.2105C231.8009,-1005.2204 255.9604,-885.0031 317.2024,-809.4083 344.4906,-775.7248 364.9219,-783.0952 399.0839,-756.4083"/>
<path fill="none" stroke="#00ffb2" stroke-dasharray="5,2" d="M399.0839,-756.4083C461.6402,-707.5403 645.9127,-626.9686 721.3989,-602.4083 1000.9698,-511.4471 1083.1272,-479.4774 1375.8875,-506.4083 1493.2829,-517.2075 1557.6673,-499.9221 1625.4075,-596.4083"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge134" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M227.8387,-1064.6541C238.7283,-1095.8659 268.9188,-1186.4098 281.2024,-1264.4083 294.4576,-1348.576 276.2984,-1955.6637 317.2024,-2030.4083 327.2929,-2048.8469 346.0606,-2062.7887 363.0848,-2072.3766"/>
<polygon fill="#0066ff" stroke="#0066ff" points="361.8219,-2075.6683 372.2971,-2077.2562 365.0985,-2069.4825 361.8219,-2075.6683"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge138" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M601.1821,-902.4083C687.7413,-900.5578 709.9027,-911.6712 795.9847,-902.4083"/>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M795.9847,-902.4083C905.9912,-890.5711 1032.0571,-858.0113 1098.7608,-839.2394"/>
<polygon fill="#0019ff" stroke="#0019ff" points="1099.8882,-842.5578 1108.5539,-836.4621 1097.9783,-835.8233 1099.8882,-842.5578"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge152" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00e5" stroke-dasharray="5,2" d="M239.4843,-1042.3307C289.4793,-1008.0212 450.921,-905.6208 601.1821,-902.4083"/>
<path fill="none" stroke="#ff00e5" stroke-dasharray="5,2" d="M601.1821,-902.4083C742.398,-879.789 764.7059,-822.5657 870.5706,-726.4083 889.5297,-709.1877 886.7688,-697.6531 906.5706,-681.4083 968.8118,-630.3476 1055.4809,-591.9162 1105.6401,-572.1985"/>
<polygon fill="#ff00e5" stroke="#ff00e5" points="1107.1076,-575.3835 1115.167,-568.5063 1104.578,-568.8565 1107.1076,-575.3835"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge162" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M226.2747,-1064.4846C236.7741,-1111.4579 279.367,-1293.7915 317.2024,-1337.4083 370.4101,-1398.7466 422.4111,-1362.1514 480.9653,-1418.4083 505.06,-1441.5577 498.1764,-1456.7783 516.9653,-1484.4083 537.6347,-1514.8037 565.6156,-1546.9153 583.5362,-1566.5623"/>
<polygon fill="#ff0098" stroke="#ff0098" points="581.201,-1569.1931 590.5499,-1574.1779 586.3501,-1564.4511 581.201,-1569.1931"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge169" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M601.1821,-1017.4083C646.2848,-1028.635 655.4593,-1043.8569 685.3989,-1079.4083 708.4449,-1106.7741 698.5992,-1123.8371 721.3989,-1151.4083 747.9866,-1183.5603 755.0667,-1200.262 795.9847,-1208.4083"/>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M795.9847,-1208.4083C835.4819,-1216.2718 879.7343,-1225.1813 914.9094,-1232.2868"/>
<polygon fill="#ff004c" stroke="#ff004c" points="914.5522,-1235.7853 925.0473,-1234.3356 915.9388,-1228.924 914.5522,-1235.7853"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M227.4631,-1064.7221C237.3928,-1096.1077 265.3576,-1187.0546 281.2024,-1264.4083 304.4354,-1377.8309 250.5989,-1427.7066 317.2024,-1522.4083 364.4951,-1589.6525 427.7227,-1545.7697 480.9653,-1608.4083 513.7339,-1646.9599 480.5996,-1681.2298 516.9653,-1716.4083 521.8999,-1721.1818 527.7031,-1725.0496 533.9169,-1728.1825"/>
<polygon fill="#ff0000" stroke="#ff0000" points="532.6964,-1731.4687 543.2611,-1732.2668 535.4999,-1725.0547 532.6964,-1731.4687"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M231.6839,-1064.4807C246.1908,-1084.0783 279.2214,-1124.7488 317.2024,-1145.4083 381.1554,-1180.1952 463.1342,-1195.7813 522.5571,-1202.7602"/>
<polygon fill="#00ffff" stroke="#00ffff" points="522.3088,-1206.2542 532.6358,-1203.887 523.0866,-1199.2975 522.3088,-1206.2542"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M225.2517,-1042.1347C236.0724,-955.8578 305.771,-403.1867 317.2024,-390.4083 321.2141,-385.9239 326.0411,-382.3372 331.3193,-379.4758"/>
<polygon fill="#ff0000" stroke="#ff0000" points="332.8818,-382.6108 340.5639,-375.3144 330.0085,-376.2277 332.8818,-382.6108"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M227.8692,-1064.6494C238.8369,-1095.849 269.2083,-1186.3647 281.2024,-1264.4083 296.5732,-1364.4243 270.7205,-2084.5257 317.2024,-2174.4083 327.7265,-2194.759 348.1339,-2210.4859 365.9416,-2221.1367"/>
<polygon fill="#ff0000" stroke="#ff0000" points="364.5249,-2224.3567 374.9508,-2226.2412 367.9757,-2218.2664 364.5249,-2224.3567"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge106" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-900.4083C1248.1345,-894.4168 1288.1264,-833.642 1375.8875,-886.4083 1451.7896,-932.0445 1416.5046,-991.3287 1469.339,-1062.4083"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9847,-902.4083C951.3331,-895.026 990.4905,-906.1733 1145.9073,-900.4083"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1469.339,-1062.4083C1547.4505,-1164.6507 1507.5138,-1220.2215 1562.7905,-1336.4083 1576.769,-1365.7899 1597.5082,-1397.2099 1611.2365,-1416.8268"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1608.5373,-1419.0712 1617.1768,-1425.2039 1614.2474,-1415.0221 1608.5373,-1419.0712"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge111" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M227.6355,-1064.6887C238.0057,-1095.9889 266.9918,-1186.7377 281.2024,-1264.4083 311.0967,-1427.8019 286.9457,-1473.0815 317.2024,-1636.4083 336.7057,-1741.688 375.9947,-1863.9348 392.0278,-1911.7492"/>
<polygon fill="#00ff00" stroke="#00ff00" points="388.7314,-1912.9273 395.2479,-1921.281 395.3632,-1910.6868 388.7314,-1912.9273"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge117" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M601.1821,-1702.4083C624.6147,-1718.9074 791.8655,-1713.3855 896.0557,-1708.1924"/>
<polygon fill="#0000ff" stroke="#0000ff" points="896.4369,-1711.6777 906.2468,-1707.6756 896.0823,-1704.6867 896.4369,-1711.6777"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M227.2768,-1064.7625C236.7306,-1096.2513 263.5917,-1187.4374 281.2024,-1264.4083 300.6637,-1349.4676 261.7487,-1390.0383 317.2024,-1457.4083 366.9681,-1517.8681 430.1322,-1462.8433 480.9653,-1522.4083 528.5628,-1578.1818 465.168,-1631.512 516.9653,-1683.4083 544.0714,-1710.5662 569.9898,-1680.0627 601.1821,-1702.4083"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge79" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-900.4083C1217.576,-896.2078 1254.4785,-851.939 1307.4386,-900.4083"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge91" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M601.1821,-902.4083C744.5639,-902.4083 898.1436,-997.0376 955.9202,-1036.4727"/>
<polygon fill="#00ff00" stroke="#00ff00" points="954.1385,-1039.4959 964.3541,-1042.305 958.1199,-1033.7385 954.1385,-1039.4959"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge94" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M224.3619,-1042.2027C226.9106,-998.9058 241.2625,-840.1052 317.2024,-742.4083 377.8217,-664.4214 658.6795,-541.1033 759.6813,-498.4844"/>
<polygon fill="#0000ff" stroke="#0000ff" points="761.2964,-501.6022 769.1582,-494.4999 758.5833,-495.1493 761.2964,-501.6022"/>
</g>
<!-- sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node34" class="node">
<title>sourcefile~sortandstringutilities.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node34"><a xlink:href="../sourcefile/sortandstringutilities.f90.html" xlink:title="SortAndStringUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.3044,-1025.4138 334.8633,-1025.4138 334.8633,-1003.4029 463.3044,-1003.4029 463.3044,-1025.4138"/>
<text text-anchor="middle" x="399.0839" y="-1011.2583" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SortAndStringUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge55" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M267.6098,-1043.6676C289.3428,-1038.831 315.9254,-1032.9151 339.4864,-1027.6716"/>
<polygon fill="#ff0000" stroke="#ff0000" points="340.3752,-1031.0595 349.3761,-1025.4707 338.8545,-1024.2267 340.3752,-1031.0595"/>
</g>
<!-- sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node35" class="node">
<title>sourcefile~dataoutputs.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node35"><a xlink:href="../sourcefile/dataoutputs.f90.html" xlink:title="DataOutputs.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="443.5485,-1103.4138 354.6193,-1103.4138 354.6193,-1081.4029 443.5485,-1081.4029 443.5485,-1103.4138"/>
<text text-anchor="middle" x="399.0839" y="-1089.2583" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataOutputs.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge56" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M267.6098,-1063.1491C290.9546,-1068.3444 319.8949,-1074.785 344.6753,-1080.2999"/>
<polygon fill="#cbff00" stroke="#cbff00" points="344.134,-1083.7649 354.6555,-1082.5209 345.6547,-1076.9321 344.134,-1083.7649"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge64" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M399.0839,-1053.4083C462.6524,-1053.7229 648.3506,-1093.8715 685.3989,-1127.4083 718.8732,-1157.7099 687.4521,-1192.6371 721.3989,-1222.4083 867.1301,-1350.2139 957.2777,-1277.7914 1145.9073,-1322.4083"/>
</g>
<!-- sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node37" class="node">
<title>sourcefile~dataglobalconstants.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node37"><a xlink:href="../sourcefile/dataglobalconstants.f90.html" xlink:title="DataGlobalConstants.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="860.8052,-1142.4138 731.1643,-1142.4138 731.1643,-1120.4029 860.8052,-1120.4029 860.8052,-1142.4138"/>
<text text-anchor="middle" x="795.9847" y="-1128.2583" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobalConstants.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge69" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataglobalconstants.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M601.1821,-1017.4083C633.4371,-1025.437 691.9692,-1090.9573 721.3989,-1106.4083 728.9601,-1110.3781 737.2775,-1113.9001 745.5306,-1116.9562"/>
<polygon fill="#0066ff" stroke="#0066ff" points="744.5456,-1120.3198 755.1404,-1120.3289 746.8637,-1113.7147 744.5456,-1120.3198"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M399.0839,-1053.4083C490.3181,-1053.8598 512.6482,-995.3711 601.1821,-1017.4083"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M267.7725,-1053.288C303.217,-1053.2199 354.3609,-1053.1871 399.0839,-1053.4083"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge71" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M228.119,-1042.3548C239.3929,-1014.2359 272.1735,-938.6576 317.2024,-888.4083 332.3962,-871.4531 353.261,-856.5098 370.1256,-845.9042"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="372.3104,-848.6712 379.0219,-840.4732 368.6629,-842.6965 372.3104,-848.6712"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node39" class="node">
<title>sourcefile~databranchnodeconnections.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node39"><a xlink:href="../sourcefile/databranchnodeconnections.f90.html" xlink:title="DataBranchNodeConnections.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="685.6163,-1674.4138 516.748,-1674.4138 516.748,-1652.4029 685.6163,-1652.4029 685.6163,-1674.4138"/>
<text text-anchor="middle" x="601.1821" y="-1660.2583" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBranchNodeConnections.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchnodeconnections.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge113" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchnodeconnections.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M226.9002,-1064.6249C242.862,-1123.128 315.9015,-1390.6656 317.2024,-1392.4083 368.4955,-1461.122 430.4922,-1425.0901 480.9653,-1494.4083 519.797,-1547.7385 471.3454,-1590.7552 516.9653,-1638.4083 520.3469,-1641.9407 524.2025,-1644.9803 528.3603,-1647.5953"/>
<polygon fill="#ff0000" stroke="#ff0000" points="526.7999,-1650.7302 537.2642,-1652.3884 530.1179,-1644.5665 526.7999,-1650.7302"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge144" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M225.1572,-1042.2812C234.8738,-960.5265 295.6848,-455.2425 317.2024,-431.4083 318.4194,-430.0603 319.7101,-428.7936 321.0645,-427.6033"/>
<polygon fill="#ff0000" stroke="#ff0000" points="323.3619,-430.2628 329.4486,-421.5909 319.2825,-424.5743 323.3619,-430.2628"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge146" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M224.6809,-1042.1287C229.979,-973.1888 260.3784,-608.5099 317.2024,-514.4083 329.2034,-494.5345 350.0014,-478.6519 367.6325,-467.8052"/>
<polygon fill="#00ffff" stroke="#00ffff" points="369.6496,-470.6796 376.5004,-462.5977 366.105,-464.6434 369.6496,-470.6796"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge183" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1786.9362,-1322.4083C1894.2703,-1495.9031 1952.0365,-1740.7711 1967.6364,-1813.953"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1964.304,-1815.1165 1969.7792,-1824.1869 1971.1554,-1813.6819 1964.304,-1815.1165"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-215.4083C1166.254,-231.7901 1182.0235,-213.8274 1202.9897,-229.4083 1276.3042,-283.8914 1217.8312,-388.69 1307.4386,-406.4083"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1307.4386,-406.4083C1454.7147,-435.5298 1524.5058,-409.2456 1625.4075,-520.4083"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1625.4075,-520.4083C1652.113,-549.0548 1670.5811,-547.3436 1688.0244,-582.4083 1835.8119,-879.493 1612.3636,-1040.2296 1786.9362,-1322.4083"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M230.6338,-263.1129C244.3655,-241.1649 277.5202,-192.4564 317.2024,-164.4083 394.7735,-109.5798 423.5384,-105.5801 516.9653,-88.4083 751.6188,-45.2792 839.6758,-13.2178 1052.825,-120.4083 1105.6348,-146.9659 1099.8644,-178.3376 1145.9073,-215.4083"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#ff9900" stroke-dasharray="5,2" d="M399.0839,-178.4083C502.9919,-171.1218 806.638,-246.9209 928.3562,-278.7403"/>
<polygon fill="#ff9900" stroke="#ff9900" points="927.621,-282.1658 938.1817,-281.3168 929.3965,-275.3947 927.621,-282.1658"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M399.0839,-178.4083C522.4331,-169.7585 580.3229,-359.7912 596.3785,-424.3302"/>
<polygon fill="#cbff00" stroke="#cbff00" points="593.0121,-425.3015 598.7495,-434.2084 599.8188,-423.6677 593.0121,-425.3015"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge153" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00e5" stroke-dasharray="5,2" d="M235.7999,-263.0574C262.5445,-238.8353 330.2642,-183.8376 399.0839,-178.4083"/>
<path fill="none" stroke="#ff00e5" stroke-dasharray="5,2" d="M399.0839,-178.4083C494.7493,-170.8613 505.3249,-106.9044 601.1821,-102.4083"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M244.2862,-285.492C275.2837,-302.2959 334.3129,-334.2958 369.8431,-353.5568"/>
<polygon fill="#ff0000" stroke="#ff0000" points="368.3091,-356.7064 378.7685,-358.3953 371.6452,-350.5525 368.3091,-356.7064"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge184" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M421.8735,-2099.4557C440.2019,-2109.4066 465.3837,-2125.6488 480.9653,-2146.4083 510.3276,-2185.528 480.0438,-2218.3258 516.9653,-2250.4083 559.4882,-2287.3581 1408.5771,-2393.2914 1625.4075,-2352.4083"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M441.4575,-2077.3899C547.1475,-2049.2471 829.9438,-1969.8709 1052.825,-1870.4083 1076.5047,-1859.841 1102.0048,-1845.061 1120.3165,-1833.7928"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1122.3031,-1836.6788 1128.9388,-1828.4194 1118.6008,-1830.738 1122.3031,-1836.6788"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M418.1987,-2077.2131C435.6319,-2066.4816 461.5545,-2049.1785 480.9653,-2030.4083 534.9392,-1978.2158 658.3602,-1831.4522 685.3989,-1761.4083 718.5757,-1675.4638 664.3951,-1420.7805 721.3989,-1348.4083 729.0571,-1338.6855 740.6402,-1332.7136 752.4097,-1329.0553"/>
<polygon fill="#ffe500" stroke="#ffe500" points="753.4602,-1332.3986 762.2578,-1326.495 751.6989,-1325.6238 753.4602,-1332.3986"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M419.9322,-2099.5513C437.8011,-2109.885 463.368,-2126.6224 480.9653,-2146.4083 503.1708,-2171.3755 490.8697,-2191.5406 516.9653,-2212.4083 547.3617,-2236.7151 564.6794,-2222.9062 601.1821,-2236.4083"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M601.1821,-2236.4083C684.0782,-2267.0711 710.0025,-2255.9384 795.9847,-2276.4083"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge163" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M425.2308,-2077.3181C444.1511,-2067.8084 468.5008,-2052.1781 480.9653,-2030.4083 527.5108,-1949.1149 457.7815,-1683.0196 516.9653,-1610.4083 523.3973,-1602.5171 532.2007,-1597.0414 541.7016,-1593.258"/>
<polygon fill="#ff0098" stroke="#ff0098" points="543.0064,-1596.512 551.3729,-1590.012 540.779,-1589.8758 543.0064,-1596.512"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge81" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M453.3433,-2087.6612C569.9294,-2083.9514 850.179,-2063.6191 1052.825,-1956.4083 1073.6822,-1945.3737 1374.3554,-1699.8791 1375.8875,-1697.4083 1414.5285,-1635.0941 1395.769,-1607.9373 1411.8875,-1536.4083 1431.2888,-1450.3107 1454.648,-1347.7937 1464.5402,-1304.4319"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1467.9934,-1305.0308 1466.8059,-1294.5028 1461.1688,-1303.4735 1467.9934,-1305.0308"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge185" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1148.0739,-813.9931C1155.083,-780.0034 1180.1881,-678.2388 1238.9897,-620.4083 1278.7765,-581.2787 1413.6299,-523.6661 1469.339,-520.4083"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge104" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1155.2603,-814.1557C1197.4742,-764.5974 1372.3891,-572.602 1469.339,-672.4083"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge186" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1469.339,-2468.4083C1569.6022,-2462.4372 1608.2596,-2472.4488 1688.0244,-2411.4083 1758.3611,-2357.5827 1728.2139,-2304.7118 1786.9362,-2238.4083"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1343.0768,-2440.4197C1382.932,-2452.2999 1445.0737,-2469.4083 1469.339,-2468.4083"/>
</g>
<!-- sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge187" class="edge">
<title>sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1662.5745,-2380.3387C1671.4078,-2376.7187 1680.4557,-2372.119 1688.0244,-2366.4083 1745.4161,-2323.106 1739.2689,-2292.2296 1786.9362,-2238.4083"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge188" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M402.3805,-1328.4624C413.816,-1366.9405 452.6237,-1498.6457 480.9653,-1608.4083 498.4302,-1676.0469 493.5705,-1695.5852 516.9653,-1761.4083 574.3767,-1922.9396 620.2786,-1949.8279 685.3989,-2108.4083 704.2987,-2154.4329 682.3397,-2183.589 721.3989,-2214.4083 811.9102,-2285.8255 866.0033,-2219.2704 979.6978,-2238.4083"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-1624.4083C627.894,-1651.954 648.5707,-1632.6393 685.3989,-1643.4083 785.7288,-1672.746 806.7276,-1692.4539 906.5706,-1723.4083 938.6445,-1733.3523 950.0631,-1726.6156 979.6978,-1742.4083"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M418.4286,-1328.5643C437.5952,-1340.709 466.1657,-1361.9767 480.9653,-1388.4083 528.7273,-1473.7097 449.8522,-1534.3214 516.9653,-1605.4083 543.3063,-1633.309 574.8669,-1596.4835 601.1821,-1624.4083"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#ff9900" stroke-dasharray="5,2" d="M601.1821,-1247.4083C631.0549,-1223.3271 659.8911,-1257.0726 685.3989,-1228.4083 735.9073,-1171.6497 702.0706,-961.8866 721.3989,-888.4083 753.4426,-766.5917 926.2479,-403.5411 969.752,-313.0266"/>
<polygon fill="#ff9900" stroke="#ff9900" points="973.0071,-314.3338 974.1903,-303.8053 966.6996,-311.298 973.0071,-314.3338"/>
<path fill="none" stroke="#ff9900" stroke-dasharray="5,2" d="M447.9805,-1309.905C491.8908,-1301.1238 556.1856,-1282.9953 601.1821,-1247.4083"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M601.1821,-1323.4083C653.119,-1320.8187 712.9417,-1321.3399 752.4412,-1322.1692"/>
<polygon fill="#ffe500" stroke="#ffe500" points="752.4469,-1325.6701 762.5234,-1322.3969 752.605,-1318.6719 752.4469,-1325.6701"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge50" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M795.9847,-2276.4083C836.5095,-2286.0561 883.5025,-2286.1199 919.8155,-2283.8677"/>
<polygon fill="#7fff00" stroke="#7fff00" points="920.5085,-2287.3279 930.2405,-2283.14 920.021,-2280.3449 920.5085,-2287.3279"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M402.7566,-1328.6603C415.2439,-1367.2516 456.6347,-1497.9561 480.9653,-1608.4083 531.4356,-1837.5248 457.6164,-1936.8538 601.1821,-2122.4083"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M601.1821,-2122.4083C629.6242,-2159.1689 655.048,-2149.2073 685.3989,-2184.4083 707.7292,-2210.307 695.1915,-2230.4412 721.3989,-2252.4083 748.0868,-2274.7782 762.1084,-2268.3434 795.9847,-2276.4083"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge128" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#00ffb2" stroke-dasharray="5,2" d="M1145.9073,-2084.4083C1217.0368,-2094.1371 1237.05,-2098.5325 1307.4386,-2084.4083"/>
<path fill="none" stroke="#00ffb2" stroke-dasharray="5,2" d="M601.1821,-1624.4083C627.4974,-1652.3332 655.0593,-1619.918 685.3989,-1643.4083 713.0611,-1664.8257 700.5043,-1685.3492 721.3989,-1713.4083 796.226,-1813.8928 1021.7785,-2067.4307 1145.9073,-2084.4083"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge140" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M795.9847,-1092.4083C938.7123,-1025.1032 1078.8683,-892.647 1127.7295,-843.9438"/>
<polygon fill="#0019ff" stroke="#0019ff" points="1130.4513,-846.1706 1135.0257,-836.6142 1125.4902,-841.2322 1130.4513,-846.1706"/>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M601.1821,-1247.4083C631.2778,-1223.6063 657.2479,-1254.4815 685.3989,-1228.4083 725.3147,-1191.439 681.9961,-1148.9239 721.3989,-1111.4083 746.1736,-1087.8203 765.6134,-1108.1489 795.9847,-1092.4083"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge155" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00e5" stroke-dasharray="5,2" d="M601.1821,-1247.4083C631.2778,-1223.6063 658.0824,-1255.3545 685.3989,-1228.4083 734.2078,-1180.2613 689.1408,-1138.9051 721.3989,-1078.4083 767.4502,-992.0442 807.5755,-991.3157 870.5706,-916.4083 975.9477,-791.1044 1092.2612,-631.8485 1131.8408,-577.0012"/>
<polygon fill="#ff00e5" stroke="#ff00e5" points="1134.9181,-578.7173 1137.9226,-568.5574 1129.2381,-574.6261 1134.9181,-578.7173"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge167" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M448.2116,-1323.7286C460.2938,-1327.4345 472.249,-1333.2629 480.9653,-1342.4083 525.8844,-1389.5389 487.3826,-1426.4094 516.9653,-1484.4083 533.5588,-1516.941 562.2967,-1548.2517 581.5234,-1567.1655"/>
<polygon fill="#ff0098" stroke="#ff0098" points="579.2431,-1569.8287 588.8722,-1574.2481 584.1007,-1564.7885 579.2431,-1569.8287"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge170" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M601.1821,-1323.4083C701.5972,-1318.4015 697.3801,-1188.7772 795.9847,-1208.4083"/>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M448.1115,-1321.0418C489.0524,-1323.5531 548.9451,-1326.013 601.1821,-1323.4083"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M448.2233,-1308.6762C459.7609,-1304.9983 471.4516,-1299.7864 480.9653,-1292.4083 505.2394,-1273.5835 492.6184,-1252.1389 516.9653,-1233.4083 522.0424,-1229.5025 527.7204,-1226.2053 533.6654,-1223.4222"/>
<polygon fill="#00ffff" stroke="#00ffff" points="535.2947,-1226.5351 543.1795,-1219.4584 532.6026,-1220.0735 535.2947,-1226.5351"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge107" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9847,-1362.4083C853.6279,-1387.3603 850.1652,-1422.7721 906.5706,-1450.4083 1134.6975,-1562.1808 1229.2852,-1633.5296 1469.339,-1550.4083"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge118" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M447.9787,-1323.9401C459.0465,-1326.2435 470.5887,-1329.32 480.9653,-1333.4083 670.837,-1408.2174 742.8504,-1417.2379 870.5706,-1576.4083 900.6573,-1613.9037 872.4096,-1644.5832 906.5706,-1678.4083 910.2307,-1682.0326 914.4377,-1685.132 918.9451,-1687.7825"/>
<polygon fill="#0000ff" stroke="#0000ff" points="917.4186,-1690.9328 927.9188,-1692.3464 920.592,-1684.6934 917.4186,-1690.9328"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge88" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9847,-1092.4083C865.4737,-1056.3943 1072.2871,-1105.842 1145.9073,-1132.4083"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-1132.4083C1170.5048,-1141.2014 1180.0917,-1133.8373 1202.9897,-1146.4083 1259.3255,-1177.3368 1244.506,-1233.3789 1307.4386,-1246.4083"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1307.4386,-1246.4083C1342.8508,-1253.74 1382.4265,-1262.7692 1413.5853,-1270.0725"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1412.8544,-1273.496 1423.3901,-1272.3787 1414.4572,-1266.682 1412.8544,-1273.496"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge92" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M795.9847,-1092.4083C817.5759,-1082.2268 874.5706,-1070.9333 919.4053,-1063.1309"/>
<polygon fill="#00ff00" stroke="#00ff00" points="920.0858,-1066.5654 929.3487,-1061.4225 918.9004,-1059.6665 920.0858,-1066.5654"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge65" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M795.9847,-1362.4083C834.163,-1378.9345 938.1405,-1396.4897 979.6978,-1398.4083"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M601.1821,-1323.4083C623.229,-1322.3091 775.727,-1353.6394 795.9847,-1362.4083"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M979.6978,-1398.4083C1072.5427,-1402.6949 1179.4088,-1386.6711 1245.1906,-1374.3691"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1246.2168,-1377.7368 1255.3869,-1372.4303 1244.9091,-1370.86 1246.2168,-1377.7368"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge189" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1307.4386,-520.4083C1379.2284,-515.5245 1397.7151,-527.3113 1469.339,-520.4083"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1469.339,-520.4083C1538.3828,-513.754 1578.7877,-469.0476 1625.4075,-520.4083"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1179.7862,-546.3699C1212.1517,-536.6116 1262.5175,-523.4643 1307.4386,-520.4083"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge130" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#00ffb2" stroke-dasharray="5,2" d="M1307.4386,-520.4083C1343.7635,-520.5058 1602.7043,-568.0521 1625.4075,-596.4083"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge86" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1186.555,-568.4236C1222.2192,-579.8639 1273.5419,-600.8655 1307.4386,-634.4083"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1307.4386,-634.4083C1450.9184,-776.3905 1366.0673,-879.8227 1411.8875,-1076.4083 1427.9147,-1145.1712 1451.6557,-1225.4342 1462.9371,-1262.5847"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1459.6274,-1263.7309 1465.8943,-1272.2735 1466.3225,-1261.6874 1459.6274,-1263.7309"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge66" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1149.6197,-568.4392C1160.0292,-599.8795 1189.6068,-692.8107 1202.9897,-772.4083 1239.0488,-986.8764 1167.5669,-1054.9927 1238.9897,-1260.4083 1250.0791,-1292.302 1273.8989,-1323.6383 1290.2949,-1342.7446"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1287.7862,-1345.1919 1297.0208,-1350.3855 1293.0406,-1340.5667 1287.7862,-1345.1919"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge190" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9847,-2200.4083C810.7494,-2215.1225 959.1423,-2234.9483 979.6978,-2238.4083"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-2238.4083C998.4039,-2241.5571 1126.9756,-2278.6022 1145.9073,-2277.4083"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M651.1434,-1589.8894C664.1866,-1593.5341 676.9421,-1599.7907 685.3989,-1610.4083 764.6101,-1709.8587 640.2572,-2083.5267 721.3989,-2181.4083 743.2305,-2207.7439 771.7547,-2176.2612 795.9847,-2200.4083"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-2277.4083C1187.7279,-2274.771 1197.2959,-2266.5967 1238.9897,-2262.4083 1315.511,-2254.7214 1335.0064,-2257.3819 1411.8875,-2255.4083 1473.2346,-2253.8336 1626.8329,-2257.0516 1688.0244,-2252.4083 1732.2961,-2249.049 1757.5885,-2271.7247 1786.9362,-2238.4083"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9847,-1590.4083C837.3092,-1602.6749 843.6914,-1618.7083 870.5706,-1652.4083 892.6318,-1680.068 879.0125,-1701.2203 906.5706,-1723.4083 932.7265,-1744.4675 950.0631,-1726.6156 979.6978,-1742.4083"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-1742.4083C1023.0524,-1765.5127 1074.9198,-1788.1652 1109.0487,-1802.424"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1108.034,-1805.7923 1118.6118,-1806.3935 1110.7177,-1799.3271 1108.034,-1805.7923"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M608.9413,-1574.2937C624.7946,-1551.2482 661.4245,-1496.2442 685.3989,-1446.4083 705.5145,-1404.5939 688.1219,-1380.7461 721.3989,-1348.4083 729.9589,-1340.09 741.3674,-1334.5376 752.6817,-1330.832"/>
<polygon fill="#ffe500" stroke="#ffe500" points="753.8677,-1334.1335 762.5264,-1328.028 751.9502,-1327.4013 753.8677,-1334.1335"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge51" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M795.9847,-2200.4083C829.8575,-2234.1653 880.7395,-2253.9205 920.372,-2264.9509"/>
<polygon fill="#7fff00" stroke="#7fff00" points="919.6242,-2268.3738 930.1885,-2267.5705 921.4291,-2261.6104 919.6242,-2268.3738"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge131" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#00ffb2" stroke-dasharray="5,2" d="M649.5579,-1596.509C661.5998,-1600.1461 674.2479,-1604.746 685.3989,-1610.4083 840.3559,-1689.0929 1139.7004,-2129.8707 1307.4386,-2084.4083"/>
<path fill="none" stroke="#00ffb2" stroke-dasharray="5,2" d="M1307.4386,-2084.4083C1465.7062,-2037.458 1462.9986,-1922.0115 1625.4075,-1892.4083"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge157" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00e5" stroke-dasharray="5,2" d="M979.6978,-1130.4083C1002.1751,-1095.8705 1032.3097,-1109.1465 1052.825,-1073.4083 1112.6569,-969.1798 1067.3232,-923.6502 1088.825,-805.4083 1104.2407,-720.6346 1129.2967,-621.0959 1140.3583,-578.4872"/>
<polygon fill="#ff00e5" stroke="#ff00e5" points="1143.7734,-579.2615 1142.9133,-568.7016 1137.0005,-577.493 1143.7734,-579.2615"/>
<path fill="none" stroke="#ff00e5" stroke-dasharray="5,2" d="M603.7949,-1574.1381C613.5459,-1533.9072 650.9179,-1394.8985 721.3989,-1303.4083 772.6529,-1236.8764 810.1229,-1245.714 870.5706,-1187.4083 888.5099,-1170.1047 885.084,-1157.0401 906.5706,-1144.4083 935.0973,-1127.6378 961.6478,-1158.1433 979.6978,-1130.4083"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge109" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-1664.4083C1151.1341,-1705.99 1218.7685,-1720.6149 1375.8875,-1640.4083 1427.2461,-1614.1906 1414.8264,-1569.2086 1469.339,-1550.4083"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge119" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M795.9847,-1590.4083C856.1998,-1608.2823 851.4716,-1648.2516 906.5706,-1678.4083 913.7665,-1682.3469 921.6965,-1685.8301 929.5993,-1688.8509"/>
<polygon fill="#0000ff" stroke="#0000ff" points="928.5801,-1692.2039 939.1744,-1692.3057 930.9559,-1685.6194 928.5801,-1692.2039"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge87" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M651.1264,-1579.6591C691.1543,-1576.7086 748.3092,-1576.2565 795.9847,-1590.4083"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9847,-1590.4083C880.3707,-1615.4571 893.281,-1647.6578 979.6978,-1664.4083"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-1664.4083C1015.6875,-1671.3844 1280.2313,-1650.9785 1307.4386,-1626.4083"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1307.4386,-1626.4083C1405.4724,-1530.232 1451.2278,-1363.1105 1464.8197,-1304.4722"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1468.2751,-1305.0586 1467.0522,-1294.5345 1461.4454,-1303.5242 1468.2751,-1305.0586"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge93" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M605.3722,-1574.1418C618.2638,-1539.2657 658.1117,-1429.8628 685.3989,-1337.4083 703.951,-1274.5503 675.8513,-1241.5328 721.3989,-1194.4083 769.3508,-1144.7964 810.8989,-1186.0497 870.5706,-1151.4083 889.8696,-1140.2046 890.1098,-1131.4755 906.5706,-1116.4083 923.6199,-1100.8023 943.5256,-1083.7246 958.2603,-1071.2913"/>
<polygon fill="#00ff00" stroke="#00ff00" points="960.8739,-1073.6668 966.2777,-1064.5537 956.3703,-1068.3078 960.8739,-1073.6668"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge63" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M651.0613,-1582.4208C749.6045,-1574.9984 974.5399,-1550.4427 1145.9073,-1474.4083"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge70" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataglobalconstants.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M605.579,-1574.2C619.0658,-1539.4915 660.4449,-1430.5196 685.3989,-1337.4083 706.6313,-1258.184 667.2017,-1217.9711 721.3989,-1156.4083 724.4249,-1152.9712 727.9377,-1150.0055 731.758,-1147.4468"/>
<polygon fill="#0066ff" stroke="#0066ff" points="733.5671,-1150.4447 740.5429,-1142.4704 730.1168,-1144.354 733.5671,-1150.4447"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge191" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1625.4075,-1322.4083C1692.047,-1349.1113 1749.166,-1261.3568 1786.9362,-1322.4083"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M998.0154,-1234.4022C1082.454,-1184.3216 1433.9792,-983.173 1526.7905,-1048.4083 1632.6762,-1122.8335 1505.2685,-1274.2678 1625.4075,-1322.4083"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M985.7031,-1256.6058C1000.0804,-1283.9944 1036.4937,-1356.9195 1052.825,-1422.4083 1072.8138,-1502.5641 1040.3228,-1725.5351 1088.825,-1792.4083 1091.1871,-1795.6652 1094.0675,-1798.5034 1097.2657,-1800.9758"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1095.4445,-1803.9656 1105.7563,-1806.3984 1099.2123,-1798.0661 1095.4445,-1803.9656"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge139" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M1034.9067,-1234.4036C1041.7755,-1230.9349 1048.0496,-1226.382 1052.825,-1220.4083 1099.4385,-1162.0978 1057.7181,-954.2707 1088.825,-886.4083 1096.6085,-869.4278 1111.0076,-854.0938 1123.396,-843.0474"/>
<polygon fill="#0019ff" stroke="#0019ff" points="1125.8161,-845.5836 1131.1568,-836.4333 1121.2756,-840.2559 1125.8161,-845.5836"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge156" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00e5" stroke-dasharray="5,2" d="M990.9594,-1234.1909C1007.7072,-1216.7244 1038.7157,-1181.1953 1052.825,-1144.4083 1107.0826,-1002.9426 1063.7868,-954.8391 1088.825,-805.4083 1103.0638,-720.429 1128.7361,-620.9979 1140.158,-578.4522"/>
<polygon fill="#ff00e5" stroke="#ff00e5" points="1143.5683,-579.2487 1142.7999,-568.6818 1136.811,-577.4215 1143.5683,-579.2487"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge110" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1469.339,-1550.4083C1527.8324,-1532.8269 1582.0503,-1482.6093 1608.4984,-1455.0573"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1611.1966,-1457.2971 1615.4963,-1447.6139 1606.0966,-1452.5023 1611.1966,-1457.2971"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-1246.4083C1201.098,-1249.8097 1336.23,-1302.8745 1375.8875,-1341.4083 1448.8632,-1412.3164 1371.8938,-1579.6976 1469.339,-1550.4083"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge84" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-1246.4083C1217.5631,-1250.8244 1236.9405,-1232.8413 1307.4386,-1246.4083"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1035.1529,-1244.2043C1067.4888,-1243.8863 1109.0412,-1244.1363 1145.9073,-1246.4083"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge68" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1145.9073,-1322.4083C1181.3737,-1330.7973 1221.1717,-1340.4038 1252.3898,-1347.9834"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1251.664,-1351.4089 1262.2077,-1350.369 1253.3169,-1344.6068 1251.664,-1351.4089"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M997.2715,-1256.4773C1026.6865,-1274.3146 1088.3441,-1308.7928 1145.9073,-1322.4083"/>
</g>
<!-- sourcefile~datastringglobals.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node22" class="node">
<title>sourcefile~datastringglobals.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_node22"><a xlink:href="../sourcefile/datastringglobals.f90.html" xlink:title="DataStringGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="281.0645,-1633.4138 166.6166,-1633.4138 166.6166,-1611.4029 281.0645,-1611.4029 281.0645,-1633.4138"/>
<text text-anchor="middle" x="223.8406" y="-1619.2583" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataStringGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.5937,-1633.7299C228.8735,-1694.2398 252.2813,-1978.665 317.2024,-2030.4083 384.6705,-2084.1818 858.7215,-2019.7802 1052.825,-1913.4083 1087.0005,-1894.6796 1116.3808,-1859.2331 1132.5592,-1837.0476"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1135.5416,-1838.8925 1138.4725,-1828.7111 1129.8321,-1834.8426 1135.5416,-1838.8925"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M233.1972,-1611.1822C248.9797,-1592.795 282.5735,-1555.9535 317.2024,-1532.4083 463.8059,-1432.7284 665.662,-1363.4219 752.926,-1336.219"/>
<polygon fill="#ffe500" stroke="#ffe500" points="753.974,-1339.5585 762.495,-1333.2621 751.9074,-1332.8705 753.974,-1339.5585"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge165" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M399.0839,-1622.4083C447.2993,-1615.7954 501.5261,-1605.7216 541.6613,-1597.7544"/>
<polygon fill="#ff0098" stroke="#ff0098" points="542.4295,-1601.1701 551.5493,-1595.7776 541.0571,-1594.306 542.4295,-1601.1701"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M224.3582,-1633.5003C226.9276,-1677.8481 241.4446,-1845.1847 317.2024,-1952.4083 329.7553,-1970.1751 349.5448,-1984.4095 366.5241,-1994.3302"/>
<polygon fill="#00ffff" stroke="#00ffff" points="365.1656,-1997.5799 375.6042,-1999.3929 368.5745,-1991.4661 365.1656,-1997.5799"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge74" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1622.4083C456.7392,-1614.5007 461.054,-1581.5514 516.9653,-1565.4083 811.739,-1480.2996 913.0273,-1588.692 1202.9897,-1488.4083 1288.3946,-1458.871 1305.714,-1438.3481 1375.8875,-1381.4083 1406.0522,-1356.9322 1436.2096,-1323.2252 1453.8023,-1302.4002"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1456.6052,-1304.5041 1460.3257,-1294.584 1451.231,-1300.0188 1456.6052,-1304.5041"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M281.3154,-1626.2314C315.6457,-1627.5662 360.0317,-1627.6274 399.0839,-1622.4083"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge58" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1145.9073,-1474.4083C1202.6953,-1451.1542 1259.1748,-1405.0419 1287.9205,-1379.4982"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1290.5134,-1381.8729 1295.596,-1372.5768 1285.8256,-1376.6743 1290.5134,-1381.8729"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M248.793,-1611.2928C320.4635,-1580.0511 533.8223,-1491.8261 721.3989,-1462.4083 786.8968,-1452.1363 804.2878,-1460.9646 870.5706,-1462.4083 993.0296,-1465.0756 1032.5548,-1520.8252 1145.9073,-1474.4083"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M435.7704,-1999.3476C532.3159,-1970.284 786.6943,-1894.0114 795.9847,-1894.4083"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M437.6496,-2021.4408C483.5795,-2036.5947 559.329,-2068.3144 601.1821,-2122.4083"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge166" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M425.1101,-1999.2482C443.9671,-1989.7019 468.2905,-1974.0563 480.9653,-1952.4083 519.5774,-1886.4606 468.1121,-1669.1737 516.9653,-1610.4083 523.4734,-1602.5798 532.3132,-1597.1341 541.8264,-1593.3608"/>
<polygon fill="#ff0098" stroke="#ff0098" points="543.1326,-1596.6144 551.5025,-1590.1186 540.9086,-1589.9771 543.1326,-1596.6144"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge80" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M456.1208,-1999.2533C465.0338,-1995.8077 473.6881,-1991.3012 480.9653,-1985.4083 506.6298,-1964.6261 491.1836,-1941.045 516.9653,-1920.4083 710.7133,-1765.3252 827.7069,-1867.8637 1052.825,-1763.4083 1142.7811,-1721.6684 1147.3743,-1678.3683 1238.9897,-1640.4083 1267.6763,-1628.5224 1285.2729,-1648.1541 1307.4386,-1626.4083"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge67" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M460.8294,-1999.3272C468.3371,-1995.8622 475.3303,-1991.3307 480.9653,-1985.4083 526.1422,-1937.9282 469.9761,-1888.0956 516.9653,-1842.4083 691.8787,-1672.3417 849.8599,-1858.769 1052.825,-1723.4083 1188.1838,-1633.1353 1273.8191,-1444.5295 1299.3793,-1382.025"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1302.731,-1383.0707 1303.2102,-1372.4867 1296.2353,-1380.4618 1302.731,-1383.0707"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M659.1917,-1734.035C669.2287,-1730.2437 678.6042,-1724.6431 685.3989,-1716.4083 789.9889,-1589.6513 619.0333,-1476.9685 721.3989,-1348.4083 729.1084,-1338.7261 740.7065,-1332.766 752.4739,-1329.1061"/>
<polygon fill="#ffe500" stroke="#ffe500" points="753.5222,-1332.4499 762.3167,-1326.5416 751.7573,-1325.676 753.5222,-1332.4499"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge122" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#00ffb2" stroke-dasharray="5,2" d="M622.3692,-1752.4174C641.3529,-1763.2799 668.7047,-1781.5545 685.3989,-1804.4083 714.2509,-1843.9059 687.8613,-1872.8033 721.3989,-1908.4083 861.4398,-2057.0818 941.8119,-2076.6427 1145.9073,-2084.4083"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M660.272,-1219.5165C669.2863,-1222.9662 678.0271,-1227.4862 685.3989,-1233.4083 711.1439,-1254.0908 696.0182,-1277.2805 721.3989,-1298.4083 730.4101,-1305.9096 741.7656,-1311.1912 752.8796,-1314.8984"/>
<polygon fill="#ffe500" stroke="#ffe500" points="751.9364,-1318.2693 762.5193,-1317.7671 753.9331,-1311.5601 751.9364,-1318.2693"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M448.0054,-380.4371C458.9624,-383.3259 470.4506,-386.6881 480.9653,-390.4083 512.4829,-401.5597 547.055,-417.8277 571.0014,-429.7792"/>
<polygon fill="#cbff00" stroke="#cbff00" points="569.439,-432.9111 579.9439,-434.2884 572.5907,-426.6607 569.439,-432.9111"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge148" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00e5" stroke-dasharray="5,2" d="M416.8663,-358.3016C499.4468,-308.2691 850.0717,-113.0615 1052.825,-272.4083 1106.0502,-314.2389 1067.7425,-356.0792 1088.825,-420.4083 1102.7099,-462.7756 1123.9029,-510.4583 1136.1816,-536.9158"/>
<polygon fill="#ff00e5" stroke="#ff00e5" points="1133.1508,-538.6967 1140.5622,-546.2678 1139.4899,-535.7274 1133.1508,-538.6967"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M450.1224,-2248.4466C513.4057,-2261.519 624.7484,-2282.515 721.3989,-2290.4083 787.4774,-2295.8049 804.3885,-2294.3365 870.5706,-2290.4083 886.6631,-2289.4532 904.0203,-2287.7124 920.0546,-2285.8087"/>
<polygon fill="#7fff00" stroke="#7fff00" points="920.8752,-2289.2342 930.3737,-2284.5407 920.0215,-2282.2865 920.8752,-2289.2342"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge126" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#00ffb2" stroke-dasharray="5,2" d="M1629.8963,-1447.4963C1651.9932,-1502.0792 1749.3232,-1742.4987 1778.586,-1814.7822"/>
<polygon fill="#00ffb2" stroke="#00ffb2" points="1775.3957,-1816.229 1782.3925,-1824.1848 1781.8842,-1813.6022 1775.3957,-1816.229"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge127" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#00ffb2" stroke-dasharray="5,2" d="M427.9728,-1943.4287C504.5757,-1972.0387 719.8114,-2048.4613 906.5706,-2077.4083 1011.7322,-2093.708 1039.6744,-2078.1452 1145.9073,-2084.4083"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge164" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M439.6275,-1929.2472C454.7692,-1925.9646 470.7497,-1919.5974 480.9653,-1907.4083 566.3746,-1805.5002 431.1612,-1711.9842 516.9653,-1610.4083 523.5348,-1602.6313 532.4041,-1597.2102 541.9271,-1593.4452"/>
<polygon fill="#ff0098" stroke="#ff0098" points="543.2345,-1596.6985 551.6071,-1590.2063 541.0133,-1590.0603 543.2345,-1596.6985"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge129" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#00ffb2" stroke-dasharray="5,2" d="M1625.4075,-1892.4083C1671.6276,-1884.4925 1722.194,-1864.7018 1754.2158,-1850.6687"/>
<polygon fill="#00ffb2" stroke="#00ffb2" points="1755.8226,-1853.7845 1763.5328,-1846.5179 1752.974,-1847.3903 1755.8226,-1853.7845"/>
<path fill="none" stroke="#00ffb2" stroke-dasharray="5,2" d="M1145.9073,-1778.4083C1199.4448,-1789.9282 1571.4305,-1901.6527 1625.4075,-1892.4083"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge108" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-1778.4083C1218.0086,-1793.9226 1246.7163,-1782.2662 1307.4386,-1740.4083"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1307.4386,-1740.4083C1337.0182,-1720.0181 1350.4154,-1722.7439 1375.8875,-1697.4083 1430.777,-1642.8129 1395.5071,-1573.6973 1469.339,-1550.4083"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1015.8509,-1714.4653C1027.7828,-1718.4576 1041.0181,-1723.2602 1052.825,-1728.4083 1095.8715,-1747.1778 1099.9975,-1768.5298 1145.9073,-1778.4083"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge99" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1480.8151,-1294.6588C1507.5348,-1320.8532 1574.1049,-1386.1144 1606.7542,-1418.1218"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1604.3234,-1420.6402 1613.9146,-1425.1414 1609.2238,-1415.6415 1604.3234,-1420.6402"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge100" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1020.6184,-1042.3748C1071.3885,-1029.307 1160.8197,-1008.3157 1238.9897,-1000.4083 1299.5243,-994.2849 1317.635,-982.8419 1375.8875,-1000.4083 1423.6085,-1014.7989 1440.3247,-1021.8799 1469.339,-1062.4083"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge102" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1469.339,-672.4083C1575.6637,-776.8065 1512.8312,-1196.0232 1562.7905,-1336.4083 1573.6893,-1367.0337 1595.1381,-1398.1176 1609.8688,-1417.3228"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1607.1755,-1419.5601 1616.1022,-1425.2666 1612.6825,-1415.2388 1607.1755,-1419.5601"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M825.0542,-494.4792C877.1758,-513.9351 990.2972,-554.3755 1088.825,-577.4083 1258.5572,-617.0867 1344.9627,-550.2857 1469.339,-672.4083"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge159" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M462.7471,-1025.4463C469.6765,-1028.9345 476.0019,-1033.4837 480.9653,-1039.4083 523.8014,-1090.5401 502.1617,-1272.3681 516.9653,-1337.4083 536.6875,-1424.0584 575.3801,-1522.9462 592.5836,-1564.8849"/>
<polygon fill="#ff0098" stroke="#ff0098" points="589.4126,-1566.3758 596.4697,-1574.2782 595.8809,-1563.6997 589.4126,-1566.3758"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge75" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M463.4068,-1004.7808C648.1046,-978.5913 1175.2875,-914.4719 1307.4386,-1014.4083"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1307.4386,-1014.4083C1398.9983,-1077.4956 1447.4402,-1210.8436 1463.3443,-1262.4225"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1460.0297,-1263.5549 1466.248,-1272.133 1466.7363,-1261.5495 1460.0297,-1263.5549"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge160" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M404.7872,-1103.5257C418.6191,-1130.6649 454.7393,-1202.6062 480.9653,-1264.4083 528.2774,-1375.9002 576.3446,-1513.0039 594.0628,-1564.5279"/>
<polygon fill="#ff0098" stroke="#ff0098" points="590.8189,-1565.8584 597.3719,-1574.1836 597.4408,-1563.589 590.8189,-1565.8584"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge77" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M443.4533,-1085.2189C616.1071,-1057.6955 1237.0577,-963.0895 1307.4386,-1014.4083"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge82" class="edge">
<title>sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1330.2916,-1350.3983C1358.1759,-1336.9643 1405.4986,-1314.1652 1437.0829,-1298.9486"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1438.8508,-1301.9819 1446.3407,-1294.4884 1435.8126,-1295.6756 1438.8508,-1301.9819"/>
</g>
<!-- sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge83" class="edge">
<title>sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M860.7803,-1140.3109C875.7858,-1142.015 891.7111,-1143.5379 906.5706,-1144.4083 971.4613,-1148.2094 987.9565,-1148.5725 1052.825,-1144.4083 1094.4516,-1141.7362 1106.2255,-1119.5525 1145.9073,-1132.4083"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge85" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M470.874,-820.2132C642.2351,-799.3877 1070.7259,-754.2557 1202.9897,-805.4083 1261.5162,-828.0433 1263.9594,-855.1618 1307.4386,-900.4083"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1307.4386,-900.4083C1347.1699,-936.7706 1351.9966,-952.1381 1375.8875,-1000.4083 1421.8802,-1093.3343 1453.1303,-1214.1847 1464.5365,-1262.3032"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1461.1592,-1263.2321 1466.8384,-1272.1762 1467.9763,-1261.6426 1461.1592,-1263.2321"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge116" class="edge">
<title>sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M685.5525,-1671.4565C738.6733,-1676.6248 808.6626,-1683.6191 870.5706,-1690.4083 878.8859,-1691.3203 887.5539,-1692.3011 896.2098,-1693.3006"/>
<polygon fill="#0000ff" stroke="#0000ff" points="896.0063,-1696.8004 906.3438,-1694.4794 896.8152,-1689.8473 896.0063,-1696.8004"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge154" class="edge">
<title>sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00e5" stroke-dasharray="5,2" d="M456.5356,-399.3456C575.6471,-379.4329 854.8893,-348.653 1052.825,-452.4083 1089.9682,-471.8784 1119.2486,-512.6435 1134.4449,-537.2595"/>
<polygon fill="#ff00e5" stroke="#ff00e5" points="1131.605,-539.3304 1139.7375,-546.121 1137.6147,-535.741 1131.605,-539.3304"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~EfferentGraph_edge158" class="edge">
<title>sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00e5" stroke-dasharray="5,2" d="M438.8283,-440.3846C461.5177,-434.6625 490.6102,-428.2803 516.9653,-425.4083 591.3842,-417.2989 610.8103,-419.0473 685.3989,-425.4083 735.088,-429.6459 746.3406,-439.6735 795.9847,-444.4083"/>
<path fill="none" stroke="#ff00e5" stroke-dasharray="5,2" d="M795.9847,-444.4083C913.3761,-447.4195 943.3013,-464.0482 1052.825,-506.4083 1076.6801,-515.6347 1102.0315,-529.8493 1120.2435,-540.9303"/>
<polygon fill="#ff00e5" stroke="#ff00e5" points="1118.726,-544.1073 1129.0706,-546.3963 1122.4113,-538.1559 1118.726,-544.1073"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefileheatbalanceconvectioncoeffsf90EfferentGraph = svgPanZoom('#sourcefileheatbalanceconvectioncoeffsf90EfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <h3>Files Dependent On This One</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefileheatbalanceconvectioncoeffsf90AfferentGraph" width="641pt" height="246pt"
 viewBox="0.00 0.00 641.00 245.64" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph" class="graph" transform="scale(.1957 .1957) rotate(0) translate(4 1251.0615)">
<title>sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1251.0615 3271.0798,-1251.0615 3271.0798,4 -4,4"/>
<!-- sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~heatbalanceconvectioncoeffs.f90</title>
<polygon fill="none" stroke="#000000" points="172.4954,-795.8169 -.1654,-795.8169 -.1654,-773.806 172.4954,-773.806 172.4954,-795.8169"/>
<text text-anchor="middle" x="86.165" y="-781.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">HeatBalanceConvectionCoeffs.f90</text>
</g>
<!-- sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~photovoltaicthermalcollectors.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node2"><a xlink:href="../sourcefile/photovoltaicthermalcollectors.f90.html" xlink:title="PhotovoltaicThermalCollectors.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="380.1869,-834.8169 208.3778,-834.8169 208.3778,-812.806 380.1869,-812.806 380.1869,-834.8169"/>
<text text-anchor="middle" x="294.2823" y="-820.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PhotovoltaicThermalCollectors.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge138" class="edge">
<title>sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M144.9686,-795.8309C169.9055,-800.504 199.1487,-805.984 225.1142,-810.8497"/>
<polygon fill="#ff0000" stroke="#ff0000" points="224.7898,-814.3498 235.2634,-812.7517 226.0792,-807.4696 224.7898,-814.3498"/>
</g>
<!-- sourcefile~windowmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~windowmanager.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node3"><a xlink:href="../sourcefile/windowmanager.f90.html" xlink:title="WindowManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2435.0848,-352.8169 2327.6334,-352.8169 2327.6334,-330.806 2435.0848,-330.806 2435.0848,-352.8169"/>
<text text-anchor="middle" x="2381.3591" y="-338.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WindowManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~windowmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge139" class="edge">
<title>sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~windowmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M514.4634,-496.8115C558.9213,-495.9439 573.9829,-499.6943 612.6921,-477.8115 633.513,-466.0411 627.9407,-449.7038 648.6921,-437.8115 685.0668,-416.9657 701.235,-431.824 741.089,-418.8115"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M741.089,-418.8115C800.789,-399.3191 811.9487,-384.9814 869.4858,-359.8115 944.7937,-326.8676 961.8487,-313.471 1040.261,-288.8115 1385.0594,-180.3772 1491.0702,-169.8742 1849.9578,-212.8115 1897.7975,-218.535 2203.9184,-296.2983 2328.6154,-328.2504"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2327.7824,-331.65 2338.3384,-330.7432 2329.5209,-324.8693 2327.7824,-331.65"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M294.2823,-477.8115C333.5713,-448.3452 465.3618,-497.7696 514.4634,-496.8115"/>
</g>
<!-- sourcefile~generalroutines.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~generalroutines.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node4"><a xlink:href="../sourcefile/generalroutines.f90.html" xlink:title="GeneralRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2039.3581,-787.8169 1930.7376,-787.8169 1930.7376,-765.806 2039.3581,-765.806 2039.3581,-787.8169"/>
<text text-anchor="middle" x="1985.0479" y="-773.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">GeneralRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~generalroutines.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge140" class="edge">
<title>sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~generalroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M741.089,-418.8115C936.6298,-356.2295 1450.743,-537.4766 1648.4568,-592.8115 1740.479,-618.566 1779.8667,-602.8605 1849.9578,-667.8115 1877.963,-693.763 1857.2732,-720.6128 1885.9578,-745.8115 1895.9398,-754.5804 1908.3886,-760.8697 1921.0561,-765.3803"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1920.1571,-768.7676 1930.7485,-768.4944 1922.2985,-762.1031 1920.1571,-768.7676"/>
</g>
<!-- sourcefile~roomairmodelcrossvent.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~roomairmodelcrossvent.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node5"><a xlink:href="../sourcefile/roomairmodelcrossvent.f90.html" xlink:title="RoomAirModelCrossVent.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1416.2217,-713.8169 1268.4252,-713.8169 1268.4252,-691.806 1416.2217,-691.806 1416.2217,-713.8169"/>
<text text-anchor="middle" x="1342.3235" y="-699.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RoomAirModelCrossVent.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~roomairmodelcrossvent.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge141" class="edge">
<title>sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~roomairmodelcrossvent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M514.4634,-496.8115C851.4783,-482.5909 922.5303,-603.0835 1250.5291,-681.8115 1261.1178,-684.353 1272.4108,-686.9937 1283.3247,-689.5098"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1282.6805,-692.9529 1293.2101,-691.7792 1284.2467,-686.1304 1282.6805,-692.9529"/>
</g>
<!-- sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~hvactranspiredcollector.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node6"><a xlink:href="../sourcefile/hvactranspiredcollector.f90.html" xlink:title="HVACTranspiredCollector.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="368.3547,-756.8169 220.21,-756.8169 220.21,-734.806 368.3547,-734.806 368.3547,-756.8169"/>
<text text-anchor="middle" x="294.2823" y="-742.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACTranspiredCollector.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge142" class="edge">
<title>sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M144.9686,-773.792C169.9055,-769.119 199.1487,-763.639 225.1142,-758.7732"/>
<polygon fill="#ff0000" stroke="#ff0000" points="226.0792,-762.1534 235.2634,-756.8713 224.7898,-755.2731 226.0792,-762.1534"/>
</g>
<!-- sourcefile~ecoroof.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~ecoroof.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node7"><a xlink:href="../sourcefile/ecoroof.f90.html" xlink:title="EcoRoof.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="549.2496,-468.8169 479.6772,-468.8169 479.6772,-446.806 549.2496,-446.806 549.2496,-468.8169"/>
<text text-anchor="middle" x="514.4634" y="-454.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EcoRoof.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~ecoroof.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge143" class="edge">
<title>sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~ecoroof.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M294.2823,-477.8115C344.7749,-439.9426 421.2443,-442.4703 469.4875,-449.1231"/>
<polygon fill="#ff0000" stroke="#ff0000" points="469.222,-452.6222 479.6297,-450.6398 470.2574,-445.6992 469.222,-452.6222"/>
</g>
<!-- sourcefile~roomairmodelufad.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~roomairmodelufad.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node8"><a xlink:href="../sourcefile/roomairmodelufad.f90.html" xlink:title="RoomAirModelUFAD.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1405.7852,-795.8169 1278.8618,-795.8169 1278.8618,-773.806 1405.7852,-773.806 1405.7852,-795.8169"/>
<text text-anchor="middle" x="1342.3235" y="-781.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RoomAirModelUFAD.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~roomairmodelufad.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge144" class="edge">
<title>sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~roomairmodelufad.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1127.395,-784.8115C1174.3957,-782.5751 1227.2433,-782.5419 1268.7732,-783.0841"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1268.756,-786.5841 1278.8055,-783.229 1268.8571,-779.5848 1268.756,-786.5841"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~heatbalancesurfacemanager.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node9"><a xlink:href="../sourcefile/heatbalancesurfacemanager.f90.html" xlink:title="HeatBalanceSurfaceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2667.5325,-430.8169 2501.1511,-430.8169 2501.1511,-408.806 2667.5325,-408.806 2667.5325,-430.8169"/>
<text text-anchor="middle" x="2584.3418" y="-416.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceSurfaceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge145" class="edge">
<title>sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M294.2823,-477.8115C461.4652,-352.4263 460.9293,-260.554 648.6921,-168.8115 765.9231,-111.5314 806.397,-112.8115 936.8734,-112.8115 936.8734,-112.8115 936.8734,-112.8115 1767.2073,-112.8115 2085.8882,-112.8115 2196.3546,-106.3792 2464.9966,-277.8115 2514.7232,-309.5442 2554.3908,-368.5671 2572.9352,-399.5797"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2570.1345,-401.7242 2578.1999,-408.5944 2576.1791,-398.1941 2570.1345,-401.7242"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M90.4715,-773.6028C108.2023,-728.9576 180.0533,-562.1369 294.2823,-477.8115"/>
</g>
<!-- sourcefile~roomairmodeldisplacementvent.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node10" class="node">
<title>sourcefile~roomairmodeldisplacementvent.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node10"><a xlink:href="../sourcefile/roomairmodeldisplacementvent.f90.html" xlink:title="RoomAirModelDisplacementVent.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1433.9128,-754.8169 1250.7342,-754.8169 1250.7342,-732.806 1433.9128,-732.806 1433.9128,-754.8169"/>
<text text-anchor="middle" x="1342.3235" y="-740.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RoomAirModelDisplacementVent.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~roomairmodeldisplacementvent.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge146" class="edge">
<title>sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~roomairmodeldisplacementvent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1127.395,-784.8115C1156.9816,-783.4037 1230.2804,-768.4961 1283.055,-757.0587"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1283.9602,-760.4437 1292.9859,-754.8951 1282.47,-753.6041 1283.9602,-760.4437"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M172.709,-784.8115C259.2197,-784.8115 396.0493,-784.8115 514.4634,-784.8115 514.4634,-784.8115 514.4634,-784.8115 741.089,-784.8115 912.7806,-784.8115 955.8975,-792.9717 1127.395,-784.8115"/>
</g>
<!-- sourcefile~plantpondgroundheatexchanger.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node11" class="node">
<title>sourcefile~plantpondgroundheatexchanger.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node11"><a xlink:href="../sourcefile/plantpondgroundheatexchanger.f90.html" xlink:title="PlantPondGroundHeatExchanger.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="833.3828,-1168.8169 648.7952,-1168.8169 648.7952,-1146.806 833.3828,-1146.806 833.3828,-1168.8169"/>
<text text-anchor="middle" x="741.089" y="-1154.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantPondGroundHeatExchanger.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~plantpondgroundheatexchanger.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge147" class="edge">
<title>sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~plantpondgroundheatexchanger.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M294.2823,-1196.8115C375.2857,-1251.7177 416.6952,-1201.0099 514.4634,-1196.8115"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M87.8336,-795.9064C96.7393,-850.8227 144.0378,-1094.9716 294.2823,-1196.8115"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M514.4634,-1196.8115C573.9797,-1194.2556 641.1087,-1181.4295 686.7561,-1171.1738"/>
<polygon fill="#ff0000" stroke="#ff0000" points="687.7616,-1174.5344 696.7318,-1168.8966 686.2037,-1167.71 687.7616,-1174.5344"/>
</g>
<!-- sourcefile~plantsurfacegroundheatexchanger.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node12" class="node">
<title>sourcefile~plantsurfacegroundheatexchanger.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node12"><a xlink:href="../sourcefile/plantsurfacegroundheatexchanger.f90.html" xlink:title="PlantSurfaceGroundHeatExchanger.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="612.9214,-1246.8169 416.0053,-1246.8169 416.0053,-1224.806 612.9214,-1224.806 612.9214,-1246.8169"/>
<text text-anchor="middle" x="514.4634" y="-1232.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantSurfaceGroundHeatExchanger.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~plantsurfacegroundheatexchanger.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge148" class="edge">
<title>sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~plantsurfacegroundheatexchanger.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M294.2823,-1196.8115C326.8044,-1218.8558 368.0244,-1229.5656 405.9822,-1234.4575"/>
<polygon fill="#ff0000" stroke="#ff0000" points="405.7334,-1237.9521 416.0714,-1235.6335 406.5439,-1230.9992 405.7334,-1237.9521"/>
</g>
<!-- sourcefile~plantpipeheattransfer.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node13" class="node">
<title>sourcefile~plantpipeheattransfer.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node13"><a xlink:href="../sourcefile/plantpipeheattransfer.f90.html" xlink:title="PlantPipeHeatTransfer.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1004.1487,-1207.8169 869.5981,-1207.8169 869.5981,-1185.806 1004.1487,-1185.806 1004.1487,-1207.8169"/>
<text text-anchor="middle" x="936.8734" y="-1193.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantPipeHeatTransfer.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge149" class="edge">
<title>sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M514.4634,-1196.8115C634.8568,-1191.6414 774.73,-1193.1084 859.473,-1194.8222"/>
<polygon fill="#ff0000" stroke="#ff0000" points="859.4583,-1198.3226 869.5292,-1195.032 859.6044,-1191.3241 859.4583,-1198.3226"/>
</g>
<!-- sourcefile~plantloopequipment.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node14" class="node">
<title>sourcefile~plantloopequipment.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node14"><a xlink:href="../sourcefile/plantloopequipment.f90.html" xlink:title="PlantLoopEquipment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1622.79,-1188.8169 1495.7847,-1188.8169 1495.7847,-1166.806 1622.79,-1166.806 1622.79,-1188.8169"/>
<text text-anchor="middle" x="1559.2874" y="-1174.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantLoopEquipment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~photovoltaicthermalcollectors.f90&#45;&gt;sourcefile~plantloopequipment.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge120" class="edge">
<title>sourcefile~photovoltaicthermalcollectors.f90&#45;&gt;sourcefile~plantloopequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1127.395,-1138.8115C1225.2859,-1153.9697 1243.2783,-1199.372 1342.3235,-1197.8115"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M936.8734,-1119.8115C1021.5407,-1111.2778 1043.301,-1125.7897 1127.395,-1138.8115"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1342.3235,-1197.8115C1390.0184,-1197.06 1443.3702,-1192.196 1485.233,-1187.4534"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1485.812,-1190.9098 1495.3441,-1186.2851 1485.0085,-1183.9561 1485.812,-1190.9098"/>
</g>
<!-- sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node15" class="node">
<title>sourcefile~photovoltaics.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node15"><a xlink:href="../sourcefile/photovoltaics.f90.html" xlink:title="Photovoltaics.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="560.4285,-756.8169 468.4983,-756.8169 468.4983,-734.806 560.4285,-734.806 560.4285,-756.8169"/>
<text text-anchor="middle" x="514.4634" y="-742.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Photovoltaics.f90</text>
</a>
</g>
</g>
<!-- sourcefile~photovoltaicthermalcollectors.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge121" class="edge">
<title>sourcefile~photovoltaicthermalcollectors.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M325.3619,-812.8014C364.183,-799.0489 430.7081,-775.4821 473.614,-760.2825"/>
<polygon fill="#ff0000" stroke="#ff0000" points="474.9289,-763.5299 483.1862,-756.8915 472.5914,-756.9317 474.9289,-763.5299"/>
</g>
<!-- sourcefile~mixedair.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node16" class="node">
<title>sourcefile~mixedair.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node16"><a xlink:href="../sourcefile/mixedair.f90.html" xlink:title="MixedAir.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1162.1761,-992.8169 1092.6139,-992.8169 1092.6139,-970.806 1162.1761,-970.806 1162.1761,-992.8169"/>
<text text-anchor="middle" x="1127.395" y="-978.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">MixedAir.f90</text>
</a>
</g>
</g>
<!-- sourcefile~photovoltaicthermalcollectors.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge122" class="edge">
<title>sourcefile~photovoltaicthermalcollectors.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M936.8734,-1119.8115C1014.3225,-1108.2014 1082.6387,-1036.5608 1112.0518,-1001.3318"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1115.062,-1003.1789 1118.6734,-993.2185 1109.6389,-998.7529 1115.062,-1003.1789"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M305.723,-835.1499C366.5785,-894.1023 659.9206,-1161.3283 936.8734,-1119.8115"/>
</g>
<!-- sourcefile~windowmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge124" class="edge">
<title>sourcefile~windowmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff7f00" stroke-dasharray="5,2" d="M2422.1163,-352.8632C2435.8614,-356.8888 2451.2086,-361.7128 2464.9966,-366.8115 2495.2724,-378.007 2528.7886,-393.144 2552.5752,-404.3749"/>
<polygon fill="#ff7f00" stroke="#ff7f00" points="2551.2853,-407.6371 2561.819,-408.774 2554.2934,-401.3164 2551.2853,-407.6371"/>
</g>
<!-- sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node28" class="node">
<title>sourcefile~heatbalancemanager.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node28"><a xlink:href="../sourcefile/heatbalancemanager.f90.html" xlink:title="HeatBalanceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2838.8869,-432.8169 2708.8763,-432.8169 2708.8763,-410.806 2838.8869,-410.806 2838.8869,-432.8169"/>
<text text-anchor="middle" x="2773.8816" y="-418.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~windowmanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge123" class="edge">
<title>sourcefile~windowmanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff7f00" stroke-dasharray="5,2" d="M2396.167,-330.6613C2412.8849,-318.0719 2440.8977,-296.9744 2464.9966,-278.8115 2518.0499,-238.8261 2520.2048,-171.4927 2584.3418,-188.8115"/>
</g>
<!-- sourcefile~roomairmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node33" class="node">
<title>sourcefile~roomairmanager.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node33"><a xlink:href="../sourcefile/roomairmanager.f90.html" xlink:title="RoomAirManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1615.0095,-734.8169 1503.5652,-734.8169 1503.5652,-712.806 1615.0095,-712.806 1615.0095,-734.8169"/>
<text text-anchor="middle" x="1559.2874" y="-720.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RoomAirManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~roomairmodelcrossvent.f90&#45;&gt;sourcefile~roomairmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge125" class="edge">
<title>sourcefile~roomairmodelcrossvent.f90&#45;&gt;sourcefile~roomairmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1416.0803,-709.9504C1441.1259,-712.3746 1468.9322,-715.066 1493.3293,-717.4274"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1493.2678,-720.9377 1503.5585,-718.4175 1493.9423,-713.9702 1493.2678,-720.9377"/>
</g>
<!-- sourcefile~hvactranspiredcollector.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge126" class="edge">
<title>sourcefile~hvactranspiredcollector.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M368.5186,-745.8115C397.8549,-745.8115 431.0042,-745.8115 458.2875,-745.8115"/>
<polygon fill="#00ff00" stroke="#00ff00" points="458.4367,-749.3116 468.4366,-745.8115 458.4366,-742.3116 458.4367,-749.3116"/>
</g>
<!-- sourcefile~hvactranspiredcollector.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge127" class="edge">
<title>sourcefile~hvactranspiredcollector.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M339.7979,-734.7537C402.2286,-721.4303 517.5232,-703.4507 612.6921,-725.8115 817.2006,-773.8624 1033.3848,-915.9753 1103.7753,-964.9771"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1101.7972,-967.8647 1111.9947,-970.7389 1105.8153,-962.1328 1101.7972,-967.8647"/>
</g>
<!-- sourcefile~ecoroof.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge128" class="edge">
<title>sourcefile~ecoroof.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#00ff7f" stroke-dasharray="5,2" d="M521.8181,-446.5211C558.8823,-391.1342 731.5343,-150.8115 936.8734,-150.8115 936.8734,-150.8115 936.8734,-150.8115 1559.2874,-150.8115 1688.9138,-150.8115 1721.2889,-159.0847 1849.9578,-174.8115 1954.6203,-187.604 1987.4756,-170.6892 2084.1379,-212.8115 2102.7201,-220.9089 2101.8498,-232.0703 2120.1379,-240.8115 2262.1874,-308.7071 2323.8578,-252.0425 2464.9966,-321.8115 2506.0945,-342.1273 2545.5379,-379.0283 2567.1999,-401.2932"/>
<polygon fill="#00ff7f" stroke="#00ff7f" points="2564.9085,-403.9615 2574.3463,-408.776 2569.9708,-399.1269 2564.9085,-403.9615"/>
</g>
<!-- sourcefile~roomairmodelufad.f90&#45;&gt;sourcefile~roomairmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge129" class="edge">
<title>sourcefile~roomairmodelufad.f90&#45;&gt;sourcefile~roomairmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1401.2656,-773.7256C1412.333,-770.9726 1423.6953,-767.6783 1434.1179,-763.8115 1451.0799,-757.5185 1453.1762,-751.1586 1470.1179,-744.8115 1477.6356,-741.995 1485.6554,-739.4728 1493.687,-737.2383"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1494.6838,-740.5951 1503.4568,-734.6549 1492.8943,-733.8277 1494.6838,-740.5951"/>
</g>
<!-- sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node19" class="node">
<title>sourcefile~simulationmanager.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node19"><a xlink:href="../sourcefile/simulationmanager.f90.html" xlink:title="SimulationManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3134.6624,-432.8169 3014.852,-432.8169 3014.852,-410.806 3134.6624,-410.806 3134.6624,-432.8169"/>
<text text-anchor="middle" x="3074.7572" y="-418.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SimulationManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge131" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#007fff" stroke-dasharray="5,2" d="M2629.1155,-430.8218C2720.9728,-453.3078 2922.7396,-502.129 2929.5656,-498.8115"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge130" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#007fff" stroke-dasharray="5,2" d="M2667.7525,-420.6916C2678.032,-420.8001 2688.4924,-420.9105 2698.6405,-421.0175"/>
<polygon fill="#007fff" stroke="#007fff" points="2698.6298,-424.5175 2708.6662,-421.1233 2698.7037,-417.5179 2698.6298,-424.5175"/>
</g>
<!-- sourcefile~roomairmodeldisplacementvent.f90&#45;&gt;sourcefile~roomairmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge132" class="edge">
<title>sourcefile~roomairmodeldisplacementvent.f90&#45;&gt;sourcefile~roomairmanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1434.0212,-735.3587C1453.928,-733.5236 1474.6075,-731.6174 1493.2904,-729.8951"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1493.8103,-733.3622 1503.4468,-728.9589 1493.1677,-726.3917 1493.8103,-733.3622"/>
</g>
<!-- sourcefile~plantpondgroundheatexchanger.f90&#45;&gt;sourcefile~plantloopequipment.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge133" class="edge">
<title>sourcefile~plantpondgroundheatexchanger.f90&#45;&gt;sourcefile~plantloopequipment.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M833.7616,-1149.3644C929.634,-1141.3236 1072.8269,-1131.4577 1127.395,-1138.8115"/>
</g>
<!-- sourcefile~plantsurfacegroundheatexchanger.f90&#45;&gt;sourcefile~plantloopequipment.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge134" class="edge">
<title>sourcefile~plantsurfacegroundheatexchanger.f90&#45;&gt;sourcefile~plantloopequipment.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M612.8441,-1234.7579C748.4287,-1232.777 1000.2861,-1227.1974 1214.5291,-1211.8115 1271.5196,-1207.7187 1285.2113,-1199.5072 1342.3235,-1197.8115"/>
</g>
<!-- sourcefile~plantpipeheattransfer.f90&#45;&gt;sourcefile~plantloopequipment.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge136" class="edge">
<title>sourcefile~plantpipeheattransfer.f90&#45;&gt;sourcefile~plantloopequipment.f90</title>
<path fill="none" stroke="#ff007f" stroke-dasharray="5,2" d="M1004.3617,-1195.8049C1040.8145,-1195.6042 1086.5893,-1195.904 1127.395,-1197.8115"/>
<path fill="none" stroke="#ff007f" stroke-dasharray="5,2" d="M1127.395,-1197.8115C1222.8146,-1202.2718 1246.8418,-1200.6464 1342.3235,-1197.8115"/>
</g>
<!-- sourcefile~plantmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node17" class="node">
<title>sourcefile~plantmanager.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node17"><a xlink:href="../sourcefile/plantmanager.f90.html" xlink:title="PlantManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2032.3616,-1165.8169 1937.7341,-1165.8169 1937.7341,-1143.806 2032.3616,-1143.806 2032.3616,-1165.8169"/>
<text text-anchor="middle" x="1985.0479" y="-1151.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantpipeheattransfer.f90&#45;&gt;sourcefile~plantmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge135" class="edge">
<title>sourcefile~plantpipeheattransfer.f90&#45;&gt;sourcefile~plantmanager.f90</title>
<path fill="none" stroke="#ff007f" stroke-dasharray="5,2" d="M1127.395,-1197.8115C1182.4138,-1200.3833 1195.5573,-1208.3786 1250.5291,-1211.8115 1443.0237,-1223.8323 1491.5904,-1215.7003 1684.4568,-1216.8115 1758.0116,-1217.2352 1778.0975,-1232.5143 1849.9578,-1216.8115 1890.0994,-1208.0398 1932.5671,-1186.1945 1958.9384,-1170.9321"/>
<polygon fill="#ff007f" stroke="#ff007f" points="1960.7321,-1173.9376 1967.5647,-1165.8403 1957.1738,-1167.9094 1960.7321,-1173.9376"/>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node26" class="node">
<title>sourcefile~heatbalanceinternalheatgains.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node26"><a xlink:href="../sourcefile/heatbalanceinternalheatgains.f90.html" xlink:title="HeatBalanceInternalHeatGains.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1214.6633,-544.8169 1040.1267,-544.8169 1040.1267,-522.806 1214.6633,-522.806 1214.6633,-544.8169"/>
<text text-anchor="middle" x="1127.395" y="-530.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceInternalHeatGains.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantpipeheattransfer.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge137" class="edge">
<title>sourcefile~plantpipeheattransfer.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff007f" stroke-dasharray="5,2" d="M954.6212,-1185.736C970.5905,-1174.705 993.1929,-1156.2105 1004.261,-1133.8115 1076.0824,-988.4632 1003.9978,-928.8286 1040.261,-770.8115 1059.2939,-687.8752 1099.5574,-594.4567 1117.9148,-554.131"/>
<polygon fill="#ff007f" stroke="#ff007f" points="1121.185,-555.3968 1122.1824,-544.849 1114.825,-552.4726 1121.185,-555.3968"/>
</g>
<!-- sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1623.028,-1174.3681C1705.5049,-1169.9127 1848.0036,-1162.2147 1927.3942,-1157.926"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1927.8982,-1161.4039 1937.6948,-1157.3695 1927.5205,-1154.4141 1927.8982,-1161.4039"/>
</g>
<!-- sourcefile~plantloopsolver.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node18" class="node">
<title>sourcefile~plantloopsolver.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node18"><a xlink:href="../sourcefile/plantloopsolver.f90.html" xlink:title="PlantLoopSolver.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1820.1997,-1207.8169 1714.2148,-1207.8169 1714.2148,-1185.806 1820.1997,-1185.806 1820.1997,-1207.8169"/>
<text text-anchor="middle" x="1767.2073" y="-1193.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantLoopSolver.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantloopsolver.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantloopsolver.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1622.8,-1183.6153C1648.5248,-1185.9661 1678.1642,-1188.6746 1703.8711,-1191.0237"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1703.6051,-1194.5139 1713.8821,-1191.9385 1704.2422,-1187.543 1703.6051,-1194.5139"/>
</g>
<!-- sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node24" class="node">
<title>sourcefile~electricpowermanager.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node24"><a xlink:href="../sourcefile/electricpowermanager.f90.html" xlink:title="ElectricPowerManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="808.1546,-468.8169 674.0233,-468.8169 674.0233,-446.806 808.1546,-446.806 808.1546,-468.8169"/>
<text text-anchor="middle" x="741.089" y="-454.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ElectricPowerManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~photovoltaics.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge89" class="edge">
<title>sourcefile~photovoltaics.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M523.3474,-734.5215C557.7595,-690.7899 682.5194,-532.2428 726.0104,-476.9736"/>
<polygon fill="#00ff00" stroke="#00ff00" points="728.833,-479.0465 732.2664,-469.0234 723.3319,-474.7177 728.833,-479.0465"/>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge112" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1559.2874,-1081.8115C1688.7248,-1084.3593 1721.2331,-1076.6139 1849.9578,-1062.8115 1954.5941,-1051.5919 1980.7294,-1047.3386 2084.1379,-1027.8115 2217.296,-1002.6666 2248.1026,-984.4296 2381.3591,-959.8115"/>
</g>
<!-- sourcefile~airflownetworkbalancemanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node37" class="node">
<title>sourcefile~airflownetworkbalancemanager.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node37"><a xlink:href="../sourcefile/airflownetworkbalancemanager.f90.html" xlink:title="AirflowNetworkBalanceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1648.6265,-656.8169 1469.9482,-656.8169 1469.9482,-634.806 1648.6265,-634.806 1648.6265,-656.8169"/>
<text text-anchor="middle" x="1559.2874" y="-642.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">AirflowNetworkBalanceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~airflownetworkbalancemanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge114" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~airflownetworkbalancemanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1148.2727,-970.7357C1186.1436,-950.9556 1269.0373,-909.0793 1342.3235,-881.8115"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1342.3235,-881.8115C1392.2312,-863.2422 1403.717,-848.5308 1434.1179,-804.8115 1461.3245,-765.6859 1440.5901,-741.2163 1470.1179,-703.8115 1484.4097,-685.7071 1505.9811,-671.4626 1524.3271,-661.621"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1526.0029,-664.695 1533.2988,-657.0125 1522.8045,-658.4684 1526.0029,-664.695"/>
</g>
<!-- sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node40" class="node">
<title>sourcefile~simairservingzones.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node40"><a xlink:href="../sourcefile/simairservingzones.f90.html" xlink:title="SimAirServingZones.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2047.7614,-736.8169 1922.3343,-736.8169 1922.3343,-714.806 2047.7614,-714.806 2047.7614,-736.8169"/>
<text text-anchor="middle" x="1985.0479" y="-722.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SimAirServingZones.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge116" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1342.3235,-881.8115C1400.8227,-859.6437 1410.5924,-842.0541 1470.1179,-822.8115 1534.1229,-802.1208 1701.0434,-776.9392 1767.2073,-764.8115"/>
</g>
<!-- sourcefile~hvacstandaloneerv.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node47" class="node">
<title>sourcefile~hvacstandaloneerv.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node47"><a xlink:href="../sourcefile/hvacstandaloneerv.f90.html" xlink:title="HVACStandAloneERV.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1833.3552,-1053.8169 1701.0593,-1053.8169 1701.0593,-1031.806 1833.3552,-1031.806 1833.3552,-1053.8169"/>
<text text-anchor="middle" x="1767.2073" y="-1039.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACStandAloneERV.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacstandaloneerv.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge110" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacstandaloneerv.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1153.2232,-993.0146C1219.5401,-1020.6247 1401.6816,-1089.1859 1559.2874,-1081.8115"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1559.2874,-1081.8115C1616.2773,-1082.9333 1680.5874,-1068.3602 1722.3948,-1056.7104"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1723.6027,-1060.0056 1732.2605,-1053.8988 1721.6841,-1053.2737 1723.6027,-1060.0056"/>
</g>
<!-- sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node48" class="node">
<title>sourcefile~hvaccontrollers.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node48"><a xlink:href="../sourcefile/hvaccontrollers.f90.html" xlink:title="HVACControllers.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1613.4668,-853.8169 1505.1079,-853.8169 1505.1079,-831.806 1613.4668,-831.806 1613.4668,-853.8169"/>
<text text-anchor="middle" x="1559.2874" y="-839.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACControllers.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge111" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~hvaccontrollers.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1342.3235,-881.8115C1391.7393,-863.4252 1450.8039,-853.5334 1494.8206,-848.3183"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1495.2797,-851.7888 1504.821,-847.1829 1494.49,-844.8334 1495.2797,-851.7888"/>
</g>
<!-- sourcefile~packagedterminalheatpump.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node49" class="node">
<title>sourcefile~packagedterminalheatpump.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node49"><a xlink:href="../sourcefile/packagedterminalheatpump.f90.html" xlink:title="PackagedTerminalHeatPump.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1849.709,-971.8169 1684.7055,-971.8169 1684.7055,-949.806 1849.709,-949.806 1849.709,-971.8169"/>
<text text-anchor="middle" x="1767.2073" y="-957.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PackagedTerminalHeatPump.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~packagedterminalheatpump.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge113" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~packagedterminalheatpump.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1559.2874,-981.8115C1613.1067,-993.5497 1676.2221,-983.9779 1718.6764,-974.2444"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1719.5561,-977.6328 1728.4731,-971.9112 1717.9343,-970.8233 1719.5561,-977.6328"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1342.3235,-881.8115C1441.8364,-844.7855 1455.5482,-959.1856 1559.2874,-981.8115"/>
</g>
<!-- sourcefile~hvacvariablerefrigerantflow.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node50" class="node">
<title>sourcefile~hvacvariablerefrigerantflow.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node50"><a xlink:href="../sourcefile/hvacvariablerefrigerantflow.f90.html" xlink:title="HVACVariableRefrigerantFlow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1427.0211,-992.8169 1257.6259,-992.8169 1257.6259,-970.806 1427.0211,-970.806 1427.0211,-992.8169"/>
<text text-anchor="middle" x="1342.3235" y="-978.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACVariableRefrigerantFlow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacvariablerefrigerantflow.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge115" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacvariablerefrigerantflow.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1162.4053,-981.8115C1185.596,-981.8115 1217.2128,-981.8115 1247.4761,-981.8115"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1247.6734,-985.3116 1257.6733,-981.8115 1247.6733,-978.3116 1247.6734,-985.3116"/>
</g>
<!-- sourcefile~hvacunitarybypassvav.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node51" class="node">
<title>sourcefile~hvacunitarybypassvav.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node51"><a xlink:href="../sourcefile/hvacunitarybypassvav.f90.html" xlink:title="HVACUnitaryBypassVAV.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1631.3885,-775.8169 1487.1862,-775.8169 1487.1862,-753.806 1631.3885,-753.806 1631.3885,-775.8169"/>
<text text-anchor="middle" x="1559.2874" y="-761.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACUnitaryBypassVAV.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacunitarybypassvav.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge117" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacunitarybypassvav.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1342.3235,-881.8115C1407.9151,-857.4066 1407.0595,-820.1676 1470.1179,-789.8115 1479.0271,-785.5226 1488.802,-781.8516 1498.5123,-778.7491"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1499.6051,-782.0753 1508.1667,-775.8343 1497.5819,-775.374 1499.6051,-782.0753"/>
</g>
<!-- sourcefile~fancoilunits.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node52" class="node">
<title>sourcefile~fancoilunits.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node52"><a xlink:href="../sourcefile/fancoilunits.f90.html" xlink:title="FanCoilUnits.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1811.825,-855.8169 1722.5895,-855.8169 1722.5895,-833.806 1811.825,-833.806 1811.825,-855.8169"/>
<text text-anchor="middle" x="1767.2073" y="-841.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">FanCoilUnits.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~fancoilunits.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge118" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~fancoilunits.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1342.3235,-881.8115C1406.2054,-858.0427 1580.6803,-870.0371 1648.4568,-862.8115 1669.4759,-860.5706 1692.4692,-857.2819 1712.5773,-854.1267"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1713.1746,-857.5758 1722.4986,-852.5446 1712.0722,-850.6631 1713.1746,-857.5758"/>
</g>
<!-- sourcefile~windowac.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node53" class="node">
<title>sourcefile~windowac.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node53"><a xlink:href="../sourcefile/windowac.f90.html" xlink:title="WindowAC.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1808.1531,-1012.8169 1726.2615,-1012.8169 1726.2615,-990.806 1808.1531,-990.806 1808.1531,-1012.8169"/>
<text text-anchor="middle" x="1767.2073" y="-998.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WindowAC.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~windowac.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge119" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~windowac.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1559.2874,-981.8115C1611.986,-993.3052 1673.6346,-998.1945 1716.0443,-1000.2738"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1715.9775,-1003.7743 1726.1264,-1000.7329 1716.296,-996.7815 1715.9775,-1003.7743"/>
</g>
<!-- sourcefile~plantmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~plantmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2381.3591,-1111.8115C2473.041,-1107.5299 2492.56,-1073.8115 2584.3418,-1073.8115"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2032.4845,-1147.7573C2106.6918,-1137.154 2254.8466,-1117.7196 2381.3591,-1111.8115"/>
</g>
<!-- sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node20" class="node">
<title>sourcefile~utilityroutines.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node20"><a xlink:href="../sourcefile/utilityroutines.f90.html" xlink:title="UtilityRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3266.8908,-452.8169 3170.6485,-452.8169 3170.6485,-430.806 3266.8908,-430.806 3266.8908,-452.8169"/>
<text text-anchor="middle" x="3218.7697" y="-438.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">UtilityRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~plantmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2381.3591,-1111.8115C2471.1989,-1103.5967 2495.3739,-1096.8659 2584.3418,-1111.8115"/>
</g>
<!-- sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node21" class="node">
<title>sourcefile~hvacmanager.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node21"><a xlink:href="../sourcefile/hvacmanager.f90.html" xlink:title="HVACManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2240.2089,-697.8169 2141.6508,-697.8169 2141.6508,-675.806 2240.2089,-675.806 2240.2089,-697.8169"/>
<text text-anchor="middle" x="2190.9298" y="-683.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantmanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~plantmanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1996.8818,-1143.6938C2017.4545,-1123.7519 2059.9259,-1079.7706 2084.1379,-1034.8115 2116.0709,-975.5155 2168.8548,-773.7371 2185.6361,-707.8272"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2189.0294,-708.6843 2188.0941,-698.1308 2182.2441,-706.9641 2189.0294,-708.6843"/>
</g>
<!-- sourcefile~plantloopsolver.f90&#45;&gt;sourcefile~plantmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~plantloopsolver.f90&#45;&gt;sourcefile~plantmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1820.2185,-1186.5908C1852.7465,-1180.3194 1894.4017,-1172.2882 1927.6979,-1165.8686"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1928.587,-1169.2618 1937.7435,-1163.9318 1927.2617,-1162.3883 1928.587,-1169.2618"/>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3134.5803,-430.1195C3143.0413,-431.2945 3151.7333,-432.5017 3160.1708,-433.6734"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3159.9173,-437.1717 3170.3037,-435.0807 3160.8803,-430.2383 3159.9173,-437.1717"/>
</g>
<!-- sourcefile~energyplus.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node22" class="node">
<title>sourcefile~energyplus.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node22"><a xlink:href="../sourcefile/energyplus.f90.html" xlink:title="EnergyPlus.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3260.4782,-411.8169 3177.0611,-411.8169 3177.0611,-389.806 3260.4782,-389.806 3260.4782,-411.8169"/>
<text text-anchor="middle" x="3218.7697" y="-397.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EnergyPlus.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3134.5803,-413.088C3145.2449,-411.5329 3156.2768,-409.9242 3166.7031,-408.4038"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3167.5013,-411.8246 3176.8916,-406.9182 3166.4912,-404.8978 3167.5013,-411.8246"/>
</g>
<!-- sourcefile~hvacmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~hvacmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2240.2851,-685.4326C2278.7493,-684.6913 2333.4836,-684.3666 2381.3591,-686.8115"/>
</g>
<!-- sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node23" class="node">
<title>sourcefile~heatbalanceairmanager.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node23"><a xlink:href="../sourcefile/heatbalanceairmanager.f90.html" xlink:title="HeatBalanceAirManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2453.1967,-622.8169 2309.5216,-622.8169 2309.5216,-600.806 2453.1967,-600.806 2453.1967,-622.8169"/>
<text text-anchor="middle" x="2381.3591" y="-608.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceAirManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacmanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~hvacmanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2219.0283,-675.745C2252.0787,-662.7282 2307.0806,-641.0658 2343.7753,-626.6137"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2345.1236,-629.8445 2353.1453,-622.9234 2342.5584,-623.3314 2345.1236,-629.8445"/>
</g>
<!-- sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2390.7611,-600.7412C2410.2932,-577.9972 2457.1053,-524.7916 2500.9966,-484.8115 2520.0573,-467.4492 2543.3022,-449.5648 2560.3962,-436.9618"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2562.7081,-439.6074 2568.7198,-430.8833 2558.5798,-433.9543 2562.7081,-439.6074"/>
</g>
<!-- sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2584.3418,-686.8115C2699.7878,-697.386 2747.8237,-727.4262 2844.0762,-662.8115 2912.3222,-616.9976 2855.7337,-534.9402 2929.5656,-498.8115"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2400.417,-622.8572C2435.4457,-642.2287 2513.0225,-680.8475 2584.3418,-686.8115"/>
</g>
<!-- sourcefile~electricpowermanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge86" class="edge">
<title>sourcefile~electricpowermanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M743.879,-469.0681C760.1258,-532.2502 848.5249,-845.5207 1040.261,-1001.8115 1306.5139,-1218.8436 2240.8399,-1073.8115 2584.3418,-1073.8115"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2584.3418,-1073.8115C2906.6137,-1054.8254 3043.7732,-552.8241 3069.9833,-442.9352"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3073.4291,-443.5701 3072.2942,-433.0362 3066.6124,-441.9787 3073.4291,-443.5701"/>
</g>
<!-- sourcefile~electricpowermanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge88" class="edge">
<title>sourcefile~electricpowermanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M936.8734,-494.8115C1302.4528,-547.9666 1399.4591,-421.6684 1767.2073,-456.8115"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M794.9621,-468.8385C834.2094,-476.6651 888.711,-487.1069 936.8734,-494.8115"/>
</g>
<!-- sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node25" class="node">
<title>sourcefile~outputreporttabular.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node25"><a xlink:href="../sourcefile/outputreporttabular.f90.html" xlink:title="OutputReportTabular.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1000.2872,-390.8169 873.4597,-390.8169 873.4597,-368.806 1000.2872,-368.806 1000.2872,-390.8169"/>
<text text-anchor="middle" x="936.8734" y="-376.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputReportTabular.f90</text>
</a>
</g>
</g>
<!-- sourcefile~electricpowermanager.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge85" class="edge">
<title>sourcefile~electricpowermanager.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M789.6596,-446.7127C803.9751,-442.8968 819.5363,-438.2055 833.4858,-432.8115 860.078,-422.5287 888.8244,-407.4429 909.2389,-395.9931"/>
<polygon fill="#ff0000" stroke="#ff0000" points="911.0289,-399.0017 917.9945,-391.0186 907.5709,-392.9154 911.0289,-399.0017"/>
</g>
<!-- sourcefile~electricpowermanager.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge87" class="edge">
<title>sourcefile~electricpowermanager.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M936.8734,-494.8115C982.419,-501.4338 1033.4815,-512.0619 1071.2709,-520.5518"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1070.5441,-523.9758 1081.0703,-522.7723 1072.091,-517.1489 1070.5441,-523.9758"/>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge54" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1767.2073,-340.8115C1865.3984,-346.5281 1886.7994,-375.1838 1985.0479,-379.8115"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2190.9298,-380.8115C2305.2733,-375.6845 2437.5882,-393.7865 2515.9398,-407.0296"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2515.7128,-410.5417 2526.1604,-408.7815 2516.8955,-403.6423 2515.7128,-410.5417"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1985.0479,-379.8115C2076.4507,-384.1167 2099.4414,-382.5111 2190.9298,-380.8115"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1127.395,-302.8115C1350.0799,-238.3451 1417.4014,-307.8945 1648.4568,-326.8115 1701.4231,-331.1479 1714.1536,-337.7227 1767.2073,-340.8115"/>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge47" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2381.3591,-72.8115C2435.5405,-70.4786 2447.6382,-58.5038 2500.9966,-48.8115 2590.7979,-32.4995 2612.7133,-23.1687 2703.687,-15.8115 2765.8791,-10.7818 2790.1484,15.5725 2844.0762,-15.8115 2994.72,-103.4806 3055.0366,-330.2561 3070.4933,-400.6497"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3067.0965,-401.5037 3072.5958,-410.5595 3073.9441,-400.0508 3067.0965,-401.5037"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M942.6109,-368.7877C974.0404,-310.0781 1131.646,-36.8115 1342.3235,-36.8115 1342.3235,-36.8115 1342.3235,-36.8115 1767.2073,-36.8115 2040.6322,-36.8115 2107.9354,-72.0189 2381.3591,-72.8115"/>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge51" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1767.2073,-456.8115C1910.1272,-464.3395 1976.1859,-419.848 2084.1379,-513.8115 2122.9388,-547.5845 2091.9504,-580.7814 2120.1379,-623.8115 2132.0452,-641.9886 2150.5095,-658.1791 2165.5953,-669.5943"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2163.8726,-672.6702 2174.0122,-675.7426 2168.0016,-667.0177 2163.8726,-672.6702"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1127.395,-302.8115C1185.7462,-286.147 1192.121,-345.3474 1250.5291,-361.8115 1421.6536,-410.0481 1476.8574,-356.2925 1648.4568,-402.8115 1704.4156,-417.9814 1709.5919,-450.3322 1767.2073,-456.8115"/>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge46" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M950.5753,-390.8868C983.1769,-417.2389 1065.598,-483.8605 1105.3212,-515.969"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1103.584,-519.0653 1113.5613,-522.6296 1107.9844,-513.6213 1103.584,-519.0653"/>
</g>
<!-- sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node27" class="node">
<title>sourcefile~sizingmanager.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node27"><a xlink:href="../sourcefile/sizingmanager.f90.html" xlink:title="SizingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2979.0443,-432.8169 2880.0868,-432.8169 2880.0868,-410.806 2979.0443,-410.806 2979.0443,-432.8169"/>
<text text-anchor="middle" x="2929.5656" y="-418.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SizingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge45" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2381.3591,-72.8115C2508.7644,-67.0218 2556.5577,-29.2345 2667.687,-91.8115 2810.9855,-172.5029 2757.4662,-285.2106 2880.0762,-394.8115 2884.5638,-398.823 2889.7515,-402.4653 2895.0438,-405.6844"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2893.5127,-408.8388 2903.9441,-410.6926 2896.9455,-402.7383 2893.5127,-408.8388"/>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge48" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2584.3418,-188.8115C2688.7294,-216.999 2619.2301,-333.296 2703.687,-400.8115 2706.1414,-402.7736 2708.7758,-404.5525 2711.5325,-406.1654"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2710.177,-409.4015 2720.6827,-410.7724 2713.3249,-403.1492 2710.177,-409.4015"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1767.2073,-226.8115C1865.4365,-223.6508 1887.7315,-278.5408 1985.0479,-264.8115"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1985.0479,-264.8115C2250.9013,-227.3049 2325.1393,-118.8197 2584.3418,-188.8115"/>
</g>
<!-- sourcefile~economiclifecyclecost.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node29" class="node">
<title>sourcefile~economiclifecyclecost.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node29"><a xlink:href="../sourcefile/economiclifecyclecost.f90.html" xlink:title="EconomicLifeCycleCost.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2844.2713,-391.8169 2703.4919,-391.8169 2703.4919,-369.806 2844.2713,-369.806 2844.2713,-391.8169"/>
<text text-anchor="middle" x="2773.8816" y="-377.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EconomicLifeCycleCost.f90</text>
</a>
</g>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~economiclifecyclecost.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge49" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~economiclifecyclecost.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1127.395,-302.8115C1181.9204,-288.6791 1194.9567,-282.0016 1250.5291,-272.8115 1477.9829,-235.197 1536.8823,-236.8369 1767.2073,-226.8115"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1767.2073,-226.8115C1958.0661,-213.4434 1999.6034,-150.8115 2190.9298,-150.8115 2190.9298,-150.8115 2190.9298,-150.8115 2381.3591,-150.8115 2509.0622,-150.8115 2563.0891,-101.5492 2667.687,-174.8115 2698.9598,-196.7155 2686.4973,-218.7191 2703.687,-252.8115 2723.2293,-291.5697 2748.0407,-335.7579 2762.3246,-360.7636"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2759.4092,-362.7155 2767.4194,-369.65 2765.4819,-359.2338 2759.4092,-362.7155"/>
</g>
<!-- sourcefile~roomairmodelusertemppattern.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node30" class="node">
<title>sourcefile~roomairmodelusertemppattern.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node30"><a xlink:href="../sourcefile/roomairmodelusertemppattern.f90.html" xlink:title="RoomAirModelUserTempPattern.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1432.4749,-672.8169 1252.172,-672.8169 1252.172,-650.806 1432.4749,-650.806 1432.4749,-672.8169"/>
<text text-anchor="middle" x="1342.3235" y="-658.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RoomAirModelUserTempPattern.f90</text>
</a>
</g>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~roomairmodelusertemppattern.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge50" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~roomairmodelusertemppattern.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M945.0517,-391.0141C958.2598,-409.3294 984.7739,-447.0327 1004.261,-480.8115 1022.3381,-512.1461 1012.0704,-531.1414 1040.261,-553.8115 1102.4285,-603.8047 1147.0872,-554.2002 1214.5291,-596.8115 1235.8896,-610.3076 1229.0544,-627.4975 1250.5291,-640.8115 1254.2024,-643.0889 1258.0961,-645.1199 1262.1253,-646.9311"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1261.1483,-650.3098 1271.7332,-650.7708 1263.7461,-643.8096 1261.1483,-650.3098"/>
</g>
<!-- sourcefile~economictariff.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node31" class="node">
<title>sourcefile~economictariff.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node31"><a xlink:href="../sourcefile/economictariff.f90.html" xlink:title="EconomicTariff.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2633.5261,-122.8169 2535.1575,-122.8169 2535.1575,-100.806 2633.5261,-100.806 2633.5261,-122.8169"/>
<text text-anchor="middle" x="2584.3418" y="-108.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EconomicTariff.f90</text>
</a>
</g>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~economictariff.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge52" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~economictariff.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M960.125,-368.753C995.5173,-352.3047 1065.353,-321.3474 1127.395,-302.8115"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1127.395,-302.8115C1192.3444,-283.4069 1191.8974,-246.8304 1250.5291,-212.8115 1380.5388,-137.378 1408.9786,-74.8115 1559.2874,-74.8115 1559.2874,-74.8115 1559.2874,-74.8115 1767.2073,-74.8115 2051.28,-74.8115 2390.3352,-97.4032 2524.9951,-107.2803"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2524.8684,-110.7803 2535.0989,-108.0257 2525.3835,-103.7993 2524.8684,-110.7803"/>
</g>
<!-- sourcefile~thermalcomfort.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node32" class="node">
<title>sourcefile~thermalcomfort.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node32"><a xlink:href="../sourcefile/thermalcomfort.f90.html" xlink:title="ThermalComfort.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1395.1859,-352.8169 1289.461,-352.8169 1289.461,-330.806 1395.1859,-330.806 1395.1859,-352.8169"/>
<text text-anchor="middle" x="1342.3235" y="-338.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ThermalComfort.f90</text>
</a>
</g>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~thermalcomfort.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge53" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~thermalcomfort.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1127.395,-302.8115C1157.9698,-294.0796 1240.712,-313.5218 1294.1579,-327.974"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1293.5354,-331.4323 1304.1047,-330.6973 1295.3839,-324.6808 1293.5354,-331.4323"/>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelcrossvent.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge74" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelcrossvent.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1148.9627,-544.9248C1168.3603,-555.8591 1196.5,-574.1808 1214.5291,-596.8115 1240.0927,-628.8998 1219.0854,-655.4589 1250.5291,-681.8115 1253.3071,-684.1397 1256.2926,-686.2222 1259.4286,-688.0841"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1258.1192,-691.345 1268.6181,-692.7677 1261.2978,-685.1083 1258.1192,-691.345"/>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelufad.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge80" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelufad.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1129.9026,-545.073C1138.8859,-582.6553 1173.1294,-704.7175 1250.5291,-763.8115 1256.0292,-768.0107 1262.22,-771.3955 1268.7227,-774.1202"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1267.8352,-777.5219 1278.4291,-777.6581 1270.2324,-770.9452 1267.8352,-777.5219"/>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge81" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1559.2874,-416.8115C1655.2218,-394.9732 1668.9849,-335.093 1767.2073,-340.8115"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1164.1155,-522.7754C1238.3061,-500.7203 1411.5823,-450.4347 1559.2874,-416.8115"/>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodeldisplacementvent.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge82" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodeldisplacementvent.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1131.1895,-544.8956C1143.0543,-577.7956 1182.7592,-675.5332 1250.5291,-722.8115 1253.5919,-724.9482 1256.8391,-726.8708 1260.2133,-728.6005"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1258.8474,-731.824 1269.4023,-732.7431 1261.7244,-725.4425 1258.8474,-731.824"/>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge78" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1559.2874,-606.8115C1776.0537,-590.5382 2032.526,-646.4759 2139.7842,-673.2844"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2139.1394,-676.7313 2149.6918,-675.7844 2140.8521,-669.944 2139.1394,-676.7313"/>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge76" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1129.9591,-522.7337C1139.0182,-486.3974 1173.2256,-370.387 1250.5291,-321.8115 1389.1502,-234.7054 1822.7834,-286.5726 1985.0479,-264.8115"/>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelusertemppattern.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge77" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelusertemppattern.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1191.2492,-544.9438C1199.7083,-548.3943 1207.7747,-552.9082 1214.5291,-558.8115 1244.4981,-585.0041 1219.8574,-615.4452 1250.5291,-640.8115 1252.6235,-642.5436 1254.833,-644.1393 1257.1339,-645.6091"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1255.9568,-648.9542 1266.4109,-650.6754 1259.3119,-642.8106 1255.9568,-648.9542"/>
</g>
<!-- sourcefile~zonetemppredictorcorrector.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node34" class="node">
<title>sourcefile~zonetemppredictorcorrector.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node34"><a xlink:href="../sourcefile/zonetemppredictorcorrector.f90.html" xlink:title="ZoneTempPredictorCorrector.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1849.5294,-544.8169 1684.8852,-544.8169 1684.8852,-522.806 1849.5294,-522.806 1849.5294,-544.8169"/>
<text text-anchor="middle" x="1767.2073" y="-530.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ZoneTempPredictorCorrector.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~zonetemppredictorcorrector.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge83" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~zonetemppredictorcorrector.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1559.2874,-606.8115C1625.7107,-601.2288 1698.031,-569.4302 1737.4526,-549.687"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1739.4234,-552.6108 1746.7426,-544.9505 1736.2439,-546.3746 1739.4234,-552.6108"/>
</g>
<!-- sourcefile~zonecontaminantpredictorcorrector.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node35" class="node">
<title>sourcefile~zonecontaminantpredictorcorrector.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node35"><a xlink:href="../sourcefile/zonecontaminantpredictorcorrector.f90.html" xlink:title="ZoneContaminantPredictorCorrector.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2084.2281,-544.8169 1885.8676,-544.8169 1885.8676,-522.806 2084.2281,-522.806 2084.2281,-544.8169"/>
<text text-anchor="middle" x="1985.0479" y="-530.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ZoneContaminantPredictorCorrector.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~zonecontaminantpredictorcorrector.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge75" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~zonecontaminantpredictorcorrector.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1559.2874,-606.8115C1628.3493,-601.0071 1618.6588,-535.5798 1684.4568,-513.8115 1770.8246,-485.238 1878.5942,-504.7255 1938.8118,-520.1553"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1938.2101,-523.6162 1948.772,-522.7824 1939.9954,-516.8477 1938.2101,-523.6162"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1342.3235,-581.8115C1438.7965,-592.5281 1462.4933,-614.0781 1559.2874,-606.8115"/>
</g>
<!-- sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node36" class="node">
<title>sourcefile~zoneequipmentmanager.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node36"><a xlink:href="../sourcefile/zoneequipmentmanager.f90.html" xlink:title="Zoneequipmentmanager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2056.8957,-837.8169 1913.2,-837.8169 1913.2,-815.806 2056.8957,-815.806 2056.8957,-837.8169"/>
<text text-anchor="middle" x="1985.0479" y="-823.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Zoneequipmentmanager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge72" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1342.3235,-581.8115C1383.5101,-588.0888 1400.5658,-576.1133 1434.1179,-600.8115 1460.7131,-620.3885 1443.5799,-646.1569 1470.1179,-665.8115 1535.2428,-714.0443 1570.8364,-680.5148 1648.4568,-703.8115 1757.032,-736.3988 1778.8474,-759.6917 1885.9578,-796.8115 1902.1317,-802.4167 1919.9851,-808.0032 1936.0301,-812.8093"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1935.173,-816.2057 1945.7555,-815.6941 1937.1637,-809.4947 1935.173,-816.2057"/>
</g>
<!-- sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node41" class="node">
<title>sourcefile~daylightingmanager.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node41"><a xlink:href="../sourcefile/daylightingmanager.f90.html" xlink:title="DaylightingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2046.3752,-429.8169 1923.7205,-429.8169 1923.7205,-407.806 2046.3752,-407.806 2046.3752,-429.8169"/>
<text text-anchor="middle" x="1985.0479" y="-415.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DaylightingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge73" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1190.314,-544.8713C1198.4768,-546.4508 1206.7128,-548.117 1214.5291,-549.8115 1271.751,-562.2162 1284.1303,-575.3471 1342.3235,-581.8115"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1342.3235,-581.8115C1505.4497,-599.9322 1524.7543,-480.6748 1684.4568,-442.8115 1761.2627,-424.6018 1851.8673,-419.5168 1913.3734,-418.4131"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1913.8003,-421.9072 1923.7475,-418.2597 1913.6968,-414.908 1913.8003,-421.9072"/>
</g>
<!-- sourcefile~delightmanagerf.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node42" class="node">
<title>sourcefile~delightmanagerf.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node42"><a xlink:href="../sourcefile/delightmanagerf.f90.html" xlink:title="DElightManagerF.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1822.2603,-390.8169 1712.1543,-390.8169 1712.1543,-368.806 1822.2603,-368.806 1822.2603,-390.8169"/>
<text text-anchor="middle" x="1767.2073" y="-376.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DElightManagerF.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~delightmanagerf.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge79" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~delightmanagerf.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1559.2874,-416.8115C1606.6806,-406.023 1660.7461,-396.4859 1701.8641,-389.7973"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1702.4445,-393.249 1711.7599,-388.2018 1701.3303,-386.3382 1702.4445,-393.249"/>
</g>
<!-- sourcefile~roomairmodelmundt.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node43" class="node">
<title>sourcefile~roomairmodelmundt.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node43"><a xlink:href="../sourcefile/roomairmodelmundt.f90.html" xlink:title="RoomAirModelMundt.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1406.4593,-631.8169 1278.1877,-631.8169 1278.1877,-609.806 1406.4593,-609.806 1406.4593,-631.8169"/>
<text text-anchor="middle" x="1342.3235" y="-617.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RoomAirModelMundt.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelmundt.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge84" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelmundt.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1182.2014,-544.8286C1193.3496,-548.3444 1204.6708,-552.9121 1214.5291,-558.8115 1234.217,-570.593 1230.762,-584.1632 1250.5291,-595.8115 1257.6886,-600.0304 1265.5795,-603.5566 1273.6378,-606.4995"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1272.5467,-609.8251 1283.1407,-609.6928 1274.7764,-603.1897 1272.5467,-609.8251"/>
</g>
<!-- sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2979.1262,-421.8115C2987.3926,-421.8115 2996.1035,-421.8115 3004.7649,-421.8115"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3004.8804,-425.3116 3014.8803,-421.8115 3004.8803,-418.3116 3004.8804,-425.3116"/>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge15" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M2809.4437,-432.8955C2820.7161,-436.8255 2833.0966,-441.5846 2844.0762,-446.8115 2884.2303,-465.9271 2889.5674,-518.2515 2929.5656,-498.8115"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M2929.5656,-498.8115C2970.5514,-478.8914 3016.9098,-453.856 3045.9839,-437.8416"/>
<polygon fill="#ffff00" stroke="#ffff00" points="3047.7276,-440.877 3054.7875,-432.9771 3044.342,-434.7501 3047.7276,-440.877"/>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge14" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M2839.0035,-421.8115C2849.1455,-421.8115 2859.5836,-421.8115 2869.6038,-421.8115"/>
<polygon fill="#ffff00" stroke="#ffff00" points="2869.8648,-425.3116 2879.8647,-421.8115 2869.8647,-418.3116 2869.8648,-425.3116"/>
</g>
<!-- sourcefile~economiclifecyclecost.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge16" class="edge">
<title>sourcefile~economiclifecyclecost.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2821.5508,-369.7979C2853.8526,-364.8822 2896.5101,-363.5322 2929.5656,-380.8115"/>
</g>
<!-- sourcefile~roomairmodelusertemppattern.f90&#45;&gt;sourcefile~roomairmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge26" class="edge">
<title>sourcefile~roomairmodelusertemppattern.f90&#45;&gt;sourcefile~roomairmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1398.6248,-672.8803C1410.4661,-675.7114 1422.7954,-679.0397 1434.1179,-682.8115 1450.7295,-688.3452 1453.6452,-692.877 1470.1179,-698.8115 1481.3443,-702.8559 1493.5561,-706.6565 1505.2384,-710.0148"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1504.3197,-713.3921 1514.8936,-712.7273 1506.213,-706.653 1504.3197,-713.3921"/>
</g>
<!-- sourcefile~economictariff.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge29" class="edge">
<title>sourcefile~economictariff.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2633.4914,-122.4873C2645.1332,-126.1025 2657.2037,-130.7987 2667.687,-136.8115 2805.6821,-215.9587 2788.5838,-307.1155 2929.5656,-380.8115"/>
</g>
<!-- sourcefile~economictariff.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge27" class="edge">
<title>sourcefile~economictariff.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2607.4043,-122.853C2626.7731,-133.3967 2653.4944,-151.1748 2667.687,-174.8115 2720.0456,-262.0105 2636.6944,-324.2799 2703.687,-400.8115 2704.8966,-402.1933 2706.1931,-403.4861 2707.5627,-404.6955"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2705.9283,-407.8267 2716.1121,-410.749 2709.9734,-402.1138 2705.9283,-407.8267"/>
</g>
<!-- sourcefile~economictariff.f90&#45;&gt;sourcefile~economiclifecyclecost.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge28" class="edge">
<title>sourcefile~economictariff.f90&#45;&gt;sourcefile~economiclifecyclecost.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2633.5724,-117.0805C2646.3185,-120.753 2658.9098,-126.8272 2667.687,-136.8115 2732.8139,-210.8943 2640.4599,-280.1008 2703.687,-355.8115 2706.4856,-359.1626 2709.7663,-362.0647 2713.3534,-364.5778"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2711.7999,-367.7242 2722.1965,-369.7643 2715.3413,-361.6861 2711.7999,-367.7242"/>
</g>
<!-- sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge41" class="edge">
<title>sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1559.2874,-340.8115C1651.5904,-336.3897 1674.9546,-335.4406 1767.2073,-340.8115"/>
</g>
<!-- sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~zonetemppredictorcorrector.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge42" class="edge">
<title>sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~zonetemppredictorcorrector.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1358.655,-352.8469C1377.0746,-365.3334 1407.8831,-386.339 1434.1179,-404.8115 1450.2554,-416.1742 1452.6081,-421.7044 1470.1179,-430.8115 1550.6318,-472.6877 1651.8618,-503.612 1712.9482,-520.1489"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1712.2016,-523.5722 1722.7665,-522.7764 1714.0112,-516.8101 1712.2016,-523.5722"/>
</g>
<!-- sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~airflownetworkbalancemanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge43" class="edge">
<title>sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~airflownetworkbalancemanager.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1346.7516,-352.891C1366.6058,-402.3554 1447.4399,-601.4249 1470.1179,-620.8115 1474.5805,-624.6263 1479.5842,-627.8615 1484.8839,-630.6048"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1483.4876,-633.8147 1494.039,-634.7727 1486.3879,-627.4439 1483.4876,-633.8147"/>
</g>
<!-- sourcefile~weathermanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node38" class="node">
<title>sourcefile~weathermanager.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node38"><a xlink:href="../sourcefile/weathermanager.f90.html" xlink:title="WeatherManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2828.7603,-46.8169 2719.0029,-46.8169 2719.0029,-24.806 2828.7603,-24.806 2828.7603,-46.8169"/>
<text text-anchor="middle" x="2773.8816" y="-32.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WeatherManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~weathermanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge44" class="edge">
<title>sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~weathermanager.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1559.2874,-340.8115C1566.6192,-340.4602 2077.0629,-280.7668 2084.1379,-278.8115 2279.8593,-224.7212 2307.7445,-154.1513 2500.9966,-91.8115 2570.434,-69.4122 2652.7981,-53.9653 2708.7399,-45.0555"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="2709.5316,-48.4742 2718.8689,-43.4677 2708.4475,-41.5587 2709.5316,-48.4742"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1395.3898,-342.3161C1439.3241,-342.5539 1503.3758,-342.4855 1559.2874,-340.8115"/>
</g>
<!-- sourcefile~roomairmanager.f90&#45;&gt;sourcefile~zonetemppredictorcorrector.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge25" class="edge">
<title>sourcefile~roomairmanager.f90&#45;&gt;sourcefile~zonetemppredictorcorrector.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1579.4529,-712.746C1598.2386,-701.9763 1626.5609,-684.5343 1648.4568,-665.8115 1690.3146,-630.0194 1731.587,-579.8927 1752.7032,-552.8732"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1755.4746,-555.0108 1758.8261,-544.96 1749.9383,-550.727 1755.4746,-555.0108"/>
</g>
<!-- sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge23" class="edge">
<title>sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1985.0479,-572.8115C2072.4935,-600.2197 2289.838,-682.1378 2381.3591,-686.8115"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2381.3591,-686.8115C2471.4108,-692.23 2494.4411,-679.2937 2584.3418,-686.8115"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1833.2748,-544.82C1891.9609,-554.7334 1970.6264,-568.403 1985.0479,-572.8115"/>
</g>
<!-- sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge24" class="edge">
<title>sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1985.0479,-572.8115C2028.2871,-586.364 2048.1008,-569.341 2084.1379,-596.8115 2110.4013,-616.8316 2094.9277,-640.4804 2120.1379,-661.8115 2124.6,-665.5869 2129.671,-668.8068 2135.0008,-671.5499"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2133.6026,-674.759 2144.1528,-675.7301 2136.5109,-668.3917 2133.6026,-674.759"/>
</g>
<!-- sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~zonecontaminantpredictorcorrector.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge21" class="edge">
<title>sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~zonecontaminantpredictorcorrector.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1849.5635,-533.8115C1858.0502,-533.8115 1866.766,-533.8115 1875.4873,-533.8115"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1875.7146,-537.3116 1885.7145,-533.8115 1875.7145,-530.3116 1875.7146,-537.3116"/>
</g>
<!-- sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge22" class="edge">
<title>sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1775.6739,-545.0334C1792.1311,-567.3217 1828.6835,-619.2205 1849.9578,-667.8115 1873.8309,-722.3384 1844.33,-754.2646 1885.9578,-796.8115 1891.9208,-802.9061 1899.0763,-807.7722 1906.7777,-811.6557"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1905.4716,-814.9054 1916.0304,-815.778 1908.3203,-808.5112 1905.4716,-814.9054"/>
</g>
<!-- sourcefile~zonecontaminantpredictorcorrector.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge17" class="edge">
<title>sourcefile~zonecontaminantpredictorcorrector.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2032.7241,-544.851C2176.9507,-575.6774 2617.8144,-650.8469 2929.5656,-498.8115"/>
</g>
<!-- sourcefile~zonecontaminantpredictorcorrector.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge18" class="edge">
<title>sourcefile~zonecontaminantpredictorcorrector.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2058.0816,-544.8367C2067.4219,-548.3101 2076.4056,-552.8589 2084.1379,-558.8115 2110.3058,-578.9562 2099.5097,-598.023 2120.1379,-623.8115 2133.9692,-641.1027 2152.8236,-657.6255 2167.5967,-669.4087"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2165.7161,-672.3805 2175.7545,-675.7688 2170.0201,-666.86 2165.7161,-672.3805"/>
</g>
<!-- sourcefile~zoneequipmentmanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge20" class="edge">
<title>sourcefile~zoneequipmentmanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2043.0977,-815.7818C2057.3212,-811.3687 2071.9461,-805.2525 2084.1379,-796.8115 2105.7714,-781.8336 2102.2292,-769.089 2120.1379,-749.8115 2135.3957,-733.3874 2154.4665,-716.5993 2168.9689,-704.4875"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2171.4273,-706.9968 2176.9164,-697.9347 2166.9742,-701.5959 2171.4273,-706.9968"/>
</g>
<!-- sourcefile~zoneequipmentmanager.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge19" class="edge">
<title>sourcefile~zoneequipmentmanager.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2026.6428,-815.7656C2098.4501,-797.6975 2250.5575,-763.8115 2381.3591,-763.8115 2381.3591,-763.8115 2381.3591,-763.8115 2584.3418,-763.8115 2729.2272,-763.8115 2754.3551,-680.574 2844.0762,-566.8115 2868.7238,-535.5594 2859.6202,-518.9545 2880.0762,-484.8115 2889.4851,-469.1071 2902.3017,-452.8971 2912.5344,-440.8531"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2915.2293,-443.0877 2919.1322,-433.2379 2909.9387,-438.504 2915.2293,-443.0877"/>
</g>
<!-- sourcefile~airflownetworkbalancemanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge38" class="edge">
<title>sourcefile~airflownetworkbalancemanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1985.0479,-686.8115C2034.2653,-688.8976 2090.1605,-688.7375 2131.2786,-688.1452"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2131.457,-691.6429 2141.4009,-687.9864 2131.3472,-684.6438 2131.457,-691.6429"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1648.474,-651.0749C1706.0561,-654.84 1782.5356,-660.5262 1849.9578,-667.8115 1910.2379,-674.325 1924.4713,-684.2439 1985.0479,-686.8115"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node39" class="node">
<title>sourcefile~systemavailabilitymanager.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node39"><a xlink:href="../sourcefile/systemavailabilitymanager.f90.html" xlink:title="SystemAvailabilityManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1844.5135,-698.8169 1689.901,-698.8169 1689.901,-676.806 1844.5135,-676.806 1844.5135,-698.8169"/>
<text text-anchor="middle" x="1767.2073" y="-684.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SystemAvailabilityManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~airflownetworkbalancemanager.f90&#45;&gt;sourcefile~systemavailabilitymanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge37" class="edge">
<title>sourcefile~airflownetworkbalancemanager.f90&#45;&gt;sourcefile~systemavailabilitymanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1613.9159,-656.8465C1641.1459,-662.347 1674.2542,-669.0349 1702.7237,-674.7857"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1702.088,-678.2279 1712.583,-676.7773 1703.474,-671.3665 1702.088,-678.2279"/>
</g>
<!-- sourcefile~weathermanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge40" class="edge">
<title>sourcefile~weathermanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2929.5656,-380.8115C2952.8234,-392.9691 2980.1167,-401.8906 3004.7238,-408.2468"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3004.1755,-411.7169 3014.7242,-410.7297 3005.8622,-404.9231 3004.1755,-411.7169"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2824.3519,-46.9637C2831.7187,-50.408 2838.6393,-54.9149 2844.0762,-60.8115 2943.8647,-169.0384 2799.1046,-312.6151 2929.5656,-380.8115"/>
</g>
<!-- sourcefile~weathermanager.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge39" class="edge">
<title>sourcefile~weathermanager.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2826.5588,-46.9722C2833.2838,-50.4166 2839.4286,-54.9211 2844.0762,-60.8115 2936.559,-178.0236 2797.088,-270.6958 2880.0762,-394.8115 2882.7572,-398.8211 2886.2399,-402.2876 2890.1164,-405.2714"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2888.2079,-408.2052 2898.4957,-410.7376 2892.0326,-402.3424 2888.2079,-408.2052"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~plantmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge35" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~plantmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1780.5509,-698.9982C1799.2783,-715.5012 1832.965,-748.2787 1849.9578,-783.8115 1888.3575,-864.1074 1855.5038,-897.1781 1885.9578,-980.8115 1907.8261,-1040.8668 1949.3916,-1104.4059 1971.0834,-1135.4503"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1968.2568,-1137.5151 1976.8882,-1143.6592 1973.9722,-1133.4735 1968.2568,-1137.5151"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge33" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1844.6188,-685.6913C1886.2552,-684.996 1938.4766,-684.8375 1985.0479,-686.8115"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge36" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1844.8141,-677.973C1858.5211,-676.2455 1872.6576,-674.4703 1885.9578,-672.8115 2031.5053,-654.6583 2201.1528,-633.8438 2299.406,-621.8228"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2300.0638,-625.2685 2309.5648,-620.5801 2299.2138,-618.3203 2300.0638,-625.2685"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge32" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1827.0721,-698.9538C1835.4042,-702.3992 1843.3575,-706.9089 1849.9578,-712.8115 1880.2343,-739.8874 1855.6891,-769.7266 1885.9578,-796.8115 1893.0161,-803.1274 1901.3672,-808.1143 1910.1797,-812.0517"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1908.9112,-815.3139 1919.4955,-815.7866 1911.5161,-808.8166 1908.9112,-815.3139"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge34" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1830.5084,-698.8537C1856.1283,-703.3228 1885.8581,-708.5089 1912.3587,-713.1316"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1911.8891,-716.6025 1922.3419,-714.8731 1913.0921,-709.7066 1911.8891,-716.6025"/>
</g>
<!-- sourcefile~simairservingzones.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge31" class="edge">
<title>sourcefile~simairservingzones.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2043.2198,-714.792C2070.8607,-709.556 2103.8498,-703.3069 2131.6334,-698.0439"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2132.4406,-701.4533 2141.6144,-696.1532 2131.1377,-694.5757 2132.4406,-701.4533"/>
</g>
<!-- sourcefile~simairservingzones.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge30" class="edge">
<title>sourcefile~simairservingzones.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2047.7229,-726.0023C2104.1892,-725.1139 2189.218,-721.1367 2261.7217,-706.8115 2529.3559,-653.9326 2614.2649,-659.8183 2844.0762,-512.8115 2873.9802,-493.6823 2900.6091,-461.7876 2915.9156,-441.288"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2918.8833,-443.1583 2921.9409,-433.0142 2913.2248,-439.0374 2918.8833,-443.1583"/>
</g>
<!-- sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge65" class="edge">
<title>sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2026.068,-407.7905C2067.3462,-397.5204 2133.0143,-383.4083 2190.9298,-380.8115"/>
</g>
<!-- sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge67" class="edge">
<title>sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3074.7572,-1087.8115C3180.5109,-1012.4489 3211.785,-566.5793 3217.6585,-463.2053"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3221.1619,-463.2377 3218.2146,-453.0611 3214.1724,-462.8545 3221.1619,-463.2377"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2042.1499,-429.8551C2056.6175,-434.2837 2071.5971,-440.4038 2084.1379,-448.8115 2187.9366,-518.4004 2213.0391,-551.7167 2261.7217,-666.8115 2288.4806,-730.0747 2249.8587,-924.5428 2297.7217,-973.8115 2328.1236,-1005.1063 3039.2255,-1113.1322 3074.7572,-1087.8115"/>
</g>
<!-- sourcefile~solarshading.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node44" class="node">
<title>sourcefile~solarshading.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node44"><a xlink:href="../sourcefile/solarshading.f90.html" xlink:title="SolarShading.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2427.42,-508.8169 2335.2983,-508.8169 2335.2983,-486.806 2427.42,-486.806 2427.42,-508.8169"/>
<text text-anchor="middle" x="2381.3591" y="-494.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SolarShading.f90</text>
</a>
</g>
</g>
<!-- sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge66" class="edge">
<title>sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2040.5705,-429.8793C2115.9022,-444.8957 2249.7399,-471.5747 2325.3319,-486.6431"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2324.6595,-490.0779 2335.1508,-488.6004 2326.028,-483.2129 2324.6595,-490.0779"/>
</g>
<!-- sourcefile~windowequivalentlayer.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node45" class="node">
<title>sourcefile~windowequivalentlayer.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node45"><a xlink:href="../sourcefile/windowequivalentlayer.f90.html" xlink:title="WindowEquivalentLayer.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2261.5142,-430.8169 2120.3455,-430.8169 2120.3455,-408.806 2261.5142,-408.806 2261.5142,-430.8169"/>
<text text-anchor="middle" x="2190.9298" y="-416.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WindowEquivalentLayer.f90</text>
</a>
</g>
</g>
<!-- sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~windowequivalentlayer.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge68" class="edge">
<title>sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~windowequivalentlayer.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2046.2618,-419.1088C2066.227,-419.2058 2088.713,-419.315 2109.9004,-419.4179"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2110.1635,-422.9191 2120.1805,-419.4678 2110.1976,-415.9192 2110.1635,-422.9191"/>
</g>
<!-- sourcefile~delightmanagerf.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge69" class="edge">
<title>sourcefile~delightmanagerf.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1822.3016,-378.3807C1866.3624,-377.5814 1929.7036,-377.2046 1985.0479,-379.8115"/>
</g>
<!-- sourcefile~delightmanagerf.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge70" class="edge">
<title>sourcefile~delightmanagerf.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1822.4593,-389.7032C1850.205,-394.6705 1884.145,-400.7468 1913.825,-406.0604"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1913.2517,-409.5134 1923.712,-407.8305 1914.4853,-402.6229 1913.2517,-409.5134"/>
</g>
<!-- sourcefile~roomairmodelmundt.f90&#45;&gt;sourcefile~roomairmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge71" class="edge">
<title>sourcefile~roomairmodelmundt.f90&#45;&gt;sourcefile~roomairmanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1406.8,-628.7707C1416.5077,-631.839 1425.9796,-636.0481 1434.1179,-641.8115 1458.5702,-659.128 1446.0922,-680.9078 1470.1179,-698.8115 1477.2367,-704.1163 1485.4331,-708.2957 1493.9111,-711.5885"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1492.9654,-714.9652 1503.5602,-714.9422 1495.2635,-708.3531 1492.9654,-714.9652"/>
</g>
<!-- sourcefile~solarshading.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge56" class="edge">
<title>sourcefile~solarshading.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2422.1163,-486.7597C2435.8614,-482.7342 2451.2086,-477.9101 2464.9966,-472.8115 2495.2724,-461.6159 2528.7886,-446.4789 2552.5752,-435.248"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2554.2934,-438.3065 2561.819,-430.8489 2551.2853,-431.9858 2554.2934,-438.3065"/>
</g>
<!-- sourcefile~solarshading.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge58" class="edge">
<title>sourcefile~solarshading.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2773.8816,-498.8115C2841.217,-482.8869 2867.4148,-529.2242 2929.5656,-498.8115"/>
</g>
<!-- sourcefile~solarshading.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge57" class="edge">
<title>sourcefile~solarshading.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2773.8816,-498.8115C2812.9907,-489.5623 2819.1786,-473.3579 2844.0762,-441.8115 2866.9829,-412.7875 2848.7816,-386.5031 2880.0762,-366.8115 2976.6692,-306.0319 3027.3946,-362.2958 3134.4595,-401.8115 3151.432,-408.0757 3154.1519,-412.9775 3170.4595,-420.8115 3174.5104,-422.7575 3178.7862,-424.7302 3183.0512,-426.6476"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3181.7182,-429.885 3192.2797,-430.7251 3184.5473,-423.4821 3181.7182,-429.885"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2584.3418,-498.8115C2668.1797,-490.5914 2691.6339,-517.0234 2773.8816,-498.8115"/>
</g>
<!-- sourcefile~solarshading.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge55" class="edge">
<title>sourcefile~solarshading.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2584.3418,-498.8115C2646.3189,-492.7347 2712.3094,-458.863 2747.7438,-438.1198"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2749.6929,-441.0325 2756.4866,-432.9026 2746.1058,-435.0215 2749.6929,-441.0325"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2427.4349,-500.722C2468.6578,-502.688 2530.6812,-504.0728 2584.3418,-498.8115"/>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~windowmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge60" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~windowmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2217.8098,-408.8014C2251.0318,-395.1937 2307.7126,-371.9772 2344.8509,-356.7653"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2346.3811,-359.9208 2354.3082,-352.8915 2343.7278,-353.4431 2346.3811,-359.9208"/>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge64" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2381.3591,-458.8115C2409.6872,-460.3176 2480.4495,-445.0872 2530.4252,-433.219"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2531.5281,-436.5539 2540.4375,-430.8205 2529.8973,-429.7465 2531.5281,-436.5539"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2228.0793,-430.8437C2266.1528,-441.3362 2327.2718,-455.9358 2381.3591,-458.8115"/>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge62" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2381.3591,-458.8115C2494.8538,-464.8456 2626.254,-447.4863 2704.5851,-434.5415"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2705.525,-437.9328 2714.8085,-432.8271 2704.3673,-431.0292 2705.525,-437.9328"/>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge61" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2210.934,-431.0265C2232.0489,-442.5554 2266.528,-460.5124 2297.7217,-472.8115 2307.8685,-476.8121 2318.9203,-480.5392 2329.5663,-483.8304"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2328.6073,-487.1968 2339.1916,-486.7257 2330.6237,-480.4935 2328.6073,-487.1968"/>
</g>
<!-- sourcefile~heatbalanceintradexchange.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node46" class="node">
<title>sourcefile~heatbalanceintradexchange.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node46"><a xlink:href="../sourcefile/heatbalanceintradexchange.f90.html" xlink:title="HeatBalanceIntRadExchange.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2465.1343,-430.8169 2297.584,-430.8169 2297.584,-408.806 2465.1343,-408.806 2465.1343,-430.8169"/>
<text text-anchor="middle" x="2381.3591" y="-416.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceIntRadExchange.f90</text>
</a>
</g>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalanceintradexchange.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge63" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalanceintradexchange.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2261.568,-419.8115C2270.0127,-419.8115 2278.7343,-419.8115 2287.4414,-419.8115"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2287.6387,-423.3116 2297.6387,-419.8115 2287.6386,-416.3116 2287.6387,-423.3116"/>
</g>
<!-- sourcefile~heatbalanceintradexchange.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge59" class="edge">
<title>sourcefile~heatbalanceintradexchange.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2465.0919,-419.8115C2473.6475,-419.8115 2482.377,-419.8115 2491.0267,-419.8115"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2491.129,-423.3116 2501.1289,-419.8115 2491.1289,-416.3116 2491.129,-423.3116"/>
</g>
<!-- sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge95" class="edge">
<title>sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1833.5145,-1047.7065C1903.8559,-1049.223 2014.2756,-1040.5913 2084.1379,-980.8115 2168.8841,-908.2959 2186.3869,-762.893 2189.9952,-708.2369"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2193.5033,-708.1918 2190.5735,-698.0101 2186.5144,-707.7965 2193.5033,-708.1918"/>
</g>
<!-- sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge94" class="edge">
<title>sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1833.619,-1031.9226C1839.5152,-1029.2408 1845.0854,-1025.92 1849.9578,-1021.8115 1880.0751,-996.4157 1864.8022,-974.0446 1885.9578,-940.8115 1909.5363,-903.772 1944.6609,-866.4166 1966.1415,-845.0034"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1968.7209,-847.3756 1973.3915,-837.8658 1963.8099,-842.3874 1968.7209,-847.3756"/>
</g>
<!-- sourcefile~systemreports.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node54" class="node">
<title>sourcefile~systemreports.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node54"><a xlink:href="../sourcefile/systemreports.f90.html" xlink:title="SystemReports.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2035.8341,-971.8169 1934.2616,-971.8169 1934.2616,-949.806 2035.8341,-949.806 2035.8341,-971.8169"/>
<text text-anchor="middle" x="1985.0479" y="-957.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SystemReports.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~systemreports.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge93" class="edge">
<title>sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~systemreports.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1816.6375,-1031.7789C1827.7113,-1028.8902 1839.3243,-1025.5291 1849.9578,-1021.8115 1860.1595,-1018.2448 1915.1427,-993.0922 1951.7429,-976.2191"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1953.456,-979.2833 1961.0694,-971.9153 1950.523,-972.9273 1953.456,-979.2833"/>
</g>
<!-- sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge99" class="edge">
<title>sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M2381.3591,-959.8115C2621.5333,-914.7214 2679.882,-843.8005 2844.0762,-662.8115 2899.3053,-601.9331 2855.9591,-535.3972 2929.5656,-498.8115"/>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M1613.7382,-852.8517C1635.6767,-856.7742 1661.2395,-861.19 1684.4568,-864.8115 1694.1088,-866.317 2371.7319,-961.4683 2381.3591,-959.8115"/>
</g>
<!-- sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge97" class="edge">
<title>sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M1613.7749,-832.0409C1625.6443,-828.4795 1637.8232,-823.8308 1648.4568,-817.8115 1667.6091,-806.9701 1665.0516,-794.1935 1684.4568,-783.8115 1717.7291,-766.0103 1730.0907,-771.6149 1767.2073,-764.8115"/>
</g>
<!-- sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node55" class="node">
<title>sourcefile~hvacfurnace.f90</title>
<g id="a_sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_node55"><a xlink:href="../sourcefile/hvacfurnace.f90.html" xlink:title="HVACFurnace.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1815.6389,-814.8169 1718.7756,-814.8169 1718.7756,-792.806 1815.6389,-792.806 1815.6389,-814.8169"/>
<text text-anchor="middle" x="1767.2073" y="-800.6615" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACFurnace.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge98" class="edge">
<title>sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M1613.6443,-832.6156C1642.9398,-827.1206 1679.0995,-820.338 1708.97,-814.7352"/>
<polygon fill="#ffda00" stroke="#ffda00" points="1709.6566,-818.1675 1718.8399,-812.8838 1708.3661,-811.2875 1709.6566,-818.1675"/>
</g>
<!-- sourcefile~packagedterminalheatpump.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge101" class="edge">
<title>sourcefile~packagedterminalheatpump.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M1785.4056,-949.6172C1823.8635,-925.9606 1913.5427,-870.7963 1958.4435,-843.1766"/>
<polygon fill="#48ff00" stroke="#48ff00" points="1960.3708,-846.1002 1967.0546,-837.8797 1956.7032,-840.1379 1960.3708,-846.1002"/>
</g>
<!-- sourcefile~packagedterminalheatpump.f90&#45;&gt;sourcefile~systemreports.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge100" class="edge">
<title>sourcefile~packagedterminalheatpump.f90&#45;&gt;sourcefile~systemreports.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M1849.8741,-960.8115C1874.507,-960.8115 1901.0448,-960.8115 1924.029,-960.8115"/>
<polygon fill="#48ff00" stroke="#48ff00" points="1924.3197,-964.3116 1934.3196,-960.8115 1924.3196,-957.3116 1924.3197,-964.3116"/>
</g>
<!-- sourcefile~hvacvariablerefrigerantflow.f90&#45;&gt;sourcefile~plantloopequipment.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge103" class="edge">
<title>sourcefile~hvacvariablerefrigerantflow.f90&#45;&gt;sourcefile~plantloopequipment.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M1354.6101,-992.9109C1390.4761,-1025.3114 1495.2739,-1119.9832 1539.3697,-1159.8183"/>
<polygon fill="#00ff91" stroke="#00ff91" points="1537.0999,-1162.4845 1546.8666,-1166.5909 1541.7924,-1157.2902 1537.0999,-1162.4845"/>
</g>
<!-- sourcefile~hvacvariablerefrigerantflow.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge102" class="edge">
<title>sourcefile~hvacvariablerefrigerantflow.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M1394.0413,-970.7455C1486.0599,-950.8666 1684.1338,-907.218 1849.9578,-864.8115 1879.2347,-857.3244 1911.8543,-848.1719 1937.7045,-840.7254"/>
<polygon fill="#00ff91" stroke="#00ff91" points="1938.9837,-843.999 1947.6174,-837.8581 1937.0386,-837.2746 1938.9837,-843.999"/>
</g>
<!-- sourcefile~hvacunitarybypassvav.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge104" class="edge">
<title>sourcefile~hvacunitarybypassvav.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M1631.5547,-771.1789C1671.808,-773.1387 1722.6477,-772.9792 1767.2073,-764.8115"/>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M1767.2073,-764.8115C1815.6635,-755.9295 1870.228,-746.1612 1912.6262,-738.6225"/>
<polygon fill="#0091ff" stroke="#0091ff" points="1913.3458,-742.0496 1922.5792,-736.854 1912.1211,-735.1575 1913.3458,-742.0496"/>
</g>
<!-- sourcefile~fancoilunits.f90&#45;&gt;sourcefile~generalroutines.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge107" class="edge">
<title>sourcefile~fancoilunits.f90&#45;&gt;sourcefile~generalroutines.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M1811.9156,-835.1385C1824.3776,-831.9924 1837.822,-828.1707 1849.9578,-823.8115 1866.6103,-817.8298 1869.4455,-813.1701 1885.9578,-806.8115 1901.2309,-800.93 1918.1752,-795.4372 1933.6695,-790.8005"/>
<polygon fill="#4800ff" stroke="#4800ff" points="1935.0012,-794.0573 1943.6101,-787.8817 1933.029,-787.3408 1935.0012,-794.0573"/>
</g>
<!-- sourcefile~fancoilunits.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge106" class="edge">
<title>sourcefile~fancoilunits.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M1812.0798,-841.1037C1838.2647,-838.94 1872.1089,-836.1435 1902.9075,-833.5987"/>
<polygon fill="#4800ff" stroke="#4800ff" points="1903.5422,-837.0582 1913.22,-832.7465 1902.9657,-830.082 1903.5422,-837.0582"/>
</g>
<!-- sourcefile~fancoilunits.f90&#45;&gt;sourcefile~systemreports.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge105" class="edge">
<title>sourcefile~fancoilunits.f90&#45;&gt;sourcefile~systemreports.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M1788.0947,-855.934C1826.968,-876.634 1910.5246,-921.1278 1955.29,-944.9654"/>
<polygon fill="#4800ff" stroke="#4800ff" points="1953.752,-948.1117 1964.2236,-949.7226 1957.0421,-941.9331 1953.752,-948.1117"/>
</g>
<!-- sourcefile~windowac.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge109" class="edge">
<title>sourcefile~windowac.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1808.2847,-996.4529C1822.235,-993.3536 1837.4453,-988.4764 1849.9578,-980.8115 1851.8463,-979.6546 1932.6476,-886.9881 1968.3653,-845.9759"/>
<polygon fill="#ff00da" stroke="#ff00da" points="1971.1376,-848.1219 1975.065,-838.2818 1965.8585,-843.525 1971.1376,-848.1219"/>
</g>
<!-- sourcefile~windowac.f90&#45;&gt;sourcefile~systemreports.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge108" class="edge">
<title>sourcefile~windowac.f90&#45;&gt;sourcefile~systemreports.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1808.1814,-994.0997C1840.8518,-987.9507 1887.1015,-979.2461 1924.1124,-972.2802"/>
<polygon fill="#ff00da" stroke="#ff00da" points="1925.1074,-975.6545 1934.2875,-970.3651 1923.8126,-968.7752 1925.1074,-975.6545"/>
</g>
<!-- sourcefile~systemreports.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge90" class="edge">
<title>sourcefile~systemreports.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2036.101,-956.4026C2077.9386,-953.7851 2138.5688,-952.2729 2190.9298,-959.8115"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2190.9298,-959.8115C2274.7013,-971.8722 2298.1771,-975.428 2381.3591,-959.8115"/>
</g>
<!-- sourcefile~systemreports.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge91" class="edge">
<title>sourcefile~systemreports.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2584.3418,-1111.8115C2802.3275,-1121.9914 2909.2806,-1230.0749 3074.7572,-1087.8115"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2190.9298,-959.8115C2242.6177,-967.2531 2249.6318,-988.4553 2297.7217,-1008.8115 2386.9816,-1046.5947 2409.1596,-1056.8137 2500.9966,-1087.8115 2537.5197,-1100.1391 2546.1083,-1106.9013 2584.3418,-1111.8115"/>
</g>
<!-- sourcefile~systemreports.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge92" class="edge">
<title>sourcefile~systemreports.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1995.6771,-949.568C2014.3857,-929.5686 2054.0632,-886.2055 2084.1379,-846.8115 2121.2366,-798.217 2159.8857,-737.305 2178.8975,-706.5406"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2181.8876,-708.3597 2184.1438,-698.0079 2175.9246,-704.6934 2181.8876,-708.3597"/>
</g>
<!-- sourcefile~hvacfurnace.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~heatbalanceconvectioncoeffs.f90~~AfferentGraph_edge96" class="edge">
<title>sourcefile~hvacfurnace.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1811.3438,-792.7437C1824.0511,-788.9544 1837.7671,-784.2697 1849.9578,-778.8115 1867.0718,-771.1489 1868.8815,-764.5579 1885.9578,-756.8115 1900.5007,-750.2142 1916.8453,-744.4705 1932.0029,-739.7797"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1933.1896,-743.0778 1941.7613,-736.8508 1931.1772,-736.3733 1933.1896,-743.0778"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefileheatbalanceconvectioncoeffsf90AfferentGraph = svgPanZoom('#sourcefileheatbalanceconvectioncoeffsf90AfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <br>

    <section class="visible-xs visible-sm hidden-md">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/convectioncoefficients.html">ConvectionCoefficients</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html#src">HeatBalanceConvectionCoeffs.f90</a>
  </div>
</div>


    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">MODULE </span><span class="n">ConvectionCoefficients</span>
<a name="ln-2"></a>
<a name="ln-3"></a>  <span class="c">! Module containing the routines dealing with the convection coefficients</span>
<a name="ln-4"></a>
<a name="ln-5"></a>  <span class="c">! MODULE INFORMATION:</span>
<a name="ln-6"></a>  <span class="c">!       AUTHOR         Rick Strand</span>
<a name="ln-7"></a>  <span class="c">!       DATE WRITTEN   August 2000</span>
<a name="ln-8"></a>  <span class="c">!       MODIFIED       Brent Griffith, August 2010 expanded model choices</span>
<a name="ln-9"></a>  <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10"></a>
<a name="ln-11"></a>  <span class="c">! PURPOSE OF THIS MODULE:</span>
<a name="ln-12"></a>  <span class="c">! This module contain the routines dealing with convection coefficients.</span>
<a name="ln-13"></a>  <span class="c">! This module collects correlations/calculations for both the interior and exterior</span>
<a name="ln-14"></a>  <span class="c">! Manages a portion of the input and calculations for Hc values for use in surface heat balances</span>
<a name="ln-15"></a>  <span class="c">! .</span>
<a name="ln-16"></a>
<a name="ln-17"></a>  <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-18"></a>  <span class="c">!</span>
<a name="ln-19"></a>  <span class="c">! Subroutines are called to fill the variable HConvIn with the convection coefficient at</span>
<a name="ln-20"></a>  <span class="c">! the inside face.  or outside face for the current surface.</span>
<a name="ln-21"></a>
<a name="ln-22"></a>  <span class="c">! REFERENCES:</span>
<a name="ln-23"></a>
<a name="ln-24"></a>
<a name="ln-25"></a>  <span class="c">! OTHER NOTES: none</span>
<a name="ln-26"></a>
<a name="ln-27"></a>  <span class="c">! USE STATEMENTS:</span>
<a name="ln-28"></a><span class="k">USE </span><span class="n">DataPrecisionGlobals</span>
<a name="ln-29"></a><span class="k">USE </span><span class="n">DataGlobals</span>
<a name="ln-30"></a><span class="k">USE </span><span class="n">DataLoopNode</span>
<a name="ln-31"></a><span class="k">USE </span><span class="n">DataHeatBalance</span>
<a name="ln-32"></a><span class="k">USE </span><span class="n">DataSurfaces</span>
<a name="ln-33"></a><span class="k">USE </span><span class="n">DataInterfaces</span>
<a name="ln-34"></a><span class="k">USE </span><span class="n">DataVectorTypes</span>
<a name="ln-35"></a><span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-36"></a>
<a name="ln-37"></a><span class="k">IMPLICIT NONE</span>         <span class="c">! Enforce explicit typing of all variables</span>
<a name="ln-38"></a>
<a name="ln-39"></a><span class="k">PRIVATE</span> <span class="c">! Everything private unless explicitly made public</span>
<a name="ln-40"></a>
<a name="ln-41"></a>  <span class="c">! MODULE PARAMETER DEFINITIONS:</span>
<a name="ln-42"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">AdaptiveHcInsideLowLimit</span>  <span class="o">=</span> <span class="mf">0.5d0</span> <span class="c">! W/m2-K</span>
<a name="ln-43"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">AdaptiveHcOutsideLowLimit</span> <span class="o">=</span> <span class="mf">1.d0</span> <span class="c">! W/m2-K</span>
<a name="ln-44"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">fmtx</span><span class="o">=</span><span class="s1">&#39;(A,I4,1x,A,1x,6f16.8)&#39;</span>
<a name="ln-45"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">fmty</span><span class="o">=</span><span class="s1">&#39;(A,1x,6f16.8)&#39;</span>
<a name="ln-46"></a>
<a name="ln-47"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">MinFlow</span> <span class="o">=</span> <span class="mf">0.01d0</span>      <span class="c">! Minimum mass flow rate</span>
<a name="ln-48"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">MaxACH</span> <span class="o">=</span> <span class="mi">10</span><span class="mf">0.0d0</span>      <span class="c">! Maximum ceiling diffuser correlation limit</span>
<a name="ln-49"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Blank</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
<a name="ln-50"></a>
<a name="ln-51"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">OneThird</span>  <span class="o">=</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">/</span><span class="mf">3.d0</span><span class="p">)</span>  <span class="c">! 1/3 in highest precision</span>
<a name="ln-52"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">OneFourth</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">/</span><span class="mf">4.d0</span><span class="p">)</span>  <span class="c">! 1/4 in highest precision</span>
<a name="ln-53"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">OneFifth</span>  <span class="o">=</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">/</span><span class="mf">5.d0</span><span class="p">)</span>  <span class="c">! 1/5 in highest precision</span>
<a name="ln-54"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">OneSixth</span>  <span class="o">=</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">/</span><span class="mf">6.d0</span><span class="p">)</span>  <span class="c">! 1/6 in highest precision</span>
<a name="ln-55"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">FourFifths</span> <span class="o">=</span> <span class="p">(</span><span class="mf">4.d0</span><span class="o">/</span><span class="mf">5.d0</span><span class="p">)</span> <span class="c">! 4/5 in highest precision</span>
<a name="ln-56"></a>
<a name="ln-57"></a>
<a name="ln-58"></a><span class="c">! Coefficients that modify the convection coeff based on surface roughness</span>
<a name="ln-59"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RoughnessMultiplier</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span> <span class="mf">2.17d0</span><span class="p">,</span> <span class="mf">1.67d0</span><span class="p">,</span> <span class="mf">1.52d0</span><span class="p">,</span> <span class="mf">1.13d0</span><span class="p">,</span> <span class="mf">1.11d0</span><span class="p">,</span> <span class="mf">1.0d0</span> <span class="o">/</span><span class="p">)</span>
<a name="ln-60"></a>
<a name="ln-61"></a><span class="c">! parameters for identifying more specific hc model equations, inside face</span>
<a name="ln-62"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcInt_UserValue</span>                               <span class="o">=</span> <span class="mi">200</span>
<a name="ln-63"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcInt_UserSchedule</span>                            <span class="o">=</span> <span class="mi">201</span>
<a name="ln-64"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcInt_UserCurve</span>                               <span class="o">=</span> <span class="mi">202</span>
<a name="ln-65"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcInt_ASHRAEVerticalWall</span>                      <span class="o">=</span> <span class="mi">203</span>
<a name="ln-66"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcInt_WaltonUnstableHorizontalOrTilt</span>          <span class="o">=</span> <span class="mi">204</span>
<a name="ln-67"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcInt_WaltonStableHorizontalOrTilt</span>            <span class="o">=</span> <span class="mi">205</span>
<a name="ln-68"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcInt_FisherPedersenCeilDiffuserFloor</span>         <span class="o">=</span> <span class="mi">206</span>
<a name="ln-69"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcInt_FisherPedersenCeilDiffuserCeiling</span>       <span class="o">=</span> <span class="mi">207</span>
<a name="ln-70"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcInt_FisherPedersenCeilDiffuserWalls</span>         <span class="o">=</span> <span class="mi">208</span>
<a name="ln-71"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcInt_AlamdariHammondStableHorizontal</span>         <span class="o">=</span> <span class="mi">209</span>
<a name="ln-72"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcInt_AlamdariHammondVerticalWall</span>             <span class="o">=</span> <span class="mi">210</span>
<a name="ln-73"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcInt_AlamdariHammondUnstableHorizontal</span>       <span class="o">=</span> <span class="mi">211</span>
<a name="ln-74"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcInt_KhalifaEq3WallAwayFromHeat</span>              <span class="o">=</span> <span class="mi">212</span>
<a name="ln-75"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcInt_KhalifaEq4CeilingAwayFromHeat</span>           <span class="o">=</span> <span class="mi">213</span>
<a name="ln-76"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcInt_KhalifaEq5WallNearHeat</span>                  <span class="o">=</span> <span class="mi">214</span>
<a name="ln-77"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcInt_KhalifaEq6NonHeatedWalls</span>                <span class="o">=</span> <span class="mi">215</span>
<a name="ln-78"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcInt_KhalifaEq7Ceiling</span>                       <span class="o">=</span> <span class="mi">216</span>
<a name="ln-79"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcInt_AwbiHattonHeatedFloor</span>                   <span class="o">=</span> <span class="mi">217</span>
<a name="ln-80"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcInt_AwbiHattonHeatedWall</span>                    <span class="o">=</span> <span class="mi">218</span>
<a name="ln-81"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcInt_BeausoleilMorrisonMixedAssistingWall</span>    <span class="o">=</span> <span class="mi">219</span>
<a name="ln-82"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcInt_BeausoleilMorrisonMixedOppossingWall</span>    <span class="o">=</span> <span class="mi">220</span>
<a name="ln-83"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcInt_BeausoleilMorrisonMixedStableCeiling</span>    <span class="o">=</span> <span class="mi">221</span>
<a name="ln-84"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcInt_BeausoleilMorrisonMixedUnstableCeiling</span>  <span class="o">=</span> <span class="mi">222</span>
<a name="ln-85"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcInt_BeausoleilMorrisonMixedStableFloor</span>      <span class="o">=</span> <span class="mi">223</span>
<a name="ln-86"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcInt_BeausoleilMorrisonMixedUnstableFloor</span>    <span class="o">=</span> <span class="mi">224</span>
<a name="ln-87"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcInt_FohannoPolidoriVerticalWall</span>             <span class="o">=</span> <span class="mi">225</span>
<a name="ln-88"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcInt_KaradagChilledCeiling</span>                   <span class="o">=</span> <span class="mi">226</span>
<a name="ln-89"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcInt_ISO15099Windows</span>                         <span class="o">=</span> <span class="mi">227</span>
<a name="ln-90"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcInt_GoldsteinNovoselacCeilingDiffuserWindow</span> <span class="o">=</span> <span class="mi">228</span>
<a name="ln-91"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcInt_GoldsteinNovoselacCeilingDiffuserWalls</span>  <span class="o">=</span> <span class="mi">229</span>
<a name="ln-92"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcInt_GoldsteinNovoselacCeilingDiffuserFloor</span>  <span class="o">=</span> <span class="mi">230</span>
<a name="ln-93"></a>
<a name="ln-94"></a><span class="c">!parameters for identifying more specific hc model equations, outside face</span>
<a name="ln-95"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcExt_None</span>                                    <span class="o">=</span> <span class="mi">300</span> <span class="c">!none is allowed because Hn and Hf are split</span>
<a name="ln-96"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcExt_UserValue</span>                               <span class="o">=</span> <span class="mi">301</span>
<a name="ln-97"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcExt_UserSchedule</span>                            <span class="o">=</span> <span class="mi">302</span>
<a name="ln-98"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcExt_UserCurve</span>                               <span class="o">=</span> <span class="mi">303</span>
<a name="ln-99"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcExt_ASHRAESimpleCombined</span>                    <span class="o">=</span> <span class="mi">304</span>
<a name="ln-100"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcExt_NaturalASHRAEVerticalWall</span>               <span class="o">=</span> <span class="mi">305</span>
<a name="ln-101"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcExt_NaturalWaltonUnstableHorizontalOrTilt</span>   <span class="o">=</span> <span class="mi">306</span>
<a name="ln-102"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcExt_NaturalWaltonStableHorizontalOrTilt</span>     <span class="o">=</span> <span class="mi">307</span>
<a name="ln-103"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcExt_SparrowWindward</span>                         <span class="o">=</span> <span class="mi">308</span>
<a name="ln-104"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcExt_SparrowLeeward</span>                          <span class="o">=</span> <span class="mi">309</span>
<a name="ln-105"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcExt_MoWiTTWindward</span>                          <span class="o">=</span> <span class="mi">310</span>
<a name="ln-106"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcExt_MoWiTTLeeward</span>                           <span class="o">=</span> <span class="mi">311</span>
<a name="ln-107"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcExt_DOE2Windward</span>                            <span class="o">=</span> <span class="mi">312</span>
<a name="ln-108"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcExt_DOE2Leeward</span>                             <span class="o">=</span> <span class="mi">313</span>
<a name="ln-109"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcExt_NusseltJurges</span>                           <span class="o">=</span> <span class="mi">314</span>
<a name="ln-110"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcExt_McAdams</span>                                 <span class="o">=</span> <span class="mi">315</span>
<a name="ln-111"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcExt_Mitchell</span>                                <span class="o">=</span> <span class="mi">316</span>
<a name="ln-112"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcExt_ClearRoof</span>                               <span class="o">=</span> <span class="mi">317</span>
<a name="ln-113"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcExt_BlockenWindward</span>                         <span class="o">=</span> <span class="mi">318</span>
<a name="ln-114"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcExt_EmmelVertical</span>                           <span class="o">=</span> <span class="mi">319</span>
<a name="ln-115"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcExt_EmmelRoof</span>                               <span class="o">=</span> <span class="mi">320</span>
<a name="ln-116"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcExt_AlamdariHammondVerticalWall</span>             <span class="o">=</span> <span class="mi">321</span>
<a name="ln-117"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcExt_FohannoPolidoriVerticalWall</span>             <span class="o">=</span> <span class="mi">322</span>
<a name="ln-118"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcExt_ISO15099Windows</span>                         <span class="o">=</span> <span class="mi">323</span>
<a name="ln-119"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcExt_AlamdariHammondStableHorizontal</span>         <span class="o">=</span> <span class="mi">324</span>
<a name="ln-120"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HcExt_AlamdariHammondUnstableHorizontal</span>       <span class="o">=</span> <span class="mi">325</span>
<a name="ln-121"></a>
<a name="ln-122"></a><span class="c">!parameters, by zone, for flow regimes for adaptive convection on inside face</span>
<a name="ln-123"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">InConvFlowRegime_A1</span> <span class="o">=</span> <span class="mi">1</span> <span class="c">! In-floor heating or in-ceiling cooling</span>
<a name="ln-124"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">InConvFlowRegime_A2</span> <span class="o">=</span> <span class="mi">2</span> <span class="c">! In-wall heating</span>
<a name="ln-125"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">InConvFlowRegime_A3</span> <span class="o">=</span> <span class="mi">3</span> <span class="c">! no HVAC system, all bouyancy</span>
<a name="ln-126"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">InConvFlowRegime_B</span>  <span class="o">=</span> <span class="mi">4</span> <span class="c">! Convective heater in zone</span>
<a name="ln-127"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">InConvFlowRegime_C</span>  <span class="o">=</span> <span class="mi">5</span> <span class="c">! central mechanical air</span>
<a name="ln-128"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">InConvFlowRegime_D</span>  <span class="o">=</span> <span class="mi">6</span> <span class="c">! zone mechanical air</span>
<a name="ln-129"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">InConvFlowRegime_E</span>  <span class="o">=</span> <span class="mi">7</span> <span class="c">! mixed. mechancial air and bouyancy</span>
<a name="ln-130"></a>
<a name="ln-131"></a><span class="c">!params for reference temperature type</span>
<a name="ln-132"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RefTempMeanAirTemp</span>     <span class="o">=</span> <span class="mi">1</span>
<a name="ln-133"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RefTempAdjacentAirTemp</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-134"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RefTempSupplyAirTemp</span>   <span class="o">=</span> <span class="mi">3</span>
<a name="ln-135"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RefTempOutDryblubAtZ</span>   <span class="o">=</span> <span class="mi">4</span>
<a name="ln-136"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RefTempOutDrybulbEPW</span>   <span class="o">=</span> <span class="mi">5</span>
<a name="ln-137"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RefTempOutWetbulbAtZ</span>   <span class="o">=</span> <span class="mi">6</span>
<a name="ln-138"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RefTempOutWetbulbEPW</span>   <span class="o">=</span> <span class="mi">7</span>
<a name="ln-139"></a>
<a name="ln-140"></a><span class="c">!params for wind speed type</span>
<a name="ln-141"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RefWindWeatherFile</span>     <span class="o">=</span> <span class="mi">1</span>
<a name="ln-142"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RefWindAtZ</span>             <span class="o">=</span> <span class="mi">2</span>
<a name="ln-143"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RefWindParallComp</span>      <span class="o">=</span> <span class="mi">3</span>
<a name="ln-144"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RefWindParallCompAtZ</span>   <span class="o">=</span> <span class="mi">4</span>
<a name="ln-145"></a>
<a name="ln-146"></a>  <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-147"></a>  <span class="c">! na</span>
<a name="ln-148"></a>
<a name="ln-149"></a>  <span class="c">! MODULE VARIABLE DECLARATIONS:</span>
<a name="ln-150"></a>
<a name="ln-151"></a>  <span class="k">TYPE </span><span class="n">HcInsideFaceUserCurveStruct</span>
<a name="ln-152"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Name</span>     <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="c">! user&#39;s name for object</span>
<a name="ln-153"></a>
<a name="ln-154"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ReferenceTempType</span>             <span class="o">=</span> <span class="mi">0</span> <span class="c">!</span>
<a name="ln-155"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HcFnTempDiffCurveNum</span>          <span class="o">=</span> <span class="mi">0</span> <span class="c">!</span>
<a name="ln-156"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HcFnTempDiffDivHeightCurveNum</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">!</span>
<a name="ln-157"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HcFnACHCurveNum</span>               <span class="o">=</span> <span class="mi">0</span> <span class="c">!</span>
<a name="ln-158"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HcFnACHDivPerimLengthCurveNum</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">!</span>
<a name="ln-159"></a>  <span class="n">ENDTYPE</span> <span class="n">HcInsideFaceUserCurveStruct</span>
<a name="ln-160"></a>
<a name="ln-161"></a>  <span class="k">TYPE </span><span class="n">HcOutsideFaceUserCurveStruct</span>
<a name="ln-162"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Name</span>     <span class="o">=</span> <span class="s1">&#39; &#39;</span>
<a name="ln-163"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ReferenceTempType</span>             <span class="o">=</span> <span class="mi">0</span>
<a name="ln-164"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">SuppressRainChange</span>            <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-165"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WindSpeedType</span>                 <span class="o">=</span> <span class="mi">0</span>
<a name="ln-166"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HfFnWindSpeedCurveNum</span>         <span class="o">=</span> <span class="mi">0</span>
<a name="ln-167"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HnFnTempDiffCurveNum</span>          <span class="o">=</span> <span class="mi">0</span>
<a name="ln-168"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HnFnTempDiffDivHeightCurveNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-169"></a>  <span class="n">ENDTYPE</span> <span class="n">HcOutsideFaceUserCurveStruct</span>
<a name="ln-170"></a>
<a name="ln-171"></a>  <span class="k">TYPE </span><span class="n">InsideFaceAdaptiveConvAlgoStruct</span>
<a name="ln-172"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">EnteredByUser</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>  <span class="c">!</span>
<a name="ln-173"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Name</span>                      <span class="o">=</span> <span class="s1">&#39; &#39;</span>
<a name="ln-174"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SimpleBouyVertWallEqNum</span>                        <span class="o">=</span> <span class="n">HcInt_FohannoPolidoriVerticalWall</span> <span class="c">! InConvClass_A3_VertWalls</span>
<a name="ln-175"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SimpleBouyVertWallUserCurveNum</span>                 <span class="o">=</span> <span class="mi">0</span> <span class="c">!</span>
<a name="ln-176"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SimpleBouyStableHorizEqNum</span>                     <span class="o">=</span> <span class="n">HcInt_AlamdariHammondStableHorizontal</span> <span class="c">!InConvClass_A3_StableHoriz</span>
<a name="ln-177"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SimpleBouyStableHorizUserCurveNum</span>              <span class="o">=</span> <span class="mi">0</span>
<a name="ln-178"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SimpleBouyUnstableHorizEqNum</span>                   <span class="o">=</span> <span class="n">HcInt_AlamdariHammondUnstableHorizontal</span> <span class="c">!InConvClass_A3_UnstableHoriz</span>
<a name="ln-179"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SimpleBouyUnstableHorizUserCurveNum</span>            <span class="o">=</span> <span class="mi">0</span> <span class="c">!</span>
<a name="ln-180"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SimpleBouyStableTiltedEqNum</span>                    <span class="o">=</span> <span class="n">HcInt_WaltonStableHorizontalOrTilt</span> <span class="c">!InConvClass_A3_StableTilted</span>
<a name="ln-181"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SimpleBouyStableTiltedUserCurveNum</span>             <span class="o">=</span> <span class="mi">0</span>
<a name="ln-182"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SimpleBouyUnstableTiltedEqNum</span>                  <span class="o">=</span> <span class="n">HcInt_WaltonUnstableHorizontalOrTilt</span> <span class="c">!InConvClass_A3_UnstableTilted</span>
<a name="ln-183"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SimpleBouyUnstableTiltedUserCurveNum</span>           <span class="o">=</span> <span class="mi">0</span> <span class="c">!</span>
<a name="ln-184"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SimpleBouyWindowsEqNum</span>                         <span class="o">=</span> <span class="n">HcInt_ISO15099Windows</span>  <span class="c">!InConvClass_A3_Windows</span>
<a name="ln-185"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SimpleBouyWindowsUserCurveNum</span>                  <span class="o">=</span> <span class="mi">0</span>
<a name="ln-186"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">FloorHeatCeilingCoolVertWallEqNum</span>              <span class="o">=</span> <span class="n">HcInt_KhalifaEq3WallAwayFromHeat</span> <span class="c">!InConvClass_A1_VertWalls</span>
<a name="ln-187"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">FloorHeatCeilingCoolVertWallUserCurveNum</span>       <span class="o">=</span> <span class="mi">0</span> <span class="c">!</span>
<a name="ln-188"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">FloorHeatCeilingCoolStableHorizEqNum</span>           <span class="o">=</span> <span class="n">HcInt_AlamdariHammondStableHorizontal</span> <span class="c">!InConvClass_A1_StableHoriz</span>
<a name="ln-189"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">FloorHeatCeilingCoolStableHorizUserCurveNum</span>    <span class="o">=</span> <span class="mi">0</span>
<a name="ln-190"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">FloorHeatCeilingCoolUnstableHorizEqNum</span>         <span class="o">=</span> <span class="n">HcInt_KhalifaEq4CeilingAwayFromHeat</span> <span class="c">!InConvClass_A1_UntableHoriz</span>
<a name="ln-191"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">FloorHeatCeilingCoolUnstableHorizUserCurveNum</span>  <span class="o">=</span> <span class="mi">0</span>
<a name="ln-192"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">FloorHeatCeilingCoolHeatedFloorEqNum</span>           <span class="o">=</span> <span class="n">HcInt_AwbiHattonHeatedFloor</span>  <span class="c">!InConvClass_A1_HeatedFloor</span>
<a name="ln-193"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">FloorHeatCeilingCoolHeatedFloorUserCurveNum</span>    <span class="o">=</span> <span class="mi">0</span>
<a name="ln-194"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">FloorHeatCeilingCoolChilledCeilingEqNum</span>        <span class="o">=</span> <span class="n">HcInt_KaradagChilledCeiling</span> <span class="c">!InConvClass_A1_ChilledCeil</span>
<a name="ln-195"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">FloorHeatCeilingCoolChilledCeilingUserCurveNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-196"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">FloorHeatCeilingCoolStableTiltedEqNum</span>          <span class="o">=</span> <span class="n">HcInt_WaltonStableHorizontalOrTilt</span> <span class="c">!InConvClass_A1_StableTilted</span>
<a name="ln-197"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">FloorHeatCeilingCoolStableTiltedUserCurveNum</span>   <span class="o">=</span> <span class="mi">0</span>
<a name="ln-198"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">FloorHeatCeilingCoolUnstableTiltedEqNum</span>        <span class="o">=</span> <span class="n">HcInt_WaltonUnstableHorizontalOrTilt</span> <span class="c">!InConvClass_A1_UnstableTilted</span>
<a name="ln-199"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">FloorHeatCeilingCoolUnstableTiltedUserCurveNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-200"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">FloorHeatCeilingCoolWindowsEqNum</span>               <span class="o">=</span> <span class="n">HcInt_ISO15099Windows</span> <span class="c">!InConvClass_A1_Windows</span>
<a name="ln-201"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">FloorHeatCeilingCoolWindowsUserCurveNum</span>        <span class="o">=</span> <span class="mi">0</span>
<a name="ln-202"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WallPanelHeatVertWallEqNum</span>                     <span class="o">=</span> <span class="n">HcInt_KhalifaEq6NonHeatedWalls</span> <span class="c">!InConvClass_A2_VertWallsNonHeated</span>
<a name="ln-203"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WallPanelHeatVertWallUserCurveNum</span>              <span class="o">=</span> <span class="mi">0</span>
<a name="ln-204"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WallPanelHeatHeatedWallEqNum</span>                   <span class="o">=</span> <span class="n">HcInt_AwbiHattonHeatedWall</span> <span class="c">!InConvClass_A2_HeatedVerticalWall</span>
<a name="ln-205"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WallPanelHeatHeatedWallUserCurveNum</span>            <span class="o">=</span> <span class="mi">0</span>
<a name="ln-206"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WallPanelHeatStableHorizEqNum</span>                  <span class="o">=</span> <span class="n">HcInt_AlamdariHammondStableHorizontal</span> <span class="c">!InConvClass_A2_StableHoriz</span>
<a name="ln-207"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WallPanelHeatStableHorizUserCurveNum</span>           <span class="o">=</span> <span class="mi">0</span>
<a name="ln-208"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WallPanelHeatUnstableHorizEqNum</span>                <span class="o">=</span> <span class="n">HcInt_KhalifaEq7Ceiling</span> <span class="c">!InConvClass_A2_UnstableHoriz</span>
<a name="ln-209"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WallPanelHeatUnstableHorizUserCurveNum</span>         <span class="o">=</span> <span class="mi">0</span>
<a name="ln-210"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WallPanelHeatStableTiltedEqNum</span>                 <span class="o">=</span> <span class="n">HcInt_WaltonStableHorizontalOrTilt</span> <span class="c">!InConvClass_A2_StableTilted</span>
<a name="ln-211"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WallPanelHeatStableTiltedUserCurveNum</span>          <span class="o">=</span> <span class="mi">0</span>
<a name="ln-212"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WallPanelHeatUnstableTiltedEqNum</span>               <span class="o">=</span> <span class="n">HcInt_WaltonUnstableHorizontalOrTilt</span> <span class="c">!InConvClass_A2_UnstableTilted</span>
<a name="ln-213"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WallPanelHeatUnstableTiltedUserCurveNum</span>        <span class="o">=</span> <span class="mi">0</span>
<a name="ln-214"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WallPanelHeatWindowsEqNum</span>                      <span class="o">=</span> <span class="n">HcInt_ISO15099Windows</span> <span class="c">!InConvClass_A2_Windows</span>
<a name="ln-215"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WallPanelHeatWindowsUserCurveNum</span>               <span class="o">=</span> <span class="mi">0</span>
<a name="ln-216"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ConvectiveHeatVertWallEqNum</span>                    <span class="o">=</span> <span class="n">HcInt_FohannoPolidoriVerticalWall</span>
<a name="ln-217"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ConvectiveHeatVertWallUserCurveNum</span>             <span class="o">=</span> <span class="mi">0</span>
<a name="ln-218"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ConvectiveHeatVertWallNearHeaterEqNum</span>          <span class="o">=</span> <span class="n">HcInt_KhalifaEq5WallNearHeat</span>
<a name="ln-219"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ConvectiveHeatVertWallNearHeaterUserCurveNum</span>   <span class="o">=</span> <span class="mi">0</span>
<a name="ln-220"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ConvectiveHeatStableHorizEqNum</span>                 <span class="o">=</span> <span class="n">HcInt_AlamdariHammondStableHorizontal</span>
<a name="ln-221"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ConvectiveHeatStableHorizUserCurveNum</span>          <span class="o">=</span> <span class="mi">0</span>
<a name="ln-222"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ConvectiveHeatUnstableHorizEqNum</span>               <span class="o">=</span> <span class="n">HcInt_KhalifaEq7Ceiling</span>
<a name="ln-223"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ConvectiveHeatUnstableHorizUserCurveNum</span>        <span class="o">=</span> <span class="mi">0</span>
<a name="ln-224"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ConvectiveHeatStableTiltedEqNum</span>                <span class="o">=</span> <span class="n">HcInt_WaltonStableHorizontalOrTilt</span>
<a name="ln-225"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ConvectiveHeatStableTiltedUserCurveNum</span>         <span class="o">=</span> <span class="mi">0</span>
<a name="ln-226"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ConvectiveHeatUnstableTiltedEqNum</span>              <span class="o">=</span> <span class="n">HcInt_WaltonUnstableHorizontalOrTilt</span>
<a name="ln-227"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ConvectiveHeatUnstableTiltedUserCurveNum</span>       <span class="o">=</span> <span class="mi">0</span>
<a name="ln-228"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ConvectiveHeatWindowsEqNum</span>                     <span class="o">=</span> <span class="n">HcInt_ISO15099Windows</span>
<a name="ln-229"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ConvectiveHeatWindowsUserCurveNum</span>              <span class="o">=</span> <span class="mi">0</span>
<a name="ln-230"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CentralAirWallEqNum</span>                            <span class="o">=</span> <span class="n">HcInt_GoldsteinNovoselacCeilingDiffuserWalls</span>
<a name="ln-231"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CentralAirWallUserCurveNum</span>                     <span class="o">=</span> <span class="mi">0</span>
<a name="ln-232"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CentralAirCeilingEqNum</span>                         <span class="o">=</span> <span class="n">HcInt_FisherPedersenCeilDiffuserCeiling</span>
<a name="ln-233"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CentralAirCeilingUserCurveNum</span>                  <span class="o">=</span> <span class="mi">0</span>
<a name="ln-234"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CentralAirFloorEqNum</span>                           <span class="o">=</span> <span class="n">HcInt_GoldsteinNovoselacCeilingDiffuserFloor</span>
<a name="ln-235"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CentralAirFloorUserCurveNum</span>                    <span class="o">=</span> <span class="mi">0</span>
<a name="ln-236"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CentralAirWindowsEqNum</span>                         <span class="o">=</span> <span class="n">HcInt_GoldsteinNovoselacCeilingDiffuserWindow</span>
<a name="ln-237"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CentralAirWindowsUserCurveNum</span>                  <span class="o">=</span> <span class="mi">0</span>
<a name="ln-238"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ZoneFanCircVertWallEqNum</span>                       <span class="o">=</span> <span class="n">HcInt_KhalifaEq3WallAwayFromHeat</span>
<a name="ln-239"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ZoneFanCircVertWallUserCurveNum</span>                <span class="o">=</span> <span class="mi">0</span>
<a name="ln-240"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ZoneFanCircStableHorizEqNum</span>                    <span class="o">=</span> <span class="n">HcInt_AlamdariHammondStableHorizontal</span>
<a name="ln-241"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ZoneFanCircStableHorizUserCurveNum</span>             <span class="o">=</span> <span class="mi">0</span>
<a name="ln-242"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ZoneFanCircUnstableHorizEqNum</span>                  <span class="o">=</span> <span class="n">HcInt_KhalifaEq4CeilingAwayFromHeat</span>
<a name="ln-243"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ZoneFanCircUnstableHorizUserCurveNum</span>           <span class="o">=</span> <span class="mi">0</span>
<a name="ln-244"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ZoneFanCircStableTiltedEqNum</span>                   <span class="o">=</span> <span class="n">HcInt_WaltonStableHorizontalOrTilt</span>
<a name="ln-245"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ZoneFanCircStableTiltedUserCurveNum</span>            <span class="o">=</span> <span class="mi">0</span>
<a name="ln-246"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ZoneFanCircUnstableTiltedEqNum</span>                 <span class="o">=</span> <span class="n">HcInt_WaltonUnstableHorizontalOrTilt</span>
<a name="ln-247"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ZoneFanCircUnstableTiltedUserCurveNum</span>          <span class="o">=</span> <span class="mi">0</span>
<a name="ln-248"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ZoneFanCircWindowsEqNum</span>                        <span class="o">=</span> <span class="n">HcInt_ISO15099Windows</span>
<a name="ln-249"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ZoneFanCircWindowsUserCurveNum</span>                 <span class="o">=</span> <span class="mi">0</span>
<a name="ln-250"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MixedBouyAssistingFlowWallEqNum</span>                <span class="o">=</span> <span class="n">HcInt_BeausoleilMorrisonMixedAssistingWall</span>
<a name="ln-251"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MixedBouyAssistingFlowWallUserCurveNum</span>         <span class="o">=</span> <span class="mi">0</span>
<a name="ln-252"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MixedBouyOppossingFlowWallEqNum</span>                <span class="o">=</span> <span class="n">HcInt_BeausoleilMorrisonMixedOppossingWall</span>
<a name="ln-253"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MixedBouyOppossingFlowWallUserCurveNum</span>         <span class="o">=</span> <span class="mi">0</span>
<a name="ln-254"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MixedStableFloorEqNum</span>                          <span class="o">=</span> <span class="n">HcInt_BeausoleilMorrisonMixedStableFloor</span>
<a name="ln-255"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MixedStableFloorUserCurveNum</span>                   <span class="o">=</span> <span class="mi">0</span>
<a name="ln-256"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MixedUnstableFloorEqNum</span>                        <span class="o">=</span> <span class="n">HcInt_BeausoleilMorrisonMixedUnstableFloor</span>
<a name="ln-257"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MixedUnstableFloorUserCurveNum</span>                 <span class="o">=</span> <span class="mi">0</span>
<a name="ln-258"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MixedStableCeilingEqNum</span>                        <span class="o">=</span> <span class="n">HcInt_BeausoleilMorrisonMixedStableCeiling</span>
<a name="ln-259"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MixedStableCeilingUserCurveNum</span>                 <span class="o">=</span> <span class="mi">0</span>
<a name="ln-260"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MixedUnstableCeilingEqNum</span>                      <span class="o">=</span> <span class="n">HcInt_BeausoleilMorrisonMixedUnstableCeiling</span>
<a name="ln-261"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MixedUnstableCeilingUserCurveNum</span>               <span class="o">=</span> <span class="mi">0</span>
<a name="ln-262"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MixedWindowsEqNum</span>                              <span class="o">=</span> <span class="n">HcInt_GoldsteinNovoselacCeilingDiffuserWindow</span>
<a name="ln-263"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MixedWindowsUserCurveNum</span>                       <span class="o">=</span> <span class="mi">0</span>
<a name="ln-264"></a>  <span class="k">END TYPE </span><span class="n">InsideFaceAdaptiveConvAlgoStruct</span>
<a name="ln-265"></a>
<a name="ln-266"></a>  <span class="k">TYPE </span><span class="n">OutsideFaceAdpativeConvAlgoStruct</span>
<a name="ln-267"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">EnteredByUser</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>  <span class="c">!</span>
<a name="ln-268"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Name</span>        <span class="o">=</span> <span class="s1">&#39; &#39;</span>
<a name="ln-269"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">SuppressRainChange</span>               <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-270"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HWindWallWindwardEqNum</span>           <span class="o">=</span> <span class="n">HcExt_BlockenWindward</span>
<a name="ln-271"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HWindWallWindwardUserCurveNum</span>    <span class="o">=</span> <span class="mi">0</span>
<a name="ln-272"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HWindWallLeewardEqNum</span>            <span class="o">=</span> <span class="n">HcExt_EmmelVertical</span>
<a name="ln-273"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HWindWallLeewardUserCurveNum</span>     <span class="o">=</span> <span class="mi">0</span>
<a name="ln-274"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HWindHorizRoofEqNum</span>              <span class="o">=</span> <span class="n">HcExt_ClearRoof</span>
<a name="ln-275"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HWindHorizRoofUserCurveNum</span>       <span class="o">=</span> <span class="mi">0</span>
<a name="ln-276"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HNatVertWallEqNum</span>                <span class="o">=</span> <span class="n">HcExt_NaturalASHRAEVerticalWall</span>
<a name="ln-277"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HNatVertWallUserCurveNum</span>         <span class="o">=</span> <span class="mi">0</span>
<a name="ln-278"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HNatStableHorizEqNum</span>             <span class="o">=</span> <span class="n">HcExt_NaturalWaltonStableHorizontalOrTilt</span>
<a name="ln-279"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HNatStableHorizUserCurveNum</span>      <span class="o">=</span> <span class="mi">0</span>
<a name="ln-280"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HNatUnstableHorizEqNum</span>           <span class="o">=</span> <span class="n">HcExt_NaturalWaltonUnstableHorizontalOrTilt</span>
<a name="ln-281"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HNatUstableHorizUserCurveNum</span>     <span class="o">=</span> <span class="mi">0</span>
<a name="ln-282"></a>  <span class="k">END TYPE </span><span class="n">OutsideFaceAdpativeConvAlgoStruct</span>
<a name="ln-283"></a>
<a name="ln-284"></a>  <span class="k">TYPE </span><span class="n">BoundingBoxVertStruct</span>
<a name="ln-285"></a>    <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">SurfNum</span>    <span class="o">=</span><span class="mi">0</span>
<a name="ln-286"></a>    <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">VertNum</span>    <span class="o">=</span><span class="mi">0</span>
<a name="ln-287"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Vertex</span>  <span class="o">=</span><span class="n">vector</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-288"></a>  <span class="k">END TYPE </span><span class="n">BoundingBoxVertStruct</span>
<a name="ln-289"></a>
<a name="ln-290"></a>  <span class="k">TYPE </span><span class="n">RoofGeoCharactisticsStruct</span>
<a name="ln-291"></a>
<a name="ln-292"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">BoundingBoxVertStruct</span><span class="p">)</span> <span class="kd">::</span> <span class="n">XdYdZd</span> <span class="c">! 1 low x, low y, low z</span>
<a name="ln-293"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">BoundingBoxVertStruct</span><span class="p">)</span> <span class="kd">::</span> <span class="n">XdYdZu</span> <span class="c">! 2 low x, low y, hi z</span>
<a name="ln-294"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">BoundingBoxVertStruct</span><span class="p">)</span> <span class="kd">::</span> <span class="n">XdYuZd</span> <span class="c">! 3 low x, hi y, low z</span>
<a name="ln-295"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">BoundingBoxVertStruct</span><span class="p">)</span> <span class="kd">::</span> <span class="n">XdYuZu</span> <span class="c">! 4 low x, hi y, hi z</span>
<a name="ln-296"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">BoundingBoxVertStruct</span><span class="p">)</span> <span class="kd">::</span> <span class="n">XuYdZd</span> <span class="c">! 5 hi x, low y, low z</span>
<a name="ln-297"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">BoundingBoxVertStruct</span><span class="p">)</span> <span class="kd">::</span> <span class="n">XuYuZd</span> <span class="c">! 6 hi x, hi y, low z</span>
<a name="ln-298"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">BoundingBoxVertStruct</span><span class="p">)</span> <span class="kd">::</span> <span class="n">XuYdZu</span> <span class="c">! 7 hi x, low y, hi z</span>
<a name="ln-299"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">BoundingBoxVertStruct</span><span class="p">)</span> <span class="kd">::</span> <span class="n">XuYuZu</span> <span class="c">! 8 hi x, hi y, hi z</span>
<a name="ln-300"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">vector</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">BoundSurf</span> <span class="c">!long edge of roof group bounding surface</span>
<a name="ln-301"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Area</span>          <span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-302"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Perimeter</span>     <span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-303"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Height</span>        <span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-304"></a>  <span class="k">END TYPE </span><span class="n">RoofGeoCharactisticsStruct</span>
<a name="ln-305"></a>
<a name="ln-306"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">InsideFaceAdaptiveConvAlgoStruct</span><span class="p">),</span><span class="k">SAVE</span>  <span class="kd">::</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span> <span class="c">!stores rules for Hc model equations</span>
<a name="ln-307"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">OutsideFaceAdpativeConvAlgoStruct</span><span class="p">),</span><span class="k">SAVE</span> <span class="kd">::</span> <span class="n">OutsideFaceAdaptiveConvectionAlgo</span>
<a name="ln-308"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">HcInsideFaceUserCurveStruct</span><span class="p">),</span>  <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">HcInsideUserCurve</span>
<a name="ln-309"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">HcOutsideFaceUserCurveStruct</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">HcOutsideUserCurve</span>
<a name="ln-310"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">RoofGeoCharactisticsStruct</span><span class="p">),</span><span class="k">SAVE</span> <span class="kd">::</span>  <span class="n">RoofGeo</span>
<a name="ln-311"></a>
<a name="ln-312"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotOutsideHcUserCurves</span>  <span class="o">=</span> <span class="mi">0</span>
<a name="ln-313"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotInsideHcUserCurves</span>   <span class="o">=</span> <span class="mi">0</span>
<a name="ln-314"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">GetUserSuppliedConvectionCoeffs</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>  <span class="c">! Get user input first call for Init</span>
<a name="ln-315"></a>
<a name="ln-316"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ConvectionGeometryMetaDataSetup</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">! set to true once geometry meta data are setup</span>
<a name="ln-317"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CubeRootOfOverallBuildingVolume</span> <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! building meta data. cube root of the volume of all the zones</span>
<a name="ln-318"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RoofLongAxisOutwardAzimuth</span>      <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! roof surfaces meta data. outward normal azimuth for longest roof edge</span>
<a name="ln-319"></a>
<a name="ln-320"></a>  <span class="c">! SUBROUTINE SPECIFICATIONS:</span>
<a name="ln-321"></a><span class="k">PUBLIC  </span><span class="n">InitInteriorConvectionCoeffs</span>
<a name="ln-322"></a><span class="k">PUBLIC  </span><span class="n">InitExteriorConvectionCoeff</span>
<a name="ln-323"></a><span class="k">PRIVATE </span><span class="n">CalcHfExteriorSparrow</span>
<a name="ln-324"></a><span class="k">PRIVATE </span><span class="n">CalcHnASHRAETARPExterior</span>
<a name="ln-325"></a><span class="k">PRIVATE </span><span class="n">Windward</span>
<a name="ln-326"></a><span class="k">PRIVATE </span><span class="n">GetUserConvectionCoefficients</span>
<a name="ln-327"></a><span class="c">!PRIVATE ApplyConvectionValue ! internal to GetUserConvectionCoefficients</span>
<a name="ln-328"></a><span class="k">PUBLIC  </span><span class="n">CalcASHRAESimpExtConvectCoeff</span>
<a name="ln-329"></a><span class="k">PRIVATE </span><span class="n">CalcASHRAESimpleIntConvCoeff</span>
<a name="ln-330"></a><span class="k">PRIVATE </span><span class="n">CalcASHRAEDetailedIntConvCoeff</span>
<a name="ln-331"></a><span class="k">PUBLIC  </span><span class="n">CalcDetailedHcINforDVModel</span>
<a name="ln-332"></a><span class="k">PRIVATE </span><span class="n">CalcCeilingDiffuserIntConvCoeff</span>
<a name="ln-333"></a><span class="k">PRIVATE </span><span class="n">CalcCeilingDiffuserInletCorr</span>
<a name="ln-334"></a><span class="k">PRIVATE </span><span class="n">CalcTrombeWallIntConvCoeff</span>
<a name="ln-335"></a><span class="k">PRIVATE </span><span class="n">CalcNusselt</span>
<a name="ln-336"></a><span class="k">PUBLIC  </span><span class="n">SetExtConvectionCoeff</span>
<a name="ln-337"></a><span class="k">PUBLIC  </span><span class="n">SetIntConvectionCoeff</span>
<a name="ln-338"></a><span class="k">PUBLIC  </span><span class="n">CalcISO15099WindowIntConvCoeff</span>
<a name="ln-339"></a>
<a name="ln-340"></a><span class="k">PRIVATE </span><span class="n">SetupAdaptiveConvectionStaticMetaData</span>
<a name="ln-341"></a><span class="k">PRIVATE </span><span class="n">SetupAdaptiveConvectionRadiantSurfaceData</span>
<a name="ln-342"></a><span class="k">PRIVATE </span><span class="n">ManageInsideAdaptiveConvectionAlgo</span>
<a name="ln-343"></a><span class="k">PRIVATE </span><span class="n">ManageOutsideAdaptiveConvectionAlgo</span>
<a name="ln-344"></a><span class="k">PRIVATE </span><span class="n">EvaluateIntHcModels</span>
<a name="ln-345"></a><span class="k">PRIVATE </span><span class="n">EvaluateExtHcModels</span>
<a name="ln-346"></a><span class="k">PRIVATE </span><span class="n">DynamicIntConvSurfaceClassification</span>
<a name="ln-347"></a><span class="k">PRIVATE </span><span class="n">MapIntConvClassificationToHcModels</span>
<a name="ln-348"></a><span class="k">PRIVATE </span><span class="n">DynamicExtConvSurfaceClassification</span>
<a name="ln-349"></a><span class="k">PRIVATE </span><span class="n">MapExtConvClassificationToHcModels</span>
<a name="ln-350"></a>
<a name="ln-351"></a><span class="c">!more specific Hc model equations</span>
<a name="ln-352"></a><span class="k">PRIVATE </span><span class="n">CalcUserDefinedInsideHcModel</span>
<a name="ln-353"></a><span class="k">PRIVATE </span><span class="n">CalcUserDefinedOutsideHcModel</span>
<a name="ln-354"></a><span class="k">PRIVATE </span><span class="n">CalcASHRAEVerticalWall</span>
<a name="ln-355"></a><span class="k">PRIVATE </span><span class="n">CalcWaltonUnstableHorizontalOrTilt</span>
<a name="ln-356"></a><span class="k">PRIVATE </span><span class="n">CalcWaltonStableHorizontalOrTilt</span>
<a name="ln-357"></a><span class="k">PRIVATE </span><span class="n">CalcAlamdariHammondUnstableHorizontal</span>
<a name="ln-358"></a><span class="k">PRIVATE </span><span class="n">CalcAlamdariHammondStableHorizontal</span>
<a name="ln-359"></a><span class="k">PRIVATE </span><span class="n">CalcAlamdariHammondVerticalWall</span>
<a name="ln-360"></a><span class="k">PRIVATE </span><span class="n">CalcKhalifaEq3WallAwayFromHeat</span>
<a name="ln-361"></a><span class="k">PRIVATE </span><span class="n">CalcKhalifaEq4CeilingAwayFromHeat</span>
<a name="ln-362"></a><span class="k">PRIVATE </span><span class="n">CalcKhalifaEq5WallsNearHeat</span>
<a name="ln-363"></a><span class="k">PRIVATE </span><span class="n">CalcKhalifaEq6NonHeatedWalls</span>
<a name="ln-364"></a><span class="k">PRIVATE </span><span class="n">CalcKhalifaEq7Ceiling</span>
<a name="ln-365"></a><span class="k">PRIVATE </span><span class="n">CalcAwbiHattonHeatedFloor</span>
<a name="ln-366"></a><span class="k">PRIVATE </span><span class="n">CalcAwbiHattonHeatedWall</span>
<a name="ln-367"></a><span class="k">PRIVATE </span><span class="n">CalcBeausoleilMorrisonMixedAssistedWall</span>
<a name="ln-368"></a><span class="k">PRIVATE </span><span class="n">CalcBeausoleilMorrisonMixedOpposingWall</span>
<a name="ln-369"></a><span class="k">PRIVATE </span><span class="n">CalcBeausoleilMorrisonMixedStableFloor</span>
<a name="ln-370"></a><span class="k">PRIVATE </span><span class="n">CalcBeausoleilMorrisonMixedUnstableFloor</span>
<a name="ln-371"></a><span class="k">PRIVATE </span><span class="n">CalcBeausoleilMorrisonMixedStableCeiling</span>
<a name="ln-372"></a><span class="k">PRIVATE </span><span class="n">CalcBeausoleilMorrisonMixedUnstableCeiling</span>
<a name="ln-373"></a><span class="k">PRIVATE </span><span class="n">CalcFohannoPolidoriVerticalWall</span>
<a name="ln-374"></a><span class="k">PRIVATE </span><span class="n">CalcKaradagChilledCeiling</span>
<a name="ln-375"></a><span class="k">PRIVATE </span><span class="n">CalcGoldsteinNovoselacCeilingDiffuserWindow</span>
<a name="ln-376"></a><span class="k">PRIVATE </span><span class="n">CalcGoldsteinNovoselacCeilingDiffuserWall</span>
<a name="ln-377"></a><span class="k">PRIVATE </span><span class="n">CalcGoldsteinNovoselacCeilingDiffuserFloor</span>
<a name="ln-378"></a>
<a name="ln-379"></a><span class="k">PRIVATE </span><span class="n">CalcSparrowWindward</span>
<a name="ln-380"></a><span class="k">PRIVATE </span><span class="n">CalcSparrowLeeward</span>
<a name="ln-381"></a><span class="k">PRIVATE </span><span class="n">CalcMoWITTWindward</span>
<a name="ln-382"></a><span class="k">PRIVATE </span><span class="n">CalcMoWITTLeeward</span>
<a name="ln-383"></a><span class="k">PRIVATE </span><span class="n">CalcDOE2Windward</span>
<a name="ln-384"></a><span class="k">PRIVATE </span><span class="n">CalcDOE2Leeward</span>
<a name="ln-385"></a><span class="k">PRIVATE </span><span class="n">CalcNusseltJurges</span>
<a name="ln-386"></a><span class="k">PRIVATE </span><span class="n">CalcMcAdams</span>
<a name="ln-387"></a><span class="k">PRIVATE </span><span class="n">CalcMitchell</span>
<a name="ln-388"></a><span class="k">PRIVATE </span><span class="n">CalcBlockenWindward</span>
<a name="ln-389"></a><span class="k">PRIVATE </span><span class="n">CalcEmmelVertical</span>
<a name="ln-390"></a><span class="k">PRIVATE </span><span class="n">CalcEmmelRoof</span>
<a name="ln-391"></a><span class="k">PRIVATE </span><span class="n">CalcClearRoof</span>
<a name="ln-392"></a>
<a name="ln-393"></a>
<a name="ln-394"></a><span class="k">CONTAINS</span>
<a name="ln-395"></a>
<a name="ln-396"></a><span class="k">SUBROUTINE </span><span class="n">InitInteriorConvectionCoeffs</span><span class="p">(</span><span class="n">SurfaceTemperatures</span><span class="p">,</span><span class="n">ZoneToResimulate</span><span class="p">)</span>
<a name="ln-397"></a>
<a name="ln-398"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-399"></a>          <span class="c">!       AUTHOR         Rick Strand</span>
<a name="ln-400"></a>          <span class="c">!       DATE WRITTEN   March 1998</span>
<a name="ln-401"></a>          <span class="c">!       MODIFIED       Dan Fisher, Nov 2000</span>
<a name="ln-402"></a>          <span class="c">!                      Sep 2011 LKL/BG - resimulate only zones needing it for Radiant systems</span>
<a name="ln-403"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-404"></a>
<a name="ln-405"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-406"></a>          <span class="c">! This subroutine initializes the arrays associated with interior</span>
<a name="ln-407"></a>          <span class="c">! surface convection.  The main parameter which is initialized</span>
<a name="ln-408"></a>          <span class="c">! in this routine is HConvIn, the convection coefficient on the</span>
<a name="ln-409"></a>          <span class="c">! inside surface.</span>
<a name="ln-410"></a>
<a name="ln-411"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-412"></a>          <span class="c">! Determine the temperature difference between the surface and the</span>
<a name="ln-413"></a>          <span class="c">! zone air for the last time step and then base the calculation</span>
<a name="ln-414"></a>          <span class="c">! of the convection coefficient on that value and the surface tilt.</span>
<a name="ln-415"></a>
<a name="ln-416"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-417"></a>          <span class="c">! (I)BLAST legacy routine VARTMP</span>
<a name="ln-418"></a>          <span class="c">! 1.  Passive Solar Extension of the BLAST Program</span>
<a name="ln-419"></a>          <span class="c">!       Appendix E. p. 17,18</span>
<a name="ln-420"></a>          <span class="c">! 2.  ASHRAE</span>
<a name="ln-421"></a>          <span class="c">!       Simple Algorithm:    ASHRAE Handbook of Fundamentals 1985, p. 23.2, Table 1</span>
<a name="ln-422"></a>          <span class="c">!       Detailed Algorithm:  ASHRAE Handbook of Fundamentals 2001, p. 3.12, Table 5</span>
<a name="ln-423"></a>          <span class="c">! 3.  Walton, G. N. 1983. Thermal Analysis Research Program (TARP) Reference Manual,</span>
<a name="ln-424"></a>          <span class="c">!     NBSSIR 83-2655, National Bureau of Standards, &quot;Surface Inside Heat Balances&quot;, pp 79-80</span>
<a name="ln-425"></a>          <span class="c">! 4.  Fisher, D.E. and C.O. Pedersen, Convective Heat Transfer in Building Energy and</span>
<a name="ln-426"></a>          <span class="c">!       Thermal Load Calculations, ASHRAE Transactions, vol. 103, Pt. 2, 1997, p.137</span>
<a name="ln-427"></a>          <span class="c">! 5.  ISO Standard 15099:2003e</span>
<a name="ln-428"></a>
<a name="ln-429"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-430"></a>  <span class="k">USE </span><span class="n">DataHeatBalFanSys</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">MAT</span>
<a name="ln-431"></a>  <span class="k">USE </span><span class="n">DataHeatBalance</span><span class="p">,</span>   <span class="n">ONLY</span><span class="p">:</span> <span class="n">Construct</span>
<a name="ln-432"></a>  <span class="k">USE </span><span class="n">DataZoneEquipment</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ZoneEquipInputsFilled</span><span class="p">,</span> <span class="n">ZoneEquipSimulatedOnce</span>
<a name="ln-433"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">BeginEnvrnFlag</span>
<a name="ln-434"></a>  <span class="k">USE </span><span class="n">DataLoopNode</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">Node</span><span class="p">,</span> <span class="n">NumOfNodes</span>
<a name="ln-435"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-436"></a>
<a name="ln-437"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-438"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfaceTemperatures</span> <span class="c">! Temperature of surfaces for evaluation of HcIn</span>
<a name="ln-439"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">ZoneToResimulate</span>  <span class="c">! if passed in, then only calculate surfaces that have this zone</span>
<a name="ln-440"></a>
<a name="ln-441"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-442"></a>          <span class="c">! na</span>
<a name="ln-443"></a>
<a name="ln-444"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-445"></a>          <span class="c">! na</span>
<a name="ln-446"></a>
<a name="ln-447"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-448"></a>          <span class="c">! na</span>
<a name="ln-449"></a>
<a name="ln-450"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-451"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ZoneNum</span>            <span class="c">! DO loop counter for zones</span>
<a name="ln-452"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SurfNum</span>            <span class="c">! DO loop counter for surfaces in zone</span>
<a name="ln-453"></a>  <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">SAVE</span> <span class="kd">::</span> <span class="n">NodeCheck</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>  <span class="c">! for CeilingDiffuser Zones</span>
<a name="ln-454"></a>  <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ActiveSurfaceCheck</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span> <span class="c">! for radiant surfaces in zone</span>
<a name="ln-455"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">MyEnvirnFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-456"></a>
<a name="ln-457"></a>          <span class="c">! FLOW:</span>
<a name="ln-458"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetUserSuppliedConvectionCoeffs</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-459"></a><span class="k">    CALL </span><span class="n">GetUserConvectionCoefficients</span>
<a name="ln-460"></a>    <span class="n">GetUserSuppliedConvectionCoeffs</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-461"></a>  <span class="n">ENDIF</span>
<a name="ln-462"></a>
<a name="ln-463"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NodeCheck</span><span class="p">)</span> <span class="k">THEN</span>   <span class="c">! done once when conditions are ready...</span>
<a name="ln-464"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SysSizingCalc</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">ZoneSizingCalc</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ZoneEquipInputsFilled</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">Node</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-465"></a><span class="k">      </span><span class="n">NodeCheck</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-466"></a>      <span class="k">DO </span><span class="n">ZoneNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-467"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">InsideConvectionAlgo</span> <span class="o">/=</span> <span class="n">CeilingDiffuser</span><span class="p">)</span>  <span class="k">CYCLE</span>
<a name="ln-468"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SystemZoneNodeNumber</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-469"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;InitInteriorConvectionCoeffs: Inside Convection=CeilingDiffuser, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-470"></a>                             <span class="s1">&#39;but no system inlet node defined, Zone=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-471"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Defaulting inside convection to TARP. Check ZoneHVAC:EquipmentConnections for Zone=&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-472"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-473"></a>        <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">InsideConvectionAlgo</span><span class="o">=</span><span class="n">ASHRAETARP</span>
<a name="ln-474"></a>      <span class="n">ENDDO</span>
<a name="ln-475"></a>      <span class="c">!insert one-time setup for adpative inside face</span>
<a name="ln-476"></a>    <span class="n">ENDIF</span>
<a name="ln-477"></a>  <span class="n">ENDIF</span>
<a name="ln-478"></a>
<a name="ln-479"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ActiveSurfaceCheck</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SysSizingCalc</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">ZoneSizingCalc</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ZoneEquipSimulatedOnce</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-480"></a><span class="k">    CALL </span><span class="n">SetupAdaptiveConvectionRadiantSurfaceData</span>
<a name="ln-481"></a>    <span class="n">ActiveSurfaceCheck</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-482"></a>  <span class="n">ENDIF</span>
<a name="ln-483"></a>
<a name="ln-484"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">BeginEnvrnFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MyEnvirnFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-485"></a><span class="k">    IF</span> <span class="p">(</span><span class="nb">ANY</span><span class="p">(</span><span class="n">Surface</span><span class="p">%</span><span class="n">IntConvCoeff</span> <span class="o">==</span> <span class="n">AdaptiveConvectionAlgorithm</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-486"></a>        <span class="nb">ANY</span><span class="p">(</span><span class="n">Zone</span><span class="p">%</span><span class="n">InsideConvectionAlgo</span><span class="o">==</span> <span class="n">AdaptiveConvectionAlgorithm</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-487"></a>      <span class="c">!need to clear out node conditions because dynamic assignments will be affected</span>
<a name="ln-488"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">NumOfNodes</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">Node</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-489"></a><span class="k">        </span><span class="n">Node</span><span class="p">%</span><span class="n">Temp</span>                      <span class="o">=</span> <span class="n">DefaultNodeValues</span><span class="p">%</span><span class="n">Temp</span>
<a name="ln-490"></a>        <span class="n">Node</span><span class="p">%</span><span class="n">TempMin</span>                   <span class="o">=</span> <span class="n">DefaultNodeValues</span><span class="p">%</span><span class="n">TempMin</span>
<a name="ln-491"></a>        <span class="n">Node</span><span class="p">%</span><span class="n">TempMax</span>                   <span class="o">=</span> <span class="n">DefaultNodeValues</span><span class="p">%</span><span class="n">TempMax</span>
<a name="ln-492"></a>        <span class="n">Node</span><span class="p">%</span><span class="n">TempSetPoint</span>              <span class="o">=</span> <span class="n">DefaultNodeValues</span><span class="p">%</span><span class="n">TempSetPoint</span>
<a name="ln-493"></a>        <span class="n">Node</span><span class="p">%</span><span class="n">MassFlowRate</span>              <span class="o">=</span> <span class="n">DefaultNodeValues</span><span class="p">%</span><span class="n">MassFlowRate</span>
<a name="ln-494"></a>        <span class="n">Node</span><span class="p">%</span><span class="n">MassFlowRateMin</span>           <span class="o">=</span> <span class="n">DefaultNodeValues</span><span class="p">%</span><span class="n">MassFlowRateMin</span>
<a name="ln-495"></a>        <span class="n">Node</span><span class="p">%</span><span class="n">MassFlowRateMax</span>           <span class="o">=</span> <span class="n">DefaultNodeValues</span><span class="p">%</span><span class="n">MassFlowRateMax</span>
<a name="ln-496"></a>        <span class="n">Node</span><span class="p">%</span><span class="n">MassFlowRateMinAvail</span>      <span class="o">=</span> <span class="n">DefaultNodeValues</span><span class="p">%</span><span class="n">MassFlowRateMinAvail</span>
<a name="ln-497"></a>        <span class="n">Node</span><span class="p">%</span><span class="n">MassFlowRateMaxAvail</span>      <span class="o">=</span> <span class="n">DefaultNodeValues</span><span class="p">%</span><span class="n">MassFlowRateMaxAvail</span>
<a name="ln-498"></a>        <span class="n">Node</span><span class="p">%</span><span class="n">MassFlowRateSetPoint</span>      <span class="o">=</span> <span class="n">DefaultNodeValues</span><span class="p">%</span><span class="n">MassFlowRateSetPoint</span>
<a name="ln-499"></a>        <span class="n">Node</span><span class="p">%</span><span class="n">Quality</span>                   <span class="o">=</span> <span class="n">DefaultNodeValues</span><span class="p">%</span><span class="n">Quality</span>
<a name="ln-500"></a>        <span class="n">Node</span><span class="p">%</span><span class="n">Press</span>                     <span class="o">=</span> <span class="n">DefaultNodeValues</span><span class="p">%</span><span class="n">Press</span>
<a name="ln-501"></a>        <span class="n">Node</span><span class="p">%</span><span class="n">Enthalpy</span>                  <span class="o">=</span> <span class="n">DefaultNodeValues</span><span class="p">%</span><span class="n">Enthalpy</span>
<a name="ln-502"></a>        <span class="n">Node</span><span class="p">%</span><span class="n">HumRat</span>                    <span class="o">=</span> <span class="n">DefaultNodeValues</span><span class="p">%</span><span class="n">HumRat</span>
<a name="ln-503"></a>        <span class="n">Node</span><span class="p">%</span><span class="n">HumRatMin</span>                 <span class="o">=</span> <span class="n">DefaultNodeValues</span><span class="p">%</span><span class="n">HumRatMin</span>
<a name="ln-504"></a>        <span class="n">Node</span><span class="p">%</span><span class="n">HumRatMax</span>                 <span class="o">=</span> <span class="n">DefaultNodeValues</span><span class="p">%</span><span class="n">HumRatMax</span>
<a name="ln-505"></a>        <span class="n">Node</span><span class="p">%</span><span class="n">HumRatSetPoint</span>            <span class="o">=</span> <span class="n">DefaultNodeValues</span><span class="p">%</span><span class="n">HumRatSetPoint</span>
<a name="ln-506"></a>        <span class="n">Node</span><span class="p">%</span><span class="n">TempSetPointHi</span>            <span class="o">=</span> <span class="n">DefaultNodeValues</span><span class="p">%</span><span class="n">TempSetPointHi</span>
<a name="ln-507"></a>        <span class="n">Node</span><span class="p">%</span><span class="n">TempSetPointLo</span>            <span class="o">=</span> <span class="n">DefaultNodeValues</span><span class="p">%</span><span class="n">TempSetPointLo</span>
<a name="ln-508"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">MoreNodeInfo</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-509"></a><span class="k">          </span><span class="n">MoreNodeInfo</span><span class="p">%</span><span class="n">WetbulbTemp</span>       <span class="o">=</span> <span class="n">DefaultNodeValues</span><span class="p">%</span><span class="n">Temp</span>
<a name="ln-510"></a>          <span class="n">MoreNodeInfo</span><span class="p">%</span><span class="n">RelHumidity</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-511"></a>          <span class="n">MoreNodeInfo</span><span class="p">%</span><span class="n">ReportEnthalpy</span>    <span class="o">=</span> <span class="n">DefaultNodeValues</span><span class="p">%</span><span class="n">Enthalpy</span>
<a name="ln-512"></a>          <span class="n">MoreNodeInfo</span><span class="p">%</span><span class="n">VolFlowRateStdRho</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-513"></a>          <span class="n">MoreNodeInfo</span><span class="p">%</span><span class="n">VolFlowRateCrntRho</span><span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-514"></a>          <span class="n">MoreNodeInfo</span><span class="p">%</span><span class="n">Density</span>           <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-515"></a>        <span class="n">ENDIF</span>
<a name="ln-516"></a>      <span class="n">ENDIF</span>
<a name="ln-517"></a>    <span class="n">ENDIF</span>
<a name="ln-518"></a>    <span class="n">MyEnvirnFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-519"></a>  <span class="n">ENDIF</span>
<a name="ln-520"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">BeginEnvrnFlag</span><span class="p">)</span> <span class="n">MyEnvirnFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-521"></a><span class="n">ZoneLoop1</span><span class="p">:</span>  <span class="k">DO </span><span class="n">ZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumOfZones</span>
<a name="ln-522"></a>
<a name="ln-523"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">InsideConvectionAlgo</span><span class="p">)</span>
<a name="ln-524"></a>      <span class="c">! Ceiling Diffuser and Trombe Wall only make sense at Zone Level</span>
<a name="ln-525"></a>      <span class="c">! Interior convection coeffs are first calculated here and then at surface level</span>
<a name="ln-526"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">CeilingDiffuser</span><span class="p">)</span>
<a name="ln-527"></a>        <span class="k">CALL </span><span class="n">CalcCeilingDiffuserIntConvCoeff</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span>
<a name="ln-528"></a>
<a name="ln-529"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">TrombeWall</span><span class="p">)</span>
<a name="ln-530"></a>        <span class="k">CALL </span><span class="n">CalcTrombeWallIntConvCoeff</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">,</span><span class="n">SurfaceTemperatures</span><span class="p">)</span>
<a name="ln-531"></a>
<a name="ln-532"></a>      <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-533"></a>
<a name="ln-534"></a>    <span class="k">END SELECT</span>
<a name="ln-535"></a>
<a name="ln-536"></a><span class="k">  END DO </span><span class="n">ZoneLoop1</span>
<a name="ln-537"></a><span class="n">ZoneLoop2</span><span class="p">:</span>  <span class="k">DO </span><span class="n">ZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumOfZones</span>
<a name="ln-538"></a>
<a name="ln-539"></a>  <span class="n">SurfLoop</span><span class="p">:</span>  <span class="k">DO </span><span class="n">SurfNum</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-540"></a>
<a name="ln-541"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>  <span class="c">! Skip non-heat transfer surfaces</span>
<a name="ln-542"></a>
<a name="ln-543"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">ZoneToResimulate</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-544"></a><span class="k">        IF</span> <span class="p">((</span><span class="n">ZoneNum</span> <span class="o">/=</span> <span class="n">ZoneToResimulate</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">AdjacentZoneToSurface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">/=</span> <span class="n">ZoneToResimulate</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-545"></a><span class="k">          CYCLE</span> <span class="c">! skip surfaces that are not associated with this zone</span>
<a name="ln-546"></a>        <span class="n">ENDIF</span>
<a name="ln-547"></a>      <span class="n">ENDIF</span>
<a name="ln-548"></a>
<a name="ln-549"></a>      <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvCoeff</span><span class="p">)</span>
<a name="ln-550"></a>
<a name="ln-551"></a>        <span class="k">CASE</span><span class="p">(:</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>  <span class="c">! Set by user using one of the standard algorithms...</span>
<a name="ln-552"></a>
<a name="ln-553"></a>          <span class="k">SELECT CASE</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvCoeff</span><span class="p">))</span>
<a name="ln-554"></a>
<a name="ln-555"></a>            <span class="k">CASE</span> <span class="p">(</span><span class="n">ASHRAESimple</span><span class="p">)</span>
<a name="ln-556"></a>              <span class="k">CALL </span><span class="n">CalcASHRAESimpleIntConvCoeff</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">SurfaceTemperatures</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">),</span><span class="n">MAT</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">))</span>
<a name="ln-557"></a>              <span class="c">! Establish some lower limit to avoid a zero convection coefficient (and potential divide by zero problems)</span>
<a name="ln-558"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">HConvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">LowHConvLimit</span><span class="p">)</span> <span class="n">HConvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">LowHConvLimit</span>
<a name="ln-559"></a>
<a name="ln-560"></a>            <span class="k">CASE</span> <span class="p">(</span><span class="n">ASHRAETARP</span><span class="p">)</span>
<a name="ln-561"></a>              <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TypeIsWindow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-562"></a><span class="k">                CALL </span><span class="n">CalcASHRAEDetailedIntConvCoeff</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">SurfaceTemperatures</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">),</span><span class="n">MAT</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">))</span>
<a name="ln-563"></a>              <span class="k">ELSE</span>
<a name="ln-564"></a><span class="k">                CALL </span><span class="n">CalcISO15099WindowIntConvCoeff</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">SurfaceTemperatures</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">),</span><span class="n">MAT</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">))</span>
<a name="ln-565"></a>              <span class="n">ENDIF</span>
<a name="ln-566"></a>
<a name="ln-567"></a>              <span class="c">! Establish some lower limit to avoid a zero convection coefficient (and potential divide by zero problems)</span>
<a name="ln-568"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">HConvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">LowHConvLimit</span><span class="p">)</span> <span class="n">HConvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">LowHConvLimit</span>
<a name="ln-569"></a>
<a name="ln-570"></a>            <span class="k">CASE</span> <span class="p">(</span><span class="n">AdaptiveConvectionAlgorithm</span><span class="p">)</span>
<a name="ln-571"></a>
<a name="ln-572"></a>              <span class="k">CALL </span><span class="n">ManageInsideAdaptiveConvectionAlgo</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-573"></a>
<a name="ln-574"></a>            <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-575"></a>              <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Unhandled convection coefficient algorithm.&#39;</span><span class="p">)</span>
<a name="ln-576"></a>          <span class="k">END SELECT</span>
<a name="ln-577"></a>
<a name="ln-578"></a><span class="k">        CASE</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>    <span class="c">! Not set by user, uses Zone Setting</span>
<a name="ln-579"></a>
<a name="ln-580"></a>          <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">InsideConvectionAlgo</span><span class="p">)</span>
<a name="ln-581"></a>
<a name="ln-582"></a>            <span class="k">CASE</span> <span class="p">(</span><span class="n">ASHRAESimple</span><span class="p">)</span>
<a name="ln-583"></a>              <span class="k">CALL </span><span class="n">CalcASHRAESimpleIntConvCoeff</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">SurfaceTemperatures</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">),</span><span class="n">MAT</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">))</span>
<a name="ln-584"></a>              <span class="c">! Establish some lower limit to avoid a zero convection coefficient (and potential divide by zero problems)</span>
<a name="ln-585"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">HConvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">LowHConvLimit</span><span class="p">)</span> <span class="n">HConvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">LowHConvLimit</span>
<a name="ln-586"></a>
<a name="ln-587"></a>            <span class="k">CASE</span> <span class="p">(</span><span class="n">ASHRAETARP</span><span class="p">)</span>
<a name="ln-588"></a>              <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TypeIsWindow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-589"></a><span class="k">                CALL </span><span class="n">CalcASHRAEDetailedIntConvCoeff</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">SurfaceTemperatures</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">),</span><span class="n">MAT</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">))</span>
<a name="ln-590"></a>              <span class="k">ELSE</span>
<a name="ln-591"></a><span class="k">                CALL </span><span class="n">CalcISO15099WindowIntConvCoeff</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">SurfaceTemperatures</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">),</span><span class="n">MAT</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">))</span>
<a name="ln-592"></a>              <span class="n">ENDIF</span>
<a name="ln-593"></a>              <span class="c">! Establish some lower limit to avoid a zero convection coefficient (and potential divide by zero problems)</span>
<a name="ln-594"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">HConvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">LowHConvLimit</span><span class="p">)</span> <span class="n">HConvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">LowHConvLimit</span>
<a name="ln-595"></a>
<a name="ln-596"></a>            <span class="k">CASE</span> <span class="p">(</span><span class="n">AdaptiveConvectionAlgorithm</span><span class="p">)</span>
<a name="ln-597"></a>
<a name="ln-598"></a>              <span class="k">CALL </span><span class="n">ManageInsideAdaptiveConvectionAlgo</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-599"></a>
<a name="ln-600"></a>            <span class="k">CASE</span> <span class="p">(</span><span class="n">CeilingDiffuser</span><span class="p">,</span><span class="n">TrombeWall</span><span class="p">)</span>
<a name="ln-601"></a>              <span class="c">! Already done above and can&#39;t be at individual surface</span>
<a name="ln-602"></a>
<a name="ln-603"></a>            <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-604"></a>              <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Unhandled convection coefficient algorithm.&#39;</span><span class="p">)</span>
<a name="ln-605"></a>
<a name="ln-606"></a>          <span class="k">END SELECT</span>
<a name="ln-607"></a>
<a name="ln-608"></a><span class="k">        CASE </span><span class="n">DEFAULT</span>  <span class="c">! Interior convection has been set by the user with &quot;value&quot; or &quot;schedule&quot;</span>
<a name="ln-609"></a>          <span class="n">HConvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span><span class="o">=</span><span class="n">SetIntConvectionCoeff</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-610"></a>          <span class="c">! Establish some lower limit to avoid a zero convection coefficient (and potential divide by zero problems)</span>
<a name="ln-611"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">HConvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">LowHConvLimit</span><span class="p">)</span> <span class="n">HConvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">LowHConvLimit</span>
<a name="ln-612"></a>
<a name="ln-613"></a>      <span class="k">END SELECT</span>
<a name="ln-614"></a>
<a name="ln-615"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">EMSOverrideIntConvCoef</span><span class="p">)</span> <span class="n">HConvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">EMSValueForIntConvCoef</span>
<a name="ln-616"></a>
<a name="ln-617"></a>    <span class="k">END DO </span><span class="n">SurfLoop</span>
<a name="ln-618"></a>
<a name="ln-619"></a>  <span class="k">END DO </span><span class="n">ZoneLoop2</span>
<a name="ln-620"></a>
<a name="ln-621"></a>  <span class="k">RETURN</span>
<a name="ln-622"></a>
<a name="ln-623"></a><span class="k">END SUBROUTINE </span><span class="n">InitInteriorConvectionCoeffs</span>
<a name="ln-624"></a>
<a name="ln-625"></a>
<a name="ln-626"></a><span class="k">SUBROUTINE </span><span class="n">InitExteriorConvectionCoeff</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">HMovInsul</span><span class="p">,</span><span class="n">Roughness</span><span class="p">,</span><span class="n">AbsExt</span><span class="p">,</span><span class="n">TempExt</span><span class="p">,</span><span class="n">HExt</span><span class="p">,</span><span class="n">HSky</span><span class="p">,</span><span class="n">HGround</span><span class="p">,</span><span class="n">HAir</span><span class="p">)</span>
<a name="ln-627"></a>
<a name="ln-628"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-629"></a>          <span class="c">!       AUTHOR         George Walton</span>
<a name="ln-630"></a>          <span class="c">!       DATE WRITTEN   January 1990</span>
<a name="ln-631"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-632"></a>          <span class="c">!       RE-ENGINEERED  Mar98 (RKS); Sep03 (LKL): Add additional flavors of Ext Convection Coeff.</span>
<a name="ln-633"></a>          <span class="c">!                      Dec03 (PGE): Re-eng&#39;d ASHRAEDetailed to match BLAST and TARP.</span>
<a name="ln-634"></a>          <span class="c">!                      Aug04 (PGE): Corrected error for calculating local wind speeds for different terrains.</span>
<a name="ln-635"></a>          <span class="c">!                      Aug 2010 B. Griffith.  for outside air convection, added new adaptive convection algorithm etc.</span>
<a name="ln-636"></a>
<a name="ln-637"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-638"></a>          <span class="c">! This subroutine determines the outside convection coefficient for</span>
<a name="ln-639"></a>          <span class="c">! a particular surface.</span>
<a name="ln-640"></a>
<a name="ln-641"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-642"></a>          <span class="c">! Based on the properties of a particular surface, determine what the</span>
<a name="ln-643"></a>          <span class="c">! outside convection coefficients are for outside air, the sky, and</span>
<a name="ln-644"></a>          <span class="c">! the ground.  Convection coefficients for the sky and ground are</span>
<a name="ln-645"></a>          <span class="c">! actually linearized radiation coefficients.  The ground surface is</span>
<a name="ln-646"></a>          <span class="c">! assumed to be the same temperature as the outside air.</span>
<a name="ln-647"></a>
<a name="ln-648"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-649"></a>          <span class="c">! (I)BLAST legacy routine OCNVCO</span>
<a name="ln-650"></a>          <span class="c">! TARP Reference Manual, &quot;Surface Outside Heat Balances&quot;, pp 71ff</span>
<a name="ln-651"></a>
<a name="ln-652"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-653"></a>  <span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SkyTempKelvin</span><span class="p">,</span> <span class="n">WindDir</span>
<a name="ln-654"></a>
<a name="ln-655"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-656"></a>
<a name="ln-657"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-658"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">SurfNum</span>       <span class="c">! Surface number (in Surface derived type)</span>
<a name="ln-659"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Roughness</span>     <span class="c">! Roughness index (1-6), see DataHeatBalance parameters</span>
<a name="ln-660"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">HMovInsul</span>     <span class="c">! Equivalent convection coefficient of movable insulation</span>
<a name="ln-661"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">AbsExt</span>        <span class="c">! Exterior thermal absorptance</span>
<a name="ln-662"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">TempExt</span>       <span class="c">! Exterior surface temperature (C)</span>
<a name="ln-663"></a><span class="c">!  REAL(r64),    INTENT(IN)  :: WindSpeedExt  ! Exterior wind speed (m/s)  **No longer used</span>
<a name="ln-664"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HExt</span>          <span class="c">! Convection coefficient to exterior air</span>
<a name="ln-665"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HSky</span>          <span class="c">! &quot;Convection&quot; coefficient to sky temperature</span>
<a name="ln-666"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HGround</span>       <span class="c">! &quot;Convection&quot; coefficient to ground temperature</span>
<a name="ln-667"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HAir</span>          <span class="c">! Radiation to Air Component</span>
<a name="ln-668"></a>
<a name="ln-669"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-670"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">MoWiTTTurbulentConstant</span> <span class="o">=</span> <span class="mf">0.84d0</span>  <span class="c">! Turbulent natural convection constant</span>
<a name="ln-671"></a>
<a name="ln-672"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-673"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TAir</span>           <span class="c">! Absolute dry bulb temperature of outdoor air (K)</span>
<a name="ln-674"></a><span class="c">!  REAL(r64) :: TSky           ! Absolute temperature of the sky (K)</span>
<a name="ln-675"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TSurf</span>          <span class="c">! Absolute temperature of the exterior surface (K)</span>
<a name="ln-676"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfWindSpeed</span>  <span class="c">! Local wind speed at height of the heat transfer surface (m/s)</span>
<a name="ln-677"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ConstantA</span>      <span class="c">! = a, Constant, W/(m2K(m/s)^b)</span>
<a name="ln-678"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ConstantB</span>      <span class="c">! = b, Constant, W/(m2K^(4/3))</span>
<a name="ln-679"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Hn</span>             <span class="c">! Natural part of exterior convection</span>
<a name="ln-680"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Hf</span>             <span class="c">! Forced part of exterior convection</span>
<a name="ln-681"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HcGlass</span>
<a name="ln-682"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rcalcPerimeter</span> <span class="c">! approximation for Perimeter</span>
<a name="ln-683"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">BaseSurf</span>
<a name="ln-684"></a><span class="c">! real(r64) :: flag</span>
<a name="ln-685"></a>
<a name="ln-686"></a>          <span class="c">! FLOW:</span>
<a name="ln-687"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetUserSuppliedConvectionCoeffs</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-688"></a><span class="k">    CALL </span><span class="n">GetUserConvectionCoefficients</span>
<a name="ln-689"></a>    <span class="n">GetUserSuppliedConvectionCoeffs</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-690"></a>  <span class="n">ENDIF</span>
<a name="ln-691"></a>
<a name="ln-692"></a>  <span class="n">TAir</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutDryBulbTemp</span> <span class="o">+</span> <span class="n">KelvinConv</span>
<a name="ln-693"></a>  <span class="n">TSurf</span> <span class="o">=</span> <span class="n">TempExt</span> <span class="o">+</span> <span class="n">KelvinConv</span>
<a name="ln-694"></a>
<a name="ln-695"></a>  <span class="n">BaseSurf</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span> <span class="c">! If this is a base surface, BaseSurf = SurfNum</span>
<a name="ln-696"></a>
<a name="ln-697"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtWind</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-698"></a><span class="k">    </span><span class="n">SurfWindSpeed</span> <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! No wind exposure</span>
<a name="ln-699"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">==</span> <span class="n">ExtShadeOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-700"></a><span class="k">    </span><span class="n">SurfWindSpeed</span> <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! Assume zero wind speed at outside glass surface of window with exterior shade</span>
<a name="ln-701"></a>  <span class="k">ELSE</span>
<a name="ln-702"></a><span class="k">    </span><span class="n">SurfWindSpeed</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindSpeed</span>
<a name="ln-703"></a>  <span class="n">ENDIF</span>
<a name="ln-704"></a>
<a name="ln-705"></a>  <span class="c">! Check if exterior is to be set by user</span>
<a name="ln-706"></a>  <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtConvCoeff</span><span class="p">)</span>
<a name="ln-707"></a>
<a name="ln-708"></a>    <span class="k">CASE</span><span class="p">(:</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>  <span class="c">! Set by user using one of the standard algorithms...</span>
<a name="ln-709"></a>
<a name="ln-710"></a>      <span class="k">SELECT CASE</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtConvCoeff</span><span class="p">))</span>
<a name="ln-711"></a>
<a name="ln-712"></a>        <span class="k">CASE</span><span class="p">(</span><span class="n">ASHRAESimple</span><span class="p">)</span>
<a name="ln-713"></a>
<a name="ln-714"></a>          <span class="n">HExt</span> <span class="o">=</span> <span class="n">CalcASHRAESimpExtConvectCoeff</span><span class="p">(</span><span class="n">Roughness</span><span class="p">,</span> <span class="n">SurfWindSpeed</span><span class="p">)</span> <span class="c">! includes radiation to sky, ground, and air</span>
<a name="ln-715"></a>
<a name="ln-716"></a>        <span class="k">CASE</span><span class="p">(</span><span class="n">ASHRAETARP</span><span class="p">,</span> <span class="n">BLASTHcOutside</span><span class="p">,</span> <span class="n">TarpHcOutside</span><span class="p">)</span>
<a name="ln-717"></a>          <span class="c">!   Convection is split into forced and natural components. The total</span>
<a name="ln-718"></a>          <span class="c">!   convective heat transfer coefficient is the sum of these components.</span>
<a name="ln-719"></a>          <span class="c">!</span>
<a name="ln-720"></a>          <span class="c">!   Coefficients for subsurfaces are handled in a special way.  The values for perimeter and gross area</span>
<a name="ln-721"></a>          <span class="c">!   are actually referencing the base surface because a subsurface does not initiate a completely new</span>
<a name="ln-722"></a>          <span class="c">!   thermal boundary layer (although it may add some additional complexity that cannot be accounted for</span>
<a name="ln-723"></a>          <span class="c">!   here).  The values for height (Z) and roughness do, however, come from the subsurface.</span>
<a name="ln-724"></a>          <span class="c">!</span>
<a name="ln-725"></a>          <span class="c">!   BLAST algorithm has been replaced by this one since it was identical except for the standard wind</span>
<a name="ln-726"></a>          <span class="c">!   speed measurement height which was only different because of unit conversions:  10 m vs. 30 ft (= 9.14 m).</span>
<a name="ln-727"></a>          <span class="c">!</span>
<a name="ln-728"></a>          <span class="c">!   ASHRAE/BLAST REFERENCES:</span>
<a name="ln-729"></a>          <span class="c">!   ?</span>
<a name="ln-730"></a>          <span class="c">!</span>
<a name="ln-731"></a>          <span class="c">!   TARP REFERENCES:</span>
<a name="ln-732"></a>          <span class="c">!   Walton, G. N.  1983.  Thermal Analysis Research Program Reference Manual.</span>
<a name="ln-733"></a>          <span class="c">!   National Bureau of Standards.  NBSSIR 83-2655.</span>
<a name="ln-734"></a>
<a name="ln-735"></a>          <span class="c">! due to outlying calculations when perimeter is very small compared to area, use Perimeter</span>
<a name="ln-736"></a>          <span class="c">! approximation calculation</span>
<a name="ln-737"></a>
<a name="ln-738"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">GrossArea</span> <span class="o">/=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">Height</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-739"></a><span class="k">            </span><span class="n">rCalcPerimeter</span> <span class="o">=</span> <span class="mf">2.0d0</span>  <span class="o">*</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">GrossArea</span> <span class="o">/</span> <span class="n">Surface</span><span class="p">(</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">Height</span> <span class="o">+</span> <span class="n">Surface</span><span class="p">(</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">Height</span><span class="p">)</span>
<a name="ln-740"></a>            <span class="n">Hf</span> <span class="o">=</span> <span class="n">CalcHfExteriorSparrow</span><span class="p">(</span><span class="n">SurfWindSpeed</span><span class="p">,</span> <span class="n">Surface</span><span class="p">(</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">GrossArea</span><span class="p">,</span> <span class="n">rCalcPerimeter</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-741"></a>              <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="p">,</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="p">,</span> <span class="n">Roughness</span><span class="p">,</span> <span class="n">WindDir</span><span class="p">)</span>
<a name="ln-742"></a>          <span class="k">ELSE</span>
<a name="ln-743"></a><span class="k">            </span><span class="n">Hf</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-744"></a>          <span class="n">ENDIF</span>
<a name="ln-745"></a>
<a name="ln-746"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">HMovInsul</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">TSurf</span> <span class="o">=</span> <span class="p">(</span><span class="n">HMovInsul</span> <span class="o">*</span> <span class="n">TSurf</span> <span class="o">+</span> <span class="n">Hf</span> <span class="o">*</span> <span class="n">TAir</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">HMovInsul</span> <span class="o">+</span> <span class="n">Hf</span><span class="p">)</span>
<a name="ln-747"></a>          <span class="n">Hn</span> <span class="o">=</span> <span class="n">CalcHnASHRAETARPExterior</span><span class="p">(</span><span class="n">TSurf</span><span class="p">,</span><span class="n">TAir</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="p">)</span>
<a name="ln-748"></a>          <span class="n">HExt</span> <span class="o">=</span> <span class="n">Hn</span> <span class="o">+</span> <span class="n">Hf</span>
<a name="ln-749"></a>
<a name="ln-750"></a>        <span class="k">CASE</span><span class="p">(</span><span class="n">MoWiTTHcOutside</span><span class="p">)</span>
<a name="ln-751"></a>          <span class="c">!   The MoWiTT model is based on measurements taken at the Mobile Window</span>
<a name="ln-752"></a>          <span class="c">!   Thermal Test (MoWiTT) facility.  Appropriate for very smooth surfaces.</span>
<a name="ln-753"></a>          <span class="c">!</span>
<a name="ln-754"></a>          <span class="c">!   REFERENCES:</span>
<a name="ln-755"></a>          <span class="c">!   Yazdanian, M. and J.H. Klems.  1994.  Measurement of the exterior convective</span>
<a name="ln-756"></a>          <span class="c">!   film coefficient for windows in low-rise buildings.</span>
<a name="ln-757"></a>          <span class="c">!   ASHRAE Transactions 100(1):  1087.</span>
<a name="ln-758"></a>
<a name="ln-759"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Windward</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="p">,</span> <span class="n">WindDir</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-760"></a><span class="k">           </span><span class="n">ConstantA</span> <span class="o">=</span> <span class="mf">3.26d0</span>
<a name="ln-761"></a>           <span class="n">ConstantB</span> <span class="o">=</span> <span class="mf">0.89d0</span>
<a name="ln-762"></a>          <span class="k">ELSE</span> <span class="c">! leeward</span>
<a name="ln-763"></a>           <span class="n">ConstantA</span> <span class="o">=</span> <span class="mf">3.55d0</span>
<a name="ln-764"></a>           <span class="n">ConstantB</span> <span class="o">=</span> <span class="mf">0.617d0</span>
<a name="ln-765"></a>          <span class="k">END IF</span>
<a name="ln-766"></a>
<a name="ln-767"></a>          <span class="c">! NOTE: Movable insulation is not taken into account here</span>
<a name="ln-768"></a>          <span class="n">HExt</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">((</span><span class="n">MoWiTTTurbulentConstant</span> <span class="o">*</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">TAir</span><span class="o">-</span><span class="n">TSurf</span><span class="p">))</span><span class="o">**</span> <span class="n">OneThird</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="p">&amp;</span>
<a name="ln-769"></a>                         <span class="o">+</span><span class="p">(</span><span class="n">ConstantA</span> <span class="o">*</span> <span class="n">SurfWindSpeed</span> <span class="o">**</span> <span class="n">ConstantB</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<a name="ln-770"></a>
<a name="ln-771"></a>        <span class="k">CASE</span><span class="p">(</span><span class="n">DOE2HcOutside</span><span class="p">)</span>
<a name="ln-772"></a>          <span class="c">!   The DOE-2 convection model is a combination of the MoWiTT and the BLAST</span>
<a name="ln-773"></a>          <span class="c">!   convection models. However, it calculates the coefficient for very smooth</span>
<a name="ln-774"></a>          <span class="c">!   surfaces (glass) first and then modified for other surfaces.</span>
<a name="ln-775"></a>          <span class="c">!</span>
<a name="ln-776"></a>          <span class="c">!   REFERENCES:</span>
<a name="ln-777"></a>          <span class="c">!   Lawrence Berkeley Laboratory.  1994.  DOE2.1E-053 source code.</span>
<a name="ln-778"></a>
<a name="ln-779"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Windward</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="p">,</span> <span class="n">WindDir</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-780"></a><span class="k">            </span><span class="n">ConstantA</span> <span class="o">=</span> <span class="mf">3.26d0</span>
<a name="ln-781"></a>            <span class="n">ConstantB</span> <span class="o">=</span> <span class="mf">0.89d0</span>
<a name="ln-782"></a>          <span class="k">ELSE</span> <span class="c">! leeward</span>
<a name="ln-783"></a>            <span class="n">ConstantA</span> <span class="o">=</span> <span class="mf">3.55d0</span>
<a name="ln-784"></a>            <span class="n">ConstantB</span> <span class="o">=</span> <span class="mf">0.617d0</span>
<a name="ln-785"></a>          <span class="k">END IF</span>
<a name="ln-786"></a>
<a name="ln-787"></a><span class="k">          </span><span class="n">Hn</span> <span class="o">=</span> <span class="n">CalcHnASHRAETARPExterior</span><span class="p">(</span><span class="n">TSurf</span><span class="p">,</span><span class="n">TAir</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="p">)</span>
<a name="ln-788"></a>          <span class="n">HcGlass</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="n">Hn</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">ConstantA</span> <span class="o">*</span> <span class="n">SurfWindSpeed</span> <span class="o">**</span> <span class="n">ConstantB</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-789"></a>          <span class="n">Hf</span> <span class="o">=</span> <span class="n">RoughnessMultiplier</span><span class="p">(</span><span class="n">Roughness</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">HcGlass</span> <span class="o">-</span> <span class="n">Hn</span><span class="p">)</span>
<a name="ln-790"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">HMovInsul</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-791"></a><span class="k">            </span><span class="n">TSurf</span> <span class="o">=</span> <span class="p">(</span><span class="n">HMovInsul</span> <span class="o">*</span> <span class="n">TSurf</span> <span class="o">+</span> <span class="n">Hf</span> <span class="o">*</span> <span class="n">TAir</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">HMovInsul</span> <span class="o">+</span> <span class="n">Hf</span><span class="p">)</span>
<a name="ln-792"></a>            <span class="n">Hn</span> <span class="o">=</span> <span class="n">CalcHnASHRAETARPExterior</span><span class="p">(</span><span class="n">TSurf</span><span class="p">,</span><span class="n">TAir</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="p">)</span>
<a name="ln-793"></a>            <span class="c">! Better if there was iteration for movable insulation?</span>
<a name="ln-794"></a>          <span class="k">END IF</span>
<a name="ln-795"></a>
<a name="ln-796"></a><span class="k">          </span><span class="n">HExt</span> <span class="o">=</span> <span class="n">Hn</span> <span class="o">+</span> <span class="n">Hf</span>
<a name="ln-797"></a>
<a name="ln-798"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">AdaptiveConvectionAlgorithm</span><span class="p">)</span>
<a name="ln-799"></a>
<a name="ln-800"></a>          <span class="k">CALL </span><span class="n">ManageOutsideAdaptiveConvectionAlgo</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span> <span class="n">HExt</span><span class="p">)</span>
<a name="ln-801"></a>
<a name="ln-802"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-803"></a>          <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;InitExtConvection Coefficients: invalid parameter -- outside convection type, Surface=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-804"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-805"></a>
<a name="ln-806"></a>       <span class="k">END SELECT</span>  <span class="c">! choice of algorithm type</span>
<a name="ln-807"></a>
<a name="ln-808"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">EMSOverrideExtConvCoef</span><span class="p">)</span> <span class="n">HExt</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">EMSValueForExtConvCoef</span>
<a name="ln-809"></a>
<a name="ln-810"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">TSurf</span> <span class="o">==</span> <span class="n">SkyTempKelvin</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtConvCoeff</span><span class="p">)</span> <span class="o">==</span> <span class="n">ASHRAESimple</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-811"></a><span class="k">         </span><span class="n">HSky</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-812"></a>       <span class="k">ELSE</span>
<a name="ln-813"></a>         <span class="c">! Compute sky radiation coefficient</span>
<a name="ln-814"></a>         <span class="n">HSky</span> <span class="o">=</span> <span class="n">StefanBoltzmann</span><span class="o">*</span><span class="n">AbsExt</span><span class="o">*</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorSkyIR</span> <span class="p">&amp;</span>
<a name="ln-815"></a>           <span class="o">*</span><span class="n">AirSkyRadSplit</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="n">TSurf</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">SkyTempKelvin</span><span class="o">**</span><span class="mi">4</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">TSurf</span><span class="o">-</span><span class="n">SkyTempKelvin</span><span class="p">)</span>
<a name="ln-816"></a>       <span class="k">END IF</span>
<a name="ln-817"></a>
<a name="ln-818"></a><span class="k">       IF</span> <span class="p">(</span><span class="n">TSurf</span> <span class="o">==</span> <span class="n">TAir</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtConvCoeff</span><span class="p">)</span> <span class="o">==</span> <span class="n">ASHRAESimple</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-819"></a><span class="k">         </span><span class="n">HGround</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-820"></a>         <span class="n">HAir</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-821"></a>       <span class="k">ELSE</span>
<a name="ln-822"></a>         <span class="c">! Compute ground radiation coefficient</span>
<a name="ln-823"></a>         <span class="n">HGround</span> <span class="o">=</span> <span class="n">StefanBoltzmann</span><span class="o">*</span><span class="n">AbsExt</span><span class="o">*</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorGroundIR</span> <span class="p">&amp;</span>
<a name="ln-824"></a>           <span class="o">*</span><span class="p">((</span><span class="n">TSurf</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">TAir</span><span class="o">**</span><span class="mi">4</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">TSurf</span><span class="o">-</span><span class="n">TAir</span><span class="p">)</span>
<a name="ln-825"></a>
<a name="ln-826"></a>         <span class="c">! Compute air radiation coefficient</span>
<a name="ln-827"></a>         <span class="n">HAir</span> <span class="o">=</span> <span class="n">StefanBoltzmann</span><span class="o">*</span><span class="n">AbsExt</span><span class="o">*</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorSkyIR</span> <span class="p">&amp;</span>
<a name="ln-828"></a>           <span class="o">*</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">AirSkyRadSplit</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">))</span><span class="o">*</span><span class="p">((</span><span class="n">TSurf</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">TAir</span><span class="o">**</span><span class="mi">4</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">TSurf</span><span class="o">-</span><span class="n">TAir</span><span class="p">)</span>
<a name="ln-829"></a>       <span class="k">END IF</span>
<a name="ln-830"></a>
<a name="ln-831"></a><span class="k">    CASE</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c">! Not set by user  -- uses Zone setting</span>
<a name="ln-832"></a>
<a name="ln-833"></a>      <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)%</span><span class="n">OutsideConvectionAlgo</span><span class="p">)</span>  <span class="c">! Algorithm type</span>
<a name="ln-834"></a>
<a name="ln-835"></a>        <span class="k">CASE</span><span class="p">(</span><span class="n">ASHRAESimple</span><span class="p">)</span>
<a name="ln-836"></a>
<a name="ln-837"></a>          <span class="n">HExt</span> <span class="o">=</span> <span class="n">CalcASHRAESimpExtConvectCoeff</span><span class="p">(</span><span class="n">Roughness</span><span class="p">,</span> <span class="n">SurfWindSpeed</span><span class="p">)</span> <span class="c">! includes radiation to sky, ground, and air</span>
<a name="ln-838"></a>
<a name="ln-839"></a>        <span class="k">CASE</span><span class="p">(</span><span class="n">ASHRAETARP</span><span class="p">,</span> <span class="n">BLASTHcOutside</span><span class="p">,</span> <span class="n">TarpHcOutside</span><span class="p">)</span>
<a name="ln-840"></a>          <span class="c">!   Convection is split into forced and natural components. The total</span>
<a name="ln-841"></a>          <span class="c">!   convective heat transfer coefficient is the sum of these components.</span>
<a name="ln-842"></a>          <span class="c">!</span>
<a name="ln-843"></a>          <span class="c">!   Coefficients for subsurfaces are handled in a special way.  The values for perimeter and gross area</span>
<a name="ln-844"></a>          <span class="c">!   are actually referencing the base surface because a subsurface does not initiate a completely new</span>
<a name="ln-845"></a>          <span class="c">!   thermal boundary layer (although it may add some additional complexity that cannot be accounted for</span>
<a name="ln-846"></a>          <span class="c">!   here).  The values for height (Z) and roughness do, however, come from the subsurface.</span>
<a name="ln-847"></a>          <span class="c">!</span>
<a name="ln-848"></a>          <span class="c">!   BLAST algorithm has been replaced by this one since it was identical except for the standard wind</span>
<a name="ln-849"></a>          <span class="c">!   speed measurement height which was only different because of unit conversions:  10 m vs. 30 ft (= 9.14 m).</span>
<a name="ln-850"></a>          <span class="c">!</span>
<a name="ln-851"></a>          <span class="c">!   ASHRAE/BLAST REFERENCES:</span>
<a name="ln-852"></a>          <span class="c">!   ?</span>
<a name="ln-853"></a>          <span class="c">!</span>
<a name="ln-854"></a>          <span class="c">!   TARP REFERENCES:</span>
<a name="ln-855"></a>          <span class="c">!   Walton, G. N.  1983.  Thermal Analysis Research Program Reference Manual.</span>
<a name="ln-856"></a>          <span class="c">!   National Bureau of Standards.  NBSSIR 83-2655.</span>
<a name="ln-857"></a>
<a name="ln-858"></a>          <span class="c">! due to outlying calculations when perimeter is very small compared to area, use Perimeter</span>
<a name="ln-859"></a>          <span class="c">! approximation calculation</span>
<a name="ln-860"></a>
<a name="ln-861"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">GrossArea</span> <span class="o">/=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">Height</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-862"></a><span class="k">            </span><span class="n">rCalcPerimeter</span> <span class="o">=</span> <span class="mf">2.0d0</span>  <span class="o">*</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">GrossArea</span> <span class="o">/</span> <span class="n">Surface</span><span class="p">(</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">Height</span> <span class="o">+</span> <span class="n">Surface</span><span class="p">(</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">Height</span><span class="p">)</span>
<a name="ln-863"></a>            <span class="n">Hf</span> <span class="o">=</span> <span class="n">CalcHfExteriorSparrow</span><span class="p">(</span><span class="n">SurfWindSpeed</span><span class="p">,</span> <span class="n">Surface</span><span class="p">(</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">GrossArea</span><span class="p">,</span> <span class="n">rCalcPerimeter</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-864"></a>              <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="p">,</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="p">,</span> <span class="n">Roughness</span><span class="p">,</span> <span class="n">WindDir</span><span class="p">)</span>
<a name="ln-865"></a>          <span class="k">ELSE</span>
<a name="ln-866"></a><span class="k">            </span><span class="n">Hf</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-867"></a>          <span class="n">ENDIF</span>
<a name="ln-868"></a>
<a name="ln-869"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">HMovInsul</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">TSurf</span> <span class="o">=</span> <span class="p">(</span><span class="n">HMovInsul</span> <span class="o">*</span> <span class="n">TSurf</span> <span class="o">+</span> <span class="n">Hf</span> <span class="o">*</span> <span class="n">TAir</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">HMovInsul</span> <span class="o">+</span> <span class="n">Hf</span><span class="p">)</span>
<a name="ln-870"></a>          <span class="n">Hn</span> <span class="o">=</span> <span class="n">CalcHnASHRAETARPExterior</span><span class="p">(</span><span class="n">TSurf</span><span class="p">,</span><span class="n">TAir</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="p">)</span>
<a name="ln-871"></a>          <span class="n">HExt</span> <span class="o">=</span> <span class="n">Hn</span> <span class="o">+</span> <span class="n">Hf</span>
<a name="ln-872"></a>
<a name="ln-873"></a>        <span class="k">CASE</span><span class="p">(</span><span class="n">MoWiTTHcOutside</span><span class="p">)</span>
<a name="ln-874"></a>          <span class="c">!   The MoWiTT model is based on measurements taken at the Mobile Window</span>
<a name="ln-875"></a>          <span class="c">!   Thermal Test (MoWiTT) facility.  Appropriate for very smooth surfaces.</span>
<a name="ln-876"></a>          <span class="c">!</span>
<a name="ln-877"></a>          <span class="c">!   REFERENCES:</span>
<a name="ln-878"></a>          <span class="c">!   Yazdanian, M. and J.H. Klems.  1994.  Measurement of the exterior convective</span>
<a name="ln-879"></a>          <span class="c">!   film coefficient for windows in low-rise buildings.</span>
<a name="ln-880"></a>          <span class="c">!   ASHRAE Transactions 100(1):  1087.</span>
<a name="ln-881"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Windward</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="p">,</span> <span class="n">WindDir</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-882"></a><span class="k">           </span><span class="n">ConstantA</span> <span class="o">=</span> <span class="mf">3.26d0</span>
<a name="ln-883"></a>           <span class="n">ConstantB</span> <span class="o">=</span> <span class="mf">0.89d0</span>
<a name="ln-884"></a>          <span class="k">ELSE</span> <span class="c">! leeward</span>
<a name="ln-885"></a>           <span class="n">ConstantA</span> <span class="o">=</span> <span class="mf">3.55d0</span>
<a name="ln-886"></a>           <span class="n">ConstantB</span> <span class="o">=</span> <span class="mf">0.617d0</span>
<a name="ln-887"></a>          <span class="k">END IF</span>
<a name="ln-888"></a>
<a name="ln-889"></a>          <span class="c">! NOTE: Movable insulation is not taken into account here</span>
<a name="ln-890"></a>          <span class="n">HExt</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">((</span><span class="n">MoWiTTTurbulentConstant</span> <span class="o">*</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">TAir</span><span class="o">-</span><span class="n">TSurf</span><span class="p">))</span><span class="o">**</span> <span class="n">OneThird</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="p">&amp;</span>
<a name="ln-891"></a>                         <span class="o">+</span><span class="p">(</span><span class="n">ConstantA</span> <span class="o">*</span> <span class="n">SurfWindSpeed</span> <span class="o">**</span> <span class="n">ConstantB</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<a name="ln-892"></a>
<a name="ln-893"></a>        <span class="k">CASE</span><span class="p">(</span><span class="n">DOE2HcOutside</span><span class="p">)</span>
<a name="ln-894"></a>          <span class="c">!   The DOE-2 convection model is a combination of the MoWiTT and the BLAST</span>
<a name="ln-895"></a>          <span class="c">!   convection models. However, it calculates the coefficient for very smooth</span>
<a name="ln-896"></a>          <span class="c">!   surfaces (glass) first and then modified for other surfaces.</span>
<a name="ln-897"></a>          <span class="c">!</span>
<a name="ln-898"></a>          <span class="c">!   REFERENCES:</span>
<a name="ln-899"></a>          <span class="c">!   Lawrence Berkeley Laboratory.  1994.  DOE2.1E-053 source code.</span>
<a name="ln-900"></a>
<a name="ln-901"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Windward</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="p">,</span> <span class="n">WindDir</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-902"></a><span class="k">            </span><span class="n">ConstantA</span> <span class="o">=</span> <span class="mf">3.26d0</span>
<a name="ln-903"></a>            <span class="n">ConstantB</span> <span class="o">=</span> <span class="mf">0.89d0</span>
<a name="ln-904"></a>          <span class="k">ELSE</span> <span class="c">! leeward</span>
<a name="ln-905"></a>            <span class="n">ConstantA</span> <span class="o">=</span> <span class="mf">3.55d0</span>
<a name="ln-906"></a>            <span class="n">ConstantB</span> <span class="o">=</span> <span class="mf">0.617d0</span>
<a name="ln-907"></a>          <span class="k">END IF</span>
<a name="ln-908"></a>
<a name="ln-909"></a><span class="k">          </span><span class="n">Hn</span> <span class="o">=</span> <span class="n">CalcHnASHRAETARPExterior</span><span class="p">(</span><span class="n">TSurf</span><span class="p">,</span><span class="n">TAir</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="p">)</span>
<a name="ln-910"></a>          <span class="n">HcGlass</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="n">Hn</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">ConstantA</span> <span class="o">*</span> <span class="n">SurfWindSpeed</span> <span class="o">**</span> <span class="n">ConstantB</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-911"></a>          <span class="n">Hf</span> <span class="o">=</span> <span class="n">RoughnessMultiplier</span><span class="p">(</span><span class="n">Roughness</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">HcGlass</span> <span class="o">-</span> <span class="n">Hn</span><span class="p">)</span>
<a name="ln-912"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">HMovInsul</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-913"></a><span class="k">            </span><span class="n">TSurf</span> <span class="o">=</span> <span class="p">(</span><span class="n">HMovInsul</span> <span class="o">*</span> <span class="n">TSurf</span> <span class="o">+</span> <span class="n">Hf</span> <span class="o">*</span> <span class="n">TAir</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">HMovInsul</span> <span class="o">+</span> <span class="n">Hf</span><span class="p">)</span>
<a name="ln-914"></a>            <span class="n">Hn</span> <span class="o">=</span> <span class="n">CalcHnASHRAETARPExterior</span><span class="p">(</span><span class="n">TSurf</span><span class="p">,</span><span class="n">TAir</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="p">)</span>
<a name="ln-915"></a>            <span class="c">! Better if there was iteration for movable insulation?</span>
<a name="ln-916"></a>          <span class="k">END IF</span>
<a name="ln-917"></a>
<a name="ln-918"></a><span class="k">          </span><span class="n">HExt</span> <span class="o">=</span> <span class="n">Hn</span> <span class="o">+</span> <span class="n">Hf</span>
<a name="ln-919"></a>
<a name="ln-920"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">AdaptiveConvectionAlgorithm</span><span class="p">)</span>
<a name="ln-921"></a>
<a name="ln-922"></a>          <span class="k">CALL </span><span class="n">ManageOutsideAdaptiveConvectionAlgo</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span> <span class="n">HExt</span><span class="p">)</span>
<a name="ln-923"></a>
<a name="ln-924"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-925"></a>          <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;InitExtConvection Coefficients: invalid parameter -- outside convection type, Surface=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-926"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-927"></a>
<a name="ln-928"></a>       <span class="k">END SELECT</span>  <span class="c">! choice of algorithm type</span>
<a name="ln-929"></a>
<a name="ln-930"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">EMSOverrideExtConvCoef</span><span class="p">)</span> <span class="n">HExt</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">EMSValueForExtConvCoef</span>
<a name="ln-931"></a>
<a name="ln-932"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">TSurf</span> <span class="o">==</span> <span class="n">SkyTempKelvin</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Zone</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)%</span><span class="n">OutsideConvectionAlgo</span> <span class="o">==</span> <span class="n">ASHRAESimple</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-933"></a><span class="k">         </span><span class="n">HSky</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-934"></a>       <span class="k">ELSE</span>
<a name="ln-935"></a>         <span class="c">! Compute sky radiation coefficient</span>
<a name="ln-936"></a>         <span class="n">HSky</span> <span class="o">=</span> <span class="n">StefanBoltzmann</span><span class="o">*</span><span class="n">AbsExt</span><span class="o">*</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorSkyIR</span> <span class="p">&amp;</span>
<a name="ln-937"></a>           <span class="o">*</span><span class="n">AirSkyRadSplit</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="n">TSurf</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">SkyTempKelvin</span><span class="o">**</span><span class="mi">4</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">TSurf</span><span class="o">-</span><span class="n">SkyTempKelvin</span><span class="p">)</span>
<a name="ln-938"></a>       <span class="k">END IF</span>
<a name="ln-939"></a>
<a name="ln-940"></a><span class="k">       IF</span> <span class="p">(</span><span class="n">TSurf</span> <span class="o">==</span> <span class="n">TAir</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Zone</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)%</span><span class="n">OutsideConvectionAlgo</span> <span class="o">==</span> <span class="n">ASHRAESimple</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-941"></a><span class="k">         </span><span class="n">HGround</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-942"></a>         <span class="n">HAir</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-943"></a>       <span class="k">ELSE</span>
<a name="ln-944"></a>         <span class="c">! Compute ground radiation coefficient</span>
<a name="ln-945"></a>         <span class="n">HGround</span> <span class="o">=</span> <span class="n">StefanBoltzmann</span><span class="o">*</span><span class="n">AbsExt</span><span class="o">*</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorGroundIR</span> <span class="p">&amp;</span>
<a name="ln-946"></a>           <span class="o">*</span><span class="p">((</span><span class="n">TSurf</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">TAir</span><span class="o">**</span><span class="mi">4</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">TSurf</span><span class="o">-</span><span class="n">TAir</span><span class="p">)</span>
<a name="ln-947"></a>
<a name="ln-948"></a>         <span class="c">! Compute air radiation coefficient</span>
<a name="ln-949"></a>         <span class="n">HAir</span> <span class="o">=</span> <span class="n">StefanBoltzmann</span><span class="o">*</span><span class="n">AbsExt</span><span class="o">*</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorSkyIR</span> <span class="p">&amp;</span>
<a name="ln-950"></a>           <span class="o">*</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">AirSkyRadSplit</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">))</span><span class="o">*</span><span class="p">((</span><span class="n">TSurf</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">TAir</span><span class="o">**</span><span class="mi">4</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">TSurf</span><span class="o">-</span><span class="n">TAir</span><span class="p">)</span>
<a name="ln-951"></a>       <span class="k">END IF</span>
<a name="ln-952"></a>
<a name="ln-953"></a><span class="k">    CASE </span><span class="n">DEFAULT</span>  <span class="c">! Exterior convection scheme for this surface has been set by user</span>
<a name="ln-954"></a>
<a name="ln-955"></a>      <span class="n">HExt</span> <span class="o">=</span> <span class="n">SetExtConvectionCoeff</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-956"></a>
<a name="ln-957"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">EMSOverrideExtConvCoef</span><span class="p">)</span> <span class="n">HExt</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">EMSValueForExtConvCoef</span>
<a name="ln-958"></a>
<a name="ln-959"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TSurf</span> <span class="o">==</span> <span class="n">SkyTempKelvin</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Zone</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)%</span><span class="n">OutsideConvectionAlgo</span> <span class="o">==</span> <span class="n">ASHRAESimple</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-960"></a><span class="k">        </span><span class="n">HSky</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-961"></a>      <span class="k">ELSE</span>
<a name="ln-962"></a>        <span class="c">! Compute sky radiation coefficient</span>
<a name="ln-963"></a>        <span class="n">HSky</span> <span class="o">=</span> <span class="n">StefanBoltzmann</span><span class="o">*</span><span class="n">AbsExt</span><span class="o">*</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorSkyIR</span> <span class="p">&amp;</span>
<a name="ln-964"></a>          <span class="o">*</span><span class="n">AirSkyRadSplit</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="n">TSurf</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">SkyTempKelvin</span><span class="o">**</span><span class="mi">4</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">TSurf</span><span class="o">-</span><span class="n">SkyTempKelvin</span><span class="p">)</span>
<a name="ln-965"></a>      <span class="k">END IF</span>
<a name="ln-966"></a>
<a name="ln-967"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">TSurf</span> <span class="o">==</span> <span class="n">TAir</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Zone</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)%</span><span class="n">OutsideConvectionAlgo</span> <span class="o">==</span> <span class="n">ASHRAESimple</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-968"></a><span class="k">        </span><span class="n">HGround</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-969"></a>        <span class="n">HAir</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-970"></a>      <span class="k">ELSE</span>
<a name="ln-971"></a>        <span class="c">! Compute ground radiation coefficient</span>
<a name="ln-972"></a>        <span class="n">HGround</span> <span class="o">=</span> <span class="n">StefanBoltzmann</span><span class="o">*</span><span class="n">AbsExt</span><span class="o">*</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorGroundIR</span> <span class="p">&amp;</span>
<a name="ln-973"></a>          <span class="o">*</span><span class="p">((</span><span class="n">TSurf</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">TAir</span><span class="o">**</span><span class="mi">4</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">TSurf</span><span class="o">-</span><span class="n">TAir</span><span class="p">)</span>
<a name="ln-974"></a>
<a name="ln-975"></a>        <span class="c">! Compute air radiation coefficient</span>
<a name="ln-976"></a>        <span class="n">HAir</span> <span class="o">=</span> <span class="n">StefanBoltzmann</span><span class="o">*</span><span class="n">AbsExt</span><span class="o">*</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorSkyIR</span> <span class="p">&amp;</span>
<a name="ln-977"></a>          <span class="o">*</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">AirSkyRadSplit</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">))</span><span class="o">*</span><span class="p">((</span><span class="n">TSurf</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">TAir</span><span class="o">**</span><span class="mi">4</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">TSurf</span><span class="o">-</span><span class="n">TAir</span><span class="p">)</span>
<a name="ln-978"></a>      <span class="k">END IF</span>
<a name="ln-979"></a>
<a name="ln-980"></a><span class="k">  END SELECT</span>
<a name="ln-981"></a>
<a name="ln-982"></a><span class="k">  RETURN</span>
<a name="ln-983"></a>
<a name="ln-984"></a><span class="k">END SUBROUTINE </span><span class="n">InitExteriorConvectionCoeff</span>
<a name="ln-985"></a>
<a name="ln-986"></a>
<a name="ln-987"></a><span class="k">FUNCTION </span><span class="n">CalcHfExteriorSparrow</span><span class="p">(</span><span class="n">SurfWindSpeed</span><span class="p">,</span> <span class="n">GrossArea</span><span class="p">,</span> <span class="n">Perimeter</span><span class="p">,</span> <span class="n">CosTilt</span><span class="p">,</span> <span class="n">Azimuth</span><span class="p">,</span> <span class="n">Roughness</span><span class="p">,</span> <span class="n">WindDirection</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-988"></a>                        <span class="k">RESULT</span> <span class="p">(</span><span class="n">Hf</span><span class="p">)</span>
<a name="ln-989"></a>
<a name="ln-990"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-991"></a>          <span class="c">!       AUTHOR         Linda K. Lawrie</span>
<a name="ln-992"></a>          <span class="c">!       DATE WRITTEN   September 2003</span>
<a name="ln-993"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-994"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-995"></a>
<a name="ln-996"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-997"></a>          <span class="c">! This function returns the forced convection piece of the</span>
<a name="ln-998"></a>          <span class="c">! exterior convection coefficient.</span>
<a name="ln-999"></a>
<a name="ln-1000"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1001"></a>          <span class="c">! The forced convection calculation is based on a semi-empirical correlation</span>
<a name="ln-1002"></a>          <span class="c">! developed by Sparrow, Ramsey, and Mass.</span>
<a name="ln-1003"></a>
<a name="ln-1004"></a>
<a name="ln-1005"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1006"></a>          <span class="c">!   1. Sparrow, E. M., J. W. Ramsey, and E. A. Mass.  1979.  Effect of finite</span>
<a name="ln-1007"></a>          <span class="c">!   width on heat transfer and fluid flow about an inclined rectangular plate.</span>
<a name="ln-1008"></a>          <span class="c">!   Journal of Heat Transfer 101:  204.</span>
<a name="ln-1009"></a>          <span class="c">!   2. McClellan, T.M.  1996.  Investigation of a heat balance cooling load</span>
<a name="ln-1010"></a>          <span class="c">!   procedure with a detailed study of outside heat transfer parameters.</span>
<a name="ln-1011"></a>          <span class="c">!   M.S. Thesis, Department of Mechanical and Industrial Engineering,</span>
<a name="ln-1012"></a>          <span class="c">!   University of Illinois at Urbana-Champaign.</span>
<a name="ln-1013"></a>          <span class="c">!   3. ASHRAE Loads Toolkit.</span>
<a name="ln-1014"></a>
<a name="ln-1015"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1016"></a>          <span class="c">! na</span>
<a name="ln-1017"></a>
<a name="ln-1018"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1019"></a>
<a name="ln-1020"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-1021"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">SurfWindSpeed</span>  <span class="c">! Local wind speed at height of the heat transfer surface (m/s)</span>
<a name="ln-1022"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">GrossArea</span>     <span class="c">! Gross surface area {m2}</span>
<a name="ln-1023"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CosTilt</span>       <span class="c">! Cosine of the Surface Tilt Angle</span>
<a name="ln-1024"></a>                                        <span class="c">! (Angle between the ground and the surface outward normal)</span>
<a name="ln-1025"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Azimuth</span>       <span class="c">! Facing angle (degrees) of the surface outward normal</span>
<a name="ln-1026"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Perimeter</span>     <span class="c">! Surface perimeter length {m}</span>
<a name="ln-1027"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Roughness</span>     <span class="c">! Surface roughness index (6=very smooth, 5=smooth, 4=medium smooth,</span>
<a name="ln-1028"></a>                                        <span class="c">! 3=medium rough,2=rough,1=very rough)</span>
<a name="ln-1029"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">WindDirection</span> <span class="c">! Wind (compass) direction (degrees)</span>
<a name="ln-1030"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">Hf</span>            <span class="c">! Surface exterior forced convective heat transfer coefficient, W/(m2-K)</span>
<a name="ln-1031"></a>
<a name="ln-1032"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-1033"></a>          <span class="c">! na</span>
<a name="ln-1034"></a>
<a name="ln-1035"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-1036"></a>          <span class="c">! na</span>
<a name="ln-1037"></a>
<a name="ln-1038"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-1039"></a>          <span class="c">! na</span>
<a name="ln-1040"></a>
<a name="ln-1041"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1042"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WindDirectionModifier</span>
<a name="ln-1043"></a>
<a name="ln-1044"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">Windward</span><span class="p">(</span><span class="n">CosTilt</span><span class="p">,</span><span class="n">Azimuth</span><span class="p">,</span><span class="n">WindDirection</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1045"></a><span class="k">     </span><span class="n">WindDirectionModifier</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-1046"></a>  <span class="k">ELSE</span>
<a name="ln-1047"></a><span class="k">     </span><span class="n">WindDirectionModifier</span> <span class="o">=</span> <span class="mf">0.5d0</span>
<a name="ln-1048"></a>  <span class="k">END IF</span>
<a name="ln-1049"></a>
<a name="ln-1050"></a>
<a name="ln-1051"></a><span class="k">  </span><span class="n">Hf</span> <span class="o">=</span> <span class="mf">2.537d0</span> <span class="o">*</span> <span class="n">WindDirectionModifier</span> <span class="o">*</span> <span class="n">RoughnessMultiplier</span><span class="p">(</span><span class="n">Roughness</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1052"></a>    <span class="o">*</span> <span class="nb">SQRT</span><span class="p">(</span><span class="n">SurfWindSpeed</span> <span class="o">*</span> <span class="n">Perimeter</span> <span class="o">/</span> <span class="n">GrossArea</span><span class="p">)</span>
<a name="ln-1053"></a>
<a name="ln-1054"></a>  <span class="k">RETURN</span>
<a name="ln-1055"></a>
<a name="ln-1056"></a><span class="k">END FUNCTION </span><span class="n">CalcHfExteriorSparrow</span>
<a name="ln-1057"></a>
<a name="ln-1058"></a>
<a name="ln-1059"></a><span class="k">FUNCTION </span><span class="n">CalcHnASHRAETARPExterior</span><span class="p">(</span><span class="n">TOutSurf</span><span class="p">,</span> <span class="n">TAir</span><span class="p">,</span> <span class="n">CosTilt</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">Hn</span><span class="p">)</span>
<a name="ln-1060"></a>
<a name="ln-1061"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-1062"></a>          <span class="c">!       AUTHOR         Linda K. Lawrie</span>
<a name="ln-1063"></a>          <span class="c">!       DATE WRITTEN   September 2003</span>
<a name="ln-1064"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-1065"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1066"></a>
<a name="ln-1067"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-1068"></a>          <span class="c">! This function returns the natural convection piece of the</span>
<a name="ln-1069"></a>          <span class="c">! exterior convection coefficient.</span>
<a name="ln-1070"></a>
<a name="ln-1071"></a>
<a name="ln-1072"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1073"></a>          <span class="c">! Needs description, as appropriate.</span>
<a name="ln-1074"></a>
<a name="ln-1075"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1076"></a>          <span class="c">!   1. ASHRAE.  1993.  ASHRAE Handbook - 1993 Fundamentals.  Atlanta.</span>
<a name="ln-1077"></a>          <span class="c">!   2. McClellan, T.M.  1996.  Investigation of a heat balance cooling load</span>
<a name="ln-1078"></a>          <span class="c">!   procedure with a detailed study of outside heat transfer parameters.</span>
<a name="ln-1079"></a>          <span class="c">!   M.S. Thesis, Department of Mechanical and Industrial Engineering,</span>
<a name="ln-1080"></a>          <span class="c">!   University of Illinois at Urbana-Champaign.</span>
<a name="ln-1081"></a>          <span class="c">!   3. ASHRAE Loads Toolkit</span>
<a name="ln-1082"></a>
<a name="ln-1083"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1084"></a>          <span class="c">! na</span>
<a name="ln-1085"></a>
<a name="ln-1086"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1087"></a>
<a name="ln-1088"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-1089"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">TOutSurf</span> <span class="c">! Exterior surface temperature</span>
<a name="ln-1090"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">TAir</span>     <span class="c">! Outdoor Air temperature</span>
<a name="ln-1091"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CosTilt</span>  <span class="c">! Cosine of the Surface Tilt Angle (Angle between the ground outward normal and</span>
<a name="ln-1092"></a>                                <span class="c">! the surface outward normal)</span>
<a name="ln-1093"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">Hn</span>       <span class="c">! Natural convective heat transfer coefficient,{W/(m2-K)}</span>
<a name="ln-1094"></a>
<a name="ln-1095"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-1096"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">OneThird</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">/</span><span class="mf">3.d0</span><span class="p">)</span>  <span class="c">! 1/3 in highest precision</span>
<a name="ln-1097"></a>
<a name="ln-1098"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-1099"></a>          <span class="c">! na</span>
<a name="ln-1100"></a>
<a name="ln-1101"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-1102"></a>          <span class="c">! na</span>
<a name="ln-1103"></a>
<a name="ln-1104"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1105"></a>          <span class="c">! na</span>
<a name="ln-1106"></a>
<a name="ln-1107"></a>  <span class="c">! Notes: CosTilt &gt; 0 = faces up (roof), CosTilt &lt; 0 = faces down (floor),</span>
<a name="ln-1108"></a>  <span class="c">! CosTilt=0 = vertical surface (wall)</span>
<a name="ln-1109"></a>
<a name="ln-1110"></a>  <span class="n">Hn</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1111"></a>
<a name="ln-1112"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CosTilt</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Vertical Surface</span>
<a name="ln-1113"></a>
<a name="ln-1114"></a>    <span class="n">Hn</span> <span class="o">=</span> <span class="mf">1.31d0</span><span class="o">*</span><span class="p">(</span><span class="nb">ABS</span><span class="p">((</span><span class="n">TOutSurf</span><span class="o">-</span><span class="n">TAir</span><span class="p">))</span><span class="o">**</span><span class="n">OneThird</span><span class="p">)</span>
<a name="ln-1115"></a>
<a name="ln-1116"></a>  <span class="k">ELSE IF</span> <span class="p">(</span> <span class="p">((</span><span class="n">CosTilt</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">TOutSurf</span> <span class="o">&lt;</span> <span class="n">TAir</span><span class="p">))</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1117"></a>           <span class="p">((</span><span class="n">CosTilt</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">TOutSurf</span> <span class="o">&gt;</span> <span class="n">TAir</span><span class="p">))</span> <span class="p">)</span> <span class="k">THEN</span>   <span class="c">! Enhanced convection</span>
<a name="ln-1118"></a>
<a name="ln-1119"></a>    <span class="n">Hn</span> <span class="o">=</span> <span class="mf">9.482d0</span><span class="o">*</span><span class="p">(</span><span class="nb">ABS</span><span class="p">((</span><span class="n">TOutSurf</span><span class="o">-</span><span class="n">TAir</span><span class="p">))</span><span class="o">**</span><span class="n">OneThird</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">7.238d0</span><span class="o">-</span><span class="nb">ABS</span><span class="p">(</span><span class="n">CosTilt</span><span class="p">))</span>
<a name="ln-1120"></a>
<a name="ln-1121"></a>  <span class="k">ELSE IF</span> <span class="p">(</span> <span class="p">((</span><span class="n">CosTilt</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">TOutSurf</span> <span class="o">&gt;</span> <span class="n">TAir</span><span class="p">))</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1122"></a>           <span class="p">((</span><span class="n">CosTilt</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">TOutSurf</span> <span class="o">&lt;</span> <span class="n">TAir</span><span class="p">))</span> <span class="p">)</span> <span class="k">THEN</span>   <span class="c">! Reduced convection</span>
<a name="ln-1123"></a>
<a name="ln-1124"></a>    <span class="n">Hn</span> <span class="o">=</span> <span class="mf">1.810d0</span><span class="o">*</span><span class="p">(</span><span class="nb">ABS</span><span class="p">((</span><span class="n">TOutSurf</span><span class="o">-</span><span class="n">TAir</span><span class="p">))</span><span class="o">**</span><span class="n">OneThird</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.382d0</span><span class="o">+</span><span class="nb">ABS</span><span class="p">(</span><span class="n">CosTilt</span><span class="p">))</span>
<a name="ln-1125"></a>
<a name="ln-1126"></a>  <span class="k">END IF</span>    <span class="c">! Only other condition is TOutSurf=TAir, in which case there is no natural convection part.</span>
<a name="ln-1127"></a>
<a name="ln-1128"></a>  <span class="k">RETURN</span>
<a name="ln-1129"></a>
<a name="ln-1130"></a><span class="k">END FUNCTION </span><span class="n">CalcHnASHRAETARPExterior</span>
<a name="ln-1131"></a>
<a name="ln-1132"></a>
<a name="ln-1133"></a><span class="k">FUNCTION </span><span class="n">Windward</span><span class="p">(</span><span class="n">CosTilt</span><span class="p">,</span> <span class="n">Azimuth</span><span class="p">,</span> <span class="n">WindDirection</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">AgainstWind</span><span class="p">)</span>
<a name="ln-1134"></a>
<a name="ln-1135"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-1136"></a>          <span class="c">!       AUTHOR         Linda K. Lawrie</span>
<a name="ln-1137"></a>          <span class="c">!       DATE WRITTEN   September 2003</span>
<a name="ln-1138"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-1139"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1140"></a>
<a name="ln-1141"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-1142"></a>          <span class="c">! This function determines if a surface is &quot;windward&quot; or &quot;leeward&quot; (that is,</span>
<a name="ln-1143"></a>          <span class="c">! into / against the wind (true) or in shelter from wind (false).</span>
<a name="ln-1144"></a>
<a name="ln-1145"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1146"></a>          <span class="c">! Leeward is defined as greater than 100 degrees from normal incidence.</span>
<a name="ln-1147"></a>          <span class="c">! Note that a sufficiently horizontal surface is always considered windward.</span>
<a name="ln-1148"></a>
<a name="ln-1149"></a>
<a name="ln-1150"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1151"></a>          <span class="c">!   Walton, G. N.  1981.  Passive solar extension of the Building Loads</span>
<a name="ln-1152"></a>          <span class="c">!   Analysis and System Thermodynamics (BLAST) program.  Technical Report,</span>
<a name="ln-1153"></a>          <span class="c">!   United States Army Construction Engineering Research Laboratory,</span>
<a name="ln-1154"></a>          <span class="c">!   Champaign, IL.</span>
<a name="ln-1155"></a>
<a name="ln-1156"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1157"></a>          <span class="c">! na</span>
<a name="ln-1158"></a>
<a name="ln-1159"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1160"></a>
<a name="ln-1161"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-1162"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CosTilt</span>       <span class="c">! Cosine of the surface tilt angle</span>
<a name="ln-1163"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Azimuth</span>       <span class="c">! or Facing, Direction the surface outward normal faces (degrees)</span>
<a name="ln-1164"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WindDirection</span> <span class="c">! Wind direction measured clockwise from geographhic North</span>
<a name="ln-1165"></a>    <span class="kt">LOGICAL</span>          <span class="kd">::</span> <span class="n">AgainstWind</span>   <span class="c">! True for windward, false for leeward.</span>
<a name="ln-1166"></a>
<a name="ln-1167"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-1168"></a>          <span class="c">! na</span>
<a name="ln-1169"></a>
<a name="ln-1170"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-1171"></a>          <span class="c">! na</span>
<a name="ln-1172"></a>
<a name="ln-1173"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-1174"></a>          <span class="c">! na</span>
<a name="ln-1175"></a>
<a name="ln-1176"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1177"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Diff</span> <span class="c">! Difference between the wind direction and the surface azimuth</span>
<a name="ln-1178"></a>
<a name="ln-1179"></a>    <span class="n">AgainstWind</span> <span class="o">=</span> <span class="p">.</span><span class="n">True</span><span class="p">.</span>
<a name="ln-1180"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">CosTilt</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.98d0</span><span class="p">)</span> <span class="k">THEN</span>    <span class="c">! Surface is not horizontal</span>
<a name="ln-1181"></a>       <span class="n">Diff</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">WindDirection</span> <span class="o">-</span> <span class="n">Azimuth</span><span class="p">)</span>
<a name="ln-1182"></a>       <span class="k">IF</span> <span class="p">((</span><span class="n">Diff</span><span class="o">-</span><span class="mi">18</span><span class="mf">0.d0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">.</span><span class="mi">001</span><span class="n">d0</span> <span class="p">)</span> <span class="n">Diff</span>  <span class="o">=</span> <span class="n">Diff</span> <span class="o">-</span> <span class="mi">36</span><span class="mf">0.0d0</span>
<a name="ln-1183"></a>       <span class="k">IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Diff</span><span class="p">)</span><span class="o">-</span><span class="mi">10</span><span class="mf">0.d0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">.</span><span class="mi">001</span><span class="n">d0</span><span class="p">)</span> <span class="n">AgainstWind</span> <span class="o">=</span> <span class="p">.</span><span class="n">False</span><span class="p">.</span> <span class="c">! Surface is leeward</span>
<a name="ln-1184"></a>    <span class="n">ENDIF</span>
<a name="ln-1185"></a>
<a name="ln-1186"></a>  <span class="k">RETURN</span>
<a name="ln-1187"></a>
<a name="ln-1188"></a><span class="k">END FUNCTION </span><span class="n">Windward</span>
<a name="ln-1189"></a>
<a name="ln-1190"></a>
<a name="ln-1191"></a><span class="k">SUBROUTINE </span><span class="n">GetUserConvectionCoefficients</span>
<a name="ln-1192"></a>
<a name="ln-1193"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1194"></a>          <span class="c">!       AUTHOR         Linda K. Lawrie</span>
<a name="ln-1195"></a>          <span class="c">!       DATE WRITTEN   February 2003</span>
<a name="ln-1196"></a>          <span class="c">!       MODIFIED       November 2004; add more &quot;user supplied convection coefficients&quot;</span>
<a name="ln-1197"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1198"></a>
<a name="ln-1199"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1200"></a>          <span class="c">! This subroutine gets the input for the object &quot;Convection Coefficients&quot; which</span>
<a name="ln-1201"></a>          <span class="c">! can be specified by a user to override the &quot;normally&quot; calculated convection coefficients.  The</span>
<a name="ln-1202"></a>          <span class="c">! change (November 2004) allows the user to specify down to the &quot;surface level&quot; the</span>
<a name="ln-1203"></a>          <span class="c">! exterior or interior algorithm to be used.</span>
<a name="ln-1204"></a>
<a name="ln-1205"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1206"></a>          <span class="c">! na</span>
<a name="ln-1207"></a>
<a name="ln-1208"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1209"></a>          <span class="c">! This routine gets the objects:</span>
<a name="ln-1210"></a>          <span class="c">!SurfaceProperty:ConvectionCoefficients,</span>
<a name="ln-1211"></a>          <span class="c">!      \memo Allow user settable interior and/or exterior convection coefficients.</span>
<a name="ln-1212"></a>          <span class="c">!      \memo Note that some other factors may limit the lower bounds for these values, such as</span>
<a name="ln-1213"></a>          <span class="c">!      \memo for windows, the interior convection coefficient must be &gt;.28,</span>
<a name="ln-1214"></a>          <span class="c">!      \memo for trombe wall algorithm selection (zone), the interior convection coefficient must be &gt;.1</span>
<a name="ln-1215"></a>          <span class="c">!      \memo for detailed interior convection, the lower limit is also .1</span>
<a name="ln-1216"></a>          <span class="c">!  A1, \field Surface Name</span>
<a name="ln-1217"></a>          <span class="c">!      \required-field</span>
<a name="ln-1218"></a>          <span class="c">!      \type object-list</span>
<a name="ln-1219"></a>          <span class="c">!      \object-list SurfaceNames</span>
<a name="ln-1220"></a>          <span class="c">!  A2, \field Convection Coefficient 1 Location</span>
<a name="ln-1221"></a>          <span class="c">!      \required-field</span>
<a name="ln-1222"></a>          <span class="c">!      \type choice</span>
<a name="ln-1223"></a>          <span class="c">!      \key Outside</span>
<a name="ln-1224"></a>          <span class="c">!      \key Inside</span>
<a name="ln-1225"></a>          <span class="c">!  A3, \field Convection Coefficient 1 Type</span>
<a name="ln-1226"></a>          <span class="c">!      \required-field</span>
<a name="ln-1227"></a>          <span class="c">!      \type choice</span>
<a name="ln-1228"></a>          <span class="c">!      \key Value</span>
<a name="ln-1229"></a>          <span class="c">!      \key Schedule</span>
<a name="ln-1230"></a>          <span class="c">!      \key Simple</span>
<a name="ln-1231"></a>          <span class="c">!      \key Detailed</span>
<a name="ln-1232"></a>          <span class="c">!      \key BLAST</span>
<a name="ln-1233"></a>          <span class="c">!      \key TARP</span>
<a name="ln-1234"></a>          <span class="c">!      \key DOE-2</span>
<a name="ln-1235"></a>          <span class="c">!      \key MoWitt</span>
<a name="ln-1236"></a>          <span class="c">!  N1, \field Convection Coefficient 1</span>
<a name="ln-1237"></a>          <span class="c">!      \note used if Convection Value Type=value, then minimum must be &gt; 0.0, Maximum &lt;= 1000.</span>
<a name="ln-1238"></a>          <span class="c">!      \units W/m2-K</span>
<a name="ln-1239"></a>          <span class="c">!  A4, \field Convection Coefficient 1 Schedule Name</span>
<a name="ln-1240"></a>          <span class="c">!       \note used if Convection Value Type=Schedule Name</span>
<a name="ln-1241"></a>          <span class="c">!       \type object-list</span>
<a name="ln-1242"></a>          <span class="c">!       \object-list ScheduleNames</span>
<a name="ln-1243"></a>          <span class="c">!   &lt; Remainder fields are a repeat of A2, A3, N1, A4&gt;</span>
<a name="ln-1244"></a>          <span class="c">!</span>
<a name="ln-1245"></a>          <span class="c">!SurfaceProperty:ConvectionCoefficients:MultipleSurface,</span>
<a name="ln-1246"></a>          <span class="c">!      \memo Allow user settable interior and/or exterior convection coefficients.</span>
<a name="ln-1247"></a>          <span class="c">!      \memo Note that some other factors may limit the lower bounds for these values, such as</span>
<a name="ln-1248"></a>          <span class="c">!      \memo for windows, the interior convection coefficient must be &gt;.28,</span>
<a name="ln-1249"></a>          <span class="c">!      \memo for trombe wall algorithm selection (zone), the interior convection coefficient must be &gt;.1</span>
<a name="ln-1250"></a>          <span class="c">!      \memo for detailed interior convection, the lower limit is also .1</span>
<a name="ln-1251"></a>          <span class="c">!  A1, \field Surface Type</span>
<a name="ln-1252"></a>          <span class="c">!      \required-field</span>
<a name="ln-1253"></a>          <span class="c">!      \type choice</span>
<a name="ln-1254"></a>          <span class="c">!      \key AllExteriorSurfaces</span>
<a name="ln-1255"></a>          <span class="c">!      \key AllExteriorWindows</span>
<a name="ln-1256"></a>          <span class="c">!      \key AllExteriorWalls</span>
<a name="ln-1257"></a>          <span class="c">!      \key AllExteriorRoofs</span>
<a name="ln-1258"></a>          <span class="c">!      \key AllExteriorFloors</span>
<a name="ln-1259"></a>          <span class="c">!      \key AllInteriorSurfaces</span>
<a name="ln-1260"></a>          <span class="c">!      \key AllInteriorWalls</span>
<a name="ln-1261"></a>          <span class="c">!      \key AllInteriorWindows</span>
<a name="ln-1262"></a>          <span class="c">!      \key AllInteriorCeilings</span>
<a name="ln-1263"></a>          <span class="c">!      \key AllInteriorFloors</span>
<a name="ln-1264"></a>          <span class="c">!  A2, \field Convection Coefficient 1 Location</span>
<a name="ln-1265"></a>          <span class="c">!      \required-field</span>
<a name="ln-1266"></a>          <span class="c">!      \type choice</span>
<a name="ln-1267"></a>          <span class="c">!      \key Outside</span>
<a name="ln-1268"></a>          <span class="c">!      \key Inside</span>
<a name="ln-1269"></a>          <span class="c">!  A3, \field Convection Coefficient 1 Type</span>
<a name="ln-1270"></a>          <span class="c">!      \required-field</span>
<a name="ln-1271"></a>          <span class="c">!      \type choice</span>
<a name="ln-1272"></a>          <span class="c">!      \key Value</span>
<a name="ln-1273"></a>          <span class="c">!      \key Schedule</span>
<a name="ln-1274"></a>          <span class="c">!      \key Simple</span>
<a name="ln-1275"></a>          <span class="c">!      \key Detailed</span>
<a name="ln-1276"></a>          <span class="c">!      \key BLAST</span>
<a name="ln-1277"></a>          <span class="c">!      \key TARP</span>
<a name="ln-1278"></a>          <span class="c">!      \key DOE-2</span>
<a name="ln-1279"></a>          <span class="c">!      \key MoWitt</span>
<a name="ln-1280"></a>          <span class="c">!  N1, \field Convection Coefficient 1</span>
<a name="ln-1281"></a>          <span class="c">!      \note used if Convection Value Type=value, then minimum must be &gt; 0.0, Maximum &lt;= 1000.</span>
<a name="ln-1282"></a>          <span class="c">!      \units W/m2-K</span>
<a name="ln-1283"></a>          <span class="c">!  A4, \field Convection Coefficient 1 Schedule Name</span>
<a name="ln-1284"></a>          <span class="c">!       \note used if Convection Coefficient Type=Schedule</span>
<a name="ln-1285"></a>          <span class="c">!       \type object-list</span>
<a name="ln-1286"></a>          <span class="c">!       \object-list ScheduleNames</span>
<a name="ln-1287"></a>          <span class="c">!   &lt; Remainder fields are a repeat of A2, A3, N1, A4&gt;</span>
<a name="ln-1288"></a>
<a name="ln-1289"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1290"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-1291"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">FindItemInList</span><span class="p">,</span> <span class="n">SameString</span>
<a name="ln-1292"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetScheduleIndex</span><span class="p">,</span> <span class="n">CheckScheduleValueMinMax</span>
<a name="ln-1293"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCurveIndex</span><span class="p">,</span> <span class="n">GetCurveType</span>
<a name="ln-1294"></a>  <span class="k">USE </span><span class="n">DataErrorTracking</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TotalSevereErrors</span>
<a name="ln-1295"></a>
<a name="ln-1296"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1297"></a>
<a name="ln-1298"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1299"></a>          <span class="c">! na</span>
<a name="ln-1300"></a>
<a name="ln-1301"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1302"></a> <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;GetUserConvectionCoefficients&#39;</span>
<a name="ln-1303"></a> <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">NumValidSurfaceTypes</span><span class="o">=</span><span class="mi">11</span>
<a name="ln-1304"></a> <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ValidSurfaceTypes</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-1305"></a>            <span class="p">(</span><span class="o">/</span><span class="s1">&#39;ALLEXTERIORSURFACES&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1306"></a>              <span class="s1">&#39;ALLEXTERIORWINDOWS &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1307"></a>              <span class="s1">&#39;ALLEXTERIORWALLS   &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1308"></a>              <span class="s1">&#39;ALLEXTERIORROOFS   &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1309"></a>              <span class="s1">&#39;ALLEXTERIORFLOORS  &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1310"></a>              <span class="s1">&#39;ALLINTERIORSURFACES&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1311"></a>              <span class="s1">&#39;ALLINTERIORWINDOWS &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1312"></a>              <span class="s1">&#39;ALLINTERIORWALLS   &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1313"></a>              <span class="s1">&#39;ALLINTERIORROOFS   &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1314"></a>              <span class="s1">&#39;ALLINTERIORCEILINGS&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1315"></a>              <span class="s1">&#39;ALLINTERIORFLOORS  &#39;</span><span class="o">/</span><span class="p">)</span>
<a name="ln-1316"></a>
<a name="ln-1317"></a> <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">NumValidExtConvectionValueTypes</span><span class="o">=</span><span class="mi">22</span>
<a name="ln-1318"></a> <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ValidExtConvectionValueTypes</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span><span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-1319"></a>             <span class="p">(</span><span class="o">/</span><span class="s1">&#39;VALUE                            &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1320"></a>               <span class="s1">&#39;SCHEDULE                         &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1321"></a>               <span class="s1">&#39;SIMPLECOMBINED                   &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1322"></a>               <span class="s1">&#39;TARP                             &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1323"></a>               <span class="s1">&#39;MOWITT                           &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1324"></a>               <span class="s1">&#39;DOE-2                            &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1325"></a>               <span class="s1">&#39;ADAPTIVECONVECTIONALGORITHM      &#39;</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1326"></a>               <span class="s1">&#39;USERCURVE                        &#39;</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1327"></a>               <span class="s1">&#39;ASHRAEVERTICALWALL               &#39;</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1328"></a>               <span class="s1">&#39;WALTONUNSTABLEHORIZONTALORTILT   &#39;</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1329"></a>               <span class="s1">&#39;WALTONSTABLEHORIZONTALORTILT     &#39;</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1330"></a>               <span class="s1">&#39;NUSSELTJURGES                    &#39;</span> <span class="p">,&amp;</span>
<a name="ln-1331"></a>               <span class="s1">&#39;MCADAMS                          &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1332"></a>               <span class="s1">&#39;MITCHELL                         &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1333"></a>               <span class="s1">&#39;CLEARROOF                        &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1334"></a>               <span class="s1">&#39;EMMELVERTICAL                    &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1335"></a>               <span class="s1">&#39;EMMELROOF                        &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1336"></a>               <span class="s1">&#39;ALAMDARIHAMMONDVERTICALWALL      &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1337"></a>               <span class="s1">&#39;FOHANNOPOLIDORIVERTICALWALL      &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1338"></a>               <span class="s1">&#39;ISO15099WINDOWS                  &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1339"></a>               <span class="s1">&#39;ALAMDARIHAMMONDSTABLEHORIZONTAL  &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1340"></a>               <span class="s1">&#39;ALAMDARIHAMMONDUNSTABLEHORIZONTAL&#39;</span><span class="o">/</span><span class="p">)</span>
<a name="ln-1341"></a>
<a name="ln-1342"></a> <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ExtConvectionValue</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span><span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-1343"></a>              <span class="p">(</span><span class="o">/-</span><span class="mi">999</span>                       <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1344"></a>                <span class="o">-</span><span class="mi">999</span>                       <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1345"></a>                <span class="n">ASHRAESimple</span>               <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1346"></a>                <span class="n">TarpHcOutside</span>              <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1347"></a>                <span class="n">MoWittHcOutside</span>            <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1348"></a>                <span class="n">DOE2HcOutside</span>              <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1349"></a>                <span class="n">AdaptiveConvectionAlgorithm</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1350"></a>                <span class="n">HcExt_UserCurve</span>            <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1351"></a>                <span class="n">HcExt_NaturalASHRAEVerticalWall</span>               <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1352"></a>                <span class="n">HcExt_NaturalWaltonUnstableHorizontalOrTilt</span>   <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1353"></a>                <span class="n">HcExt_NaturalWaltonStableHorizontalOrTilt</span>     <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1354"></a>                <span class="n">HcExt_NusseltJurges</span>                        <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1355"></a>                <span class="n">HcExt_McAdams</span>                             <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1356"></a>                <span class="n">HcExt_Mitchell</span>                             <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1357"></a>                <span class="n">HcExt_ClearRoof</span>                            <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1358"></a>                <span class="n">HcExt_EmmelVertical</span>                        <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1359"></a>                <span class="n">HcExt_EmmelRoof</span>                             <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1360"></a>                <span class="n">HcExt_AlamdariHammondVerticalWall</span>           <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1361"></a>                <span class="n">HcExt_FohannoPolidoriVerticalWall</span>           <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1362"></a>                <span class="n">HcExt_ISO15099Windows</span>                       <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1363"></a>                <span class="n">HcExt_AlamdariHammondStableHorizontal</span>        <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1364"></a>                <span class="n">HcExt_AlamdariHammondUnstableHorizontal</span>     <span class="o">/</span><span class="p">)</span>
<a name="ln-1365"></a>
<a name="ln-1366"></a>
<a name="ln-1367"></a> <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">NumValidSpecificExtWindConvValueTypes</span><span class="o">=</span><span class="mi">15</span>
<a name="ln-1368"></a> <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ValidSpecificExtWindConvValueTypes</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-1369"></a>             <span class="p">(</span><span class="o">/</span><span class="s1">&#39;SIMPLECOMBINED         &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1370"></a>               <span class="s1">&#39;TARPWINDWARD           &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1371"></a>               <span class="s1">&#39;TARPLEEWARD            &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1372"></a>               <span class="s1">&#39;MOWITTWINDWARD         &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1373"></a>               <span class="s1">&#39;MOWITTLEEWARD          &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1374"></a>               <span class="s1">&#39;DOE2WINDWARD           &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1375"></a>               <span class="s1">&#39;DOE2LEEWARD            &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1376"></a>               <span class="s1">&#39;NUSSELTJURGES          &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1377"></a>               <span class="s1">&#39;MCADAMS                &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1378"></a>               <span class="s1">&#39;MITCHELL               &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1379"></a>               <span class="s1">&#39;EMMELVERTICAL          &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1380"></a>               <span class="s1">&#39;EMMELROOF              &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1381"></a>               <span class="s1">&#39;BLOCKENWINDWARD        &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1382"></a>               <span class="s1">&#39;CLEARROOF              &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1383"></a>               <span class="s1">&#39;USERCURVE              &#39;</span><span class="o">/</span><span class="p">)</span>
<a name="ln-1384"></a> <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">MoreSpecificExtWindConvectionValue</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-1385"></a>              <span class="p">(</span><span class="o">/</span><span class="n">HcExt_ASHRAESimpleCombined</span>   <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1386"></a>                <span class="n">HcExt_SparrowWindward</span>        <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1387"></a>                <span class="n">HcExt_SparrowLeeward</span>         <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1388"></a>                <span class="n">HcExt_MoWiTTWindward</span>         <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1389"></a>                <span class="n">HcExt_DOE2Windward</span>           <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1390"></a>                <span class="n">HcExt_MoWiTTLeeward</span>          <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1391"></a>                <span class="n">HcExt_DOE2Leeward</span>            <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1392"></a>                <span class="n">HcExt_NusseltJurges</span>          <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1393"></a>                <span class="n">HcExt_McAdams</span>                <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1394"></a>                <span class="n">HcExt_Mitchell</span>               <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1395"></a>                <span class="n">HcExt_EmmelVertical</span>          <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1396"></a>                <span class="n">HcExt_EmmelRoof</span>              <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1397"></a>                <span class="n">HcExt_BlockenWindward</span>        <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1398"></a>                <span class="n">HcExt_ClearRoof</span>              <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1399"></a>                <span class="n">HcExt_UserCurve</span> <span class="o">/</span><span class="p">)</span>
<a name="ln-1400"></a>
<a name="ln-1401"></a> <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">NumValidSpecificExtNatConvectValueTypes</span><span class="o">=</span><span class="mi">10</span>
<a name="ln-1402"></a> <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ValidSpecificExtNatConvectValueTypes</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-1403"></a>             <span class="p">(</span><span class="o">/</span><span class="s1">&#39;ASHRAEVERTICALWALL                &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1404"></a>               <span class="s1">&#39;ALAMDARIHAMMONDVERTICALWALL       &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1405"></a>               <span class="s1">&#39;FOHANNOPOLIDORIVERTICALWALL       &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1406"></a>               <span class="s1">&#39;WALTONUNSTABLEHORIZONTALORTILT    &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1407"></a>               <span class="s1">&#39;WALTONSTABLEHORIZONTALORTILT      &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1408"></a>               <span class="s1">&#39;ALAMDARIHAMMONDSTABLEHORIZONTAL   &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1409"></a>               <span class="s1">&#39;ALAMDARIHAMMONDUNSTABLEHORIZONTAL &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1410"></a>               <span class="s1">&#39;ISO15099WINDOWS                   &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1411"></a>               <span class="s1">&#39;USERCURVE                         &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1412"></a>               <span class="s1">&#39;NONE                              &#39;</span> <span class="o">/</span><span class="p">)</span>
<a name="ln-1413"></a> <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">SpecificExtNatConvectionValue</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-1414"></a>              <span class="p">(</span><span class="o">/</span><span class="n">HcExt_NaturalASHRAEVerticalWall</span>            <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1415"></a>                <span class="n">HcExt_AlamdariHammondVerticalWall</span>          <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1416"></a>                <span class="n">HcExt_FohannoPolidoriVerticalWall</span>          <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1417"></a>                <span class="n">HcExt_NaturalWaltonUnstableHorizontalOrTilt</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1418"></a>                <span class="n">HcExt_NaturalWaltonStableHorizontalOrTilt</span>  <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1419"></a>                <span class="n">HcExt_AlamdariHammondStableHorizontal</span>      <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1420"></a>                <span class="n">HcExt_AlamdariHammondUnstableHorizontal</span>    <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1421"></a>                <span class="n">HcExt_ISO15099Windows</span>                      <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1422"></a>                <span class="n">HcExt_UserCurve</span>                            <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1423"></a>                <span class="n">HcExt_None</span>  <span class="o">/</span><span class="p">)</span>
<a name="ln-1424"></a>
<a name="ln-1425"></a> <span class="c">! CeilingDiffuser and TrombeWall Interior types are only Zone Level settings.</span>
<a name="ln-1426"></a> <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">NumValidIntConvectionValueTypes</span><span class="o">=</span><span class="mi">34</span>
<a name="ln-1427"></a> <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="mi">34</span><span class="p">)</span><span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-1428"></a>             <span class="p">(</span><span class="o">/</span><span class="s1">&#39;VALUE                                  &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1429"></a>               <span class="s1">&#39;SCHEDULE                               &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1430"></a>               <span class="s1">&#39;SIMPLE                                 &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1431"></a>               <span class="s1">&#39;TARP                                   &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1432"></a>               <span class="s1">&#39;ADAPTIVECONVECTIONALGORITHM            &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1433"></a>               <span class="s1">&#39;USERCURVE                              &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1434"></a>               <span class="s1">&#39;ASHRAEVERTICALWALL                     &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1435"></a>               <span class="s1">&#39;WALTONUNSTABLEHORIZONTALORTILT         &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1436"></a>               <span class="s1">&#39;WALTONSTABLEHORIZONTALORTILT           &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1437"></a>               <span class="s1">&#39;FISHERPEDERSENCEILINGDIFFUSERWALLS     &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1438"></a>               <span class="s1">&#39;FISHERPEDERSENCEILINGDIFFUSERCEILING   &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1439"></a>               <span class="s1">&#39;FISHERPEDERSENCEILINGDIFFUSERFLOOR     &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1440"></a>               <span class="s1">&#39;ALAMDARIHAMMONDSTABLEHORIZONTAL        &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1441"></a>               <span class="s1">&#39;ALAMDARIHAMMONDUNSTABLEHORIZONTAL      &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1442"></a>               <span class="s1">&#39;ALAMDARIHAMMONDVERTICALWALL            &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1443"></a>               <span class="s1">&#39;KHALIFAEQ3WALLAWAYFROMHEAT             &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1444"></a>               <span class="s1">&#39;KHALIFAEQ4CEILINGAWAYFROMHEAT          &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1445"></a>               <span class="s1">&#39;KHALIFAEQ5WALLNEARHEAT                 &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1446"></a>               <span class="s1">&#39;KHALIFAEQ6NONHEATEDWALLS               &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1447"></a>               <span class="s1">&#39;KHALIFAEQ7CEILING                      &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1448"></a>               <span class="s1">&#39;AWBIHATTONHEATEDFLOOR                  &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1449"></a>               <span class="s1">&#39;AWBIHATTONHEATEDWALL                   &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1450"></a>               <span class="s1">&#39;BEAUSOLEILMORRISONMIXEDASSISTEDWALL    &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1451"></a>               <span class="s1">&#39;BEAUSOLEILMORRISONMIXEDOPPOSINGWALL    &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1452"></a>               <span class="s1">&#39;BEAUSOLEILMORRISONMIXEDSTABLEFLOOR     &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1453"></a>               <span class="s1">&#39;BEAUSOLEILMORRISONMIXEDUNSTABLEFLOOR   &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1454"></a>               <span class="s1">&#39;BEAUSOLEILMORRISONMIXEDSTABLECEILING   &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1455"></a>               <span class="s1">&#39;BEAUSOLEILMORRISONMIXEDUNSTABLECEILING &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1456"></a>               <span class="s1">&#39;FOHANNOPOLIDORIVERTICALWALL            &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1457"></a>               <span class="s1">&#39;KARADAGCHILLEDCEILING                  &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1458"></a>               <span class="s1">&#39;ISO15099WINDOWS                        &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1459"></a>               <span class="s1">&#39;GOLDSTEINNOVOSELACCEILINGDIFFUSERWINDOW&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1460"></a>               <span class="s1">&#39;GOLDSTEINNOVOSELACCEILINGDIFFUSERWALLS &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1461"></a>               <span class="s1">&#39;GOLDSTEINNOVOSELACCEILINGDIFFUSERFLOOR &#39;</span><span class="o">/</span><span class="p">)</span>
<a name="ln-1462"></a> <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="mi">34</span><span class="p">)</span><span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-1463"></a>              <span class="p">(</span><span class="o">/-</span><span class="mi">999</span><span class="p">,</span>                                        <span class="p">&amp;</span>
<a name="ln-1464"></a>                <span class="o">-</span><span class="mi">999</span><span class="p">,</span>                                        <span class="p">&amp;</span>
<a name="ln-1465"></a>               <span class="n">ASHRAESimple</span><span class="p">,</span>                                 <span class="p">&amp;</span>
<a name="ln-1466"></a>               <span class="n">ASHRAETARP</span><span class="p">,</span>                                   <span class="p">&amp;</span>
<a name="ln-1467"></a>               <span class="n">AdaptiveConvectionAlgorithm</span><span class="p">,</span>                  <span class="p">&amp;</span>
<a name="ln-1468"></a>               <span class="n">HcInt_UserCurve</span><span class="p">,</span>                              <span class="p">&amp;</span>
<a name="ln-1469"></a>               <span class="n">HcInt_ASHRAEVerticalWall</span><span class="p">,</span>                     <span class="p">&amp;</span>
<a name="ln-1470"></a>               <span class="n">HcInt_WaltonUnstableHorizontalOrTilt</span><span class="p">,</span>         <span class="p">&amp;</span>
<a name="ln-1471"></a>               <span class="n">HcInt_WaltonStableHorizontalOrTilt</span><span class="p">,</span>           <span class="p">&amp;</span>
<a name="ln-1472"></a>               <span class="n">HcInt_FisherPedersenCeilDiffuserWalls</span><span class="p">,</span>        <span class="p">&amp;</span>
<a name="ln-1473"></a>               <span class="n">HcInt_FisherPedersenCeilDiffuserCeiling</span><span class="p">,</span>      <span class="p">&amp;</span>
<a name="ln-1474"></a>               <span class="n">HcInt_FisherPedersenCeilDiffuserFloor</span><span class="p">,</span>        <span class="p">&amp;</span>
<a name="ln-1475"></a>               <span class="n">HcInt_AlamdariHammondStableHorizontal</span><span class="p">,</span>        <span class="p">&amp;</span>
<a name="ln-1476"></a>               <span class="n">HcInt_AlamdariHammondUnstableHorizontal</span><span class="p">,</span>      <span class="p">&amp;</span>
<a name="ln-1477"></a>               <span class="n">HcInt_AlamdariHammondVerticalWall</span><span class="p">,</span>            <span class="p">&amp;</span>
<a name="ln-1478"></a>               <span class="n">HcInt_KhalifaEq3WallAwayFromHeat</span><span class="p">,</span>             <span class="p">&amp;</span>
<a name="ln-1479"></a>               <span class="n">HcInt_KhalifaEq4CeilingAwayFromHeat</span><span class="p">,</span>          <span class="p">&amp;</span>
<a name="ln-1480"></a>               <span class="n">HcInt_KhalifaEq5WallNearHeat</span><span class="p">,</span>                 <span class="p">&amp;</span>
<a name="ln-1481"></a>               <span class="n">HcInt_KhalifaEq6NonHeatedWalls</span><span class="p">,</span>               <span class="p">&amp;</span>
<a name="ln-1482"></a>               <span class="n">HcInt_KhalifaEq7Ceiling</span><span class="p">,</span>                      <span class="p">&amp;</span>
<a name="ln-1483"></a>               <span class="n">HcInt_AwbiHattonHeatedFloor</span><span class="p">,</span>                  <span class="p">&amp;</span>
<a name="ln-1484"></a>               <span class="n">HcInt_AwbiHattonHeatedWall</span><span class="p">,</span>                   <span class="p">&amp;</span>
<a name="ln-1485"></a>               <span class="n">HcInt_BeausoleilMorrisonMixedAssistingWall</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1486"></a>               <span class="n">HcInt_BeausoleilMorrisonMixedOppossingWall</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1487"></a>               <span class="n">HcInt_BeausoleilMorrisonMixedStableFloor</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-1488"></a>               <span class="n">HcInt_BeausoleilMorrisonMixedUnstableFloor</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1489"></a>               <span class="n">HcInt_BeausoleilMorrisonMixedStableCeiling</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1490"></a>               <span class="n">HcInt_BeausoleilMorrisonMixedUnstableCeiling</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1491"></a>               <span class="n">HcInt_FohannoPolidoriVerticalWall</span><span class="p">,</span>            <span class="p">&amp;</span>
<a name="ln-1492"></a>               <span class="n">HcInt_KaradagChilledCeiling</span><span class="p">,</span>                  <span class="p">&amp;</span>
<a name="ln-1493"></a>               <span class="n">HcInt_ISO15099Windows</span><span class="p">,</span>                        <span class="p">&amp;</span>
<a name="ln-1494"></a>               <span class="n">HcInt_GoldsteinNovoselacCeilingDiffuserWindow</span><span class="p">,&amp;</span>
<a name="ln-1495"></a>               <span class="n">HcInt_GoldsteinNovoselacCeilingDiffuserWalls</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1496"></a>               <span class="n">HcInt_GoldsteinNovoselacCeilingDiffuserFloor</span><span class="o">/</span><span class="p">)</span>
<a name="ln-1497"></a>
<a name="ln-1498"></a>
<a name="ln-1499"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-1500"></a>          <span class="c">! na</span>
<a name="ln-1501"></a>
<a name="ln-1502"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-1503"></a>          <span class="c">! na</span>
<a name="ln-1504"></a>
<a name="ln-1505"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1506"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-1507"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1508"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumAlphas</span>
<a name="ln-1509"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumNumbers</span>
<a name="ln-1510"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Loop</span>
<a name="ln-1511"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Loop1</span>
<a name="ln-1512"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="nb">Count</span>
<a name="ln-1513"></a><span class="nb">  </span><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Status</span>
<a name="ln-1514"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Found</span>
<a name="ln-1515"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1516"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1517"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1518"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ExtValue</span>
<a name="ln-1519"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IntValue</span>
<a name="ln-1520"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Ptr</span>
<a name="ln-1521"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="k">Pass</span>
<a name="ln-1522"></a><span class="k">  </span><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">FieldNo</span>
<a name="ln-1523"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CFieldNo</span>
<a name="ln-1524"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumField</span>
<a name="ln-1525"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CurrentModuleObject</span>
<a name="ln-1526"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">PotentialAssignedValue</span>
<a name="ln-1527"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ZoneNum</span>
<a name="ln-1528"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SurfNum</span>
<a name="ln-1529"></a>
<a name="ln-1530"></a>  <span class="c">! first get user-defined H models so they can be processed for later objects</span>
<a name="ln-1531"></a>  <span class="n">CurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;SurfaceConvectionAlgorithm:Inside:UserCurve&#39;</span>
<a name="ln-1532"></a>  <span class="n">TotInsideHcUserCurves</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span>
<a name="ln-1533"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">HcInsideUserCurve</span><span class="p">(</span><span class="n">TotInsideHcUserCurves</span><span class="p">))</span>
<a name="ln-1534"></a>  <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotInsideHcUserCurves</span>
<a name="ln-1535"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">Loop</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">Status</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1536"></a>                 <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1537"></a>                 <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-1538"></a>    <span class="n">HcInsideUserCurve</span><span class="p">(</span><span class="n">loop</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1539"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-1540"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;MEANAIRTEMPERATURE&#39;</span><span class="p">)</span>
<a name="ln-1541"></a>      <span class="n">HcInsideUserCurve</span><span class="p">(</span><span class="n">loop</span><span class="p">)%</span><span class="n">ReferenceTempType</span>  <span class="o">=</span> <span class="n">RefTempMeanAirTemp</span>
<a name="ln-1542"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;ADJACENTAIRTEMPERATURE&#39;</span><span class="p">)</span>
<a name="ln-1543"></a>      <span class="n">HcInsideUserCurve</span><span class="p">(</span><span class="n">loop</span><span class="p">)%</span><span class="n">ReferenceTempType</span>  <span class="o">=</span> <span class="n">RefTempAdjacentAirTemp</span>
<a name="ln-1544"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;SUPPLYAIRTEMPERATURE&#39;</span><span class="p">)</span>
<a name="ln-1545"></a>      <span class="n">HcInsideUserCurve</span><span class="p">(</span><span class="n">loop</span><span class="p">)%</span><span class="n">ReferenceTempType</span>  <span class="o">=</span> <span class="n">RefTempSupplyAirTemp</span>
<a name="ln-1546"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1547"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetUserSuppliedConvectionCoefficients: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1548"></a>                          <span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-1549"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1550"></a>    <span class="k">END SELECT</span>
<a name="ln-1551"></a>
<a name="ln-1552"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1553"></a><span class="k">      </span><span class="n">HcInsideUserCurve</span><span class="p">(</span><span class="n">loop</span><span class="p">)%</span><span class="n">HcFnTempDiffCurveNum</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-1554"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">HcInsideUserCurve</span><span class="p">(</span><span class="n">loop</span><span class="p">)%</span><span class="n">HcFnTempDiffCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1555"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetUserSuppliedConvectionCoefficients: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1556"></a>                                 <span class="s1">&#39;Invalid Name Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1557"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1558"></a>      <span class="k">ELSE</span> <span class="c">! check type</span>
<a name="ln-1559"></a>        <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">HcInsideUserCurve</span><span class="p">(</span><span class="n">loop</span><span class="p">)%</span><span class="n">HcFnTempDiffCurveNum</span><span class="p">))</span>
<a name="ln-1560"></a>
<a name="ln-1561"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;LINEAR&#39;</span><span class="p">,</span> <span class="s1">&#39;QUADRATIC&#39;</span><span class="p">,</span> <span class="s1">&#39;CUBIC&#39;</span><span class="p">,</span> <span class="s1">&#39;EXPONENT&#39;</span><span class="p">,</span> <span class="s1">&#39;QUARTIC&#39;</span><span class="p">)</span>
<a name="ln-1562"></a>         <span class="c">!okay do nothing, have the right type of curve (single independent variable)</span>
<a name="ln-1563"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1564"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1565"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1566"></a>               <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)))))</span>
<a name="ln-1567"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1568"></a>        <span class="k">END SELECT</span>
<a name="ln-1569"></a>
<a name="ln-1570"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-1571"></a>    <span class="k">ELSE</span>
<a name="ln-1572"></a><span class="k">      </span><span class="n">HcInsideUserCurve</span><span class="p">(</span><span class="n">loop</span><span class="p">)%</span><span class="n">HcFnTempDiffCurveNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1573"></a>    <span class="n">ENDIF</span>
<a name="ln-1574"></a>
<a name="ln-1575"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1576"></a><span class="k">      </span><span class="n">HcInsideUserCurve</span><span class="p">(</span><span class="n">loop</span><span class="p">)%</span><span class="n">HcFnTempDiffDivHeightCurveNum</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-1577"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">HcInsideUserCurve</span><span class="p">(</span><span class="n">loop</span><span class="p">)%</span><span class="n">HcFnTempDiffDivHeightCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1578"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetUserSuppliedConvectionCoefficients: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1579"></a>                                 <span class="s1">&#39;Invalid Name Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-1580"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1581"></a>      <span class="k">ELSE</span> <span class="c">! check type</span>
<a name="ln-1582"></a>        <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">HcInsideUserCurve</span><span class="p">(</span><span class="n">loop</span><span class="p">)%</span><span class="n">HcFnTempDiffDivHeightCurveNum</span><span class="p">))</span>
<a name="ln-1583"></a>
<a name="ln-1584"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;LINEAR&#39;</span><span class="p">,</span> <span class="s1">&#39;QUADRATIC&#39;</span><span class="p">,</span> <span class="s1">&#39;CUBIC&#39;</span><span class="p">,</span> <span class="s1">&#39;EXPONENT&#39;</span><span class="p">,</span> <span class="s1">&#39;QUARTIC&#39;</span><span class="p">)</span>
<a name="ln-1585"></a>         <span class="c">!okay do nothing, have the right type of curve (single independent variable)</span>
<a name="ln-1586"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1587"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1588"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1589"></a>               <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)))))</span>
<a name="ln-1590"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1591"></a>        <span class="k">END SELECT</span>
<a name="ln-1592"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-1593"></a>    <span class="k">ELSE</span>
<a name="ln-1594"></a><span class="k">      </span><span class="n">HcInsideUserCurve</span><span class="p">(</span><span class="n">loop</span><span class="p">)%</span><span class="n">HcFnTempDiffDivHeightCurveNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1595"></a>    <span class="n">ENDIF</span>
<a name="ln-1596"></a>
<a name="ln-1597"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1598"></a><span class="k">      </span><span class="n">HcInsideUserCurve</span><span class="p">(</span><span class="n">loop</span><span class="p">)%</span><span class="n">HcFnACHCurveNum</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-1599"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">HcInsideUserCurve</span><span class="p">(</span><span class="n">loop</span><span class="p">)%</span><span class="n">HcFnACHCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1600"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetUserSuppliedConvectionCoefficients: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1601"></a>                                 <span class="s1">&#39;Invalid Name Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-1602"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1603"></a>      <span class="k">ELSE</span> <span class="c">! check type</span>
<a name="ln-1604"></a>        <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">HcInsideUserCurve</span><span class="p">(</span><span class="n">loop</span><span class="p">)%</span><span class="n">HcFnACHCurveNum</span><span class="p">))</span>
<a name="ln-1605"></a>
<a name="ln-1606"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;LINEAR&#39;</span><span class="p">,</span> <span class="s1">&#39;QUADRATIC&#39;</span><span class="p">,</span> <span class="s1">&#39;CUBIC&#39;</span><span class="p">,</span> <span class="s1">&#39;EXPONENT&#39;</span><span class="p">,</span> <span class="s1">&#39;QUARTIC&#39;</span><span class="p">)</span>
<a name="ln-1607"></a>         <span class="c">!okay do nothing, have the right type of curve (single independent variable)</span>
<a name="ln-1608"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1609"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1610"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1611"></a>               <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)))))</span>
<a name="ln-1612"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1613"></a>        <span class="k">END SELECT</span>
<a name="ln-1614"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-1615"></a>    <span class="k">ELSE</span>
<a name="ln-1616"></a><span class="k">      </span><span class="n">HcInsideUserCurve</span><span class="p">(</span><span class="n">loop</span><span class="p">)%</span><span class="n">HcFnACHCurveNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1617"></a>    <span class="n">ENDIF</span>
<a name="ln-1618"></a>
<a name="ln-1619"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1620"></a><span class="k">      </span><span class="n">HcInsideUserCurve</span><span class="p">(</span><span class="n">loop</span><span class="p">)%</span><span class="n">HcFnACHDivPerimLengthCurveNum</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1621"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">HcInsideUserCurve</span><span class="p">(</span><span class="n">loop</span><span class="p">)%</span><span class="n">HcFnACHDivPerimLengthCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1622"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetUserSuppliedConvectionCoefficients: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1623"></a>                             <span class="s1">&#39;Invalid Name Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-1624"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1625"></a>      <span class="k">ELSE</span> <span class="c">! check type</span>
<a name="ln-1626"></a>        <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">HcInsideUserCurve</span><span class="p">(</span><span class="n">loop</span><span class="p">)%</span><span class="n">HcFnACHDivPerimLengthCurveNum</span><span class="p">))</span>
<a name="ln-1627"></a>
<a name="ln-1628"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;LINEAR&#39;</span><span class="p">,</span> <span class="s1">&#39;QUADRATIC&#39;</span><span class="p">,</span> <span class="s1">&#39;CUBIC&#39;</span><span class="p">,</span> <span class="s1">&#39;EXPONENT&#39;</span><span class="p">,</span> <span class="s1">&#39;QUARTIC&#39;</span><span class="p">)</span>
<a name="ln-1629"></a>         <span class="c">!okay do nothing, have the right type of curve (single independent variable)</span>
<a name="ln-1630"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1631"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1632"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1633"></a>               <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)))))</span>
<a name="ln-1634"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1635"></a>        <span class="k">END SELECT</span>
<a name="ln-1636"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-1637"></a>    <span class="k">ELSE</span>
<a name="ln-1638"></a><span class="k">      </span><span class="n">HcInsideUserCurve</span><span class="p">(</span><span class="n">loop</span><span class="p">)%</span><span class="n">HcFnACHDivPerimLengthCurveNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1639"></a>    <span class="n">ENDIF</span>
<a name="ln-1640"></a>
<a name="ln-1641"></a>
<a name="ln-1642"></a>  <span class="n">ENDDO</span> <span class="c">!end of &#39;SurfaceConvectionAlgorithm:Inside:UserCurve&#39;</span>
<a name="ln-1643"></a>
<a name="ln-1644"></a>  <span class="n">CurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;SurfaceConvectionAlgorithm:Outside:UserCurve&#39;</span>
<a name="ln-1645"></a>  <span class="n">TotOutsideHcUserCurves</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span>
<a name="ln-1646"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">HcOutsideUserCurve</span><span class="p">(</span><span class="n">TotOutsideHcUserCurves</span><span class="p">))</span>
<a name="ln-1647"></a>  <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotOutsideHcUserCurves</span>
<a name="ln-1648"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">Loop</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">Status</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1649"></a>                 <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1650"></a>                 <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-1651"></a>    <span class="n">HcOutsideUserCurve</span><span class="p">(</span><span class="n">loop</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1652"></a>
<a name="ln-1653"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1654"></a>
<a name="ln-1655"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;WEATHERFILE&#39;</span><span class="p">)</span>
<a name="ln-1656"></a>      <span class="n">HcOutsideUserCurve</span><span class="p">(</span><span class="n">loop</span><span class="p">)%</span><span class="n">WindSpeedType</span> <span class="o">=</span> <span class="n">RefWindWeatherFile</span>
<a name="ln-1657"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;HEIGHTADJUST&#39;</span><span class="p">)</span>
<a name="ln-1658"></a>      <span class="n">HcOutsideUserCurve</span><span class="p">(</span><span class="n">loop</span><span class="p">)%</span><span class="n">WindSpeedType</span> <span class="o">=</span> <span class="n">RefWindAtZ</span>
<a name="ln-1659"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;PARALLELCOMPONENT&#39;</span><span class="p">)</span>
<a name="ln-1660"></a>      <span class="n">HcOutsideUserCurve</span><span class="p">(</span><span class="n">loop</span><span class="p">)%</span><span class="n">WindSpeedType</span> <span class="o">=</span> <span class="n">RefWindParallComp</span>
<a name="ln-1661"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;PARALLELCOMPONENTHEIGHTADJUST&#39;</span><span class="p">)</span>
<a name="ln-1662"></a>      <span class="n">HcOutsideUserCurve</span><span class="p">(</span><span class="n">loop</span><span class="p">)%</span><span class="n">WindSpeedType</span> <span class="o">=</span> <span class="n">RefWindParallCompAtZ</span>
<a name="ln-1663"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1664"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetUserSuppliedConvectionCoefficients: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1665"></a>                            <span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-1666"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1667"></a>    <span class="k">END SELECT</span>
<a name="ln-1668"></a>
<a name="ln-1669"></a>    <span class="c">! A3 , \field Hf Function of Wind Speed Curve Name</span>
<a name="ln-1670"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1671"></a><span class="k">      </span><span class="n">HcOutsideUserCurve</span><span class="p">(</span><span class="n">loop</span><span class="p">)%</span><span class="n">HfFnWindSpeedCurveNum</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-1672"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">HcOutsideUserCurve</span><span class="p">(</span><span class="n">loop</span><span class="p">)%</span><span class="n">HfFnWindSpeedCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1673"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetUserSuppliedConvectionCoefficients: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1674"></a>                              <span class="s1">&#39;Invalid Name Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1675"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1676"></a>      <span class="k">ELSE</span> <span class="c">! check type</span>
<a name="ln-1677"></a>        <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">HcOutsideUserCurve</span><span class="p">(</span><span class="n">loop</span><span class="p">)%</span><span class="n">HfFnWindSpeedCurveNum</span><span class="p">))</span>
<a name="ln-1678"></a>
<a name="ln-1679"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;LINEAR&#39;</span><span class="p">,</span> <span class="s1">&#39;QUADRATIC&#39;</span><span class="p">,</span> <span class="s1">&#39;CUBIC&#39;</span><span class="p">,</span> <span class="s1">&#39;EXPONENT&#39;</span><span class="p">,</span> <span class="s1">&#39;QUARTIC&#39;</span><span class="p">)</span>
<a name="ln-1680"></a>         <span class="c">!okay do nothing, have the right type of curve (single independent variable)</span>
<a name="ln-1681"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1682"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1683"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1684"></a>               <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)))))</span>
<a name="ln-1685"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1686"></a>        <span class="k">END SELECT</span>
<a name="ln-1687"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-1688"></a>    <span class="k">ELSE</span>
<a name="ln-1689"></a><span class="k">      </span><span class="n">HcOutsideUserCurve</span><span class="p">(</span><span class="n">loop</span><span class="p">)%</span><span class="n">HfFnWindSpeedCurveNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1690"></a>    <span class="n">ENDIF</span>
<a name="ln-1691"></a>
<a name="ln-1692"></a>    <span class="c">!  A4 , \field Hn Function of Temperature Difference Curve Name</span>
<a name="ln-1693"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1694"></a><span class="k">      </span><span class="n">HcOutsideUserCurve</span><span class="p">(</span><span class="n">loop</span><span class="p">)%</span><span class="n">HnFnTempDiffCurveNum</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-1695"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">HcOutsideUserCurve</span><span class="p">(</span><span class="n">loop</span><span class="p">)%</span><span class="n">HnFnTempDiffCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1696"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetUserSuppliedConvectionCoefficients: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1697"></a>                              <span class="s1">&#39;Invalid Name Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-1698"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1699"></a>      <span class="k">ELSE</span> <span class="c">! check type</span>
<a name="ln-1700"></a>        <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">HcOutsideUserCurve</span><span class="p">(</span><span class="n">loop</span><span class="p">)%</span><span class="n">HnFnTempDiffCurveNum</span><span class="p">))</span>
<a name="ln-1701"></a>
<a name="ln-1702"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;LINEAR&#39;</span><span class="p">,</span> <span class="s1">&#39;QUADRATIC&#39;</span><span class="p">,</span> <span class="s1">&#39;CUBIC&#39;</span><span class="p">,</span> <span class="s1">&#39;EXPONENT&#39;</span><span class="p">,</span> <span class="s1">&#39;QUARTIC&#39;</span><span class="p">)</span>
<a name="ln-1703"></a>         <span class="c">!okay do nothing, have the right type of curve (single independent variable)</span>
<a name="ln-1704"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1705"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1706"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1707"></a>               <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)))))</span>
<a name="ln-1708"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1709"></a>        <span class="k">END SELECT</span>
<a name="ln-1710"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-1711"></a>    <span class="k">ELSE</span>
<a name="ln-1712"></a><span class="k">      </span><span class="n">HcOutsideUserCurve</span><span class="p">(</span><span class="n">loop</span><span class="p">)%</span><span class="n">HnFnTempDiffCurveNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1713"></a>    <span class="n">ENDIF</span>
<a name="ln-1714"></a>
<a name="ln-1715"></a>    <span class="c">!  A5 , \field Hn Function of Temperature Difference Divided by Height Curve Name</span>
<a name="ln-1716"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1717"></a><span class="k">      </span><span class="n">HcOutsideUserCurve</span><span class="p">(</span><span class="n">loop</span><span class="p">)%</span><span class="n">HnFnTempDiffDivHeightCurveNum</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-1718"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">HcOutsideUserCurve</span><span class="p">(</span><span class="n">loop</span><span class="p">)%</span><span class="n">HnFnTempDiffDivHeightCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1719"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetUserSuppliedConvectionCoefficients: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1720"></a>                              <span class="s1">&#39;Invalid Name Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-1721"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1722"></a>      <span class="k">ELSE</span> <span class="c">! check type</span>
<a name="ln-1723"></a>        <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">HcOutsideUserCurve</span><span class="p">(</span><span class="n">loop</span><span class="p">)%</span><span class="n">HnFnTempDiffDivHeightCurveNum</span><span class="p">))</span>
<a name="ln-1724"></a>
<a name="ln-1725"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;LINEAR&#39;</span><span class="p">,</span> <span class="s1">&#39;QUADRATIC&#39;</span><span class="p">,</span> <span class="s1">&#39;CUBIC&#39;</span><span class="p">,</span> <span class="s1">&#39;EXPONENT&#39;</span><span class="p">,</span> <span class="s1">&#39;QUARTIC&#39;</span><span class="p">)</span>
<a name="ln-1726"></a>         <span class="c">!okay do nothing, have the right type of curve (single independent variable)</span>
<a name="ln-1727"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1728"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1729"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1730"></a>               <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)))))</span>
<a name="ln-1731"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1732"></a>        <span class="k">END SELECT</span>
<a name="ln-1733"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-1734"></a>    <span class="k">ELSE</span>
<a name="ln-1735"></a><span class="k">      </span><span class="n">HcOutsideUserCurve</span><span class="p">(</span><span class="n">loop</span><span class="p">)%</span><span class="n">HnFnTempDiffDivHeightCurveNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1736"></a>    <span class="n">ENDIF</span>
<a name="ln-1737"></a>
<a name="ln-1738"></a>
<a name="ln-1739"></a>  <span class="n">ENDDO</span> <span class="c">! &#39;SurfaceConvectionAlgorithm:Outside:UserCurve&#39;</span>
<a name="ln-1740"></a>
<a name="ln-1741"></a>
<a name="ln-1742"></a>
<a name="ln-1743"></a>  <span class="c">! now get user directed overrides at the surface level.</span>
<a name="ln-1744"></a>  <span class="n">TotIntConvCoeff</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1745"></a>  <span class="n">TotExtConvCoeff</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1746"></a>  <span class="n">CurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;SurfaceProperty:ConvectionCoefficients:MultipleSurface&#39;</span>
<a name="ln-1747"></a>  <span class="nb">Count</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span>
<a name="ln-1748"></a>  <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="nb">Count</span>
<a name="ln-1749"></a><span class="nb">    </span><span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">Loop</span><span class="p">,</span><span class="n">Alphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">Numbers</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">Status</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1750"></a>                   <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1751"></a>                   <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-1752"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;INSIDE&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1753"></a><span class="k">      </span><span class="n">TotIntConvCoeff</span><span class="o">=</span><span class="n">TotIntConvCoeff</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1754"></a>    <span class="n">ENDIF</span>
<a name="ln-1755"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;INSIDE&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1756"></a><span class="k">      </span><span class="n">TotIntConvCoeff</span><span class="o">=</span><span class="n">TotIntConvCoeff</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1757"></a>    <span class="n">ENDIF</span>
<a name="ln-1758"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;OUTSIDE&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1759"></a><span class="k">      </span><span class="n">TotExtConvCoeff</span><span class="o">=</span><span class="n">TotExtConvCoeff</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1760"></a>    <span class="n">ENDIF</span>
<a name="ln-1761"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;OUTSIDE&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1762"></a><span class="k">      </span><span class="n">TotExtConvCoeff</span><span class="o">=</span><span class="n">TotExtConvCoeff</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1763"></a>    <span class="n">ENDIF</span>
<a name="ln-1764"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumAlphas</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1765"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;GetUserConvectionCoefficients: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1766"></a>                        <span class="s1">&#39; for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1767"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank and rest of fields will not be processed.&#39;</span><span class="p">)</span>
<a name="ln-1768"></a>    <span class="n">ENDIF</span>
<a name="ln-1769"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumAlphas</span> <span class="o">&gt;=</span> <span class="mi">6</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1770"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;GetUserConvectionCoefficients: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1771"></a>                        <span class="s1">&#39; for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1772"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank and rest of fields will not be processed.&#39;</span><span class="p">)</span>
<a name="ln-1773"></a>    <span class="n">ENDIF</span>
<a name="ln-1774"></a>  <span class="n">ENDDO</span>
<a name="ln-1775"></a>  <span class="n">CurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;SurfaceProperty:ConvectionCoefficients&#39;</span>
<a name="ln-1776"></a>  <span class="nb">Count</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span>
<a name="ln-1777"></a>  <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="nb">Count</span>
<a name="ln-1778"></a><span class="nb">    </span><span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">Loop</span><span class="p">,</span><span class="n">Alphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">Numbers</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">Status</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1779"></a>                   <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1780"></a>                   <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-1781"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;INSIDE&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1782"></a><span class="k">      </span><span class="n">TotIntConvCoeff</span><span class="o">=</span><span class="n">TotIntConvCoeff</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1783"></a>    <span class="n">ENDIF</span>
<a name="ln-1784"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;INSIDE&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1785"></a><span class="k">      </span><span class="n">TotIntConvCoeff</span><span class="o">=</span><span class="n">TotIntConvCoeff</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1786"></a>    <span class="n">ENDIF</span>
<a name="ln-1787"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;OUTSIDE&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1788"></a><span class="k">      </span><span class="n">TotExtConvCoeff</span><span class="o">=</span><span class="n">TotExtConvCoeff</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1789"></a>    <span class="n">ENDIF</span>
<a name="ln-1790"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;OUTSIDE&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1791"></a><span class="k">      </span><span class="n">TotExtConvCoeff</span><span class="o">=</span><span class="n">TotExtConvCoeff</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1792"></a>    <span class="n">ENDIF</span>
<a name="ln-1793"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumAlphas</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1794"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;GetUserConvectionCoefficients: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1795"></a>                        <span class="s1">&#39; for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1796"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank and rest of fields will not be processed.&#39;</span><span class="p">)</span>
<a name="ln-1797"></a>    <span class="n">ENDIF</span>
<a name="ln-1798"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumAlphas</span> <span class="o">&gt;=</span> <span class="mi">6</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1799"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;GetUserConvectionCoefficients: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1800"></a>                        <span class="s1">&#39; for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1801"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank and rest of fields will not be processed.&#39;</span><span class="p">)</span>
<a name="ln-1802"></a>    <span class="n">ENDIF</span>
<a name="ln-1803"></a>  <span class="n">ENDDO</span>
<a name="ln-1804"></a>
<a name="ln-1805"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">TotIntConvCoeff</span><span class="p">))</span>
<a name="ln-1806"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">TotExtConvCoeff</span><span class="p">))</span>
<a name="ln-1807"></a>
<a name="ln-1808"></a>  <span class="n">TotIntConvCoeff</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1809"></a>  <span class="n">TotExtConvCoeff</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1810"></a>
<a name="ln-1811"></a>  <span class="c">!   Now, get for real and check for consistency</span>
<a name="ln-1812"></a>  <span class="n">CurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;SurfaceProperty:ConvectionCoefficients&#39;</span>
<a name="ln-1813"></a>  <span class="nb">Count</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span>
<a name="ln-1814"></a>  <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="nb">Count</span>
<a name="ln-1815"></a><span class="nb">    </span><span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">Loop</span><span class="p">,</span><span class="n">Alphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">Numbers</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">Status</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1816"></a>                   <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1817"></a>                   <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-1818"></a>    <span class="n">Found</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Surface</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotSurfaces</span><span class="p">)</span>
<a name="ln-1819"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Found</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1820"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetUserConvectionCoefficients: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1821"></a>                           <span class="s1">&#39;illegal value for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1822"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1823"></a>      <span class="k">CYCLE</span>
<a name="ln-1824"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-1825"></a>
<a name="ln-1826"></a>    <span class="n">Ptr</span><span class="o">=</span><span class="mi">2</span>
<a name="ln-1827"></a>    <span class="n">FieldNo</span><span class="o">=</span><span class="mi">2</span>
<a name="ln-1828"></a>    <span class="n">NumField</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-1829"></a>    <span class="k">DO Pass</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
<a name="ln-1830"></a>
<a name="ln-1831"></a>      <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="p">))</span>
<a name="ln-1832"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;OUTSIDE&#39;</span><span class="p">)</span>
<a name="ln-1833"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">OSCPtr</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1834"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetUserSuppliedConvectionCoefficients: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1835"></a>                  <span class="s1">&#39;OUTSIDE &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; cannot be specified for OtherSideCoefficient Surface=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1836"></a>                  <span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1837"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1838"></a>          <span class="n">ENDIF</span>
<a name="ln-1839"></a>          <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1840"></a>          <span class="n">ExtValue</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1841"></a>          <span class="n">PotentialAssignedValue</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1842"></a>          <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumValidExtConvectionValueTypes</span>
<a name="ln-1843"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">/=</span> <span class="n">ValidExtConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">))</span> <span class="k">CYCLE</span>
<a name="ln-1844"></a><span class="k">            </span><span class="n">ExtValue</span><span class="o">=</span><span class="n">ExtConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-1845"></a>            <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1846"></a>            <span class="k">EXIT</span>
<a name="ln-1847"></a><span class="k">          </span><span class="n">ENDDO</span>
<a name="ln-1848"></a>
<a name="ln-1849"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsValidType</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">Loop1</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Loop1</span> <span class="o">&lt;=</span> <span class="mi">7</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1850"></a><span class="k">            </span><span class="n">PotentialAssignedValue</span><span class="o">=-</span><span class="n">ExtValue</span>
<a name="ln-1851"></a>          <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">IsValidType</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Loop1</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Value</span>
<a name="ln-1852"></a>            <span class="n">TotExtConvCoeff</span><span class="o">=</span><span class="n">TotExtConvCoeff</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1853"></a>            <span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">TotExtConvCoeff</span><span class="p">)%</span><span class="n">SurfaceName</span><span class="o">=</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1854"></a>            <span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">TotExtConvCoeff</span><span class="p">)%</span><span class="n">WhichSurface</span><span class="o">=</span><span class="n">Found</span>
<a name="ln-1855"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="n">NumField</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">LowHConvLimit</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">Numbers</span><span class="p">(</span><span class="n">NumField</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">HighHConvLimit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1856"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, out of range value&#39;</span><span class="p">)</span>
<a name="ln-1857"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">Ptr</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1858"></a>                 <span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="n">NumField</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="n">NumField</span><span class="p">),</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-1859"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Out-of-range from low/high limits=[&gt;=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">LowHConvLimit</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1860"></a>                 <span class="s1">&#39;&lt;=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">HighHConvLimit</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-1861"></a><span class="c">!            CALL RangeCheck(ErrFlag,&#39;&quot;&#39;//trim(cAlphaFieldNames(FieldNo+1))//&#39;&quot;&#39;,&#39;object&#39;,  &amp;</span>
<a name="ln-1862"></a><span class="c">!                       &#39;SEVERE&#39;,&#39;&gt;=&#39;//trim(RoundSigDigits(LowHConvLimit,9)),(Numbers(NumField)&gt;=LowHConvLimit),&amp;</span>
<a name="ln-1863"></a><span class="c">!                       &#39;&lt;=&#39;//trim(RoundSigDigits(HighHConvLimit,1)),(Numbers(NumField)&lt;=HighHConvLimit))</span>
<a name="ln-1864"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Limits are set (or default) in HeatBalanceAlgorithm object.&#39;</span><span class="p">)</span>
<a name="ln-1865"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1866"></a>              <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1867"></a>            <span class="n">ENDIF</span>
<a name="ln-1868"></a>            <span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">TotExtConvCoeff</span><span class="p">)%</span><span class="n">OverrideType</span><span class="o">=</span><span class="n">ConvCoefValue</span>
<a name="ln-1869"></a>            <span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">TotExtConvCoeff</span><span class="p">)%</span><span class="n">OverrideValue</span><span class="o">=</span><span class="n">Numbers</span><span class="p">(</span><span class="n">NumField</span><span class="p">)</span>
<a name="ln-1870"></a>            <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1871"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, duplicate value&#39;</span><span class="p">)</span>
<a name="ln-1872"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Since VALUE is used for &quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">FieldNo</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1873"></a>                                    <span class="s1">&#39;&quot;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1874"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is ignored.&#39;</span><span class="p">)</span>
<a name="ln-1875"></a>            <span class="n">ENDIF</span>
<a name="ln-1876"></a>            <span class="n">PotentialAssignedValue</span><span class="o">=</span><span class="n">TotExtConvCoeff</span>
<a name="ln-1877"></a>          <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">IsValidType</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Loop1</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Schedule</span>
<a name="ln-1878"></a>            <span class="n">TotExtConvCoeff</span><span class="o">=</span><span class="n">TotExtConvCoeff</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1879"></a>            <span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">TotExtConvCoeff</span><span class="p">)%</span><span class="n">SurfaceName</span><span class="o">=</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1880"></a>            <span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">TotExtConvCoeff</span><span class="p">)%</span><span class="n">WhichSurface</span><span class="o">=</span><span class="n">Found</span>
<a name="ln-1881"></a>            <span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">TotExtConvCoeff</span><span class="p">)%</span><span class="n">OverrideType</span><span class="o">=</span><span class="n">ConvCoefSchedule</span>
<a name="ln-1882"></a>            <span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">TotExtConvCoeff</span><span class="p">)%</span><span class="n">ScheduleIndex</span><span class="o">=</span><span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-1883"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">TotExtConvCoeff</span><span class="p">)%</span><span class="n">ScheduleIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1884"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-1885"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; entered=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-1886"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1887"></a>            <span class="k">ELSE</span>
<a name="ln-1888"></a><span class="k">              </span><span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">TotExtConvCoeff</span><span class="p">)%</span><span class="n">ScheduleName</span><span class="o">=</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1889"></a>            <span class="n">ENDIF</span>
<a name="ln-1890"></a>            <span class="n">PotentialAssignedValue</span><span class="o">=</span><span class="n">TotExtConvCoeff</span>
<a name="ln-1891"></a>          <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">IsValidType</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ExtValue</span> <span class="o">==</span> <span class="n">HcExt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! User curve</span>
<a name="ln-1892"></a>
<a name="ln-1893"></a>            <span class="n">TotExtConvCoeff</span><span class="o">=</span><span class="n">TotExtConvCoeff</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1894"></a>            <span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">TotExtConvCoeff</span><span class="p">)%</span><span class="n">SurfaceName</span><span class="o">=</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1895"></a>            <span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">TotExtConvCoeff</span><span class="p">)%</span><span class="n">WhichSurface</span><span class="o">=</span><span class="n">Found</span>
<a name="ln-1896"></a>            <span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">TotExtConvCoeff</span><span class="p">)%</span><span class="n">OverrideType</span><span class="o">=</span><span class="n">ConvCoefUserCurve</span>
<a name="ln-1897"></a>            <span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">TotExtConvCoeff</span><span class="p">)%</span><span class="n">UserCurveIndex</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">3</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1898"></a>                                                     <span class="n">HcOutsideUserCurve</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span> <span class="n">TotOutsideHcUserCurves</span><span class="p">)</span>
<a name="ln-1899"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">TotExtConvCoeff</span><span class="p">)%</span><span class="n">UserCurveIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1900"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-1901"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; entered=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1902"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1903"></a>            <span class="n">ENDIF</span>
<a name="ln-1904"></a>            <span class="n">PotentialAssignedValue</span><span class="o">=</span><span class="n">TotExtConvCoeff</span>
<a name="ln-1905"></a>          <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">IsValidType</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ExtValue</span> <span class="o">&gt;</span> <span class="n">HcExt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1906"></a>            <span class="c">! specificmodel</span>
<a name="ln-1907"></a>            <span class="n">TotExtConvCoeff</span><span class="o">=</span><span class="n">TotExtConvCoeff</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1908"></a>            <span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">TotExtConvCoeff</span><span class="p">)%</span><span class="n">SurfaceName</span><span class="o">=</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1909"></a>            <span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">TotExtConvCoeff</span><span class="p">)%</span><span class="n">WhichSurface</span><span class="o">=</span><span class="n">Found</span>
<a name="ln-1910"></a>            <span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">TotExtConvCoeff</span><span class="p">)%</span><span class="n">OverrideType</span><span class="o">=</span><span class="n">ConvCoefSpecifiedModel</span>
<a name="ln-1911"></a>            <span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">TotExtConvCoeff</span><span class="p">)%</span><span class="n">HcModelEq</span> <span class="o">=</span> <span class="n">ExtValue</span>
<a name="ln-1912"></a>            <span class="n">PotentialAssignedValue</span> <span class="o">=</span> <span class="n">TotExtConvCoeff</span>
<a name="ln-1913"></a>
<a name="ln-1914"></a>          <span class="k">ELSE</span>
<a name="ln-1915"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, check input&#39;</span><span class="p">)</span>
<a name="ln-1916"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Check Input Entered :&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1917"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1918"></a>          <span class="n">ENDIF</span>
<a name="ln-1919"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ExtConvCoeff</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1920"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-1921"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Duplicate (Outside) assignment attempt&#39;</span><span class="p">)</span>
<a name="ln-1922"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1923"></a>          <span class="k">ELSE</span>
<a name="ln-1924"></a><span class="k">            </span><span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">ExtConvCoeff</span><span class="o">=</span><span class="n">PotentialAssignedValue</span>
<a name="ln-1925"></a>          <span class="n">ENDIF</span>
<a name="ln-1926"></a>
<a name="ln-1927"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;INSIDE&#39;</span><span class="p">)</span>
<a name="ln-1928"></a>          <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1929"></a>          <span class="n">IntValue</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1930"></a>          <span class="n">PotentialAssignedValue</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1931"></a>          <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumValidIntConvectionValueTypes</span>
<a name="ln-1932"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">/=</span> <span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">))</span> <span class="k">CYCLE</span>
<a name="ln-1933"></a><span class="k">            </span><span class="n">IntValue</span><span class="o">=</span><span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-1934"></a>            <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1935"></a>            <span class="k">EXIT</span>
<a name="ln-1936"></a><span class="k">          </span><span class="n">ENDDO</span>
<a name="ln-1937"></a>
<a name="ln-1938"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsValidType</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Loop1</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Loop1</span> <span class="o">&lt;=</span> <span class="mi">5</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1939"></a><span class="k">            </span><span class="n">PotentialAssignedValue</span><span class="o">=-</span><span class="n">IntValue</span>
<a name="ln-1940"></a>          <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">IsValidType</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Loop1</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Value</span>
<a name="ln-1941"></a>            <span class="n">TotIntConvCoeff</span><span class="o">=</span><span class="n">TotIntConvCoeff</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1942"></a>            <span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">TotIntConvCoeff</span><span class="p">)%</span><span class="n">SurfaceName</span><span class="o">=</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1943"></a>            <span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">TotIntConvCoeff</span><span class="p">)%</span><span class="n">WhichSurface</span><span class="o">=</span><span class="n">Found</span>
<a name="ln-1944"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="n">NumField</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">LowHConvLimit</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">Numbers</span><span class="p">(</span><span class="n">NumField</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">HighHConvLimit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1945"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, out of range value&#39;</span><span class="p">)</span>
<a name="ln-1946"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">Ptr</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1947"></a>                 <span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="n">NumField</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="n">NumField</span><span class="p">),</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-1948"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Out-of-range from low/high limits=[&gt;=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">LowHConvLimit</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1949"></a>                 <span class="s1">&#39;&lt;=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">HighHConvLimit</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-1950"></a><span class="c">!            CALL RangeCheck(ErrFlag,&#39;&quot;&#39;//trim(cAlphaFieldNames(FieldNo+1))//&#39;&quot;&#39;,&#39;object&#39;,  &amp;</span>
<a name="ln-1951"></a><span class="c">!                       &#39;SEVERE&#39;,&#39;&gt;=&#39;//trim(RoundSigDigits(LowHConvLimit,9)),(Numbers(NumField)&gt;=LowHConvLimit),&amp;</span>
<a name="ln-1952"></a><span class="c">!                       &#39;&lt;=&#39;//trim(RoundSigDigits(HighHConvLimit,1)),(Numbers(NumField)&lt;=HighHConvLimit))</span>
<a name="ln-1953"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Limits are set (or default) in HeatBalanceAlgorithm object.&#39;</span><span class="p">)</span>
<a name="ln-1954"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1955"></a>              <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1956"></a>            <span class="n">ENDIF</span>
<a name="ln-1957"></a>            <span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">TotIntConvCoeff</span><span class="p">)%</span><span class="n">OverrideType</span><span class="o">=</span><span class="n">ConvCoefValue</span>
<a name="ln-1958"></a>            <span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">TotIntConvCoeff</span><span class="p">)%</span><span class="n">OverrideValue</span><span class="o">=</span><span class="n">Numbers</span><span class="p">(</span><span class="n">NumField</span><span class="p">)</span>
<a name="ln-1959"></a>            <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1960"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, duplicate value&#39;</span><span class="p">)</span>
<a name="ln-1961"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Since VALUE is used for &quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">FieldNo</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1962"></a>                                    <span class="s1">&#39;&quot;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1963"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is ignored.&#39;</span><span class="p">)</span>
<a name="ln-1964"></a>            <span class="n">ENDIF</span>
<a name="ln-1965"></a>            <span class="n">PotentialAssignedValue</span><span class="o">=</span><span class="n">TotIntConvCoeff</span>
<a name="ln-1966"></a>          <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">IsValidType</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Loop1</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Schedule</span>
<a name="ln-1967"></a>            <span class="n">TotIntConvCoeff</span><span class="o">=</span><span class="n">TotIntConvCoeff</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1968"></a>            <span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">TotIntConvCoeff</span><span class="p">)%</span><span class="n">SurfaceName</span><span class="o">=</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1969"></a>            <span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">TotIntConvCoeff</span><span class="p">)%</span><span class="n">WhichSurface</span><span class="o">=</span><span class="n">Found</span>
<a name="ln-1970"></a>            <span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">TotIntConvCoeff</span><span class="p">)%</span><span class="n">OverrideType</span><span class="o">=</span><span class="n">ConvCoefSchedule</span>
<a name="ln-1971"></a>            <span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">TotIntConvCoeff</span><span class="p">)%</span><span class="n">ScheduleIndex</span><span class="o">=</span><span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-1972"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">TotIntConvCoeff</span><span class="p">)%</span><span class="n">ScheduleIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1973"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-1974"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; entered=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-1975"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1976"></a>            <span class="k">ELSE</span>
<a name="ln-1977"></a><span class="k">              </span><span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">TotIntConvCoeff</span><span class="p">)%</span><span class="n">ScheduleName</span><span class="o">=</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1978"></a>            <span class="n">ENDIF</span>
<a name="ln-1979"></a>            <span class="n">PotentialAssignedValue</span><span class="o">=</span><span class="n">TotIntConvCoeff</span>
<a name="ln-1980"></a>          <span class="n">ELSEIF</span> <span class="p">(</span> <span class="n">IsValidType</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">IntValue</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1981"></a><span class="k">            </span><span class="n">TotIntConvCoeff</span><span class="o">=</span><span class="n">TotIntConvCoeff</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1982"></a>            <span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">TotIntConvCoeff</span><span class="p">)%</span><span class="n">SurfaceName</span><span class="o">=</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1983"></a>            <span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">TotIntConvCoeff</span><span class="p">)%</span><span class="n">WhichSurface</span><span class="o">=</span><span class="n">Found</span>
<a name="ln-1984"></a>            <span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">TotIntConvCoeff</span><span class="p">)%</span><span class="n">OverrideType</span><span class="o">=</span><span class="n">ConvCoefUserCurve</span>
<a name="ln-1985"></a>            <span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">TotIntConvCoeff</span><span class="p">)%</span><span class="n">UserCurveIndex</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">3</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1986"></a>                                                                     <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span> <span class="n">TotInsideHcUserCurves</span><span class="p">)</span>
<a name="ln-1987"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">TotIntConvCoeff</span><span class="p">)%</span><span class="n">UserCurveIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1988"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-1989"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; entered=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1990"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1991"></a>            <span class="n">ENDIF</span>
<a name="ln-1992"></a>            <span class="n">PotentialAssignedValue</span><span class="o">=</span><span class="n">TotIntConvCoeff</span>
<a name="ln-1993"></a>          <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">IsValidType</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">IntValue</span> <span class="o">&gt;</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1994"></a>            <span class="c">! specificmodel</span>
<a name="ln-1995"></a>            <span class="n">TotIntConvCoeff</span><span class="o">=</span><span class="n">TotIntConvCoeff</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1996"></a>            <span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">TotIntConvCoeff</span><span class="p">)%</span><span class="n">SurfaceName</span><span class="o">=</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1997"></a>            <span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">TotIntConvCoeff</span><span class="p">)%</span><span class="n">WhichSurface</span><span class="o">=</span><span class="n">Found</span>
<a name="ln-1998"></a>            <span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">TotIntConvCoeff</span><span class="p">)%</span><span class="n">OverrideType</span><span class="o">=</span><span class="n">ConvCoefSpecifiedModel</span>
<a name="ln-1999"></a>            <span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">TotIntConvCoeff</span><span class="p">)%</span><span class="n">HcModelEq</span>   <span class="o">=</span> <span class="n">IntValue</span>
<a name="ln-2000"></a>            <span class="n">PotentialAssignedValue</span> <span class="o">=</span> <span class="n">TotIntConvCoeff</span>
<a name="ln-2001"></a>
<a name="ln-2002"></a>
<a name="ln-2003"></a>          <span class="k">ELSE</span>
<a name="ln-2004"></a>            <span class="c">! treat CeilingDiffuser and TrombeWall special</span>
<a name="ln-2005"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="s1">&#39;CEILINGDIFFUSER&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="s1">&#39;TROMBEWALL&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2006"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2007"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Value Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">Ptr</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="p">)))</span>
<a name="ln-2008"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;invalid value in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2009"></a>                                     <span class="s1">&#39;&quot;. This type is only applicable at a Zone level.&#39;</span><span class="p">)</span>
<a name="ln-2010"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2011"></a>            <span class="k">ELSE</span>  <span class="c">! really invalid</span>
<a name="ln-2012"></a>              <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2013"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Value Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">Ptr</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="p">)))</span>
<a name="ln-2014"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;invalid value in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2015"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2016"></a>            <span class="n">ENDIF</span>
<a name="ln-2017"></a>          <span class="n">ENDIF</span>
<a name="ln-2018"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">IntConvCoeff</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2019"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, duplicate (inside)&#39;</span><span class="p">)</span>
<a name="ln-2020"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Duplicate (Inside) assignment attempt.&#39;</span><span class="p">)</span>
<a name="ln-2021"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2022"></a>          <span class="k">ELSE</span>
<a name="ln-2023"></a><span class="k">            </span><span class="n">Surface</span><span class="p">(</span><span class="n">Found</span><span class="p">)%</span><span class="n">IntConvCoeff</span><span class="o">=</span><span class="n">PotentialAssignedValue</span>
<a name="ln-2024"></a>          <span class="n">ENDIF</span>
<a name="ln-2025"></a>
<a name="ln-2026"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>  <span class="c">! Blank</span>
<a name="ln-2027"></a>
<a name="ln-2028"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2029"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2030"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Value Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">Ptr</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="p">)))</span>
<a name="ln-2031"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2032"></a>      <span class="k">END SELECT</span>
<a name="ln-2033"></a>
<a name="ln-2034"></a><span class="k">      </span><span class="n">Ptr</span><span class="o">=</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">4</span>
<a name="ln-2035"></a>      <span class="n">FieldNo</span><span class="o">=</span><span class="n">FieldNo</span><span class="o">+</span><span class="mi">4</span>
<a name="ln-2036"></a>      <span class="n">NumField</span><span class="o">=</span><span class="n">NumField</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2037"></a>    <span class="n">ENDDO</span>
<a name="ln-2038"></a>  <span class="n">ENDDO</span>
<a name="ln-2039"></a>
<a name="ln-2040"></a>  <span class="n">CurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;SurfaceProperty:ConvectionCoefficients:MultipleSurface&#39;</span>
<a name="ln-2041"></a>  <span class="nb">Count</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span>
<a name="ln-2042"></a>  <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="nb">Count</span>
<a name="ln-2043"></a><span class="nb">    </span><span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">Loop</span><span class="p">,</span><span class="n">Alphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">Numbers</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">Status</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2044"></a>                   <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2045"></a>                   <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-2046"></a>    <span class="c">! Check Field 1 for validity</span>
<a name="ln-2047"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2048"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumValidSurfaceTypes</span>
<a name="ln-2049"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">/=</span> <span class="n">ValidSurfaceTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">))</span> <span class="k">CYCLE</span>
<a name="ln-2050"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2051"></a>      <span class="k">EXIT</span>
<a name="ln-2052"></a><span class="k">    </span><span class="n">ENDDO</span>
<a name="ln-2053"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2054"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2055"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;illegal value for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2056"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2057"></a>      <span class="k">CYCLE</span>
<a name="ln-2058"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-2059"></a>    <span class="n">Ptr</span><span class="o">=</span><span class="mi">2</span>
<a name="ln-2060"></a>    <span class="n">FieldNo</span><span class="o">=</span><span class="mi">2</span>
<a name="ln-2061"></a>    <span class="n">NumField</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-2062"></a>    <span class="k">DO Pass</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
<a name="ln-2063"></a>
<a name="ln-2064"></a>      <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="p">))</span>
<a name="ln-2065"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;OUTSIDE&#39;</span><span class="p">)</span>
<a name="ln-2066"></a>          <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2067"></a>          <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumValidExtConvectionValueTypes</span>
<a name="ln-2068"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">/=</span> <span class="n">ValidExtConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">))</span> <span class="k">CYCLE</span>
<a name="ln-2069"></a><span class="k">            </span><span class="n">ExtValue</span><span class="o">=</span><span class="n">ExtConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-2070"></a>            <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2071"></a>            <span class="k">EXIT</span>
<a name="ln-2072"></a><span class="k">          </span><span class="n">ENDDO</span>
<a name="ln-2073"></a>
<a name="ln-2074"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsValidType</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">Loop1</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Loop1</span> <span class="o">&lt;=</span><span class="mi">7</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2075"></a><span class="k">            CALL </span><span class="n">ApplyConvectionValue</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="s1">&#39;OUTSIDE&#39;</span><span class="p">,</span><span class="o">-</span><span class="n">ExtValue</span><span class="p">)</span>
<a name="ln-2076"></a>          <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">IsValidType</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Loop1</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Value</span>
<a name="ln-2077"></a>            <span class="c">! SimpleValueAssignment via UserExtConvectionCoeffs array</span>
<a name="ln-2078"></a>            <span class="n">TotExtConvCoeff</span><span class="o">=</span><span class="n">TotExtConvCoeff</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2079"></a>            <span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">TotExtConvCoeff</span><span class="p">)%</span><span class="n">SurfaceName</span><span class="o">=</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="p">)</span>
<a name="ln-2080"></a>            <span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">TotExtConvCoeff</span><span class="p">)%</span><span class="n">WhichSurface</span><span class="o">=-</span><span class="mi">999</span>
<a name="ln-2081"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="n">NumField</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">LowHConvLimit</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">Numbers</span><span class="p">(</span><span class="n">NumField</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">HighHConvLimit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2082"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, out of range value&#39;</span><span class="p">)</span>
<a name="ln-2083"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">Ptr</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2084"></a>                 <span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="n">NumField</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="n">NumField</span><span class="p">),</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-2085"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Out-of-range from low/high limits=[&gt;=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">LowHConvLimit</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2086"></a>                 <span class="s1">&#39;&lt;=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">HighHConvLimit</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-2087"></a><span class="c">!            CALL RangeCheck(ErrFlag,&#39;&quot;&#39;//trim(cAlphaFieldNames(FieldNo+1))//&#39;&quot;&#39;,&#39;object&#39;,  &amp;</span>
<a name="ln-2088"></a><span class="c">!                       &#39;SEVERE&#39;,&#39;&gt;=&#39;//trim(RoundSigDigits(LowHConvLimit,9)),(Numbers(NumField)&gt;=LowHConvLimit),&amp;</span>
<a name="ln-2089"></a><span class="c">!                       &#39;&lt;=&#39;//trim(RoundSigDigits(HighHConvLimit,1)),(Numbers(NumField)&lt;=HighHConvLimit))</span>
<a name="ln-2090"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Limits are set (or default) in HeatBalanceAlgorithm object.&#39;</span><span class="p">)</span>
<a name="ln-2091"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2092"></a>              <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2093"></a>            <span class="n">ENDIF</span>
<a name="ln-2094"></a>            <span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">TotExtConvCoeff</span><span class="p">)%</span><span class="n">OverrideType</span><span class="o">=</span><span class="n">ConvCoefValue</span>
<a name="ln-2095"></a>            <span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">TotExtConvCoeff</span><span class="p">)%</span><span class="n">OverrideValue</span><span class="o">=</span><span class="n">Numbers</span><span class="p">(</span><span class="n">NumField</span><span class="p">)</span>
<a name="ln-2096"></a>            <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2097"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, duplicate value&#39;</span><span class="p">)</span>
<a name="ln-2098"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Since VALUE is used for &quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">FieldNo</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2099"></a>                                    <span class="s1">&#39;&quot;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2100"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is ignored.&#39;</span><span class="p">)</span>
<a name="ln-2101"></a>            <span class="n">ENDIF</span>
<a name="ln-2102"></a>            <span class="k">CALL </span><span class="n">ApplyConvectionValue</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="s1">&#39;OUTSIDE&#39;</span><span class="p">,</span><span class="n">TotExtConvCoeff</span><span class="p">)</span>
<a name="ln-2103"></a>          <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">IsValidType</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Loop1</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Schedule</span>
<a name="ln-2104"></a>            <span class="n">TotExtConvCoeff</span><span class="o">=</span><span class="n">TotExtConvCoeff</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2105"></a>            <span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">TotExtConvCoeff</span><span class="p">)%</span><span class="n">SurfaceName</span><span class="o">=</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="p">)</span>
<a name="ln-2106"></a>            <span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">TotExtConvCoeff</span><span class="p">)%</span><span class="n">WhichSurface</span><span class="o">=-</span><span class="mi">999</span>
<a name="ln-2107"></a>            <span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">TotExtConvCoeff</span><span class="p">)%</span><span class="n">OverrideType</span><span class="o">=</span><span class="n">ConvCoefSchedule</span>
<a name="ln-2108"></a>            <span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">TotExtConvCoeff</span><span class="p">)%</span><span class="n">ScheduleIndex</span><span class="o">=</span><span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-2109"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">TotExtConvCoeff</span><span class="p">)%</span><span class="n">ScheduleIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2110"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2111"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; entered=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-2112"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2113"></a>            <span class="k">ELSE</span>
<a name="ln-2114"></a><span class="k">              </span><span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">TotExtConvCoeff</span><span class="p">)%</span><span class="n">ScheduleName</span><span class="o">=</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-2115"></a>            <span class="n">ENDIF</span>
<a name="ln-2116"></a>            <span class="k">CALL </span><span class="n">ApplyConvectionValue</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="s1">&#39;OUTSIDE&#39;</span><span class="p">,</span><span class="n">TotExtConvCoeff</span><span class="p">)</span>
<a name="ln-2117"></a>          <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">IsValidType</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ExtValue</span> <span class="o">==</span> <span class="n">HcExt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! User curve</span>
<a name="ln-2118"></a>            <span class="n">TotExtConvCoeff</span><span class="o">=</span><span class="n">TotExtConvCoeff</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2119"></a>            <span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">TotExtConvCoeff</span><span class="p">)%</span><span class="n">SurfaceName</span><span class="o">=</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="p">)</span>
<a name="ln-2120"></a>            <span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">TotExtConvCoeff</span><span class="p">)%</span><span class="n">WhichSurface</span><span class="o">=-</span><span class="mi">999</span>
<a name="ln-2121"></a>            <span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">TotExtConvCoeff</span><span class="p">)%</span><span class="n">OverrideType</span><span class="o">=</span><span class="n">ConvCoefUserCurve</span>
<a name="ln-2122"></a>            <span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">TotExtConvCoeff</span><span class="p">)%</span><span class="n">UserCurveIndex</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">3</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2123"></a>                                                     <span class="n">HcOutsideUserCurve</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span> <span class="n">TotOutsideHcUserCurves</span><span class="p">)</span>
<a name="ln-2124"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">TotExtConvCoeff</span><span class="p">)%</span><span class="n">UserCurveIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2125"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2126"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; entered=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-2127"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2128"></a>            <span class="n">ENDIF</span>
<a name="ln-2129"></a>            <span class="n">PotentialAssignedValue</span><span class="o">=</span><span class="n">TotExtConvCoeff</span>
<a name="ln-2130"></a>            <span class="k">CALL </span><span class="n">ApplyConvectionValue</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="s1">&#39;OUTSIDE&#39;</span><span class="p">,</span><span class="n">TotExtConvCoeff</span><span class="p">)</span>
<a name="ln-2131"></a>
<a name="ln-2132"></a>          <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">IsValidType</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ExtValue</span> <span class="o">&gt;</span> <span class="n">HcExt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2133"></a>            <span class="c">! specificmodel</span>
<a name="ln-2134"></a>            <span class="n">TotExtConvCoeff</span><span class="o">=</span><span class="n">TotExtConvCoeff</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2135"></a>            <span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">TotExtConvCoeff</span><span class="p">)%</span><span class="n">SurfaceName</span><span class="o">=</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="p">)</span>
<a name="ln-2136"></a>            <span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">TotExtConvCoeff</span><span class="p">)%</span><span class="n">WhichSurface</span><span class="o">=-</span><span class="mi">999</span>
<a name="ln-2137"></a>            <span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">TotExtConvCoeff</span><span class="p">)%</span><span class="n">OverrideType</span><span class="o">=</span><span class="n">ConvCoefSpecifiedModel</span>
<a name="ln-2138"></a>            <span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">TotExtConvCoeff</span><span class="p">)%</span><span class="n">HcModelEq</span> <span class="o">=</span> <span class="n">ExtValue</span>
<a name="ln-2139"></a>            <span class="n">PotentialAssignedValue</span> <span class="o">=</span> <span class="n">TotExtConvCoeff</span>
<a name="ln-2140"></a>            <span class="k">CALL </span><span class="n">ApplyConvectionValue</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="s1">&#39;OUTSIDE&#39;</span><span class="p">,</span><span class="n">TotExtConvCoeff</span><span class="p">)</span>
<a name="ln-2141"></a>          <span class="k">ELSE</span>
<a name="ln-2142"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, check input&#39;</span><span class="p">)</span>
<a name="ln-2143"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Check Input Entered :&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2144"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2145"></a>          <span class="n">ENDIF</span>
<a name="ln-2146"></a>
<a name="ln-2147"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;INSIDE&#39;</span><span class="p">)</span>
<a name="ln-2148"></a>          <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2149"></a>          <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumValidIntConvectionValueTypes</span>
<a name="ln-2150"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">/=</span> <span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">))</span> <span class="k">CYCLE</span>
<a name="ln-2151"></a><span class="k">            </span><span class="n">IntValue</span><span class="o">=</span><span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-2152"></a>            <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2153"></a>            <span class="k">EXIT</span>
<a name="ln-2154"></a><span class="k">          </span><span class="n">ENDDO</span>
<a name="ln-2155"></a>
<a name="ln-2156"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsValidType</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Loop1</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="p">).</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Loop1</span> <span class="o">&lt;=</span> <span class="mi">5</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2157"></a><span class="k">            CALL </span><span class="n">ApplyConvectionValue</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="s1">&#39;INSIDE&#39;</span><span class="p">,</span><span class="o">-</span><span class="n">IntValue</span><span class="p">)</span>
<a name="ln-2158"></a>          <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">IsValidType</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Loop1</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Value</span>
<a name="ln-2159"></a>            <span class="c">! SimpleValueAssignment via UserExtConvectionCoeffs array</span>
<a name="ln-2160"></a>            <span class="n">TotIntConvCoeff</span><span class="o">=</span><span class="n">TotIntConvCoeff</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2161"></a>            <span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">TotIntConvCoeff</span><span class="p">)%</span><span class="n">SurfaceName</span><span class="o">=</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="p">)</span>
<a name="ln-2162"></a>            <span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">TotIntConvCoeff</span><span class="p">)%</span><span class="n">WhichSurface</span><span class="o">=-</span><span class="mi">999</span>
<a name="ln-2163"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="n">NumField</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">LowHConvLimit</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">Numbers</span><span class="p">(</span><span class="n">NumField</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">HighHConvLimit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2164"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, out of range value&#39;</span><span class="p">)</span>
<a name="ln-2165"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">Ptr</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2166"></a>                 <span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="n">NumField</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="n">NumField</span><span class="p">),</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-2167"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Out-of-range from low/high limits=[&gt;=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">LowHConvLimit</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2168"></a>                 <span class="s1">&#39;&lt;=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">HighHConvLimit</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-2169"></a><span class="c">!            CALL RangeCheck(ErrFlag,&#39;&quot;&#39;//trim(cAlphaFieldNames(FieldNo+1))//&#39;&quot;&#39;,&#39;object&#39;,  &amp;</span>
<a name="ln-2170"></a><span class="c">!                       &#39;SEVERE&#39;,&#39;&gt;=&#39;//trim(RoundSigDigits(LowHConvLimit,9)),(Numbers(NumField)&gt;=LowHConvLimit),&amp;</span>
<a name="ln-2171"></a><span class="c">!                       &#39;&lt;=&#39;//trim(RoundSigDigits(HighHConvLimit,1)),(Numbers(NumField)&lt;=HighHConvLimit))</span>
<a name="ln-2172"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Limits are set (or default) in HeatBalanceAlgorithm object.&#39;</span><span class="p">)</span>
<a name="ln-2173"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2174"></a>              <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2175"></a>            <span class="n">ENDIF</span>
<a name="ln-2176"></a>            <span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">TotIntConvCoeff</span><span class="p">)%</span><span class="n">OverrideType</span><span class="o">=</span><span class="n">ConvCoefValue</span>
<a name="ln-2177"></a>            <span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">TotIntConvCoeff</span><span class="p">)%</span><span class="n">OverrideValue</span><span class="o">=</span><span class="n">Numbers</span><span class="p">(</span><span class="n">NumField</span><span class="p">)</span>
<a name="ln-2178"></a>            <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2179"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, duplicate value&#39;</span><span class="p">)</span>
<a name="ln-2180"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Since VALUE is used for &quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">FieldNo</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2181"></a>                                    <span class="s1">&#39;&quot;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2182"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is ignored.&#39;</span><span class="p">)</span>
<a name="ln-2183"></a>            <span class="n">ENDIF</span>
<a name="ln-2184"></a>            <span class="k">CALL </span><span class="n">ApplyConvectionValue</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="s1">&#39;INSIDE&#39;</span><span class="p">,</span><span class="n">TotIntConvCoeff</span><span class="p">)</span>
<a name="ln-2185"></a>          <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">IsValidType</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Loop1</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Schedule</span>
<a name="ln-2186"></a>            <span class="n">TotIntConvCoeff</span><span class="o">=</span><span class="n">TotIntConvCoeff</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2187"></a>            <span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">TotIntConvCoeff</span><span class="p">)%</span><span class="n">SurfaceName</span><span class="o">=</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="p">)</span>
<a name="ln-2188"></a>            <span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">TotIntConvCoeff</span><span class="p">)%</span><span class="n">WhichSurface</span><span class="o">=-</span><span class="mi">999</span>
<a name="ln-2189"></a>            <span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">TotIntConvCoeff</span><span class="p">)%</span><span class="n">OverrideType</span><span class="o">=</span><span class="n">ConvCoefSchedule</span>
<a name="ln-2190"></a>            <span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">TotIntConvCoeff</span><span class="p">)%</span><span class="n">ScheduleIndex</span><span class="o">=</span><span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-2191"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">TotIntConvCoeff</span><span class="p">)%</span><span class="n">ScheduleIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2192"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2193"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; entered=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-2194"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2195"></a>            <span class="k">ELSE</span>
<a name="ln-2196"></a><span class="k">              </span><span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">TotIntConvCoeff</span><span class="p">)%</span><span class="n">ScheduleName</span><span class="o">=</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-2197"></a>            <span class="n">ENDIF</span>
<a name="ln-2198"></a>            <span class="k">CALL </span><span class="n">ApplyConvectionValue</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="s1">&#39;INSIDE&#39;</span><span class="p">,</span><span class="n">TotIntConvCoeff</span><span class="p">)</span>
<a name="ln-2199"></a>          <span class="n">ELSEIF</span> <span class="p">(</span> <span class="n">IsValidType</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">IntValue</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2200"></a><span class="k">            </span><span class="n">TotIntConvCoeff</span><span class="o">=</span><span class="n">TotIntConvCoeff</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2201"></a>            <span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">TotIntConvCoeff</span><span class="p">)%</span><span class="n">SurfaceName</span><span class="o">=</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="p">)</span>
<a name="ln-2202"></a>            <span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">TotIntConvCoeff</span><span class="p">)%</span><span class="n">WhichSurface</span><span class="o">=-</span><span class="mi">999</span>
<a name="ln-2203"></a>            <span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">TotIntConvCoeff</span><span class="p">)%</span><span class="n">OverrideType</span><span class="o">=</span><span class="n">ConvCoefUserCurve</span>
<a name="ln-2204"></a>            <span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">TotIntConvCoeff</span><span class="p">)%</span><span class="n">UserCurveIndex</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">3</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2205"></a>                                                                     <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span> <span class="n">TotInsideHcUserCurves</span><span class="p">)</span>
<a name="ln-2206"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">TotIntConvCoeff</span><span class="p">)%</span><span class="n">UserCurveIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2207"></a>
<a name="ln-2208"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2209"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; entered=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-2210"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2211"></a>            <span class="n">ENDIF</span>
<a name="ln-2212"></a>            <span class="n">PotentialAssignedValue</span><span class="o">=</span><span class="n">TotIntConvCoeff</span>
<a name="ln-2213"></a>            <span class="k">CALL </span><span class="n">ApplyConvectionValue</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="s1">&#39;INSIDE&#39;</span><span class="p">,</span><span class="n">TotIntConvCoeff</span><span class="p">)</span>
<a name="ln-2214"></a>          <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">IsValidType</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">IntValue</span> <span class="o">&gt;</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2215"></a>            <span class="c">! specificmodel</span>
<a name="ln-2216"></a>            <span class="n">TotIntConvCoeff</span><span class="o">=</span><span class="n">TotIntConvCoeff</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2217"></a>            <span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">TotIntConvCoeff</span><span class="p">)%</span><span class="n">SurfaceName</span><span class="o">=</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="p">)</span>
<a name="ln-2218"></a>            <span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">TotIntConvCoeff</span><span class="p">)%</span><span class="n">WhichSurface</span><span class="o">=-</span><span class="mi">999</span>
<a name="ln-2219"></a>            <span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">TotIntConvCoeff</span><span class="p">)%</span><span class="n">OverrideType</span><span class="o">=</span><span class="n">ConvCoefSpecifiedModel</span>
<a name="ln-2220"></a>            <span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">TotIntConvCoeff</span><span class="p">)%</span><span class="n">HcModelEq</span>   <span class="o">=</span> <span class="n">IntValue</span>
<a name="ln-2221"></a>            <span class="n">PotentialAssignedValue</span> <span class="o">=</span> <span class="n">TotIntConvCoeff</span>
<a name="ln-2222"></a>            <span class="k">CALL </span><span class="n">ApplyConvectionValue</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="s1">&#39;INSIDE&#39;</span><span class="p">,</span><span class="n">TotIntConvCoeff</span><span class="p">)</span>
<a name="ln-2223"></a>
<a name="ln-2224"></a>          <span class="k">ELSE</span>
<a name="ln-2225"></a>            <span class="c">! treat CeilingDiffuser and TrombeWall special</span>
<a name="ln-2226"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="s1">&#39;CEILINGDIFFUSER&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="s1">&#39;TROMBEWALL&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2227"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2228"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">Ptr</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; entered=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="p">)))</span>
<a name="ln-2229"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;invalid value in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2230"></a>                                     <span class="s1">&#39;&quot;. This type is only applicable at a Zone level.&#39;</span><span class="p">)</span>
<a name="ln-2231"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2232"></a>            <span class="k">ELSE</span>  <span class="c">! really invalid</span>
<a name="ln-2233"></a>              <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2234"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; entered=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2235"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2236"></a>            <span class="n">ENDIF</span>
<a name="ln-2237"></a>          <span class="n">ENDIF</span>
<a name="ln-2238"></a>
<a name="ln-2239"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>  <span class="c">! Blank</span>
<a name="ln-2240"></a>
<a name="ln-2241"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>  <span class="c">! Error Case</span>
<a name="ln-2242"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2243"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">Ptr</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; entered=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">Ptr</span><span class="p">)))</span>
<a name="ln-2244"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2245"></a>      <span class="k">END SELECT</span>
<a name="ln-2246"></a>
<a name="ln-2247"></a><span class="k">      </span><span class="n">Ptr</span><span class="o">=</span><span class="n">Ptr</span><span class="o">+</span><span class="mi">4</span>
<a name="ln-2248"></a>      <span class="n">FieldNo</span><span class="o">=</span><span class="n">FieldNo</span><span class="o">+</span><span class="mi">4</span>
<a name="ln-2249"></a>      <span class="n">NumField</span><span class="o">=</span><span class="n">NumField</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2250"></a>    <span class="n">ENDDO</span>
<a name="ln-2251"></a>  <span class="n">ENDDO</span>
<a name="ln-2252"></a>
<a name="ln-2253"></a>  <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotIntConvCoeff</span>
<a name="ln-2254"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">OverrideType</span> <span class="o">/=</span> <span class="n">ConvCoefSchedule</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-2255"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">ScheduleIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-2256"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">CheckScheduleValueMinMax</span><span class="p">(</span><span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">ScheduleIndex</span><span class="p">,</span><span class="s1">&#39;&gt;=&#39;</span><span class="p">,</span><span class="n">LowHConvLimit</span><span class="p">,</span><span class="s1">&#39;&lt;=&#39;</span><span class="p">,</span><span class="n">HighHConvLimit</span><span class="p">))</span> <span class="k">CYCLE</span>
<a name="ln-2257"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Surface=&quot;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2258"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">SurfaceName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, out-of-range convection coefficient:&#39;</span><span class="p">)</span>
<a name="ln-2259"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Out-of-range value found in schedule=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">ScheduleName</span><span class="p">))</span>
<a name="ln-2260"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User supplied convection coefficients must be in range [&gt;=&#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2261"></a>                           <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">LowHConvLimit</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, &lt;=&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2262"></a>                           <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">HighHConvLimit</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-2263"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Limits are set (or default) in HeatBalanceAlgorithm object.&#39;</span><span class="p">)</span>
<a name="ln-2264"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2265"></a>  <span class="n">ENDDO</span>
<a name="ln-2266"></a>
<a name="ln-2267"></a>  <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotExtConvCoeff</span>
<a name="ln-2268"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">OverrideType</span> <span class="o">/=</span> <span class="n">ConvCoefSchedule</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-2269"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">ScheduleIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-2270"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">CheckScheduleValueMinMax</span><span class="p">(</span><span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">ScheduleIndex</span><span class="p">,</span><span class="s1">&#39;&gt;=&#39;</span><span class="p">,</span><span class="n">LowHConvLimit</span><span class="p">,</span><span class="s1">&#39;&lt;=&#39;</span><span class="p">,</span><span class="n">HighHConvLimit</span><span class="p">))</span> <span class="k">CYCLE</span>
<a name="ln-2271"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Surface=&quot;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2272"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">SurfaceName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, out-of-range convection coefficient:&#39;</span><span class="p">)</span>
<a name="ln-2273"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Out-of-range value found in schedule=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">ScheduleName</span><span class="p">))</span>
<a name="ln-2274"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User supplied convection coefficients must be in range [&gt;=&#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2275"></a>                           <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">LowHConvLimit</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, &lt;=&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2276"></a>                           <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">HighHConvLimit</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-2277"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Limits are set (or default) in HeatBalanceAlgorithm object.&#39;</span><span class="p">)</span>
<a name="ln-2278"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2279"></a>  <span class="n">ENDDO</span>
<a name="ln-2280"></a>
<a name="ln-2281"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DefaultOutsideConvectionAlgo</span> <span class="o">==</span> <span class="n">ASHRAESimple</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="nb">ANY</span><span class="p">(</span><span class="n">Zone</span><span class="p">%</span><span class="n">OutsideConvectionAlgo</span> <span class="o">==</span> <span class="n">ASHRAESimple</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2282"></a><span class="k">    </span><span class="nb">Count</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-2283"></a>    <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotExtConvCoeff</span>
<a name="ln-2284"></a>      <span class="n">SurfNum</span><span class="o">=</span><span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">WhichSurface</span>
<a name="ln-2285"></a>      <span class="c">! Tests show that Zone will override the simple convection specification of global.</span>
<a name="ln-2286"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SurfNum</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>  <span class="c">! ignore this error condition</span>
<a name="ln-2287"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>  <span class="c">! ignore this error condition</span>
<a name="ln-2288"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)%</span><span class="n">OutsideConvectionAlgo</span> <span class="o">==</span> <span class="n">ASHRAESimple</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-2289"></a>          <span class="p">(</span><span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">OverrideType</span> <span class="o">==</span> <span class="n">ConvCoefSpecifiedModel</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-2290"></a>           <span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">HcModelEq</span>  <span class="o">/=</span> <span class="n">ASHRAESimple</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-2291"></a>           <span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">OverrideType</span> <span class="o">/=</span> <span class="n">ConvCoefSpecifiedModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2292"></a><span class="k">        </span><span class="nb">Count</span><span class="o">=</span><span class="nb">Count</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2293"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2294"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Surface=&quot;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2295"></a>             <span class="nb">TRIM</span><span class="p">(</span><span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">Loop</span><span class="p">)%</span><span class="n">SurfaceName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, mixed algorithms.&#39;</span><span class="p">)</span>
<a name="ln-2296"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Zone Outside Convection Algorithm specifies &quot;SimpleCombined&quot;. &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2297"></a>             <span class="s1">&#39;SimpleCombined will be used for this surface.&#39;</span><span class="p">)</span>
<a name="ln-2298"></a>        <span class="n">ENDIF</span>
<a name="ln-2299"></a>      <span class="n">ENDIF</span>
<a name="ln-2300"></a>    <span class="n">ENDDO</span>
<a name="ln-2301"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">Count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2302"></a><span class="k">      CALL </span><span class="n">ShowSevereMessage</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="nb">Count</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2303"></a>         <span class="s1">&#39; surfaces had different outside convection algorithms specified when&#39;</span><span class="p">)</span>
<a name="ln-2304"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;the Zone Outside Convection Algorithm specifies &quot;SimpleCombined&quot;.&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2305"></a>            <span class="s1">&#39;SimpleCombined will be used for these surfaces.&#39;</span><span class="p">)</span>
<a name="ln-2306"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2307"></a><span class="k">        CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Use OutputDiagnostics,DisplayExtraWarnings; to see specific instances.&#39;</span><span class="p">)</span>
<a name="ln-2308"></a>        <span class="n">TotalSevereErrors</span><span class="o">=</span><span class="n">TotalSevereErrors</span><span class="o">+</span><span class="nb">Count</span>
<a name="ln-2309"></a><span class="nb">      </span><span class="n">ENDIF</span>
<a name="ln-2310"></a>    <span class="n">ENDIF</span>
<a name="ln-2311"></a>  <span class="n">ENDIF</span>
<a name="ln-2312"></a>
<a name="ln-2313"></a>
<a name="ln-2314"></a>  <span class="c">!get SurfaceConvectionAlgorithm:Inside:AdaptiveModelSelections</span>
<a name="ln-2315"></a>
<a name="ln-2316"></a>  <span class="n">CurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;SurfaceConvectionAlgorithm:Inside:AdaptiveModelSelections&#39;</span>
<a name="ln-2317"></a>  <span class="nb">Count</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span>
<a name="ln-2318"></a>  <span class="c">!IF (Count &gt; 1) ! throw  error ... TODO or IP handles it</span>
<a name="ln-2319"></a>  <span class="k">IF</span> <span class="p">(</span><span class="nb">Count</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2320"></a><span class="k">    CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">Status</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2321"></a>                 <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2322"></a>                 <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-2323"></a>    <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c">!not used by E+, unique object</span>
<a name="ln-2324"></a>    <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">EnteredByUser</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2325"></a>
<a name="ln-2326"></a>    <span class="c">! A2 , \field Simple Bouyancy Vertical Wall Equation Source</span>
<a name="ln-2327"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2328"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NumValidIntConvectionValueTypes</span> <span class="c">!skipping first 5 whole-model types</span>
<a name="ln-2329"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-2330"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2331"></a>      <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">SimpleBouyVertWallEqNum</span> <span class="o">=</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-2332"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">SimpleBouyVertWallEqNum</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2333"></a>        <span class="c">! A3 , \field Simple Bouyancy Vertical Wall User Curve Name</span>
<a name="ln-2334"></a>        <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">SimpleBouyVertWallUserCurveNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2335"></a>                                                             <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotInsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-2336"></a>
<a name="ln-2337"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">SimpleBouyVertWallUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2338"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2339"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; entered=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-2340"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2341"></a>        <span class="n">ENDIF</span>
<a name="ln-2342"></a>      <span class="n">ENDIF</span>
<a name="ln-2343"></a>      <span class="k">EXIT</span> <span class="c">!found it</span>
<a name="ln-2344"></a>    <span class="n">ENDDO</span>
<a name="ln-2345"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2346"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2347"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-2348"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2349"></a>    <span class="n">ENDIF</span>
<a name="ln-2350"></a>
<a name="ln-2351"></a>    <span class="c">! A4 , \field Simple Bouyancy Stable Horizontal Equation Source</span>
<a name="ln-2352"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2353"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NumValidIntConvectionValueTypes</span> <span class="c">!skipping first 5 whole-model types</span>
<a name="ln-2354"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-2355"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2356"></a>      <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">SimpleBouyStableHorizEqNum</span> <span class="o">=</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-2357"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">SimpleBouyStableHorizEqNum</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2358"></a>        <span class="c">! A5 , \field Simple Bouyancy Stable Horizontal Equation User Curve Name</span>
<a name="ln-2359"></a>        <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">SimpleBouyStableHorizUserCurveNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2360"></a>                                                             <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotInsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-2361"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">SimpleBouyStableHorizUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2362"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2363"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-2364"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2365"></a>        <span class="n">ENDIF</span>
<a name="ln-2366"></a>      <span class="n">ENDIF</span>
<a name="ln-2367"></a>      <span class="k">EXIT</span> <span class="c">!found it</span>
<a name="ln-2368"></a>    <span class="n">ENDDO</span>
<a name="ln-2369"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2370"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2371"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-2372"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2373"></a>    <span class="n">ENDIF</span>
<a name="ln-2374"></a>
<a name="ln-2375"></a>    <span class="c">! A6 , \field Simple Bouyancy Unstable Horizontal Equation Source</span>
<a name="ln-2376"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2377"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NumValidIntConvectionValueTypes</span> <span class="c">!skipping first 5 whole-model types</span>
<a name="ln-2378"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-2379"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2380"></a>      <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">SimpleBouyUnstableHorizEqNum</span> <span class="o">=</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-2381"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">SimpleBouyUnstableHorizEqNum</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2382"></a>        <span class="c">! A7 , \field Simple Bouyancy Unstable Horizontal Equation User Curve Name</span>
<a name="ln-2383"></a>        <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">SimpleBouyUnstableHorizUserCurveNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2384"></a>                                                             <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotInsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-2385"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">SimpleBouyUnstableHorizUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2386"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2387"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">)))</span>
<a name="ln-2388"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2389"></a>        <span class="n">ENDIF</span>
<a name="ln-2390"></a>      <span class="n">ENDIF</span>
<a name="ln-2391"></a>      <span class="k">EXIT</span> <span class="c">!found it</span>
<a name="ln-2392"></a>    <span class="n">ENDDO</span>
<a name="ln-2393"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2394"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2395"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-2396"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2397"></a>    <span class="n">ENDIF</span>
<a name="ln-2398"></a>
<a name="ln-2399"></a>    <span class="c">! A8 , \field Simple Bouyancy Stable Tilted Equation Source</span>
<a name="ln-2400"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2401"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NumValidIntConvectionValueTypes</span> <span class="c">!skipping first 5 whole-model types</span>
<a name="ln-2402"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-2403"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2404"></a>      <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">SimpleBouyStableTiltedEqNum</span> <span class="o">=</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-2405"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">SimpleBouyStableTiltedEqNum</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2406"></a>        <span class="c">! A9 , \field Simple Bouyancy Stable Tilted Equation User Curve Name</span>
<a name="ln-2407"></a>        <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">SimpleBouyStableTiltedUserCurveNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2408"></a>                                                             <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotInsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-2409"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">SimpleBouyStableTiltedUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2410"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2411"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">)))</span>
<a name="ln-2412"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2413"></a>        <span class="n">ENDIF</span>
<a name="ln-2414"></a>      <span class="n">ENDIF</span>
<a name="ln-2415"></a>      <span class="k">EXIT</span> <span class="c">!found it</span>
<a name="ln-2416"></a>    <span class="n">ENDDO</span>
<a name="ln-2417"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2418"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2419"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">)))</span>
<a name="ln-2420"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2421"></a>    <span class="n">ENDIF</span>
<a name="ln-2422"></a>
<a name="ln-2423"></a>     <span class="c">! A10 , \field Simple Bouyancy Unstable Tilted Equation Source</span>
<a name="ln-2424"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2425"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NumValidIntConvectionValueTypes</span> <span class="c">!skipping first 5 whole-model types</span>
<a name="ln-2426"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-2427"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2428"></a>      <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">SimpleBouyUnstableTiltedEqNum</span> <span class="o">=</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-2429"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">SimpleBouyUnstableTiltedEqNum</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2430"></a>        <span class="c">! A11, \field Simple Bouyancy Unstable Tilted Equation User Curve Name</span>
<a name="ln-2431"></a>        <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">SimpleBouyUnstableTiltedUserCurveNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2432"></a>                                                             <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotInsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-2433"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">SimpleBouyUnstableTiltedUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2434"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2435"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">11</span><span class="p">)))</span>
<a name="ln-2436"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2437"></a>        <span class="n">ENDIF</span>
<a name="ln-2438"></a>      <span class="n">ENDIF</span>
<a name="ln-2439"></a>      <span class="k">EXIT</span> <span class="c">!found it</span>
<a name="ln-2440"></a>    <span class="n">ENDDO</span>
<a name="ln-2441"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2442"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2443"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span>
<a name="ln-2444"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2445"></a>    <span class="n">ENDIF</span>
<a name="ln-2446"></a>
<a name="ln-2447"></a>     <span class="c">! A12, \field Simple Bouyancy Windows Equation Source</span>
<a name="ln-2448"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2449"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NumValidIntConvectionValueTypes</span> <span class="c">!skipping first 5 whole-model types</span>
<a name="ln-2450"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-2451"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2452"></a>      <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">SimpleBouyWindowsEqNum</span> <span class="o">=</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-2453"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">SimpleBouyWindowsEqNum</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2454"></a>        <span class="c">! A13, \field Simple Bouyancy Windows Equation User Curve Name</span>
<a name="ln-2455"></a>        <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">SimpleBouyWindowsUserCurveNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">13</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2456"></a>                                                             <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotInsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-2457"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">SimpleBouyWindowsUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2458"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2459"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">13</span><span class="p">)))</span>
<a name="ln-2460"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2461"></a>        <span class="n">ENDIF</span>
<a name="ln-2462"></a>      <span class="n">ENDIF</span>
<a name="ln-2463"></a>      <span class="k">EXIT</span> <span class="c">!found it</span>
<a name="ln-2464"></a>    <span class="n">ENDDO</span>
<a name="ln-2465"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2466"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2467"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">12</span><span class="p">)))</span>
<a name="ln-2468"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2469"></a>    <span class="n">ENDIF</span>
<a name="ln-2470"></a>
<a name="ln-2471"></a>     <span class="c">! A14, \field Floor Heat Ceiling Cool Vertical Wall Equation Source</span>
<a name="ln-2472"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2473"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NumValidIntConvectionValueTypes</span> <span class="c">!skipping first 5 whole-model types</span>
<a name="ln-2474"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-2475"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2476"></a>      <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolVertWallEqNum</span> <span class="o">=</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-2477"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolVertWallEqNum</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2478"></a>        <span class="c">!  A15, \field Floor Heat Ceiling Cool Vertical Wall Equation User Curve Name</span>
<a name="ln-2479"></a>        <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolVertWallUserCurveNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2480"></a>                                                             <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotInsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-2481"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolVertWallUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2482"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2483"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">15</span><span class="p">)))</span>
<a name="ln-2484"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2485"></a>        <span class="n">ENDIF</span>
<a name="ln-2486"></a>      <span class="n">ENDIF</span>
<a name="ln-2487"></a>      <span class="k">EXIT</span> <span class="c">!found it</span>
<a name="ln-2488"></a>    <span class="n">ENDDO</span>
<a name="ln-2489"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2490"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2491"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">14</span><span class="p">)))</span>
<a name="ln-2492"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2493"></a>    <span class="n">ENDIF</span>
<a name="ln-2494"></a>
<a name="ln-2495"></a>
<a name="ln-2496"></a>     <span class="c">! A16, \field Floor Heat Ceiling Cool Stable Horizontal Equation Source</span>
<a name="ln-2497"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2498"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NumValidIntConvectionValueTypes</span> <span class="c">!skipping first 5 whole-model types</span>
<a name="ln-2499"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-2500"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2501"></a>      <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolStableHorizEqNum</span> <span class="o">=</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-2502"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolStableHorizEqNum</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2503"></a>        <span class="c">!  A17, \field Floor Heat Ceiling Cool Stable Horizontal Equation User Curve Name</span>
<a name="ln-2504"></a>        <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolStableHorizUserCurveNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">17</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2505"></a>                                                             <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotInsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-2506"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolStableHorizUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2507"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2508"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">17</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">17</span><span class="p">)))</span>
<a name="ln-2509"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2510"></a>        <span class="n">ENDIF</span>
<a name="ln-2511"></a>      <span class="n">ENDIF</span>
<a name="ln-2512"></a>      <span class="k">EXIT</span> <span class="c">!found it</span>
<a name="ln-2513"></a>    <span class="n">ENDDO</span>
<a name="ln-2514"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2515"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2516"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">16</span><span class="p">)))</span>
<a name="ln-2517"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2518"></a>    <span class="n">ENDIF</span>
<a name="ln-2519"></a>
<a name="ln-2520"></a>     <span class="c">! A18, \field Floor Heat Ceiling Cool Unstable Horizontal Equation Source</span>
<a name="ln-2521"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2522"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NumValidIntConvectionValueTypes</span> <span class="c">!skipping first 5 whole-model types</span>
<a name="ln-2523"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">18</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-2524"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2525"></a>      <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolUnstableHorizEqNum</span> <span class="o">=</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-2526"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolUnstableHorizEqNum</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2527"></a>        <span class="c">! A19, \field Floor Heat Ceiling Cool Unstable Horizontal Equation User Curve Name</span>
<a name="ln-2528"></a>        <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolUnstableHorizUserCurveNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">19</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2529"></a>                                                             <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotInsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-2530"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolUnstableHorizUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2531"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2532"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">19</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">19</span><span class="p">)))</span>
<a name="ln-2533"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2534"></a>        <span class="n">ENDIF</span>
<a name="ln-2535"></a>      <span class="n">ENDIF</span>
<a name="ln-2536"></a>      <span class="k">EXIT</span> <span class="c">!found it</span>
<a name="ln-2537"></a>    <span class="n">ENDDO</span>
<a name="ln-2538"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2539"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2540"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">18</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">18</span><span class="p">)))</span>
<a name="ln-2541"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2542"></a>    <span class="n">ENDIF</span>
<a name="ln-2543"></a>
<a name="ln-2544"></a>     <span class="c">! A20, \field Floor Heat Ceiling Cool Heated Floor Equation Source</span>
<a name="ln-2545"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2546"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NumValidIntConvectionValueTypes</span> <span class="c">!skipping first 5 whole-model types</span>
<a name="ln-2547"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-2548"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2549"></a>      <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolHeatedFloorEqNum</span> <span class="o">=</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-2550"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolHeatedFloorEqNum</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2551"></a>        <span class="c">! A21, \field Floor Heat Ceiling Cool Heated Floor Equation User Curve Name</span>
<a name="ln-2552"></a>        <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolHeatedFloorUserCurveNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">21</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2553"></a>                                                             <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotInsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-2554"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolHeatedFloorUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2555"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2556"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">21</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">21</span><span class="p">)))</span>
<a name="ln-2557"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2558"></a>        <span class="n">ENDIF</span>
<a name="ln-2559"></a>      <span class="n">ENDIF</span>
<a name="ln-2560"></a>      <span class="k">EXIT</span> <span class="c">!found it</span>
<a name="ln-2561"></a>    <span class="n">ENDDO</span>
<a name="ln-2562"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2563"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2564"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">20</span><span class="p">)))</span>
<a name="ln-2565"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2566"></a>    <span class="n">ENDIF</span>
<a name="ln-2567"></a>
<a name="ln-2568"></a>     <span class="c">! A22, \field Floor Heat Ceiling Cool Chilled Ceiling Equation Source</span>
<a name="ln-2569"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2570"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NumValidIntConvectionValueTypes</span> <span class="c">!skipping first 5 whole-model types</span>
<a name="ln-2571"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">22</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-2572"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2573"></a>      <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolChilledCeilingEqNum</span> <span class="o">=</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-2574"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolChilledCeilingEqNum</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2575"></a>        <span class="c">! A23, \field Floor Heat Ceiling Cool Chilled Ceiling Equation User Curve Name</span>
<a name="ln-2576"></a>        <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolChilledCeilingUserCurveNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">23</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2577"></a>                                                             <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotInsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-2578"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolChilledCeilingUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2579"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2580"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">23</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">23</span><span class="p">)))</span>
<a name="ln-2581"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2582"></a>        <span class="n">ENDIF</span>
<a name="ln-2583"></a>      <span class="n">ENDIF</span>
<a name="ln-2584"></a>      <span class="k">EXIT</span> <span class="c">!found it</span>
<a name="ln-2585"></a>    <span class="n">ENDDO</span>
<a name="ln-2586"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2587"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2588"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">22</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">22</span><span class="p">)))</span>
<a name="ln-2589"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2590"></a>    <span class="n">ENDIF</span>
<a name="ln-2591"></a>
<a name="ln-2592"></a>     <span class="c">! A24, \field Floor Heat Ceiling Cool Stable Tilted Equation Source</span>
<a name="ln-2593"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2594"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NumValidIntConvectionValueTypes</span> <span class="c">!skipping first 5 whole-model types</span>
<a name="ln-2595"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">24</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-2596"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2597"></a>      <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolStableTiltedEqNum</span> <span class="o">=</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-2598"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolStableTiltedEqNum</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2599"></a>        <span class="c">!   A25, \field Floor Heat Ceiling Cool Stable Tilted Equation User Curve Name</span>
<a name="ln-2600"></a>        <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolStableTiltedUserCurveNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">25</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2601"></a>                                                             <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotInsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-2602"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolStableTiltedUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2603"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2604"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">25</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">25</span><span class="p">)))</span>
<a name="ln-2605"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2606"></a>        <span class="n">ENDIF</span>
<a name="ln-2607"></a>      <span class="n">ENDIF</span>
<a name="ln-2608"></a>      <span class="k">EXIT</span> <span class="c">!found it</span>
<a name="ln-2609"></a>    <span class="n">ENDDO</span>
<a name="ln-2610"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2611"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2612"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">24</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">24</span><span class="p">)))</span>
<a name="ln-2613"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2614"></a>    <span class="n">ENDIF</span>
<a name="ln-2615"></a>
<a name="ln-2616"></a>     <span class="c">! A26, \field Floor Heat Ceiling Cool Unstable Tilted Equation Source</span>
<a name="ln-2617"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2618"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NumValidIntConvectionValueTypes</span> <span class="c">!skipping first 5 whole-model types</span>
<a name="ln-2619"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">26</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-2620"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2621"></a>      <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolUnstableTiltedEqNum</span> <span class="o">=</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-2622"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolUnstableTiltedEqNum</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2623"></a>        <span class="c">!   A27, \field Floor Heat Ceiling Cool Unstable Tilted Equation User Curve Name</span>
<a name="ln-2624"></a>        <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolUnstableTiltedUserCurveNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">27</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2625"></a>                                                             <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotInsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-2626"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolUnstableTiltedUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2627"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2628"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">27</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">27</span><span class="p">)))</span>
<a name="ln-2629"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2630"></a>        <span class="n">ENDIF</span>
<a name="ln-2631"></a>      <span class="n">ENDIF</span>
<a name="ln-2632"></a>      <span class="k">EXIT</span> <span class="c">!found it</span>
<a name="ln-2633"></a>    <span class="n">ENDDO</span>
<a name="ln-2634"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2635"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2636"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">26</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">26</span><span class="p">)))</span>
<a name="ln-2637"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2638"></a>    <span class="n">ENDIF</span>
<a name="ln-2639"></a>
<a name="ln-2640"></a>     <span class="c">! A28, \field Floor Heat Ceiling Cool Window Equation Source</span>
<a name="ln-2641"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2642"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NumValidIntConvectionValueTypes</span> <span class="c">!skipping first 5 whole-model types</span>
<a name="ln-2643"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">28</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-2644"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2645"></a>      <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolWindowsEqNum</span> <span class="o">=</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-2646"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolWindowsEqNum</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2647"></a>        <span class="c">!    A29, \field Floor Heat Ceiling Cool Window Equation User Curve Name</span>
<a name="ln-2648"></a>        <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolWindowsUserCurveNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">29</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2649"></a>                                                             <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotInsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-2650"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolWindowsUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2651"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2652"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">29</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">29</span><span class="p">)))</span>
<a name="ln-2653"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2654"></a>        <span class="n">ENDIF</span>
<a name="ln-2655"></a>      <span class="n">ENDIF</span>
<a name="ln-2656"></a>      <span class="k">EXIT</span> <span class="c">!found it</span>
<a name="ln-2657"></a>    <span class="n">ENDDO</span>
<a name="ln-2658"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2659"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2660"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">28</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">28</span><span class="p">)))</span>
<a name="ln-2661"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2662"></a>    <span class="n">ENDIF</span>
<a name="ln-2663"></a>
<a name="ln-2664"></a>     <span class="c">! A30, \field Wall Panel Heating Vertical Wall Equation Source</span>
<a name="ln-2665"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2666"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NumValidIntConvectionValueTypes</span> <span class="c">!skipping first 5 whole-model types</span>
<a name="ln-2667"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-2668"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2669"></a>      <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">WallPanelHeatVertWallEqNum</span> <span class="o">=</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-2670"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">WallPanelHeatVertWallEqNum</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2671"></a>        <span class="c">!    A31, \field Wall Panel Heating Vertical Wall Equation User Curve Name</span>
<a name="ln-2672"></a>        <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">WallPanelHeatVertWallUserCurveNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2673"></a>                                                             <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotInsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-2674"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">WallPanelHeatVertWallUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2675"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2676"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">31</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">31</span><span class="p">)))</span>
<a name="ln-2677"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2678"></a>        <span class="n">ENDIF</span>
<a name="ln-2679"></a>      <span class="n">ENDIF</span>
<a name="ln-2680"></a>      <span class="k">EXIT</span> <span class="c">!found it</span>
<a name="ln-2681"></a>    <span class="n">ENDDO</span>
<a name="ln-2682"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2683"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2684"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">30</span><span class="p">)))</span>
<a name="ln-2685"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2686"></a>    <span class="n">ENDIF</span>
<a name="ln-2687"></a>
<a name="ln-2688"></a>     <span class="c">!  A32, \field Wall Panel Heating Heated Wall Equation Source</span>
<a name="ln-2689"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2690"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NumValidIntConvectionValueTypes</span> <span class="c">!skipping first 5 whole-model types</span>
<a name="ln-2691"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">32</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-2692"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2693"></a>      <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">WallPanelHeatHeatedWallEqNum</span> <span class="o">=</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-2694"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">WallPanelHeatHeatedWallEqNum</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2695"></a>        <span class="c">!   A33, \field Wall Panel Heating Heated Wall Equation User Curve Name</span>
<a name="ln-2696"></a>        <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">WallPanelHeatHeatedWallUserCurveNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">33</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2697"></a>                                                             <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotInsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-2698"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">WallPanelHeatHeatedWallUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2699"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2700"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">33</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">33</span><span class="p">)))</span>
<a name="ln-2701"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2702"></a>        <span class="n">ENDIF</span>
<a name="ln-2703"></a>      <span class="n">ENDIF</span>
<a name="ln-2704"></a>      <span class="k">EXIT</span> <span class="c">!found it</span>
<a name="ln-2705"></a>    <span class="n">ENDDO</span>
<a name="ln-2706"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2707"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2708"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">32</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">32</span><span class="p">)))</span>
<a name="ln-2709"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2710"></a>    <span class="n">ENDIF</span>
<a name="ln-2711"></a>
<a name="ln-2712"></a>     <span class="c">!  A34, \field Wall Panel Heating Stable Horizontal Equation Source</span>
<a name="ln-2713"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2714"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NumValidIntConvectionValueTypes</span> <span class="c">!skipping first 5 whole-model types</span>
<a name="ln-2715"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">34</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-2716"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2717"></a>      <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">WallPanelHeatStableHorizEqNum</span> <span class="o">=</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-2718"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">WallPanelHeatStableHorizEqNum</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2719"></a>        <span class="c">!   A35, \field Wall Panel Heating Stable Horizontal Equation User Curve Name</span>
<a name="ln-2720"></a>        <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">WallPanelHeatStableHorizUserCurveNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">35</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2721"></a>                                                             <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotInsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-2722"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">WallPanelHeatStableHorizUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2723"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2724"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">35</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">35</span><span class="p">)))</span>
<a name="ln-2725"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2726"></a>
<a name="ln-2727"></a>        <span class="n">ENDIF</span>
<a name="ln-2728"></a>      <span class="n">ENDIF</span>
<a name="ln-2729"></a>      <span class="k">EXIT</span> <span class="c">!found it</span>
<a name="ln-2730"></a>    <span class="n">ENDDO</span>
<a name="ln-2731"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2732"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2733"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">34</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">34</span><span class="p">)))</span>
<a name="ln-2734"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2735"></a>    <span class="n">ENDIF</span>
<a name="ln-2736"></a>
<a name="ln-2737"></a>     <span class="c">! A36, \field Wall Panel Heating Unstable Horizontal Equation Source</span>
<a name="ln-2738"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2739"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NumValidIntConvectionValueTypes</span> <span class="c">!skipping first 5 whole-model types</span>
<a name="ln-2740"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">36</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-2741"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2742"></a>      <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">WallPanelHeatUnstableHorizEqNum</span> <span class="o">=</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-2743"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">WallPanelHeatUnstableHorizEqNum</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2744"></a>        <span class="c">!  A37, \field Wall Panel Heating Unstable Horizontal Equation User Curve Name</span>
<a name="ln-2745"></a>        <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">WallPanelHeatUnstableHorizUserCurveNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">37</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2746"></a>                                                             <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotInsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-2747"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">WallPanelHeatUnstableHorizUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2748"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2749"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">37</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">37</span><span class="p">)))</span>
<a name="ln-2750"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2751"></a>        <span class="n">ENDIF</span>
<a name="ln-2752"></a>      <span class="n">ENDIF</span>
<a name="ln-2753"></a>      <span class="k">EXIT</span> <span class="c">!found it</span>
<a name="ln-2754"></a>    <span class="n">ENDDO</span>
<a name="ln-2755"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2756"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2757"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">36</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">36</span><span class="p">)))</span>
<a name="ln-2758"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2759"></a>    <span class="n">ENDIF</span>
<a name="ln-2760"></a>
<a name="ln-2761"></a>     <span class="c">! A38, \field Wall Panel Heating Stable Tilted Equation Source</span>
<a name="ln-2762"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2763"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NumValidIntConvectionValueTypes</span> <span class="c">!skipping first 5 whole-model types</span>
<a name="ln-2764"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">38</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-2765"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2766"></a>      <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">WallPanelHeatStableTiltedEqNum</span> <span class="o">=</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-2767"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">WallPanelHeatStableTiltedEqNum</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2768"></a>        <span class="c">!  A39, \field Wall Panel Heating Stable Tilted Equation User Curve Name</span>
<a name="ln-2769"></a>        <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">WallPanelHeatStableTiltedUserCurveNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">39</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2770"></a>                                                             <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotInsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-2771"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">WallPanelHeatStableTiltedUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2772"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2773"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">39</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">39</span><span class="p">)))</span>
<a name="ln-2774"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2775"></a>        <span class="n">ENDIF</span>
<a name="ln-2776"></a>      <span class="n">ENDIF</span>
<a name="ln-2777"></a>      <span class="k">EXIT</span> <span class="c">!found it</span>
<a name="ln-2778"></a>    <span class="n">ENDDO</span>
<a name="ln-2779"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2780"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2781"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">38</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">38</span><span class="p">)))</span>
<a name="ln-2782"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2783"></a>    <span class="n">ENDIF</span>
<a name="ln-2784"></a>
<a name="ln-2785"></a>     <span class="c">!   A40, \field Wall Panel Heating Unstable Tilted Equation Source</span>
<a name="ln-2786"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2787"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NumValidIntConvectionValueTypes</span> <span class="c">!skipping first 5 whole-model types</span>
<a name="ln-2788"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">40</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-2789"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2790"></a>      <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">WallPanelHeatUnstableTiltedEqNum</span> <span class="o">=</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-2791"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">WallPanelHeatUnstableTiltedEqNum</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2792"></a>        <span class="c">!  A41, \field Wall Panel Heating Unstable Tilted Equation User Curve Name</span>
<a name="ln-2793"></a>        <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">WallPanelHeatUnstableTiltedUserCurveNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">41</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2794"></a>                                                             <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotInsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-2795"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">WallPanelHeatUnstableTiltedUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2796"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2797"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">41</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">41</span><span class="p">)))</span>
<a name="ln-2798"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2799"></a>        <span class="n">ENDIF</span>
<a name="ln-2800"></a>      <span class="n">ENDIF</span>
<a name="ln-2801"></a>      <span class="k">EXIT</span> <span class="c">!found it</span>
<a name="ln-2802"></a>    <span class="n">ENDDO</span>
<a name="ln-2803"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2804"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2805"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">40</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">40</span><span class="p">)))</span>
<a name="ln-2806"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2807"></a>    <span class="n">ENDIF</span>
<a name="ln-2808"></a>
<a name="ln-2809"></a>     <span class="c">!  A42, \field Wall Panel Heating Window Equation Source</span>
<a name="ln-2810"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2811"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NumValidIntConvectionValueTypes</span> <span class="c">!skipping first 5 whole-model types</span>
<a name="ln-2812"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">42</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-2813"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2814"></a>      <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">WallPanelHeatWindowsEqNum</span> <span class="o">=</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-2815"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">WallPanelHeatWindowsEqNum</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2816"></a>        <span class="c">!  A43, \field Wall Panel Heating Window Equation User Curve Name</span>
<a name="ln-2817"></a>        <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">WallPanelHeatWindowsUserCurveNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">43</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2818"></a>                                                             <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotInsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-2819"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">WallPanelHeatWindowsUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2820"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2821"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">43</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">43</span><span class="p">)))</span>
<a name="ln-2822"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2823"></a>        <span class="n">ENDIF</span>
<a name="ln-2824"></a>      <span class="n">ENDIF</span>
<a name="ln-2825"></a>      <span class="k">EXIT</span> <span class="c">!found it</span>
<a name="ln-2826"></a>    <span class="n">ENDDO</span>
<a name="ln-2827"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2828"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2829"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">42</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">42</span><span class="p">)))</span>
<a name="ln-2830"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2831"></a>    <span class="n">ENDIF</span>
<a name="ln-2832"></a>
<a name="ln-2833"></a>     <span class="c">!  A44, \field Convective Zone Heater Vertical Wall Equation Source</span>
<a name="ln-2834"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2835"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NumValidIntConvectionValueTypes</span> <span class="c">!skipping first 5 whole-model types</span>
<a name="ln-2836"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">44</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-2837"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2838"></a>      <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ConvectiveHeatVertWallEqNum</span> <span class="o">=</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-2839"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ConvectiveHeatVertWallEqNum</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2840"></a>        <span class="c">! A45, \field Convective Zone Heater Vertical Wall Equation User Curve Name</span>
<a name="ln-2841"></a>        <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ConvectiveHeatVertWallUserCurveNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">45</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2842"></a>                                                             <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotInsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-2843"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ConvectiveHeatVertWallUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2844"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2845"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">45</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">45</span><span class="p">)))</span>
<a name="ln-2846"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2847"></a>        <span class="n">ENDIF</span>
<a name="ln-2848"></a>      <span class="n">ENDIF</span>
<a name="ln-2849"></a>      <span class="k">EXIT</span> <span class="c">!found it</span>
<a name="ln-2850"></a>    <span class="n">ENDDO</span>
<a name="ln-2851"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2852"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2853"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">44</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">44</span><span class="p">)))</span>
<a name="ln-2854"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2855"></a>    <span class="n">ENDIF</span>
<a name="ln-2856"></a>
<a name="ln-2857"></a>     <span class="c">!  A46, \field Convective Zone Heater Vertical Walls Near Heater Equation Source</span>
<a name="ln-2858"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2859"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NumValidIntConvectionValueTypes</span> <span class="c">!skipping first 5 whole-model types</span>
<a name="ln-2860"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">46</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-2861"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2862"></a>      <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ConvectiveHeatVertWallNearHeaterEqNum</span> <span class="o">=</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-2863"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ConvectiveHeatVertWallNearHeaterEqNum</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2864"></a>        <span class="c">! A47, \field Convective Zone Heater Vertical Walls Near Heater Equation User Curve Name</span>
<a name="ln-2865"></a>        <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ConvectiveHeatVertWallNearHeaterUserCurveNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">47</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2866"></a>                                                             <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotInsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-2867"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ConvectiveHeatVertWallNearHeaterUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2868"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2869"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">47</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">47</span><span class="p">)))</span>
<a name="ln-2870"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2871"></a>        <span class="n">ENDIF</span>
<a name="ln-2872"></a>      <span class="n">ENDIF</span>
<a name="ln-2873"></a>      <span class="k">EXIT</span> <span class="c">!found it</span>
<a name="ln-2874"></a>    <span class="n">ENDDO</span>
<a name="ln-2875"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2876"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2877"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">46</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">46</span><span class="p">)))</span>
<a name="ln-2878"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2879"></a>    <span class="n">ENDIF</span>
<a name="ln-2880"></a>
<a name="ln-2881"></a>     <span class="c">!  A48, \field Convective Zone Heater Stable Horizontal Equation Source</span>
<a name="ln-2882"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2883"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NumValidIntConvectionValueTypes</span> <span class="c">!skipping first 5 whole-model types</span>
<a name="ln-2884"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">48</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-2885"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2886"></a>      <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ConvectiveHeatStableHorizEqNum</span> <span class="o">=</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-2887"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ConvectiveHeatStableHorizEqNum</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2888"></a>        <span class="c">! A49, \field Convective Zone Heater Stable Horizontal Equation User Curve Name</span>
<a name="ln-2889"></a>        <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ConvectiveHeatStableHorizUserCurveNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">49</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2890"></a>                                                             <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotInsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-2891"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ConvectiveHeatStableHorizUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2892"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2893"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">49</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">49</span><span class="p">)))</span>
<a name="ln-2894"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2895"></a>        <span class="n">ENDIF</span>
<a name="ln-2896"></a>      <span class="n">ENDIF</span>
<a name="ln-2897"></a>      <span class="k">EXIT</span> <span class="c">!found it</span>
<a name="ln-2898"></a>    <span class="n">ENDDO</span>
<a name="ln-2899"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2900"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2901"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">48</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">48</span><span class="p">)))</span>
<a name="ln-2902"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2903"></a>    <span class="n">ENDIF</span>
<a name="ln-2904"></a>
<a name="ln-2905"></a>     <span class="c">!  A50, \field Convective Zone Heater Unstable Horizontal Equation Source</span>
<a name="ln-2906"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2907"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NumValidIntConvectionValueTypes</span> <span class="c">!skipping first 5 whole-model types</span>
<a name="ln-2908"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">50</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-2909"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2910"></a>      <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ConvectiveHeatUnstableHorizEqNum</span> <span class="o">=</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-2911"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ConvectiveHeatUnstableHorizEqNum</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2912"></a>        <span class="c">!  A51, \field Convective Zone Heater Unstable Horizontal Equation User Curve Name</span>
<a name="ln-2913"></a>        <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ConvectiveHeatUnstableHorizUserCurveNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">51</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2914"></a>                                                             <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotInsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-2915"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ConvectiveHeatUnstableHorizUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2916"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2917"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">51</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">51</span><span class="p">)))</span>
<a name="ln-2918"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2919"></a>        <span class="n">ENDIF</span>
<a name="ln-2920"></a>      <span class="n">ENDIF</span>
<a name="ln-2921"></a>      <span class="k">EXIT</span> <span class="c">!found it</span>
<a name="ln-2922"></a>    <span class="n">ENDDO</span>
<a name="ln-2923"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2924"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2925"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">50</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">50</span><span class="p">)))</span>
<a name="ln-2926"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2927"></a>    <span class="n">ENDIF</span>
<a name="ln-2928"></a>
<a name="ln-2929"></a>     <span class="c">!  A52, \field Convective Zone Heater Stable Tilted Equation Source</span>
<a name="ln-2930"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2931"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NumValidIntConvectionValueTypes</span> <span class="c">!skipping first 5 whole-model types</span>
<a name="ln-2932"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">52</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-2933"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2934"></a>      <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ConvectiveHeatStableTiltedEqNum</span> <span class="o">=</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-2935"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ConvectiveHeatStableTiltedEqNum</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2936"></a>        <span class="c">!  A53, \field Convective Zone Heater Stable Tilted Equation User Curve Name</span>
<a name="ln-2937"></a>        <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ConvectiveHeatStableTiltedUserCurveNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">53</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2938"></a>                                                             <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotInsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-2939"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ConvectiveHeatStableTiltedUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2940"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2941"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">53</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">53</span><span class="p">)))</span>
<a name="ln-2942"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2943"></a>        <span class="n">ENDIF</span>
<a name="ln-2944"></a>      <span class="n">ENDIF</span>
<a name="ln-2945"></a>      <span class="k">EXIT</span> <span class="c">!found it</span>
<a name="ln-2946"></a>    <span class="n">ENDDO</span>
<a name="ln-2947"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2948"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2949"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">52</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">52</span><span class="p">)))</span>
<a name="ln-2950"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2951"></a>    <span class="n">ENDIF</span>
<a name="ln-2952"></a>
<a name="ln-2953"></a>     <span class="c">!  A54, \field Convective Zone Heater Unstable Tilted Equation Source</span>
<a name="ln-2954"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2955"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NumValidIntConvectionValueTypes</span> <span class="c">!skipping first 5 whole-model types</span>
<a name="ln-2956"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">54</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-2957"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2958"></a>      <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ConvectiveHeatUnstableTiltedEqNum</span> <span class="o">=</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-2959"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ConvectiveHeatUnstableTiltedEqNum</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2960"></a>        <span class="c">!  A55, \field Convective Zone Heater Unstable Tilted Equation User Curve Name</span>
<a name="ln-2961"></a>        <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ConvectiveHeatUnstableTiltedUserCurveNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">55</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2962"></a>                                                             <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotInsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-2963"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ConvectiveHeatUnstableTiltedUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2964"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2965"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">55</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">55</span><span class="p">)))</span>
<a name="ln-2966"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2967"></a>        <span class="n">ENDIF</span>
<a name="ln-2968"></a>      <span class="n">ENDIF</span>
<a name="ln-2969"></a>      <span class="k">EXIT</span> <span class="c">!found it</span>
<a name="ln-2970"></a>    <span class="n">ENDDO</span>
<a name="ln-2971"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2972"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2973"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">54</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">54</span><span class="p">)))</span>
<a name="ln-2974"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2975"></a>    <span class="n">ENDIF</span>
<a name="ln-2976"></a>
<a name="ln-2977"></a>     <span class="c">!  A56, \field Convective Zone Heater Windows Equation Source</span>
<a name="ln-2978"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2979"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NumValidIntConvectionValueTypes</span> <span class="c">!skipping first 5 whole-model types</span>
<a name="ln-2980"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">56</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-2981"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2982"></a>      <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ConvectiveHeatWindowsEqNum</span> <span class="o">=</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-2983"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ConvectiveHeatWindowsEqNum</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2984"></a>        <span class="c">!   A57, \field Convective Zone Heater Windows Equation User Curve Name</span>
<a name="ln-2985"></a>        <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ConvectiveHeatWindowsUserCurveNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">57</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2986"></a>                                                             <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotInsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-2987"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ConvectiveHeatWindowsUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2988"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2989"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">57</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">57</span><span class="p">)))</span>
<a name="ln-2990"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2991"></a>        <span class="n">ENDIF</span>
<a name="ln-2992"></a>      <span class="n">ENDIF</span>
<a name="ln-2993"></a>      <span class="k">EXIT</span> <span class="c">!found it</span>
<a name="ln-2994"></a>    <span class="n">ENDDO</span>
<a name="ln-2995"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2996"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-2997"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">56</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">56</span><span class="p">)))</span>
<a name="ln-2998"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2999"></a>    <span class="n">ENDIF</span>
<a name="ln-3000"></a>
<a name="ln-3001"></a>     <span class="c">!  A58, \field Central Air Diffuser Wall Equation Source</span>
<a name="ln-3002"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3003"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NumValidIntConvectionValueTypes</span> <span class="c">!skipping first 5 whole-model types</span>
<a name="ln-3004"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">58</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-3005"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3006"></a>      <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">CentralAirWallEqNum</span> <span class="o">=</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-3007"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">CentralAirWallEqNum</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3008"></a>        <span class="c">!   A59, \field Central Air Diffuser Wall Equation User Curve Name</span>
<a name="ln-3009"></a>        <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">CentralAirWallUserCurveNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">59</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3010"></a>                                                             <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotInsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-3011"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">CentralAirWallUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3012"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3013"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">59</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">59</span><span class="p">)))</span>
<a name="ln-3014"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3015"></a>        <span class="n">ENDIF</span>
<a name="ln-3016"></a>      <span class="n">ENDIF</span>
<a name="ln-3017"></a>      <span class="k">EXIT</span> <span class="c">!found it</span>
<a name="ln-3018"></a>    <span class="n">ENDDO</span>
<a name="ln-3019"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3020"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3021"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">58</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">58</span><span class="p">)))</span>
<a name="ln-3022"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3023"></a>    <span class="n">ENDIF</span>
<a name="ln-3024"></a>
<a name="ln-3025"></a>     <span class="c">!   A60, \field Central Air Diffuser Ceiling Equation Source</span>
<a name="ln-3026"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3027"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NumValidIntConvectionValueTypes</span> <span class="c">!skipping first 5 whole-model types</span>
<a name="ln-3028"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">60</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-3029"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3030"></a>      <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">CentralAirCeilingEqNum</span> <span class="o">=</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-3031"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">CentralAirCeilingEqNum</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3032"></a>        <span class="c">!   A61, \field Central Air Diffuser Ceiling Equation User Curve Name</span>
<a name="ln-3033"></a>        <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">CentralAirCeilingUserCurveNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">61</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3034"></a>                                                             <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotInsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-3035"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">CentralAirCeilingUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3036"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3037"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">61</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">61</span><span class="p">)))</span>
<a name="ln-3038"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3039"></a>        <span class="n">ENDIF</span>
<a name="ln-3040"></a>      <span class="n">ENDIF</span>
<a name="ln-3041"></a>      <span class="k">EXIT</span> <span class="c">!found it</span>
<a name="ln-3042"></a>    <span class="n">ENDDO</span>
<a name="ln-3043"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3044"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3045"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">60</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">60</span><span class="p">)))</span>
<a name="ln-3046"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3047"></a>    <span class="n">ENDIF</span>
<a name="ln-3048"></a>
<a name="ln-3049"></a>     <span class="c">!  A62, \field Central Air Diffuser Floor Equation Source</span>
<a name="ln-3050"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3051"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NumValidIntConvectionValueTypes</span> <span class="c">!skipping first 5 whole-model types</span>
<a name="ln-3052"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">62</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-3053"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3054"></a>      <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">CentralAirFloorEqNum</span> <span class="o">=</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-3055"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">CentralAirFloorEqNum</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3056"></a>        <span class="c">!  A63, \field Central Air Diffuser Floor Equation User Curve Name</span>
<a name="ln-3057"></a>        <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">CentralAirFloorUserCurveNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">63</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3058"></a>                                                             <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotInsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-3059"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">CentralAirFloorUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3060"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3061"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">63</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">63</span><span class="p">)))</span>
<a name="ln-3062"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3063"></a>        <span class="n">ENDIF</span>
<a name="ln-3064"></a>      <span class="n">ENDIF</span>
<a name="ln-3065"></a>      <span class="k">EXIT</span> <span class="c">!found it</span>
<a name="ln-3066"></a>    <span class="n">ENDDO</span>
<a name="ln-3067"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3068"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3069"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">62</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">62</span><span class="p">)))</span>
<a name="ln-3070"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3071"></a>    <span class="n">ENDIF</span>
<a name="ln-3072"></a>
<a name="ln-3073"></a>     <span class="c">!  A64, \field Central Air Diffuser Window Equation Source</span>
<a name="ln-3074"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3075"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NumValidIntConvectionValueTypes</span> <span class="c">!skipping first 5 whole-model types</span>
<a name="ln-3076"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">64</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-3077"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3078"></a>      <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">CentralAirWindowsEqNum</span> <span class="o">=</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-3079"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">CentralAirWindowsEqNum</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3080"></a>        <span class="c">!   A65, \field Central Air Diffuser Window Equation User Curve Name</span>
<a name="ln-3081"></a>        <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">CentralAirWindowsUserCurveNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">65</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3082"></a>                                                             <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotInsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-3083"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">CentralAirWindowsUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3084"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3085"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">65</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">65</span><span class="p">)))</span>
<a name="ln-3086"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3087"></a>        <span class="n">ENDIF</span>
<a name="ln-3088"></a>      <span class="n">ENDIF</span>
<a name="ln-3089"></a>      <span class="k">EXIT</span> <span class="c">!found it</span>
<a name="ln-3090"></a>    <span class="n">ENDDO</span>
<a name="ln-3091"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3092"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3093"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">64</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">64</span><span class="p">)))</span>
<a name="ln-3094"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3095"></a>    <span class="n">ENDIF</span>
<a name="ln-3096"></a>
<a name="ln-3097"></a>     <span class="c">! A66, \field Mechanical Zone Fan Circulation Vertical Wall Equation Source</span>
<a name="ln-3098"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3099"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NumValidIntConvectionValueTypes</span> <span class="c">!skipping first 5 whole-model types</span>
<a name="ln-3100"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">66</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-3101"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3102"></a>      <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ZoneFanCircVertWallEqNum</span> <span class="o">=</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-3103"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ZoneFanCircVertWallEqNum</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3104"></a>        <span class="c">!   A67, \field Mechanical Zone Fan Circulation Vertical Wall Equation User Curve Name</span>
<a name="ln-3105"></a>        <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ZoneFanCircVertWallUserCurveNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">67</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3106"></a>                                                             <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotInsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-3107"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ZoneFanCircVertWallUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3108"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3109"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">67</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">67</span><span class="p">)))</span>
<a name="ln-3110"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3111"></a>
<a name="ln-3112"></a>        <span class="n">ENDIF</span>
<a name="ln-3113"></a>      <span class="n">ENDIF</span>
<a name="ln-3114"></a>      <span class="k">EXIT</span> <span class="c">!found it</span>
<a name="ln-3115"></a>    <span class="n">ENDDO</span>
<a name="ln-3116"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3117"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3118"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">66</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">66</span><span class="p">)))</span>
<a name="ln-3119"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3120"></a>    <span class="n">ENDIF</span>
<a name="ln-3121"></a>
<a name="ln-3122"></a>     <span class="c">! A68, \field Mechanical Zone Fan Circulation Stable Horizontal Equation Source</span>
<a name="ln-3123"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3124"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NumValidIntConvectionValueTypes</span> <span class="c">!skipping first 5 whole-model types</span>
<a name="ln-3125"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">68</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-3126"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3127"></a>      <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ZoneFanCircStableHorizEqNum</span> <span class="o">=</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-3128"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ZoneFanCircStableHorizEqNum</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3129"></a>        <span class="c">!   A69, \field Mechanical Zone Fan Circulation Stable Horizontal Equation User Curve Name</span>
<a name="ln-3130"></a>        <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ZoneFanCircStableHorizUserCurveNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">69</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3131"></a>                                                             <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotInsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-3132"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ZoneFanCircStableHorizUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3133"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3134"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">69</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">69</span><span class="p">)))</span>
<a name="ln-3135"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3136"></a>        <span class="n">ENDIF</span>
<a name="ln-3137"></a>      <span class="n">ENDIF</span>
<a name="ln-3138"></a>      <span class="k">EXIT</span> <span class="c">!found it</span>
<a name="ln-3139"></a>    <span class="n">ENDDO</span>
<a name="ln-3140"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3141"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3142"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">68</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">68</span><span class="p">)))</span>
<a name="ln-3143"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3144"></a>    <span class="n">ENDIF</span>
<a name="ln-3145"></a>
<a name="ln-3146"></a>     <span class="c">! A70, \field Mechanical Zone Fan Circulation Unstable Horizontal Equation Source</span>
<a name="ln-3147"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3148"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NumValidIntConvectionValueTypes</span> <span class="c">!skipping first 5 whole-model types</span>
<a name="ln-3149"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">70</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-3150"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3151"></a>      <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ZoneFanCircUnstableHorizEqNum</span> <span class="o">=</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-3152"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ZoneFanCircUnstableHorizEqNum</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3153"></a>        <span class="c">!   A71, \field Mechanical Zone Fan Circulation Unstable Horizontal Equation User Curve Name</span>
<a name="ln-3154"></a>        <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ZoneFanCircUnstableHorizUserCurveNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">71</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3155"></a>                                                             <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotInsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-3156"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ZoneFanCircUnstableHorizUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3157"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3158"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">71</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">71</span><span class="p">)))</span>
<a name="ln-3159"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3160"></a>        <span class="n">ENDIF</span>
<a name="ln-3161"></a>      <span class="n">ENDIF</span>
<a name="ln-3162"></a>      <span class="k">EXIT</span> <span class="c">!found it</span>
<a name="ln-3163"></a>    <span class="n">ENDDO</span>
<a name="ln-3164"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3165"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3166"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">70</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">70</span><span class="p">)))</span>
<a name="ln-3167"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3168"></a>    <span class="n">ENDIF</span>
<a name="ln-3169"></a>
<a name="ln-3170"></a>     <span class="c">! A72, \field Mechanical Zone Fan Circulation Stable Tilted Equation Source</span>
<a name="ln-3171"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3172"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NumValidIntConvectionValueTypes</span> <span class="c">!skipping first 5 whole-model types</span>
<a name="ln-3173"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">72</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-3174"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3175"></a>      <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ZoneFanCircStableTiltedEqNum</span> <span class="o">=</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-3176"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ZoneFanCircStableTiltedEqNum</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3177"></a>        <span class="c">!  A73, \field Mechanical Zone Fan Circulation Stable Tilted Equation User Curve Name</span>
<a name="ln-3178"></a>        <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ZoneFanCircStableTiltedUserCurveNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">73</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3179"></a>                                                             <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotInsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-3180"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ZoneFanCircStableTiltedUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3181"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3182"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">73</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">73</span><span class="p">)))</span>
<a name="ln-3183"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3184"></a>        <span class="n">ENDIF</span>
<a name="ln-3185"></a>      <span class="n">ENDIF</span>
<a name="ln-3186"></a>      <span class="k">EXIT</span> <span class="c">!found it</span>
<a name="ln-3187"></a>    <span class="n">ENDDO</span>
<a name="ln-3188"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3189"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3190"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">72</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">72</span><span class="p">)))</span>
<a name="ln-3191"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3192"></a>    <span class="n">ENDIF</span>
<a name="ln-3193"></a>
<a name="ln-3194"></a>     <span class="c">! A74, \field Mechanical Zone Fan Circulation Unstable Tilted Equation Source</span>
<a name="ln-3195"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3196"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NumValidIntConvectionValueTypes</span> <span class="c">!skipping first 5 whole-model types</span>
<a name="ln-3197"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">74</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-3198"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3199"></a>      <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ZoneFanCircUnstableTiltedEqNum</span> <span class="o">=</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-3200"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ZoneFanCircUnstableTiltedEqNum</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3201"></a>        <span class="c">!  A75, \field Mechanical Zone Fan Circulation Unstable Tilted Equation User Curve Name</span>
<a name="ln-3202"></a>        <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ZoneFanCircUnstableTiltedUserCurveNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">75</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3203"></a>                                                             <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotInsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-3204"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ZoneFanCircUnstableTiltedUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3205"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3206"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">75</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">75</span><span class="p">)))</span>
<a name="ln-3207"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3208"></a>        <span class="n">ENDIF</span>
<a name="ln-3209"></a>      <span class="n">ENDIF</span>
<a name="ln-3210"></a>      <span class="k">EXIT</span> <span class="c">!found it</span>
<a name="ln-3211"></a>    <span class="n">ENDDO</span>
<a name="ln-3212"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3213"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3214"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">74</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">74</span><span class="p">)))</span>
<a name="ln-3215"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3216"></a>    <span class="n">ENDIF</span>
<a name="ln-3217"></a>
<a name="ln-3218"></a>     <span class="c">! A76, \field Mechanical Zone Fan Circulation Window Equation Source</span>
<a name="ln-3219"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3220"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NumValidIntConvectionValueTypes</span> <span class="c">!skipping first 5 whole-model types</span>
<a name="ln-3221"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">76</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-3222"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3223"></a>      <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ZoneFanCircWindowsEqNum</span> <span class="o">=</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-3224"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ZoneFanCircWindowsEqNum</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3225"></a>        <span class="c">!  A77, \field Mechanical Zone Fan Circulation Window Equation User Curve Name</span>
<a name="ln-3226"></a>        <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ZoneFanCircWindowsUserCurveNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">77</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3227"></a>                                                             <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotInsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-3228"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ZoneFanCircWindowsUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3229"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3230"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">77</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">77</span><span class="p">)))</span>
<a name="ln-3231"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3232"></a>        <span class="n">ENDIF</span>
<a name="ln-3233"></a>      <span class="n">ENDIF</span>
<a name="ln-3234"></a>      <span class="k">EXIT</span> <span class="c">!found it</span>
<a name="ln-3235"></a>    <span class="n">ENDDO</span>
<a name="ln-3236"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3237"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3238"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">76</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">76</span><span class="p">)))</span>
<a name="ln-3239"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3240"></a>    <span class="n">ENDIF</span>
<a name="ln-3241"></a>
<a name="ln-3242"></a>     <span class="c">! A78, \field Mixed Regime Bouyancy Assisting Flow on Walls Equation Source</span>
<a name="ln-3243"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3244"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NumValidIntConvectionValueTypes</span> <span class="c">!skipping first 5 whole-model types</span>
<a name="ln-3245"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">78</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-3246"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3247"></a>      <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">MixedBouyAssistingFlowWallEqNum</span> <span class="o">=</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-3248"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">MixedBouyAssistingFlowWallEqNum</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3249"></a>        <span class="c">!  A79, \field Mixed Regime Bouyancy Assisting Flow on Walls Equation User Curve Name</span>
<a name="ln-3250"></a>        <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">MixedBouyAssistingFlowWallUserCurveNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">79</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3251"></a>                                                             <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotInsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-3252"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">MixedBouyAssistingFlowWallUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3253"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3254"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">79</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">79</span><span class="p">)))</span>
<a name="ln-3255"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3256"></a>        <span class="n">ENDIF</span>
<a name="ln-3257"></a>      <span class="n">ENDIF</span>
<a name="ln-3258"></a>      <span class="k">EXIT</span> <span class="c">!found it</span>
<a name="ln-3259"></a>    <span class="n">ENDDO</span>
<a name="ln-3260"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3261"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3262"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">78</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">78</span><span class="p">)))</span>
<a name="ln-3263"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3264"></a>    <span class="n">ENDIF</span>
<a name="ln-3265"></a>
<a name="ln-3266"></a>     <span class="c">! A80, \field Mixed Regime Bouyancy Oppossing Flow on Walls Equation Source</span>
<a name="ln-3267"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3268"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NumValidIntConvectionValueTypes</span> <span class="c">!skipping first 5 whole-model types</span>
<a name="ln-3269"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">80</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-3270"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3271"></a>      <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">MixedBouyOppossingFlowWallEqNum</span> <span class="o">=</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-3272"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">MixedBouyOppossingFlowWallEqNum</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3273"></a>        <span class="c">!  A81, \field Mixed Regime Bouyancy Oppossing Flow on Walls Equation User Curve Name</span>
<a name="ln-3274"></a>        <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">MixedBouyOppossingFlowWallUserCurveNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">81</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3275"></a>                                                             <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotInsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-3276"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">MixedBouyOppossingFlowWallUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3277"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3278"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">81</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">81</span><span class="p">)))</span>
<a name="ln-3279"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3280"></a>        <span class="n">ENDIF</span>
<a name="ln-3281"></a>      <span class="n">ENDIF</span>
<a name="ln-3282"></a>      <span class="k">EXIT</span> <span class="c">!found it</span>
<a name="ln-3283"></a>    <span class="n">ENDDO</span>
<a name="ln-3284"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3285"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3286"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">80</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">80</span><span class="p">)))</span>
<a name="ln-3287"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3288"></a>    <span class="n">ENDIF</span>
<a name="ln-3289"></a>
<a name="ln-3290"></a>     <span class="c">! A82, \field Mixed Regime Stable Floor Equation Source</span>
<a name="ln-3291"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3292"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NumValidIntConvectionValueTypes</span> <span class="c">!skipping first 5 whole-model types</span>
<a name="ln-3293"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">82</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-3294"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3295"></a>      <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">MixedStableFloorEqNum</span> <span class="o">=</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-3296"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">MixedStableFloorEqNum</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3297"></a>        <span class="c">!  A83, \field Mixed Regime Stable Floor Equation User Curve Name</span>
<a name="ln-3298"></a>        <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">MixedStableFloorUserCurveNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">83</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3299"></a>                                                             <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotInsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-3300"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">MixedStableFloorUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3301"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3302"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">83</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">83</span><span class="p">)))</span>
<a name="ln-3303"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3304"></a>        <span class="n">ENDIF</span>
<a name="ln-3305"></a>      <span class="n">ENDIF</span>
<a name="ln-3306"></a>      <span class="k">EXIT</span> <span class="c">!found it</span>
<a name="ln-3307"></a>    <span class="n">ENDDO</span>
<a name="ln-3308"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3309"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3310"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">82</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">82</span><span class="p">)))</span>
<a name="ln-3311"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3312"></a>    <span class="n">ENDIF</span>
<a name="ln-3313"></a>
<a name="ln-3314"></a>     <span class="c">! A84, \field Mixed Regime Unstable Floor Equation Source</span>
<a name="ln-3315"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3316"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NumValidIntConvectionValueTypes</span> <span class="c">!skipping first 5 whole-model types</span>
<a name="ln-3317"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">84</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-3318"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3319"></a>      <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">MixedUnstableFloorEqNum</span> <span class="o">=</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-3320"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">MixedUnstableFloorEqNum</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3321"></a>        <span class="c">!  A85, \field Mixed Regime Unstable Floor Equation User Curve Name</span>
<a name="ln-3322"></a>        <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">MixedUnstableFloorUserCurveNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">85</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3323"></a>                                                             <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotInsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-3324"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">MixedUnstableFloorUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3325"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3326"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">85</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">85</span><span class="p">)))</span>
<a name="ln-3327"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3328"></a>        <span class="n">ENDIF</span>
<a name="ln-3329"></a>      <span class="n">ENDIF</span>
<a name="ln-3330"></a>      <span class="k">EXIT</span> <span class="c">!found it</span>
<a name="ln-3331"></a>    <span class="n">ENDDO</span>
<a name="ln-3332"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3333"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3334"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">84</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">84</span><span class="p">)))</span>
<a name="ln-3335"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3336"></a>    <span class="n">ENDIF</span>
<a name="ln-3337"></a>
<a name="ln-3338"></a>     <span class="c">! A86, \field Mixed Regime Stable Ceiling Equation Source</span>
<a name="ln-3339"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3340"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NumValidIntConvectionValueTypes</span> <span class="c">!skipping first 5 whole-model types</span>
<a name="ln-3341"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">86</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-3342"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3343"></a>      <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">MixedStableCeilingEqNum</span> <span class="o">=</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-3344"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">MixedStableCeilingEqNum</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3345"></a>        <span class="c">!  A87, \field Mixed Regime Stable Ceiling Equation User Curve Name</span>
<a name="ln-3346"></a>        <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">MixedStableCeilingUserCurveNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">87</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3347"></a>                                                             <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotInsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-3348"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">MixedStableCeilingUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3349"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3350"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">87</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">87</span><span class="p">)))</span>
<a name="ln-3351"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3352"></a>        <span class="n">ENDIF</span>
<a name="ln-3353"></a>      <span class="n">ENDIF</span>
<a name="ln-3354"></a>      <span class="k">EXIT</span> <span class="c">!found it</span>
<a name="ln-3355"></a>    <span class="n">ENDDO</span>
<a name="ln-3356"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3357"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3358"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">86</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">86</span><span class="p">)))</span>
<a name="ln-3359"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3360"></a>    <span class="n">ENDIF</span>
<a name="ln-3361"></a>
<a name="ln-3362"></a>     <span class="c">! A88, \field Mixed Regime Unstable Ceiling Equation Source</span>
<a name="ln-3363"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3364"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NumValidIntConvectionValueTypes</span> <span class="c">!skipping first 5 whole-model types</span>
<a name="ln-3365"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">88</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-3366"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3367"></a>      <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">MixedUnstableCeilingEqNum</span> <span class="o">=</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-3368"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">MixedUnstableCeilingEqNum</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3369"></a>        <span class="c">!  A89, \field Mixed Regime Unstable Ceiling Equation User Curve Name</span>
<a name="ln-3370"></a>        <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">MixedUnstableCeilingUserCurveNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">89</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3371"></a>                                                             <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotInsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-3372"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">MixedUnstableCeilingUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3373"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3374"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">89</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">89</span><span class="p">)))</span>
<a name="ln-3375"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3376"></a>        <span class="n">ENDIF</span>
<a name="ln-3377"></a>      <span class="n">ENDIF</span>
<a name="ln-3378"></a>      <span class="k">EXIT</span> <span class="c">!found it</span>
<a name="ln-3379"></a>    <span class="n">ENDDO</span>
<a name="ln-3380"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3381"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3382"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">88</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">88</span><span class="p">)))</span>
<a name="ln-3383"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3384"></a>    <span class="n">ENDIF</span>
<a name="ln-3385"></a>
<a name="ln-3386"></a>     <span class="c">! A90, \field Mixed Regime Window Equation Source</span>
<a name="ln-3387"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3388"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">NumValidIntConvectionValueTypes</span> <span class="c">!skipping first 5 whole-model types</span>
<a name="ln-3389"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">90</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidIntConvectionValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-3390"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3391"></a>      <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">MixedWindowsEqNum</span> <span class="o">=</span> <span class="n">IntConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-3392"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">MixedWindowsEqNum</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3393"></a>        <span class="c">!   A91; \field Mixed Regime Window Equation User Curve Name</span>
<a name="ln-3394"></a>        <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">MixedWindowsUserCurveNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">91</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3395"></a>                                                             <span class="n">HcInsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotInsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-3396"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">MixedWindowsUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3397"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3398"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">91</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">91</span><span class="p">)))</span>
<a name="ln-3399"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3400"></a>        <span class="n">ENDIF</span>
<a name="ln-3401"></a>      <span class="n">ENDIF</span>
<a name="ln-3402"></a>      <span class="k">EXIT</span> <span class="c">!found it</span>
<a name="ln-3403"></a>    <span class="n">ENDDO</span>
<a name="ln-3404"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3405"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3406"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">90</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">90</span><span class="p">)))</span>
<a name="ln-3407"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3408"></a>    <span class="n">ENDIF</span>
<a name="ln-3409"></a>
<a name="ln-3410"></a>  <span class="n">ENDIF</span> <span class="c">!end of &#39;SurfaceConvectionAlgorithm:Inside:AdaptiveModelSelections&#39;</span>
<a name="ln-3411"></a>
<a name="ln-3412"></a>  <span class="n">CurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;SurfaceConvectionAlgorithm:Outside:AdaptiveModelSelections&#39;</span>
<a name="ln-3413"></a>  <span class="nb">Count</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span>
<a name="ln-3414"></a>  <span class="c">!IF (Count &gt; 1) ! throw  error ... TODO or IP handles it</span>
<a name="ln-3415"></a>  <span class="k">IF</span> <span class="p">(</span><span class="nb">Count</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3416"></a><span class="k">    CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">Status</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3417"></a>                 <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3418"></a>                 <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-3419"></a>    <span class="n">OutsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c">!not used by E+, unique object</span>
<a name="ln-3420"></a>    <span class="n">OutsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">EnteredByUser</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3421"></a>
<a name="ln-3422"></a>
<a name="ln-3423"></a>
<a name="ln-3424"></a>    <span class="c">! A2 , \field Wind Convection Windward Vertical Wall Equation Source</span>
<a name="ln-3425"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3426"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">NumValidSpecificExtWindConvValueTypes</span>
<a name="ln-3427"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidSpecificExtWindConvValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-3428"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3429"></a>      <span class="n">OutsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">HWindWallWindwardEqNum</span>  <span class="o">=</span> <span class="n">MoreSpecificExtWindConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-3430"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">OutsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">HWindWallWindwardEqNum</span> <span class="o">==</span> <span class="n">HcExt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3431"></a>        <span class="c">!  A3 , \field Wind Convection Windward Equation Vertical Wall User Curve Name</span>
<a name="ln-3432"></a>        <span class="n">OutsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">HWindWallWindwardUserCurveNum</span>  <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3433"></a>                                                             <span class="n">HcOutsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotOutsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-3434"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">OutsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">HWindWallWindwardUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3435"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3436"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-3437"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3438"></a>        <span class="n">ENDIF</span>
<a name="ln-3439"></a>      <span class="n">ENDIF</span>
<a name="ln-3440"></a>      <span class="k">EXIT</span>
<a name="ln-3441"></a><span class="k">    </span><span class="n">ENDDO</span>
<a name="ln-3442"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3443"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3444"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-3445"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3446"></a>    <span class="n">ENDIF</span>
<a name="ln-3447"></a>
<a name="ln-3448"></a>    <span class="c">! A4 , \field Wind Convection Leeward Vertical Wall Equation Source</span>
<a name="ln-3449"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3450"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">NumValidSpecificExtWindConvValueTypes</span>
<a name="ln-3451"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidSpecificExtWindConvValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-3452"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3453"></a>      <span class="n">OutsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">HWindWallLeewardEqNum</span>  <span class="o">=</span> <span class="n">MoreSpecificExtWindConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-3454"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">OutsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">HWindWallLeewardEqNum</span> <span class="o">==</span> <span class="n">HcExt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3455"></a>        <span class="c">! A5 , \field Wind Convection Leeward Vertical Wall Equation User Curve Name</span>
<a name="ln-3456"></a>        <span class="n">OutsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">HWindWallLeewardUserCurveNum</span>  <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3457"></a>                                                             <span class="n">HcOutsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotOutsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-3458"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">OutsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">HWindWallLeewardUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3459"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3460"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-3461"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3462"></a>        <span class="n">ENDIF</span>
<a name="ln-3463"></a>      <span class="n">ENDIF</span>
<a name="ln-3464"></a>      <span class="k">EXIT</span>
<a name="ln-3465"></a><span class="k">    </span><span class="n">ENDDO</span>
<a name="ln-3466"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3467"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3468"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-3469"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3470"></a>    <span class="n">ENDIF</span>
<a name="ln-3471"></a>
<a name="ln-3472"></a>    <span class="c">! A6 , \field Wind Convection Horizontal Roof Equation Source</span>
<a name="ln-3473"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3474"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NumValidSpecificExtWindConvValueTypes</span>
<a name="ln-3475"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidSpecificExtWindConvValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-3476"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3477"></a>      <span class="n">OutsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">HWindHorizRoofEqNum</span>  <span class="o">=</span> <span class="n">MoreSpecificExtWindConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-3478"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">OutsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">HWindHorizRoofEqNum</span> <span class="o">==</span> <span class="n">HcExt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3479"></a>        <span class="c">!  A7 , \field Wind Convection Horizontal Roof User Curve Name</span>
<a name="ln-3480"></a>        <span class="n">OutsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">HWindHorizRoofUserCurveNum</span>  <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3481"></a>                                                             <span class="n">HcOutsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotOutsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-3482"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">OutsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">HWindHorizRoofUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3483"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3484"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">)))</span>
<a name="ln-3485"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3486"></a>        <span class="n">ENDIF</span>
<a name="ln-3487"></a>      <span class="n">ENDIF</span>
<a name="ln-3488"></a>      <span class="k">EXIT</span>
<a name="ln-3489"></a><span class="k">    </span><span class="n">ENDDO</span>
<a name="ln-3490"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3491"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3492"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-3493"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3494"></a>    <span class="n">ENDIF</span>
<a name="ln-3495"></a>
<a name="ln-3496"></a>    <span class="c">!  A8 , \field Natural Convection Vertical Wall Equation Source</span>
<a name="ln-3497"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3498"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NumValidSpecificExtNatConvectValueTypes</span>
<a name="ln-3499"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidSpecificExtNatConvectValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-3500"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3501"></a>      <span class="n">OutsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">HNatVertWallEqNum</span>  <span class="o">=</span> <span class="n">SpecificExtNatConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-3502"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">OutsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">HNatVertWallEqNum</span> <span class="o">==</span> <span class="n">HcExt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3503"></a>        <span class="c">!  A9 , \field Natural Convection Vertical Wall Equation User Curve Name</span>
<a name="ln-3504"></a>        <span class="n">OutsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">HNatVertWallUserCurveNum</span>  <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3505"></a>                                                             <span class="n">HcOutsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotOutsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-3506"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">OutsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">HNatVertWallUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3507"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3508"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">)))</span>
<a name="ln-3509"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3510"></a>        <span class="n">ENDIF</span>
<a name="ln-3511"></a>      <span class="n">ENDIF</span>
<a name="ln-3512"></a>      <span class="k">EXIT</span>
<a name="ln-3513"></a><span class="k">    </span><span class="n">ENDDO</span>
<a name="ln-3514"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3515"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3516"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">)))</span>
<a name="ln-3517"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3518"></a>    <span class="n">ENDIF</span>
<a name="ln-3519"></a>
<a name="ln-3520"></a>    <span class="c">!  A10, \field Natural Convection Stable Horizontal Equation Source</span>
<a name="ln-3521"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3522"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NumValidSpecificExtNatConvectValueTypes</span>
<a name="ln-3523"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidSpecificExtNatConvectValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-3524"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3525"></a>      <span class="n">OutsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">HNatStableHorizEqNum</span>  <span class="o">=</span> <span class="n">SpecificExtNatConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-3526"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">OutsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">HNatStableHorizEqNum</span> <span class="o">==</span> <span class="n">HcExt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3527"></a>        <span class="c">!  A11, \field Natural Convection Stable Horizontal Equation User Curve Name</span>
<a name="ln-3528"></a>        <span class="n">OutsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">HNatStableHorizUserCurveNum</span>  <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3529"></a>                                                             <span class="n">HcOutsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotOutsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-3530"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">OutsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">HNatStableHorizUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3531"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3532"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">11</span><span class="p">)))</span>
<a name="ln-3533"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3534"></a>        <span class="n">ENDIF</span>
<a name="ln-3535"></a>      <span class="n">ENDIF</span>
<a name="ln-3536"></a>      <span class="k">EXIT</span>
<a name="ln-3537"></a><span class="k">    </span><span class="n">ENDDO</span>
<a name="ln-3538"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3539"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3540"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span>
<a name="ln-3541"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3542"></a>    <span class="n">ENDIF</span>
<a name="ln-3543"></a>
<a name="ln-3544"></a>    <span class="c">!   A12, \field Natural Convection Unstable Horizontal Equation Source</span>
<a name="ln-3545"></a>    <span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3546"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NumValidSpecificExtNatConvectValueTypes</span>
<a name="ln-3547"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ValidSpecificExtNatConvectValueTypes</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-3548"></a><span class="k">      </span><span class="n">IsValidType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3549"></a>      <span class="n">OutsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">HNatStableHorizEqNum</span>  <span class="o">=</span> <span class="n">SpecificExtNatConvectionValue</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)</span>
<a name="ln-3550"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">OutsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">HNatStableHorizEqNum</span> <span class="o">==</span> <span class="n">HcExt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3551"></a>        <span class="c">! A13; \field Natural Convection Unstable Horizontal Equation User Curve Name</span>
<a name="ln-3552"></a>        <span class="n">OutsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">HNatStableHorizUserCurveNum</span>  <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">13</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3553"></a>                                                             <span class="n">HcOutsideUserCurve</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="n">TotOutsideHcUserCurves</span> <span class="p">)</span>
<a name="ln-3554"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">OutsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">HNatStableHorizUserCurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3555"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3556"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Name choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">13</span><span class="p">)))</span>
<a name="ln-3557"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3558"></a>        <span class="n">ENDIF</span>
<a name="ln-3559"></a>      <span class="n">ENDIF</span>
<a name="ln-3560"></a>      <span class="k">EXIT</span>
<a name="ln-3561"></a><span class="k">    </span><span class="n">ENDDO</span>
<a name="ln-3562"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IsValidType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3563"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, invalid value&#39;</span><span class="p">)</span>
<a name="ln-3564"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid Key choice Entered, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">12</span><span class="p">)))</span>
<a name="ln-3565"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3566"></a>    <span class="n">ENDIF</span>
<a name="ln-3567"></a>
<a name="ln-3568"></a>  <span class="n">ENDIF</span> <span class="c">! end of &#39;SurfaceConvectionAlgorithm:Outside:AdaptiveModelSelections&#39;</span>
<a name="ln-3569"></a>
<a name="ln-3570"></a>
<a name="ln-3571"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3572"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Errors found getting input.  Program termination.&#39;</span><span class="p">)</span>
<a name="ln-3573"></a>  <span class="n">ENDIF</span>
<a name="ln-3574"></a>
<a name="ln-3575"></a>  <span class="k">CALL </span><span class="n">SetupAdaptiveConvectionStaticMetaData</span>
<a name="ln-3576"></a>
<a name="ln-3577"></a>
<a name="ln-3578"></a>  <span class="k">RETURN</span>
<a name="ln-3579"></a>
<a name="ln-3580"></a><span class="k">CONTAINS</span>
<a name="ln-3581"></a><span class="c">! Internal subroutines to GetUserConvectionCoefficients</span>
<a name="ln-3582"></a><span class="k">SUBROUTINE </span><span class="n">ApplyConvectionValue</span><span class="p">(</span><span class="n">SurfaceTypes</span><span class="p">,</span><span class="n">ConvectionType</span><span class="p">,</span><span class="k">Value</span><span class="p">)</span>
<a name="ln-3583"></a>
<a name="ln-3584"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3585"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-3586"></a>          <span class="c">!       DATE WRITTEN   November 2004</span>
<a name="ln-3587"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-3588"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3589"></a>
<a name="ln-3590"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3591"></a>          <span class="c">! This subroutine applies a convection type to a set of surfaces.  This is</span>
<a name="ln-3592"></a>          <span class="c">! one of the &quot;regular&quot; convection types and becomes a &quot;negative&quot; convection</span>
<a name="ln-3593"></a>          <span class="c">! type to that surface.</span>
<a name="ln-3594"></a>
<a name="ln-3595"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3596"></a>          <span class="c">! na</span>
<a name="ln-3597"></a>
<a name="ln-3598"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3599"></a>          <span class="c">! na</span>
<a name="ln-3600"></a>
<a name="ln-3601"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3602"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-3603"></a>
<a name="ln-3604"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3605"></a>
<a name="ln-3606"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3607"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfaceTypes</span>
<a name="ln-3608"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ConvectionType</span>
<a name="ln-3609"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="k">Value</span>
<a name="ln-3610"></a>
<a name="ln-3611"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3612"></a>          <span class="c">! na</span>
<a name="ln-3613"></a>
<a name="ln-3614"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-3615"></a>          <span class="c">! na</span>
<a name="ln-3616"></a>
<a name="ln-3617"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-3618"></a>          <span class="c">! na</span>
<a name="ln-3619"></a>
<a name="ln-3620"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3621"></a>  <span class="kt">INTEGER </span><span class="n">SurfNum</span>
<a name="ln-3622"></a>  <span class="kt">LOGICAL </span><span class="n">SurfacesOfType</span>
<a name="ln-3623"></a>  <span class="kt">INTEGER </span><span class="n">SurfaceCountOutside</span>
<a name="ln-3624"></a>  <span class="kt">INTEGER </span><span class="n">SurfaceCountInside</span>
<a name="ln-3625"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">52</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OverwriteMessage</span>
<a name="ln-3626"></a>
<a name="ln-3627"></a>  <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">SurfaceTypes</span><span class="p">)</span>
<a name="ln-3628"></a>
<a name="ln-3629"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;ALLEXTERIORSURFACES&#39;</span><span class="p">)</span>
<a name="ln-3630"></a>      <span class="n">SurfacesOfType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3631"></a>      <span class="n">SurfaceCountOutside</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-3632"></a>      <span class="n">SurfaceCountInside</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-3633"></a>      <span class="k">DO </span><span class="n">SurfNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-3634"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3635"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>    <span class="c">! Interior surfaces</span>
<a name="ln-3636"></a>        <span class="n">SurfacesOfType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3637"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ConvectionType</span> <span class="o">==</span> <span class="s1">&#39;OUTSIDE&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3638"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OSCPtr</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3639"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtConvCoeff</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3640"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3641"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;User Supplied Convection Coefficients, Multiple Surface Assignments=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">SurfaceTypes</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3642"></a>                 <span class="s1">&#39;&quot;, not overwriting already assigned value for (Outside) in Surface=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3643"></a>            <span class="k">ELSE</span>
<a name="ln-3644"></a><span class="k">              </span><span class="n">SurfaceCountOutside</span><span class="o">=</span><span class="n">SurfaceCountOutside</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3645"></a>            <span class="n">ENDIF</span>
<a name="ln-3646"></a>          <span class="k">ELSE</span>
<a name="ln-3647"></a><span class="k">            </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtConvCoeff</span><span class="o">=</span><span class="k">Value</span>
<a name="ln-3648"></a><span class="k">          </span><span class="n">ENDIF</span>
<a name="ln-3649"></a>        <span class="k">ELSE</span>
<a name="ln-3650"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvCoeff</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3651"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3652"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;User Supplied Convection Coefficients, Multiple Surface Assignments=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">SurfaceTypes</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3653"></a>                 <span class="s1">&#39;&quot;, not overwriting already assigned value for (Inside) in Surface=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3654"></a>            <span class="k">ELSE</span>
<a name="ln-3655"></a><span class="k">              </span><span class="n">SurfaceCountInside</span><span class="o">=</span><span class="n">SurfaceCountInside</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3656"></a>            <span class="n">ENDIF</span>
<a name="ln-3657"></a>          <span class="k">ELSE</span>
<a name="ln-3658"></a><span class="k">            </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvCoeff</span><span class="o">=</span><span class="k">Value</span>
<a name="ln-3659"></a><span class="k">          </span><span class="n">ENDIF</span>
<a name="ln-3660"></a>        <span class="n">ENDIF</span>
<a name="ln-3661"></a>      <span class="n">ENDDO</span>
<a name="ln-3662"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DisplayExtraWarnings</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">SurfaceCountOutside</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SurfaceCountInside</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3663"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SurfaceCountOutside</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3664"></a><span class="k">          </span><span class="n">OverwriteMessage</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceCountOutside</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Outside&#39;</span>
<a name="ln-3665"></a>        <span class="n">ENDIF</span>
<a name="ln-3666"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceCountInside</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3667"></a><span class="k">          </span><span class="n">OverwriteMessage</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceCountInside</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Inside&#39;</span>
<a name="ln-3668"></a>        <span class="n">ENDIF</span>
<a name="ln-3669"></a>        <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;User Supplied Convection Coefficients, Multiple Surface Assignments=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">SurfaceTypes</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3670"></a>            <span class="s1">&#39;&quot;, not overwriting already assigned values for &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">OverwriteMessage</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; assignments.&#39;</span><span class="p">)</span>
<a name="ln-3671"></a>      <span class="n">ENDIF</span>
<a name="ln-3672"></a>
<a name="ln-3673"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;ALLEXTERIORWINDOWS&#39;</span><span class="p">)</span>
<a name="ln-3674"></a>      <span class="n">SurfacesOfType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3675"></a>      <span class="n">SurfaceCountOutside</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-3676"></a>      <span class="n">SurfaceCountInside</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-3677"></a>      <span class="k">DO </span><span class="n">SurfNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-3678"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3679"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>    <span class="c">! Interior surfaces</span>
<a name="ln-3680"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TypeIsWindow</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3681"></a><span class="k">        </span><span class="n">SurfacesOfType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3682"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ConvectionType</span> <span class="o">==</span> <span class="s1">&#39;OUTSIDE&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3683"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OSCPtr</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3684"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtConvCoeff</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3685"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3686"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;User Supplied Convection Coefficients, Multiple Surface Assignments=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">SurfaceTypes</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3687"></a>                 <span class="s1">&#39;&quot;, not overwriting already assigned value for (Outside) in Surface=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3688"></a>            <span class="k">ELSE</span>
<a name="ln-3689"></a><span class="k">              </span><span class="n">SurfaceCountOutside</span><span class="o">=</span><span class="n">SurfaceCountOutside</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3690"></a>            <span class="n">ENDIF</span>
<a name="ln-3691"></a>          <span class="k">ELSE</span>
<a name="ln-3692"></a><span class="k">            </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtConvCoeff</span><span class="o">=</span><span class="k">Value</span>
<a name="ln-3693"></a><span class="k">          </span><span class="n">ENDIF</span>
<a name="ln-3694"></a>        <span class="k">ELSE</span>
<a name="ln-3695"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvCoeff</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3696"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3697"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;User Supplied Convection Coefficients, Multiple Surface Assignments=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">SurfaceTypes</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3698"></a>                 <span class="s1">&#39;&quot;, not overwriting already assigned value for (Inside) in Surface=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3699"></a>            <span class="k">ELSE</span>
<a name="ln-3700"></a><span class="k">              </span><span class="n">SurfaceCountInside</span><span class="o">=</span><span class="n">SurfaceCountInside</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3701"></a>            <span class="n">ENDIF</span>
<a name="ln-3702"></a>          <span class="k">ELSE</span>
<a name="ln-3703"></a><span class="k">            </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvCoeff</span><span class="o">=</span><span class="k">Value</span>
<a name="ln-3704"></a><span class="k">          </span><span class="n">ENDIF</span>
<a name="ln-3705"></a>        <span class="n">ENDIF</span>
<a name="ln-3706"></a>      <span class="n">ENDDO</span>
<a name="ln-3707"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DisplayExtraWarnings</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">SurfaceCountOutside</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SurfaceCountInside</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3708"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SurfaceCountOutside</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3709"></a><span class="k">          </span><span class="n">OverwriteMessage</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceCountOutside</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Outside&#39;</span>
<a name="ln-3710"></a>        <span class="n">ENDIF</span>
<a name="ln-3711"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceCountInside</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3712"></a><span class="k">          </span><span class="n">OverwriteMessage</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceCountInside</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Inside&#39;</span>
<a name="ln-3713"></a>        <span class="n">ENDIF</span>
<a name="ln-3714"></a>        <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;User Supplied Convection Coefficients, Multiple Surface Assignments=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">SurfaceTypes</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3715"></a>            <span class="s1">&#39;&quot;, not overwriting already assigned values for &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">OverwriteMessage</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; assignments.&#39;</span><span class="p">)</span>
<a name="ln-3716"></a>      <span class="n">ENDIF</span>
<a name="ln-3717"></a>
<a name="ln-3718"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;ALLEXTERIORWALLS&#39;</span><span class="p">)</span>
<a name="ln-3719"></a>      <span class="n">SurfacesOfType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3720"></a>      <span class="n">SurfaceCountOutside</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-3721"></a>      <span class="n">SurfaceCountInside</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-3722"></a>      <span class="k">DO </span><span class="n">SurfNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-3723"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3724"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>    <span class="c">! Interior surfaces</span>
<a name="ln-3725"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Wall</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3726"></a><span class="k">        </span><span class="n">SurfacesOfType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3727"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ConvectionType</span> <span class="o">==</span> <span class="s1">&#39;OUTSIDE&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3728"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OSCPtr</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3729"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtConvCoeff</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3730"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3731"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;User Supplied Convection Coefficients, Multiple Surface Assignments=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">SurfaceTypes</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3732"></a>                 <span class="s1">&#39;&quot;, not overwriting already assigned value for (Outside) in Surface=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3733"></a>            <span class="k">ELSE</span>
<a name="ln-3734"></a><span class="k">              </span><span class="n">SurfaceCountOutside</span><span class="o">=</span><span class="n">SurfaceCountOutside</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3735"></a>            <span class="n">ENDIF</span>
<a name="ln-3736"></a>          <span class="k">ELSE</span>
<a name="ln-3737"></a><span class="k">            </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtConvCoeff</span><span class="o">=</span><span class="k">Value</span>
<a name="ln-3738"></a><span class="k">          </span><span class="n">ENDIF</span>
<a name="ln-3739"></a>        <span class="k">ELSE</span>
<a name="ln-3740"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvCoeff</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3741"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3742"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;User Supplied Convection Coefficients, Multiple Surface Assignments=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">SurfaceTypes</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3743"></a>                 <span class="s1">&#39;&quot;, not overwriting already assigned value for (Inside) in Surface=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3744"></a>            <span class="k">ELSE</span>
<a name="ln-3745"></a><span class="k">              </span><span class="n">SurfaceCountInside</span><span class="o">=</span><span class="n">SurfaceCountInside</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3746"></a>            <span class="n">ENDIF</span>
<a name="ln-3747"></a>          <span class="k">ELSE</span>
<a name="ln-3748"></a><span class="k">            </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvCoeff</span><span class="o">=</span><span class="k">Value</span>
<a name="ln-3749"></a><span class="k">          </span><span class="n">ENDIF</span>
<a name="ln-3750"></a>        <span class="n">ENDIF</span>
<a name="ln-3751"></a>      <span class="n">ENDDO</span>
<a name="ln-3752"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DisplayExtraWarnings</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">SurfaceCountOutside</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SurfaceCountInside</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3753"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SurfaceCountOutside</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3754"></a><span class="k">          </span><span class="n">OverwriteMessage</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceCountOutside</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Outside&#39;</span>
<a name="ln-3755"></a>        <span class="n">ENDIF</span>
<a name="ln-3756"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceCountInside</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3757"></a><span class="k">          </span><span class="n">OverwriteMessage</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceCountInside</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Inside&#39;</span>
<a name="ln-3758"></a>        <span class="n">ENDIF</span>
<a name="ln-3759"></a>        <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;User Supplied Convection Coefficients, Multiple Surface Assignments=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">SurfaceTypes</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3760"></a>            <span class="s1">&#39;&quot;, not overwriting already assigned values for &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">OverwriteMessage</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; assignments.&#39;</span><span class="p">)</span>
<a name="ln-3761"></a>      <span class="n">ENDIF</span>
<a name="ln-3762"></a>
<a name="ln-3763"></a>    <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;ALLEXTERIORROOFS&#39;</span><span class="p">)</span>
<a name="ln-3764"></a>      <span class="n">SurfacesOfType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3765"></a>      <span class="n">SurfaceCountOutside</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-3766"></a>      <span class="n">SurfaceCountInside</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-3767"></a>      <span class="k">DO </span><span class="n">SurfNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-3768"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3769"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>    <span class="c">! Interior surfaces</span>
<a name="ln-3770"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Roof</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3771"></a><span class="k">        </span><span class="n">SurfacesOfType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3772"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ConvectionType</span> <span class="o">==</span> <span class="s1">&#39;OUTSIDE&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3773"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OSCPtr</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3774"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtConvCoeff</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3775"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3776"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;User Supplied Convection Coefficients, Multiple Surface Assignments=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">SurfaceTypes</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3777"></a>                 <span class="s1">&#39;&quot;, not overwriting already assigned value for (Outside) in Surface=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3778"></a>            <span class="k">ELSE</span>
<a name="ln-3779"></a><span class="k">              </span><span class="n">SurfaceCountOutside</span><span class="o">=</span><span class="n">SurfaceCountOutside</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3780"></a>            <span class="n">ENDIF</span>
<a name="ln-3781"></a>          <span class="k">ELSE</span>
<a name="ln-3782"></a><span class="k">            </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtConvCoeff</span><span class="o">=</span><span class="k">Value</span>
<a name="ln-3783"></a><span class="k">          </span><span class="n">ENDIF</span>
<a name="ln-3784"></a>        <span class="k">ELSE</span>
<a name="ln-3785"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvCoeff</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3786"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3787"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;User Supplied Convection Coefficients, Multiple Surface Assignments=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">SurfaceTypes</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3788"></a>                 <span class="s1">&#39;&quot;, not overwriting already assigned value for (Inside) in Surface=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3789"></a>            <span class="k">ELSE</span>
<a name="ln-3790"></a><span class="k">              </span><span class="n">SurfaceCountInside</span><span class="o">=</span><span class="n">SurfaceCountInside</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3791"></a>            <span class="n">ENDIF</span>
<a name="ln-3792"></a>          <span class="k">ELSE</span>
<a name="ln-3793"></a><span class="k">            </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvCoeff</span><span class="o">=</span><span class="k">Value</span>
<a name="ln-3794"></a><span class="k">          </span><span class="n">ENDIF</span>
<a name="ln-3795"></a>        <span class="n">ENDIF</span>
<a name="ln-3796"></a>      <span class="n">ENDDO</span>
<a name="ln-3797"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DisplayExtraWarnings</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">SurfaceCountOutside</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SurfaceCountInside</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3798"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SurfaceCountOutside</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3799"></a><span class="k">          </span><span class="n">OverwriteMessage</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceCountOutside</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Outside&#39;</span>
<a name="ln-3800"></a>        <span class="n">ENDIF</span>
<a name="ln-3801"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceCountInside</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3802"></a><span class="k">          </span><span class="n">OverwriteMessage</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceCountInside</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Inside&#39;</span>
<a name="ln-3803"></a>        <span class="n">ENDIF</span>
<a name="ln-3804"></a>        <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;User Supplied Convection Coefficients, Multiple Surface Assignments=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">SurfaceTypes</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3805"></a>            <span class="s1">&#39;&quot;, not overwriting already assigned values for &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">OverwriteMessage</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; assignments.&#39;</span><span class="p">)</span>
<a name="ln-3806"></a>      <span class="n">ENDIF</span>
<a name="ln-3807"></a>
<a name="ln-3808"></a>    <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;ALLEXTERIORFLOORS&#39;</span><span class="p">)</span>
<a name="ln-3809"></a>      <span class="n">SurfacesOfType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3810"></a>      <span class="n">SurfaceCountOutside</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-3811"></a>      <span class="n">SurfaceCountInside</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-3812"></a>      <span class="k">DO </span><span class="n">SurfNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-3813"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3814"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>    <span class="c">! Interior surfaces</span>
<a name="ln-3815"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Floor</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3816"></a><span class="k">        </span><span class="n">SurfacesOfType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3817"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ConvectionType</span> <span class="o">==</span> <span class="s1">&#39;OUTSIDE&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3818"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OSCPtr</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3819"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtConvCoeff</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3820"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3821"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;User Supplied Convection Coefficients, Multiple Surface Assignments=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">SurfaceTypes</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3822"></a>                 <span class="s1">&#39;&quot;, not overwriting already assigned value for (Outside) in Surface=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3823"></a>            <span class="k">ELSE</span>
<a name="ln-3824"></a><span class="k">              </span><span class="n">SurfaceCountOutside</span><span class="o">=</span><span class="n">SurfaceCountOutside</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3825"></a>            <span class="n">ENDIF</span>
<a name="ln-3826"></a>          <span class="k">ELSE</span>
<a name="ln-3827"></a><span class="k">            </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtConvCoeff</span><span class="o">=</span><span class="k">Value</span>
<a name="ln-3828"></a><span class="k">          </span><span class="n">ENDIF</span>
<a name="ln-3829"></a>        <span class="k">ELSE</span>
<a name="ln-3830"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvCoeff</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3831"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3832"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;User Supplied Convection Coefficients, Multiple Surface Assignments=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">SurfaceTypes</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3833"></a>                 <span class="s1">&#39;&quot;, not overwriting already assigned value for (Inside) in Surface=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3834"></a>            <span class="k">ELSE</span>
<a name="ln-3835"></a><span class="k">              </span><span class="n">SurfaceCountInside</span><span class="o">=</span><span class="n">SurfaceCountInside</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3836"></a>            <span class="n">ENDIF</span>
<a name="ln-3837"></a>          <span class="k">ELSE</span>
<a name="ln-3838"></a><span class="k">            </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvCoeff</span><span class="o">=</span><span class="k">Value</span>
<a name="ln-3839"></a><span class="k">          </span><span class="n">ENDIF</span>
<a name="ln-3840"></a>        <span class="n">ENDIF</span>
<a name="ln-3841"></a>      <span class="n">ENDDO</span>
<a name="ln-3842"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DisplayExtraWarnings</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">SurfaceCountOutside</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SurfaceCountInside</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3843"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SurfaceCountOutside</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3844"></a><span class="k">          </span><span class="n">OverwriteMessage</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceCountOutside</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Outside&#39;</span>
<a name="ln-3845"></a>        <span class="n">ENDIF</span>
<a name="ln-3846"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceCountInside</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3847"></a><span class="k">          </span><span class="n">OverwriteMessage</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceCountInside</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Inside&#39;</span>
<a name="ln-3848"></a>        <span class="n">ENDIF</span>
<a name="ln-3849"></a>        <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;User Supplied Convection Coefficients, Multiple Surface Assignments=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">SurfaceTypes</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3850"></a>            <span class="s1">&#39;&quot;, not overwriting already assigned values for &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">OverwriteMessage</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; assignments.&#39;</span><span class="p">)</span>
<a name="ln-3851"></a>      <span class="n">ENDIF</span>
<a name="ln-3852"></a>
<a name="ln-3853"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;ALLINTERIORSURFACES&#39;</span><span class="p">)</span>
<a name="ln-3854"></a>      <span class="n">SurfacesOfType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3855"></a>      <span class="n">SurfaceCountOutside</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-3856"></a>      <span class="n">SurfaceCountInside</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-3857"></a>      <span class="k">DO </span><span class="n">SurfNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-3858"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3859"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>    <span class="c">! Exterior surfaces</span>
<a name="ln-3860"></a>        <span class="n">SurfacesOfType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3861"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ConvectionType</span> <span class="o">==</span> <span class="s1">&#39;OUTSIDE&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3862"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OSCPtr</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3863"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtConvCoeff</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3864"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3865"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;User Supplied Convection Coefficients, Multiple Surface Assignments=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">SurfaceTypes</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3866"></a>                 <span class="s1">&#39;&quot;, not overwriting already assigned value for (Outside) in Surface=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3867"></a>            <span class="k">ELSE</span>
<a name="ln-3868"></a><span class="k">              </span><span class="n">SurfaceCountOutside</span><span class="o">=</span><span class="n">SurfaceCountOutside</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3869"></a>            <span class="n">ENDIF</span>
<a name="ln-3870"></a>          <span class="k">ELSE</span>
<a name="ln-3871"></a><span class="k">            </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtConvCoeff</span><span class="o">=</span><span class="k">Value</span>
<a name="ln-3872"></a><span class="k">          </span><span class="n">ENDIF</span>
<a name="ln-3873"></a>        <span class="k">ELSE</span>
<a name="ln-3874"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvCoeff</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3875"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3876"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;User Supplied Convection Coefficients, Multiple Surface Assignments=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">SurfaceTypes</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3877"></a>                 <span class="s1">&#39;&quot;, not overwriting already assigned value for (Inside) in Surface=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3878"></a>            <span class="k">ELSE</span>
<a name="ln-3879"></a><span class="k">              </span><span class="n">SurfaceCountInside</span><span class="o">=</span><span class="n">SurfaceCountInside</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3880"></a>            <span class="n">ENDIF</span>
<a name="ln-3881"></a>          <span class="k">ELSE</span>
<a name="ln-3882"></a><span class="k">            </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvCoeff</span><span class="o">=</span><span class="k">Value</span>
<a name="ln-3883"></a><span class="k">          </span><span class="n">ENDIF</span>
<a name="ln-3884"></a>        <span class="n">ENDIF</span>
<a name="ln-3885"></a>      <span class="n">ENDDO</span>
<a name="ln-3886"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DisplayExtraWarnings</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">SurfaceCountOutside</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SurfaceCountInside</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3887"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SurfaceCountOutside</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3888"></a><span class="k">          </span><span class="n">OverwriteMessage</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceCountOutside</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Outside&#39;</span>
<a name="ln-3889"></a>        <span class="n">ENDIF</span>
<a name="ln-3890"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceCountInside</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3891"></a><span class="k">          </span><span class="n">OverwriteMessage</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceCountInside</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Inside&#39;</span>
<a name="ln-3892"></a>        <span class="n">ENDIF</span>
<a name="ln-3893"></a>        <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;User Supplied Convection Coefficients, Multiple Surface Assignments=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">SurfaceTypes</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3894"></a>            <span class="s1">&#39;&quot;, not overwriting already assigned values for &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">OverwriteMessage</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; assignments.&#39;</span><span class="p">)</span>
<a name="ln-3895"></a>      <span class="n">ENDIF</span>
<a name="ln-3896"></a>
<a name="ln-3897"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;ALLINTERIORWINDOWS&#39;</span><span class="p">)</span>
<a name="ln-3898"></a>      <span class="n">SurfacesOfType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3899"></a>      <span class="n">SurfaceCountOutside</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-3900"></a>      <span class="n">SurfaceCountInside</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-3901"></a>      <span class="k">DO </span><span class="n">SurfNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-3902"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3903"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>    <span class="c">! Exterior surfaces</span>
<a name="ln-3904"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TypeIsWindow</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3905"></a><span class="k">        </span><span class="n">SurfacesOfType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3906"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ConvectionType</span> <span class="o">==</span> <span class="s1">&#39;OUTSIDE&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3907"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OSCPtr</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3908"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtConvCoeff</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3909"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3910"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;User Supplied Convection Coefficients, Multiple Surface Assignments=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">SurfaceTypes</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3911"></a>                 <span class="s1">&#39;&quot;, not overwriting already assigned value for (Outside) in Surface=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3912"></a>            <span class="k">ELSE</span>
<a name="ln-3913"></a><span class="k">              </span><span class="n">SurfaceCountOutside</span><span class="o">=</span><span class="n">SurfaceCountOutside</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3914"></a>            <span class="n">ENDIF</span>
<a name="ln-3915"></a>          <span class="k">ELSE</span>
<a name="ln-3916"></a><span class="k">            </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtConvCoeff</span><span class="o">=</span><span class="k">Value</span>
<a name="ln-3917"></a><span class="k">          </span><span class="n">ENDIF</span>
<a name="ln-3918"></a>        <span class="k">ELSE</span>
<a name="ln-3919"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvCoeff</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3920"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3921"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;User Supplied Convection Coefficients, Multiple Surface Assignments=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">SurfaceTypes</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3922"></a>                 <span class="s1">&#39;&quot;, not overwriting already assigned value for (Inside) in Surface=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3923"></a>            <span class="k">ELSE</span>
<a name="ln-3924"></a><span class="k">              </span><span class="n">SurfaceCountInside</span><span class="o">=</span><span class="n">SurfaceCountInside</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3925"></a>            <span class="n">ENDIF</span>
<a name="ln-3926"></a>          <span class="k">ELSE</span>
<a name="ln-3927"></a><span class="k">            </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvCoeff</span><span class="o">=</span><span class="k">Value</span>
<a name="ln-3928"></a><span class="k">          </span><span class="n">ENDIF</span>
<a name="ln-3929"></a>        <span class="n">ENDIF</span>
<a name="ln-3930"></a>      <span class="n">ENDDO</span>
<a name="ln-3931"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DisplayExtraWarnings</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">SurfaceCountOutside</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SurfaceCountInside</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3932"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SurfaceCountOutside</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3933"></a><span class="k">          </span><span class="n">OverwriteMessage</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceCountOutside</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Outside&#39;</span>
<a name="ln-3934"></a>        <span class="n">ENDIF</span>
<a name="ln-3935"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceCountInside</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3936"></a><span class="k">          </span><span class="n">OverwriteMessage</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceCountInside</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Inside&#39;</span>
<a name="ln-3937"></a>        <span class="n">ENDIF</span>
<a name="ln-3938"></a>        <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;User Supplied Convection Coefficients, Multiple Surface Assignments=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">SurfaceTypes</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3939"></a>            <span class="s1">&#39;&quot;, not overwriting already assigned values for &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">OverwriteMessage</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; assignments.&#39;</span><span class="p">)</span>
<a name="ln-3940"></a>      <span class="n">ENDIF</span>
<a name="ln-3941"></a>
<a name="ln-3942"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;ALLINTERIORWALLS&#39;</span><span class="p">)</span>
<a name="ln-3943"></a>      <span class="n">SurfacesOfType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3944"></a>      <span class="n">SurfaceCountOutside</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-3945"></a>      <span class="n">SurfaceCountInside</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-3946"></a>      <span class="k">DO </span><span class="n">SurfNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-3947"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3948"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>    <span class="c">! Exterior surfaces</span>
<a name="ln-3949"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Wall</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3950"></a><span class="k">        </span><span class="n">SurfacesOfType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3951"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ConvectionType</span> <span class="o">==</span> <span class="s1">&#39;OUTSIDE&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3952"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OSCPtr</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3953"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtConvCoeff</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3954"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3955"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;User Supplied Convection Coefficients, Multiple Surface Assignments=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">SurfaceTypes</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3956"></a>                 <span class="s1">&#39;&quot;, not overwriting already assigned value for (Outside) in Surface=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3957"></a>            <span class="k">ELSE</span>
<a name="ln-3958"></a><span class="k">              </span><span class="n">SurfaceCountOutside</span><span class="o">=</span><span class="n">SurfaceCountOutside</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3959"></a>            <span class="n">ENDIF</span>
<a name="ln-3960"></a>          <span class="k">ELSE</span>
<a name="ln-3961"></a><span class="k">            </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtConvCoeff</span><span class="o">=</span><span class="k">Value</span>
<a name="ln-3962"></a><span class="k">          </span><span class="n">ENDIF</span>
<a name="ln-3963"></a>        <span class="k">ELSE</span>
<a name="ln-3964"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvCoeff</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3965"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3966"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;User Supplied Convection Coefficients, Multiple Surface Assignments=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">SurfaceTypes</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3967"></a>                 <span class="s1">&#39;&quot;, not overwriting already assigned value for (Inside) in Surface=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3968"></a>            <span class="k">ELSE</span>
<a name="ln-3969"></a><span class="k">              </span><span class="n">SurfaceCountInside</span><span class="o">=</span><span class="n">SurfaceCountInside</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3970"></a>            <span class="n">ENDIF</span>
<a name="ln-3971"></a>          <span class="k">ELSE</span>
<a name="ln-3972"></a><span class="k">            </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvCoeff</span><span class="o">=</span><span class="k">Value</span>
<a name="ln-3973"></a><span class="k">          </span><span class="n">ENDIF</span>
<a name="ln-3974"></a>        <span class="n">ENDIF</span>
<a name="ln-3975"></a>      <span class="n">ENDDO</span>
<a name="ln-3976"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DisplayExtraWarnings</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">SurfaceCountOutside</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SurfaceCountInside</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3977"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SurfaceCountOutside</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3978"></a><span class="k">          </span><span class="n">OverwriteMessage</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceCountOutside</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Outside&#39;</span>
<a name="ln-3979"></a>        <span class="n">ENDIF</span>
<a name="ln-3980"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceCountInside</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3981"></a><span class="k">          </span><span class="n">OverwriteMessage</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceCountInside</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Inside&#39;</span>
<a name="ln-3982"></a>        <span class="n">ENDIF</span>
<a name="ln-3983"></a>        <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;User Supplied Convection Coefficients, Multiple Surface Assignments=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">SurfaceTypes</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3984"></a>            <span class="s1">&#39;&quot;, not overwriting already assigned values for &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">OverwriteMessage</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; assignments.&#39;</span><span class="p">)</span>
<a name="ln-3985"></a>      <span class="n">ENDIF</span>
<a name="ln-3986"></a>
<a name="ln-3987"></a>    <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;ALLINTERIORROOFS&#39;</span><span class="p">,</span><span class="s1">&#39;ALLINTERIORCEILINGS&#39;</span><span class="p">)</span>
<a name="ln-3988"></a>      <span class="n">SurfacesOfType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3989"></a>      <span class="n">SurfaceCountOutside</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-3990"></a>      <span class="n">SurfaceCountInside</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-3991"></a>      <span class="k">DO </span><span class="n">SurfNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-3992"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3993"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>    <span class="c">! Exterior surfaces</span>
<a name="ln-3994"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Roof</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3995"></a><span class="k">        </span><span class="n">SurfacesOfType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3996"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ConvectionType</span> <span class="o">==</span> <span class="s1">&#39;OUTSIDE&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3997"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OSCPtr</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3998"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtConvCoeff</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3999"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4000"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;User Supplied Convection Coefficients, Multiple Surface Assignments=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">SurfaceTypes</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4001"></a>                 <span class="s1">&#39;&quot;, not overwriting already assigned value for (Outside) in Surface=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4002"></a>            <span class="k">ELSE</span>
<a name="ln-4003"></a><span class="k">              </span><span class="n">SurfaceCountOutside</span><span class="o">=</span><span class="n">SurfaceCountOutside</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-4004"></a>            <span class="n">ENDIF</span>
<a name="ln-4005"></a>          <span class="k">ELSE</span>
<a name="ln-4006"></a><span class="k">            </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtConvCoeff</span><span class="o">=</span><span class="k">Value</span>
<a name="ln-4007"></a><span class="k">          </span><span class="n">ENDIF</span>
<a name="ln-4008"></a>        <span class="k">ELSE</span>
<a name="ln-4009"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvCoeff</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4010"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4011"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;User Supplied Convection Coefficients, Multiple Surface Assignments=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">SurfaceTypes</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4012"></a>                 <span class="s1">&#39;&quot;, not overwriting already assigned value for (Inside) in Surface=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4013"></a>            <span class="k">ELSE</span>
<a name="ln-4014"></a><span class="k">              </span><span class="n">SurfaceCountInside</span><span class="o">=</span><span class="n">SurfaceCountInside</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-4015"></a>            <span class="n">ENDIF</span>
<a name="ln-4016"></a>          <span class="k">ELSE</span>
<a name="ln-4017"></a><span class="k">            </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvCoeff</span><span class="o">=</span><span class="k">Value</span>
<a name="ln-4018"></a><span class="k">          </span><span class="n">ENDIF</span>
<a name="ln-4019"></a>        <span class="n">ENDIF</span>
<a name="ln-4020"></a>      <span class="n">ENDDO</span>
<a name="ln-4021"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DisplayExtraWarnings</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">SurfaceCountOutside</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SurfaceCountInside</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4022"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SurfaceCountOutside</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4023"></a><span class="k">          </span><span class="n">OverwriteMessage</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceCountOutside</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Outside&#39;</span>
<a name="ln-4024"></a>        <span class="n">ENDIF</span>
<a name="ln-4025"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceCountInside</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4026"></a><span class="k">          </span><span class="n">OverwriteMessage</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceCountInside</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Inside&#39;</span>
<a name="ln-4027"></a>        <span class="n">ENDIF</span>
<a name="ln-4028"></a>        <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;User Supplied Convection Coefficients, Multiple Surface Assignments=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">SurfaceTypes</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4029"></a>            <span class="s1">&#39;&quot;, not overwriting already assigned values for &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">OverwriteMessage</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; assignments.&#39;</span><span class="p">)</span>
<a name="ln-4030"></a>      <span class="n">ENDIF</span>
<a name="ln-4031"></a>
<a name="ln-4032"></a>    <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;ALLINTERIORFLOORS&#39;</span><span class="p">)</span>
<a name="ln-4033"></a>      <span class="n">SurfacesOfType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4034"></a>      <span class="n">SurfaceCountOutside</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4035"></a>      <span class="n">SurfaceCountInside</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4036"></a>      <span class="k">DO </span><span class="n">SurfNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-4037"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-4038"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>    <span class="c">! Exterior surfaces</span>
<a name="ln-4039"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Floor</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-4040"></a><span class="k">        </span><span class="n">SurfacesOfType</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4041"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ConvectionType</span> <span class="o">==</span> <span class="s1">&#39;OUTSIDE&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4042"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OSCPtr</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-4043"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtConvCoeff</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4044"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4045"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;User Supplied Convection Coefficients, Multiple Surface Assignments=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">SurfaceTypes</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4046"></a>                 <span class="s1">&#39;&quot;, not overwriting already assigned value for (Outside) in Surface=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4047"></a>            <span class="k">ELSE</span>
<a name="ln-4048"></a><span class="k">              </span><span class="n">SurfaceCountOutside</span><span class="o">=</span><span class="n">SurfaceCountOutside</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-4049"></a>            <span class="n">ENDIF</span>
<a name="ln-4050"></a>          <span class="k">ELSE</span>
<a name="ln-4051"></a><span class="k">            </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtConvCoeff</span><span class="o">=</span><span class="k">Value</span>
<a name="ln-4052"></a><span class="k">          </span><span class="n">ENDIF</span>
<a name="ln-4053"></a>        <span class="k">ELSE</span>
<a name="ln-4054"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvCoeff</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4055"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4056"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;User Supplied Convection Coefficients, Multiple Surface Assignments=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">SurfaceTypes</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4057"></a>                 <span class="s1">&#39;&quot;, not overwriting already assigned value for (Inside) in Surface=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4058"></a>            <span class="k">ELSE</span>
<a name="ln-4059"></a><span class="k">              </span><span class="n">SurfaceCountInside</span><span class="o">=</span><span class="n">SurfaceCountInside</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-4060"></a>            <span class="n">ENDIF</span>
<a name="ln-4061"></a>          <span class="k">ELSE</span>
<a name="ln-4062"></a><span class="k">            </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvCoeff</span><span class="o">=</span><span class="k">Value</span>
<a name="ln-4063"></a><span class="k">          </span><span class="n">ENDIF</span>
<a name="ln-4064"></a>        <span class="n">ENDIF</span>
<a name="ln-4065"></a>      <span class="n">ENDDO</span>
<a name="ln-4066"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DisplayExtraWarnings</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">SurfaceCountOutside</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SurfaceCountInside</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4067"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SurfaceCountOutside</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4068"></a><span class="k">          </span><span class="n">OverwriteMessage</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceCountOutside</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Outside&#39;</span>
<a name="ln-4069"></a>        <span class="n">ENDIF</span>
<a name="ln-4070"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceCountInside</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4071"></a><span class="k">          </span><span class="n">OverwriteMessage</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SurfaceCountInside</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Inside&#39;</span>
<a name="ln-4072"></a>        <span class="n">ENDIF</span>
<a name="ln-4073"></a>        <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;User Supplied Convection Coefficients, Multiple Surface Assignments=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">SurfaceTypes</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4074"></a>            <span class="s1">&#39;&quot;, not overwriting already assigned values for &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">OverwriteMessage</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; assignments.&#39;</span><span class="p">)</span>
<a name="ln-4075"></a>      <span class="n">ENDIF</span>
<a name="ln-4076"></a>
<a name="ln-4077"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-4078"></a>      <span class="n">SurfacesOfType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4079"></a>
<a name="ln-4080"></a>  <span class="k">END SELECT</span>
<a name="ln-4081"></a>
<a name="ln-4082"></a><span class="k">  IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SurfacesOfType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4083"></a><span class="k">    CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;User Supplied Convection Coefficients, Multiple Surface Assignments=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">SurfaceTypes</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4084"></a>       <span class="s1">&#39;&quot;, there were no surfaces of that type found for &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">ConvectionType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; assignment.&#39;</span><span class="p">)</span>
<a name="ln-4085"></a>  <span class="n">ENDIF</span>
<a name="ln-4086"></a>
<a name="ln-4087"></a>  <span class="k">RETURN</span>
<a name="ln-4088"></a>
<a name="ln-4089"></a><span class="k">END SUBROUTINE </span><span class="n">ApplyConvectionValue</span>
<a name="ln-4090"></a>
<a name="ln-4091"></a><span class="k">END SUBROUTINE </span><span class="n">GetUserConvectionCoefficients</span>
<a name="ln-4092"></a>
<a name="ln-4093"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">CalcASHRAESimpExtConvectCoeff</span><span class="p">(</span><span class="n">Roughness</span><span class="p">,</span> <span class="n">SurfWindSpeed</span><span class="p">)</span>
<a name="ln-4094"></a>
<a name="ln-4095"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-4096"></a>          <span class="c">!       AUTHOR         Rick Strand</span>
<a name="ln-4097"></a>          <span class="c">!       DATE WRITTEN   August 2000</span>
<a name="ln-4098"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4099"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4100"></a>
<a name="ln-4101"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-4102"></a>          <span class="c">! This subroutine calculates the exterior convection coefficient</span>
<a name="ln-4103"></a>          <span class="c">! using the ASHRAE Simple Method from a correlation from Figure 1</span>
<a name="ln-4104"></a>          <span class="c">! on p. 22.4 of the 1989 ASHRAE Handbook of Fundamentals.</span>
<a name="ln-4105"></a>          <span class="c">! This is a combined coefficient that includes radiation to sky, ground, and air.</span>
<a name="ln-4106"></a>
<a name="ln-4107"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4108"></a>          <span class="c">! Apply the correlation based on the input data.</span>
<a name="ln-4109"></a>
<a name="ln-4110"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4111"></a>          <span class="c">! ASHRAE Handbook of Fundamentals 1989, p.22.4</span>
<a name="ln-4112"></a>
<a name="ln-4113"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4114"></a>          <span class="c">! na</span>
<a name="ln-4115"></a>
<a name="ln-4116"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4117"></a>
<a name="ln-4118"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-4119"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Roughness</span>  <span class="c">! Integer index for roughness, relates to parameter array indices</span>
<a name="ln-4120"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfWindSpeed</span>  <span class="c">! Current wind speed, m/s</span>
<a name="ln-4121"></a>
<a name="ln-4122"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-4123"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="kd">::</span> <span class="n">D</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span> <span class="mi">1</span><span class="mf">1.58d0</span><span class="p">,</span> <span class="mi">1</span><span class="mf">2.49d0</span><span class="p">,</span> <span class="mi">1</span><span class="mf">0.79d0</span><span class="p">,</span> <span class="mf">8.23d0</span><span class="p">,</span> <span class="mi">1</span><span class="mf">0.22d0</span><span class="p">,</span> <span class="mf">8.23d0</span> <span class="o">/</span><span class="p">)</span>
<a name="ln-4124"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="kd">::</span> <span class="n">E</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span> <span class="mf">5.894d0</span><span class="p">,</span> <span class="mf">4.065d0</span><span class="p">,</span> <span class="mf">4.192d0</span><span class="p">,</span> <span class="mf">4.00d0</span><span class="p">,</span> <span class="mf">3.100d0</span><span class="p">,</span> <span class="mf">3.33d0</span> <span class="o">/</span><span class="p">)</span>
<a name="ln-4125"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="kd">::</span> <span class="n">F</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">0.028d0</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.057d0</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.036d0</span> <span class="o">/</span><span class="p">)</span>
<a name="ln-4126"></a>
<a name="ln-4127"></a>
<a name="ln-4128"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-4129"></a>          <span class="c">! na</span>
<a name="ln-4130"></a>
<a name="ln-4131"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-4132"></a>          <span class="c">! na</span>
<a name="ln-4133"></a>
<a name="ln-4134"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4135"></a>          <span class="c">! na</span>
<a name="ln-4136"></a>
<a name="ln-4137"></a>          <span class="c">! FLOW:</span>
<a name="ln-4138"></a>  <span class="n">CalcASHRAESimpExtConvectCoeff</span> <span class="o">=</span>  <span class="n">D</span><span class="p">(</span><span class="n">Roughness</span><span class="p">)</span> <span class="o">+</span> <span class="n">E</span><span class="p">(</span><span class="n">Roughness</span><span class="p">)</span><span class="o">*</span><span class="n">SurfWindSpeed</span> <span class="p">&amp;</span>
<a name="ln-4139"></a>                                                <span class="o">+</span> <span class="n">F</span><span class="p">(</span><span class="n">Roughness</span><span class="p">)</span><span class="o">*</span><span class="n">SurfWindSpeed</span><span class="o">**</span><span class="mi">2</span>
<a name="ln-4140"></a>
<a name="ln-4141"></a>  <span class="k">RETURN</span>
<a name="ln-4142"></a>
<a name="ln-4143"></a><span class="k">END FUNCTION </span><span class="n">CalcASHRAESimpExtConvectCoeff</span>
<a name="ln-4144"></a>
<a name="ln-4145"></a>
<a name="ln-4146"></a><span class="k">SUBROUTINE </span><span class="n">CalcASHRAESimpleIntConvCoeff</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">SurfaceTemperature</span><span class="p">,</span><span class="n">ZoneMeanAirTemperature</span><span class="p">)</span>
<a name="ln-4147"></a>
<a name="ln-4148"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4149"></a>          <span class="c">!       AUTHOR         Rick Strand</span>
<a name="ln-4150"></a>          <span class="c">!       DATE WRITTEN   August 2000</span>
<a name="ln-4151"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4152"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4153"></a>
<a name="ln-4154"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-4155"></a>          <span class="c">! This subroutine calculates the interior convection coefficient for a surface.</span>
<a name="ln-4156"></a>
<a name="ln-4157"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4158"></a>          <span class="c">! The convection coefficients are taken directly from the TARP Reference Manual.  TARP calculated</span>
<a name="ln-4159"></a>          <span class="c">! its coefficients using the surface conductances for e=0.9 found in ASHRAE Handbook of Fundamentals</span>
<a name="ln-4160"></a>          <span class="c">! 1985 in Table 1 on p. 23.2, but subtracted off the radiative component which was estimated at</span>
<a name="ln-4161"></a>          <span class="c">! 1.02 * 0.9 = 0.918 BTU/h-ft2-F.  Coefficients were then converted to SI units to yield the values</span>
<a name="ln-4162"></a>          <span class="c">! in this subroutine.</span>
<a name="ln-4163"></a>
<a name="ln-4164"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4165"></a>          <span class="c">! 1.  Walton, G. N. 1983. Thermal Analysis Research Program (TARP) Reference Manual,</span>
<a name="ln-4166"></a>          <span class="c">!     NBSSIR 83-2655, National Bureau of Standards, &quot;Surface Inside Heat Balances&quot;, pp 79.</span>
<a name="ln-4167"></a>          <span class="c">! 2.  ASHRAE Handbook of Fundamentals 1985, p. 23.2, Table 1.</span>
<a name="ln-4168"></a>
<a name="ln-4169"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4170"></a>          <span class="c">! na</span>
<a name="ln-4171"></a>
<a name="ln-4172"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4173"></a>
<a name="ln-4174"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4175"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">SurfNum</span> <span class="c">! surface number for which coefficients are being calculated</span>
<a name="ln-4176"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">SurfaceTemperature</span> <span class="c">! Temperature of surface for evaluation of HcIn</span>
<a name="ln-4177"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">ZoneMeanAirTemperature</span>  <span class="c">! Mean Air Temperature of Zone</span>
<a name="ln-4178"></a>
<a name="ln-4179"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4180"></a>          <span class="c">! na</span>
<a name="ln-4181"></a>
<a name="ln-4182"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-4183"></a>          <span class="c">! na</span>
<a name="ln-4184"></a>
<a name="ln-4185"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-4186"></a>          <span class="c">! na</span>
<a name="ln-4187"></a>
<a name="ln-4188"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4189"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DeltaTemp</span>          <span class="c">! Temperature difference between the zone air and the surface</span>
<a name="ln-4190"></a>
<a name="ln-4191"></a>
<a name="ln-4192"></a>  <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mf">0.3827d0</span><span class="p">)</span> <span class="k">THEN</span>   <span class="c">! Recalculate HConvIn</span>
<a name="ln-4193"></a>
<a name="ln-4194"></a>    <span class="n">DeltaTemp</span> <span class="o">=</span> <span class="n">ZoneMeanAirTemperature</span> <span class="o">-</span> <span class="n">SurfaceTemperature</span>
<a name="ln-4195"></a>
<a name="ln-4196"></a>    <span class="c">! Set HConvIn using the proper correlation based on DeltaTemp and Cosine of the Tilt of the Surface</span>
<a name="ln-4197"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mf">0.9239d0</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Horizontal Surface</span>
<a name="ln-4198"></a>
<a name="ln-4199"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaTemp</span><span class="o">*</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Horizontal, Reduced Convection</span>
<a name="ln-4200"></a>
<a name="ln-4201"></a>        <span class="n">HConvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.948d0</span>
<a name="ln-4202"></a>
<a name="ln-4203"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DeltaTemp</span><span class="o">*</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Vertical Surface</span>
<a name="ln-4204"></a>
<a name="ln-4205"></a>        <span class="n">HConvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="mf">3.076d0</span>
<a name="ln-4206"></a>
<a name="ln-4207"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DeltaTemp</span><span class="o">*</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Horizontal, Enhanced Convection</span>
<a name="ln-4208"></a>
<a name="ln-4209"></a>        <span class="n">HConvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="mf">4.040d0</span>
<a name="ln-4210"></a>
<a name="ln-4211"></a>      <span class="k">END IF</span>
<a name="ln-4212"></a>
<a name="ln-4213"></a><span class="k">    ELSE</span>  <span class="c">! Tilted Surface</span>
<a name="ln-4214"></a>
<a name="ln-4215"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaTemp</span><span class="o">*</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Tilted, Reduced Convection</span>
<a name="ln-4216"></a>
<a name="ln-4217"></a>        <span class="n">HConvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="mf">2.281d0</span>
<a name="ln-4218"></a>
<a name="ln-4219"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DeltaTemp</span><span class="o">*</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Vertical Surface</span>
<a name="ln-4220"></a>
<a name="ln-4221"></a>        <span class="n">HConvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="mf">3.076d0</span>
<a name="ln-4222"></a>
<a name="ln-4223"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DeltaTemp</span><span class="o">*</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Tilted, Enhanced Convection</span>
<a name="ln-4224"></a>
<a name="ln-4225"></a>        <span class="n">HConvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="mf">3.870d0</span>
<a name="ln-4226"></a>
<a name="ln-4227"></a>      <span class="k">END IF</span>
<a name="ln-4228"></a>
<a name="ln-4229"></a><span class="k">    END IF</span>    <span class="c">! ...end of correlation selection IF-THEN block</span>
<a name="ln-4230"></a>
<a name="ln-4231"></a>  <span class="k">END IF</span>  <span class="c">! ...end of HConvIn recalculation IF-THEN block</span>
<a name="ln-4232"></a>
<a name="ln-4233"></a>  <span class="c">! Establish some lower limit to avoid a zero convection coefficient (and potential divide by zero problems)</span>
<a name="ln-4234"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">HConvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">LowHConvLimit</span><span class="p">)</span> <span class="n">HConvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">LowHConvLimit</span>
<a name="ln-4235"></a>
<a name="ln-4236"></a>  <span class="k">RETURN</span>
<a name="ln-4237"></a>
<a name="ln-4238"></a><span class="k">END SUBROUTINE </span><span class="n">CalcASHRAESimpleIntConvCoeff</span>
<a name="ln-4239"></a>
<a name="ln-4240"></a>
<a name="ln-4241"></a><span class="k">SUBROUTINE </span><span class="n">CalcASHRAEDetailedIntConvCoeff</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">SurfaceTemperature</span><span class="p">,</span><span class="n">ZoneMeanAirTemperature</span><span class="p">)</span>
<a name="ln-4242"></a>
<a name="ln-4243"></a>            <span class="c">!SUBROUTINE INFORMATION:</span>
<a name="ln-4244"></a>          <span class="c">!       AUTHOR         Rick Strand</span>
<a name="ln-4245"></a>          <span class="c">!       DATE WRITTEN   August 2000</span>
<a name="ln-4246"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4247"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4248"></a>
<a name="ln-4249"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-4250"></a>          <span class="c">! This subroutine calculates the interior convection coefficient for a surface.</span>
<a name="ln-4251"></a>
<a name="ln-4252"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4253"></a>          <span class="c">! The algorithm for convection coefficients is taken directly from the TARP Reference Manual.</span>
<a name="ln-4254"></a>          <span class="c">! ASHRAE Handbook of Fundamentals 2001, p. 3.12, Table 5 gives equations for natural convection</span>
<a name="ln-4255"></a>          <span class="c">! heat transfer coefficients in the turbulent range for large, vertical plates and for large,</span>
<a name="ln-4256"></a>          <span class="c">! horizontal plates facing upward when heated (or downward when cooled).  A note in the text</span>
<a name="ln-4257"></a>          <span class="c">! also gives an approximation for large, horizontal places facing downward when heated (or</span>
<a name="ln-4258"></a>          <span class="c">! upward when cooled) recommending that it should be half of the facing upward value.</span>
<a name="ln-4259"></a>          <span class="c">! TARP then adds a curve fit as a function of the cosine of the tilt angle to provide intermediate</span>
<a name="ln-4260"></a>          <span class="c">! values between vertical and horizontal.  The curve fit values at the extremes match the ASHRAE</span>
<a name="ln-4261"></a>          <span class="c">! values very well.</span>
<a name="ln-4262"></a>
<a name="ln-4263"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4264"></a>          <span class="c">! 1.  Walton, G. N. 1983. Thermal Analysis Research Program (TARP) Reference Manual,</span>
<a name="ln-4265"></a>          <span class="c">!     NBSSIR 83-2655, National Bureau of Standards, &quot;Surface Inside Heat Balances&quot;, pp 79-80.</span>
<a name="ln-4266"></a>          <span class="c">! 2.  ASHRAE Handbook of Fundamentals 2001, p. 3.12, Table 5.</span>
<a name="ln-4267"></a>
<a name="ln-4268"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4269"></a>          <span class="c">! na</span>
<a name="ln-4270"></a>
<a name="ln-4271"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4272"></a>
<a name="ln-4273"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4274"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">SurfNum</span> <span class="c">! surface number for which coefficients are being calculated</span>
<a name="ln-4275"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">SurfaceTemperature</span> <span class="c">! Temperature of surface for evaluation of HcIn</span>
<a name="ln-4276"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">ZoneMeanAirTemperature</span>  <span class="c">! Mean Air Temperature of Zone</span>
<a name="ln-4277"></a>
<a name="ln-4278"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4279"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">OneThird</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">/</span><span class="mf">3.d0</span><span class="p">)</span>  <span class="c">! 1/3 in highest precision</span>
<a name="ln-4280"></a>
<a name="ln-4281"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-4282"></a>          <span class="c">! na</span>
<a name="ln-4283"></a>
<a name="ln-4284"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-4285"></a>          <span class="c">! na</span>
<a name="ln-4286"></a>
<a name="ln-4287"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4288"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DeltaTemp</span>          <span class="c">! Temperature difference between the zone air and the surface</span>
<a name="ln-4289"></a>
<a name="ln-4290"></a>          <span class="c">! FLOW:</span>
<a name="ln-4291"></a>
<a name="ln-4292"></a>  <span class="n">DeltaTemp</span> <span class="o">=</span> <span class="n">SurfaceTemperature</span> <span class="o">-</span> <span class="n">ZoneMeanAirTemperature</span>
<a name="ln-4293"></a>
<a name="ln-4294"></a>    <span class="c">! Set HConvIn using the proper correlation based on DeltaTemp and Surface (Cosine Tilt)</span>
<a name="ln-4295"></a>
<a name="ln-4296"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">DeltaTemp</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="k">THEN</span>   <span class="c">! Vertical Surface</span>
<a name="ln-4297"></a>
<a name="ln-4298"></a>    <span class="n">HConvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">CalcASHRAEVerticalWall</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">)</span>
<a name="ln-4299"></a>
<a name="ln-4300"></a>  <span class="n">ELSEIF</span> <span class="p">(</span> <span class="p">((</span><span class="n">DeltaTemp</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4301"></a>           <span class="p">((</span><span class="n">DeltaTemp</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Enhanced Convection</span>
<a name="ln-4302"></a>
<a name="ln-4303"></a>    <span class="n">HConvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">CalcWaltonUnstableHorizontalOrTilt</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">,</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="p">)</span>
<a name="ln-4304"></a>
<a name="ln-4305"></a>  <span class="n">ELSEIF</span> <span class="p">(</span> <span class="p">((</span><span class="n">DeltaTemp</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4306"></a>           <span class="p">((</span><span class="n">DeltaTemp</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Reduced Convection</span>
<a name="ln-4307"></a>
<a name="ln-4308"></a>    <span class="n">HConvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">CalcWaltonStableHorizontalOrTilt</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">,</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="p">)</span>
<a name="ln-4309"></a>
<a name="ln-4310"></a>  <span class="k">END IF</span>  <span class="c">! ...end of IF-THEN block to set HConvIn</span>
<a name="ln-4311"></a>
<a name="ln-4312"></a>  <span class="c">! Establish some lower limit to avoid a zero convection coefficient (and potential divide by zero problems)</span>
<a name="ln-4313"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">HConvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">LowHConvLimit</span><span class="p">)</span> <span class="n">HConvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">LowHConvLimit</span>
<a name="ln-4314"></a>
<a name="ln-4315"></a>  <span class="k">RETURN</span>
<a name="ln-4316"></a>
<a name="ln-4317"></a><span class="k">END SUBROUTINE </span><span class="n">CalcASHRAEDetailedIntConvCoeff</span>
<a name="ln-4318"></a>
<a name="ln-4319"></a>
<a name="ln-4320"></a><span class="k">SUBROUTINE </span><span class="n">CalcDetailedHcInForDVModel</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">SurfaceTemperatures</span><span class="p">,</span><span class="n">HcIn</span><span class="p">,</span><span class="n">Vhc</span><span class="p">)</span>
<a name="ln-4321"></a>
<a name="ln-4322"></a>            <span class="c">!SUBROUTINE INFORMATION:</span>
<a name="ln-4323"></a>          <span class="c">!       AUTHOR         Rick Strand</span>
<a name="ln-4324"></a>          <span class="c">!       DATE WRITTEN   August 2000</span>
<a name="ln-4325"></a>          <span class="c">!       MODIFIED       Used for DV model; Feb 2004, LKL</span>
<a name="ln-4326"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4327"></a>
<a name="ln-4328"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-4329"></a>          <span class="c">! This subroutine calculates the interior convection coefficient for a surface.</span>
<a name="ln-4330"></a>
<a name="ln-4331"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4332"></a>          <span class="c">! na</span>
<a name="ln-4333"></a>
<a name="ln-4334"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4335"></a>          <span class="c">! na</span>
<a name="ln-4336"></a>
<a name="ln-4337"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4338"></a>  <span class="k">USE </span><span class="n">DataHeatBalFanSys</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">MAT</span>
<a name="ln-4339"></a>  <span class="k">USE </span><span class="n">DataRoomAirModel</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">AirModel</span><span class="p">,</span> <span class="n">RoomAirModel_UCSDDV</span><span class="p">,</span> <span class="n">RoomAirModel_UCSDCV</span><span class="p">,</span> <span class="n">RoomAirModel_UCSDUFI</span><span class="p">,</span> <span class="n">RoomAirModel_UCSDUFE</span>
<a name="ln-4340"></a>
<a name="ln-4341"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4342"></a>
<a name="ln-4343"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4344"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">SurfNum</span> <span class="c">! surface number for which coefficients are being calculated</span>
<a name="ln-4345"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfaceTemperatures</span> <span class="c">! Temperature of surfaces for evaluation of HcIn</span>
<a name="ln-4346"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">HcIn</span> <span class="c">! Interior Convection Coeff Array</span>
<a name="ln-4347"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">OPTIONAL</span>   <span class="kd">::</span> <span class="n">Vhc</span> <span class="c">!Velocity array for forced convection coeff calculation</span>
<a name="ln-4348"></a>
<a name="ln-4349"></a>
<a name="ln-4350"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4351"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">OneThird</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">/</span><span class="mf">3.d0</span><span class="p">)</span>  <span class="c">! 1/3 in highest precision</span>
<a name="ln-4352"></a>
<a name="ln-4353"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-4354"></a>          <span class="c">! na</span>
<a name="ln-4355"></a>
<a name="ln-4356"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-4357"></a>          <span class="c">! na</span>
<a name="ln-4358"></a>
<a name="ln-4359"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4360"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DeltaTemp</span>          <span class="c">! Temperature difference between the zone air and the surface</span>
<a name="ln-4361"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TAirConv</span>
<a name="ln-4362"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Hf</span>
<a name="ln-4363"></a>
<a name="ln-4364"></a>          <span class="c">! FLOW:</span>
<a name="ln-4365"></a>
<a name="ln-4366"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Only treat heat transfer surfaces</span>
<a name="ln-4367"></a>
<a name="ln-4368"></a><span class="c">! UCSD</span>
<a name="ln-4369"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TAirRef</span><span class="p">)</span>
<a name="ln-4370"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">AdjacentAirTemp</span><span class="p">)</span>
<a name="ln-4371"></a>        <span class="n">TAirConv</span> <span class="o">=</span> <span class="n">TempEffBulkAir</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-4372"></a>      <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-4373"></a>        <span class="c">! currently set to mean air temp but should add error warning here</span>
<a name="ln-4374"></a>        <span class="n">TAirConv</span> <span class="o">=</span> <span class="n">MAT</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)</span>
<a name="ln-4375"></a>    <span class="k">END SELECT</span>
<a name="ln-4376"></a><span class="k">    </span><span class="n">DeltaTemp</span> <span class="o">=</span> <span class="n">SurfaceTemperatures</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">-</span> <span class="n">TAirConv</span>
<a name="ln-4377"></a>
<a name="ln-4378"></a>
<a name="ln-4379"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">AirModel</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)%</span><span class="n">AirModelType</span> <span class="o">==</span> <span class="n">RoomAirModel_UCSDDV</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4380"></a>        <span class="n">AirModel</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)%</span><span class="n">AirModelType</span> <span class="o">==</span> <span class="n">RoomAirModel_UCSDUFI</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4381"></a>        <span class="n">AirModel</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)%</span><span class="n">AirModelType</span> <span class="o">==</span> <span class="n">RoomAirModel_UCSDUFE</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4382"></a>
<a name="ln-4383"></a>      <span class="c">! Set HConvIn using the proper correlation based on DeltaTemp and CosTiltSurf</span>
<a name="ln-4384"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvCoeff</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4385"></a>
<a name="ln-4386"></a><span class="k">        </span><span class="n">HcIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span><span class="o">=</span><span class="n">SetIntConvectionCoeff</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-4387"></a>
<a name="ln-4388"></a>      <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">DeltaTemp</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="n">CosTilt</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="k">THEN</span>   <span class="c">! Vertical Surface</span>
<a name="ln-4389"></a>
<a name="ln-4390"></a>        <span class="n">HcIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.31d0</span><span class="o">*</span><span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">))</span><span class="o">**</span><span class="n">OneThird</span><span class="p">)</span>
<a name="ln-4391"></a>
<a name="ln-4392"></a>      <span class="n">ELSEIF</span> <span class="p">(</span> <span class="p">((</span><span class="n">DeltaTemp</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4393"></a>             <span class="p">((</span><span class="n">DeltaTemp</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Enhanced Convection</span>
<a name="ln-4394"></a>
<a name="ln-4395"></a>        <span class="n">HcIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="mf">9.482d0</span><span class="o">*</span><span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">))</span><span class="o">**</span><span class="n">OneThird</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4396"></a>                                <span class="o">/</span><span class="p">(</span><span class="mf">7.283d0</span> <span class="o">-</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="p">))</span>
<a name="ln-4397"></a>
<a name="ln-4398"></a>      <span class="n">ELSEIF</span> <span class="p">(</span> <span class="p">((</span><span class="n">DeltaTemp</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4399"></a>             <span class="p">((</span><span class="n">DeltaTemp</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Reduced Convection</span>
<a name="ln-4400"></a>
<a name="ln-4401"></a>        <span class="n">HcIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.810d0</span><span class="o">*</span><span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">))</span><span class="o">**</span><span class="n">OneThird</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4402"></a>                                <span class="o">/</span><span class="p">(</span><span class="mf">1.382d0</span> <span class="o">+</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="p">))</span>
<a name="ln-4403"></a>
<a name="ln-4404"></a>      <span class="k">END IF</span>  <span class="c">! ...end of IF-THEN block to set HConvIn</span>
<a name="ln-4405"></a>
<a name="ln-4406"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">AirModel</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)%</span><span class="n">AirModelType</span> <span class="o">==</span> <span class="n">RoomAirModel_UCSDCV</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4407"></a>
<a name="ln-4408"></a><span class="k">      </span><span class="n">Hf</span><span class="o">=</span><span class="mf">4.3d0</span><span class="o">*</span><span class="n">Vhc</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)</span>
<a name="ln-4409"></a>
<a name="ln-4410"></a>      <span class="c">! Set HConvIn using the proper correlation based on DeltaTemp and CosTiltSurf</span>
<a name="ln-4411"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvCoeff</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4412"></a>
<a name="ln-4413"></a><span class="k">        </span><span class="n">HcIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span><span class="o">=</span><span class="n">SetIntConvectionCoeff</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-4414"></a>
<a name="ln-4415"></a>
<a name="ln-4416"></a>      <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">DeltaTemp</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="k">THEN</span>   <span class="c">! Vertical Surface</span>
<a name="ln-4417"></a>
<a name="ln-4418"></a>        <span class="n">HcIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.31d0</span><span class="o">*</span><span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">))</span><span class="o">**</span><span class="n">OneThird</span><span class="p">)</span>
<a name="ln-4419"></a>
<a name="ln-4420"></a>        <span class="n">HcIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span><span class="o">=</span> <span class="p">(</span><span class="n">HcIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span><span class="o">**</span><span class="mf">3.2d0</span><span class="o">+</span><span class="n">Hf</span><span class="o">**</span><span class="mf">3.2d0</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">/</span><span class="mf">3.2d0</span><span class="p">)</span>
<a name="ln-4421"></a>
<a name="ln-4422"></a>
<a name="ln-4423"></a>      <span class="n">ELSEIF</span> <span class="p">(</span> <span class="p">((</span><span class="n">DeltaTemp</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4424"></a>             <span class="p">((</span><span class="n">DeltaTemp</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Enhanced Convection</span>
<a name="ln-4425"></a>
<a name="ln-4426"></a>        <span class="n">HcIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="mf">9.482d0</span><span class="o">*</span><span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">/</span><span class="mf">3.d0</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-4427"></a>                                <span class="o">/</span><span class="p">(</span><span class="mf">7.283</span> <span class="o">-</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="p">))</span>
<a name="ln-4428"></a>        <span class="n">HcIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span><span class="o">=</span> <span class="p">(</span><span class="n">HcIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span><span class="o">**</span><span class="mf">3.2d0</span><span class="o">+</span><span class="n">Hf</span><span class="o">**</span><span class="mf">3.2d0</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">/</span><span class="mf">3.2d0</span><span class="p">)</span>
<a name="ln-4429"></a>
<a name="ln-4430"></a>
<a name="ln-4431"></a>      <span class="n">ELSEIF</span> <span class="p">(</span> <span class="p">((</span><span class="n">DeltaTemp</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4432"></a>             <span class="p">((</span><span class="n">DeltaTemp</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Reduced Convection</span>
<a name="ln-4433"></a>
<a name="ln-4434"></a>        <span class="n">HcIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.810d0</span><span class="o">*</span><span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">))</span><span class="o">**</span><span class="n">OneThird</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4435"></a>                                <span class="o">/</span><span class="p">(</span><span class="mf">1.382d0</span> <span class="o">+</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="p">))</span>
<a name="ln-4436"></a>        <span class="n">HcIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span><span class="o">=</span> <span class="p">(</span><span class="n">HcIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span><span class="o">**</span><span class="mf">3.2d0</span><span class="o">+</span><span class="n">Hf</span><span class="o">**</span><span class="mf">3.2d0</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">/</span><span class="mf">3.2d0</span><span class="p">)</span>
<a name="ln-4437"></a>
<a name="ln-4438"></a>
<a name="ln-4439"></a>      <span class="k">END IF</span>  <span class="c">! ...end of IF-THEN block to set HConvIn</span>
<a name="ln-4440"></a>
<a name="ln-4441"></a>
<a name="ln-4442"></a>    <span class="k">END IF</span>
<a name="ln-4443"></a>
<a name="ln-4444"></a><span class="k">  END IF</span>
<a name="ln-4445"></a>
<a name="ln-4446"></a>  <span class="c">! Establish some lower limit to avoid a zero convection coefficient (and potential divide by zero problems)</span>
<a name="ln-4447"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">HcIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">LowHConvLimit</span><span class="p">)</span> <span class="n">HcIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">LowHConvLimit</span>
<a name="ln-4448"></a>
<a name="ln-4449"></a>
<a name="ln-4450"></a>  <span class="k">RETURN</span>
<a name="ln-4451"></a>
<a name="ln-4452"></a>
<a name="ln-4453"></a><span class="k">END SUBROUTINE </span><span class="n">CalcDetailedHcInForDVModel</span>
<a name="ln-4454"></a>
<a name="ln-4455"></a><span class="k">SUBROUTINE </span><span class="n">CalcCeilingDiffuserIntConvCoeff</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span>
<a name="ln-4456"></a>
<a name="ln-4457"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4458"></a>          <span class="c">!       AUTHOR         Rick Strand</span>
<a name="ln-4459"></a>          <span class="c">!       DATE WRITTEN   August 2000</span>
<a name="ln-4460"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4461"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4462"></a>
<a name="ln-4463"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-4464"></a>          <span class="c">! This subroutine calculates the interior convection coefficients</span>
<a name="ln-4465"></a>          <span class="c">! for ceiling diffusers correlated to the outlet air temperature.</span>
<a name="ln-4466"></a>
<a name="ln-4467"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4468"></a>          <span class="c">! call functions with the actual model equations</span>
<a name="ln-4469"></a>
<a name="ln-4470"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4471"></a>          <span class="c">! Fisher, D.E. and C.O. Pedersen, Convective Heat Transfer in Building Energy and</span>
<a name="ln-4472"></a>          <span class="c">!       Thermal Load Calculations, ASHRAE Transactions, vol. 103, Pt. 2, 1997, p.137</span>
<a name="ln-4473"></a>
<a name="ln-4474"></a>          <span class="c">! OTHER NOTES:</span>
<a name="ln-4475"></a>          <span class="c">! The correlations shown below differ from (and are less accurate than) those shown</span>
<a name="ln-4476"></a>          <span class="c">! in the reference above (Fisher 1997).  They have been reformulated with an outlet</span>
<a name="ln-4477"></a>          <span class="c">! temperature reference in order to accomodate the structure of the EnergyPlus code.</span>
<a name="ln-4478"></a>
<a name="ln-4479"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4480"></a>  <span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">OutBaroPress</span>
<a name="ln-4481"></a>  <span class="k">USE </span><span class="n">Psychrometrics</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">,</span> <span class="n">PsyWFnTdpPb</span>
<a name="ln-4482"></a>
<a name="ln-4483"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4484"></a>
<a name="ln-4485"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4486"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ZoneNum</span> <span class="c">! zone number for which coefficients are being calculated</span>
<a name="ln-4487"></a>
<a name="ln-4488"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4489"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SurfNum</span>            <span class="c">! DO loop counter for surfaces</span>
<a name="ln-4490"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ACH</span>                <span class="c">! Air changes per hour</span>
<a name="ln-4491"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ZoneNode</span>           <span class="c">! Zone node as defined in system simulation</span>
<a name="ln-4492"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ZoneVolume</span>         <span class="c">! Zone node as defined in system simulation</span>
<a name="ln-4493"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ZoneMassFlowRate</span>   <span class="c">! Zone node as defined in system simulation</span>
<a name="ln-4494"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">AirDensity</span>         <span class="c">! zone air density</span>
<a name="ln-4495"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ZoneMult</span>
<a name="ln-4496"></a>
<a name="ln-4497"></a>          <span class="c">! FLOW:</span>
<a name="ln-4498"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SysSizingCalc</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ZoneSizingCalc</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">Node</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4499"></a><span class="k">    </span><span class="n">ACH</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4500"></a>  <span class="k">ELSE</span>
<a name="ln-4501"></a>    <span class="c">! Set local variables</span>
<a name="ln-4502"></a>    <span class="n">ZoneVolume</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Volume</span>
<a name="ln-4503"></a>    <span class="n">ZoneNode</span>  <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SystemZoneNodeNumber</span>
<a name="ln-4504"></a>    <span class="n">ZoneMult</span>  <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Multiplier</span> <span class="o">*</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ListMultiplier</span>
<a name="ln-4505"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">BeginEnvrnFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4506"></a><span class="k">      </span><span class="n">AirDensity</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">PsyWFnTdpPb</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">))</span>
<a name="ln-4507"></a>      <span class="n">ZoneMassFlowRate</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">/</span> <span class="n">ZoneMult</span>
<a name="ln-4508"></a>    <span class="k">ELSE</span>  <span class="c">! because these are not updated yet for new environment</span>
<a name="ln-4509"></a>      <span class="n">AirDensity</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">PsyWFnTdpPb</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">))</span>
<a name="ln-4510"></a>      <span class="n">ZoneMassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4511"></a>    <span class="n">ENDIF</span>
<a name="ln-4512"></a>
<a name="ln-4513"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneMassFlowRate</span> <span class="o">&lt;</span> <span class="n">MinFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4514"></a><span class="k">      </span><span class="n">ACH</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4515"></a>    <span class="k">ELSE</span>
<a name="ln-4516"></a>      <span class="c">! Calculate ACH</span>
<a name="ln-4517"></a>      <span class="n">ACH</span> <span class="o">=</span> <span class="n">ZoneMassFlowRate</span><span class="o">/</span><span class="n">AirDensity</span><span class="o">/</span><span class="n">ZoneVolume</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-4518"></a>      <span class="c">! Limit ACH to range of correlation</span>
<a name="ln-4519"></a>      <span class="n">ACH</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">ACH</span><span class="p">,</span> <span class="n">MaxACH</span><span class="p">)</span>
<a name="ln-4520"></a>      <span class="n">ACH</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">ACH</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-4521"></a>    <span class="k">END IF</span>
<a name="ln-4522"></a><span class="k">  END IF</span>
<a name="ln-4523"></a>
<a name="ln-4524"></a>  <span class="c">! If the Ceiling Diffuser option is selected the following correlations are used.</span>
<a name="ln-4525"></a>  <span class="c">! The development of the ceiling diffuser convection correlations is shown in reference 4.</span>
<a name="ln-4526"></a>  <span class="c">! The correlations shown below differ from (and are less accurate than) those shown in reference 4 because they have been</span>
<a name="ln-4527"></a>  <span class="c">! reformulated with an outlet temperature reference in order to accomodate the structure of the</span>
<a name="ln-4528"></a>  <span class="c">! EnergyPlus code.</span>
<a name="ln-4529"></a>  <span class="k">DO </span><span class="n">SurfNum</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-4530"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>  <span class="c">! Skip non-heat transfer surfaces</span>
<a name="ln-4531"></a>
<a name="ln-4532"></a>    <span class="c">! Set HConvIn using the proper correlation based on Surface Tilt</span>
<a name="ln-4533"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&gt;</span> <span class="mi">13</span><span class="mf">5.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4534"></a><span class="k">      </span><span class="n">HConvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">CalcFisherPedersenCeilDiffuserFloor</span><span class="p">(</span><span class="n">ACH</span><span class="p">)</span> <span class="c">! Floor correlation</span>
<a name="ln-4535"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="mf">5.0d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4536"></a><span class="k">      </span><span class="n">HConvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span><span class="n">CalcFisherPedersenCeilDiffuserCeiling</span><span class="p">(</span><span class="n">ACH</span><span class="p">)</span> <span class="c">! Ceiling correlation</span>
<a name="ln-4537"></a>    <span class="k">ELSE</span>
<a name="ln-4538"></a><span class="k">      </span><span class="n">HConvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">CalcFisherPedersenCeilDiffuserWalls</span><span class="p">(</span><span class="n">ACH</span><span class="p">)</span> <span class="c">! Wall correlation</span>
<a name="ln-4539"></a>    <span class="k">END IF</span>
<a name="ln-4540"></a>    <span class="c">! Establish some lower limit to avoid a zero convection coefficient (and potential divide by zero problems)</span>
<a name="ln-4541"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">HConvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">LowHConvLimit</span><span class="p">)</span> <span class="n">HConvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">LowHConvLimit</span>
<a name="ln-4542"></a>
<a name="ln-4543"></a>  <span class="k">END DO</span> <span class="c">! SurfNum</span>
<a name="ln-4544"></a>
<a name="ln-4545"></a>  <span class="k">RETURN</span>
<a name="ln-4546"></a>
<a name="ln-4547"></a><span class="k">END SUBROUTINE </span><span class="n">CalcCeilingDiffuserIntConvCoeff</span>
<a name="ln-4548"></a>
<a name="ln-4549"></a>
<a name="ln-4550"></a><span class="c">! CalcCeilingDiffuserInletCorr should replace CalcCeilingDiffuser (above), if ZoneTempPredictorCorrector can</span>
<a name="ln-4551"></a><span class="c">! ever be made to work correctly with the inlet air temperature.</span>
<a name="ln-4552"></a>
<a name="ln-4553"></a><span class="k">SUBROUTINE </span><span class="n">CalcCeilingDiffuserInletCorr</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">,</span> <span class="n">SurfaceTemperatures</span><span class="p">)</span>
<a name="ln-4554"></a>
<a name="ln-4555"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4556"></a>          <span class="c">!       AUTHOR         Rick Strand</span>
<a name="ln-4557"></a>          <span class="c">!       DATE WRITTEN   August 2000</span>
<a name="ln-4558"></a>          <span class="c">!       RE-ENGINEERED  July 2003 (Peter Graham Ellis)</span>
<a name="ln-4559"></a>          <span class="c">!       MODIFIED       July 2003, (CC) set a flag for reference temperature so that supply air temperature</span>
<a name="ln-4560"></a>          <span class="c">!                                      is used as the reference in the inside heat balance calculations</span>
<a name="ln-4561"></a>
<a name="ln-4562"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-4563"></a>          <span class="c">! This subroutine calculates the interior convection coefficients</span>
<a name="ln-4564"></a>          <span class="c">! for ceiling diffusers correlated to the inlet air temperature.</span>
<a name="ln-4565"></a>
<a name="ln-4566"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4567"></a>          <span class="c">! na</span>
<a name="ln-4568"></a>
<a name="ln-4569"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4570"></a>          <span class="c">! Fisher, D.E. and C.O. Pedersen, Convective Heat Transfer in Building Energy and</span>
<a name="ln-4571"></a>          <span class="c">!   Thermal Load Calculations, ASHRAE Transactions, vol. 103, Pt. 2, 1997, p.137</span>
<a name="ln-4572"></a>
<a name="ln-4573"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4574"></a>  <span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">OutBaroPress</span>
<a name="ln-4575"></a>  <span class="k">USE </span><span class="n">Psychrometrics</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">,</span> <span class="n">PsyWFnTdpPb</span>
<a name="ln-4576"></a>  <span class="k">USE </span><span class="n">DataHeatBalFanSys</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">MAT</span>
<a name="ln-4577"></a>
<a name="ln-4578"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4579"></a>
<a name="ln-4580"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4581"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">ZoneNum</span>             <span class="c">! Zone number</span>
<a name="ln-4582"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfaceTemperatures</span> <span class="c">! For CalcASHRAEDetailed, if called</span>
<a name="ln-4583"></a>
<a name="ln-4584"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4585"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ACH</span>              <span class="c">! Air changes per hour</span>
<a name="ln-4586"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ZoneNode</span>         <span class="c">! Zone node as defined in system simulation</span>
<a name="ln-4587"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ZoneVolume</span>       <span class="c">! Zone node as defined in system simulation</span>
<a name="ln-4588"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ZoneMassFlowRate</span> <span class="c">! Zone node as defined in system simulation</span>
<a name="ln-4589"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">AirDensity</span>       <span class="c">! zone air density</span>
<a name="ln-4590"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SurfNum</span>          <span class="c">! DO loop counter for surfaces</span>
<a name="ln-4591"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Tilt</span>             <span class="c">! Surface tilt</span>
<a name="ln-4592"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ZoneMult</span>
<a name="ln-4593"></a>
<a name="ln-4594"></a>          <span class="c">! FLOW:</span>
<a name="ln-4595"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SysSizingCalc</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ZoneSizingCalc</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">Node</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4596"></a><span class="k">    </span><span class="n">ACH</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4597"></a>  <span class="k">ELSE</span>
<a name="ln-4598"></a>    <span class="c">! Set local variables</span>
<a name="ln-4599"></a>    <span class="n">ZoneVolume</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Volume</span>
<a name="ln-4600"></a>    <span class="n">ZoneNode</span>  <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SystemZoneNodeNumber</span>
<a name="ln-4601"></a>    <span class="n">ZoneMult</span>  <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Multiplier</span> <span class="o">*</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ListMultiplier</span>
<a name="ln-4602"></a>    <span class="n">AirDensity</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutBaroPress</span><span class="p">,</span> <span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span> <span class="n">PsyWFnTdpPb</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span> <span class="n">OutBaroPress</span><span class="p">))</span>
<a name="ln-4603"></a>    <span class="n">ZoneMassFlowRate</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">MassFlowRate</span><span class="o">/</span><span class="n">ZoneMult</span>
<a name="ln-4604"></a>
<a name="ln-4605"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneMassFlowRate</span> <span class="o">&lt;</span> <span class="n">MinFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4606"></a><span class="k">      </span><span class="n">ACH</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4607"></a>    <span class="k">ELSE</span>
<a name="ln-4608"></a>      <span class="c">! Calculate ACH</span>
<a name="ln-4609"></a>      <span class="n">ACH</span> <span class="o">=</span> <span class="n">ZoneMassFlowRate</span> <span class="o">/</span> <span class="n">AirDensity</span> <span class="o">/</span> <span class="n">ZoneVolume</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-4610"></a>      <span class="c">! Limit ACH to range of correlation</span>
<a name="ln-4611"></a>      <span class="n">ACH</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">ACH</span><span class="p">,</span> <span class="n">MaxACH</span><span class="p">)</span>
<a name="ln-4612"></a>      <span class="n">ACH</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">ACH</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-4613"></a>    <span class="k">END IF</span>
<a name="ln-4614"></a><span class="k">  END IF</span>
<a name="ln-4615"></a>
<a name="ln-4616"></a><span class="k">    DO </span><span class="n">SurfNum</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-4617"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span> <span class="c">! Skip non-heat transfer surfaces</span>
<a name="ln-4618"></a>
<a name="ln-4619"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ACH</span> <span class="o">&lt;=</span> <span class="mf">3.0d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Use the other convection algorithm</span>
<a name="ln-4620"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TypeIsWindow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4621"></a><span class="k">          CALL </span><span class="n">CalcASHRAEDetailedIntConvCoeff</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">SurfaceTemperatures</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">),</span><span class="n">MAT</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">))</span>
<a name="ln-4622"></a>        <span class="k">ELSE</span>
<a name="ln-4623"></a><span class="k">          CALL </span><span class="n">CalcISO15099WindowIntConvCoeff</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">SurfaceTemperatures</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">),</span><span class="n">MAT</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">))</span>
<a name="ln-4624"></a>        <span class="n">ENDIF</span>
<a name="ln-4625"></a>      <span class="k">ELSE</span> <span class="c">! Use forced convection correlations</span>
<a name="ln-4626"></a>        <span class="n">Tilt</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span>
<a name="ln-4627"></a>
<a name="ln-4628"></a>        <span class="c">! assume that reference air temp for user defined convection coefficient is the mean air temperature (=MAT)</span>
<a name="ln-4629"></a>        <span class="c">! Calculate the convection coefficient based on inlet (supply) air conditions</span>
<a name="ln-4630"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Tilt</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="mf">5.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4631"></a><span class="k">          </span><span class="n">HConvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.49d0</span> <span class="o">*</span> <span class="n">ACH</span><span class="o">**</span><span class="mf">0.8d0</span> <span class="c">! Ceiling correlation</span>
<a name="ln-4632"></a>        <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Tilt</span> <span class="o">&gt;</span> <span class="mi">13</span><span class="mf">5.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4633"></a><span class="k">          </span><span class="n">HConvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.13d0</span> <span class="o">*</span> <span class="n">ACH</span><span class="o">**</span><span class="mf">0.8d0</span> <span class="c">! Floor correlation</span>
<a name="ln-4634"></a>        <span class="k">ELSE</span>
<a name="ln-4635"></a><span class="k">          </span><span class="n">HConvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.19d0</span> <span class="o">*</span> <span class="n">ACH</span><span class="o">**</span><span class="mf">0.8d0</span> <span class="c">! Wall correlation</span>
<a name="ln-4636"></a>        <span class="k">END IF</span>
<a name="ln-4637"></a>        <span class="c">! set flag for reference air temperature</span>
<a name="ln-4638"></a>        <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TAirRef</span> <span class="o">=</span> <span class="n">ZoneSupplyAirTemp</span>
<a name="ln-4639"></a>      <span class="k">END IF</span>
<a name="ln-4640"></a>
<a name="ln-4641"></a>      <span class="c">! Establish some lower limit to avoid a zero convection coefficient (and potential divide by zero problems)</span>
<a name="ln-4642"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">HConvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">LowHConvLimit</span><span class="p">)</span> <span class="n">HConvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">LowHConvLimit</span>
<a name="ln-4643"></a>
<a name="ln-4644"></a>    <span class="k">END DO</span> <span class="c">! SurfNum</span>
<a name="ln-4645"></a>
<a name="ln-4646"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ACH</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;CeilingDiffuser convection correlation is out of range: ACH &gt; 100&#39;</span><span class="p">)</span>
<a name="ln-4647"></a>
<a name="ln-4648"></a>  <span class="k">RETURN</span>
<a name="ln-4649"></a>
<a name="ln-4650"></a><span class="k">END SUBROUTINE </span><span class="n">CalcCeilingDiffuserInletCorr</span>
<a name="ln-4651"></a>
<a name="ln-4652"></a>
<a name="ln-4653"></a><span class="k">SUBROUTINE </span><span class="n">CalcTrombeWallIntConvCoeff</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">,</span><span class="n">SurfaceTemperatures</span><span class="p">)</span>
<a name="ln-4654"></a>
<a name="ln-4655"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4656"></a>          <span class="c">!       AUTHOR         Peter Graham Ellis</span>
<a name="ln-4657"></a>          <span class="c">!       DATE WRITTEN   ?????</span>
<a name="ln-4658"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4659"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4660"></a>
<a name="ln-4661"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-4662"></a>          <span class="c">! This subroutine calculates the interior convection coefficient</span>
<a name="ln-4663"></a>          <span class="c">! using the Trombe Wall correlation ?????</span>
<a name="ln-4664"></a>
<a name="ln-4665"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4666"></a>          <span class="c">! na</span>
<a name="ln-4667"></a>
<a name="ln-4668"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4669"></a>          <span class="c">! na</span>
<a name="ln-4670"></a>
<a name="ln-4671"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4672"></a>  <span class="k">USE </span><span class="n">DataHeatBalFanSys</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">MAT</span>
<a name="ln-4673"></a>
<a name="ln-4674"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4675"></a>
<a name="ln-4676"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">ZoneNum</span>             <span class="c">! Zone number for which coefficients are being calculated</span>
<a name="ln-4677"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfaceTemperatures</span> <span class="c">! Temperature of surfaces for evaluation of HcIn</span>
<a name="ln-4678"></a>
<a name="ln-4679"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4680"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">g</span> <span class="o">=</span> <span class="mf">9.81d0</span>       <span class="c">! gravity constant (m/s**2)</span>
<a name="ln-4681"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">v</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">5.89d-6</span>   <span class="c">! kinematic viscosity (m**2/s) for air at 300 K</span>
<a name="ln-4682"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">k</span> <span class="o">=</span> <span class="mf">0.0263d0</span>     <span class="c">! thermal conductivity (W/m K) for air at 300 K</span>
<a name="ln-4683"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Pr</span> <span class="o">=</span> <span class="mf">0.71d0</span>      <span class="c">! Prandtl number for air at ?</span>
<a name="ln-4684"></a>
<a name="ln-4685"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-4686"></a>          <span class="c">! na</span>
<a name="ln-4687"></a>
<a name="ln-4688"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-4689"></a>          <span class="c">! na</span>
<a name="ln-4690"></a>
<a name="ln-4691"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4692"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SurfNum</span>            <span class="c">! DO loop counter for surfaces</span>
<a name="ln-4693"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Surf1</span>              <span class="c">! first major wall surface</span>
<a name="ln-4694"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Surf2</span>              <span class="c">! second major wall surface</span>
<a name="ln-4695"></a>
<a name="ln-4696"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">H</span>                  <span class="c">! height of enclosure</span>
<a name="ln-4697"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">minorW</span>             <span class="c">! width of enclosure (narrow dimension)</span>
<a name="ln-4698"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">majorW</span>             <span class="c">! width of major surface</span>
<a name="ln-4699"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">gapW</span>               <span class="c">! width of air gap</span>
<a name="ln-4700"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">asp</span>      <span class="c">! aspect ratio H/gapW</span>
<a name="ln-4701"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">beta</span>     <span class="c">! volumetric thermal expansion coefficient</span>
<a name="ln-4702"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Gr</span>       <span class="c">! Grashof number</span>
<a name="ln-4703"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Nu</span>       <span class="c">! Nusselt number</span>
<a name="ln-4704"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HConvNet</span>           <span class="c">! net heat transfer coefficient from wall to wall</span>
<a name="ln-4705"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Tso</span>      <span class="c">! outside surface temperature [K]</span>
<a name="ln-4706"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Tsi</span>      <span class="c">! inside surface temperature [K]</span>
<a name="ln-4707"></a>
<a name="ln-4708"></a>  <span class="c">! If the Trombe Wall option is selected the following correlations</span>
<a name="ln-4709"></a>  <span class="c">! will be used based on references by .....</span>
<a name="ln-4710"></a>  <span class="c">! tall enclosed rectangular cavity</span>
<a name="ln-4711"></a>
<a name="ln-4712"></a>  <span class="c">! This routine assumes that the major Trombe wall surfaces are of the</span>
<a name="ln-4713"></a>  <span class="c">! &quot;WALL&quot; class and are vertical.  The important heat transfer surfaces</span>
<a name="ln-4714"></a>  <span class="c">! are assumed to have exactly equal widths AND must have a greater</span>
<a name="ln-4715"></a>  <span class="c">! width than the side surfaces.</span>
<a name="ln-4716"></a>  <span class="c">!</span>
<a name="ln-4717"></a>
<a name="ln-4718"></a>  <span class="n">Surf1</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4719"></a>  <span class="n">Surf2</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4720"></a>
<a name="ln-4721"></a>  <span class="n">H</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">CeilingHeight</span>
<a name="ln-4722"></a>  <span class="n">minorW</span> <span class="o">=</span> <span class="mi">10000</span><span class="mf">0.0d0</span> <span class="c">! An impossibly big width</span>
<a name="ln-4723"></a>  <span class="n">majorW</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4724"></a>  <span class="n">gapW</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4725"></a>
<a name="ln-4726"></a>  <span class="n">Tso</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4727"></a>  <span class="n">Tsi</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4728"></a>  <span class="n">HConvNet</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4729"></a>
<a name="ln-4730"></a>  <span class="c">! determine major width and minor width</span>
<a name="ln-4731"></a>  <span class="k">DO </span><span class="n">SurfNum</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-4732"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">SurfaceClass_Wall</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-4733"></a>
<a name="ln-4734"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Width</span> <span class="o">&gt;</span> <span class="n">majorW</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4735"></a><span class="k">      </span><span class="n">majorW</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Width</span>
<a name="ln-4736"></a>    <span class="k">END IF</span>
<a name="ln-4737"></a>
<a name="ln-4738"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Width</span> <span class="o">&lt;</span> <span class="n">minorW</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4739"></a><span class="k">      </span><span class="n">minorW</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Width</span>
<a name="ln-4740"></a>    <span class="k">END IF</span>
<a name="ln-4741"></a><span class="k">  END DO</span>
<a name="ln-4742"></a>
<a name="ln-4743"></a>  <span class="c">! assign major surfaces</span>
<a name="ln-4744"></a>  <span class="k">DO </span><span class="n">SurfNum</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-4745"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">SurfaceClass_Wall</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-4746"></a>
<a name="ln-4747"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Width</span> <span class="o">==</span> <span class="n">majorW</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4748"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Surf1</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4749"></a><span class="k">        </span><span class="n">Surf1</span> <span class="o">=</span> <span class="n">SurfNum</span>
<a name="ln-4750"></a>      <span class="k">ELSE</span>
<a name="ln-4751"></a><span class="k">        </span><span class="n">Surf2</span> <span class="o">=</span> <span class="n">SurfNum</span>
<a name="ln-4752"></a>
<a name="ln-4753"></a>        <span class="k">EXIT</span> <span class="c">! both major surfaces are now assigned</span>
<a name="ln-4754"></a>      <span class="k">END IF</span>
<a name="ln-4755"></a><span class="k">    END IF</span>
<a name="ln-4756"></a><span class="k">  END DO</span>
<a name="ln-4757"></a>
<a name="ln-4758"></a>  <span class="c">! check to make sure major surfaces were found</span>
<a name="ln-4759"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Surf1</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surf2</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4760"></a><span class="k">    </span><span class="n">gapW</span> <span class="o">=</span> <span class="n">minorW</span>
<a name="ln-4761"></a>    <span class="n">asp</span> <span class="o">=</span> <span class="n">H</span><span class="o">/</span><span class="n">gapW</span>  <span class="c">! This calc should only be done once for the zone</span>
<a name="ln-4762"></a>
<a name="ln-4763"></a>    <span class="c">! make sure inside surface is hot, outside is cold</span>
<a name="ln-4764"></a>    <span class="c">! NOTE: this is not ideal.  could have circumstances that reverse this?</span>
<a name="ln-4765"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceTemperatures</span><span class="p">(</span><span class="n">Surf1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">SurfaceTemperatures</span><span class="p">(</span><span class="n">Surf2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4766"></a><span class="k">      </span><span class="n">Tsi</span> <span class="o">=</span> <span class="n">SurfaceTemperatures</span><span class="p">(</span><span class="n">Surf1</span><span class="p">)</span> <span class="o">+</span> <span class="n">KelvinConv</span>
<a name="ln-4767"></a>      <span class="n">Tso</span> <span class="o">=</span> <span class="n">SurfaceTemperatures</span><span class="p">(</span><span class="n">Surf2</span><span class="p">)</span> <span class="o">+</span> <span class="n">KelvinConv</span>
<a name="ln-4768"></a>    <span class="k">ELSE</span>
<a name="ln-4769"></a><span class="k">      </span><span class="n">Tso</span> <span class="o">=</span> <span class="n">SurfaceTemperatures</span><span class="p">(</span><span class="n">Surf1</span><span class="p">)</span> <span class="o">+</span> <span class="n">KelvinConv</span>
<a name="ln-4770"></a>      <span class="n">Tsi</span> <span class="o">=</span> <span class="n">SurfaceTemperatures</span><span class="p">(</span><span class="n">Surf2</span><span class="p">)</span> <span class="o">+</span> <span class="n">KelvinConv</span>
<a name="ln-4771"></a>    <span class="n">ENDIF</span>
<a name="ln-4772"></a>
<a name="ln-4773"></a>    <span class="n">beta</span> <span class="o">=</span> <span class="mf">2.0d0</span><span class="o">/</span><span class="p">(</span><span class="n">Tso</span> <span class="o">+</span> <span class="n">Tsi</span><span class="p">)</span>
<a name="ln-4774"></a>
<a name="ln-4775"></a>    <span class="n">Gr</span> <span class="o">=</span> <span class="p">(</span><span class="n">g</span><span class="o">*</span><span class="n">beta</span><span class="o">*</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Tsi</span> <span class="o">-</span> <span class="n">Tso</span><span class="p">)</span><span class="o">*</span><span class="n">gapW</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">v</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="c">! curve fit for v = v(T)?</span>
<a name="ln-4776"></a>
<a name="ln-4777"></a>    <span class="k">CALL </span><span class="n">CalcNusselt</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span> <span class="n">asp</span><span class="p">,</span> <span class="n">Tso</span><span class="p">,</span> <span class="n">Tsi</span><span class="p">,</span> <span class="n">Gr</span><span class="p">,</span> <span class="n">Pr</span><span class="p">,</span> <span class="n">Nu</span><span class="p">)</span> <span class="c">! curve fit for Pr = Pr(T)?</span>
<a name="ln-4778"></a>
<a name="ln-4779"></a>    <span class="n">HConvNet</span> <span class="o">=</span> <span class="p">(</span><span class="n">k</span><span class="o">/</span><span class="n">gapW</span><span class="p">)</span><span class="o">*</span><span class="n">Nu</span> <span class="c">! curve fit for k = k(T)?</span>
<a name="ln-4780"></a>
<a name="ln-4781"></a>  <span class="k">ELSE</span>
<a name="ln-4782"></a>    <span class="c">! fatal Error msg &quot;heat transfer surfaces not found&quot;</span>
<a name="ln-4783"></a>  <span class="k">END IF</span>
<a name="ln-4784"></a>
<a name="ln-4785"></a>  <span class="c">! Assign convection coefficients</span>
<a name="ln-4786"></a>  <span class="k">DO </span><span class="n">SurfNum</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-4787"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span> <span class="c">! Skip non-heat transfer surfaces</span>
<a name="ln-4788"></a>
<a name="ln-4789"></a>    <span class="c">! Use ASHRAESimple correlation to give values for all the minor surfaces</span>
<a name="ln-4790"></a>    <span class="k">CALL </span><span class="n">CalcASHRAESimpleIntConvCoeff</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">SurfaceTemperatures</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">),</span><span class="n">MAT</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">))</span>
<a name="ln-4791"></a>
<a name="ln-4792"></a>    <span class="c">! assign the convection coefficent to the major surfaces and any subsurfaces on them</span>
<a name="ln-4793"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span> <span class="o">==</span> <span class="n">Surf1</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span> <span class="o">==</span> <span class="n">Surf2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4794"></a><span class="k">      </span><span class="n">HConvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="mf">2.0d0</span><span class="o">*</span><span class="n">HConvNet</span>
<a name="ln-4795"></a>    <span class="k">END IF</span>
<a name="ln-4796"></a>
<a name="ln-4797"></a>    <span class="c">! Establish some lower limit to avoid a zero convection coefficient (and potential divide by zero problems)</span>
<a name="ln-4798"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">HConvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">LowHConvLimit</span><span class="p">)</span> <span class="n">HConvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">LowHConvLimit</span>
<a name="ln-4799"></a>  <span class="k">END DO</span>
<a name="ln-4800"></a>
<a name="ln-4801"></a><span class="k">  RETURN</span>
<a name="ln-4802"></a>
<a name="ln-4803"></a><span class="k">END SUBROUTINE </span><span class="n">CalcTrombeWallIntConvCoeff</span>
<a name="ln-4804"></a>
<a name="ln-4805"></a>
<a name="ln-4806"></a><span class="k">SUBROUTINE </span><span class="n">CalcNusselt</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span> <span class="n">asp</span><span class="p">,</span> <span class="n">tso</span><span class="p">,</span> <span class="n">tsi</span><span class="p">,</span> <span class="n">gr</span><span class="p">,</span> <span class="n">pr</span><span class="p">,</span> <span class="n">gnu</span><span class="p">)</span>
<a name="ln-4807"></a>
<a name="ln-4808"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4809"></a>          <span class="c">!       AUTHOR         Peter Graham Ellis, based on code adapted by Fred Winkelmann</span>
<a name="ln-4810"></a>          <span class="c">!                      from Window5 subroutine NusseltNumber</span>
<a name="ln-4811"></a>          <span class="c">!       DATE WRITTEN   September 2001</span>
<a name="ln-4812"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4813"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4814"></a>
<a name="ln-4815"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4816"></a>          <span class="c">! Finds the Nusselt number for gas-filled gaps between isothermal solid layers.</span>
<a name="ln-4817"></a>          <span class="c">! The gap may be filled with a single gas or a gas mixture.</span>
<a name="ln-4818"></a>
<a name="ln-4819"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4820"></a>          <span class="c">! Based on methodology in Chapter 5 of the July 18, 2001 draft of ISO 15099,</span>
<a name="ln-4821"></a>          <span class="c">! &quot;Thermal Performance of Windows, Doors and Shading Devices--Detailed Calculations.&quot;</span>
<a name="ln-4822"></a>          <span class="c">! The equation numbers below correspond to those in the standard.</span>
<a name="ln-4823"></a>
<a name="ln-4824"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4825"></a>          <span class="c">! Window5 source code; ISO 15099</span>
<a name="ln-4826"></a>
<a name="ln-4827"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4828"></a>          <span class="c">! na</span>
<a name="ln-4829"></a>
<a name="ln-4830"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4831"></a>
<a name="ln-4832"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4833"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">tso</span>               <span class="c">! Temperature of gap surface closest to outside (K)</span>
<a name="ln-4834"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">tsi</span>               <span class="c">! Temperature of gap surface closest to zone (K)</span>
<a name="ln-4835"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">SurfNum</span>           <span class="c">! Surface number</span>
<a name="ln-4836"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">asp</span>               <span class="c">! Aspect ratio: window height to gap width</span>
<a name="ln-4837"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">pr</span>                <span class="c">! Gap gas Prandtl number</span>
<a name="ln-4838"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">gr</span>                <span class="c">! Gap gas Grashof number</span>
<a name="ln-4839"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">gnu</span>               <span class="c">! Gap gas Nusselt number</span>
<a name="ln-4840"></a>
<a name="ln-4841"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-4842"></a>          <span class="c">! na</span>
<a name="ln-4843"></a>
<a name="ln-4844"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-4845"></a>          <span class="c">! na</span>
<a name="ln-4846"></a>
<a name="ln-4847"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS</span>
<a name="ln-4848"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ra</span>                                 <span class="c">! Rayleigh number</span>
<a name="ln-4849"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">gnu901</span><span class="p">,</span> <span class="n">gnu902</span><span class="p">,</span> <span class="n">gnu90</span><span class="p">,</span> <span class="n">gnu601</span>      <span class="c">! Nusselt number temporary variables for</span>
<a name="ln-4850"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">gnu602</span><span class="p">,</span> <span class="n">gnu60</span><span class="p">,</span> <span class="n">gnu601a</span><span class="p">,</span> <span class="n">gnua</span><span class="p">,</span> <span class="n">gnub</span> <span class="c">!  different tilt and Ra ranges</span>
<a name="ln-4851"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">cra</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">ang</span><span class="p">,</span> <span class="n">tilt</span><span class="p">,</span> <span class="n">tiltr</span>     <span class="c">! Temporary variables</span>
<a name="ln-4852"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">costilt</span><span class="p">,</span><span class="n">sintilt</span>
<a name="ln-4853"></a>
<a name="ln-4854"></a>
<a name="ln-4855"></a>  <span class="n">tilt</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span>
<a name="ln-4856"></a>  <span class="n">tiltr</span> <span class="o">=</span> <span class="n">tilt</span> <span class="o">*</span> <span class="n">DegToRadians</span>
<a name="ln-4857"></a>  <span class="n">costilt</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span>
<a name="ln-4858"></a>  <span class="n">sintilt</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SinTilt</span>
<a name="ln-4859"></a>  <span class="n">ra</span> <span class="o">=</span> <span class="n">gr</span><span class="o">*</span><span class="n">pr</span>
<a name="ln-4860"></a>                         <span class="c">!!fw if (ra &gt; 2.0e6): error that outside range of Rayleigh number?</span>
<a name="ln-4861"></a>
<a name="ln-4862"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ra</span> <span class="o">&lt;=</span> <span class="mf">1.0d4</span><span class="p">)</span>                  <span class="n">gnu901</span> <span class="o">=</span> <span class="mf">1.d0</span> <span class="o">+</span> <span class="mf">1.7596678d-10</span> <span class="o">*</span> <span class="n">ra</span><span class="o">**</span><span class="mf">2.2984755d0</span>   <span class="c">! eq. 51</span>
<a name="ln-4863"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ra</span> <span class="o">&gt;</span> <span class="mf">1.0d4</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">ra</span> <span class="o">&lt;=</span> <span class="mf">5.0d4</span><span class="p">)</span> <span class="n">gnu901</span> <span class="o">=</span>      <span class="mf">0.028154d0</span>      <span class="o">*</span> <span class="n">ra</span><span class="o">**</span><span class="mf">0.4134d0</span>      <span class="c">! eq. 50</span>
<a name="ln-4864"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ra</span> <span class="o">&gt;</span> <span class="mf">5.0d4</span><span class="p">)</span>                   <span class="n">gnu901</span> <span class="o">=</span>      <span class="mf">0.0673838d0</span>     <span class="o">*</span> <span class="n">ra</span><span class="o">**</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">/</span><span class="mf">3.0d0</span><span class="p">)</span>   <span class="c">! eq. 49</span>
<a name="ln-4865"></a>
<a name="ln-4866"></a>  <span class="n">gnu902</span> <span class="o">=</span> <span class="mf">0.242d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">ra</span><span class="o">/</span><span class="n">asp</span><span class="p">)</span><span class="o">**</span><span class="p">.</span><span class="mi">272</span><span class="n">d0</span>               <span class="c">! eq. 52</span>
<a name="ln-4867"></a>  <span class="n">gnu90</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">gnu901</span><span class="p">,</span><span class="n">gnu902</span><span class="p">)</span>
<a name="ln-4868"></a>
<a name="ln-4869"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">tso</span> <span class="o">&gt;</span> <span class="n">tsi</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! window heated from above</span>
<a name="ln-4870"></a>    <span class="n">gnu</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="o">+</span> <span class="p">(</span><span class="n">gnu90</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">)</span><span class="o">*</span><span class="n">sintilt</span>                     <span class="c">! eq. 53</span>
<a name="ln-4871"></a>  <span class="k">ELSE</span>                <span class="c">! window heated from below</span>
<a name="ln-4872"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">tilt</span> <span class="o">&gt;=</span> <span class="mi">6</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4873"></a><span class="k">      </span><span class="n">g</span>       <span class="o">=</span> <span class="mf">0.5d0</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">+</span><span class="p">(</span><span class="n">ra</span><span class="o">/</span><span class="mi">316</span><span class="mf">0.d0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="mf">0.6d0</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1d0</span><span class="p">)</span>    <span class="c">! eq. 47</span>
<a name="ln-4874"></a>      <span class="n">gnu601a</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.0936d0</span><span class="o">*</span><span class="p">(</span><span class="n">ra</span><span class="o">**</span><span class="mf">0.314d0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">+</span><span class="n">g</span><span class="p">))</span><span class="o">**</span><span class="mi">7</span>   <span class="c">! eq. 45</span>
<a name="ln-4875"></a>      <span class="n">gnu601</span>  <span class="o">=</span> <span class="n">gnu601a</span><span class="o">**</span><span class="mf">0.142857d0</span>
<a name="ln-4876"></a>
<a name="ln-4877"></a>      <span class="c">! For any aspect ratio</span>
<a name="ln-4878"></a>      <span class="n">gnu602</span>  <span class="o">=</span> <span class="p">(</span><span class="mf">0.104d0</span><span class="o">+</span><span class="mf">0.175d0</span><span class="o">/</span><span class="n">asp</span><span class="p">)</span> <span class="o">*</span> <span class="n">ra</span><span class="o">**</span><span class="mf">0.283d0</span>           <span class="c">! eq. 46</span>
<a name="ln-4879"></a>      <span class="n">gnu60</span>   <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">gnu601</span><span class="p">,</span><span class="n">gnu602</span><span class="p">)</span>
<a name="ln-4880"></a>
<a name="ln-4881"></a>      <span class="c">! linear interpolation for layers inclined at angles between 60 and 90 deg</span>
<a name="ln-4882"></a>      <span class="n">gnu</span>     <span class="o">=</span> <span class="p">((</span><span class="mi">9</span><span class="mf">0.0d0</span><span class="o">-</span><span class="n">tilt</span><span class="p">)</span><span class="o">*</span><span class="n">gnu60</span> <span class="o">+</span> <span class="p">(</span><span class="n">tilt</span><span class="o">-</span><span class="mi">6</span><span class="mf">0.0d0</span><span class="p">)</span><span class="o">*</span><span class="n">gnu90</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="mf">0.0d0</span>
<a name="ln-4883"></a>    <span class="n">ENDIF</span>
<a name="ln-4884"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">tilt</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>                               <span class="c">! eq. 42</span>
<a name="ln-4885"></a>      <span class="n">cra</span>  <span class="o">=</span> <span class="n">ra</span><span class="o">*</span><span class="n">costilt</span>
<a name="ln-4886"></a>      <span class="n">a</span>    <span class="o">=</span> <span class="mf">1.0d0</span> <span class="o">-</span> <span class="mi">170</span><span class="mf">8.0d0</span><span class="o">/</span><span class="n">cra</span>
<a name="ln-4887"></a>      <span class="n">b</span>    <span class="o">=</span> <span class="p">(</span><span class="n">cra</span><span class="o">/</span><span class="mi">583</span><span class="mf">0.0d0</span><span class="p">)</span><span class="o">**</span><span class="mf">0.33333d0</span><span class="o">-</span><span class="mf">1.0d0</span>    <span class="c">! LKL- replace .333 with OneThird?</span>
<a name="ln-4888"></a>      <span class="n">gnua</span> <span class="o">=</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">+</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0d0</span>
<a name="ln-4889"></a>      <span class="n">gnub</span> <span class="o">=</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">+</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0d0</span>
<a name="ln-4890"></a>      <span class="n">ang</span>  <span class="o">=</span> <span class="mi">170</span><span class="mf">8.0d0</span> <span class="o">*</span> <span class="p">(</span><span class="nb">SIN</span><span class="p">(</span><span class="mf">1.8d0</span><span class="o">*</span><span class="n">tiltr</span><span class="p">))</span><span class="o">**</span><span class="mf">1.6d0</span>
<a name="ln-4891"></a>      <span class="n">gnu</span>  <span class="o">=</span> <span class="mf">1.0d0</span> <span class="o">+</span> <span class="mf">1.44d0</span><span class="o">*</span><span class="n">gnua</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">ang</span><span class="o">/</span><span class="n">cra</span><span class="p">)</span> <span class="o">+</span> <span class="n">gnub</span>
<a name="ln-4892"></a>    <span class="n">ENDIF</span>
<a name="ln-4893"></a>  <span class="n">ENDIF</span>
<a name="ln-4894"></a>
<a name="ln-4895"></a>  <span class="k">RETURN</span>
<a name="ln-4896"></a>
<a name="ln-4897"></a><span class="k">END SUBROUTINE </span><span class="n">CalcNusselt</span>
<a name="ln-4898"></a>
<a name="ln-4899"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">SetExtConvectionCoeff</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-4900"></a>
<a name="ln-4901"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-4902"></a>          <span class="c">!       AUTHOR         Linda K. Lawrie</span>
<a name="ln-4903"></a>          <span class="c">!       DATE WRITTEN   May 1998</span>
<a name="ln-4904"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4905"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4906"></a>
<a name="ln-4907"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-4908"></a>          <span class="c">! This function accesses the data structure for the User</span>
<a name="ln-4909"></a>          <span class="c">! Supplied Exterior Convection Coefficients and returns that</span>
<a name="ln-4910"></a>          <span class="c">! as the result of this function.  The surface has already</span>
<a name="ln-4911"></a>          <span class="c">! been verified to have user supplied exterior convection values.</span>
<a name="ln-4912"></a>
<a name="ln-4913"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4914"></a>          <span class="c">! na</span>
<a name="ln-4915"></a>
<a name="ln-4916"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4917"></a>          <span class="c">! na</span>
<a name="ln-4918"></a>
<a name="ln-4919"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4920"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCurrentScheduleValue</span>
<a name="ln-4921"></a>
<a name="ln-4922"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4923"></a>
<a name="ln-4924"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-4925"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfNum</span>  <span class="c">! Surface Number</span>
<a name="ln-4926"></a>
<a name="ln-4927"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-4928"></a>          <span class="c">! na</span>
<a name="ln-4929"></a>
<a name="ln-4930"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-4931"></a>          <span class="c">! na</span>
<a name="ln-4932"></a>
<a name="ln-4933"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-4934"></a>          <span class="c">! na</span>
<a name="ln-4935"></a>
<a name="ln-4936"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4937"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">HExt</span>   <span class="c">! Will become the returned value</span>
<a name="ln-4938"></a>
<a name="ln-4939"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtConvCoeff</span><span class="p">)%</span><span class="n">OverrideType</span><span class="p">)</span>
<a name="ln-4940"></a>
<a name="ln-4941"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">ConvCoefValue</span><span class="p">)</span>
<a name="ln-4942"></a>      <span class="n">HExt</span><span class="o">=</span><span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtConvCoeff</span><span class="p">)%</span><span class="n">OverrideValue</span>
<a name="ln-4943"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvHfModelEq</span> <span class="o">=</span> <span class="n">HcExt_UserValue</span>  <span class="c">!reporting</span>
<a name="ln-4944"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvHnModelEq</span> <span class="o">=</span> <span class="n">HcExt_None</span>  <span class="c">!reporting</span>
<a name="ln-4945"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">ConvCoefSchedule</span><span class="p">)</span>
<a name="ln-4946"></a>      <span class="n">HExt</span><span class="o">=</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtConvCoeff</span><span class="p">)%</span><span class="n">ScheduleIndex</span><span class="p">)</span>
<a name="ln-4947"></a>      <span class="c">! Need to check for validity</span>
<a name="ln-4948"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvHfModelEq</span> <span class="o">=</span> <span class="n">HcExt_UserSchedule</span>  <span class="c">!reporting</span>
<a name="ln-4949"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvHnModelEq</span> <span class="o">=</span> <span class="n">HcExt_None</span>  <span class="c">!reporting</span>
<a name="ln-4950"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">ConvCoefUserCurve</span><span class="p">)</span>
<a name="ln-4951"></a>      <span class="k">Call </span><span class="n">CalcUserDefinedOutsideHcModel</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4952"></a>                            <span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtConvCoeff</span><span class="p">)%</span><span class="n">UserCurveIndex</span><span class="p">,</span> <span class="n">HExt</span><span class="p">)</span>
<a name="ln-4953"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvHfModelEq</span> <span class="o">=</span> <span class="n">HcExt_UserCurve</span>  <span class="c">!reporting</span>
<a name="ln-4954"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvHnModelEq</span> <span class="o">=</span> <span class="n">HcExt_None</span>  <span class="c">!reporting</span>
<a name="ln-4955"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">ConvCoefSpecifiedModel</span><span class="p">)</span>
<a name="ln-4956"></a>      <span class="k">CALL </span><span class="n">EvaluateExtHcModels</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4957"></a>                       <span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtConvCoeff</span><span class="p">)%</span><span class="n">HcModelEq</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4958"></a>                       <span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtConvCoeff</span><span class="p">)%</span><span class="n">HcModelEq</span><span class="p">,</span> <span class="n">HExt</span><span class="p">)</span>
<a name="ln-4959"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvHfModelEq</span> <span class="o">=</span> <span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtConvCoeff</span><span class="p">)%</span><span class="n">HcModelEq</span>  <span class="c">!reporting</span>
<a name="ln-4960"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvHnModelEq</span> <span class="o">=</span> <span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtConvCoeff</span><span class="p">)%</span><span class="n">HcModelEq</span>  <span class="c">!reporting</span>
<a name="ln-4961"></a>    <span class="k">END SELECT</span>
<a name="ln-4962"></a>
<a name="ln-4963"></a><span class="k">    </span><span class="n">SetExtConvectionCoeff</span><span class="o">=</span><span class="n">HExt</span>
<a name="ln-4964"></a>
<a name="ln-4965"></a>  <span class="k">RETURN</span>
<a name="ln-4966"></a>
<a name="ln-4967"></a><span class="k">END FUNCTION </span><span class="n">SetExtConvectionCoeff</span>
<a name="ln-4968"></a>
<a name="ln-4969"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">SetIntConvectionCoeff</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-4970"></a>
<a name="ln-4971"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-4972"></a>          <span class="c">!       AUTHOR         Linda K. Lawrie</span>
<a name="ln-4973"></a>          <span class="c">!       DATE WRITTEN   May 1998</span>
<a name="ln-4974"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4975"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4976"></a>
<a name="ln-4977"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-4978"></a>          <span class="c">! This function accesses the data structre for the User</span>
<a name="ln-4979"></a>          <span class="c">! Supplied Interior Convection Coefficients and returns that</span>
<a name="ln-4980"></a>          <span class="c">! as the result of this function.  The surface has already</span>
<a name="ln-4981"></a>          <span class="c">! been verified to have user supplied interior convection values.</span>
<a name="ln-4982"></a>
<a name="ln-4983"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4984"></a>          <span class="c">! na</span>
<a name="ln-4985"></a>
<a name="ln-4986"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4987"></a>          <span class="c">! na</span>
<a name="ln-4988"></a>
<a name="ln-4989"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4990"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCurrentScheduleValue</span>
<a name="ln-4991"></a>
<a name="ln-4992"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4993"></a>
<a name="ln-4994"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-4995"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfNum</span>  <span class="c">! Surface Number</span>
<a name="ln-4996"></a>
<a name="ln-4997"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-4998"></a>          <span class="c">! na</span>
<a name="ln-4999"></a>
<a name="ln-5000"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-5001"></a>          <span class="c">! na</span>
<a name="ln-5002"></a>
<a name="ln-5003"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-5004"></a>          <span class="c">! na</span>
<a name="ln-5005"></a>
<a name="ln-5006"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5007"></a>          <span class="c">! na</span>
<a name="ln-5008"></a>
<a name="ln-5009"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">HInt</span>   <span class="c">! Will become the returned value</span>
<a name="ln-5010"></a>
<a name="ln-5011"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvCoeff</span><span class="p">)%</span><span class="n">OverrideType</span><span class="p">)</span>
<a name="ln-5012"></a>
<a name="ln-5013"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">ConvCoefValue</span><span class="p">)</span>
<a name="ln-5014"></a>      <span class="n">HInt</span><span class="o">=</span><span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvCoeff</span><span class="p">)%</span><span class="n">OverrideValue</span>
<a name="ln-5015"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">=</span> <span class="n">HcInt_UserValue</span> <span class="c">!reporting</span>
<a name="ln-5016"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">ConvCoefSchedule</span><span class="p">)</span>
<a name="ln-5017"></a>      <span class="n">HInt</span><span class="o">=</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvCoeff</span><span class="p">)%</span><span class="n">ScheduleIndex</span><span class="p">)</span>
<a name="ln-5018"></a>      <span class="c">! Need to check for validity</span>
<a name="ln-5019"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">=</span> <span class="n">HcInt_UserSchedule</span> <span class="c">!reporting</span>
<a name="ln-5020"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">ConvCoefUserCurve</span><span class="p">)</span>
<a name="ln-5021"></a>
<a name="ln-5022"></a>      <span class="k">CALL </span><span class="n">CalcUserDefinedInsideHcModel</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5023"></a>                    <span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvCoeff</span><span class="p">)%</span><span class="n">UserCurveIndex</span><span class="p">,</span> <span class="n">HInt</span><span class="p">)</span>
<a name="ln-5024"></a>        <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">=</span> <span class="n">HcInt_UserCurve</span> <span class="c">!reporting</span>
<a name="ln-5025"></a>    <span class="k">CASE</span> <span class="p">(</span> <span class="n">ConvCoefSpecifiedModel</span> <span class="p">)</span>
<a name="ln-5026"></a>
<a name="ln-5027"></a>      <span class="k">CALL </span><span class="n">EvaluateIntHcModels</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span> <span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvCoeff</span><span class="p">)%</span><span class="n">HcModelEq</span><span class="p">,</span> <span class="n">HInt</span><span class="p">)</span>
<a name="ln-5028"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">=</span> <span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvCoeff</span><span class="p">)%</span><span class="n">HcModelEq</span>
<a name="ln-5029"></a>    <span class="k">END SELECT</span>
<a name="ln-5030"></a>
<a name="ln-5031"></a><span class="k">    </span><span class="n">SetIntConvectionCoeff</span><span class="o">=</span><span class="n">HInt</span>
<a name="ln-5032"></a>
<a name="ln-5033"></a>  <span class="k">RETURN</span>
<a name="ln-5034"></a>
<a name="ln-5035"></a><span class="k">END FUNCTION </span><span class="n">SetIntConvectionCoeff</span>
<a name="ln-5036"></a>
<a name="ln-5037"></a><span class="k">SUBROUTINE </span><span class="n">CalcISO15099WindowIntConvCoeff</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">SurfaceTemperature</span><span class="p">,</span><span class="n">AirTemperature</span><span class="p">)</span>
<a name="ln-5038"></a>
<a name="ln-5039"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5040"></a>          <span class="c">!       AUTHOR         B. Griffith</span>
<a name="ln-5041"></a>          <span class="c">!       DATE WRITTEN   January 2009</span>
<a name="ln-5042"></a>          <span class="c">!       MODIFIED       BG May 2009, added EMS override for window coeffs.</span>
<a name="ln-5043"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5044"></a>
<a name="ln-5045"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5046"></a>          <span class="c">! Calculate interior surface convection coefficients for windows</span>
<a name="ln-5047"></a>
<a name="ln-5048"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5049"></a>          <span class="c">! correlation documented in ISO 15099, Section 8.3.2.2</span>
<a name="ln-5050"></a>
<a name="ln-5051"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5052"></a>          <span class="c">! Internation Standard ISO 15099. Thermal performance of windows, doors and shading devices -- Detailed Calculations</span>
<a name="ln-5053"></a>          <span class="c">! First Edition 2003-11-15. ISO 15099:2003(E)</span>
<a name="ln-5054"></a>
<a name="ln-5055"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5056"></a>  <span class="k">USE </span><span class="n">Psychrometrics</span> <span class="p">,</span>   <span class="n">ONLY</span><span class="p">:</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">,</span> <span class="n">PsyRhoAirFnPbTdbW</span>
<a name="ln-5057"></a>  <span class="k">USE </span><span class="n">DataHeatBalFanSys</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ZoneAirHumRatAvg</span>
<a name="ln-5058"></a>  <span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span>   <span class="n">ONLY</span><span class="p">:</span> <span class="n">OutHumRat</span><span class="p">,</span> <span class="n">OutBaroPress</span>
<a name="ln-5059"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5060"></a>
<a name="ln-5061"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5062"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">SurfNum</span> <span class="c">! surface number for which coefficients are being calculated</span>
<a name="ln-5063"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">SurfaceTemperature</span> <span class="c">! Temperature of surface for evaluation of HcIn</span>
<a name="ln-5064"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">AirTemperature</span>  <span class="c">! Mean Air Temperature of Zone (or adjacent air temperature)</span>
<a name="ln-5065"></a>
<a name="ln-5066"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-5067"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">OneThird</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">/</span><span class="mf">3.d0</span><span class="p">)</span>  <span class="c">! 1/3 in highest precision</span>
<a name="ln-5068"></a>
<a name="ln-5069"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-5070"></a>          <span class="c">! na</span>
<a name="ln-5071"></a>
<a name="ln-5072"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-5073"></a>          <span class="c">! na</span>
<a name="ln-5074"></a>
<a name="ln-5075"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5076"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">DeltaTemp</span>          <span class="c">! Temperature difference between the zone air and the surface</span>
<a name="ln-5077"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">TmeanFilm</span>  <span class="c">! mean film temperature</span>
<a name="ln-5078"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">TmeanFilmKelvin</span> <span class="c">!  mean film temperature for property evaluation</span>
<a name="ln-5079"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">rho</span>     <span class="c">! density of air [kg/m3]</span>
<a name="ln-5080"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">g</span>       <span class="c">! acceleration due to gravity [m/s2]</span>
<a name="ln-5081"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Height</span>  <span class="c">! window cavity height [m]</span>
<a name="ln-5082"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Cp</span>      <span class="c">! specific heat of air [J/kg-K]</span>
<a name="ln-5083"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">lambda</span>  <span class="c">! thermal conductivity of air [W/m-K]</span>
<a name="ln-5084"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">mu</span>      <span class="c">! dynamic viscosity of air [kg/m-s]</span>
<a name="ln-5085"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">RaH</span>     <span class="c">! Rayleigh number for cavity height [ Non dim]</span>
<a name="ln-5086"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">RaCV</span>    <span class="c">! Rayleigh number for slanted cavity</span>
<a name="ln-5087"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">tiltDeg</span> <span class="c">! glazing tilt in degrees</span>
<a name="ln-5088"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">sineTilt</span> <span class="c">! sine of glazing tilt</span>
<a name="ln-5089"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Nuint</span>    <span class="c">! Nusselt number for interior surface convection</span>
<a name="ln-5090"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">SurfTempKelvin</span> <span class="c">! surface temperature in Kelvin</span>
<a name="ln-5091"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">AirTempKelvin</span>  <span class="c">! air temperature in Kelvin</span>
<a name="ln-5092"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">AirHumRat</span>  <span class="c">! air humidity ratio</span>
<a name="ln-5093"></a>
<a name="ln-5094"></a>  <span class="n">SurfTempKelvin</span> <span class="o">=</span> <span class="n">SurfaceTemperature</span> <span class="o">+</span>  <span class="mi">27</span><span class="mf">3.15D0</span>
<a name="ln-5095"></a>  <span class="n">AirTempKelvin</span>  <span class="o">=</span> <span class="n">AirTemperature</span>     <span class="o">+</span> <span class="mi">27</span><span class="mf">3.15D0</span>
<a name="ln-5096"></a>  <span class="n">DeltaTemp</span>      <span class="o">=</span> <span class="n">SurfaceTemperature</span> <span class="o">-</span> <span class="n">AirTemperature</span>
<a name="ln-5097"></a>
<a name="ln-5098"></a>  <span class="c">! protect against wildly out of range temperatures</span>
<a name="ln-5099"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">AirTempKelvin</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="mf">0.0D0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">AirTempKelvin</span> <span class="o">&gt;</span> <span class="mi">40</span><span class="mf">0.0D0</span><span class="p">))</span> <span class="k">THEN</span> <span class="c">! out of range</span>
<a name="ln-5100"></a>    <span class="n">HConvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">LowHConvLimit</span>
<a name="ln-5101"></a>    <span class="k">RETURN</span>
<a name="ln-5102"></a><span class="k">  </span><span class="n">ENDIF</span>
<a name="ln-5103"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">SurfTempKelvin</span> <span class="o">&lt;</span> <span class="mi">18</span><span class="mf">0.0D0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">SurfTempKelvin</span> <span class="o">&gt;</span> <span class="mi">45</span><span class="mf">0.0D0</span><span class="p">))</span> <span class="k">THEN</span> <span class="c">! out of range</span>
<a name="ln-5104"></a>    <span class="n">HConvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">LowHConvLimit</span>
<a name="ln-5105"></a>    <span class="k">RETURN</span>
<a name="ln-5106"></a><span class="k">  </span><span class="n">ENDIF</span>
<a name="ln-5107"></a>
<a name="ln-5108"></a>  <span class="c">! Get humidity ratio</span>
<a name="ln-5109"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-5110"></a><span class="k">    </span><span class="n">AirHumRat</span> <span class="o">=</span> <span class="n">ZoneAirHumRatAvg</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)</span>
<a name="ln-5111"></a>  <span class="k">ELSE</span>
<a name="ln-5112"></a><span class="k">    </span><span class="n">AirHumRat</span> <span class="o">=</span> <span class="n">OutHumRat</span>
<a name="ln-5113"></a>  <span class="n">ENDIF</span>
<a name="ln-5114"></a>
<a name="ln-5115"></a>  <span class="c">! mean film temperature</span>
<a name="ln-5116"></a>  <span class="n">TmeanFilmKelvin</span> <span class="o">=</span> <span class="n">AirTempKelvin</span> <span class="o">+</span> <span class="mf">0.25D0</span><span class="o">*</span><span class="p">(</span><span class="n">SurfTempKelvin</span> <span class="o">-</span> <span class="n">AirTempKelvin</span><span class="p">)</span> <span class="c">! eq. 133 in ISO 15099</span>
<a name="ln-5117"></a>  <span class="n">TmeanFilm</span> <span class="o">=</span> <span class="n">TmeanFilmKelvin</span> <span class="o">-</span> <span class="mi">27</span><span class="mf">3.15D0</span>
<a name="ln-5118"></a>
<a name="ln-5119"></a>  <span class="n">rho</span>    <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutBaroPress</span><span class="p">,</span> <span class="n">TmeanFilm</span><span class="p">,</span> <span class="n">AirHumRat</span><span class="p">,</span> <span class="s1">&#39;WindowTempsForNominalCond&#39;</span><span class="p">)</span>
<a name="ln-5120"></a>  <span class="n">g</span>      <span class="o">=</span> <span class="mf">9.81D0</span>
<a name="ln-5121"></a>  <span class="n">Height</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Height</span>
<a name="ln-5122"></a>
<a name="ln-5123"></a>  <span class="c">! the following properties are probably for dry air, should maybe be remade for moist-air</span>
<a name="ln-5124"></a>  <span class="n">lambda</span> <span class="o">=</span> <span class="mf">2.873D-3</span> <span class="o">+</span> <span class="mf">7.76D-5</span>   <span class="o">*</span> <span class="n">TmeanFilmKelvin</span> <span class="c">! Table B.1 in ISO 15099,</span>
<a name="ln-5125"></a>  <span class="n">mu</span>     <span class="o">=</span> <span class="mf">3.723D-6</span> <span class="o">+</span> <span class="mf">4.94D-8</span>   <span class="o">*</span> <span class="n">TmeanFilmKelvin</span> <span class="c">! Table B.2 in ISO 15099</span>
<a name="ln-5126"></a>
<a name="ln-5127"></a>  <span class="n">Cp</span>     <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">AirHumRat</span><span class="p">,</span>  <span class="n">TmeanFilm</span><span class="p">,</span> <span class="s1">&#39;WindowTempsForNominalCond&#39;</span><span class="p">)</span>
<a name="ln-5128"></a>
<a name="ln-5129"></a>  <span class="n">TiltDeg</span><span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span>
<a name="ln-5130"></a>  <span class="n">sineTilt</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SinTilt</span>
<a name="ln-5131"></a>
<a name="ln-5132"></a>  <span class="c">! four cases depending on tilt and DeltaTemp (heat flow direction )</span>
<a name="ln-5133"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="n">TiltDeg</span> <span class="o">=</span> <span class="mi">18</span><span class="mf">0.0D0</span> <span class="o">-</span> <span class="n">TiltDeg</span> <span class="c">! complement angle if cooling situation</span>
<a name="ln-5134"></a>
<a name="ln-5135"></a>  <span class="n">RaH</span> <span class="o">=</span> <span class="p">(</span> <span class="n">rho</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Height</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="n">g</span> <span class="o">*</span> <span class="n">Cp</span> <span class="o">*</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">SurfTempKelvin</span><span class="o">-</span><span class="n">AirTempKelvin</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5136"></a>           <span class="o">/</span> <span class="p">(</span><span class="n">TmeanFilmKelvin</span> <span class="o">*</span> <span class="n">mu</span> <span class="o">*</span> <span class="n">lambda</span><span class="p">)</span> <span class="c">! eq 132 in ISO 15099</span>
<a name="ln-5137"></a>
<a name="ln-5138"></a>  <span class="c">! case a)</span>
<a name="ln-5139"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="p">(</span><span class="mf">0.0D0</span> <span class="o">&lt;=</span> <span class="n">TiltDeg</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">TiltDeg</span>  <span class="o">&lt;</span> <span class="mi">1</span><span class="mf">5.0D0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5140"></a>
<a name="ln-5141"></a><span class="k">    </span><span class="n">Nuint</span> <span class="o">=</span>  <span class="mf">0.13d0</span><span class="o">*</span><span class="p">(</span><span class="n">RaH</span><span class="p">)</span><span class="o">**</span><span class="n">OneThird</span>
<a name="ln-5142"></a>
<a name="ln-5143"></a>  <span class="c">! case b)</span>
<a name="ln-5144"></a>  <span class="n">ELSEIF</span> <span class="p">(</span> <span class="p">(</span><span class="mi">1</span><span class="mf">5.0D0</span> <span class="o">&lt;=</span> <span class="n">TiltDeg</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">TiltDeg</span>  <span class="o">&lt;=</span> <span class="mi">9</span><span class="mf">0.0D0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5145"></a>
<a name="ln-5146"></a><span class="k">    </span><span class="n">RaCV</span> <span class="o">=</span> <span class="mf">2.5D+5</span> <span class="o">*</span> <span class="p">(</span> <span class="nb">EXP</span><span class="p">(</span><span class="mf">0.72d0</span><span class="o">*</span><span class="n">TiltDeg</span><span class="p">)</span> <span class="o">/</span> <span class="n">sineTilt</span><span class="p">)</span><span class="o">**</span><span class="mf">0.2D0</span> <span class="c">! eq. 137</span>
<a name="ln-5147"></a>
<a name="ln-5148"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">RaH</span> <span class="o">&lt;=</span> <span class="n">RaCV</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-5149"></a><span class="k">      </span><span class="n">Nuint</span> <span class="o">=</span> <span class="mf">0.56D0</span><span class="o">*</span><span class="p">(</span><span class="n">RaH</span> <span class="o">*</span> <span class="n">sineTilt</span><span class="p">)</span><span class="o">**</span><span class="mf">0.25d0</span>  <span class="c">! eq. 135 in ISO 15099</span>
<a name="ln-5150"></a>    <span class="k">ELSE</span>
<a name="ln-5151"></a><span class="k">      </span><span class="n">Nuint</span> <span class="o">=</span> <span class="mf">0.13D0</span> <span class="o">*</span> <span class="p">(</span><span class="n">RaH</span><span class="o">**</span><span class="n">OneThird</span> <span class="o">-</span> <span class="n">RaCV</span><span class="o">**</span><span class="n">OneThird</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5152"></a>              <span class="o">+</span> <span class="mf">0.56D0</span> <span class="o">*</span> <span class="p">(</span><span class="n">RaCV</span> <span class="o">*</span> <span class="n">sineTilt</span> <span class="p">)</span><span class="o">**</span><span class="mf">0.25D0</span> <span class="c">! eq. 136 in ISO 15099</span>
<a name="ln-5153"></a>    <span class="n">ENDIF</span>
<a name="ln-5154"></a>
<a name="ln-5155"></a>  <span class="c">!case c)</span>
<a name="ln-5156"></a>  <span class="n">ELSEIF</span>  <span class="p">(</span> <span class="p">(</span><span class="mi">9</span><span class="mf">0.0D0</span> <span class="o">&lt;</span> <span class="n">TiltDeg</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">TiltDeg</span>  <span class="o">&lt;=</span> <span class="mi">17</span><span class="mf">9.0D0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5157"></a>    <span class="c">! bound by applicability</span>
<a name="ln-5158"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">RaH</span> <span class="o">*</span> <span class="n">sineTilt</span> <span class="o">&lt;</span> <span class="mf">1.0D+5</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5159"></a><span class="k">      </span><span class="n">Nuint</span> <span class="o">=</span> <span class="mf">0.56D0</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0D+5</span><span class="p">)</span><span class="o">**</span><span class="mf">0.25d0</span> <span class="c">! bounded</span>
<a name="ln-5160"></a>    <span class="n">ElseIF</span> <span class="p">(</span><span class="n">RaH</span> <span class="o">*</span> <span class="n">sineTilt</span> <span class="o">&gt;=</span> <span class="mf">1.0D+11</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5161"></a><span class="k">      </span><span class="n">Nuint</span> <span class="o">=</span> <span class="mf">0.56D0</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0D+11</span><span class="p">)</span><span class="o">**</span><span class="mf">0.25d0</span> <span class="c">! bounded</span>
<a name="ln-5162"></a>    <span class="k">Else</span>
<a name="ln-5163"></a><span class="k">      </span><span class="n">Nuint</span> <span class="o">=</span> <span class="mf">0.56D0</span><span class="o">*</span><span class="p">(</span><span class="n">RaH</span> <span class="o">*</span> <span class="n">sineTilt</span><span class="p">)</span><span class="o">**</span><span class="mf">0.25d0</span> <span class="c">! eq.. 138</span>
<a name="ln-5164"></a>    <span class="n">ENDIF</span>
<a name="ln-5165"></a>
<a name="ln-5166"></a>  <span class="c">! case d)</span>
<a name="ln-5167"></a>  <span class="n">ELSEIF</span>  <span class="p">(</span> <span class="p">(</span><span class="mi">17</span><span class="mf">9.0D0</span> <span class="o">&lt;</span> <span class="n">TiltDeg</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">TiltDeg</span>  <span class="o">&lt;=</span> <span class="mi">18</span><span class="mf">0.0D0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5168"></a>
<a name="ln-5169"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">RaH</span> <span class="o">&gt;</span> <span class="mf">1.0D+11</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5170"></a><span class="k">      </span><span class="n">Nuint</span> <span class="o">=</span> <span class="mf">0.58d0</span><span class="o">*</span><span class="mi">1</span><span class="n">D</span><span class="o">+</span><span class="mi">11</span><span class="o">**</span><span class="mf">0.2D0</span>  <span class="c">! bounded</span>
<a name="ln-5171"></a>    <span class="k">ELSE</span>
<a name="ln-5172"></a><span class="k">      </span><span class="n">Nuint</span> <span class="o">=</span> <span class="mf">0.58d0</span><span class="o">*</span><span class="n">RaH</span><span class="o">**</span><span class="mf">0.2D0</span>
<a name="ln-5173"></a>    <span class="n">ENDIF</span>
<a name="ln-5174"></a>
<a name="ln-5175"></a>  <span class="n">ENDIF</span>
<a name="ln-5176"></a>
<a name="ln-5177"></a>  <span class="n">HConvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span>  <span class="n">Nuint</span> <span class="o">*</span> <span class="n">lambda</span> <span class="o">/</span> <span class="n">Height</span>
<a name="ln-5178"></a>
<a name="ln-5179"></a>  <span class="c">! EMS override point (Violates Standard 15099?  throw warning? scary.</span>
<a name="ln-5180"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">EMSOverrideIntConvCoef</span><span class="p">)</span> <span class="n">HConvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">EMSValueForIntConvCoef</span>
<a name="ln-5181"></a>
<a name="ln-5182"></a>  <span class="c">! Establish some lower limit to avoid a zero convection coefficient (and potential divide by zero problems)</span>
<a name="ln-5183"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">HConvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">LowHConvLimit</span><span class="p">)</span> <span class="n">HConvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">LowHConvLimit</span>
<a name="ln-5184"></a>
<a name="ln-5185"></a>  <span class="k">RETURN</span>
<a name="ln-5186"></a>
<a name="ln-5187"></a><span class="k">END SUBROUTINE </span><span class="n">CalcISO15099WindowIntConvCoeff</span>
<a name="ln-5188"></a>
<a name="ln-5189"></a><span class="k">SUBROUTINE </span><span class="n">SetupAdaptiveConvectionStaticMetaData</span>
<a name="ln-5190"></a>
<a name="ln-5191"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5192"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-5193"></a>          <span class="c">!       DATE WRITTEN   Aug 2010</span>
<a name="ln-5194"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5195"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5196"></a>
<a name="ln-5197"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5198"></a>          <span class="c">!do one-time setup needed to store static data</span>
<a name="ln-5199"></a>          <span class="c">! for adaptive convection algorithm</span>
<a name="ln-5200"></a>
<a name="ln-5201"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5202"></a>          <span class="c">!</span>
<a name="ln-5203"></a>
<a name="ln-5204"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5205"></a>          <span class="c">! none, developed for EnergyPlus version 6.0, see Eng Ref.</span>
<a name="ln-5206"></a>
<a name="ln-5207"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5208"></a>  <span class="k">USE </span><span class="n">Vectors</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">Distance</span><span class="p">,</span> <span class="n">DetermineAzimuthAndTilt</span><span class="p">,</span> <span class="n">CreateNewellSurfaceNormalVector</span><span class="p">,</span><span class="n">CreateNewellAreaVector</span><span class="p">,</span> <span class="n">VecLength</span>
<a name="ln-5209"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ScanForReports</span><span class="p">,</span> <span class="n">RoundSigDigits</span>
<a name="ln-5210"></a>
<a name="ln-5211"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5212"></a>
<a name="ln-5213"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5214"></a>          <span class="c">! na</span>
<a name="ln-5215"></a>
<a name="ln-5216"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-5217"></a>          <span class="c">! na</span>
<a name="ln-5218"></a>
<a name="ln-5219"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-5220"></a>          <span class="c">! na</span>
<a name="ln-5221"></a>
<a name="ln-5222"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-5223"></a>
<a name="ln-5224"></a>
<a name="ln-5225"></a>  <span class="k">TYPE </span><span class="n">FacadeGeoCharactisticsStruct</span>
<a name="ln-5226"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AzimuthRangeLow</span>
<a name="ln-5227"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AzimuthRangeHi</span>
<a name="ln-5228"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Zmax</span>
<a name="ln-5229"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Zmin</span>
<a name="ln-5230"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Ymax</span>
<a name="ln-5231"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Ymin</span>
<a name="ln-5232"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Xmax</span>
<a name="ln-5233"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Xmin</span>
<a name="ln-5234"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Area</span>
<a name="ln-5235"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Perimeter</span>
<a name="ln-5236"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Height</span>
<a name="ln-5237"></a>  <span class="k">END TYPE </span><span class="n">FacadeGeoCharactisticsStruct</span>
<a name="ln-5238"></a>
<a name="ln-5239"></a>
<a name="ln-5240"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5241"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">FirstRoofSurf</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5242"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ZoneLoop</span> <span class="c">!</span>
<a name="ln-5243"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SurfLoop</span> <span class="c">!</span>
<a name="ln-5244"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">VertLoop</span>
<a name="ln-5245"></a><span class="c">!  REAL(r64) :: thisZoneHeight</span>
<a name="ln-5246"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BldgVolumeSum</span>
<a name="ln-5247"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PerimExtLengthSum</span>
<a name="ln-5248"></a>
<a name="ln-5249"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">thisWWR</span>
<a name="ln-5250"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">thisZoneSimplePerim</span>
<a name="ln-5251"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">thisZoneHorizHydralicDiameter</span>
<a name="ln-5252"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ExtWallCount</span>
<a name="ln-5253"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ExtWindowCount</span>
<a name="ln-5254"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">thisAzimuth</span>
<a name="ln-5255"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">thisArea</span>
<a name="ln-5256"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">thisZone</span>
<a name="ln-5257"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RoofBoundZvals</span>
<a name="ln-5258"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TestDist</span>
<a name="ln-5259"></a><span class="c">!  TYPE(vector), DIMENSION(4) :: BoundSurf</span>
<a name="ln-5260"></a>  <span class="k">Type</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">BoundNewellVec</span>
<a name="ln-5261"></a>  <span class="k">Type</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">BoundNewellAreaVec</span>
<a name="ln-5262"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">surfacearea</span>
<a name="ln-5263"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">BoundTilt</span>
<a name="ln-5264"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">BoundAzimuth</span>
<a name="ln-5265"></a>  <span class="k">Type</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">dummy1</span>
<a name="ln-5266"></a>  <span class="k">Type</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">dummy2</span>
<a name="ln-5267"></a>  <span class="k">Type</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">dummy3</span>
<a name="ln-5268"></a>  <span class="kt">LOGICAL </span><span class="n">DoReport</span>
<a name="ln-5269"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SideALength</span>
<a name="ln-5270"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SideBLength</span>
<a name="ln-5271"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SideCLength</span>
<a name="ln-5272"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SideDLength</span>
<a name="ln-5273"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">YesNo1</span>
<a name="ln-5274"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">YesNo2</span>
<a name="ln-5275"></a>
<a name="ln-5276"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">FacadeGeoCharactisticsStruct</span><span class="p">)</span> <span class="kd">::</span>  <span class="n">NorthFacade</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5277"></a>       <span class="n">FacadeGeoCharactisticsStruct</span><span class="p">(</span><span class="mi">33</span><span class="mf">2.5d0</span><span class="p">,</span> <span class="mi">2</span><span class="mf">2.5d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span> <span class="p">)</span>
<a name="ln-5278"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">FacadeGeoCharactisticsStruct</span><span class="p">)</span> <span class="kd">::</span>  <span class="n">NorthEastFacade</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5279"></a>       <span class="n">FacadeGeoCharactisticsStruct</span><span class="p">(</span><span class="mi">2</span><span class="mf">2.5d0</span><span class="p">,</span> <span class="mi">6</span><span class="mf">7.5d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span> <span class="p">)</span>
<a name="ln-5280"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">FacadeGeoCharactisticsStruct</span><span class="p">)</span> <span class="kd">::</span>  <span class="n">EastFacade</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5281"></a>       <span class="n">FacadeGeoCharactisticsStruct</span><span class="p">(</span><span class="mi">6</span><span class="mf">7.5d0</span><span class="p">,</span> <span class="mi">11</span><span class="mf">2.5d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span> <span class="p">)</span>
<a name="ln-5282"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">FacadeGeoCharactisticsStruct</span><span class="p">)</span> <span class="kd">::</span>  <span class="n">SouthEastFacade</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5283"></a>       <span class="n">FacadeGeoCharactisticsStruct</span><span class="p">(</span><span class="mi">11</span><span class="mf">2.5d0</span><span class="p">,</span> <span class="mi">15</span><span class="mf">7.5d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span> <span class="p">)</span>
<a name="ln-5284"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">FacadeGeoCharactisticsStruct</span><span class="p">)</span> <span class="kd">::</span>  <span class="n">SouthFacade</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5285"></a>       <span class="n">FacadeGeoCharactisticsStruct</span><span class="p">(</span><span class="mi">15</span><span class="mf">7.5d0</span><span class="p">,</span> <span class="mi">20</span><span class="mf">2.5d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span> <span class="p">)</span>
<a name="ln-5286"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">FacadeGeoCharactisticsStruct</span><span class="p">)</span> <span class="kd">::</span>  <span class="n">SouthWestFacade</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5287"></a>       <span class="n">FacadeGeoCharactisticsStruct</span><span class="p">(</span><span class="mi">20</span><span class="mf">2.5d0</span><span class="p">,</span> <span class="mi">24</span><span class="mf">7.5d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span> <span class="p">)</span>
<a name="ln-5288"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">FacadeGeoCharactisticsStruct</span><span class="p">)</span> <span class="kd">::</span>  <span class="n">WestFacade</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5289"></a>       <span class="n">FacadeGeoCharactisticsStruct</span><span class="p">(</span><span class="mi">24</span><span class="mf">7.5d0</span><span class="p">,</span> <span class="mi">28</span><span class="mf">7.5d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span> <span class="p">)</span>
<a name="ln-5290"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">FacadeGeoCharactisticsStruct</span><span class="p">)</span> <span class="kd">::</span>  <span class="n">NorthWestFacade</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5291"></a>       <span class="n">FacadeGeoCharactisticsStruct</span><span class="p">(</span><span class="mi">28</span><span class="mf">7.5d0</span><span class="p">,</span> <span class="mi">33</span><span class="mf">2.5d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="mf">0.d0</span> <span class="p">)</span>
<a name="ln-5292"></a>
<a name="ln-5293"></a>
<a name="ln-5294"></a>
<a name="ln-5295"></a>  <span class="n">BldgVolumeSum</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-5296"></a>  <span class="n">RoofBoundZVals</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-5297"></a>  <span class="k">DO </span><span class="n">ZoneLoop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NumOfZones</span>
<a name="ln-5298"></a>
<a name="ln-5299"></a>    <span class="n">BldgVolumeSum</span> <span class="o">=</span> <span class="n">BldgVolumeSum</span> <span class="o">+</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">)%</span><span class="n">Volume</span><span class="o">*</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">)%</span><span class="n">Multiplier</span><span class="o">*</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">)%</span><span class="n">ListMultiplier</span>
<a name="ln-5300"></a>    <span class="n">PerimExtLengthSum</span>   <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! init</span>
<a name="ln-5301"></a>    <span class="n">ExtWallCount</span>        <span class="o">=</span> <span class="mi">0</span>    <span class="c">! init</span>
<a name="ln-5302"></a>    <span class="n">ExtWindowCount</span>      <span class="o">=</span> <span class="mi">0</span>    <span class="c">! init</span>
<a name="ln-5303"></a>    <span class="c">!model perimeter of bounding horizontal rectangle from max and min x and y values</span>
<a name="ln-5304"></a>    <span class="n">thisZoneSimplePerim</span> <span class="o">=</span>  <span class="mf">2.d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">)%</span><span class="n">MaximumY</span> <span class="o">-</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">)%</span><span class="n">MinimumY</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5305"></a>                         <span class="o">+</span> <span class="mf">2.d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">)%</span><span class="n">MaximumX</span> <span class="o">-</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">)%</span><span class="n">MinimumX</span><span class="p">)</span>
<a name="ln-5306"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">thisZoneSimplePerim</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5307"></a><span class="k">      </span><span class="n">thisZoneHorizHydralicDiameter</span> <span class="o">=</span> <span class="mf">4.d0</span><span class="o">*</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">)%</span><span class="n">FloorArea</span> <span class="o">/</span> <span class="n">thisZoneSimplePerim</span>
<a name="ln-5308"></a>    <span class="k">ELSE</span>
<a name="ln-5309"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">)%</span><span class="n">FloorArea</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5310"></a><span class="k">        </span><span class="n">thisZoneHorizHydralicDiameter</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">)%</span><span class="n">FloorArea</span><span class="p">)</span>
<a name="ln-5311"></a>      <span class="n">ENDIF</span>
<a name="ln-5312"></a>    <span class="n">ENDIF</span>
<a name="ln-5313"></a>
<a name="ln-5314"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">)%</span><span class="n">ExtGrossWallArea</span> <span class="o">&gt;</span> <span class="mf">0.d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5315"></a><span class="k">     </span><span class="n">thisWWR</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">)%</span><span class="n">ExtWindowArea</span> <span class="o">/</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">)%</span><span class="n">ExtGrossWallArea</span>
<a name="ln-5316"></a>    <span class="k">ELSE</span>
<a name="ln-5317"></a><span class="k">     </span><span class="n">thisWWR</span> <span class="o">=</span> <span class="o">-</span><span class="mi">99</span><span class="mf">9.d0</span>  <span class="c">!throw error?</span>
<a name="ln-5318"></a>    <span class="n">ENDIF</span>
<a name="ln-5319"></a>    <span class="c">! first pass thru this zones surfaces to gather data</span>
<a name="ln-5320"></a>    <span class="k">DO </span><span class="n">SurfLoop</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-5321"></a>      <span class="c">!first catch exterior walls and do summations</span>
<a name="ln-5322"></a>      <span class="k">IF</span> <span class="p">(</span>  <span class="p">(</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">ExternalEnvironment</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5323"></a>         <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Wall</span><span class="p">)</span>  <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5324"></a><span class="k">        </span><span class="n">PerimExtLengthSum</span>   <span class="o">=</span> <span class="n">PerimExtLengthSum</span> <span class="o">+</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Width</span>
<a name="ln-5325"></a>        <span class="n">ExtWallCount</span> <span class="o">=</span> <span class="n">ExtWallCount</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-5326"></a>      <span class="n">ENDIF</span>
<a name="ln-5327"></a>      <span class="k">IF</span> <span class="p">(</span>  <span class="p">(</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">ExternalEnvironment</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5328"></a>         <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span><span class="p">)</span>     <span class="p">&amp;</span>
<a name="ln-5329"></a>               <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span>  <span class="n">SurfaceClass_GlassDoor</span><span class="p">)</span> <span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5330"></a><span class="k">        </span><span class="n">ExtWindowCount</span>   <span class="o">=</span> <span class="n">ExtWindowCount</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-5331"></a>      <span class="n">ENDIF</span>
<a name="ln-5332"></a>    <span class="n">ENDDO</span>
<a name="ln-5333"></a>
<a name="ln-5334"></a>    <span class="c">!second pass thru zone surfs to fill data</span>
<a name="ln-5335"></a>    <span class="k">DO </span><span class="n">SurfLoop</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-5336"></a>      <span class="c">!now fill values</span>
<a name="ln-5337"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">IntConvZoneWallHeight</span>    <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">)%</span><span class="n">CeilingHeight</span>
<a name="ln-5338"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">IntConvZonePerimLength</span>   <span class="o">=</span> <span class="n">PerimExtLengthSum</span>
<a name="ln-5339"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">IntConvZoneHorizHydrDiam</span> <span class="o">=</span> <span class="n">thisZoneHorizHydralicDiameter</span>
<a name="ln-5340"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">IntConvWindowWallRatio</span>   <span class="o">=</span> <span class="n">thisWWR</span>
<a name="ln-5341"></a>    <span class="n">ENDDO</span> <span class="c">!2nd pass over surfaces.</span>
<a name="ln-5342"></a>
<a name="ln-5343"></a>    <span class="c">!third pass for window locations</span>
<a name="ln-5344"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">ExtWindowCount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">ExtWallCount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5345"></a><span class="k">      DO </span><span class="n">SurfLoop</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-5346"></a>        <span class="k">IF</span> <span class="p">(</span>  <span class="p">(</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">ExternalEnvironment</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5347"></a>           <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span><span class="p">)</span>     <span class="p">&amp;</span>
<a name="ln-5348"></a>               <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span>  <span class="n">SurfaceClass_GlassDoor</span><span class="p">)</span> <span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5349"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">IntConvWindowWallRatio</span> <span class="o">&lt;</span> <span class="mf">0.5d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5350"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">Z</span> <span class="o">&lt;</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">)%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5351"></a><span class="k">              </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">IntConvWindowLocation</span> <span class="o">=</span> <span class="n">InConvWinLoc_LowerPartOfExteriorWall</span>
<a name="ln-5352"></a>            <span class="k">ELSE</span>
<a name="ln-5353"></a><span class="k">              </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">IntConvWindowLocation</span> <span class="o">=</span> <span class="n">InConvWinLoc_UpperPartOfExteriorWall</span>
<a name="ln-5354"></a>            <span class="n">ENDIF</span>
<a name="ln-5355"></a>          <span class="k">ELSE</span>
<a name="ln-5356"></a><span class="k">            </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">IntConvWindowLocation</span> <span class="o">=</span> <span class="n">InConvWinLoc_LargePartOfExteriorWall</span>
<a name="ln-5357"></a>          <span class="n">ENDIF</span>
<a name="ln-5358"></a>          <span class="k">IF</span> <span class="p">(</span>  <span class="p">(</span> <span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">ExternalEnvironment</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5359"></a>              <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Wall</span><span class="p">)</span>  <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5360"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">Z</span> <span class="o">&lt;</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">z</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5361"></a><span class="k">              </span><span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">IntConvWindowLocation</span> <span class="o">=</span> <span class="n">InConvWinLoc_WindowAboveThis</span>
<a name="ln-5362"></a>            <span class="k">ELSE</span>
<a name="ln-5363"></a><span class="k">              </span><span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">IntConvWindowLocation</span> <span class="o">=</span> <span class="n">InConvWinLoc_WindowBelowThis</span>
<a name="ln-5364"></a>            <span class="n">ENDIF</span>
<a name="ln-5365"></a>          <span class="n">ENDIF</span>
<a name="ln-5366"></a>        <span class="n">ENDIF</span>
<a name="ln-5367"></a>        <span class="k">IF</span> <span class="p">(</span>  <span class="p">(</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">ExternalEnvironment</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5368"></a>           <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Wall</span><span class="p">)</span>        <span class="p">&amp;</span>
<a name="ln-5369"></a>           <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>  <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">IntConvWindowLocation</span> <span class="o">==</span> <span class="n">InConvWinLoc_NotSet</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5370"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">z</span> <span class="o">&lt;</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">)%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">z</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5371"></a><span class="k">            </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">IntConvWindowLocation</span> <span class="o">=</span> <span class="n">InConvWinLoc_WindowAboveThis</span>
<a name="ln-5372"></a>          <span class="k">ELSE</span>
<a name="ln-5373"></a><span class="k">            </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">IntConvWindowLocation</span> <span class="o">=</span> <span class="n">InConvWinLoc_WindowBelowThis</span>
<a name="ln-5374"></a>          <span class="n">ENDIF</span>
<a name="ln-5375"></a>
<a name="ln-5376"></a>        <span class="n">ENDIF</span>
<a name="ln-5377"></a>      <span class="n">ENDDO</span> <span class="c">!third pass over surfaces</span>
<a name="ln-5378"></a>
<a name="ln-5379"></a>    <span class="n">ENDIF</span>
<a name="ln-5380"></a>  <span class="n">ENDDO</span> <span class="c">!loop over zones for inside face parameters</span>
<a name="ln-5381"></a>
<a name="ln-5382"></a>  <span class="n">CubeRootOfOverallBuildingVolume</span> <span class="o">=</span> <span class="p">(</span><span class="n">BldgVolumeSum</span><span class="p">)</span><span class="o">**</span><span class="n">OneThird</span>
<a name="ln-5383"></a>
<a name="ln-5384"></a>  <span class="c">! first pass over surfaces for outside face params</span>
<a name="ln-5385"></a>  <span class="k">DO </span><span class="n">SurfLoop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">TotSurfaces</span>
<a name="ln-5386"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">/=</span> <span class="n">ExternalEnvironment</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-5387"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-5388"></a><span class="k">    </span><span class="n">thisAzimuth</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Azimuth</span>
<a name="ln-5389"></a>    <span class="n">thisArea</span>    <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-5390"></a>    <span class="n">thisZone</span>    <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-5391"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="mf">5.d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&lt;</span> <span class="mi">13</span><span class="mf">5.d0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5392"></a>     <span class="c">!treat as vertical wall</span>
<a name="ln-5393"></a>      <span class="k">IF</span> <span class="p">((</span><span class="n">thisAzimuth</span> <span class="o">&gt;=</span> <span class="n">NorthFacade</span><span class="p">%</span><span class="n">AzimuthRangeLow</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5394"></a>          <span class="p">(</span><span class="n">thisAzimuth</span> <span class="o">&lt;</span> <span class="n">NorthFacade</span><span class="p">%</span><span class="n">AzimuthRangeHi</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5395"></a><span class="k">        </span><span class="n">NorthFacade</span><span class="p">%</span><span class="n">Area</span> <span class="o">=</span> <span class="n">NorthFacade</span><span class="p">%</span><span class="n">Area</span> <span class="o">+</span> <span class="n">thisArea</span>
<a name="ln-5396"></a>        <span class="n">NorthFacade</span><span class="p">%</span><span class="n">Zmax</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">z</span><span class="p">),</span>  <span class="n">NorthFacade</span><span class="p">%</span><span class="n">Zmax</span><span class="p">)</span>
<a name="ln-5397"></a>        <span class="n">NorthFacade</span><span class="p">%</span><span class="n">Zmin</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="nb">MINVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">z</span><span class="p">),</span>  <span class="n">NorthFacade</span><span class="p">%</span><span class="n">Zmin</span><span class="p">)</span>
<a name="ln-5398"></a>        <span class="n">NorthFacade</span><span class="p">%</span><span class="n">Ymax</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">y</span><span class="p">),</span>  <span class="n">NorthFacade</span><span class="p">%</span><span class="n">Ymax</span><span class="p">)</span>
<a name="ln-5399"></a>        <span class="n">NorthFacade</span><span class="p">%</span><span class="n">Ymin</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="nb">MINVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">y</span><span class="p">),</span>  <span class="n">NorthFacade</span><span class="p">%</span><span class="n">Ymin</span><span class="p">)</span>
<a name="ln-5400"></a>        <span class="n">NorthFacade</span><span class="p">%</span><span class="n">Xmax</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">x</span><span class="p">),</span>  <span class="n">NorthFacade</span><span class="p">%</span><span class="n">Xmax</span><span class="p">)</span>
<a name="ln-5401"></a>        <span class="n">NorthFacade</span><span class="p">%</span><span class="n">Xmin</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="nb">MINVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">x</span><span class="p">),</span>  <span class="n">NorthFacade</span><span class="p">%</span><span class="n">Xmin</span><span class="p">)</span>
<a name="ln-5402"></a>
<a name="ln-5403"></a>      <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">thisAzimuth</span> <span class="o">&gt;=</span> <span class="n">NorthEastFacade</span><span class="p">%</span><span class="n">AzimuthRangeLow</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5404"></a>              <span class="p">(</span><span class="n">thisAzimuth</span> <span class="o">&lt;</span> <span class="n">NorthEastFacade</span><span class="p">%</span><span class="n">AzimuthRangeHi</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5405"></a><span class="k">        </span><span class="n">NorthEastFacade</span><span class="p">%</span><span class="n">Area</span> <span class="o">=</span> <span class="n">NorthEastFacade</span><span class="p">%</span><span class="n">Area</span> <span class="o">+</span> <span class="n">thisArea</span>
<a name="ln-5406"></a>        <span class="n">NorthEastFacade</span><span class="p">%</span><span class="n">Zmax</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">z</span><span class="p">),</span>  <span class="n">NorthEastFacade</span><span class="p">%</span><span class="n">Zmax</span><span class="p">)</span>
<a name="ln-5407"></a>        <span class="n">NorthEastFacade</span><span class="p">%</span><span class="n">Zmin</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="nb">MINVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">z</span><span class="p">),</span>  <span class="n">NorthEastFacade</span><span class="p">%</span><span class="n">Zmin</span><span class="p">)</span>
<a name="ln-5408"></a>        <span class="n">NorthEastFacade</span><span class="p">%</span><span class="n">Ymax</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">y</span><span class="p">),</span>  <span class="n">NorthEastFacade</span><span class="p">%</span><span class="n">Ymax</span><span class="p">)</span>
<a name="ln-5409"></a>        <span class="n">NorthEastFacade</span><span class="p">%</span><span class="n">Ymin</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="nb">MINVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">y</span><span class="p">),</span>  <span class="n">NorthEastFacade</span><span class="p">%</span><span class="n">Ymin</span><span class="p">)</span>
<a name="ln-5410"></a>        <span class="n">NorthEastFacade</span><span class="p">%</span><span class="n">Xmax</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">x</span><span class="p">),</span>  <span class="n">NorthEastFacade</span><span class="p">%</span><span class="n">Xmax</span><span class="p">)</span>
<a name="ln-5411"></a>        <span class="n">NorthEastFacade</span><span class="p">%</span><span class="n">Xmin</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="nb">MINVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">x</span><span class="p">),</span>  <span class="n">NorthEastFacade</span><span class="p">%</span><span class="n">Xmin</span><span class="p">)</span>
<a name="ln-5412"></a>
<a name="ln-5413"></a>      <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">thisAzimuth</span> <span class="o">&gt;=</span> <span class="n">EastFacade</span><span class="p">%</span><span class="n">AzimuthRangeLow</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5414"></a>              <span class="p">(</span><span class="n">thisAzimuth</span> <span class="o">&lt;</span> <span class="n">EastFacade</span><span class="p">%</span><span class="n">AzimuthRangeHi</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5415"></a><span class="k">        </span><span class="n">EastFacade</span><span class="p">%</span><span class="n">Area</span> <span class="o">=</span> <span class="n">EastFacade</span><span class="p">%</span><span class="n">Area</span> <span class="o">+</span> <span class="n">thisArea</span>
<a name="ln-5416"></a>        <span class="n">EastFacade</span><span class="p">%</span><span class="n">Zmax</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">z</span><span class="p">),</span>  <span class="n">EastFacade</span><span class="p">%</span><span class="n">Zmax</span><span class="p">)</span>
<a name="ln-5417"></a>        <span class="n">EastFacade</span><span class="p">%</span><span class="n">Zmin</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="nb">MINVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">z</span><span class="p">),</span>  <span class="n">EastFacade</span><span class="p">%</span><span class="n">Zmin</span><span class="p">)</span>
<a name="ln-5418"></a>        <span class="n">EastFacade</span><span class="p">%</span><span class="n">Ymax</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">y</span><span class="p">),</span>  <span class="n">EastFacade</span><span class="p">%</span><span class="n">Ymax</span><span class="p">)</span>
<a name="ln-5419"></a>        <span class="n">EastFacade</span><span class="p">%</span><span class="n">Ymin</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="nb">MINVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">y</span><span class="p">),</span>  <span class="n">EastFacade</span><span class="p">%</span><span class="n">Ymin</span><span class="p">)</span>
<a name="ln-5420"></a>        <span class="n">EastFacade</span><span class="p">%</span><span class="n">Xmax</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">x</span><span class="p">),</span>  <span class="n">EastFacade</span><span class="p">%</span><span class="n">Xmax</span><span class="p">)</span>
<a name="ln-5421"></a>        <span class="n">EastFacade</span><span class="p">%</span><span class="n">Xmin</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="nb">MINVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">x</span><span class="p">),</span>  <span class="n">EastFacade</span><span class="p">%</span><span class="n">Xmin</span><span class="p">)</span>
<a name="ln-5422"></a>      <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">thisAzimuth</span> <span class="o">&gt;=</span> <span class="n">SouthEastFacade</span><span class="p">%</span><span class="n">AzimuthRangeLow</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5423"></a>              <span class="p">(</span><span class="n">thisAzimuth</span> <span class="o">&lt;</span> <span class="n">SouthEastFacade</span><span class="p">%</span><span class="n">AzimuthRangeHi</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5424"></a><span class="k">        </span><span class="n">SouthEastFacade</span><span class="p">%</span><span class="n">Area</span> <span class="o">=</span> <span class="n">SouthEastFacade</span><span class="p">%</span><span class="n">Area</span> <span class="o">+</span> <span class="n">thisArea</span>
<a name="ln-5425"></a>        <span class="n">SouthEastFacade</span><span class="p">%</span><span class="n">Zmax</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">z</span><span class="p">),</span>  <span class="n">SouthEastFacade</span><span class="p">%</span><span class="n">Zmax</span><span class="p">)</span>
<a name="ln-5426"></a>        <span class="n">SouthEastFacade</span><span class="p">%</span><span class="n">Zmin</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="nb">MINVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">z</span><span class="p">),</span>  <span class="n">SouthEastFacade</span><span class="p">%</span><span class="n">Zmin</span><span class="p">)</span>
<a name="ln-5427"></a>        <span class="n">SouthEastFacade</span><span class="p">%</span><span class="n">Ymax</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">y</span><span class="p">),</span>  <span class="n">SouthEastFacade</span><span class="p">%</span><span class="n">Ymax</span><span class="p">)</span>
<a name="ln-5428"></a>        <span class="n">SouthEastFacade</span><span class="p">%</span><span class="n">Ymin</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="nb">MINVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">y</span><span class="p">),</span>  <span class="n">SouthEastFacade</span><span class="p">%</span><span class="n">Ymin</span><span class="p">)</span>
<a name="ln-5429"></a>        <span class="n">SouthEastFacade</span><span class="p">%</span><span class="n">Xmax</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">x</span><span class="p">),</span>  <span class="n">SouthEastFacade</span><span class="p">%</span><span class="n">Xmax</span><span class="p">)</span>
<a name="ln-5430"></a>        <span class="n">SouthEastFacade</span><span class="p">%</span><span class="n">Xmin</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="nb">MINVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">x</span><span class="p">),</span>  <span class="n">SouthEastFacade</span><span class="p">%</span><span class="n">Xmin</span><span class="p">)</span>
<a name="ln-5431"></a>
<a name="ln-5432"></a>      <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">thisAzimuth</span> <span class="o">&gt;=</span> <span class="n">SouthFacade</span><span class="p">%</span><span class="n">AzimuthRangeLow</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5433"></a>              <span class="p">(</span><span class="n">thisAzimuth</span> <span class="o">&lt;</span> <span class="n">SouthFacade</span><span class="p">%</span><span class="n">AzimuthRangeHi</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5434"></a><span class="k">        </span><span class="n">SouthFacade</span><span class="p">%</span><span class="n">Area</span> <span class="o">=</span> <span class="n">SouthFacade</span><span class="p">%</span><span class="n">Area</span> <span class="o">+</span> <span class="n">thisArea</span>
<a name="ln-5435"></a>        <span class="n">SouthFacade</span><span class="p">%</span><span class="n">Zmax</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">z</span><span class="p">),</span>  <span class="n">SouthFacade</span><span class="p">%</span><span class="n">Zmax</span><span class="p">)</span>
<a name="ln-5436"></a>        <span class="n">SouthFacade</span><span class="p">%</span><span class="n">Zmin</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="nb">MINVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">z</span><span class="p">),</span>  <span class="n">SouthFacade</span><span class="p">%</span><span class="n">Zmin</span><span class="p">)</span>
<a name="ln-5437"></a>        <span class="n">SouthFacade</span><span class="p">%</span><span class="n">Ymax</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">y</span><span class="p">),</span>  <span class="n">SouthFacade</span><span class="p">%</span><span class="n">Ymax</span><span class="p">)</span>
<a name="ln-5438"></a>        <span class="n">SouthFacade</span><span class="p">%</span><span class="n">Ymin</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="nb">MINVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">y</span><span class="p">),</span>  <span class="n">SouthFacade</span><span class="p">%</span><span class="n">Ymin</span><span class="p">)</span>
<a name="ln-5439"></a>        <span class="n">SouthFacade</span><span class="p">%</span><span class="n">Xmax</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">x</span><span class="p">),</span>  <span class="n">SouthFacade</span><span class="p">%</span><span class="n">Xmax</span><span class="p">)</span>
<a name="ln-5440"></a>        <span class="n">SouthFacade</span><span class="p">%</span><span class="n">Xmin</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="nb">MINVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">x</span><span class="p">),</span>  <span class="n">SouthFacade</span><span class="p">%</span><span class="n">Xmin</span><span class="p">)</span>
<a name="ln-5441"></a>
<a name="ln-5442"></a>      <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">thisAzimuth</span> <span class="o">&gt;=</span> <span class="n">SouthWestFacade</span><span class="p">%</span><span class="n">AzimuthRangeLow</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5443"></a>              <span class="p">(</span><span class="n">thisAzimuth</span> <span class="o">&lt;</span> <span class="n">SouthWestFacade</span><span class="p">%</span><span class="n">AzimuthRangeHi</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5444"></a><span class="k">        </span><span class="n">SouthWestFacade</span><span class="p">%</span><span class="n">Area</span> <span class="o">=</span> <span class="n">SouthWestFacade</span><span class="p">%</span><span class="n">Area</span> <span class="o">+</span> <span class="n">thisArea</span>
<a name="ln-5445"></a>        <span class="n">SouthWestFacade</span><span class="p">%</span><span class="n">Zmax</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">z</span><span class="p">),</span>  <span class="n">SouthWestFacade</span><span class="p">%</span><span class="n">Zmax</span><span class="p">)</span>
<a name="ln-5446"></a>        <span class="n">SouthWestFacade</span><span class="p">%</span><span class="n">Zmin</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="nb">MINVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">z</span><span class="p">),</span>  <span class="n">SouthWestFacade</span><span class="p">%</span><span class="n">Zmin</span><span class="p">)</span>
<a name="ln-5447"></a>        <span class="n">SouthWestFacade</span><span class="p">%</span><span class="n">Ymax</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">y</span><span class="p">),</span>  <span class="n">SouthWestFacade</span><span class="p">%</span><span class="n">Ymax</span><span class="p">)</span>
<a name="ln-5448"></a>        <span class="n">SouthWestFacade</span><span class="p">%</span><span class="n">Ymin</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="nb">MINVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">y</span><span class="p">),</span>  <span class="n">SouthWestFacade</span><span class="p">%</span><span class="n">Ymin</span><span class="p">)</span>
<a name="ln-5449"></a>        <span class="n">SouthWestFacade</span><span class="p">%</span><span class="n">Xmax</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">x</span><span class="p">),</span>  <span class="n">SouthWestFacade</span><span class="p">%</span><span class="n">Xmax</span><span class="p">)</span>
<a name="ln-5450"></a>        <span class="n">SouthWestFacade</span><span class="p">%</span><span class="n">Xmin</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="nb">MINVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">x</span><span class="p">),</span>  <span class="n">SouthWestFacade</span><span class="p">%</span><span class="n">Xmin</span><span class="p">)</span>
<a name="ln-5451"></a>
<a name="ln-5452"></a>      <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">thisAzimuth</span> <span class="o">&gt;=</span> <span class="n">WestFacade</span><span class="p">%</span><span class="n">AzimuthRangeLow</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5453"></a>              <span class="p">(</span><span class="n">thisAzimuth</span> <span class="o">&lt;</span> <span class="n">WestFacade</span><span class="p">%</span><span class="n">AzimuthRangeHi</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5454"></a><span class="k">        </span><span class="n">WestFacade</span><span class="p">%</span><span class="n">Area</span> <span class="o">=</span> <span class="n">WestFacade</span><span class="p">%</span><span class="n">Area</span> <span class="o">+</span> <span class="n">thisArea</span>
<a name="ln-5455"></a>        <span class="n">WestFacade</span><span class="p">%</span><span class="n">Zmax</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">z</span><span class="p">),</span>  <span class="n">WestFacade</span><span class="p">%</span><span class="n">Zmax</span><span class="p">)</span>
<a name="ln-5456"></a>        <span class="n">WestFacade</span><span class="p">%</span><span class="n">Zmin</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="nb">MINVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">z</span><span class="p">),</span>  <span class="n">WestFacade</span><span class="p">%</span><span class="n">Zmin</span><span class="p">)</span>
<a name="ln-5457"></a>        <span class="n">WestFacade</span><span class="p">%</span><span class="n">Ymax</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">y</span><span class="p">),</span>  <span class="n">WestFacade</span><span class="p">%</span><span class="n">Ymax</span><span class="p">)</span>
<a name="ln-5458"></a>        <span class="n">WestFacade</span><span class="p">%</span><span class="n">Ymin</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="nb">MINVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">y</span><span class="p">),</span>  <span class="n">WestFacade</span><span class="p">%</span><span class="n">Ymin</span><span class="p">)</span>
<a name="ln-5459"></a>        <span class="n">WestFacade</span><span class="p">%</span><span class="n">Xmax</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">x</span><span class="p">),</span>  <span class="n">WestFacade</span><span class="p">%</span><span class="n">Xmax</span><span class="p">)</span>
<a name="ln-5460"></a>        <span class="n">WestFacade</span><span class="p">%</span><span class="n">Xmin</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="nb">MINVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">x</span><span class="p">),</span>  <span class="n">WestFacade</span><span class="p">%</span><span class="n">Xmin</span><span class="p">)</span>
<a name="ln-5461"></a>
<a name="ln-5462"></a>      <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">thisAzimuth</span> <span class="o">&gt;=</span> <span class="n">NorthWestFacade</span><span class="p">%</span><span class="n">AzimuthRangeLow</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5463"></a>              <span class="p">(</span><span class="n">thisAzimuth</span> <span class="o">&lt;</span> <span class="n">NorthWestFacade</span><span class="p">%</span><span class="n">AzimuthRangeHi</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5464"></a><span class="k">        </span><span class="n">NorthWestFacade</span><span class="p">%</span><span class="n">Area</span> <span class="o">=</span> <span class="n">NorthWestFacade</span><span class="p">%</span><span class="n">Area</span> <span class="o">+</span> <span class="n">thisArea</span>
<a name="ln-5465"></a>        <span class="n">NorthWestFacade</span><span class="p">%</span><span class="n">Zmax</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">z</span><span class="p">),</span>  <span class="n">NorthWestFacade</span><span class="p">%</span><span class="n">Zmax</span><span class="p">)</span>
<a name="ln-5466"></a>        <span class="n">NorthWestFacade</span><span class="p">%</span><span class="n">Zmin</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="nb">MINVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">z</span><span class="p">),</span>  <span class="n">NorthWestFacade</span><span class="p">%</span><span class="n">Zmin</span><span class="p">)</span>
<a name="ln-5467"></a>        <span class="n">NorthWestFacade</span><span class="p">%</span><span class="n">Ymax</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">y</span><span class="p">),</span>  <span class="n">NorthWestFacade</span><span class="p">%</span><span class="n">Ymax</span><span class="p">)</span>
<a name="ln-5468"></a>        <span class="n">NorthWestFacade</span><span class="p">%</span><span class="n">Ymin</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="nb">MINVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">y</span><span class="p">),</span>  <span class="n">NorthWestFacade</span><span class="p">%</span><span class="n">Ymin</span><span class="p">)</span>
<a name="ln-5469"></a>        <span class="n">NorthWestFacade</span><span class="p">%</span><span class="n">Xmax</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">x</span><span class="p">),</span>  <span class="n">NorthWestFacade</span><span class="p">%</span><span class="n">Xmax</span><span class="p">)</span>
<a name="ln-5470"></a>        <span class="n">NorthWestFacade</span><span class="p">%</span><span class="n">Xmin</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="nb">MINVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">x</span><span class="p">),</span>  <span class="n">NorthWestFacade</span><span class="p">%</span><span class="n">Xmin</span><span class="p">)</span>
<a name="ln-5471"></a>
<a name="ln-5472"></a>      <span class="n">ENDIF</span>
<a name="ln-5473"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="mf">5.0d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">!TODO Double check tilt wrt outside vs inside</span>
<a name="ln-5474"></a>
<a name="ln-5475"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">FirstRoofSurf</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">!Init with something in the group</span>
<a name="ln-5476"></a>        <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYdZd</span><span class="p">%</span><span class="n">SurfNum</span> <span class="o">=</span> <span class="n">SurfLoop</span>
<a name="ln-5477"></a>        <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYdZd</span><span class="p">%</span><span class="n">VertNum</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-5478"></a>        <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYdZd</span><span class="p">%</span><span class="n">Vertex</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5479"></a>
<a name="ln-5480"></a>        <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYdZu</span><span class="p">%</span><span class="n">SurfNum</span> <span class="o">=</span> <span class="n">SurfLoop</span>
<a name="ln-5481"></a>        <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYdZu</span><span class="p">%</span><span class="n">VertNum</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-5482"></a>        <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYdZu</span><span class="p">%</span><span class="n">Vertex</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5483"></a>
<a name="ln-5484"></a>        <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYuZd</span><span class="p">%</span><span class="n">SurfNum</span> <span class="o">=</span> <span class="n">SurfLoop</span>
<a name="ln-5485"></a>        <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYuZd</span><span class="p">%</span><span class="n">VertNum</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-5486"></a>        <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYuZd</span><span class="p">%</span><span class="n">Vertex</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5487"></a>
<a name="ln-5488"></a>        <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYuZu</span><span class="p">%</span><span class="n">SurfNum</span> <span class="o">=</span> <span class="n">SurfLoop</span>
<a name="ln-5489"></a>        <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYuZu</span><span class="p">%</span><span class="n">VertNum</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-5490"></a>        <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYuZu</span><span class="p">%</span><span class="n">Vertex</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5491"></a>
<a name="ln-5492"></a>        <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYdZd</span><span class="p">%</span><span class="n">SurfNum</span> <span class="o">=</span> <span class="n">SurfLoop</span>
<a name="ln-5493"></a>        <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYdZd</span><span class="p">%</span><span class="n">VertNum</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-5494"></a>        <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYdZd</span><span class="p">%</span><span class="n">Vertex</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5495"></a>
<a name="ln-5496"></a>        <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYuZd</span><span class="p">%</span><span class="n">SurfNum</span> <span class="o">=</span> <span class="n">SurfLoop</span>
<a name="ln-5497"></a>        <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYuZd</span><span class="p">%</span><span class="n">VertNum</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-5498"></a>        <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYuZd</span><span class="p">%</span><span class="n">Vertex</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5499"></a>
<a name="ln-5500"></a>        <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYdZu</span><span class="p">%</span><span class="n">SurfNum</span> <span class="o">=</span> <span class="n">SurfLoop</span>
<a name="ln-5501"></a>        <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYdZu</span><span class="p">%</span><span class="n">VertNum</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-5502"></a>        <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYdZu</span><span class="p">%</span><span class="n">Vertex</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5503"></a>
<a name="ln-5504"></a>        <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYuZu</span><span class="p">%</span><span class="n">SurfNum</span> <span class="o">=</span> <span class="n">SurfLoop</span>
<a name="ln-5505"></a>        <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYuZu</span><span class="p">%</span><span class="n">VertNum</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-5506"></a>        <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYuZu</span><span class="p">%</span><span class="n">Vertex</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5507"></a>
<a name="ln-5508"></a>        <span class="n">FirstRoofSurf</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5509"></a>      <span class="n">ENDIF</span>
<a name="ln-5510"></a>      <span class="c">! treat as part of roof group</span>
<a name="ln-5511"></a>      <span class="n">RoofGeo</span><span class="p">%</span><span class="n">Area</span> <span class="o">=</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">Area</span> <span class="o">+</span> <span class="n">thisArea</span>
<a name="ln-5512"></a>      <span class="k">DO </span><span class="n">VertLoop</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-5513"></a>
<a name="ln-5514"></a>        <span class="c">!1 low x, low y, low z</span>
<a name="ln-5515"></a>        <span class="k">IF</span>  <span class="p">(</span>     <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">VertLoop</span><span class="p">)%</span><span class="n">X</span> <span class="o">&lt;=</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYdZd</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">X</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5516"></a>            <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">VertLoop</span><span class="p">)%</span><span class="n">Y</span> <span class="o">&lt;=</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYdZd</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Y</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5517"></a>            <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">VertLoop</span><span class="p">)%</span><span class="n">Z</span> <span class="o">&lt;=</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYdZd</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5518"></a>            <span class="c">!this point is more toward this bound</span>
<a name="ln-5519"></a>            <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYdZd</span><span class="p">%</span><span class="n">SurfNum</span> <span class="o">=</span> <span class="n">SurfLoop</span>
<a name="ln-5520"></a>            <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYdZd</span><span class="p">%</span><span class="n">VertNum</span> <span class="o">=</span> <span class="n">VertLoop</span>
<a name="ln-5521"></a>            <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYdZd</span><span class="p">%</span><span class="n">Vertex</span>  <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">VertLoop</span><span class="p">)</span>
<a name="ln-5522"></a>            <span class="n">RoofBoundZvals</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>      <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">VertLoop</span><span class="p">)%</span><span class="n">Z</span>
<a name="ln-5523"></a>        <span class="n">ENDIF</span>
<a name="ln-5524"></a>
<a name="ln-5525"></a>        <span class="c">! 2 low x, low y, hi z</span>
<a name="ln-5526"></a>        <span class="k">IF</span>  <span class="p">(</span>     <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">VertLoop</span><span class="p">)%</span><span class="n">X</span> <span class="o">&lt;=</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYdZu</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">X</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5527"></a>            <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">VertLoop</span><span class="p">)%</span><span class="n">Y</span> <span class="o">&lt;=</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYdZu</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Y</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5528"></a>            <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">VertLoop</span><span class="p">)%</span><span class="n">Z</span> <span class="o">&gt;=</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYdZu</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5529"></a>            <span class="c">!this point is more toward this bound</span>
<a name="ln-5530"></a>            <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYdZu</span><span class="p">%</span><span class="n">SurfNum</span> <span class="o">=</span> <span class="n">SurfLoop</span>
<a name="ln-5531"></a>            <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYdZu</span><span class="p">%</span><span class="n">VertNum</span> <span class="o">=</span> <span class="n">VertLoop</span>
<a name="ln-5532"></a>            <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYdZu</span><span class="p">%</span><span class="n">Vertex</span>  <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">VertLoop</span><span class="p">)</span>
<a name="ln-5533"></a>            <span class="n">RoofBoundZvals</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>      <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">VertLoop</span><span class="p">)%</span><span class="n">Z</span>
<a name="ln-5534"></a>        <span class="n">ENDIF</span>
<a name="ln-5535"></a>
<a name="ln-5536"></a>        <span class="c">! 3 low x, hi y, low z</span>
<a name="ln-5537"></a>        <span class="k">IF</span>  <span class="p">(</span>     <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">VertLoop</span><span class="p">)%</span><span class="n">X</span> <span class="o">&lt;=</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYuZd</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">X</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5538"></a>            <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">VertLoop</span><span class="p">)%</span><span class="n">Y</span> <span class="o">&gt;=</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYuZd</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Y</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5539"></a>            <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">VertLoop</span><span class="p">)%</span><span class="n">Z</span> <span class="o">&lt;=</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYuZd</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5540"></a>            <span class="c">!this point is more toward this bound</span>
<a name="ln-5541"></a>            <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYuZd</span><span class="p">%</span><span class="n">SurfNum</span> <span class="o">=</span> <span class="n">SurfLoop</span>
<a name="ln-5542"></a>            <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYuZd</span><span class="p">%</span><span class="n">VertNum</span> <span class="o">=</span> <span class="n">VertLoop</span>
<a name="ln-5543"></a>            <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYuZd</span><span class="p">%</span><span class="n">Vertex</span>  <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">VertLoop</span><span class="p">)</span>
<a name="ln-5544"></a>            <span class="n">RoofBoundZvals</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>      <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">VertLoop</span><span class="p">)%</span><span class="n">Z</span>
<a name="ln-5545"></a>        <span class="n">ENDIF</span>
<a name="ln-5546"></a>
<a name="ln-5547"></a>        <span class="c">! 4 low x, hi y, hi z</span>
<a name="ln-5548"></a>        <span class="k">IF</span>  <span class="p">(</span>     <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">VertLoop</span><span class="p">)%</span><span class="n">X</span> <span class="o">&lt;=</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYuZu</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">X</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5549"></a>            <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">VertLoop</span><span class="p">)%</span><span class="n">Y</span> <span class="o">&gt;=</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYuZu</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Y</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5550"></a>            <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">VertLoop</span><span class="p">)%</span><span class="n">Z</span> <span class="o">&gt;=</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYuZu</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5551"></a>            <span class="c">!this point is more toward this bound</span>
<a name="ln-5552"></a>            <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYuZu</span><span class="p">%</span><span class="n">SurfNum</span> <span class="o">=</span> <span class="n">SurfLoop</span>
<a name="ln-5553"></a>            <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYuZu</span><span class="p">%</span><span class="n">VertNum</span> <span class="o">=</span> <span class="n">VertLoop</span>
<a name="ln-5554"></a>            <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYuZu</span><span class="p">%</span><span class="n">Vertex</span>  <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">VertLoop</span><span class="p">)</span>
<a name="ln-5555"></a>            <span class="n">RoofBoundZvals</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>      <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">VertLoop</span><span class="p">)%</span><span class="n">Z</span>
<a name="ln-5556"></a>        <span class="n">ENDIF</span>
<a name="ln-5557"></a>
<a name="ln-5558"></a>        <span class="c">! 5 hi x, low y, low z</span>
<a name="ln-5559"></a>        <span class="k">IF</span>  <span class="p">(</span>     <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">VertLoop</span><span class="p">)%</span><span class="n">X</span> <span class="o">&gt;=</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYdZd</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">X</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5560"></a>            <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">VertLoop</span><span class="p">)%</span><span class="n">Y</span> <span class="o">&lt;=</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYdZd</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Y</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5561"></a>            <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">VertLoop</span><span class="p">)%</span><span class="n">Z</span> <span class="o">&lt;=</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYdZd</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5562"></a>            <span class="c">!this point is more toward this bound</span>
<a name="ln-5563"></a>            <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYdZd</span><span class="p">%</span><span class="n">SurfNum</span> <span class="o">=</span> <span class="n">SurfLoop</span>
<a name="ln-5564"></a>            <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYdZd</span><span class="p">%</span><span class="n">VertNum</span> <span class="o">=</span> <span class="n">VertLoop</span>
<a name="ln-5565"></a>            <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYdZd</span><span class="p">%</span><span class="n">Vertex</span>  <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">VertLoop</span><span class="p">)</span>
<a name="ln-5566"></a>            <span class="n">RoofBoundZvals</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>      <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">VertLoop</span><span class="p">)%</span><span class="n">Z</span>
<a name="ln-5567"></a>        <span class="n">ENDIF</span>
<a name="ln-5568"></a>
<a name="ln-5569"></a>        <span class="c">! 6 hi x, hi y, low z</span>
<a name="ln-5570"></a>        <span class="k">IF</span>  <span class="p">(</span>     <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">VertLoop</span><span class="p">)%</span><span class="n">X</span> <span class="o">&gt;=</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYuZd</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">X</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5571"></a>            <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">VertLoop</span><span class="p">)%</span><span class="n">Y</span> <span class="o">&gt;=</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYuZd</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Y</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5572"></a>            <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">VertLoop</span><span class="p">)%</span><span class="n">Z</span> <span class="o">&lt;=</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYuZd</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5573"></a>            <span class="c">!this point is more toward this bound</span>
<a name="ln-5574"></a>            <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYuZd</span><span class="p">%</span><span class="n">SurfNum</span> <span class="o">=</span> <span class="n">SurfLoop</span>
<a name="ln-5575"></a>            <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYuZd</span><span class="p">%</span><span class="n">VertNum</span> <span class="o">=</span> <span class="n">VertLoop</span>
<a name="ln-5576"></a>            <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYuZd</span><span class="p">%</span><span class="n">Vertex</span>  <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">VertLoop</span><span class="p">)</span>
<a name="ln-5577"></a>            <span class="n">RoofBoundZvals</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>      <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">VertLoop</span><span class="p">)%</span><span class="n">Z</span>
<a name="ln-5578"></a>        <span class="n">ENDIF</span>
<a name="ln-5579"></a>
<a name="ln-5580"></a>        <span class="c">! 7 hi x, low y, hi z</span>
<a name="ln-5581"></a>        <span class="k">IF</span>  <span class="p">(</span>     <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">VertLoop</span><span class="p">)%</span><span class="n">X</span> <span class="o">&gt;=</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYdZu</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">X</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5582"></a>            <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">VertLoop</span><span class="p">)%</span><span class="n">Y</span> <span class="o">&lt;=</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYdZu</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Y</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5583"></a>            <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">VertLoop</span><span class="p">)%</span><span class="n">Z</span> <span class="o">&gt;=</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYdZu</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5584"></a>            <span class="c">!this point is more toward this bound</span>
<a name="ln-5585"></a>            <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYdZu</span><span class="p">%</span><span class="n">SurfNum</span> <span class="o">=</span> <span class="n">SurfLoop</span>
<a name="ln-5586"></a>            <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYdZu</span><span class="p">%</span><span class="n">VertNum</span> <span class="o">=</span> <span class="n">VertLoop</span>
<a name="ln-5587"></a>            <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYdZu</span><span class="p">%</span><span class="n">Vertex</span>  <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">VertLoop</span><span class="p">)</span>
<a name="ln-5588"></a>            <span class="n">RoofBoundZvals</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>      <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">VertLoop</span><span class="p">)%</span><span class="n">Z</span>
<a name="ln-5589"></a>        <span class="n">ENDIF</span>
<a name="ln-5590"></a>
<a name="ln-5591"></a>        <span class="c">! 8 hi x, hi y, hi z</span>
<a name="ln-5592"></a>        <span class="k">IF</span>  <span class="p">(</span>     <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">VertLoop</span><span class="p">)%</span><span class="n">X</span> <span class="o">&gt;=</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYuZu</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">X</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5593"></a>            <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">VertLoop</span><span class="p">)%</span><span class="n">Y</span> <span class="o">&gt;=</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYuZu</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Y</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5594"></a>            <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">VertLoop</span><span class="p">)%</span><span class="n">Z</span> <span class="o">&gt;=</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYuZu</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5595"></a>            <span class="c">!this point is more toward this bound</span>
<a name="ln-5596"></a>            <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYuZu</span><span class="p">%</span><span class="n">SurfNum</span> <span class="o">=</span> <span class="n">SurfLoop</span>
<a name="ln-5597"></a>            <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYuZu</span><span class="p">%</span><span class="n">VertNum</span> <span class="o">=</span> <span class="n">VertLoop</span>
<a name="ln-5598"></a>            <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYuZu</span><span class="p">%</span><span class="n">Vertex</span>  <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">VertLoop</span><span class="p">)</span>
<a name="ln-5599"></a>            <span class="n">RoofBoundZvals</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>      <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">VertLoop</span><span class="p">)%</span><span class="n">Z</span>
<a name="ln-5600"></a>        <span class="n">ENDIF</span>
<a name="ln-5601"></a>
<a name="ln-5602"></a>      <span class="n">ENDDO</span>
<a name="ln-5603"></a>    <span class="n">ENDIF</span>
<a name="ln-5604"></a>  <span class="n">ENDDO</span> <span class="c">! fist loop over surfaces for outside face params</span>
<a name="ln-5605"></a>
<a name="ln-5606"></a>  <span class="n">NorthFacade</span><span class="p">%</span><span class="n">Perimeter</span>     <span class="o">=</span> <span class="mf">2.d0</span> <span class="o">*</span> <span class="p">(((</span><span class="n">NorthFacade</span><span class="p">%</span><span class="n">Xmax</span> <span class="o">-</span> <span class="n">NorthFacade</span><span class="p">%</span><span class="n">Xmin</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>   <span class="p">&amp;</span>
<a name="ln-5607"></a>                                     <span class="o">+</span> <span class="p">(</span><span class="n">NorthFacade</span><span class="p">%</span><span class="n">Ymax</span> <span class="o">-</span> <span class="n">NorthFacade</span><span class="p">%</span><span class="n">Ymin</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5d0</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5608"></a>                              <span class="mf">2.d0</span> <span class="o">*</span>   <span class="p">(</span><span class="n">NorthFacade</span><span class="p">%</span><span class="n">Zmax</span> <span class="o">-</span> <span class="n">NorthFacade</span><span class="p">%</span><span class="n">Zmin</span><span class="p">)</span>
<a name="ln-5609"></a>  <span class="n">NorthFacade</span><span class="p">%</span><span class="n">Height</span>        <span class="o">=</span> <span class="n">NorthFacade</span><span class="p">%</span><span class="n">Zmax</span> <span class="o">-</span> <span class="n">NorthFacade</span><span class="p">%</span><span class="n">Zmin</span>
<a name="ln-5610"></a>
<a name="ln-5611"></a>  <span class="n">NorthEastFacade</span><span class="p">%</span><span class="n">Perimeter</span> <span class="o">=</span> <span class="mf">2.d0</span> <span class="o">*</span> <span class="p">(((</span><span class="n">NorthEastFacade</span><span class="p">%</span><span class="n">Xmax</span> <span class="o">-</span> <span class="n">NorthEastFacade</span><span class="p">%</span><span class="n">Xmin</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>   <span class="p">&amp;</span>
<a name="ln-5612"></a>                                     <span class="o">+</span> <span class="p">(</span><span class="n">NorthEastFacade</span><span class="p">%</span><span class="n">Ymax</span> <span class="o">-</span> <span class="n">NorthEastFacade</span><span class="p">%</span><span class="n">Ymin</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5d0</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5613"></a>                              <span class="mf">2.d0</span> <span class="o">*</span>   <span class="p">(</span><span class="n">NorthEastFacade</span><span class="p">%</span><span class="n">Zmax</span> <span class="o">-</span> <span class="n">NorthEastFacade</span><span class="p">%</span><span class="n">Zmin</span><span class="p">)</span>
<a name="ln-5614"></a>  <span class="n">NorthEastFacade</span><span class="p">%</span><span class="n">Height</span>    <span class="o">=</span> <span class="n">NorthEastFacade</span><span class="p">%</span><span class="n">Zmax</span> <span class="o">-</span> <span class="n">NorthEastFacade</span><span class="p">%</span><span class="n">Zmin</span>
<a name="ln-5615"></a>
<a name="ln-5616"></a>  <span class="n">EastFacade</span><span class="p">%</span><span class="n">Perimeter</span>      <span class="o">=</span> <span class="mf">2.d0</span> <span class="o">*</span> <span class="p">(((</span><span class="n">EastFacade</span><span class="p">%</span><span class="n">Xmax</span> <span class="o">-</span> <span class="n">EastFacade</span><span class="p">%</span><span class="n">Xmin</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>   <span class="p">&amp;</span>
<a name="ln-5617"></a>                                     <span class="o">+</span> <span class="p">(</span><span class="n">EastFacade</span><span class="p">%</span><span class="n">Ymax</span> <span class="o">-</span> <span class="n">EastFacade</span><span class="p">%</span><span class="n">Ymin</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5d0</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5618"></a>                              <span class="mf">2.d0</span> <span class="o">*</span>   <span class="p">(</span><span class="n">EastFacade</span><span class="p">%</span><span class="n">Zmax</span> <span class="o">-</span> <span class="n">EastFacade</span><span class="p">%</span><span class="n">Zmin</span><span class="p">)</span>
<a name="ln-5619"></a>  <span class="n">EastFacade</span><span class="p">%</span><span class="n">Height</span>         <span class="o">=</span> <span class="n">EastFacade</span><span class="p">%</span><span class="n">Zmax</span> <span class="o">-</span> <span class="n">EastFacade</span><span class="p">%</span><span class="n">Zmin</span>
<a name="ln-5620"></a>
<a name="ln-5621"></a>  <span class="n">SouthEastFacade</span><span class="p">%</span><span class="n">Perimeter</span> <span class="o">=</span> <span class="mf">2.d0</span> <span class="o">*</span> <span class="p">(((</span><span class="n">SouthEastFacade</span><span class="p">%</span><span class="n">Xmax</span> <span class="o">-</span> <span class="n">SouthEastFacade</span><span class="p">%</span><span class="n">Xmin</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>   <span class="p">&amp;</span>
<a name="ln-5622"></a>                                     <span class="o">+</span> <span class="p">(</span><span class="n">SouthEastFacade</span><span class="p">%</span><span class="n">Ymax</span> <span class="o">-</span> <span class="n">SouthEastFacade</span><span class="p">%</span><span class="n">Ymin</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5d0</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5623"></a>                              <span class="mf">2.d0</span> <span class="o">*</span>   <span class="p">(</span><span class="n">SouthEastFacade</span><span class="p">%</span><span class="n">Zmax</span> <span class="o">-</span> <span class="n">SouthEastFacade</span><span class="p">%</span><span class="n">Zmin</span><span class="p">)</span>
<a name="ln-5624"></a>  <span class="n">SouthEastFacade</span><span class="p">%</span><span class="n">Height</span>    <span class="o">=</span> <span class="n">SouthEastFacade</span><span class="p">%</span><span class="n">Zmax</span> <span class="o">-</span> <span class="n">SouthEastFacade</span><span class="p">%</span><span class="n">Zmin</span>
<a name="ln-5625"></a>
<a name="ln-5626"></a>  <span class="n">SouthFacade</span><span class="p">%</span><span class="n">Perimeter</span>     <span class="o">=</span> <span class="mf">2.d0</span> <span class="o">*</span> <span class="p">(((</span><span class="n">SouthFacade</span><span class="p">%</span><span class="n">Xmax</span> <span class="o">-</span> <span class="n">SouthFacade</span><span class="p">%</span><span class="n">Xmin</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>   <span class="p">&amp;</span>
<a name="ln-5627"></a>                                     <span class="o">+</span> <span class="p">(</span><span class="n">SouthFacade</span><span class="p">%</span><span class="n">Ymax</span> <span class="o">-</span> <span class="n">SouthFacade</span><span class="p">%</span><span class="n">Ymin</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5d0</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5628"></a>                              <span class="mf">2.d0</span> <span class="o">*</span>   <span class="p">(</span><span class="n">SouthFacade</span><span class="p">%</span><span class="n">Zmax</span> <span class="o">-</span> <span class="n">SouthFacade</span><span class="p">%</span><span class="n">Zmin</span><span class="p">)</span>
<a name="ln-5629"></a>  <span class="n">SouthFacade</span><span class="p">%</span><span class="n">Height</span>        <span class="o">=</span> <span class="n">SouthFacade</span><span class="p">%</span><span class="n">Zmax</span> <span class="o">-</span> <span class="n">SouthFacade</span><span class="p">%</span><span class="n">Zmin</span>
<a name="ln-5630"></a>
<a name="ln-5631"></a>  <span class="n">SouthWestFacade</span><span class="p">%</span><span class="n">Perimeter</span> <span class="o">=</span> <span class="mf">2.d0</span> <span class="o">*</span> <span class="p">(((</span><span class="n">SouthWestFacade</span><span class="p">%</span><span class="n">Xmax</span> <span class="o">-</span> <span class="n">SouthWestFacade</span><span class="p">%</span><span class="n">Xmin</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>   <span class="p">&amp;</span>
<a name="ln-5632"></a>                                     <span class="o">+</span> <span class="p">(</span><span class="n">SouthWestFacade</span><span class="p">%</span><span class="n">Ymax</span> <span class="o">-</span> <span class="n">SouthWestFacade</span><span class="p">%</span><span class="n">Ymin</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5d0</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5633"></a>                              <span class="mf">2.d0</span> <span class="o">*</span>   <span class="p">(</span><span class="n">SouthWestFacade</span><span class="p">%</span><span class="n">Zmax</span> <span class="o">-</span> <span class="n">SouthWestFacade</span><span class="p">%</span><span class="n">Zmin</span><span class="p">)</span>
<a name="ln-5634"></a>  <span class="n">SouthWestFacade</span><span class="p">%</span><span class="n">Height</span>    <span class="o">=</span> <span class="n">SouthWestFacade</span><span class="p">%</span><span class="n">Zmax</span> <span class="o">-</span> <span class="n">SouthWestFacade</span><span class="p">%</span><span class="n">Zmin</span>
<a name="ln-5635"></a>
<a name="ln-5636"></a>  <span class="n">WestFacade</span><span class="p">%</span><span class="n">Perimeter</span>      <span class="o">=</span> <span class="mf">2.d0</span> <span class="o">*</span> <span class="p">(((</span><span class="n">WestFacade</span><span class="p">%</span><span class="n">Xmax</span> <span class="o">-</span> <span class="n">WestFacade</span><span class="p">%</span><span class="n">Xmin</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>   <span class="p">&amp;</span>
<a name="ln-5637"></a>                                     <span class="o">+</span> <span class="p">(</span><span class="n">WestFacade</span><span class="p">%</span><span class="n">Ymax</span> <span class="o">-</span> <span class="n">WestFacade</span><span class="p">%</span><span class="n">Ymin</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5d0</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5638"></a>                              <span class="mf">2.d0</span> <span class="o">*</span>   <span class="p">(</span><span class="n">WestFacade</span><span class="p">%</span><span class="n">Zmax</span> <span class="o">-</span> <span class="n">WestFacade</span><span class="p">%</span><span class="n">Zmin</span><span class="p">)</span>
<a name="ln-5639"></a>  <span class="n">WestFacade</span><span class="p">%</span><span class="n">Height</span>         <span class="o">=</span> <span class="n">WestFacade</span><span class="p">%</span><span class="n">Zmax</span> <span class="o">-</span> <span class="n">WestFacade</span><span class="p">%</span><span class="n">Zmin</span>
<a name="ln-5640"></a>
<a name="ln-5641"></a>  <span class="n">NorthWestFacade</span><span class="p">%</span><span class="n">Perimeter</span> <span class="o">=</span> <span class="mf">2.d0</span> <span class="o">*</span> <span class="p">(((</span><span class="n">NorthWestFacade</span><span class="p">%</span><span class="n">Xmax</span> <span class="o">-</span> <span class="n">NorthWestFacade</span><span class="p">%</span><span class="n">Xmin</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>   <span class="p">&amp;</span>
<a name="ln-5642"></a>                                     <span class="o">+</span> <span class="p">(</span><span class="n">NorthWestFacade</span><span class="p">%</span><span class="n">Ymax</span> <span class="o">-</span> <span class="n">NorthWestFacade</span><span class="p">%</span><span class="n">Ymin</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5d0</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5643"></a>                              <span class="mf">2.d0</span> <span class="o">*</span>   <span class="p">(</span><span class="n">NorthWestFacade</span><span class="p">%</span><span class="n">Zmax</span> <span class="o">-</span> <span class="n">NorthWestFacade</span><span class="p">%</span><span class="n">Zmin</span><span class="p">)</span>
<a name="ln-5644"></a>  <span class="n">NorthWestFacade</span><span class="p">%</span><span class="n">Height</span>    <span class="o">=</span> <span class="n">NorthWestFacade</span><span class="p">%</span><span class="n">Zmax</span> <span class="o">-</span> <span class="n">NorthWestFacade</span><span class="p">%</span><span class="n">Zmin</span>
<a name="ln-5645"></a>
<a name="ln-5646"></a>
<a name="ln-5647"></a>  <span class="c">!now model roof perimeter</span>
<a name="ln-5648"></a>  <span class="c">! move around bounding boxes side walls and find the longest of the four distances</span>
<a name="ln-5649"></a>  <span class="c">! Side A: Y low -- uses XdYdZd, XdYdZu, XuYdZd, XuYdZu</span>
<a name="ln-5650"></a>  <span class="n">TestDist</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Distance</span><span class="p">(</span><span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYdZd</span><span class="p">%</span><span class="n">Vertex</span><span class="p">,</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYdZd</span><span class="p">%</span><span class="n">Vertex</span><span class="p">)</span>
<a name="ln-5651"></a>  <span class="n">TestDist</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">Distance</span><span class="p">(</span><span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYdZd</span><span class="p">%</span><span class="n">Vertex</span><span class="p">,</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYdZu</span><span class="p">%</span><span class="n">Vertex</span><span class="p">)</span>
<a name="ln-5652"></a>  <span class="n">TestDist</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">Distance</span><span class="p">(</span><span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYdZu</span><span class="p">%</span><span class="n">Vertex</span><span class="p">,</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYdZd</span><span class="p">%</span><span class="n">Vertex</span><span class="p">)</span>
<a name="ln-5653"></a>  <span class="n">TestDist</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">Distance</span><span class="p">(</span><span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYdZu</span><span class="p">%</span><span class="n">Vertex</span><span class="p">,</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYdZu</span><span class="p">%</span><span class="n">Vertex</span><span class="p">)</span>
<a name="ln-5654"></a>  <span class="n">SideALength</span> <span class="o">=</span> <span class="nb">MAXVAL</span><span class="p">(</span><span class="n">TestDist</span><span class="p">)</span>
<a name="ln-5655"></a>
<a name="ln-5656"></a>  <span class="c">! Side B: X Hi -- uses XuYdZd, XuYuZd, XuYdZu, XuYuZu</span>
<a name="ln-5657"></a>  <span class="n">TestDist</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Distance</span><span class="p">(</span><span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYdZd</span><span class="p">%</span><span class="n">Vertex</span><span class="p">,</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYuZd</span><span class="p">%</span><span class="n">Vertex</span><span class="p">)</span>
<a name="ln-5658"></a>  <span class="n">TestDist</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">Distance</span><span class="p">(</span><span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYdZd</span><span class="p">%</span><span class="n">Vertex</span><span class="p">,</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYuZu</span><span class="p">%</span><span class="n">Vertex</span><span class="p">)</span>
<a name="ln-5659"></a>  <span class="n">TestDist</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">Distance</span><span class="p">(</span><span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYdZu</span><span class="p">%</span><span class="n">Vertex</span><span class="p">,</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYuZd</span><span class="p">%</span><span class="n">Vertex</span><span class="p">)</span>
<a name="ln-5660"></a>  <span class="n">TestDist</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">Distance</span><span class="p">(</span><span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYdZu</span><span class="p">%</span><span class="n">Vertex</span><span class="p">,</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYuZu</span><span class="p">%</span><span class="n">Vertex</span><span class="p">)</span>
<a name="ln-5661"></a>  <span class="n">SideBLength</span> <span class="o">=</span> <span class="nb">MAXVAL</span><span class="p">(</span><span class="n">TestDist</span><span class="p">)</span>
<a name="ln-5662"></a>
<a name="ln-5663"></a>  <span class="c">! Side C: Y Hi -- uses XdYuZd, XdYuZu, XuYuZd, XuYuZu</span>
<a name="ln-5664"></a>  <span class="n">TestDist</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Distance</span><span class="p">(</span><span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYuZd</span><span class="p">%</span><span class="n">Vertex</span><span class="p">,</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYuZd</span><span class="p">%</span><span class="n">Vertex</span><span class="p">)</span>
<a name="ln-5665"></a>  <span class="n">TestDist</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">Distance</span><span class="p">(</span><span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYuZd</span><span class="p">%</span><span class="n">Vertex</span><span class="p">,</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYuZu</span><span class="p">%</span><span class="n">Vertex</span><span class="p">)</span>
<a name="ln-5666"></a>  <span class="n">TestDist</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">Distance</span><span class="p">(</span><span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYuZu</span><span class="p">%</span><span class="n">Vertex</span><span class="p">,</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYuZd</span><span class="p">%</span><span class="n">Vertex</span><span class="p">)</span>
<a name="ln-5667"></a>  <span class="n">TestDist</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">Distance</span><span class="p">(</span><span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYuZu</span><span class="p">%</span><span class="n">Vertex</span><span class="p">,</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYuZu</span><span class="p">%</span><span class="n">Vertex</span><span class="p">)</span>
<a name="ln-5668"></a>  <span class="n">SideCLength</span> <span class="o">=</span> <span class="nb">MAXVAL</span><span class="p">(</span><span class="n">TestDist</span><span class="p">)</span>
<a name="ln-5669"></a>
<a name="ln-5670"></a>  <span class="c">! Side D: X Lo Hi -- uses XdYuZd, XdYuZu, XuYuZd, XuYuZu</span>
<a name="ln-5671"></a>  <span class="n">TestDist</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Distance</span><span class="p">(</span><span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYuZd</span><span class="p">%</span><span class="n">Vertex</span><span class="p">,</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYuZd</span><span class="p">%</span><span class="n">Vertex</span><span class="p">)</span>
<a name="ln-5672"></a>  <span class="n">TestDist</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">Distance</span><span class="p">(</span><span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYuZd</span><span class="p">%</span><span class="n">Vertex</span><span class="p">,</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYuZu</span><span class="p">%</span><span class="n">Vertex</span><span class="p">)</span>
<a name="ln-5673"></a>  <span class="n">TestDist</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">Distance</span><span class="p">(</span><span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYuZu</span><span class="p">%</span><span class="n">Vertex</span><span class="p">,</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYuZd</span><span class="p">%</span><span class="n">Vertex</span><span class="p">)</span>
<a name="ln-5674"></a>  <span class="n">TestDist</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">Distance</span><span class="p">(</span><span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYuZu</span><span class="p">%</span><span class="n">Vertex</span><span class="p">,</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYuZu</span><span class="p">%</span><span class="n">Vertex</span><span class="p">)</span>
<a name="ln-5675"></a>  <span class="n">SideDLength</span> <span class="o">=</span> <span class="nb">MAXVAL</span><span class="p">(</span><span class="n">TestDist</span><span class="p">)</span>
<a name="ln-5676"></a>
<a name="ln-5677"></a>  <span class="n">RoofGeo</span><span class="p">%</span><span class="n">Perimeter</span>   <span class="o">=</span> <span class="n">SideALength</span> <span class="o">+</span> <span class="n">SideBLength</span> <span class="o">+</span> <span class="n">SideCLength</span> <span class="o">+</span> <span class="n">SideDLength</span>
<a name="ln-5678"></a>
<a name="ln-5679"></a>  <span class="n">RoofGeo</span><span class="p">%</span><span class="n">Height</span> <span class="o">=</span> <span class="nb">MAXVAL</span><span class="p">(</span><span class="n">RoofBoundZvals</span><span class="p">)</span> <span class="o">-</span> <span class="nb">MINVAL</span><span class="p">(</span><span class="n">RoofBoundZvals</span><span class="p">)</span>
<a name="ln-5680"></a>
<a name="ln-5681"></a>  <span class="c">! now find the longest bound face</span>
<a name="ln-5682"></a>  <span class="k">IF</span> <span class="p">(</span>       <span class="p">(</span> <span class="n">SideALength</span> <span class="o">&gt;=</span> <span class="n">SideBLength</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5683"></a>       <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span> <span class="n">SideALength</span> <span class="o">&gt;=</span> <span class="n">SideCLength</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5684"></a>       <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span> <span class="n">SideALength</span> <span class="o">&gt;=</span> <span class="n">SideDLength</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5685"></a>       <span class="c">! Side A: Y low -- uses XdYdZd, XdYdZu, XuYdZd, XuYdZu</span>
<a name="ln-5686"></a>       <span class="n">RoofGeo</span><span class="p">%</span><span class="n">BoundSurf</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYdZd</span><span class="p">%</span><span class="n">Vertex</span>
<a name="ln-5687"></a>       <span class="n">RoofGeo</span><span class="p">%</span><span class="n">BoundSurf</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYdZd</span><span class="p">%</span><span class="n">Vertex</span>
<a name="ln-5688"></a>       <span class="n">RoofGeo</span><span class="p">%</span><span class="n">BoundSurf</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYdZu</span><span class="p">%</span><span class="n">Vertex</span>
<a name="ln-5689"></a>       <span class="n">RoofGeo</span><span class="p">%</span><span class="n">BoundSurf</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYdZu</span><span class="p">%</span><span class="n">Vertex</span>
<a name="ln-5690"></a>
<a name="ln-5691"></a>  <span class="n">ELSEIF</span> <span class="p">(</span>   <span class="p">(</span> <span class="n">SideBLength</span> <span class="o">&gt;=</span> <span class="n">SideALength</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5692"></a>       <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span> <span class="n">SideBLength</span> <span class="o">&gt;=</span> <span class="n">SideCLength</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5693"></a>       <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span> <span class="n">SideBLength</span> <span class="o">&gt;=</span> <span class="n">SideDLength</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5694"></a>       <span class="c">! Side B: X Hi -- uses XuYdZd, XuYuZd, XuYdZu, XuYuZu</span>
<a name="ln-5695"></a>       <span class="n">RoofGeo</span><span class="p">%</span><span class="n">BoundSurf</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYdZd</span><span class="p">%</span><span class="n">Vertex</span>
<a name="ln-5696"></a>       <span class="n">RoofGeo</span><span class="p">%</span><span class="n">BoundSurf</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYuZd</span><span class="p">%</span><span class="n">Vertex</span>
<a name="ln-5697"></a>       <span class="n">RoofGeo</span><span class="p">%</span><span class="n">BoundSurf</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYuZu</span><span class="p">%</span><span class="n">Vertex</span>
<a name="ln-5698"></a>       <span class="n">RoofGeo</span><span class="p">%</span><span class="n">BoundSurf</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYdZu</span><span class="p">%</span><span class="n">Vertex</span>
<a name="ln-5699"></a>  <span class="n">ELSEIF</span> <span class="p">(</span>   <span class="p">(</span> <span class="n">SideCLength</span> <span class="o">&gt;=</span> <span class="n">SideALength</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5700"></a>       <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span> <span class="n">SideCLength</span> <span class="o">&gt;=</span> <span class="n">SideBLength</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5701"></a>       <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span> <span class="n">SideCLength</span> <span class="o">&gt;=</span> <span class="n">SideDLength</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5702"></a>       <span class="c">! Side C: Y Hi -- uses XdYuZd, XdYuZu, XuYuZd, XuYuZu</span>
<a name="ln-5703"></a>       <span class="n">RoofGeo</span><span class="p">%</span><span class="n">BoundSurf</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYuZd</span><span class="p">%</span><span class="n">Vertex</span>
<a name="ln-5704"></a>       <span class="n">RoofGeo</span><span class="p">%</span><span class="n">BoundSurf</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYuZd</span><span class="p">%</span><span class="n">Vertex</span>
<a name="ln-5705"></a>       <span class="n">RoofGeo</span><span class="p">%</span><span class="n">BoundSurf</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYuZu</span><span class="p">%</span><span class="n">Vertex</span>
<a name="ln-5706"></a>       <span class="n">RoofGeo</span><span class="p">%</span><span class="n">BoundSurf</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYuZu</span><span class="p">%</span><span class="n">Vertex</span>
<a name="ln-5707"></a>  <span class="n">ELSEIF</span> <span class="p">(</span>   <span class="p">(</span> <span class="n">SideDLength</span> <span class="o">&gt;=</span> <span class="n">SideALength</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5708"></a>       <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span> <span class="n">SideDLength</span> <span class="o">&gt;=</span> <span class="n">SideCLength</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5709"></a>       <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span> <span class="n">SideDLength</span> <span class="o">&gt;=</span> <span class="n">SideBLength</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5710"></a>       <span class="c">! Side D: X Lo Hi -- uses XdYuZd, XdYuZu, XuYuZd, XuYuZu</span>
<a name="ln-5711"></a>       <span class="n">RoofGeo</span><span class="p">%</span><span class="n">BoundSurf</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYuZd</span><span class="p">%</span><span class="n">Vertex</span>
<a name="ln-5712"></a>       <span class="n">RoofGeo</span><span class="p">%</span><span class="n">BoundSurf</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYuZd</span><span class="p">%</span><span class="n">Vertex</span>
<a name="ln-5713"></a>       <span class="n">RoofGeo</span><span class="p">%</span><span class="n">BoundSurf</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYuZu</span><span class="p">%</span><span class="n">Vertex</span>
<a name="ln-5714"></a>       <span class="n">RoofGeo</span><span class="p">%</span><span class="n">BoundSurf</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYuZu</span><span class="p">%</span><span class="n">Vertex</span>
<a name="ln-5715"></a>  <span class="n">ENDIF</span>
<a name="ln-5716"></a>
<a name="ln-5717"></a>  <span class="k">CALL </span><span class="n">CreateNewellAreaVector</span><span class="p">(</span><span class="n">RoofGeo</span><span class="p">%</span><span class="n">BoundSurf</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">BoundNewellAreaVec</span><span class="p">)</span>
<a name="ln-5718"></a>  <span class="n">surfacearea</span><span class="o">=</span><span class="n">VecLength</span><span class="p">(</span><span class="n">BoundNewellAreaVec</span><span class="p">)</span>
<a name="ln-5719"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">surfacearea</span> <span class="o">&gt;</span> <span class="p">.</span><span class="mi">001</span><span class="n">d0</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Roof is not flat</span>
<a name="ln-5720"></a>    <span class="k">CALL </span><span class="n">CreateNewellSurfaceNormalVector</span><span class="p">(</span><span class="n">RoofGeo</span><span class="p">%</span><span class="n">BoundSurf</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">BoundNewellVec</span><span class="p">)</span>
<a name="ln-5721"></a>    <span class="k">CALL </span><span class="n">DetermineAzimuthAndTilt</span><span class="p">(</span><span class="n">RoofGeo</span><span class="p">%</span><span class="n">BoundSurf</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">BoundAzimuth</span><span class="p">,</span> <span class="n">BoundTilt</span><span class="p">,</span> <span class="n">dummy1</span><span class="p">,</span> <span class="n">dummy2</span><span class="p">,</span> <span class="n">dummy3</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-5722"></a>       <span class="n">surfacearea</span><span class="p">,</span> <span class="n">BoundNewellVec</span><span class="p">)</span>
<a name="ln-5723"></a>    <span class="n">RoofLongAxisOutwardAzimuth</span> <span class="o">=</span> <span class="n">BoundAzimuth</span>
<a name="ln-5724"></a>  <span class="k">ELSE</span>
<a name="ln-5725"></a><span class="k">    </span><span class="n">RoofLongAxisOutwardAzimuth</span> <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! flat roofs don&#39;t really have azimuth</span>
<a name="ln-5726"></a>  <span class="n">ENDIF</span>
<a name="ln-5727"></a>
<a name="ln-5728"></a>  <span class="k">DO </span><span class="n">SurfLoop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">TotSurfaces</span>
<a name="ln-5729"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">/=</span> <span class="n">ExternalEnvironment</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-5730"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-5731"></a><span class="k">    </span><span class="n">thisAzimuth</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Azimuth</span>
<a name="ln-5732"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="mf">5.d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&lt;</span> <span class="mi">13</span><span class="mf">5.d0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5733"></a>     <span class="c">!treat as vertical wall</span>
<a name="ln-5734"></a>      <span class="k">IF</span> <span class="p">((</span><span class="n">thisAzimuth</span> <span class="o">&gt;=</span> <span class="n">NorthFacade</span><span class="p">%</span><span class="n">AzimuthRangeLow</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5735"></a>          <span class="p">(</span><span class="n">thisAzimuth</span> <span class="o">&lt;</span> <span class="n">NorthFacade</span><span class="p">%</span><span class="n">AzimuthRangeHi</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5736"></a><span class="k">        </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">OutConvFaceArea</span>      <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">NorthFacade</span><span class="p">%</span><span class="n">Area</span>     <span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">GrossArea</span><span class="p">)</span>
<a name="ln-5737"></a>        <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">OutConvFacePerimeter</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">NorthFacade</span><span class="p">%</span><span class="n">Perimeter</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Perimeter</span><span class="p">)</span>
<a name="ln-5738"></a>        <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">OutConvFaceHeight</span>    <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">NorthFacade</span><span class="p">%</span><span class="n">Height</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5739"></a>                                                   <span class="p">(</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span> <span class="o">-</span> <span class="nb">MINVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
<a name="ln-5740"></a>      <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">thisAzimuth</span> <span class="o">&gt;=</span> <span class="n">NorthEastFacade</span><span class="p">%</span><span class="n">AzimuthRangeLow</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5741"></a>              <span class="p">(</span><span class="n">thisAzimuth</span> <span class="o">&lt;</span> <span class="n">NorthEastFacade</span><span class="p">%</span><span class="n">AzimuthRangeHi</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5742"></a><span class="k">        </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">OutConvFaceArea</span>      <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">NorthEastFacade</span><span class="p">%</span><span class="n">Area</span>     <span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">GrossArea</span><span class="p">)</span>
<a name="ln-5743"></a>        <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">OutConvFacePerimeter</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">NorthEastFacade</span><span class="p">%</span><span class="n">Perimeter</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Perimeter</span><span class="p">)</span>
<a name="ln-5744"></a>        <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">OutConvFaceHeight</span>    <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">NorthEastFacade</span><span class="p">%</span><span class="n">Height</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5745"></a>                                                 <span class="p">(</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span> <span class="o">-</span> <span class="nb">MINVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
<a name="ln-5746"></a>      <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">thisAzimuth</span> <span class="o">&gt;=</span> <span class="n">EastFacade</span><span class="p">%</span><span class="n">AzimuthRangeLow</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5747"></a>              <span class="p">(</span><span class="n">thisAzimuth</span> <span class="o">&lt;</span> <span class="n">EastFacade</span><span class="p">%</span><span class="n">AzimuthRangeHi</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5748"></a><span class="k">        </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">OutConvFaceArea</span>      <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">EastFacade</span><span class="p">%</span><span class="n">Area</span>     <span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">GrossArea</span><span class="p">)</span>
<a name="ln-5749"></a>        <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">OutConvFacePerimeter</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">EastFacade</span><span class="p">%</span><span class="n">Perimeter</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Perimeter</span><span class="p">)</span>
<a name="ln-5750"></a>        <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">OutConvFaceHeight</span>    <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">EastFacade</span><span class="p">%</span><span class="n">Height</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5751"></a>                                                   <span class="p">(</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span> <span class="o">-</span> <span class="nb">MINVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
<a name="ln-5752"></a>      <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">thisAzimuth</span> <span class="o">&gt;=</span> <span class="n">SouthEastFacade</span><span class="p">%</span><span class="n">AzimuthRangeLow</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5753"></a>              <span class="p">(</span><span class="n">thisAzimuth</span> <span class="o">&lt;</span> <span class="n">SouthEastFacade</span><span class="p">%</span><span class="n">AzimuthRangeHi</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5754"></a><span class="k">        </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">OutConvFaceArea</span>      <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">SouthEastFacade</span><span class="p">%</span><span class="n">Area</span>     <span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">GrossArea</span><span class="p">)</span>
<a name="ln-5755"></a>        <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">OutConvFacePerimeter</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">SouthEastFacade</span><span class="p">%</span><span class="n">Perimeter</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Perimeter</span><span class="p">)</span>
<a name="ln-5756"></a>        <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">OutConvFaceHeight</span>    <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">SouthEastFacade</span><span class="p">%</span><span class="n">Height</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5757"></a>                                                   <span class="p">(</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span> <span class="o">-</span> <span class="nb">MINVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
<a name="ln-5758"></a>      <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">thisAzimuth</span> <span class="o">&gt;=</span> <span class="n">SouthFacade</span><span class="p">%</span><span class="n">AzimuthRangeLow</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5759"></a>              <span class="p">(</span><span class="n">thisAzimuth</span> <span class="o">&lt;</span> <span class="n">SouthFacade</span><span class="p">%</span><span class="n">AzimuthRangeHi</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5760"></a><span class="k">        </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">OutConvFaceArea</span>      <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">SouthFacade</span><span class="p">%</span><span class="n">Area</span>     <span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">GrossArea</span><span class="p">)</span>
<a name="ln-5761"></a>        <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">OutConvFacePerimeter</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">SouthFacade</span><span class="p">%</span><span class="n">Perimeter</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Perimeter</span><span class="p">)</span>
<a name="ln-5762"></a>        <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">OutConvFaceHeight</span>    <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">SouthFacade</span><span class="p">%</span><span class="n">Height</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5763"></a>                                                   <span class="p">(</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span> <span class="o">-</span> <span class="nb">MINVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
<a name="ln-5764"></a>      <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">thisAzimuth</span> <span class="o">&gt;=</span> <span class="n">SouthWestFacade</span><span class="p">%</span><span class="n">AzimuthRangeLow</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5765"></a>              <span class="p">(</span><span class="n">thisAzimuth</span> <span class="o">&lt;</span> <span class="n">SouthWestFacade</span><span class="p">%</span><span class="n">AzimuthRangeHi</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5766"></a><span class="k">        </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">OutConvFaceArea</span>      <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">SouthWestFacade</span><span class="p">%</span><span class="n">Area</span>     <span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">GrossArea</span><span class="p">)</span>
<a name="ln-5767"></a>        <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">OutConvFacePerimeter</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">SouthWestFacade</span><span class="p">%</span><span class="n">Perimeter</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Perimeter</span><span class="p">)</span>
<a name="ln-5768"></a>        <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">OutConvFaceHeight</span>    <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">SouthWestFacade</span><span class="p">%</span><span class="n">Height</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5769"></a>                                                   <span class="p">(</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span> <span class="o">-</span> <span class="nb">MINVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
<a name="ln-5770"></a>      <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">thisAzimuth</span> <span class="o">&gt;=</span> <span class="n">WestFacade</span><span class="p">%</span><span class="n">AzimuthRangeLow</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5771"></a>              <span class="p">(</span><span class="n">thisAzimuth</span> <span class="o">&lt;</span> <span class="n">WestFacade</span><span class="p">%</span><span class="n">AzimuthRangeHi</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5772"></a><span class="k">        </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">OutConvFaceArea</span>      <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">WestFacade</span><span class="p">%</span><span class="n">Area</span>      <span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">GrossArea</span><span class="p">)</span>
<a name="ln-5773"></a>        <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">OutConvFacePerimeter</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">WestFacade</span><span class="p">%</span><span class="n">Perimeter</span> <span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Perimeter</span><span class="p">)</span>
<a name="ln-5774"></a>        <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">OutConvFaceHeight</span>    <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">WestFacade</span><span class="p">%</span><span class="n">Height</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5775"></a>                                                   <span class="p">(</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span> <span class="o">-</span> <span class="nb">MINVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
<a name="ln-5776"></a>      <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">thisAzimuth</span> <span class="o">&gt;=</span> <span class="n">NorthWestFacade</span><span class="p">%</span><span class="n">AzimuthRangeLow</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5777"></a>              <span class="p">(</span><span class="n">thisAzimuth</span> <span class="o">&lt;</span> <span class="n">NorthWestFacade</span><span class="p">%</span><span class="n">AzimuthRangeHi</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5778"></a><span class="k">        </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">OutConvFaceArea</span>      <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">NorthWestFacade</span><span class="p">%</span><span class="n">Area</span>      <span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">GrossArea</span><span class="p">)</span>
<a name="ln-5779"></a>        <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">OutConvFacePerimeter</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">NorthWestFacade</span><span class="p">%</span><span class="n">Perimeter</span> <span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Perimeter</span><span class="p">)</span>
<a name="ln-5780"></a>        <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">OutConvFaceHeight</span>    <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">NorthWestFacade</span><span class="p">%</span><span class="n">Height</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5781"></a>                                                   <span class="p">(</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span> <span class="o">-</span> <span class="nb">MINVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
<a name="ln-5782"></a>      <span class="n">ENDIF</span>
<a name="ln-5783"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="mf">5.0d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! assume part of roof</span>
<a name="ln-5784"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">OutConvFaceArea</span>      <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">RoofGeo</span><span class="p">%</span><span class="n">Area</span> <span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">GrossArea</span><span class="p">)</span>
<a name="ln-5785"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">OutConvFacePerimeter</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">RoofGeo</span><span class="p">%</span><span class="n">Perimeter</span> <span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Perimeter</span><span class="p">)</span>
<a name="ln-5786"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">OutConvFaceHeight</span>    <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">RoofGeo</span><span class="p">%</span><span class="n">Height</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5787"></a>                                                   <span class="p">(</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span> <span class="o">-</span> <span class="nb">MINVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
<a name="ln-5788"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&gt;=</span> <span class="mi">13</span><span class="mf">5.0d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">!assume floor over exterior, just use surface&#39;s geometry</span>
<a name="ln-5789"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">OutConvFaceArea</span>      <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">GrossArea</span>
<a name="ln-5790"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">OutConvFacePerimeter</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Perimeter</span>
<a name="ln-5791"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">OutConvFaceHeight</span>    <span class="o">=</span> <span class="p">(</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span> <span class="o">-</span> <span class="nb">MINVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Z</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-5792"></a>    <span class="n">ENDIF</span>
<a name="ln-5793"></a>  <span class="n">ENDDO</span> <span class="c">! second pass thru surfs for outside face convection params.</span>
<a name="ln-5794"></a>
<a name="ln-5795"></a>
<a name="ln-5796"></a>  <span class="c">! now send to EIO if surface reporting selected</span>
<a name="ln-5797"></a>  <span class="k">CALL </span><span class="n">ScanForReports</span><span class="p">(</span><span class="s1">&#39;Surfaces&#39;</span><span class="p">,</span><span class="n">DoReport</span><span class="p">,</span><span class="s1">&#39;Details&#39;</span><span class="p">)</span>
<a name="ln-5798"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DoReport</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! echo out static geometry data related to convection models</span>
<a name="ln-5799"></a>
<a name="ln-5800"></a>    <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span> <span class="mi">900</span><span class="p">)</span>     <span class="c">!header</span>
<a name="ln-5801"></a>    <span class="k">DO </span><span class="n">SurfLoop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">TotSurfaces</span>
<a name="ln-5802"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">cycle</span>
<a name="ln-5803"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">IntConvSurfGetsRadiantHeat</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5804"></a><span class="k">        </span><span class="n">YesNo1</span><span class="o">=</span><span class="s1">&#39;Yes&#39;</span>
<a name="ln-5805"></a>      <span class="k">ELSE</span>
<a name="ln-5806"></a><span class="k">        </span><span class="n">YesNo1</span><span class="o">=</span><span class="s1">&#39;No&#39;</span>
<a name="ln-5807"></a>      <span class="n">ENDIF</span>
<a name="ln-5808"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">IntConvSurfHasActiveInIt</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5809"></a><span class="k">        </span><span class="n">YesNo2</span><span class="o">=</span><span class="s1">&#39;Yes&#39;</span>
<a name="ln-5810"></a>      <span class="k">ELSE</span>
<a name="ln-5811"></a><span class="k">        </span><span class="n">YesNo2</span><span class="o">=</span><span class="s1">&#39;No&#39;</span>
<a name="ln-5812"></a>      <span class="n">ENDIF</span>
<a name="ln-5813"></a>      <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span> <span class="mi">901</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5814"></a>       <span class="nb">TRIM</span><span class="p">(</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5815"></a>       <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">ExtConvCoeff</span><span class="p">))</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5816"></a>       <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">OutConvFaceArea</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5817"></a>       <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">OutConvFacePerimeter</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5818"></a>       <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">OutConvFaceHeight</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5819"></a>       <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">IntConvCoeff</span><span class="p">))</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5820"></a>       <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">IntConvZoneWallHeight</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5821"></a>       <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">IntConvZonePerimLength</span> <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span> <span class="c">! [m] length of perimeter zone&#39;s exterior wall</span>
<a name="ln-5822"></a>       <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">IntConvZoneHorizHydrDiam</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span> <span class="c">! [m] hydraulic diameter, usually 4 times the zone floor area div by perimeter</span>
<a name="ln-5823"></a>       <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">IntConvWindowWallRatio</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span> <span class="c">! [-] area of windows over area of exterior wall for zone</span>
<a name="ln-5824"></a>       <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">IntConvWindowLocation</span> <span class="p">)),</span> <span class="p">&amp;</span> <span class="c">! relative location of window in zone for interior Hc models</span>
<a name="ln-5825"></a>       <span class="nb">TRIM</span><span class="p">(</span><span class="n">YesNo1</span><span class="p">),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">YesNo2</span><span class="p">)</span>
<a name="ln-5826"></a>
<a name="ln-5827"></a>    <span class="n">ENDDO</span>
<a name="ln-5828"></a>
<a name="ln-5829"></a>    <span class="c">!if display advanced reports also dump meta group data used for convection geometry</span>
<a name="ln-5830"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayAdvancedReportVariables</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5831"></a><span class="k">      WRITE</span> <span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span> <span class="mi">8000</span><span class="p">)</span> <span class="c">!header for north facade</span>
<a name="ln-5832"></a>      <span class="k">WRITE</span> <span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span> <span class="mi">8001</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-5833"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">NorthFacade</span><span class="p">%</span><span class="n">Perimeter</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5834"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">NorthFacade</span><span class="p">%</span><span class="n">Height</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5835"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">NorthFacade</span><span class="p">%</span><span class="n">Xmin</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5836"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">NorthFacade</span><span class="p">%</span><span class="n">Xmax</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5837"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">NorthFacade</span><span class="p">%</span><span class="n">Ymin</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5838"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">NorthFacade</span><span class="p">%</span><span class="n">Ymax</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5839"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">NorthFacade</span><span class="p">%</span><span class="n">Zmin</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5840"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">NorthFacade</span><span class="p">%</span><span class="n">Zmax</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<a name="ln-5841"></a>      <span class="k">WRITE</span> <span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span> <span class="mi">8100</span><span class="p">)</span> <span class="c">!header for northeast facade</span>
<a name="ln-5842"></a>      <span class="k">WRITE</span> <span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span> <span class="mi">8101</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-5843"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">NorthEastFacade</span><span class="p">%</span><span class="n">Perimeter</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5844"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">NorthEastFacade</span><span class="p">%</span><span class="n">Height</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5845"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">NorthEastFacade</span><span class="p">%</span><span class="n">Xmin</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5846"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">NorthEastFacade</span><span class="p">%</span><span class="n">Xmax</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5847"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">NorthEastFacade</span><span class="p">%</span><span class="n">Ymin</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5848"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">NorthEastFacade</span><span class="p">%</span><span class="n">Ymax</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5849"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">NorthEastFacade</span><span class="p">%</span><span class="n">Zmin</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5850"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">NorthEastFacade</span><span class="p">%</span><span class="n">Zmax</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<a name="ln-5851"></a>      <span class="k">WRITE</span> <span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span> <span class="mi">8200</span><span class="p">)</span> <span class="c">!header for east facade</span>
<a name="ln-5852"></a>      <span class="k">WRITE</span> <span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span> <span class="mi">8201</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-5853"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">EastFacade</span><span class="p">%</span><span class="n">Perimeter</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5854"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">EastFacade</span><span class="p">%</span><span class="n">Height</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5855"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">EastFacade</span><span class="p">%</span><span class="n">Xmin</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5856"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">EastFacade</span><span class="p">%</span><span class="n">Xmax</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5857"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">EastFacade</span><span class="p">%</span><span class="n">Ymin</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5858"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">EastFacade</span><span class="p">%</span><span class="n">Ymax</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5859"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">EastFacade</span><span class="p">%</span><span class="n">Zmin</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5860"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">EastFacade</span><span class="p">%</span><span class="n">Zmax</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<a name="ln-5861"></a>
<a name="ln-5862"></a>      <span class="k">WRITE</span> <span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span> <span class="mi">8300</span><span class="p">)</span> <span class="c">!header for southeast facade</span>
<a name="ln-5863"></a>      <span class="k">WRITE</span> <span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span> <span class="mi">8301</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-5864"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">SouthEastFacade</span><span class="p">%</span><span class="n">Perimeter</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5865"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">SouthEastFacade</span><span class="p">%</span><span class="n">Height</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5866"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">SouthEastFacade</span><span class="p">%</span><span class="n">Xmin</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5867"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">SouthEastFacade</span><span class="p">%</span><span class="n">Xmax</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5868"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">SouthEastFacade</span><span class="p">%</span><span class="n">Ymin</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5869"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">SouthEastFacade</span><span class="p">%</span><span class="n">Ymax</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5870"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">SouthEastFacade</span><span class="p">%</span><span class="n">Zmin</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5871"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">SouthEastFacade</span><span class="p">%</span><span class="n">Zmax</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<a name="ln-5872"></a>
<a name="ln-5873"></a>      <span class="k">WRITE</span> <span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span> <span class="mi">8400</span><span class="p">)</span> <span class="c">!header for south facade</span>
<a name="ln-5874"></a>      <span class="k">WRITE</span> <span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span> <span class="mi">8401</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-5875"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">SouthFacade</span><span class="p">%</span><span class="n">Perimeter</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5876"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">SouthFacade</span><span class="p">%</span><span class="n">Height</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5877"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">SouthFacade</span><span class="p">%</span><span class="n">Xmin</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5878"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">SouthFacade</span><span class="p">%</span><span class="n">Xmax</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5879"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">SouthFacade</span><span class="p">%</span><span class="n">Ymin</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5880"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">SouthFacade</span><span class="p">%</span><span class="n">Ymax</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5881"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">SouthFacade</span><span class="p">%</span><span class="n">Zmin</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5882"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">SouthFacade</span><span class="p">%</span><span class="n">Zmax</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<a name="ln-5883"></a>      <span class="k">WRITE</span> <span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span> <span class="mi">8500</span><span class="p">)</span> <span class="c">!header for southwest facade</span>
<a name="ln-5884"></a>      <span class="k">WRITE</span> <span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span> <span class="mi">8501</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-5885"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">SouthWestFacade</span><span class="p">%</span><span class="n">Perimeter</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5886"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">SouthWestFacade</span><span class="p">%</span><span class="n">Height</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5887"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">SouthWestFacade</span><span class="p">%</span><span class="n">Xmin</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5888"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">SouthWestFacade</span><span class="p">%</span><span class="n">Xmax</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5889"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">SouthWestFacade</span><span class="p">%</span><span class="n">Ymin</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5890"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">SouthWestFacade</span><span class="p">%</span><span class="n">Ymax</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5891"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">SouthWestFacade</span><span class="p">%</span><span class="n">Zmin</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5892"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">SouthWestFacade</span><span class="p">%</span><span class="n">Zmax</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<a name="ln-5893"></a>      <span class="k">WRITE</span> <span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span> <span class="mi">8600</span><span class="p">)</span> <span class="c">!header for west facade</span>
<a name="ln-5894"></a>      <span class="k">WRITE</span> <span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span> <span class="mi">8601</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-5895"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">WestFacade</span><span class="p">%</span><span class="n">Perimeter</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5896"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">WestFacade</span><span class="p">%</span><span class="n">Height</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5897"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">WestFacade</span><span class="p">%</span><span class="n">Xmin</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5898"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">WestFacade</span><span class="p">%</span><span class="n">Xmax</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5899"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">WestFacade</span><span class="p">%</span><span class="n">Ymin</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5900"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">WestFacade</span><span class="p">%</span><span class="n">Ymax</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5901"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">WestFacade</span><span class="p">%</span><span class="n">Zmin</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5902"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">WestFacade</span><span class="p">%</span><span class="n">Zmax</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<a name="ln-5903"></a>      <span class="k">WRITE</span> <span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span> <span class="mi">8700</span><span class="p">)</span> <span class="c">!header for northwest facade</span>
<a name="ln-5904"></a>      <span class="k">WRITE</span> <span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span> <span class="mi">8701</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-5905"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">NorthWestFacade</span><span class="p">%</span><span class="n">Perimeter</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5906"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">NorthWestFacade</span><span class="p">%</span><span class="n">Height</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5907"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">NorthWestFacade</span><span class="p">%</span><span class="n">Xmin</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5908"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">NorthWestFacade</span><span class="p">%</span><span class="n">Xmax</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5909"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">NorthWestFacade</span><span class="p">%</span><span class="n">Ymin</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5910"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">NorthWestFacade</span><span class="p">%</span><span class="n">Ymax</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5911"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">NorthWestFacade</span><span class="p">%</span><span class="n">Zmin</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5912"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">NorthWestFacade</span><span class="p">%</span><span class="n">Zmax</span>   <span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<a name="ln-5913"></a>      <span class="k">WRITE</span> <span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span> <span class="mi">8800</span><span class="p">)</span> <span class="c">! header for roof</span>
<a name="ln-5914"></a>      <span class="k">WRITE</span> <span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span> <span class="mi">8801</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-5915"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">Area</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5916"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">Perimeter</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5917"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">Height</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5918"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYdZd</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">X</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5919"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYdZd</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Y</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5920"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYdZd</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Z</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5921"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYdZu</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">X</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5922"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYdZu</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Y</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5923"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYdZu</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Z</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5924"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYuZd</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">X</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<a name="ln-5925"></a>      <span class="k">WRITE</span> <span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span> <span class="mi">88012</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-5926"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYuZd</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Y</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5927"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYuZd</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Z</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5928"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYuZu</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">X</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5929"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYuZu</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Y</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5930"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XdYuZu</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Z</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5931"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYdZd</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">X</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5932"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYdZd</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Y</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5933"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYdZd</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Z</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5934"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYuZd</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">X</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5935"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYuZd</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Y</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<a name="ln-5936"></a>      <span class="k">WRITE</span> <span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span> <span class="mi">88013</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-5937"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYuZd</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Z</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5938"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYdZu</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">X</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5939"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYdZu</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Y</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5940"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYdZu</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Z</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5941"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYuZu</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">X</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5942"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYuZu</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Y</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5943"></a>          <span class="nb">TRIM</span><span class="p">(</span> <span class="n">RoundSigDigits</span><span class="p">(</span> <span class="n">RoofGeo</span><span class="p">%</span><span class="n">XuYuZu</span><span class="p">%</span><span class="n">Vertex</span><span class="p">%</span><span class="n">Z</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<a name="ln-5944"></a>
<a name="ln-5945"></a>    <span class="n">ENDIF</span>
<a name="ln-5946"></a>
<a name="ln-5947"></a>
<a name="ln-5948"></a>  <span class="n">ENDIF</span>
<a name="ln-5949"></a>
<a name="ln-5950"></a>  <span class="mi">900</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;! &lt;Surface Convection Parameters&gt;, Surface Name, Outside Model Assignment, Outside Area [m2], &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5951"></a>             <span class="s1">&#39;Outside Perimeter [m], Outside Height [m], Inside Model Assignment, &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5952"></a>             <span class="s1">&#39;Inside Height [cm], Inside Perimeter Envelope [m], Inside Hydraulic Diameter [m], Window Wall Ratio [ ], &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5953"></a>             <span class="s1">&#39;Window Location [ ], Near Radiant [Yes/No], Has Active HVAC [Yes/No]&#39;</span><span class="p">)</span>
<a name="ln-5954"></a>
<a name="ln-5955"></a>  <span class="mi">901</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;Surface Convection Parameters,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span> <span class="p">&amp;</span>
<a name="ln-5956"></a>                 <span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span> <span class="p">)</span>
<a name="ln-5957"></a>
<a name="ln-5958"></a>  <span class="mi">8000</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;! &lt;Building Convection Parameters:North Facade&gt;, Perimeter, Height, Xmin, Xmax, Ymin, Ymax, Zmin, Zmax &#39;</span><span class="p">)</span>
<a name="ln-5959"></a>  <span class="mi">8001</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;Building Convection Parameters:North Facade, &#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span> <span class="p">,</span> <span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">A</span> <span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
<a name="ln-5960"></a>
<a name="ln-5961"></a>  <span class="mi">8100</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;! &lt;Building Convection Parameters:Northeast Facade&gt;, Perimeter, Height, Xmin, Xmax, Ymin, Ymax, Zmin, Zmax &#39;</span><span class="p">)</span>
<a name="ln-5962"></a>  <span class="mi">8101</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;Building Convection Parameters:Northeast Facade, &#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span> <span class="p">,</span> <span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">A</span> <span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
<a name="ln-5963"></a>
<a name="ln-5964"></a>  <span class="mi">8200</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;! &lt;Building Convection Parameters:East Facade&gt;, Perimeter, Height, Xmin, Xmax, Ymin, Ymax, Zmin, Zmax &#39;</span><span class="p">)</span>
<a name="ln-5965"></a>  <span class="mi">8201</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;Building Convection Parameters:East Facade, &#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span> <span class="p">,</span> <span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">A</span> <span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
<a name="ln-5966"></a>
<a name="ln-5967"></a>  <span class="mi">8300</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;! &lt;Building Convection Parameters:Southeast Facade&gt;, Perimeter, Height, Xmin, Xmax, Ymin, Ymax, Zmin, Zmax &#39;</span><span class="p">)</span>
<a name="ln-5968"></a>  <span class="mi">8301</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;Building Convection Parameters:Southeast Facade, &#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span> <span class="p">,</span> <span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">A</span> <span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
<a name="ln-5969"></a>  <span class="mi">8400</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;! &lt;Building Convection Parameters:South Facade&gt;, Perimeter, Height, Xmin, Xmax, Ymin, Ymax, Zmin, Zmax &#39;</span><span class="p">)</span>
<a name="ln-5970"></a>  <span class="mi">8401</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;Building Convection Parameters:South Facade, &#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span> <span class="p">,</span> <span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">A</span> <span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
<a name="ln-5971"></a>  <span class="mi">8500</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;! &lt;Building Convection Parameters:Southwest Facade&gt;, Perimeter, Height, Xmin, Xmax, Ymin, Ymax, Zmin, Zmax &#39;</span><span class="p">)</span>
<a name="ln-5972"></a>  <span class="mi">8501</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;Building Convection Parameters:Southwest Facade, &#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span> <span class="p">,</span> <span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">A</span> <span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
<a name="ln-5973"></a>  <span class="mi">8600</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;! &lt;Building Convection Parameters:West Facade&gt;, Perimeter, Height, Xmin, Xmax, Ymin, Ymax, Zmin, Zmax &#39;</span><span class="p">)</span>
<a name="ln-5974"></a>  <span class="mi">8601</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;Building Convection Parameters:West Facade, &#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span> <span class="p">,</span> <span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">A</span> <span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
<a name="ln-5975"></a>  <span class="mi">8700</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;! &lt;Building Convection Parameters:Northwest Facade&gt;, Perimeter, Height, Xmin, Xmax, Ymin, Ymax, Zmin, Zmax &#39;</span><span class="p">)</span>
<a name="ln-5976"></a>  <span class="mi">8701</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;Building Convection Parameters:NorthwWest Facade, &#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span> <span class="p">,</span> <span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">A</span> <span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
<a name="ln-5977"></a>
<a name="ln-5978"></a>  <span class="mi">8800</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;! &lt;Building Convection Parameters:Roof&gt;, Area [m2], Perimeter [m], Height [m], &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5979"></a>                               <span class="s1">&#39;XdYdZd:X, XdYdZd:Y, XdYdZd:Z&#39;</span> <span class="p">,</span> <span class="p">&amp;</span> <span class="c">! 1 low x, low y, low z</span>
<a name="ln-5980"></a>                               <span class="s1">&#39;,XdYdZu:X, XdYdZu:Y, XdYdZu:Z&#39;</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! 2 low x, low y, hi z</span>
<a name="ln-5981"></a>                               <span class="s1">&#39;,XdYuZd:X, XdYuZd:Y, XdYuZd:Z&#39;</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! 3 low x, hi y, low z</span>
<a name="ln-5982"></a>                               <span class="s1">&#39;,XdYuZu:X, XdYuZu:Y, XdYuZu:Z&#39;</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! 4 low x, hi y, hi z</span>
<a name="ln-5983"></a>                               <span class="s1">&#39;,XuYdZd:X, XuYdZd:Y, XuYdZd:Z&#39;</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! 5 hi x, low y, low z</span>
<a name="ln-5984"></a>                               <span class="s1">&#39;,XuYuZd:X, XuYuZd:Y, XuYuZd:Z&#39;</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! 6 hi x, hi y, low z</span>
<a name="ln-5985"></a>                               <span class="s1">&#39;,XuYdZu:X, XuYdZu:Y, XuYdZu:Z&#39;</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! 7 hi x, low y, hi z</span>
<a name="ln-5986"></a>                               <span class="s1">&#39;,XuYuZu:X, XuYuZu:Y, XuYuZu:Z&#39;</span> <span class="p">)</span> <span class="c">! 8 hi x, hi y, hi z</span>
<a name="ln-5987"></a>  <span class="mi">8801</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;Building Convection Parameters:Roof,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span> <span class="p">)</span>
<a name="ln-5988"></a>  <span class="mi">88012</span> <span class="k">format</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span> <span class="p">)</span>
<a name="ln-5989"></a>  <span class="mi">88013</span> <span class="k">format</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
<a name="ln-5990"></a>
<a name="ln-5991"></a>
<a name="ln-5992"></a>  <span class="n">ConvectionGeometryMetaDataSetup</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5993"></a>
<a name="ln-5994"></a>  <span class="k">RETURN</span>
<a name="ln-5995"></a>
<a name="ln-5996"></a><span class="k">END SUBROUTINE </span><span class="n">SetupAdaptiveConvectionStaticMetaData</span>
<a name="ln-5997"></a>
<a name="ln-5998"></a><span class="k">SUBROUTINE </span><span class="n">SetupAdaptiveConvectionRadiantSurfaceData</span>
<a name="ln-5999"></a>
<a name="ln-6000"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6001"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-6002"></a>          <span class="c">!       DATE WRITTEN   Sept 2011</span>
<a name="ln-6003"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6004"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6005"></a>
<a name="ln-6006"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6007"></a>          <span class="c">! identify Zones that have active radiant elements for convection model classifications</span>
<a name="ln-6008"></a>
<a name="ln-6009"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6010"></a>          <span class="c">! Need to fill in values for ZoneEquipConfig%InWallActiveElement, ZoneEquipConfig%InCeilingActiveElement</span>
<a name="ln-6011"></a>          <span class="c">! and ZoneEquipConfig(ZoneNum)%InFloorActiveElement.</span>
<a name="ln-6012"></a>
<a name="ln-6013"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6014"></a>          <span class="c">! na</span>
<a name="ln-6015"></a>
<a name="ln-6016"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6017"></a>  <span class="k">USE </span><span class="n">DataZoneEquipment</span>
<a name="ln-6018"></a>
<a name="ln-6019"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6020"></a>
<a name="ln-6021"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6022"></a>          <span class="c">! na</span>
<a name="ln-6023"></a>
<a name="ln-6024"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6025"></a>          <span class="c">! na</span>
<a name="ln-6026"></a>
<a name="ln-6027"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-6028"></a>          <span class="c">! na</span>
<a name="ln-6029"></a>
<a name="ln-6030"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-6031"></a>          <span class="c">! na</span>
<a name="ln-6032"></a>
<a name="ln-6033"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6034"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ActiveWallCount</span>    <span class="o">=</span> <span class="mi">0</span>
<a name="ln-6035"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ActiveWallArea</span>     <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-6036"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ActiveCeilingCount</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-6037"></a>  <span class="kt">Real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ActiveCeilingArea</span>  <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-6038"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ActiveFloorCount</span>   <span class="o">=</span> <span class="mi">0</span>
<a name="ln-6039"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ActiveFloorArea</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-6040"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ZoneLoop</span>
<a name="ln-6041"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">SurfLoop</span>
<a name="ln-6042"></a>
<a name="ln-6043"></a>  <span class="k">DO </span><span class="n">ZoneLoop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NumOfZones</span>
<a name="ln-6044"></a>    <span class="n">ActiveWallCount</span>    <span class="o">=</span> <span class="mi">0</span>
<a name="ln-6045"></a>    <span class="n">ActiveWallArea</span>     <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-6046"></a>    <span class="n">ActiveCeilingCount</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-6047"></a>    <span class="n">ActiveCeilingArea</span>  <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-6048"></a>    <span class="n">ActiveFloorCount</span>   <span class="o">=</span> <span class="mi">0</span>
<a name="ln-6049"></a>    <span class="n">ActiveFloorArea</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-6050"></a>
<a name="ln-6051"></a>    <span class="k">DO </span><span class="n">SurfLoop</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-6052"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">IntConvSurfHasActiveInIt</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-6053"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Wall</span>  <span class="p">&amp;</span>
<a name="ln-6054"></a>          <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Door</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6055"></a><span class="k">        </span><span class="n">ActiveWallCount</span> <span class="o">=</span> <span class="n">ActiveWallCount</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-6056"></a>        <span class="n">ActiveWallArea</span>  <span class="o">=</span> <span class="n">ActiveWallArea</span> <span class="o">+</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-6057"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Roof</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6058"></a><span class="k">        </span><span class="n">ActiveCeilingCount</span> <span class="o">=</span> <span class="n">ActiveCeilingCount</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-6059"></a>        <span class="n">ActiveCeilingArea</span>  <span class="o">=</span> <span class="n">ActiveCeilingArea</span> <span class="o">+</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-6060"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Floor</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6061"></a><span class="k">        </span><span class="n">ActiveFloorCount</span>   <span class="o">=</span> <span class="n">ActiveFloorCount</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-6062"></a>        <span class="n">ActiveFloorArea</span>    <span class="o">=</span> <span class="n">ActiveFloorArea</span> <span class="o">+</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-6063"></a>      <span class="n">ENDIF</span>
<a name="ln-6064"></a>    <span class="n">ENDDO</span> <span class="c">! surface loop</span>
<a name="ln-6065"></a>
<a name="ln-6066"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">ActiveWallCount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">ActiveWallArea</span> <span class="o">&gt;</span> <span class="mf">0.d0</span> <span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6067"></a><span class="k">      </span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">)%</span><span class="n">InWallActiveElement</span>    <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6068"></a>    <span class="n">ENDIF</span>
<a name="ln-6069"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">ActiveCeilingCount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">ActiveCeilingArea</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6070"></a><span class="k">      </span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">)%</span><span class="n">InCeilingActiveElement</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6071"></a>    <span class="n">ENDIF</span>
<a name="ln-6072"></a>    <span class="k">IF</span> <span class="p">((</span> <span class="n">ActiveFloorCount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">ActiveFloorArea</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6073"></a><span class="k">      </span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">)%</span><span class="n">InFloorActiveElement</span>   <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6074"></a>    <span class="n">ENDIF</span>
<a name="ln-6075"></a>  <span class="n">ENDDO</span> <span class="c">! zone loop</span>
<a name="ln-6076"></a>
<a name="ln-6077"></a>  <span class="k">RETURN</span>
<a name="ln-6078"></a>
<a name="ln-6079"></a><span class="k">END SUBROUTINE </span><span class="n">SetupAdaptiveConvectionRadiantSurfaceData</span>
<a name="ln-6080"></a>
<a name="ln-6081"></a>
<a name="ln-6082"></a><span class="k">SUBROUTINE </span><span class="n">ManageInsideAdaptiveConvectionAlgo</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-6083"></a>
<a name="ln-6084"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6085"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-6086"></a>          <span class="c">!       DATE WRITTEN   Aug 2010</span>
<a name="ln-6087"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6088"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6089"></a>
<a name="ln-6090"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6091"></a>          <span class="c">! This subroutine manages the calculation of interior convection coefficient for a surface.</span>
<a name="ln-6092"></a>
<a name="ln-6093"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6094"></a>          <span class="c">! This routine implements the Adaptive Convection Algorithm developed by IB-M 2000 and IB-M 2002</span>
<a name="ln-6095"></a>          <span class="c">!  - first calls a large routine, DynamicIntConvSurfaceClassification, that has most of the complex logic</span>
<a name="ln-6096"></a>          <span class="c">!  - then calls a straightforward routine that maps the classification to model equation</span>
<a name="ln-6097"></a>          <span class="c">!  - then calls a routine with a large case statement that calls model equations.</span>
<a name="ln-6098"></a>
<a name="ln-6099"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6100"></a>          <span class="c">! na</span>
<a name="ln-6101"></a>
<a name="ln-6102"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6103"></a>
<a name="ln-6104"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6105"></a>
<a name="ln-6106"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6107"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">SurfNum</span> <span class="c">! surface number for which coefficients are being calculated</span>
<a name="ln-6108"></a>
<a name="ln-6109"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6110"></a>          <span class="c">! na</span>
<a name="ln-6111"></a>
<a name="ln-6112"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-6113"></a>          <span class="c">! na</span>
<a name="ln-6114"></a>
<a name="ln-6115"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-6116"></a>          <span class="c">! na</span>
<a name="ln-6117"></a>
<a name="ln-6118"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6119"></a>
<a name="ln-6120"></a>
<a name="ln-6121"></a>  <span class="c">! this next call sets up the flow regime and assigns a classification to surface</span>
<a name="ln-6122"></a>  <span class="c">!  TODO: candidate for rework to do zone level calcs once rather than for each surface</span>
<a name="ln-6123"></a>  <span class="k">CALL </span><span class="n">DynamicIntConvSurfaceClassification</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-6124"></a>
<a name="ln-6125"></a>  <span class="c">! simple worker routine takes surface classification and fills in model to use (IntConvHcModelEq) for that surface</span>
<a name="ln-6126"></a>  <span class="k">CALL </span><span class="n">MapIntConvClassificationToHcModels</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-6127"></a>
<a name="ln-6128"></a>  <span class="k">CALL </span><span class="n">EvaluateIntHcModels</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span><span class="p">,</span> <span class="n">HconvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">))</span>
<a name="ln-6129"></a>
<a name="ln-6130"></a>
<a name="ln-6131"></a>  <span class="k">RETURN</span>
<a name="ln-6132"></a>
<a name="ln-6133"></a><span class="k">END SUBROUTINE </span><span class="n">ManageInsideAdaptiveConvectionAlgo</span>
<a name="ln-6134"></a>
<a name="ln-6135"></a><span class="k">SUBROUTINE </span><span class="n">ManageOutsideAdaptiveConvectionAlgo</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span> <span class="n">Hc</span><span class="p">)</span>
<a name="ln-6136"></a>
<a name="ln-6137"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6138"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-6139"></a>          <span class="c">!       DATE WRITTEN   Aug 2010</span>
<a name="ln-6140"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6141"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6142"></a>
<a name="ln-6143"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6144"></a>          <span class="c">! This subroutine calculates the convection coefficient for the outside face of a surface</span>
<a name="ln-6145"></a>
<a name="ln-6146"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6147"></a>          <span class="c">! This routine implements an adpative struture and classification system for outdoor</span>
<a name="ln-6148"></a>          <span class="c">!   It calls a series of separable worker routines</span>
<a name="ln-6149"></a>
<a name="ln-6150"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6151"></a>          <span class="c">! na</span>
<a name="ln-6152"></a>
<a name="ln-6153"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6154"></a>
<a name="ln-6155"></a>
<a name="ln-6156"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6157"></a>
<a name="ln-6158"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6159"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">SurfNum</span> <span class="c">! surface number for which coefficients are being calculated</span>
<a name="ln-6160"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Hc</span>  <span class="c">!  result for Hc Outside face, becomes HExt.</span>
<a name="ln-6161"></a>
<a name="ln-6162"></a>
<a name="ln-6163"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6164"></a>          <span class="c">! na</span>
<a name="ln-6165"></a>
<a name="ln-6166"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-6167"></a>          <span class="c">! na</span>
<a name="ln-6168"></a>
<a name="ln-6169"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-6170"></a>          <span class="c">! na</span>
<a name="ln-6171"></a>
<a name="ln-6172"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6173"></a>
<a name="ln-6174"></a>  <span class="k">CALL </span><span class="n">DynamicExtConvSurfaceClassification</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-6175"></a>
<a name="ln-6176"></a>  <span class="k">CALL </span><span class="n">MapExtConvClassificationToHcModels</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-6177"></a>
<a name="ln-6178"></a>  <span class="k">CALL </span><span class="n">EvaluateExtHcModels</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvHnModelEq</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6179"></a>                                    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvHfModelEq</span><span class="p">,</span> <span class="n">Hc</span><span class="p">)</span>
<a name="ln-6180"></a>
<a name="ln-6181"></a>
<a name="ln-6182"></a>  <span class="k">RETURN</span>
<a name="ln-6183"></a>
<a name="ln-6184"></a><span class="k">END SUBROUTINE </span><span class="n">ManageOutsideAdaptiveConvectionAlgo</span>
<a name="ln-6185"></a>
<a name="ln-6186"></a><span class="k">SUBROUTINE </span><span class="n">EvaluateIntHcModels</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span> <span class="n">ConvModelEquationNum</span><span class="p">,</span> <span class="n">Hc</span><span class="p">)</span>
<a name="ln-6187"></a>
<a name="ln-6188"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6189"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-6190"></a>          <span class="c">!       DATE WRITTEN   Aug 2010</span>
<a name="ln-6191"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6192"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6193"></a>
<a name="ln-6194"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6195"></a>          <span class="c">! central case statement for calling inside convection models</span>
<a name="ln-6196"></a>
<a name="ln-6197"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6198"></a>          <span class="c">!  - fills value for Hc by calling the appropriate convection model, usually as a function.</span>
<a name="ln-6199"></a>          <span class="c">!     preperation of argument values for the function calls is contained in each Case block (repeats)</span>
<a name="ln-6200"></a>          <span class="c">!  - also updates the reference air temperature type for use in the surface heat balance calcs</span>
<a name="ln-6201"></a>
<a name="ln-6202"></a>
<a name="ln-6203"></a>
<a name="ln-6204"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6205"></a>          <span class="c">! na</span>
<a name="ln-6206"></a>
<a name="ln-6207"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6208"></a>  <span class="k">USE </span><span class="n">DataHeatBalSurface</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TH</span><span class="p">,</span> <span class="n">QdotConvInRepPerArea</span>
<a name="ln-6209"></a>  <span class="k">USE </span><span class="n">DataHeatBalFanSys</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">MAT</span>
<a name="ln-6210"></a>  <span class="k">USE </span><span class="n">DataZoneEquipment</span>
<a name="ln-6211"></a>  <span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">OutBaroPress</span>
<a name="ln-6212"></a>  <span class="k">USE </span><span class="n">Psychrometrics</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">,</span> <span class="n">PsyWFnTdpPb</span>
<a name="ln-6213"></a>
<a name="ln-6214"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6215"></a>
<a name="ln-6216"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6217"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">SurfNum</span>
<a name="ln-6218"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ConvModelEquationNum</span>
<a name="ln-6219"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Hc</span>  <span class="c">! calculated Hc value</span>
<a name="ln-6220"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6221"></a>          <span class="c">! na</span>
<a name="ln-6222"></a>
<a name="ln-6223"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-6224"></a>          <span class="c">! na</span>
<a name="ln-6225"></a>
<a name="ln-6226"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-6227"></a>          <span class="c">! na</span>
<a name="ln-6228"></a>
<a name="ln-6229"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6230"></a>
<a name="ln-6231"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SupplyAirTemp</span>
<a name="ln-6232"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">AirChangeRate</span>
<a name="ln-6233"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">ZoneNum</span>  <span class="c">! zone associated with inside face of surface</span>
<a name="ln-6234"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">ZoneNode</span> <span class="c">! the system node for the zone, node index</span>
<a name="ln-6235"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">EquipNum</span>
<a name="ln-6236"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SumMdotTemp</span>
<a name="ln-6237"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SumMdot</span>
<a name="ln-6238"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">AirDensity</span>
<a name="ln-6239"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">AirSystemVolFlowRate</span>
<a name="ln-6240"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">thisZoneInletNode</span>
<a name="ln-6241"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">tmpHc</span>
<a name="ln-6242"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ZoneMult</span>  <span class="c">! local product of zone multiplier and zonelist multipler</span>
<a name="ln-6243"></a>  <span class="n">tmpHc</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-6244"></a><span class="c">!now call appropriate function to calculate Hc</span>
<a name="ln-6245"></a>  <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">ConvModelEquationNum</span><span class="p">)</span>
<a name="ln-6246"></a>
<a name="ln-6247"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">HcInt_UserCurve</span><span class="p">)</span>
<a name="ln-6248"></a>    <span class="k">CALL </span><span class="n">CalcUserDefinedInsideHcModel</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span><span class="p">,</span> <span class="n">tmpHc</span> <span class="p">)</span>
<a name="ln-6249"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">HcInt_ASHRAEVerticalWall</span><span class="p">)</span>
<a name="ln-6250"></a>    <span class="n">ZoneNum</span> <span class="o">=</span>  <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-6251"></a>    <span class="n">tmpHc</span> <span class="o">=</span> <span class="n">CalcASHRAEVerticalWall</span><span class="p">((</span><span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">MAT</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)))</span>
<a name="ln-6252"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TAirRef</span> <span class="o">=</span> <span class="n">ZoneMeanAirTemp</span>
<a name="ln-6253"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">HcInt_WaltonUnstableHorizontalOrTilt</span><span class="p">)</span>
<a name="ln-6254"></a>    <span class="n">ZoneNum</span> <span class="o">=</span>  <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-6255"></a>    <span class="n">tmpHc</span> <span class="o">=</span> <span class="n">CalcWaltonUnstableHorizontalOrTilt</span><span class="p">((</span><span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">MAT</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-6256"></a>                                              <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span> <span class="p">)</span> <span class="c">!TODO verify CosTilt in vs out</span>
<a name="ln-6257"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TAirRef</span> <span class="o">=</span> <span class="n">ZoneMeanAirTemp</span>
<a name="ln-6258"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">HcInt_WaltonStableHorizontalOrTilt</span><span class="p">)</span>
<a name="ln-6259"></a>    <span class="n">ZoneNum</span> <span class="o">=</span>  <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-6260"></a>    <span class="n">tmpHc</span> <span class="o">=</span> <span class="n">CalcWaltonStableHorizontalOrTilt</span><span class="p">((</span><span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">MAT</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-6261"></a>                                                         <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span> <span class="p">)</span> <span class="c">!TODO verify CosTilt in vs out</span>
<a name="ln-6262"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TAirRef</span> <span class="o">=</span> <span class="n">ZoneMeanAirTemp</span>
<a name="ln-6263"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">HcInt_FisherPedersenCeilDiffuserFloor</span><span class="p">)</span>
<a name="ln-6264"></a>    <span class="n">ZoneNum</span> <span class="o">=</span>  <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-6265"></a>    <span class="n">ZoneNode</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SystemZoneNodeNumber</span>
<a name="ln-6266"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6267"></a><span class="k">      </span><span class="n">ZoneMult</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Multiplier</span> <span class="o">*</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ListMultiplier</span>
<a name="ln-6268"></a>      <span class="n">AirDensity</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">PsyWFnTdpPb</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">))</span>
<a name="ln-6269"></a>      <span class="n">AirChangeRate</span> <span class="o">=</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span> <span class="n">SecInHour</span><span class="p">)</span><span class="o">/</span> <span class="p">(</span><span class="n">AirDensity</span> <span class="o">*</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">*</span> <span class="n">ZoneMult</span><span class="p">)</span>
<a name="ln-6270"></a>      <span class="n">AirChangeRate</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">AirChangeRate</span><span class="p">,</span> <span class="n">MaxACH</span><span class="p">)</span>
<a name="ln-6271"></a>      <span class="n">AirChangeRate</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">AirChangeRate</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-6272"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TAirRef</span> <span class="o">=</span> <span class="n">ZoneSupplyAirTemp</span>
<a name="ln-6273"></a>    <span class="k">ELSE</span>
<a name="ln-6274"></a><span class="k">      </span><span class="n">AirChangeRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-6275"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TAirRef</span> <span class="o">=</span> <span class="n">ZoneMeanAirTemp</span>
<a name="ln-6276"></a>    <span class="n">ENDIF</span>
<a name="ln-6277"></a>    <span class="n">tmpHc</span> <span class="o">=</span> <span class="n">CalcFisherPedersenCeilDiffuserFloor</span><span class="p">(</span><span class="n">AirChangeRate</span><span class="p">)</span>
<a name="ln-6278"></a>
<a name="ln-6279"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">HcInt_FisherPedersenCeilDiffuserCeiling</span><span class="p">)</span>
<a name="ln-6280"></a>    <span class="n">ZoneNum</span> <span class="o">=</span>  <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-6281"></a>    <span class="n">ZoneNode</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SystemZoneNodeNumber</span>
<a name="ln-6282"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneNode</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6283"></a><span class="k">      </span><span class="n">ZoneMult</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Multiplier</span> <span class="o">*</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ListMultiplier</span>
<a name="ln-6284"></a>      <span class="n">AirDensity</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">PsyWFnTdpPb</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">))</span>
<a name="ln-6285"></a>      <span class="n">AirChangeRate</span> <span class="o">=</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span> <span class="n">SecInHour</span><span class="p">)</span><span class="o">/</span> <span class="p">(</span><span class="n">AirDensity</span> <span class="o">*</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">*</span> <span class="n">ZoneMult</span><span class="p">)</span>
<a name="ln-6286"></a>      <span class="n">AirChangeRate</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">AirChangeRate</span><span class="p">,</span> <span class="n">MaxACH</span><span class="p">)</span>
<a name="ln-6287"></a>      <span class="n">AirChangeRate</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">AirChangeRate</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-6288"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TAirRef</span> <span class="o">=</span> <span class="n">ZoneSupplyAirTemp</span>
<a name="ln-6289"></a>    <span class="k">ELSE</span>
<a name="ln-6290"></a><span class="k">      </span><span class="n">AirChangeRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-6291"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TAirRef</span> <span class="o">=</span> <span class="n">ZoneMeanAirTemp</span>
<a name="ln-6292"></a>    <span class="n">ENDIF</span>
<a name="ln-6293"></a>    <span class="n">tmpHc</span> <span class="o">=</span> <span class="n">CalcFisherPedersenCeilDiffuserCeiling</span><span class="p">(</span><span class="n">AirChangeRate</span><span class="p">)</span>
<a name="ln-6294"></a>
<a name="ln-6295"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">HcInt_FisherPedersenCeilDiffuserWalls</span><span class="p">)</span>
<a name="ln-6296"></a>    <span class="n">ZoneNum</span> <span class="o">=</span>  <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-6297"></a>    <span class="n">ZoneNode</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SystemZoneNodeNumber</span>
<a name="ln-6298"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6299"></a><span class="k">      </span><span class="n">ZoneMult</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Multiplier</span> <span class="o">*</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ListMultiplier</span>
<a name="ln-6300"></a>      <span class="n">AirDensity</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">PsyWFnTdpPb</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">))</span>
<a name="ln-6301"></a>      <span class="n">AirChangeRate</span> <span class="o">=</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span> <span class="n">SecInHour</span><span class="p">)</span><span class="o">/</span> <span class="p">(</span><span class="n">AirDensity</span> <span class="o">*</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">*</span> <span class="n">ZoneMult</span><span class="p">)</span>
<a name="ln-6302"></a>      <span class="n">AirChangeRate</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">AirChangeRate</span><span class="p">,</span> <span class="n">MaxACH</span><span class="p">)</span>
<a name="ln-6303"></a>      <span class="n">AirChangeRate</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">AirChangeRate</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-6304"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TAirRef</span> <span class="o">=</span> <span class="n">ZoneSupplyAirTemp</span>
<a name="ln-6305"></a>    <span class="k">ELSE</span>
<a name="ln-6306"></a><span class="k">      </span><span class="n">AirChangeRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-6307"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TAirRef</span> <span class="o">=</span> <span class="n">ZoneMeanAirTemp</span>
<a name="ln-6308"></a>    <span class="n">ENDIF</span>
<a name="ln-6309"></a>    <span class="n">tmpHc</span> <span class="o">=</span> <span class="n">CalcFisherPedersenCeilDiffuserWalls</span><span class="p">(</span><span class="n">AirChangeRate</span><span class="p">)</span>
<a name="ln-6310"></a>
<a name="ln-6311"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">HcInt_AlamdariHammondStableHorizontal</span><span class="p">)</span>
<a name="ln-6312"></a>    <span class="n">ZoneNum</span> <span class="o">=</span>  <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-6313"></a>    <span class="n">tmpHc</span> <span class="o">=</span> <span class="n">CalcAlamdariHammondStableHorizontal</span><span class="p">((</span><span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">MAT</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-6314"></a>                                                 <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvZoneHorizHydrDiam</span><span class="p">,</span> <span class="n">SurfNum</span> <span class="p">)</span>
<a name="ln-6315"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TAirRef</span> <span class="o">=</span> <span class="n">ZoneMeanAirTemp</span>
<a name="ln-6316"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">HcInt_AlamdariHammondVerticalWall</span><span class="p">)</span>
<a name="ln-6317"></a>    <span class="n">ZoneNum</span> <span class="o">=</span>  <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-6318"></a>    <span class="n">tmpHc</span> <span class="o">=</span> <span class="n">CalcAlamdariHammondVerticalWall</span><span class="p">((</span><span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">MAT</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-6319"></a>                                             <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvZoneWallHeight</span><span class="p">,</span> <span class="n">SurfNum</span> <span class="p">)</span>
<a name="ln-6320"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TAirRef</span> <span class="o">=</span> <span class="n">ZoneMeanAirTemp</span>
<a name="ln-6321"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">HcInt_AlamdariHammondUnstableHorizontal</span><span class="p">)</span>
<a name="ln-6322"></a>    <span class="n">ZoneNum</span> <span class="o">=</span>  <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-6323"></a>    <span class="n">tmpHc</span> <span class="o">=</span> <span class="n">CalcAlamdariHammondUnstableHorizontal</span><span class="p">((</span><span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">MAT</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-6324"></a>                                                              <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvZoneHorizHydrDiam</span> <span class="p">,</span> <span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-6325"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TAirRef</span> <span class="o">=</span> <span class="n">ZoneMeanAirTemp</span>
<a name="ln-6326"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">HcInt_KhalifaEq3WallAwayFromHeat</span><span class="p">)</span>
<a name="ln-6327"></a>    <span class="n">ZoneNum</span> <span class="o">=</span>  <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-6328"></a>    <span class="n">tmpHc</span> <span class="o">=</span> <span class="n">CalcKhalifaEq3WallAwayFromHeat</span><span class="p">((</span><span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">MAT</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-6329"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TAirRef</span> <span class="o">=</span> <span class="n">ZoneMeanAirTemp</span>
<a name="ln-6330"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">HcInt_KhalifaEq4CeilingAwayFromHeat</span><span class="p">)</span>
<a name="ln-6331"></a>    <span class="n">ZoneNum</span> <span class="o">=</span>  <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-6332"></a>    <span class="n">tmpHc</span> <span class="o">=</span> <span class="n">CalcKhalifaEq4CeilingAwayFromHeat</span><span class="p">((</span><span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">MAT</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-6333"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TAirRef</span> <span class="o">=</span> <span class="n">ZoneMeanAirTemp</span>
<a name="ln-6334"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">HcInt_KhalifaEq5WallNearHeat</span><span class="p">)</span>
<a name="ln-6335"></a>    <span class="n">ZoneNum</span> <span class="o">=</span>  <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-6336"></a>    <span class="n">tmpHc</span> <span class="o">=</span> <span class="n">CalcKhalifaEq5WallsNearHeat</span><span class="p">((</span><span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">MAT</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-6337"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TAirRef</span> <span class="o">=</span> <span class="n">ZoneMeanAirTemp</span>
<a name="ln-6338"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">HcInt_KhalifaEq6NonHeatedWalls</span><span class="p">)</span>
<a name="ln-6339"></a>    <span class="n">ZoneNum</span> <span class="o">=</span>  <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-6340"></a>    <span class="n">tmpHc</span> <span class="o">=</span> <span class="n">CalcKhalifaEq6NonHeatedWalls</span><span class="p">((</span><span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">MAT</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-6341"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TAirRef</span> <span class="o">=</span> <span class="n">ZoneMeanAirTemp</span>
<a name="ln-6342"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">HcInt_KhalifaEq7Ceiling</span><span class="p">)</span>
<a name="ln-6343"></a>    <span class="n">ZoneNum</span> <span class="o">=</span>  <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-6344"></a>    <span class="n">tmpHc</span> <span class="o">=</span> <span class="n">CalcKhalifaEq7Ceiling</span><span class="p">((</span><span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">MAT</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-6345"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TAirRef</span> <span class="o">=</span> <span class="n">ZoneMeanAirTemp</span>
<a name="ln-6346"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">HcInt_AwbiHattonHeatedFloor</span><span class="p">)</span>
<a name="ln-6347"></a>    <span class="n">ZoneNum</span> <span class="o">=</span>  <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-6348"></a>    <span class="n">tmpHc</span> <span class="o">=</span> <span class="n">CalcAwbiHattonHeatedFloor</span><span class="p">((</span><span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">MAT</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-6349"></a>                                                  <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvZoneHorizHydrDiam</span> <span class="p">)</span>
<a name="ln-6350"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TAirRef</span> <span class="o">=</span> <span class="n">ZoneMeanAirTemp</span>
<a name="ln-6351"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">HcInt_AwbiHattonHeatedWall</span><span class="p">)</span>
<a name="ln-6352"></a>    <span class="n">ZoneNum</span> <span class="o">=</span>  <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-6353"></a>    <span class="n">tmpHc</span> <span class="o">=</span> <span class="n">CalcAwbiHattonHeatedWall</span><span class="p">((</span><span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">MAT</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-6354"></a>                                                  <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvZoneHorizHydrDiam</span> <span class="p">)</span>
<a name="ln-6355"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TAirRef</span> <span class="o">=</span> <span class="n">ZoneMeanAirTemp</span>
<a name="ln-6356"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">HcInt_BeausoleilMorrisonMixedAssistingWall</span><span class="p">)</span>
<a name="ln-6357"></a>    <span class="n">ZoneNum</span> <span class="o">=</span>  <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-6358"></a>    <span class="n">ZoneNode</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SystemZoneNodeNumber</span>
<a name="ln-6359"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneNode</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6360"></a><span class="k">      </span><span class="n">ZoneMult</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Multiplier</span> <span class="o">*</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ListMultiplier</span>
<a name="ln-6361"></a>      <span class="n">AirDensity</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">PsyWFnTdpPb</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">))</span>
<a name="ln-6362"></a>      <span class="n">AirChangeRate</span> <span class="o">=</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span> <span class="n">SecInHour</span><span class="p">)</span><span class="o">/</span> <span class="p">(</span><span class="n">AirDensity</span> <span class="o">*</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">*</span> <span class="n">ZoneMult</span><span class="p">)</span>
<a name="ln-6363"></a>      <span class="n">SumMdotTemp</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-6364"></a>      <span class="n">SumMdot</span>     <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-6365"></a>      <span class="k">DO </span><span class="n">EquipNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">NumOfEquipTypes</span>
<a name="ln-6366"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">EquipData</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)%</span><span class="n">NumOutlets</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6367"></a><span class="k">          </span><span class="n">thisZoneInletNode</span> <span class="o">=</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">EquipData</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)%</span><span class="n">OutletNodeNums</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-6368"></a>          <span class="k">IF</span> <span class="p">((</span><span class="n">thisZoneInletNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">thisZoneInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6369"></a><span class="k">            </span><span class="n">SumMdotTemp</span> <span class="o">=</span> <span class="n">SumMdotTemp</span> <span class="o">+</span> <span class="n">Node</span><span class="p">(</span><span class="n">thisZoneInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span> <span class="n">Node</span><span class="p">(</span><span class="n">thisZoneInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-6370"></a>            <span class="n">SumMdot</span>     <span class="o">=</span> <span class="n">SumMdot</span>     <span class="o">+</span> <span class="n">Node</span><span class="p">(</span><span class="n">thisZoneInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-6371"></a>          <span class="n">ENDIF</span>
<a name="ln-6372"></a>        <span class="n">ENDIF</span>
<a name="ln-6373"></a>      <span class="n">ENDDO</span>
<a name="ln-6374"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SumMdot</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6375"></a><span class="k">        </span><span class="n">SupplyAirTemp</span> <span class="o">=</span> <span class="n">SumMdotTemp</span> <span class="o">/</span> <span class="n">SumMdot</span>      <span class="c">! mass flow weighted inlet temperature</span>
<a name="ln-6376"></a>      <span class="k">ELSE</span>
<a name="ln-6377"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">thisZoneInletNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6378"></a><span class="k">          </span><span class="n">SupplyAirTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">thisZoneInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-6379"></a>        <span class="k">ELSE</span>
<a name="ln-6380"></a><span class="k">          </span><span class="n">SupplyAirTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-6381"></a>        <span class="n">ENDIF</span>
<a name="ln-6382"></a>      <span class="n">ENDIF</span>
<a name="ln-6383"></a>    <span class="k">ELSE</span>
<a name="ln-6384"></a><span class="k">      </span><span class="n">AirChangeRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-6385"></a>      <span class="n">SupplyAirTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-6386"></a>    <span class="n">ENDIF</span>
<a name="ln-6387"></a>    <span class="n">tmpHc</span> <span class="o">=</span> <span class="n">CalcBeausoleilMorrisonMixedAssistedWall</span><span class="p">((</span><span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">MAT</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)),</span>       <span class="p">&amp;</span>
<a name="ln-6388"></a>                                                               <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvZoneWallHeight</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6389"></a>                                                               <span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>   <span class="p">&amp;</span>
<a name="ln-6390"></a>                                                               <span class="n">SupplyAirTemp</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-6391"></a>                                                               <span class="n">AirChangeRate</span><span class="p">,</span> <span class="n">ZoneNum</span><span class="p">)</span>
<a name="ln-6392"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TAirRef</span> <span class="o">=</span> <span class="n">ZoneMeanAirTemp</span>
<a name="ln-6393"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">HcInt_BeausoleilMorrisonMixedOppossingWall</span><span class="p">)</span>
<a name="ln-6394"></a>    <span class="n">ZoneNum</span> <span class="o">=</span>  <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-6395"></a>    <span class="n">ZoneNode</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SystemZoneNodeNumber</span>
<a name="ln-6396"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6397"></a><span class="k">      </span><span class="n">ZoneMult</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Multiplier</span> <span class="o">*</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ListMultiplier</span>
<a name="ln-6398"></a>      <span class="n">AirDensity</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">PsyWFnTdpPb</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">))</span>
<a name="ln-6399"></a>      <span class="n">AirChangeRate</span> <span class="o">=</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span> <span class="n">SecInHour</span><span class="p">)</span><span class="o">/</span> <span class="p">(</span><span class="n">AirDensity</span> <span class="o">*</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Volume</span><span class="o">*</span> <span class="n">ZoneMult</span><span class="p">)</span>
<a name="ln-6400"></a>      <span class="n">SumMdotTemp</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-6401"></a>      <span class="n">SumMdot</span>     <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-6402"></a>      <span class="k">DO </span><span class="n">EquipNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">NumOfEquipTypes</span>
<a name="ln-6403"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">EquipData</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)%</span><span class="n">NumOutlets</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6404"></a><span class="k">          </span><span class="n">thisZoneInletNode</span> <span class="o">=</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">EquipData</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)%</span><span class="n">OutletNodeNums</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-6405"></a>          <span class="k">IF</span> <span class="p">((</span><span class="n">thisZoneInletNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">thisZoneInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6406"></a><span class="k">            </span><span class="n">SumMdotTemp</span> <span class="o">=</span> <span class="n">SumMdotTemp</span> <span class="o">+</span> <span class="n">Node</span><span class="p">(</span><span class="n">thisZoneInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span> <span class="n">Node</span><span class="p">(</span><span class="n">thisZoneInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-6407"></a>            <span class="n">SumMdot</span>     <span class="o">=</span> <span class="n">SumMdot</span>     <span class="o">+</span> <span class="n">Node</span><span class="p">(</span><span class="n">thisZoneInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-6408"></a>          <span class="n">ENDIF</span>
<a name="ln-6409"></a>        <span class="n">ENDIF</span>
<a name="ln-6410"></a>      <span class="n">ENDDO</span>
<a name="ln-6411"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SumMdot</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6412"></a><span class="k">        </span><span class="n">SupplyAirTemp</span> <span class="o">=</span> <span class="n">SumMdotTemp</span> <span class="o">/</span> <span class="n">SumMdot</span>      <span class="c">! mass flow weighted inlet temperature</span>
<a name="ln-6413"></a>      <span class="k">ELSE</span>
<a name="ln-6414"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">thisZoneInletNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6415"></a><span class="k">          </span><span class="n">SupplyAirTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">thisZoneInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-6416"></a>        <span class="k">ELSE</span>
<a name="ln-6417"></a><span class="k">          </span><span class="n">SupplyAirTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-6418"></a>        <span class="n">ENDIF</span>
<a name="ln-6419"></a>      <span class="n">ENDIF</span>
<a name="ln-6420"></a>    <span class="k">ELSE</span>
<a name="ln-6421"></a><span class="k">      </span><span class="n">AirChangeRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-6422"></a>      <span class="n">SupplyAirTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-6423"></a>    <span class="n">ENDIF</span>
<a name="ln-6424"></a>
<a name="ln-6425"></a>    <span class="n">tmpHc</span> <span class="o">=</span> <span class="n">CalcBeausoleilMorrisonMixedOpposingWall</span><span class="p">((</span><span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">MAT</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)),</span>       <span class="p">&amp;</span>
<a name="ln-6426"></a>                                                               <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvZoneWallHeight</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6427"></a>                                                               <span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>   <span class="p">&amp;</span>
<a name="ln-6428"></a>                                                               <span class="n">SupplyAirTemp</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-6429"></a>                                                               <span class="n">AirChangeRate</span><span class="p">,</span> <span class="n">ZoneNum</span><span class="p">)</span>
<a name="ln-6430"></a>
<a name="ln-6431"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TAirRef</span> <span class="o">=</span> <span class="n">ZoneMeanAirTemp</span>
<a name="ln-6432"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">HcInt_BeausoleilMorrisonMixedStableCeiling</span><span class="p">)</span>
<a name="ln-6433"></a>    <span class="n">ZoneNum</span> <span class="o">=</span>  <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-6434"></a>    <span class="n">ZoneNode</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SystemZoneNodeNumber</span>
<a name="ln-6435"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6436"></a><span class="k">      </span><span class="n">ZoneMult</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Multiplier</span> <span class="o">*</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ListMultiplier</span>
<a name="ln-6437"></a>      <span class="n">AirDensity</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">PsyWFnTdpPb</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">))</span>
<a name="ln-6438"></a>      <span class="n">AirChangeRate</span> <span class="o">=</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span> <span class="n">SecInHour</span><span class="p">)</span><span class="o">/</span> <span class="p">(</span><span class="n">AirDensity</span> <span class="o">*</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">*</span> <span class="n">ZoneMult</span><span class="p">)</span>
<a name="ln-6439"></a>      <span class="n">SumMdotTemp</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-6440"></a>      <span class="n">SumMdot</span>     <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-6441"></a>      <span class="k">DO </span><span class="n">EquipNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">NumOfEquipTypes</span>
<a name="ln-6442"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">EquipData</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)%</span><span class="n">NumOutlets</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6443"></a><span class="k">          </span><span class="n">thisZoneInletNode</span> <span class="o">=</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">EquipData</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)%</span><span class="n">OutletNodeNums</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-6444"></a>          <span class="k">IF</span> <span class="p">((</span><span class="n">thisZoneInletNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">thisZoneInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6445"></a><span class="k">            </span><span class="n">SumMdotTemp</span> <span class="o">=</span> <span class="n">SumMdotTemp</span> <span class="o">+</span> <span class="n">Node</span><span class="p">(</span><span class="n">thisZoneInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span> <span class="n">Node</span><span class="p">(</span><span class="n">thisZoneInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-6446"></a>            <span class="n">SumMdot</span>     <span class="o">=</span> <span class="n">SumMdot</span>     <span class="o">+</span> <span class="n">Node</span><span class="p">(</span><span class="n">thisZoneInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-6447"></a>          <span class="n">ENDIF</span>
<a name="ln-6448"></a>        <span class="n">ENDIF</span>
<a name="ln-6449"></a>      <span class="n">ENDDO</span>
<a name="ln-6450"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SumMdot</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6451"></a><span class="k">        </span><span class="n">SupplyAirTemp</span> <span class="o">=</span> <span class="n">SumMdotTemp</span> <span class="o">/</span> <span class="n">SumMdot</span>      <span class="c">! mass flow weighted inlet temperature</span>
<a name="ln-6452"></a>      <span class="k">ELSE</span>
<a name="ln-6453"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">thisZoneInletNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6454"></a><span class="k">          </span><span class="n">SupplyAirTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">thisZoneInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-6455"></a>        <span class="k">ELSE</span>
<a name="ln-6456"></a><span class="k">          </span><span class="n">SupplyAirTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-6457"></a>        <span class="n">ENDIF</span>
<a name="ln-6458"></a>      <span class="n">ENDIF</span>
<a name="ln-6459"></a>    <span class="k">ELSE</span>
<a name="ln-6460"></a><span class="k">      </span><span class="n">AirChangeRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-6461"></a>      <span class="n">SupplyAirTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-6462"></a>    <span class="n">ENDIF</span>
<a name="ln-6463"></a>    <span class="n">tmpHc</span> <span class="o">=</span> <span class="n">CalcBeausoleilMorrisonMixedStableCeiling</span><span class="p">((</span><span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">MAT</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)),</span>       <span class="p">&amp;</span>
<a name="ln-6464"></a>                                                               <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvZoneHorizHydrDiam</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6465"></a>                                                               <span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>   <span class="p">&amp;</span>
<a name="ln-6466"></a>                                                               <span class="n">SupplyAirTemp</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-6467"></a>                                                               <span class="n">AirChangeRate</span><span class="p">,</span> <span class="n">ZoneNum</span><span class="p">)</span>
<a name="ln-6468"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TAirRef</span> <span class="o">=</span> <span class="n">ZoneMeanAirTemp</span>
<a name="ln-6469"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">HcInt_BeausoleilMorrisonMixedUnstableCeiling</span><span class="p">)</span>
<a name="ln-6470"></a>    <span class="n">ZoneNum</span> <span class="o">=</span>  <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-6471"></a>    <span class="n">ZoneNode</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SystemZoneNodeNumber</span>
<a name="ln-6472"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6473"></a><span class="k">      </span><span class="n">ZoneMult</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Multiplier</span> <span class="o">*</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ListMultiplier</span>
<a name="ln-6474"></a>      <span class="n">AirDensity</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">PsyWFnTdpPb</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">))</span>
<a name="ln-6475"></a>      <span class="n">AirChangeRate</span> <span class="o">=</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span> <span class="n">SecInHour</span><span class="p">)</span><span class="o">/</span> <span class="p">(</span><span class="n">AirDensity</span> <span class="o">*</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">*</span> <span class="n">ZoneMult</span><span class="p">)</span>
<a name="ln-6476"></a>      <span class="n">SumMdotTemp</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-6477"></a>      <span class="n">SumMdot</span>     <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-6478"></a>      <span class="k">DO </span><span class="n">EquipNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">NumOfEquipTypes</span>
<a name="ln-6479"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">EquipData</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)%</span><span class="n">NumOutlets</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6480"></a><span class="k">          </span><span class="n">thisZoneInletNode</span> <span class="o">=</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">EquipData</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)%</span><span class="n">OutletNodeNums</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-6481"></a>          <span class="k">IF</span> <span class="p">((</span><span class="n">thisZoneInletNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">thisZoneInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6482"></a><span class="k">            </span><span class="n">SumMdotTemp</span> <span class="o">=</span> <span class="n">SumMdotTemp</span> <span class="o">+</span> <span class="n">Node</span><span class="p">(</span><span class="n">thisZoneInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span> <span class="n">Node</span><span class="p">(</span><span class="n">thisZoneInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-6483"></a>            <span class="n">SumMdot</span>     <span class="o">=</span> <span class="n">SumMdot</span>     <span class="o">+</span> <span class="n">Node</span><span class="p">(</span><span class="n">thisZoneInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-6484"></a>          <span class="n">ENDIF</span>
<a name="ln-6485"></a>        <span class="n">ENDIF</span>
<a name="ln-6486"></a>      <span class="n">ENDDO</span>
<a name="ln-6487"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SumMdot</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6488"></a><span class="k">        </span><span class="n">SupplyAirTemp</span> <span class="o">=</span> <span class="n">SumMdotTemp</span> <span class="o">/</span> <span class="n">SumMdot</span>      <span class="c">! mass flow weighted inlet temperature</span>
<a name="ln-6489"></a>      <span class="k">ELSE</span>
<a name="ln-6490"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">thisZoneInletNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6491"></a><span class="k">          </span><span class="n">SupplyAirTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">thisZoneInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-6492"></a>        <span class="k">ELSE</span>
<a name="ln-6493"></a><span class="k">          </span><span class="n">SupplyAirTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-6494"></a>        <span class="n">ENDIF</span>
<a name="ln-6495"></a>      <span class="n">ENDIF</span>
<a name="ln-6496"></a>    <span class="k">ELSE</span>
<a name="ln-6497"></a><span class="k">      </span><span class="n">AirChangeRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-6498"></a>      <span class="n">SupplyAirTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-6499"></a>    <span class="n">ENDIF</span>
<a name="ln-6500"></a>    <span class="n">tmpHc</span> <span class="o">=</span> <span class="n">CalcBeausoleilMorrisonMixedUnstableCeiling</span><span class="p">((</span><span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">MAT</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)),</span>       <span class="p">&amp;</span>
<a name="ln-6501"></a>                                                               <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvZoneHorizHydrDiam</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6502"></a>                                                               <span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>   <span class="p">&amp;</span>
<a name="ln-6503"></a>                                                               <span class="n">SupplyAirTemp</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-6504"></a>                                                               <span class="n">AirChangeRate</span><span class="p">,</span> <span class="n">ZoneNum</span><span class="p">)</span>
<a name="ln-6505"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TAirRef</span> <span class="o">=</span> <span class="n">ZoneMeanAirTemp</span>
<a name="ln-6506"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">HcInt_BeausoleilMorrisonMixedStableFloor</span><span class="p">)</span>
<a name="ln-6507"></a>    <span class="n">ZoneNum</span>  <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-6508"></a>    <span class="n">ZoneNode</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SystemZoneNodeNumber</span>
<a name="ln-6509"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6510"></a><span class="k">      </span><span class="n">ZoneMult</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Multiplier</span> <span class="o">*</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ListMultiplier</span>
<a name="ln-6511"></a>      <span class="n">AirDensity</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">PsyWFnTdpPb</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">))</span>
<a name="ln-6512"></a>      <span class="n">AirChangeRate</span> <span class="o">=</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span> <span class="n">SecInHour</span><span class="p">)</span><span class="o">/</span> <span class="p">(</span><span class="n">AirDensity</span> <span class="o">*</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">*</span> <span class="n">ZoneMult</span><span class="p">)</span>
<a name="ln-6513"></a>      <span class="n">SumMdotTemp</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-6514"></a>      <span class="n">SumMdot</span>     <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-6515"></a>      <span class="k">DO </span><span class="n">EquipNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">NumOfEquipTypes</span>
<a name="ln-6516"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">EquipData</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)%</span><span class="n">NumOutlets</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6517"></a><span class="k">          </span><span class="n">thisZoneInletNode</span> <span class="o">=</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">EquipData</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)%</span><span class="n">OutletNodeNums</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-6518"></a>          <span class="k">IF</span> <span class="p">((</span><span class="n">thisZoneInletNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">thisZoneInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6519"></a><span class="k">            </span><span class="n">SumMdotTemp</span> <span class="o">=</span> <span class="n">SumMdotTemp</span> <span class="o">+</span> <span class="n">Node</span><span class="p">(</span><span class="n">thisZoneInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span> <span class="n">Node</span><span class="p">(</span><span class="n">thisZoneInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-6520"></a>            <span class="n">SumMdot</span>     <span class="o">=</span> <span class="n">SumMdot</span>     <span class="o">+</span> <span class="n">Node</span><span class="p">(</span><span class="n">thisZoneInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-6521"></a>          <span class="n">ENDIF</span>
<a name="ln-6522"></a>        <span class="n">ENDIF</span>
<a name="ln-6523"></a>      <span class="n">ENDDO</span>
<a name="ln-6524"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SumMdot</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6525"></a><span class="k">        </span><span class="n">SupplyAirTemp</span> <span class="o">=</span> <span class="n">SumMdotTemp</span> <span class="o">/</span> <span class="n">SumMdot</span>      <span class="c">! mass flow weighted inlet temperature</span>
<a name="ln-6526"></a>      <span class="k">ELSE</span>
<a name="ln-6527"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">thisZoneInletNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6528"></a><span class="k">          </span><span class="n">SupplyAirTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">thisZoneInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-6529"></a>        <span class="k">ELSE</span>
<a name="ln-6530"></a><span class="k">          </span><span class="n">SupplyAirTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-6531"></a>        <span class="n">ENDIF</span>
<a name="ln-6532"></a>      <span class="n">ENDIF</span>
<a name="ln-6533"></a>    <span class="k">ELSE</span>
<a name="ln-6534"></a><span class="k">      </span><span class="n">AirChangeRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-6535"></a>      <span class="n">SupplyAirTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-6536"></a>    <span class="n">ENDIF</span>
<a name="ln-6537"></a>    <span class="n">tmpHc</span> <span class="o">=</span> <span class="n">CalcBeausoleilMorrisonMixedStableFloor</span><span class="p">((</span><span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">MAT</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)),</span>       <span class="p">&amp;</span>
<a name="ln-6538"></a>                                                               <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvZoneHorizHydrDiam</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6539"></a>                                                               <span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>   <span class="p">&amp;</span>
<a name="ln-6540"></a>                                                               <span class="n">SupplyAirTemp</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-6541"></a>                                                               <span class="n">AirChangeRate</span><span class="p">,</span> <span class="n">ZoneNum</span><span class="p">)</span>
<a name="ln-6542"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TAirRef</span> <span class="o">=</span> <span class="n">ZoneMeanAirTemp</span>
<a name="ln-6543"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">HcInt_BeausoleilMorrisonMixedUnstableFloor</span><span class="p">)</span>
<a name="ln-6544"></a>    <span class="n">ZoneNum</span> <span class="o">=</span>  <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-6545"></a>    <span class="n">ZoneNode</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SystemZoneNodeNumber</span>
<a name="ln-6546"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneNode</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6547"></a><span class="k">      </span><span class="n">ZoneMult</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Multiplier</span> <span class="o">*</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ListMultiplier</span>
<a name="ln-6548"></a>      <span class="n">AirDensity</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">PsyWFnTdpPb</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">))</span>
<a name="ln-6549"></a>      <span class="n">AirChangeRate</span> <span class="o">=</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span> <span class="n">SecInHour</span><span class="p">)</span><span class="o">/</span> <span class="p">(</span><span class="n">AirDensity</span> <span class="o">*</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Volume</span>  <span class="o">*</span> <span class="n">ZoneMult</span><span class="p">)</span>
<a name="ln-6550"></a>      <span class="n">SumMdotTemp</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-6551"></a>      <span class="n">SumMdot</span>     <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-6552"></a>      <span class="k">DO </span><span class="n">EquipNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">NumOfEquipTypes</span>
<a name="ln-6553"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">EquipData</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)%</span><span class="n">NumOutlets</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6554"></a><span class="k">          </span><span class="n">thisZoneInletNode</span> <span class="o">=</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">EquipData</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)%</span><span class="n">OutletNodeNums</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-6555"></a>          <span class="k">IF</span> <span class="p">((</span><span class="n">thisZoneInletNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">thisZoneInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6556"></a><span class="k">            </span><span class="n">SumMdotTemp</span> <span class="o">=</span> <span class="n">SumMdotTemp</span> <span class="o">+</span> <span class="n">Node</span><span class="p">(</span><span class="n">thisZoneInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span> <span class="n">Node</span><span class="p">(</span><span class="n">thisZoneInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-6557"></a>            <span class="n">SumMdot</span>     <span class="o">=</span> <span class="n">SumMdot</span>     <span class="o">+</span> <span class="n">Node</span><span class="p">(</span><span class="n">thisZoneInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-6558"></a>          <span class="n">ENDIF</span>
<a name="ln-6559"></a>        <span class="n">ENDIF</span>
<a name="ln-6560"></a>      <span class="n">ENDDO</span>
<a name="ln-6561"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SumMdot</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6562"></a><span class="k">        </span><span class="n">SupplyAirTemp</span> <span class="o">=</span> <span class="n">SumMdotTemp</span> <span class="o">/</span> <span class="n">SumMdot</span>      <span class="c">! mass flow weighted inlet temperature</span>
<a name="ln-6563"></a>      <span class="k">ELSE</span>
<a name="ln-6564"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">thisZoneInletNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6565"></a><span class="k">          </span><span class="n">SupplyAirTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">thisZoneInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-6566"></a>        <span class="k">ELSE</span>
<a name="ln-6567"></a><span class="k">          </span><span class="n">SupplyAirTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-6568"></a>        <span class="n">ENDIF</span>
<a name="ln-6569"></a>      <span class="n">ENDIF</span>
<a name="ln-6570"></a>    <span class="k">ELSE</span>
<a name="ln-6571"></a><span class="k">      </span><span class="n">AirChangeRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-6572"></a>      <span class="n">SupplyAirTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-6573"></a>    <span class="n">ENDIF</span>
<a name="ln-6574"></a>    <span class="n">tmpHc</span> <span class="o">=</span> <span class="n">CalcBeausoleilMorrisonMixedUnstableFloor</span><span class="p">((</span><span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">MAT</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)),</span>       <span class="p">&amp;</span>
<a name="ln-6575"></a>                                                               <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvZoneHorizHydrDiam</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6576"></a>                                                               <span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>   <span class="p">&amp;</span>
<a name="ln-6577"></a>                                                               <span class="n">SupplyAirTemp</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-6578"></a>                                                               <span class="n">AirChangeRate</span><span class="p">,</span> <span class="n">ZoneNum</span><span class="p">)</span>
<a name="ln-6579"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TAirRef</span> <span class="o">=</span> <span class="n">ZoneMeanAirTemp</span>
<a name="ln-6580"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">HcInt_FohannoPolidoriVerticalWall</span><span class="p">)</span>
<a name="ln-6581"></a>    <span class="n">ZoneNum</span> <span class="o">=</span>  <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-6582"></a>    <span class="n">tmpHc</span> <span class="o">=</span> <span class="n">CalcFohannoPolidoriVerticalWall</span><span class="p">((</span><span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">MAT</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-6583"></a>                                    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvZoneWallHeight</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6584"></a>                                    <span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-6585"></a>                                    <span class="o">-</span> <span class="n">QdotConvInRepPerArea</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">),</span> <span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-6586"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TAirRef</span> <span class="o">=</span> <span class="n">ZoneMeanAirTemp</span>
<a name="ln-6587"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">HcInt_KaradagChilledCeiling</span><span class="p">)</span>
<a name="ln-6588"></a>    <span class="n">ZoneNum</span> <span class="o">=</span>  <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-6589"></a>    <span class="n">tmpHc</span> <span class="o">=</span> <span class="n">CalcKaradagChilledCeiling</span><span class="p">((</span><span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">MAT</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)))</span>
<a name="ln-6590"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TAirRef</span> <span class="o">=</span> <span class="n">ZoneMeanAirTemp</span>
<a name="ln-6591"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">HcInt_ISO15099Windows</span><span class="p">)</span>
<a name="ln-6592"></a>    <span class="n">ZoneNum</span> <span class="o">=</span>  <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-6593"></a>    <span class="k">CALL </span><span class="n">CalcISO15099WindowIntConvCoeff</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">MAT</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">))</span>
<a name="ln-6594"></a>    <span class="n">tmpHc</span> <span class="o">=</span> <span class="n">HconvIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-6595"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TAirRef</span> <span class="o">=</span> <span class="n">ZoneMeanAirTemp</span>
<a name="ln-6596"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">HcInt_GoldsteinNovoselacCeilingDiffuserWindow</span><span class="p">)</span>
<a name="ln-6597"></a>    <span class="n">ZoneNum</span> <span class="o">=</span>  <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-6598"></a>    <span class="n">ZoneNode</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SystemZoneNodeNumber</span>
<a name="ln-6599"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6600"></a><span class="k">      </span><span class="n">ZoneMult</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Multiplier</span> <span class="o">*</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ListMultiplier</span>
<a name="ln-6601"></a>      <span class="n">AirDensity</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">PsyWFnTdpPb</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">))</span>
<a name="ln-6602"></a>      <span class="n">AirSystemVolFlowRate</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">/</span><span class="p">(</span><span class="n">AirDensity</span> <span class="o">*</span> <span class="n">ZoneMult</span><span class="p">)</span>
<a name="ln-6603"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TAirRef</span> <span class="o">=</span> <span class="n">ZoneSupplyAirTemp</span>
<a name="ln-6604"></a>    <span class="k">ELSE</span>
<a name="ln-6605"></a><span class="k">      </span><span class="n">AirSystemVolFlowRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-6606"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TAirRef</span> <span class="o">=</span> <span class="n">ZoneMeanAirTemp</span>
<a name="ln-6607"></a>    <span class="n">ENDIF</span>
<a name="ln-6608"></a>    <span class="n">tmpHc</span> <span class="o">=</span> <span class="n">CalcGoldsteinNovoselacCeilingDiffuserWindow</span><span class="p">(</span><span class="n">AirSystemVolFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6609"></a>                             <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvZonePerimLength</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6610"></a>                             <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvWindowWallRatio</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6611"></a>                             <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvWindowLocation</span><span class="p">,</span> <span class="n">ZoneNum</span><span class="p">)</span>
<a name="ln-6612"></a>
<a name="ln-6613"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">HcInt_GoldsteinNovoselacCeilingDiffuserWalls</span><span class="p">)</span>
<a name="ln-6614"></a>    <span class="n">ZoneNum</span> <span class="o">=</span>  <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-6615"></a>    <span class="n">ZoneNode</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SystemZoneNodeNumber</span>
<a name="ln-6616"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6617"></a><span class="k">      </span><span class="n">ZoneMult</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Multiplier</span> <span class="o">*</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ListMultiplier</span>
<a name="ln-6618"></a>      <span class="n">AirDensity</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">PsyWFnTdpPb</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">))</span>
<a name="ln-6619"></a>      <span class="n">AirSystemVolFlowRate</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">/</span><span class="p">(</span><span class="n">AirDensity</span> <span class="o">*</span> <span class="n">ZoneMult</span><span class="p">)</span>
<a name="ln-6620"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TAirRef</span> <span class="o">=</span> <span class="n">ZoneSupplyAirTemp</span>
<a name="ln-6621"></a>    <span class="k">ELSE</span>
<a name="ln-6622"></a><span class="k">      </span><span class="n">AirSystemVolFlowRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-6623"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TAirRef</span> <span class="o">=</span> <span class="n">ZoneMeanAirTemp</span>
<a name="ln-6624"></a>    <span class="n">ENDIF</span>
<a name="ln-6625"></a>    <span class="n">tmpHc</span> <span class="o">=</span> <span class="n">CalcGoldsteinNovoselacCeilingDiffuserWall</span><span class="p">(</span><span class="n">AirSystemVolFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6626"></a>                            <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvZonePerimLength</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6627"></a>                            <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvWindowLocation</span><span class="p">,</span> <span class="n">ZoneNum</span> <span class="p">)</span>
<a name="ln-6628"></a>
<a name="ln-6629"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">HcInt_GoldsteinNovoselacCeilingDiffuserFloor</span><span class="p">)</span>
<a name="ln-6630"></a>    <span class="n">ZoneNum</span> <span class="o">=</span>  <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-6631"></a>    <span class="n">ZoneNode</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SystemZoneNodeNumber</span>
<a name="ln-6632"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6633"></a><span class="k">      </span><span class="n">ZoneMult</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Multiplier</span> <span class="o">*</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ListMultiplier</span>
<a name="ln-6634"></a>      <span class="n">AirDensity</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">PsyWFnTdpPb</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">))</span>
<a name="ln-6635"></a>      <span class="n">AirSystemVolFlowRate</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">/</span> <span class="p">(</span><span class="n">AirDensity</span> <span class="o">*</span> <span class="n">ZoneMult</span><span class="p">)</span>
<a name="ln-6636"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TAirRef</span> <span class="o">=</span> <span class="n">ZoneSupplyAirTemp</span>
<a name="ln-6637"></a>    <span class="k">ELSE</span>
<a name="ln-6638"></a><span class="k">      </span><span class="n">AirSystemVolFlowRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-6639"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TAirRef</span> <span class="o">=</span> <span class="n">ZoneMeanAirTemp</span>
<a name="ln-6640"></a>    <span class="n">ENDIF</span>
<a name="ln-6641"></a>    <span class="n">tmpHc</span> <span class="o">=</span> <span class="n">CalcGoldsteinNovoselacCeilingDiffuserFloor</span><span class="p">(</span><span class="n">AirSystemVolFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6642"></a>                            <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvZonePerimLength</span><span class="p">,</span> <span class="n">ZoneNum</span> <span class="p">)</span>
<a name="ln-6643"></a>
<a name="ln-6644"></a>  <span class="k">END SELECT</span>
<a name="ln-6645"></a>
<a name="ln-6646"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">tmpHc</span> <span class="o">&lt;</span> <span class="n">AdaptiveHcInsideLowLimit</span><span class="p">)</span> <span class="n">tmpHc</span> <span class="o">=</span> <span class="n">AdaptiveHcInsideLowLimit</span>
<a name="ln-6647"></a>
<a name="ln-6648"></a>  <span class="n">Hc</span> <span class="o">=</span> <span class="n">tmpHc</span>
<a name="ln-6649"></a>
<a name="ln-6650"></a>  <span class="k">RETURN</span>
<a name="ln-6651"></a>
<a name="ln-6652"></a><span class="k">END SUBROUTINE </span><span class="n">EvaluateIntHcModels</span>
<a name="ln-6653"></a>
<a name="ln-6654"></a>
<a name="ln-6655"></a><span class="k">SUBROUTINE </span><span class="n">EvaluateExtHcModels</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span> <span class="n">NaturalConvModelEqNum</span><span class="p">,</span> <span class="n">ForcedConvModelEqNum</span><span class="p">,</span> <span class="n">Hc</span><span class="p">)</span>
<a name="ln-6656"></a>
<a name="ln-6657"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6658"></a>          <span class="c">!       AUTHOR         Brent Grifith</span>
<a name="ln-6659"></a>          <span class="c">!       DATE WRITTEN   Aug 2010</span>
<a name="ln-6660"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6661"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6662"></a>
<a name="ln-6663"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6664"></a>          <span class="c">! central case statement for evaluating exterior specific convection models</span>
<a name="ln-6665"></a>
<a name="ln-6666"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6667"></a>          <span class="c">! separated out long case statement for selecting models.</span>
<a name="ln-6668"></a>
<a name="ln-6669"></a>
<a name="ln-6670"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6671"></a>          <span class="c">!</span>
<a name="ln-6672"></a>
<a name="ln-6673"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6674"></a>  <span class="k">USE </span><span class="n">DataHeatBalSurface</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TH</span><span class="p">,</span> <span class="n">QdotConvOutRepPerArea</span>
<a name="ln-6675"></a>  <span class="k">USE </span><span class="n">DataEnvironment</span>   <span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">WindSpeed</span><span class="p">,</span> <span class="n">WindDir</span>
<a name="ln-6676"></a>
<a name="ln-6677"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6678"></a>
<a name="ln-6679"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6680"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfNum</span>
<a name="ln-6681"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NaturalConvModelEqNum</span>
<a name="ln-6682"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ForcedConvModelEqNum</span>
<a name="ln-6683"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Hc</span>
<a name="ln-6684"></a>
<a name="ln-6685"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6686"></a>          <span class="c">! na</span>
<a name="ln-6687"></a>
<a name="ln-6688"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-6689"></a>          <span class="c">! na</span>
<a name="ln-6690"></a>
<a name="ln-6691"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-6692"></a>          <span class="c">! na</span>
<a name="ln-6693"></a>
<a name="ln-6694"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6695"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Hf</span> <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! the forced, or wind driven portion of film coefficient</span>
<a name="ln-6696"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Hn</span> <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! the natural, or bouyancy driven portion of film coefficient</span>
<a name="ln-6697"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ConstructNum</span>
<a name="ln-6698"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfWindSpeed</span>
<a name="ln-6699"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HydraulicDiameter</span>
<a name="ln-6700"></a>
<a name="ln-6701"></a>  <span class="c">! first call Hn models</span>
<a name="ln-6702"></a>  <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">NaturalConvModelEqNum</span><span class="p">)</span>
<a name="ln-6703"></a>
<a name="ln-6704"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">HcExt_None</span><span class="p">)</span>
<a name="ln-6705"></a>    <span class="n">Hn</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-6706"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">HcExt_UserCurve</span><span class="p">)</span>
<a name="ln-6707"></a>
<a name="ln-6708"></a>   <span class="k">CALL </span><span class="n">CalcUserDefinedOutsideHcModel</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvHnUserCurveIndex</span><span class="p">,</span> <span class="n">Hn</span><span class="p">)</span>
<a name="ln-6709"></a>
<a name="ln-6710"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">HcExt_NaturalASHRAEVerticalWall</span><span class="p">)</span>
<a name="ln-6711"></a>    <span class="n">Hn</span> <span class="o">=</span> <span class="n">CalcASHRAEVerticalWall</span><span class="p">(</span> <span class="p">(</span><span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutDryBulbTemp</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-6712"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">HcExt_NaturalWaltonUnstableHorizontalOrTilt</span><span class="p">)</span>
<a name="ln-6713"></a>    <span class="n">Hn</span> <span class="o">=</span> <span class="n">CalcWaltonUnstableHorizontalOrTilt</span><span class="p">(</span> <span class="p">(</span><span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutDryBulbTemp</span><span class="p">)</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6714"></a>                                             <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span> <span class="p">)</span> <span class="c">!TODO verify CosTilt in vs out</span>
<a name="ln-6715"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">HcExt_NaturalWaltonStableHorizontalOrTilt</span><span class="p">)</span>
<a name="ln-6716"></a>    <span class="n">Hn</span> <span class="o">=</span> <span class="n">CalcWaltonStableHorizontalOrTilt</span><span class="p">(</span> <span class="p">(</span><span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutDryBulbTemp</span><span class="p">)</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6717"></a>                                             <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span> <span class="p">)</span> <span class="c">!TODO verify CosTilt in vs out</span>
<a name="ln-6718"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">HcExt_AlamdariHammondVerticalWall</span><span class="p">)</span>
<a name="ln-6719"></a>
<a name="ln-6720"></a>    <span class="n">Hn</span> <span class="o">=</span> <span class="n">CalcAlamdariHammondVerticalWall</span><span class="p">(</span> <span class="p">(</span><span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutDryBulbTemp</span><span class="p">)</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6721"></a>                                          <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvFaceHeight</span> <span class="p">,</span> <span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-6722"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">HcExt_FohannoPolidoriVerticalWall</span><span class="p">)</span>
<a name="ln-6723"></a>    <span class="n">Hn</span> <span class="o">=</span> <span class="n">CalcFohannoPolidoriVerticalWall</span><span class="p">(</span> <span class="p">(</span><span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutDryBulbTemp</span><span class="p">)</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6724"></a>                                          <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvFaceHeight</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6725"></a>                                          <span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-6726"></a>                                          <span class="o">-</span><span class="n">QdotConvOutRepPerArea</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="p">,</span> <span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-6727"></a><span class="c">!  CASE (HcExt_ISO15099Windows)</span>
<a name="ln-6728"></a>
<a name="ln-6729"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">HcExt_AlamdariHammondStableHorizontal</span><span class="p">)</span>
<a name="ln-6730"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvFacePerimeter</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6731"></a><span class="k">      </span><span class="n">HydraulicDiameter</span> <span class="o">=</span> <span class="mf">4.d0</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvFaceArea</span> <span class="o">/</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvFacePerimeter</span>
<a name="ln-6732"></a>    <span class="k">ELSE</span>
<a name="ln-6733"></a><span class="k">      </span><span class="n">HydraulicDiameter</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvFaceArea</span><span class="p">)</span>
<a name="ln-6734"></a>    <span class="n">ENDIF</span>
<a name="ln-6735"></a>    <span class="n">Hn</span> <span class="o">=</span> <span class="n">CalcAlamdariHammondStableHorizontal</span><span class="p">((</span><span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutDryBulbTemp</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-6736"></a>                                               <span class="n">HydraulicDiameter</span><span class="p">,</span> <span class="n">SurfNum</span> <span class="p">)</span>
<a name="ln-6737"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">HcExt_AlamdariHammondUnstableHorizontal</span><span class="p">)</span>
<a name="ln-6738"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvFacePerimeter</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6739"></a><span class="k">      </span><span class="n">HydraulicDiameter</span> <span class="o">=</span> <span class="mf">4.d0</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvFaceArea</span> <span class="o">/</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvFacePerimeter</span>
<a name="ln-6740"></a>    <span class="k">ELSE</span>
<a name="ln-6741"></a><span class="k">      </span><span class="n">HydraulicDiameter</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvFaceArea</span><span class="p">)</span>
<a name="ln-6742"></a>    <span class="n">ENDIF</span>
<a name="ln-6743"></a>    <span class="n">Hn</span> <span class="o">=</span> <span class="n">CalcAlamdariHammondUnstableHorizontal</span><span class="p">((</span><span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutDryBulbTemp</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-6744"></a>                                               <span class="n">HydraulicDiameter</span><span class="p">,</span> <span class="n">SurfNum</span> <span class="p">)</span>
<a name="ln-6745"></a>  <span class="k">END SELECT</span>
<a name="ln-6746"></a>
<a name="ln-6747"></a>
<a name="ln-6748"></a><span class="k">  SELECT CASE</span> <span class="p">(</span><span class="n">ForcedConvModelEqNum</span><span class="p">)</span>
<a name="ln-6749"></a>
<a name="ln-6750"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">HcExt_None</span><span class="p">)</span>
<a name="ln-6751"></a>    <span class="n">Hf</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-6752"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">HcExt_UserCurve</span><span class="p">)</span>
<a name="ln-6753"></a>   <span class="k">Call </span><span class="n">CalcUserDefinedOutsideHcModel</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvHfUserCurveIndex</span><span class="p">,</span> <span class="n">Hf</span><span class="p">)</span>
<a name="ln-6754"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">HcExt_SparrowWindward</span><span class="p">)</span>
<a name="ln-6755"></a>    <span class="n">ConstructNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-6756"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtWind</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6757"></a><span class="k">      </span><span class="n">SurfWindSpeed</span> <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! No wind exposure</span>
<a name="ln-6758"></a>    <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">==</span> <span class="n">ExtShadeOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6759"></a><span class="k">      </span><span class="n">SurfWindSpeed</span> <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! Assume zero wind speed at outside glass surface of window with exterior shade</span>
<a name="ln-6760"></a>    <span class="k">ELSE</span>
<a name="ln-6761"></a><span class="k">      </span><span class="n">SurfWindSpeed</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindSpeed</span>
<a name="ln-6762"></a>    <span class="n">ENDIF</span>
<a name="ln-6763"></a>    <span class="n">Hf</span> <span class="o">=</span> <span class="n">CalcSparrowWindward</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstructNum</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="n">Roughness</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6764"></a>                             <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvFacePerimeter</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6765"></a>                             <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvFaceArea</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6766"></a>                             <span class="n">SurfWindSpeed</span> <span class="p">,</span> <span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-6767"></a>
<a name="ln-6768"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">HcExt_SparrowLeeward</span><span class="p">)</span>
<a name="ln-6769"></a>    <span class="n">ConstructNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-6770"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtWind</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6771"></a><span class="k">      </span><span class="n">SurfWindSpeed</span> <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! No wind exposure</span>
<a name="ln-6772"></a>    <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">==</span> <span class="n">ExtShadeOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6773"></a><span class="k">      </span><span class="n">SurfWindSpeed</span> <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! Assume zero wind speed at outside glass surface of window with exterior shade</span>
<a name="ln-6774"></a>    <span class="k">ELSE</span>
<a name="ln-6775"></a><span class="k">      </span><span class="n">SurfWindSpeed</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindSpeed</span>
<a name="ln-6776"></a>    <span class="n">ENDIF</span>
<a name="ln-6777"></a>    <span class="n">Hf</span> <span class="o">=</span> <span class="n">CalcSparrowLeeward</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstructNum</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="n">Roughness</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6778"></a>                             <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvFacePerimeter</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6779"></a>                             <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvFaceArea</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6780"></a>                             <span class="n">SurfWindSpeed</span><span class="p">,</span> <span class="n">SurfNum</span> <span class="p">)</span>
<a name="ln-6781"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">HcExt_MoWiTTWindward</span><span class="p">)</span>
<a name="ln-6782"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtWind</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6783"></a><span class="k">      </span><span class="n">SurfWindSpeed</span> <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! No wind exposure</span>
<a name="ln-6784"></a>    <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">==</span> <span class="n">ExtShadeOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6785"></a><span class="k">      </span><span class="n">SurfWindSpeed</span> <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! Assume zero wind speed at outside glass surface of window with exterior shade</span>
<a name="ln-6786"></a>    <span class="k">ELSE</span>
<a name="ln-6787"></a><span class="k">      </span><span class="n">SurfWindSpeed</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindSpeed</span>
<a name="ln-6788"></a>    <span class="n">ENDIF</span>
<a name="ln-6789"></a>    <span class="n">Hf</span> <span class="o">=</span> <span class="n">CalcMoWITTWindward</span><span class="p">(</span> <span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutDryBulbTemp</span><span class="p">,</span> <span class="n">SurfWindSpeed</span><span class="p">)</span>
<a name="ln-6790"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">HcExt_MoWiTTLeeward</span><span class="p">)</span>
<a name="ln-6791"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtWind</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6792"></a><span class="k">      </span><span class="n">SurfWindSpeed</span> <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! No wind exposure</span>
<a name="ln-6793"></a>    <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">==</span> <span class="n">ExtShadeOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6794"></a><span class="k">      </span><span class="n">SurfWindSpeed</span> <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! Assume zero wind speed at outside glass surface of window with exterior shade</span>
<a name="ln-6795"></a>    <span class="k">ELSE</span>
<a name="ln-6796"></a><span class="k">      </span><span class="n">SurfWindSpeed</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindSpeed</span>
<a name="ln-6797"></a>    <span class="n">ENDIF</span>
<a name="ln-6798"></a>    <span class="n">Hf</span> <span class="o">=</span> <span class="n">CalcMoWITTLeeward</span><span class="p">(</span> <span class="p">(</span><span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutDryBulbTemp</span><span class="p">),</span> <span class="n">SurfWindSpeed</span><span class="p">)</span>
<a name="ln-6799"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">HcExt_DOE2Windward</span><span class="p">)</span>
<a name="ln-6800"></a>    <span class="n">ConstructNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-6801"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtWind</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6802"></a><span class="k">      </span><span class="n">SurfWindSpeed</span> <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! No wind exposure</span>
<a name="ln-6803"></a>    <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">==</span> <span class="n">ExtShadeOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6804"></a><span class="k">      </span><span class="n">SurfWindSpeed</span> <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! Assume zero wind speed at outside glass surface of window with exterior shade</span>
<a name="ln-6805"></a>    <span class="k">ELSE</span>
<a name="ln-6806"></a><span class="k">      </span><span class="n">SurfWindSpeed</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindSpeed</span>
<a name="ln-6807"></a>    <span class="n">ENDIF</span>
<a name="ln-6808"></a>    <span class="n">Hf</span> <span class="o">=</span> <span class="n">CalcDOE2Windward</span><span class="p">(</span><span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutDryBulbTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6809"></a>                          <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="p">,</span> <span class="n">SurfWindSpeed</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6810"></a>                          <span class="n">Material</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstructNum</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="n">Roughness</span><span class="p">)</span>
<a name="ln-6811"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">HcExt_DOE2Leeward</span><span class="p">)</span>
<a name="ln-6812"></a>    <span class="n">ConstructNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-6813"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtWind</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6814"></a><span class="k">      </span><span class="n">SurfWindSpeed</span> <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! No wind exposure</span>
<a name="ln-6815"></a>    <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">==</span> <span class="n">ExtShadeOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6816"></a><span class="k">      </span><span class="n">SurfWindSpeed</span> <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! Assume zero wind speed at outside glass surface of window with exterior shade</span>
<a name="ln-6817"></a>    <span class="k">ELSE</span>
<a name="ln-6818"></a><span class="k">      </span><span class="n">SurfWindSpeed</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindSpeed</span>
<a name="ln-6819"></a>    <span class="n">ENDIF</span>
<a name="ln-6820"></a>    <span class="n">Hf</span> <span class="o">=</span> <span class="n">CalcDOE2Leeward</span><span class="p">(</span><span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutDryBulbTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6821"></a>                          <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="p">,</span> <span class="n">SurfWindSpeed</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6822"></a>                          <span class="n">Material</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstructNum</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="n">Roughness</span><span class="p">)</span>
<a name="ln-6823"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">HcExt_NusseltJurges</span><span class="p">)</span>
<a name="ln-6824"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtWind</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6825"></a><span class="k">      </span><span class="n">SurfWindSpeed</span> <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! No wind exposure</span>
<a name="ln-6826"></a>    <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">==</span> <span class="n">ExtShadeOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6827"></a><span class="k">      </span><span class="n">SurfWindSpeed</span> <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! Assume zero wind speed at outside glass surface of window with exterior shade</span>
<a name="ln-6828"></a>    <span class="k">ELSE</span>
<a name="ln-6829"></a><span class="k">      </span><span class="n">SurfWindSpeed</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindSpeed</span>
<a name="ln-6830"></a>    <span class="n">ENDIF</span>
<a name="ln-6831"></a>    <span class="n">Hf</span> <span class="o">=</span> <span class="n">CalcNusseltJurges</span><span class="p">(</span><span class="n">SurfWindSpeed</span><span class="p">)</span>
<a name="ln-6832"></a>
<a name="ln-6833"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">HcExt_McAdams</span><span class="p">)</span>
<a name="ln-6834"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtWind</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6835"></a><span class="k">      </span><span class="n">SurfWindSpeed</span> <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! No wind exposure</span>
<a name="ln-6836"></a>    <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">==</span> <span class="n">ExtShadeOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6837"></a><span class="k">      </span><span class="n">SurfWindSpeed</span> <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! Assume zero wind speed at outside glass surface of window with exterior shade</span>
<a name="ln-6838"></a>    <span class="k">ELSE</span>
<a name="ln-6839"></a><span class="k">      </span><span class="n">SurfWindSpeed</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindSpeed</span>
<a name="ln-6840"></a>    <span class="n">ENDIF</span>
<a name="ln-6841"></a>    <span class="n">Hf</span> <span class="o">=</span> <span class="n">CalcMcAdams</span><span class="p">(</span><span class="n">SurfWindSpeed</span><span class="p">)</span>
<a name="ln-6842"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">HcExt_Mitchell</span><span class="p">)</span>
<a name="ln-6843"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtWind</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6844"></a><span class="k">      </span><span class="n">SurfWindSpeed</span> <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! No wind exposure</span>
<a name="ln-6845"></a>    <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">==</span> <span class="n">ExtShadeOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6846"></a><span class="k">      </span><span class="n">SurfWindSpeed</span> <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! Assume zero wind speed at outside glass surface of window with exterior shade</span>
<a name="ln-6847"></a>    <span class="k">ELSE</span>
<a name="ln-6848"></a><span class="k">      </span><span class="n">SurfWindSpeed</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindSpeed</span>
<a name="ln-6849"></a>    <span class="n">ENDIF</span>
<a name="ln-6850"></a>    <span class="n">Hf</span> <span class="o">=</span> <span class="n">CalcMitchell</span><span class="p">(</span><span class="n">SurfWindSpeed</span><span class="p">,</span><span class="n">CubeRootOfOverallBuildingVolume</span><span class="p">,</span> <span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-6851"></a>
<a name="ln-6852"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">HcExt_ClearRoof</span><span class="p">)</span>
<a name="ln-6853"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtWind</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6854"></a><span class="k">      </span><span class="n">SurfWindSpeed</span> <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! No wind exposure</span>
<a name="ln-6855"></a>    <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">==</span> <span class="n">ExtShadeOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6856"></a><span class="k">      </span><span class="n">SurfWindSpeed</span> <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! Assume zero wind speed at outside glass surface of window with exterior shade</span>
<a name="ln-6857"></a>    <span class="k">ELSE</span>
<a name="ln-6858"></a><span class="k">      </span><span class="n">SurfWindSpeed</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindSpeed</span>
<a name="ln-6859"></a>    <span class="n">ENDIF</span>
<a name="ln-6860"></a>    <span class="n">Hf</span> <span class="o">=</span> <span class="n">CalcClearRoof</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutDryBulbTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6861"></a>                       <span class="n">SurfWindSpeed</span> <span class="p">,</span> <span class="n">WindDir</span> <span class="p">,</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvFaceArea</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6862"></a>                       <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvFacePerimeter</span><span class="p">)</span>
<a name="ln-6863"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">HcExt_BlockenWindward</span><span class="p">)</span>
<a name="ln-6864"></a>    <span class="n">Hf</span> <span class="o">=</span> <span class="n">CalcBlockenWindward</span><span class="p">(</span><span class="n">WindSpeed</span><span class="p">,</span> <span class="n">WindDir</span><span class="p">,</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="p">)</span>
<a name="ln-6865"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">HcExt_EmmelVertical</span><span class="p">)</span>
<a name="ln-6866"></a>    <span class="n">Hf</span> <span class="o">=</span> <span class="n">CalcEmmelVertical</span><span class="p">(</span><span class="n">WindSpeed</span><span class="p">,</span> <span class="n">WindDir</span><span class="p">,</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="p">,</span> <span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-6867"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">HcExt_EmmelRoof</span><span class="p">)</span>
<a name="ln-6868"></a>
<a name="ln-6869"></a>    <span class="n">Hf</span> <span class="o">=</span> <span class="n">CalcEmmelRoof</span><span class="p">(</span><span class="n">WindSpeed</span><span class="p">,</span> <span class="n">WindDir</span><span class="p">,</span> <span class="n">RoofLongAxisOutwardAzimuth</span><span class="p">,</span> <span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-6870"></a>
<a name="ln-6871"></a>  <span class="k">END SELECT</span>
<a name="ln-6872"></a>
<a name="ln-6873"></a><span class="k">  </span><span class="n">Hc</span> <span class="o">=</span> <span class="n">Hf</span> <span class="o">+</span> <span class="n">Hn</span>
<a name="ln-6874"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Hc</span> <span class="o">&lt;</span> <span class="n">AdaptiveHcOutsideLowLimit</span> <span class="p">)</span> <span class="n">Hc</span> <span class="o">=</span> <span class="n">AdaptiveHcOutsideLowLimit</span>
<a name="ln-6875"></a>
<a name="ln-6876"></a>  <span class="k">RETURN</span>
<a name="ln-6877"></a>
<a name="ln-6878"></a><span class="k">END SUBROUTINE </span><span class="n">EvaluateExtHcModels</span>
<a name="ln-6879"></a>
<a name="ln-6880"></a>
<a name="ln-6881"></a>
<a name="ln-6882"></a><span class="k">SUBROUTINE </span><span class="n">DynamicExtConvSurfaceClassification</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-6883"></a>
<a name="ln-6884"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6885"></a>          <span class="c">!       AUTHOR         B. Griffith</span>
<a name="ln-6886"></a>          <span class="c">!       DATE WRITTEN   August 2010</span>
<a name="ln-6887"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6888"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6889"></a>
<a name="ln-6890"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6891"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-6892"></a>
<a name="ln-6893"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6894"></a>          <span class="c">! Decide surface classification based on wind and bouyancy, class, orientation</span>
<a name="ln-6895"></a>
<a name="ln-6896"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6897"></a>          <span class="c">! na</span>
<a name="ln-6898"></a>
<a name="ln-6899"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6900"></a>  <span class="k">USE </span><span class="n">DataHeatBalSurface</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TH</span>
<a name="ln-6901"></a>  <span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">WindDir</span>
<a name="ln-6902"></a>
<a name="ln-6903"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6904"></a>
<a name="ln-6905"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6906"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">SurfNum</span> <span class="c">! surface number</span>
<a name="ln-6907"></a>
<a name="ln-6908"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6909"></a>          <span class="c">! na</span>
<a name="ln-6910"></a>
<a name="ln-6911"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-6912"></a>          <span class="c">! na</span>
<a name="ln-6913"></a>
<a name="ln-6914"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-6915"></a>          <span class="c">! na</span>
<a name="ln-6916"></a>
<a name="ln-6917"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6918"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DeltaTemp</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-6919"></a>
<a name="ln-6920"></a>
<a name="ln-6921"></a>
<a name="ln-6922"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Roof</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6923"></a><span class="k">    </span><span class="n">DeltaTemp</span> <span class="o">=</span> <span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutDryBulbTemp</span>
<a name="ln-6924"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&lt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6925"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvClassification</span> <span class="o">=</span> <span class="n">OutConvClass_RoofStable</span>
<a name="ln-6926"></a>    <span class="k">ELSE</span>
<a name="ln-6927"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvClassification</span> <span class="o">=</span> <span class="n">OutConvClass_RoofUnstable</span>
<a name="ln-6928"></a>    <span class="n">ENDIF</span>
<a name="ln-6929"></a>
<a name="ln-6930"></a>  <span class="k">ELSE</span>
<a name="ln-6931"></a>
<a name="ln-6932"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">Windward</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="p">,</span> <span class="n">WindDir</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6933"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvClassification</span> <span class="o">=</span> <span class="n">OutConvClass_WindwardVertWall</span>
<a name="ln-6934"></a>    <span class="k">ELSE</span>
<a name="ln-6935"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvClassification</span> <span class="o">=</span> <span class="n">OutConvClass_LeewardVertWall</span>
<a name="ln-6936"></a>    <span class="n">ENDIF</span>
<a name="ln-6937"></a>  <span class="n">ENDIF</span>
<a name="ln-6938"></a>
<a name="ln-6939"></a>  <span class="k">RETURN</span>
<a name="ln-6940"></a>
<a name="ln-6941"></a><span class="k">END SUBROUTINE </span><span class="n">DynamicExtConvSurfaceClassification</span>
<a name="ln-6942"></a>
<a name="ln-6943"></a><span class="k">SUBROUTINE </span><span class="n">MapExtConvClassificationToHcModels</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-6944"></a>
<a name="ln-6945"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6946"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-6947"></a>          <span class="c">!       DATE WRITTEN   Aug 2010</span>
<a name="ln-6948"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6949"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6950"></a>
<a name="ln-6951"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6952"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-6953"></a>
<a name="ln-6954"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6955"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-6956"></a>
<a name="ln-6957"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6958"></a>          <span class="c">! na</span>
<a name="ln-6959"></a>
<a name="ln-6960"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6961"></a>    <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-6962"></a>
<a name="ln-6963"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6964"></a>
<a name="ln-6965"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6966"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">SurfNum</span> <span class="c">! surface number</span>
<a name="ln-6967"></a>
<a name="ln-6968"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6969"></a>          <span class="c">! na</span>
<a name="ln-6970"></a>
<a name="ln-6971"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-6972"></a>          <span class="c">! na</span>
<a name="ln-6973"></a>
<a name="ln-6974"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-6975"></a>          <span class="c">! na</span>
<a name="ln-6976"></a>
<a name="ln-6977"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6978"></a>          <span class="c">! na</span>
<a name="ln-6979"></a>  <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvClassification</span><span class="p">)</span>
<a name="ln-6980"></a>
<a name="ln-6981"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">OutConvClass_WindwardVertWall</span><span class="p">)</span>
<a name="ln-6982"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvHfModelEq</span> <span class="o">=</span> <span class="n">OutsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">HWindWallWindwardEqNum</span>
<a name="ln-6983"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvHfModelEq</span> <span class="o">==</span> <span class="n">HcExt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6984"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvHfUserCurveIndex</span> <span class="o">=</span> <span class="n">OutsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">HWindWallWindwardUserCurveNum</span>
<a name="ln-6985"></a>    <span class="n">ENDIF</span>
<a name="ln-6986"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvHnModelEq</span> <span class="o">=</span> <span class="n">OutsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">HNatVertWallEqNum</span>
<a name="ln-6987"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvHnModelEq</span> <span class="o">==</span> <span class="n">HcExt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6988"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvHnUserCurveIndex</span> <span class="o">=</span> <span class="n">OutsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">HNatVertWallUserCurveNum</span>
<a name="ln-6989"></a>    <span class="n">ENDIF</span>
<a name="ln-6990"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">OutConvClass_LeewardVertWall</span><span class="p">)</span>
<a name="ln-6991"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvHfModelEq</span> <span class="o">=</span> <span class="n">OutsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">HWindWallLeewardEqNum</span>
<a name="ln-6992"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvHfModelEq</span> <span class="o">==</span> <span class="n">HcExt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6993"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvHfUserCurveIndex</span> <span class="o">=</span> <span class="n">OutsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">HWindWallLeewardUserCurveNum</span>
<a name="ln-6994"></a>    <span class="n">ENDIF</span>
<a name="ln-6995"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvHnModelEq</span> <span class="o">=</span><span class="n">OutsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">HNatVertWallEqNum</span>
<a name="ln-6996"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvHnModelEq</span> <span class="o">==</span> <span class="n">HcExt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6997"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvHfUserCurveIndex</span> <span class="o">=</span> <span class="n">OutsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">HNatVertWallUserCurveNum</span>
<a name="ln-6998"></a>    <span class="n">ENDIF</span>
<a name="ln-6999"></a>
<a name="ln-7000"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">OutConvClass_RoofStable</span><span class="p">)</span>
<a name="ln-7001"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvHfModelEq</span> <span class="o">=</span> <span class="n">OutsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">HWindHorizRoofEqNum</span>
<a name="ln-7002"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvHfModelEq</span> <span class="o">==</span> <span class="n">HcExt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7003"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvHfUserCurveIndex</span> <span class="o">=</span> <span class="n">OutsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">HWindHorizRoofUserCurveNum</span>
<a name="ln-7004"></a>    <span class="n">ENDIF</span>
<a name="ln-7005"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvHnModelEq</span> <span class="o">=</span><span class="n">OutsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">HNatStableHorizEqNum</span>
<a name="ln-7006"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvHnModelEq</span> <span class="o">==</span> <span class="n">HcExt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7007"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvHfUserCurveIndex</span> <span class="o">=</span> <span class="n">OutsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">HNatStableHorizUserCurveNum</span>
<a name="ln-7008"></a>    <span class="n">ENDIF</span>
<a name="ln-7009"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">OutConvClass_RoofUnstable</span><span class="p">)</span>
<a name="ln-7010"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvHfModelEq</span> <span class="o">=</span> <span class="n">OutsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">HWindHorizRoofEqNum</span>
<a name="ln-7011"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvHfModelEq</span> <span class="o">==</span> <span class="n">HcExt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7012"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvHfUserCurveIndex</span> <span class="o">=</span> <span class="n">OutsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">HWindHorizRoofUserCurveNum</span>
<a name="ln-7013"></a>    <span class="n">ENDIF</span>
<a name="ln-7014"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvHnModelEq</span> <span class="o">=</span><span class="n">OutsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">HNatUnstableHorizEqNum</span>
<a name="ln-7015"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvHnModelEq</span> <span class="o">==</span> <span class="n">HcExt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7016"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvHfUserCurveIndex</span> <span class="o">=</span> <span class="n">OutsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">HNatUstableHorizUserCurveNum</span>
<a name="ln-7017"></a>    <span class="n">ENDIF</span>
<a name="ln-7018"></a>  <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-7019"></a>    <span class="k">CAll </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;MapExtConvClassificationToHcModels: caught unknown outdoor surfce classification:&#39;</span><span class="p">&amp;</span>
<a name="ln-7020"></a>                        <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvClassification</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-7021"></a>  <span class="k">END SELECT</span>
<a name="ln-7022"></a>
<a name="ln-7023"></a><span class="k">  RETURN</span>
<a name="ln-7024"></a>
<a name="ln-7025"></a><span class="k">END SUBROUTINE </span><span class="n">MapExtConvClassificationToHcModels</span>
<a name="ln-7026"></a>
<a name="ln-7027"></a>
<a name="ln-7028"></a><span class="k">SUBROUTINE </span><span class="n">DynamicIntConvSurfaceClassification</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-7029"></a>
<a name="ln-7030"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-7031"></a>          <span class="c">!       AUTHOR        Brent Griffith</span>
<a name="ln-7032"></a>          <span class="c">!       DATE WRITTEN   Aug 2010</span>
<a name="ln-7033"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-7034"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-7035"></a>
<a name="ln-7036"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-7037"></a>          <span class="c">! collects dynamic updates needed for adaptive convectin algorithm</span>
<a name="ln-7038"></a>
<a name="ln-7039"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7040"></a>          <span class="c">! Decide flow regime to set IntConvClassification</span>
<a name="ln-7041"></a>          <span class="c">!  done by zone using the following rules</span>
<a name="ln-7042"></a>          <span class="c">!</span>
<a name="ln-7043"></a>
<a name="ln-7044"></a>          <span class="c">! Using zone flow regime, and surface&#39;s characteristics assign IntConvHcModelEq</span>
<a name="ln-7045"></a>
<a name="ln-7046"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-7047"></a>          <span class="c">! na</span>
<a name="ln-7048"></a>
<a name="ln-7049"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7050"></a>  <span class="k">USE </span><span class="n">DataZoneEquipment</span>
<a name="ln-7051"></a>  <span class="k">USE </span><span class="n">DataHeatBalSurface</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TH</span>
<a name="ln-7052"></a>  <span class="k">USE </span><span class="n">DataHeatBalFanSys</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">MAT</span>
<a name="ln-7053"></a>  <span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">OutBaroPress</span>
<a name="ln-7054"></a>  <span class="k">USE </span><span class="n">Psychrometrics</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">,</span> <span class="n">PsyWFnTdpPb</span>
<a name="ln-7055"></a>
<a name="ln-7056"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7057"></a>
<a name="ln-7058"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-7059"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">SurfNum</span> <span class="c">! surface number</span>
<a name="ln-7060"></a>
<a name="ln-7061"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-7062"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">g</span>  <span class="o">=</span> <span class="mf">9.81d0</span>       <span class="c">! gravity constant (m/s**2)</span>
<a name="ln-7063"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">v</span>  <span class="o">=</span> <span class="mi">1</span><span class="mf">5.89d-6</span>     <span class="c">! kinematic viscosity (m**2/s) for air at 300 K</span>
<a name="ln-7064"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ActiveDelTempThreshold</span> <span class="o">=</span> <span class="mf">1.5d0</span>  <span class="c">! deg C, temperature difference for surfaces to be considered &quot;active&quot;</span>
<a name="ln-7065"></a>
<a name="ln-7066"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-7067"></a>          <span class="c">! na</span>
<a name="ln-7068"></a>
<a name="ln-7069"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-7070"></a>          <span class="c">! na</span>
<a name="ln-7071"></a>
<a name="ln-7072"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7073"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ZoneNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-7074"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">PriorityEquipOn</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-7075"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatingPriorityStack</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-7076"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolingPriorityStack</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-7077"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FlowRegimeStack</span>      <span class="o">=</span> <span class="mi">0</span>
<a name="ln-7078"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">EquipNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-7079"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ZoneNode</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-7080"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">EquipOnCount</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-7081"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">EquipOnLoop</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-7082"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">thisZoneInletNode</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-7083"></a><span class="c">!  INTEGER :: thisZnEqInletNode = 0</span>
<a name="ln-7084"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">FinalFlowRegime</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-7085"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Tmin</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! temporary min surf temp</span>
<a name="ln-7086"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Tmax</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! temporary max surf temp</span>
<a name="ln-7087"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GrH</span> <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! Grashof number for zone height H</span>
<a name="ln-7088"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Re</span> <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! Reynolds number for zone air system flow</span>
<a name="ln-7089"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Ri</span> <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! Richardson Number, Gr/Re**2 for determining mixed regime</span>
<a name="ln-7090"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirDensity</span> <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! temporary zone air density</span>
<a name="ln-7091"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DeltaTemp</span> <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! temporary temperature difference (Tsurf - Tair)</span>
<a name="ln-7092"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">SurfLoop</span>  <span class="c">! local for separate looping across surfaces in the zone that has SurfNum</span>
<a name="ln-7093"></a>
<a name="ln-7094"></a>  <span class="n">EquipOnCount</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-7095"></a>  <span class="n">ZoneNum</span>  <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-7096"></a>  <span class="n">ZoneNode</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SystemZoneNodeNumber</span>
<a name="ln-7097"></a>  <span class="n">FlowRegimeStack</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-7098"></a>
<a name="ln-7099"></a>  <span class="c">!HVAC connections</span>
<a name="ln-7100"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">IsControlled</span><span class="p">)</span> <span class="k">Then</span> <span class="c">! no HVAC control</span>
<a name="ln-7101"></a>    <span class="n">FlowRegimeStack</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">InConvFlowRegime_A3</span>
<a name="ln-7102"></a>  <span class="k">ELSE</span> <span class="c">! is controlled, lets see by how and if that means is currently active</span>
<a name="ln-7103"></a>
<a name="ln-7104"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7105"></a><span class="k">      </span><span class="n">FlowRegimeStack</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">InConvFlowRegime_A3</span>
<a name="ln-7106"></a>    <span class="k">ELSE</span>
<a name="ln-7107"></a>
<a name="ln-7108"></a><span class="k">      DO </span><span class="n">EquipNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">NumOfEquipTypes</span>
<a name="ln-7109"></a>
<a name="ln-7110"></a>        <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">EquipType_Num</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">))</span>
<a name="ln-7111"></a>
<a name="ln-7112"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">AirDistUnit_Num</span><span class="p">,</span><span class="n">DirectAir_Num</span><span class="p">,</span> <span class="n">PurchasedAir_Num</span><span class="p">)</span> <span class="c">! central air equipment</span>
<a name="ln-7113"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">EquipData</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)%</span><span class="n">OutletNodeNums</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-7114"></a>          <span class="c">!get inlet node, not zone node if possible</span>
<a name="ln-7115"></a>          <span class="n">thisZoneInletNode</span> <span class="o">=</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">EquipData</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)%</span><span class="n">OutletNodeNums</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-7116"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">thisZoneInletNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7117"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">thisZoneInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7118"></a><span class="k">              </span><span class="n">EquipOnCount</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">EquipOnCount</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="ln-7119"></a>              <span class="n">FlowRegimeStack</span><span class="p">(</span><span class="n">EquipOnCount</span><span class="p">)</span> <span class="o">=</span> <span class="n">InConvFlowRegime_C</span>
<a name="ln-7120"></a>              <span class="n">HeatingPriorityStack</span><span class="p">(</span><span class="n">EquipOnCount</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">HeatingPriority</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)</span>
<a name="ln-7121"></a>              <span class="n">CoolingPriorityStack</span><span class="p">(</span><span class="n">EquipOnCount</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">CoolingPriority</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)</span>
<a name="ln-7122"></a>            <span class="n">ENDIF</span>
<a name="ln-7123"></a>          <span class="k">ELSE</span>
<a name="ln-7124"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7125"></a><span class="k">              </span><span class="n">EquipOnCount</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">EquipOnCount</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="ln-7126"></a>              <span class="n">FlowRegimeStack</span><span class="p">(</span><span class="n">EquipOnCount</span><span class="p">)</span> <span class="o">=</span> <span class="n">InConvFlowRegime_C</span>
<a name="ln-7127"></a>              <span class="n">HeatingPriorityStack</span><span class="p">(</span><span class="n">EquipOnCount</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">HeatingPriority</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)</span>
<a name="ln-7128"></a>              <span class="n">CoolingPriorityStack</span><span class="p">(</span><span class="n">EquipOnCount</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">CoolingPriority</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)</span>
<a name="ln-7129"></a>            <span class="n">ENDIF</span>
<a name="ln-7130"></a>          <span class="n">ENDIF</span>
<a name="ln-7131"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">WindowAC_Num</span><span class="p">,</span> <span class="n">PkgTermHPAirToAir_Num</span><span class="p">,</span> <span class="n">PkgTermACAirToAir_Num</span><span class="p">,</span> <span class="n">ZoneDXDehumidifier_Num</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7132"></a>              <span class="n">PkgTermHPWaterToAir_Num</span><span class="p">,</span> <span class="n">FanCoil4Pipe_Num</span><span class="p">,</span> <span class="n">UnitVentilator_Num</span><span class="p">,</span> <span class="n">UnitHeater_Num</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7133"></a>              <span class="n">OutdoorAirUnit_Num</span><span class="p">)</span>
<a name="ln-7134"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">EquipData</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)%</span><span class="n">OutletNodeNums</span><span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-7135"></a><span class="k">          </span><span class="n">thisZoneInletNode</span> <span class="o">=</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">EquipData</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)%</span><span class="n">OutletNodeNums</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-7136"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">thisZoneInletNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7137"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">thisZoneInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7138"></a><span class="k">              </span><span class="n">EquipOnCount</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">EquipOnCount</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="ln-7139"></a>              <span class="n">FlowRegimeStack</span><span class="p">(</span><span class="n">EquipOnCount</span><span class="p">)</span> <span class="o">=</span> <span class="n">InConvFlowRegime_D</span>
<a name="ln-7140"></a>              <span class="n">HeatingPriorityStack</span><span class="p">(</span><span class="n">EquipOnCount</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">HeatingPriority</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)</span>
<a name="ln-7141"></a>              <span class="n">CoolingPriorityStack</span><span class="p">(</span><span class="n">EquipOnCount</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">CoolingPriority</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)</span>
<a name="ln-7142"></a>            <span class="n">ENDIF</span>
<a name="ln-7143"></a>          <span class="k">ELSE</span>
<a name="ln-7144"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7145"></a><span class="k">              </span><span class="n">EquipOnCount</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">EquipOnCount</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="ln-7146"></a>              <span class="n">FlowRegimeStack</span><span class="p">(</span><span class="n">EquipOnCount</span><span class="p">)</span> <span class="o">=</span> <span class="n">InConvFlowRegime_D</span>
<a name="ln-7147"></a>              <span class="n">HeatingPriorityStack</span><span class="p">(</span><span class="n">EquipOnCount</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">HeatingPriority</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)</span>
<a name="ln-7148"></a>              <span class="n">CoolingPriorityStack</span><span class="p">(</span><span class="n">EquipOnCount</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">CoolingPriority</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)</span>
<a name="ln-7149"></a>            <span class="n">ENDIF</span>
<a name="ln-7150"></a>          <span class="n">ENDIF</span>
<a name="ln-7151"></a>        <span class="k">CASE</span> <span class="p">(</span> <span class="n">BBSteam_Num</span><span class="p">,</span> <span class="n">BBWaterConvective_Num</span><span class="p">,</span> <span class="n">BBElectricConvective_Num</span><span class="p">,</span> <span class="n">BBWater_Num</span><span class="p">)</span>
<a name="ln-7152"></a>
<a name="ln-7153"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">EquipData</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)%</span><span class="n">ON</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7154"></a><span class="k">            </span><span class="n">EquipOnCount</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">EquipOnCount</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="ln-7155"></a>            <span class="n">FlowRegimeStack</span><span class="p">(</span><span class="n">EquipOnCount</span><span class="p">)</span> <span class="o">=</span> <span class="n">InConvFlowRegime_B</span>
<a name="ln-7156"></a>            <span class="n">HeatingPriorityStack</span><span class="p">(</span><span class="n">EquipOnCount</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">HeatingPriority</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)</span>
<a name="ln-7157"></a>            <span class="n">CoolingPriorityStack</span><span class="p">(</span><span class="n">EquipOnCount</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">CoolingPriority</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)</span>
<a name="ln-7158"></a>          <span class="n">ENDIF</span>
<a name="ln-7159"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">BBElectric_Num</span><span class="p">,</span> <span class="n">HiTempRadiant_Num</span><span class="p">)</span>
<a name="ln-7160"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">EquipData</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)%</span><span class="n">ON</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7161"></a><span class="k">            </span><span class="n">EquipOnCount</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">EquipOnCount</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="ln-7162"></a>            <span class="n">FlowRegimeStack</span><span class="p">(</span><span class="n">EquipOnCount</span><span class="p">)</span> <span class="o">=</span> <span class="n">InConvFlowRegime_B</span>
<a name="ln-7163"></a>            <span class="n">HeatingPriorityStack</span><span class="p">(</span><span class="n">EquipOnCount</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">HeatingPriority</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)</span>
<a name="ln-7164"></a>            <span class="n">CoolingPriorityStack</span><span class="p">(</span><span class="n">EquipOnCount</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">CoolingPriority</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)</span>
<a name="ln-7165"></a>          <span class="n">ENDIF</span>
<a name="ln-7166"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">VentilatedSlab_Num</span><span class="p">,</span> <span class="n">LoTempRadiant_Num</span><span class="p">)</span>
<a name="ln-7167"></a>
<a name="ln-7168"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">InFloorActiveElement</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7169"></a><span class="k">            DO </span><span class="n">SurfLoop</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-7170"></a>              <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">IntConvSurfHasActiveInIt</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-7171"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Floor</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7172"></a><span class="k">                </span><span class="n">DeltaTemp</span> <span class="o">=</span> <span class="n">TH</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">MAT</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span>
<a name="ln-7173"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&gt;</span> <span class="n">ActiveDelTempThreshold</span><span class="p">)</span> <span class="k">then</span> <span class="c">! assume heating with floor</span>
<a name="ln-7174"></a>                  <span class="c">! system ON is not enough because floor surfaces can continue to heat because of thermal capacity</span>
<a name="ln-7175"></a>                  <span class="n">EquipOnCount</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">EquipOnCount</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="ln-7176"></a>                  <span class="n">FlowRegimeStack</span><span class="p">(</span><span class="n">EquipOnCount</span><span class="p">)</span> <span class="o">=</span> <span class="n">InConvFlowRegime_A1</span>
<a name="ln-7177"></a>                  <span class="n">HeatingPriorityStack</span><span class="p">(</span><span class="n">EquipOnCount</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7178"></a>                           <span class="o">=</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">HeatingPriority</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)</span>
<a name="ln-7179"></a>                  <span class="n">CoolingPriorityStack</span><span class="p">(</span><span class="n">EquipOnCount</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7180"></a>                           <span class="o">=</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">CoolingPriority</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)</span>
<a name="ln-7181"></a>                  <span class="k">EXIT</span>
<a name="ln-7182"></a><span class="k">                </span><span class="n">ENDIF</span>
<a name="ln-7183"></a>              <span class="n">ENDIF</span>
<a name="ln-7184"></a>            <span class="n">ENDDO</span>
<a name="ln-7185"></a>          <span class="n">ENDIF</span>
<a name="ln-7186"></a>
<a name="ln-7187"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">InCeilingActiveElement</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7188"></a><span class="k">            DO </span><span class="n">SurfLoop</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-7189"></a>              <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">IntConvSurfHasActiveInIt</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-7190"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Roof</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7191"></a><span class="k">                </span><span class="n">DeltaTemp</span> <span class="o">=</span> <span class="n">TH</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">MAT</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span>
<a name="ln-7192"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&lt;</span> <span class="n">ActiveDelTempThreshold</span><span class="p">)</span> <span class="k">then</span> <span class="c">! assume cooling with ceiling</span>
<a name="ln-7193"></a>                  <span class="c">! system ON is not enough because  surfaces can continue to cool because of thermal capacity</span>
<a name="ln-7194"></a>                  <span class="n">EquipOnCount</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">EquipOnCount</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="ln-7195"></a>                  <span class="n">FlowRegimeStack</span><span class="p">(</span><span class="n">EquipOnCount</span><span class="p">)</span> <span class="o">=</span> <span class="n">InConvFlowRegime_A1</span>
<a name="ln-7196"></a>                  <span class="n">HeatingPriorityStack</span><span class="p">(</span><span class="n">EquipOnCount</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7197"></a>                           <span class="o">=</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">HeatingPriority</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)</span>
<a name="ln-7198"></a>                  <span class="n">CoolingPriorityStack</span><span class="p">(</span><span class="n">EquipOnCount</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7199"></a>                           <span class="o">=</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">CoolingPriority</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)</span>
<a name="ln-7200"></a>                  <span class="k">EXIT</span>
<a name="ln-7201"></a><span class="k">                </span><span class="n">ENDIF</span>
<a name="ln-7202"></a>              <span class="n">ENDIF</span>
<a name="ln-7203"></a>            <span class="n">ENDDO</span>
<a name="ln-7204"></a>          <span class="n">ENDIF</span>
<a name="ln-7205"></a>
<a name="ln-7206"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">InWallActiveElement</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7207"></a><span class="k">            DO </span><span class="n">SurfLoop</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-7208"></a>              <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">IntConvSurfHasActiveInIt</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-7209"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Wall</span>  <span class="p">&amp;</span>
<a name="ln-7210"></a>                    <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Door</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7211"></a><span class="k">                </span><span class="n">DeltaTemp</span> <span class="o">=</span> <span class="n">TH</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">MAT</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span>
<a name="ln-7212"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&gt;</span> <span class="n">ActiveDelTempThreshold</span><span class="p">)</span> <span class="k">then</span> <span class="c">! assume heating with wall panel</span>
<a name="ln-7213"></a>                  <span class="c">! system ON is not enough because  surfaces can continue to heat because of thermal capacity</span>
<a name="ln-7214"></a>                  <span class="n">EquipOnCount</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">EquipOnCount</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="ln-7215"></a>                  <span class="n">FlowRegimeStack</span><span class="p">(</span><span class="n">EquipOnCount</span><span class="p">)</span> <span class="o">=</span> <span class="n">InConvFlowRegime_A2</span>
<a name="ln-7216"></a>                  <span class="n">HeatingPriorityStack</span><span class="p">(</span><span class="n">EquipOnCount</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7217"></a>                           <span class="o">=</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">HeatingPriority</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)</span>
<a name="ln-7218"></a>                  <span class="n">CoolingPriorityStack</span><span class="p">(</span><span class="n">EquipOnCount</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7219"></a>                           <span class="o">=</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">CoolingPriority</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)</span>
<a name="ln-7220"></a>                <span class="k">ELSE</span> <span class="c">! not heating, no special models wall cooling so use simple bouyancy</span>
<a name="ln-7221"></a>                  <span class="n">EquipOnCount</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">EquipOnCount</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="ln-7222"></a>                  <span class="n">FlowRegimeStack</span><span class="p">(</span><span class="n">EquipOnCount</span><span class="p">)</span> <span class="o">=</span> <span class="n">InConvFlowRegime_A3</span>
<a name="ln-7223"></a>                  <span class="n">HeatingPriorityStack</span><span class="p">(</span><span class="n">EquipOnCount</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7224"></a>                           <span class="o">=</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">HeatingPriority</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)</span>
<a name="ln-7225"></a>                  <span class="n">CoolingPriorityStack</span><span class="p">(</span><span class="n">EquipOnCount</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7226"></a>                           <span class="o">=</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">CoolingPriority</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)</span>
<a name="ln-7227"></a>                <span class="n">ENDIF</span>
<a name="ln-7228"></a>              <span class="n">ENDIF</span>
<a name="ln-7229"></a>            <span class="n">ENDDO</span>
<a name="ln-7230"></a>          <span class="n">ENDIF</span>
<a name="ln-7231"></a>
<a name="ln-7232"></a>        <span class="k">END SELECT</span>
<a name="ln-7233"></a><span class="k">      </span><span class="n">ENDDO</span> <span class="c">!loop over equipment for this zone</span>
<a name="ln-7234"></a>    <span class="n">ENDIF</span>
<a name="ln-7235"></a>  <span class="n">ENDIF</span>
<a name="ln-7236"></a>
<a name="ln-7237"></a>  <span class="c">! now select which equipment type is dominant compared to all those that are ON</span>
<a name="ln-7238"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">EquipOnCount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7239"></a><span class="k">    If</span> <span class="p">(</span><span class="n">SNLoadPredictedRate</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mf">0.d0</span> <span class="p">)</span> <span class="k">Then</span> <span class="c">! heating load</span>
<a name="ln-7240"></a>      <span class="n">PriorityEquipOn</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-7241"></a>      <span class="k">DO </span><span class="n">EquipOnLoop</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">EquipOnCount</span>
<a name="ln-7242"></a>        <span class="c">!assume highest priority/first sim order is dominant for flow regime</span>
<a name="ln-7243"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">HeatingPriorityStack</span><span class="p">(</span><span class="n">EquipOnLoop</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">HeatingPriorityStack</span><span class="p">(</span><span class="n">PriorityEquipOn</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7244"></a><span class="k">          </span><span class="n">PriorityEquipOn</span> <span class="o">=</span> <span class="n">EquipOnLoop</span>
<a name="ln-7245"></a>        <span class="n">ENDIF</span>
<a name="ln-7246"></a>      <span class="n">ENDDO</span>
<a name="ln-7247"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SNLoadPredictedRate</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! cooling load</span>
<a name="ln-7248"></a>      <span class="n">PriorityEquipOn</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-7249"></a>      <span class="k">DO </span><span class="n">EquipOnLoop</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">EquipOnCount</span>
<a name="ln-7250"></a>        <span class="c">!assume highest priority/first sim order is dominant for flow regime</span>
<a name="ln-7251"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">CoolingPriorityStack</span><span class="p">(</span><span class="n">EquipOnLoop</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">CoolingPriorityStack</span><span class="p">(</span><span class="n">PriorityEquipOn</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7252"></a><span class="k">          </span><span class="n">PriorityEquipOn</span> <span class="o">=</span> <span class="n">EquipOnLoop</span>
<a name="ln-7253"></a>        <span class="n">ENDIF</span>
<a name="ln-7254"></a>      <span class="n">ENDDO</span>
<a name="ln-7255"></a>    <span class="n">ENDIF</span>
<a name="ln-7256"></a>    <span class="n">FinalFlowRegime</span> <span class="o">=</span> <span class="n">FlowRegimeStack</span><span class="p">(</span><span class="n">PriorityEquipOn</span><span class="p">)</span>
<a name="ln-7257"></a>  <span class="k">ELSE</span>
<a name="ln-7258"></a>    <span class="c">! no equipment on, so simple bouyancy flow regime</span>
<a name="ln-7259"></a>    <span class="n">FinalFlowRegime</span> <span class="o">=</span> <span class="n">InConvFlowRegime_A3</span>
<a name="ln-7260"></a>  <span class="n">ENDIF</span>
<a name="ln-7261"></a>
<a name="ln-7262"></a>  <span class="c">! now if flow regimes C or D, then check for Mixed regime or very low flow rates</span>
<a name="ln-7263"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">FinalFlowRegime</span> <span class="o">==</span> <span class="n">InConvFlowRegime_C</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7264"></a>      <span class="p">(</span><span class="n">FinalFlowRegime</span> <span class="o">==</span> <span class="n">InConvFlowRegime_D</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7265"></a>
<a name="ln-7266"></a>    <span class="c">!Calculate Grashof, Reynolds, and Richardson numbers for the zone</span>
<a name="ln-7267"></a>    <span class="c">!</span>
<a name="ln-7268"></a>    <span class="c">!Grashof for zone air based on largest delta T between surfaces and zone height</span>
<a name="ln-7269"></a>    <span class="n">Tmin</span> <span class="o">=</span> <span class="nb">MINVAL</span><span class="p">(</span><span class="n">TH</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">:</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceLast</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<a name="ln-7270"></a>    <span class="n">Tmax</span> <span class="o">=</span> <span class="nb">MAXVAL</span><span class="p">(</span><span class="n">TH</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">:</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceLast</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<a name="ln-7271"></a>    <span class="n">GrH</span>  <span class="o">=</span> <span class="p">(</span><span class="n">g</span> <span class="o">*</span> <span class="p">(</span><span class="n">Tmax</span> <span class="o">-</span> <span class="n">Tmin</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">CeilingHeight</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-7272"></a>            <span class="o">/</span><span class="p">((</span><span class="n">MAT</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">+</span> <span class="n">KelvinConv</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">v</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-7273"></a>
<a name="ln-7274"></a>    <span class="c">! Reynolds number = Vdot supply / v * cube root of zone volume (Goldstein and Noveselac 2010)</span>
<a name="ln-7275"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7276"></a><span class="k">      </span><span class="n">AirDensity</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">PsyWFnTdpPb</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">))</span>
<a name="ln-7277"></a>      <span class="n">Re</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">/</span><span class="p">(</span><span class="n">v</span> <span class="o">*</span><span class="n">AirDensity</span> <span class="o">*</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Volume</span><span class="o">**</span><span class="n">OneThird</span><span class="p">))</span>
<a name="ln-7278"></a>    <span class="k">ELSE</span>
<a name="ln-7279"></a><span class="k">      </span><span class="n">Re</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7280"></a>    <span class="n">ENDIF</span>
<a name="ln-7281"></a>
<a name="ln-7282"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Re</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7283"></a><span class="k">      </span><span class="n">Ri</span> <span class="o">=</span> <span class="n">GrH</span><span class="o">/</span><span class="p">(</span><span class="n">Re</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>  <span class="c">!Richardson Number</span>
<a name="ln-7284"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Ri</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="mf">0.d0</span> <span class="p">)</span> <span class="k">Then</span> <span class="c">! natural convection expected</span>
<a name="ln-7285"></a>        <span class="n">FinalFlowRegime</span> <span class="o">=</span> <span class="n">InConvFlowRegime_A3</span>
<a name="ln-7286"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Ri</span> <span class="o">&lt;</span> <span class="mf">0.1d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">!forced</span>
<a name="ln-7287"></a>        <span class="c">! no change, already a forced regime</span>
<a name="ln-7288"></a>      <span class="k">ELSE</span>  <span class="c">! mixed</span>
<a name="ln-7289"></a>        <span class="n">FinalFlowRegime</span> <span class="o">=</span> <span class="n">InConvFlowRegime_E</span>
<a name="ln-7290"></a>      <span class="n">ENDIF</span>
<a name="ln-7291"></a>    <span class="k">ELSE</span> <span class="c">! natural convection expected</span>
<a name="ln-7292"></a>      <span class="n">FinalFlowRegime</span> <span class="o">=</span> <span class="n">InConvFlowRegime_A3</span>
<a name="ln-7293"></a>    <span class="n">ENDIF</span>
<a name="ln-7294"></a>  <span class="n">ENDIF</span>
<a name="ln-7295"></a>
<a name="ln-7296"></a>  <span class="c">! now finish out specific model eq for this surface</span>
<a name="ln-7297"></a>  <span class="c">!Surface(SurfNum)%IntConvClassification = 0 !init/check</span>
<a name="ln-7298"></a>  <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">FinalFlowRegime</span><span class="p">)</span>
<a name="ln-7299"></a>
<a name="ln-7300"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">InConvFlowRegime_A1</span><span class="p">)</span>
<a name="ln-7301"></a>    <span class="n">DeltaTemp</span> <span class="o">=</span> <span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">MAT</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span>
<a name="ln-7302"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Wall</span> <span class="p">&amp;</span>
<a name="ln-7303"></a>       <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Door</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7304"></a>
<a name="ln-7305"></a><span class="k">      IF</span>  <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&gt;</span> <span class="mi">8</span><span class="mf">5.d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&lt;</span> <span class="mi">9</span><span class="mf">5.d0</span> <span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span> <span class="c">!vertical wall</span>
<a name="ln-7306"></a>        <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A1_VertWalls</span>
<a name="ln-7307"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&gt;=</span> <span class="mi">9</span><span class="mf">5.d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">!tilted upwards</span>
<a name="ln-7308"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7309"></a><span class="k">         </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A1_UnstableTilted</span>
<a name="ln-7310"></a>        <span class="k">ELSE</span>
<a name="ln-7311"></a><span class="k">         </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A1_StableTilted</span>
<a name="ln-7312"></a>        <span class="n">ENDIF</span>
<a name="ln-7313"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&lt;=</span> <span class="mi">8</span><span class="mf">5.d0</span> <span class="p">)</span> <span class="k">THEN</span> <span class="c">!tilted downwards</span>
<a name="ln-7314"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&lt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7315"></a><span class="k">         </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A1_UnstableTilted</span>
<a name="ln-7316"></a>        <span class="k">ELSE</span>
<a name="ln-7317"></a><span class="k">         </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A1_StableTilted</span>
<a name="ln-7318"></a>        <span class="n">ENDIF</span>
<a name="ln-7319"></a>      <span class="n">ENDIF</span>
<a name="ln-7320"></a>
<a name="ln-7321"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Roof</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7322"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvSurfHasActiveInIt</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7323"></a><span class="k">        </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A1_ChilledCeil</span>
<a name="ln-7324"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&lt;</span> <span class="mf">5.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7325"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&lt;</span><span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7326"></a><span class="k">          </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A1_UnstableHoriz</span>
<a name="ln-7327"></a>        <span class="k">Else</span>
<a name="ln-7328"></a><span class="k">          </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A1_StableHoriz</span>
<a name="ln-7329"></a>        <span class="n">ENDIF</span>
<a name="ln-7330"></a>      <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&gt;=</span> <span class="mf">5.d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&lt;</span> <span class="mi">9</span><span class="mf">5.d0</span><span class="p">)))</span><span class="k">THEN</span> <span class="c">!tilted downwards</span>
<a name="ln-7331"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&lt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7332"></a><span class="k">         </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A1_UnstableTilted</span>
<a name="ln-7333"></a>        <span class="k">ELSE</span>
<a name="ln-7334"></a><span class="k">         </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A1_StableTilted</span>
<a name="ln-7335"></a>        <span class="n">ENDIF</span>
<a name="ln-7336"></a>      <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&gt;</span> <span class="mi">8</span><span class="mf">5.d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&lt;</span> <span class="mi">9</span><span class="mf">5.d0</span> <span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>  <span class="c">!vertical wall</span>
<a name="ln-7337"></a>        <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A1_VertWalls</span>
<a name="ln-7338"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&gt;=</span> <span class="mi">9</span><span class="mf">5.d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">!tilted upwards</span>
<a name="ln-7339"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7340"></a><span class="k">         </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A1_UnstableTilted</span>
<a name="ln-7341"></a>        <span class="k">ELSE</span>
<a name="ln-7342"></a><span class="k">         </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A1_StableTilted</span>
<a name="ln-7343"></a>        <span class="n">ENDIF</span>
<a name="ln-7344"></a>      <span class="n">ENDIF</span>
<a name="ln-7345"></a>
<a name="ln-7346"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Floor</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7347"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvSurfHasActiveInIt</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7348"></a><span class="k">        </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A1_HeatedFloor</span>
<a name="ln-7349"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&gt;</span> <span class="mi">17</span><span class="mf">5.d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">!floor</span>
<a name="ln-7350"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7351"></a><span class="k">          </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A1_UnstableHoriz</span>
<a name="ln-7352"></a>        <span class="k">ELSE</span>
<a name="ln-7353"></a><span class="k">          </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A1_StableHoriz</span>
<a name="ln-7354"></a>        <span class="n">ENDIF</span>
<a name="ln-7355"></a>      <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&lt;=</span> <span class="mi">17</span><span class="mf">5.d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&gt;=</span> <span class="mi">9</span><span class="mf">5.d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7356"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7357"></a><span class="k">          </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A1_UnstableTilted</span>
<a name="ln-7358"></a>        <span class="k">ELSE</span>
<a name="ln-7359"></a><span class="k">          </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A1_StableTilted</span>
<a name="ln-7360"></a>        <span class="n">ENDIF</span>
<a name="ln-7361"></a>      <span class="n">ENDIF</span>
<a name="ln-7362"></a>    <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span><span class="p">)</span>     <span class="p">&amp;</span>
<a name="ln-7363"></a>            <span class="p">.</span><span class="nb">OR</span><span class="p">.</span>  <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_GlassDoor</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7364"></a>            <span class="p">.</span><span class="nb">OR</span><span class="p">.</span>  <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_TDD_Diffuser</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7365"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A1_Windows</span>
<a name="ln-7366"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_IntMass</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7367"></a>      <span class="c">! assume horizontal upwards.</span>
<a name="ln-7368"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7369"></a><span class="k">        </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A1_UnstableHoriz</span>
<a name="ln-7370"></a>      <span class="k">ELSE</span>
<a name="ln-7371"></a><span class="k">        </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A1_StableHoriz</span>
<a name="ln-7372"></a>      <span class="n">ENDIF</span>
<a name="ln-7373"></a>    <span class="n">ENDIF</span>
<a name="ln-7374"></a>
<a name="ln-7375"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7376"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;DynamicIntConvSurfaceClassification: failed to resolve Hc model for A1 surface named&#39;</span><span class="p">&amp;</span>
<a name="ln-7377"></a>                           <span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-7378"></a>    <span class="n">ENDIF</span>
<a name="ln-7379"></a>
<a name="ln-7380"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">InConvFlowRegime_A2</span><span class="p">)</span>
<a name="ln-7381"></a>    <span class="n">DeltaTemp</span> <span class="o">=</span> <span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">MAT</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span>
<a name="ln-7382"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Wall</span> <span class="p">&amp;</span>
<a name="ln-7383"></a>         <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Door</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7384"></a>
<a name="ln-7385"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvSurfHasActiveInIt</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7386"></a><span class="k">        </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A2_HeatedVerticalWall</span>
<a name="ln-7387"></a>      <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&gt;</span> <span class="mi">8</span><span class="mf">5.d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&lt;</span> <span class="mi">9</span><span class="mf">5.d0</span> <span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span> <span class="c">!vertical wall</span>
<a name="ln-7388"></a>        <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A2_VertWallsNonHeated</span>
<a name="ln-7389"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&gt;=</span> <span class="mi">9</span><span class="mf">5.d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">!tilted upwards</span>
<a name="ln-7390"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7391"></a><span class="k">         </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A2_UnstableTilted</span>
<a name="ln-7392"></a>        <span class="k">ELSE</span>
<a name="ln-7393"></a><span class="k">         </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A2_StableTilted</span>
<a name="ln-7394"></a>        <span class="n">ENDIF</span>
<a name="ln-7395"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&lt;=</span> <span class="mi">8</span><span class="mf">5.d0</span> <span class="p">)</span> <span class="k">THEN</span> <span class="c">!tilted downwards</span>
<a name="ln-7396"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&lt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7397"></a><span class="k">         </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A2_UnstableTilted</span>
<a name="ln-7398"></a>        <span class="k">ELSE</span>
<a name="ln-7399"></a><span class="k">         </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A2_StableTilted</span>
<a name="ln-7400"></a>        <span class="n">ENDIF</span>
<a name="ln-7401"></a>      <span class="n">ENDIF</span>
<a name="ln-7402"></a>
<a name="ln-7403"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Roof</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7404"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&lt;</span> <span class="mf">5.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7405"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&lt;</span><span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7406"></a><span class="k">          </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A2_UnstableHoriz</span>
<a name="ln-7407"></a>        <span class="k">Else</span>
<a name="ln-7408"></a><span class="k">          </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A2_StableHoriz</span>
<a name="ln-7409"></a>        <span class="n">ENDIF</span>
<a name="ln-7410"></a>      <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&gt;=</span> <span class="mf">5.d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&lt;</span> <span class="mi">9</span><span class="mf">5.d0</span><span class="p">)))</span><span class="k">THEN</span> <span class="c">!tilted downwards</span>
<a name="ln-7411"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&lt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7412"></a><span class="k">         </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A2_UnstableTilted</span>
<a name="ln-7413"></a>        <span class="k">ELSE</span>
<a name="ln-7414"></a><span class="k">         </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A2_StableTilted</span>
<a name="ln-7415"></a>        <span class="n">ENDIF</span>
<a name="ln-7416"></a>      <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&gt;</span> <span class="mi">8</span><span class="mf">5.d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&lt;</span> <span class="mi">9</span><span class="mf">5.d0</span> <span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>  <span class="c">!vertical wall</span>
<a name="ln-7417"></a>        <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A2_VertWallsNonHeated</span>
<a name="ln-7418"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&gt;=</span> <span class="mi">9</span><span class="mf">5.d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">!tilted upwards</span>
<a name="ln-7419"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7420"></a><span class="k">         </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A2_UnstableTilted</span>
<a name="ln-7421"></a>        <span class="k">ELSE</span>
<a name="ln-7422"></a><span class="k">         </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A2_StableTilted</span>
<a name="ln-7423"></a>        <span class="n">ENDIF</span>
<a name="ln-7424"></a>      <span class="n">ENDIF</span>
<a name="ln-7425"></a>
<a name="ln-7426"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Floor</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7427"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&gt;</span> <span class="mi">17</span><span class="mf">5.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7428"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7429"></a><span class="k">          </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A2_UnstableHoriz</span>
<a name="ln-7430"></a>        <span class="k">ELSE</span>
<a name="ln-7431"></a><span class="k">          </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A2_StableHoriz</span>
<a name="ln-7432"></a>        <span class="n">ENDIF</span>
<a name="ln-7433"></a>      <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&lt;=</span> <span class="mi">17</span><span class="mf">5.d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&gt;=</span> <span class="mi">9</span><span class="mf">5.d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7434"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7435"></a><span class="k">          </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A2_UnstableTilted</span>
<a name="ln-7436"></a>        <span class="k">ELSE</span>
<a name="ln-7437"></a><span class="k">          </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A2_StableTilted</span>
<a name="ln-7438"></a>        <span class="n">ENDIF</span>
<a name="ln-7439"></a>      <span class="n">ENDIF</span>
<a name="ln-7440"></a>    <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span><span class="p">)</span>     <span class="p">&amp;</span>
<a name="ln-7441"></a>            <span class="p">.</span><span class="nb">OR</span><span class="p">.</span>  <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_GlassDoor</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7442"></a>            <span class="p">.</span><span class="nb">OR</span><span class="p">.</span>  <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_TDD_Diffuser</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7443"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A2_Windows</span>
<a name="ln-7444"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_IntMass</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7445"></a>      <span class="c">! assume horizontal upwards.</span>
<a name="ln-7446"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7447"></a><span class="k">        </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A2_UnstableHoriz</span>
<a name="ln-7448"></a>      <span class="k">ELSE</span>
<a name="ln-7449"></a><span class="k">        </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A2_StableHoriz</span>
<a name="ln-7450"></a>      <span class="n">ENDIF</span>
<a name="ln-7451"></a>    <span class="n">ENDIF</span>
<a name="ln-7452"></a>
<a name="ln-7453"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7454"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;DynamicIntConvSurfaceClassification: failed to resolve Hc model for A2 surface named&#39;</span><span class="p">&amp;</span>
<a name="ln-7455"></a>                           <span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-7456"></a>    <span class="n">ENDIF</span>
<a name="ln-7457"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">InConvFlowRegime_A3</span><span class="p">)</span>
<a name="ln-7458"></a>    <span class="n">DeltaTemp</span> <span class="o">=</span> <span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">MAT</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span>
<a name="ln-7459"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Wall</span> <span class="p">&amp;</span>
<a name="ln-7460"></a>         <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Door</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7461"></a>
<a name="ln-7462"></a><span class="k">      IF</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&gt;</span> <span class="mi">8</span><span class="mf">5.d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&lt;</span> <span class="mi">9</span><span class="mf">5.d0</span> <span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span> <span class="c">!vertical wall</span>
<a name="ln-7463"></a>        <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A3_VertWalls</span>
<a name="ln-7464"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&gt;=</span> <span class="mi">9</span><span class="mf">5.d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">!tilted upwards</span>
<a name="ln-7465"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7466"></a><span class="k">         </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A3_UnstableTilted</span>
<a name="ln-7467"></a>        <span class="k">ELSE</span>
<a name="ln-7468"></a><span class="k">         </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A3_StableTilted</span>
<a name="ln-7469"></a>        <span class="n">ENDIF</span>
<a name="ln-7470"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&lt;=</span> <span class="mi">8</span><span class="mf">5.d0</span> <span class="p">)</span> <span class="k">THEN</span> <span class="c">!tilted downwards</span>
<a name="ln-7471"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&lt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7472"></a><span class="k">         </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A3_UnstableTilted</span>
<a name="ln-7473"></a>        <span class="k">ELSE</span>
<a name="ln-7474"></a><span class="k">         </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A3_StableTilted</span>
<a name="ln-7475"></a>        <span class="n">ENDIF</span>
<a name="ln-7476"></a>      <span class="n">ENDIF</span>
<a name="ln-7477"></a>
<a name="ln-7478"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Roof</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7479"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&lt;</span> <span class="mf">5.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7480"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&lt;</span><span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7481"></a><span class="k">          </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A3_UnstableHoriz</span>
<a name="ln-7482"></a>        <span class="k">Else</span>
<a name="ln-7483"></a><span class="k">          </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A3_StableHoriz</span>
<a name="ln-7484"></a>        <span class="n">ENDIF</span>
<a name="ln-7485"></a>      <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&gt;</span> <span class="mf">5.d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="mf">5.d0</span><span class="p">)))</span><span class="k">THEN</span> <span class="c">!tilted downwards</span>
<a name="ln-7486"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&lt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7487"></a><span class="k">         </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A3_UnstableTilted</span>
<a name="ln-7488"></a>        <span class="k">ELSE</span>
<a name="ln-7489"></a><span class="k">         </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A3_StableTilted</span>
<a name="ln-7490"></a>        <span class="n">ENDIF</span>
<a name="ln-7491"></a>      <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&gt;</span> <span class="mi">8</span><span class="mf">5.d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&lt;</span> <span class="mi">9</span><span class="mf">5.d0</span> <span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>  <span class="c">!vertical wall</span>
<a name="ln-7492"></a>        <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A3_VertWalls</span>
<a name="ln-7493"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&gt;=</span> <span class="mi">9</span><span class="mf">5.d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">!tilted upwards</span>
<a name="ln-7494"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7495"></a><span class="k">         </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A3_UnstableTilted</span>
<a name="ln-7496"></a>        <span class="k">ELSE</span>
<a name="ln-7497"></a><span class="k">         </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A3_StableTilted</span>
<a name="ln-7498"></a>        <span class="n">ENDIF</span>
<a name="ln-7499"></a>      <span class="n">ENDIF</span>
<a name="ln-7500"></a>
<a name="ln-7501"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Floor</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7502"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&gt;</span> <span class="mi">17</span><span class="mf">5.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7503"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7504"></a><span class="k">          </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A3_UnstableHoriz</span>
<a name="ln-7505"></a>        <span class="k">ELSE</span>
<a name="ln-7506"></a><span class="k">          </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A3_StableHoriz</span>
<a name="ln-7507"></a>        <span class="n">ENDIF</span>
<a name="ln-7508"></a>      <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&lt;=</span> <span class="mi">17</span><span class="mf">5.d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&gt;=</span> <span class="mi">9</span><span class="mf">5.d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7509"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7510"></a><span class="k">          </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A3_UnstableTilted</span>
<a name="ln-7511"></a>        <span class="k">ELSE</span>
<a name="ln-7512"></a><span class="k">          </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A3_StableTilted</span>
<a name="ln-7513"></a>        <span class="n">ENDIF</span>
<a name="ln-7514"></a>      <span class="n">ENDIF</span>
<a name="ln-7515"></a>    <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span><span class="p">)</span>     <span class="p">&amp;</span>
<a name="ln-7516"></a>            <span class="p">.</span><span class="nb">OR</span><span class="p">.</span>  <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_GlassDoor</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7517"></a>            <span class="p">.</span><span class="nb">OR</span><span class="p">.</span>  <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_TDD_Diffuser</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7518"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A3_Windows</span>
<a name="ln-7519"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_IntMass</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7520"></a>      <span class="c">! assume horizontal upwards.</span>
<a name="ln-7521"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&gt;=</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7522"></a><span class="k">        </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A3_UnstableHoriz</span>
<a name="ln-7523"></a>      <span class="k">ELSE</span>
<a name="ln-7524"></a><span class="k">        </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_A3_StableHoriz</span>
<a name="ln-7525"></a>      <span class="n">ENDIF</span>
<a name="ln-7526"></a>    <span class="n">ENDIF</span>
<a name="ln-7527"></a>
<a name="ln-7528"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7529"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;DynamicIntConvSurfaceClassification: failed to resolve Hc model for A3 surface named&#39;</span><span class="p">&amp;</span>
<a name="ln-7530"></a>                           <span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-7531"></a>    <span class="n">ENDIF</span>
<a name="ln-7532"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">InConvFlowRegime_B</span><span class="p">)</span>
<a name="ln-7533"></a>    <span class="n">DeltaTemp</span> <span class="o">=</span> <span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">MAT</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span>
<a name="ln-7534"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Wall</span> <span class="p">&amp;</span>
<a name="ln-7535"></a>        <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Door</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7536"></a>
<a name="ln-7537"></a><span class="k">      IF</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&gt;</span> <span class="mi">8</span><span class="mf">5.d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&lt;</span> <span class="mi">9</span><span class="mf">5.d0</span> <span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span> <span class="c">!vertical wall</span>
<a name="ln-7538"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvSurfGetsRadiantHeat</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7539"></a><span class="k">          </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_B_VertWallsNearHeat</span>
<a name="ln-7540"></a>        <span class="k">ELSE</span>
<a name="ln-7541"></a><span class="k">          </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_B_VertWalls</span>
<a name="ln-7542"></a>        <span class="n">ENDIF</span>
<a name="ln-7543"></a>
<a name="ln-7544"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&gt;=</span> <span class="mi">9</span><span class="mf">5.d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">!tilted upwards</span>
<a name="ln-7545"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7546"></a><span class="k">         </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_B_UnstableTilted</span>
<a name="ln-7547"></a>        <span class="k">ELSE</span>
<a name="ln-7548"></a><span class="k">         </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_B_StableTilted</span>
<a name="ln-7549"></a>        <span class="n">ENDIF</span>
<a name="ln-7550"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&lt;=</span> <span class="mi">8</span><span class="mf">5.d0</span> <span class="p">)</span> <span class="k">THEN</span> <span class="c">!tilted downwards</span>
<a name="ln-7551"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&lt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7552"></a><span class="k">         </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_B_UnstableTilted</span>
<a name="ln-7553"></a>        <span class="k">ELSE</span>
<a name="ln-7554"></a><span class="k">         </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_B_StableTilted</span>
<a name="ln-7555"></a>        <span class="n">ENDIF</span>
<a name="ln-7556"></a>      <span class="n">ENDIF</span>
<a name="ln-7557"></a>
<a name="ln-7558"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Roof</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7559"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&lt;</span> <span class="mf">5.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7560"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&lt;</span><span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7561"></a><span class="k">          </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_B_UnstableHoriz</span>
<a name="ln-7562"></a>        <span class="k">Else</span>
<a name="ln-7563"></a><span class="k">          </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_B_StableHoriz</span>
<a name="ln-7564"></a>        <span class="n">ENDIF</span>
<a name="ln-7565"></a>      <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&gt;=</span> <span class="mf">5.d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="mf">5.d0</span><span class="p">)))</span><span class="k">THEN</span> <span class="c">!tilted downwards</span>
<a name="ln-7566"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&lt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7567"></a><span class="k">         </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_B_UnstableTilted</span>
<a name="ln-7568"></a>        <span class="k">ELSE</span>
<a name="ln-7569"></a><span class="k">         </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_B_StableTilted</span>
<a name="ln-7570"></a>        <span class="n">ENDIF</span>
<a name="ln-7571"></a>      <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&gt;</span> <span class="mi">8</span><span class="mf">5.d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&lt;</span> <span class="mi">9</span><span class="mf">5.d0</span> <span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>  <span class="c">!vertical wall</span>
<a name="ln-7572"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvSurfGetsRadiantHeat</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7573"></a><span class="k">          </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_B_VertWallsNearHeat</span>
<a name="ln-7574"></a>        <span class="k">ELSE</span>
<a name="ln-7575"></a><span class="k">          </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_B_VertWalls</span>
<a name="ln-7576"></a>        <span class="n">ENDIF</span>
<a name="ln-7577"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&gt;=</span> <span class="mi">9</span><span class="mf">5.d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">!tilted upwards</span>
<a name="ln-7578"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7579"></a><span class="k">         </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_B_UnstableTilted</span>
<a name="ln-7580"></a>        <span class="k">ELSE</span>
<a name="ln-7581"></a><span class="k">         </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_B_StableTilted</span>
<a name="ln-7582"></a>        <span class="n">ENDIF</span>
<a name="ln-7583"></a>      <span class="n">ENDIF</span>
<a name="ln-7584"></a>
<a name="ln-7585"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Floor</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7586"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&gt;</span> <span class="mi">17</span><span class="mf">5.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7587"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7588"></a><span class="k">          </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_B_UnstableHoriz</span>
<a name="ln-7589"></a>        <span class="k">ELSE</span>
<a name="ln-7590"></a><span class="k">          </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_B_StableHoriz</span>
<a name="ln-7591"></a>        <span class="n">ENDIF</span>
<a name="ln-7592"></a>      <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&lt;=</span> <span class="mi">17</span><span class="mf">5.d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&gt;=</span> <span class="mi">9</span><span class="mf">5.d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7593"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7594"></a><span class="k">          </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_B_UnstableTilted</span>
<a name="ln-7595"></a>        <span class="k">ELSE</span>
<a name="ln-7596"></a><span class="k">          </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_B_StableTilted</span>
<a name="ln-7597"></a>        <span class="n">ENDIF</span>
<a name="ln-7598"></a>      <span class="n">ENDIF</span>
<a name="ln-7599"></a>    <span class="n">ELSEIF</span> <span class="p">(</span>      <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span><span class="p">)</span>     <span class="p">&amp;</span>
<a name="ln-7600"></a>            <span class="p">.</span><span class="nb">OR</span><span class="p">.</span>  <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_GlassDoor</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7601"></a>            <span class="p">.</span><span class="nb">OR</span><span class="p">.</span>  <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_TDD_Diffuser</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7602"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_B_Windows</span>
<a name="ln-7603"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_IntMass</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7604"></a>      <span class="c">! assume horizontal upwards.</span>
<a name="ln-7605"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7606"></a><span class="k">        </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_B_UnstableHoriz</span>
<a name="ln-7607"></a>      <span class="k">ELSE</span>
<a name="ln-7608"></a><span class="k">        </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_B_StableHoriz</span>
<a name="ln-7609"></a>      <span class="n">ENDIF</span>
<a name="ln-7610"></a>    <span class="n">ENDIF</span>
<a name="ln-7611"></a>
<a name="ln-7612"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7613"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;DynamicIntConvSurfaceClassification: failed to resolve Hc model for B surface named&#39;</span><span class="p">&amp;</span>
<a name="ln-7614"></a>                           <span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-7615"></a>    <span class="n">ENDIF</span>
<a name="ln-7616"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">InConvFlowRegime_C</span><span class="p">)</span>
<a name="ln-7617"></a>    <span class="k">IF</span>     <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Wall</span> <span class="p">&amp;</span>
<a name="ln-7618"></a>            <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Door</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7619"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_C_Walls</span>
<a name="ln-7620"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Roof</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7621"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_C_Ceiling</span>
<a name="ln-7622"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Floor</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7623"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_C_Floor</span>
<a name="ln-7624"></a>    <span class="n">ELSEIF</span> <span class="p">(</span>      <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span><span class="p">)</span>     <span class="p">&amp;</span>
<a name="ln-7625"></a>            <span class="p">.</span><span class="nb">OR</span><span class="p">.</span>  <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_GlassDoor</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7626"></a>            <span class="p">.</span><span class="nb">OR</span><span class="p">.</span>  <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_TDD_Diffuser</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7627"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_C_Windows</span>
<a name="ln-7628"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_IntMass</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7629"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_C_Floor</span>
<a name="ln-7630"></a>    <span class="n">ENDIF</span>
<a name="ln-7631"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7632"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;DynamicIntConvSurfaceClassification: failed to resolve Hc model for C surface named&#39;</span><span class="p">&amp;</span>
<a name="ln-7633"></a>                           <span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-7634"></a>    <span class="n">ENDIF</span>
<a name="ln-7635"></a>
<a name="ln-7636"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">InConvFlowRegime_D</span><span class="p">)</span>
<a name="ln-7637"></a>
<a name="ln-7638"></a>    <span class="n">DeltaTemp</span> <span class="o">=</span> <span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">MAT</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span>
<a name="ln-7639"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Wall</span> <span class="p">&amp;</span>
<a name="ln-7640"></a>         <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Door</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7641"></a>
<a name="ln-7642"></a><span class="k">      IF</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&gt;</span> <span class="mi">8</span><span class="mf">5.d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&lt;</span> <span class="mi">9</span><span class="mf">5.d0</span> <span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span> <span class="c">!vertical wall</span>
<a name="ln-7643"></a>
<a name="ln-7644"></a>        <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_D_Walls</span>
<a name="ln-7645"></a>
<a name="ln-7646"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&gt;=</span> <span class="mi">9</span><span class="mf">5.d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">!tilted upwards</span>
<a name="ln-7647"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7648"></a><span class="k">         </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_D_UnstableTilted</span>
<a name="ln-7649"></a>        <span class="k">ELSE</span>
<a name="ln-7650"></a><span class="k">         </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_D_StableTilted</span>
<a name="ln-7651"></a>        <span class="n">ENDIF</span>
<a name="ln-7652"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&lt;=</span> <span class="mi">8</span><span class="mf">5.d0</span> <span class="p">)</span> <span class="k">THEN</span> <span class="c">!tilted downwards</span>
<a name="ln-7653"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&lt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7654"></a><span class="k">         </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_D_UnstableTilted</span>
<a name="ln-7655"></a>        <span class="k">ELSE</span>
<a name="ln-7656"></a><span class="k">         </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_D_StableTilted</span>
<a name="ln-7657"></a>        <span class="n">ENDIF</span>
<a name="ln-7658"></a>      <span class="n">ENDIF</span>
<a name="ln-7659"></a>
<a name="ln-7660"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Roof</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7661"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&lt;</span> <span class="mf">5.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7662"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&lt;</span><span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7663"></a><span class="k">          </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_D_UnstableHoriz</span>
<a name="ln-7664"></a>        <span class="k">Else</span>
<a name="ln-7665"></a><span class="k">          </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_D_StableHoriz</span>
<a name="ln-7666"></a>        <span class="n">ENDIF</span>
<a name="ln-7667"></a>      <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&gt;=</span> <span class="mf">5.d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&lt;=</span> <span class="mi">8</span><span class="mf">5.d0</span><span class="p">)))</span><span class="k">THEN</span> <span class="c">!tilted downwards</span>
<a name="ln-7668"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&lt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7669"></a><span class="k">         </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_D_UnstableTilted</span>
<a name="ln-7670"></a>        <span class="k">ELSE</span>
<a name="ln-7671"></a><span class="k">         </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_D_StableTilted</span>
<a name="ln-7672"></a>        <span class="n">ENDIF</span>
<a name="ln-7673"></a>      <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&gt;</span> <span class="mi">8</span><span class="mf">5.d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&lt;</span> <span class="mi">9</span><span class="mf">5.d0</span> <span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>  <span class="c">!vertical wall</span>
<a name="ln-7674"></a>
<a name="ln-7675"></a>        <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_D_Walls</span>
<a name="ln-7676"></a>
<a name="ln-7677"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&gt;=</span> <span class="mi">9</span><span class="mf">5.d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">!tilted upwards</span>
<a name="ln-7678"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7679"></a><span class="k">         </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_D_UnstableTilted</span>
<a name="ln-7680"></a>        <span class="k">ELSE</span>
<a name="ln-7681"></a><span class="k">         </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_D_StableTilted</span>
<a name="ln-7682"></a>        <span class="n">ENDIF</span>
<a name="ln-7683"></a>      <span class="n">ENDIF</span>
<a name="ln-7684"></a>
<a name="ln-7685"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Floor</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7686"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&gt;</span> <span class="mi">17</span><span class="mf">5.d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">!floor</span>
<a name="ln-7687"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7688"></a><span class="k">          </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_D_UnstableHoriz</span>
<a name="ln-7689"></a>        <span class="k">ELSE</span>
<a name="ln-7690"></a><span class="k">          </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_D_StableHoriz</span>
<a name="ln-7691"></a>        <span class="n">ENDIF</span>
<a name="ln-7692"></a>      <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&lt;=</span> <span class="mi">17</span><span class="mf">5.d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&gt;=</span> <span class="mi">9</span><span class="mf">5.d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7693"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7694"></a><span class="k">          </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_D_UnstableTilted</span>
<a name="ln-7695"></a>        <span class="k">ELSE</span>
<a name="ln-7696"></a><span class="k">          </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_D_StableTilted</span>
<a name="ln-7697"></a>        <span class="n">ENDIF</span>
<a name="ln-7698"></a>      <span class="n">ENDIF</span>
<a name="ln-7699"></a>    <span class="n">ELSEIF</span> <span class="p">(</span>      <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span><span class="p">)</span>     <span class="p">&amp;</span>
<a name="ln-7700"></a>            <span class="p">.</span><span class="nb">OR</span><span class="p">.</span>  <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_GlassDoor</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7701"></a>            <span class="p">.</span><span class="nb">OR</span><span class="p">.</span>  <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_TDD_Diffuser</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7702"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_D_Windows</span>
<a name="ln-7703"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_IntMass</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7704"></a>      <span class="c">! assume horizontal upwards.</span>
<a name="ln-7705"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7706"></a><span class="k">        </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_D_UnstableHoriz</span>
<a name="ln-7707"></a>      <span class="k">ELSE</span>
<a name="ln-7708"></a><span class="k">        </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_D_StableHoriz</span>
<a name="ln-7709"></a>      <span class="n">ENDIF</span>
<a name="ln-7710"></a>    <span class="n">ENDIF</span>
<a name="ln-7711"></a>
<a name="ln-7712"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7713"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;DynamicIntConvSurfaceClassification: failed to resolve Hc model for D surface named&#39;</span><span class="p">&amp;</span>
<a name="ln-7714"></a>                           <span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-7715"></a>    <span class="n">ENDIF</span>
<a name="ln-7716"></a>
<a name="ln-7717"></a>
<a name="ln-7718"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">InConvFlowRegime_E</span><span class="p">)</span>
<a name="ln-7719"></a>
<a name="ln-7720"></a>    <span class="n">DeltaTemp</span> <span class="o">=</span> <span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">MAT</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span>
<a name="ln-7721"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Wall</span> <span class="p">&amp;</span>
<a name="ln-7722"></a>         <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Door</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7723"></a>
<a name="ln-7724"></a>      <span class="c">!mixed regime, but need to know what regime it was before it was mixed</span>
<a name="ln-7725"></a>      <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">FlowRegimeStack</span><span class="p">(</span><span class="n">PriorityEquipOn</span><span class="p">))</span>
<a name="ln-7726"></a>
<a name="ln-7727"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">InConvFlowRegime_C</span><span class="p">)</span>
<a name="ln-7728"></a>        <span class="c">!assume forced flow is down along wall (ceiling diffuser)</span>
<a name="ln-7729"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! surface is hotter so plume upwards and forces oppose</span>
<a name="ln-7730"></a>          <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_E_OpposFlowWalls</span>
<a name="ln-7731"></a>        <span class="k">ELSE</span> <span class="c">! surface is cooler so plume down and forces assist</span>
<a name="ln-7732"></a>          <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_E_AssistFlowWalls</span>
<a name="ln-7733"></a>        <span class="n">ENDIF</span>
<a name="ln-7734"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">InConvFlowRegime_D</span><span class="p">)</span>
<a name="ln-7735"></a>        <span class="c">! assume forced flow is upward along wall (perimeter zone HVAC with fan)</span>
<a name="ln-7736"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! surface is hotter so plume up and forces assist</span>
<a name="ln-7737"></a>          <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_E_AssistFlowWalls</span>
<a name="ln-7738"></a>        <span class="k">ELSE</span> <span class="c">! surface is cooler so plume downward and forces oppose</span>
<a name="ln-7739"></a>          <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_E_OpposFlowWalls</span>
<a name="ln-7740"></a>        <span class="n">ENDIF</span>
<a name="ln-7741"></a>      <span class="k">END SELECT</span>
<a name="ln-7742"></a>
<a name="ln-7743"></a><span class="k">    </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Roof</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7744"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">!surface is hotter so stable</span>
<a name="ln-7745"></a>        <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_E_StableCeiling</span>
<a name="ln-7746"></a>      <span class="k">ELSE</span>
<a name="ln-7747"></a><span class="k">        </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_E_UnstableCieling</span>
<a name="ln-7748"></a>      <span class="n">ENDIF</span>
<a name="ln-7749"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Floor</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7750"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">!surface is hotter so unstable</span>
<a name="ln-7751"></a>        <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_E_UnstableFloor</span>
<a name="ln-7752"></a>      <span class="k">ELSE</span>
<a name="ln-7753"></a><span class="k">        </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_E_StableFloor</span>
<a name="ln-7754"></a>      <span class="n">ENDIF</span>
<a name="ln-7755"></a>    <span class="n">ELSEIF</span> <span class="p">(</span>      <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span><span class="p">)</span>     <span class="p">&amp;</span>
<a name="ln-7756"></a>            <span class="p">.</span><span class="nb">OR</span><span class="p">.</span>  <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_GlassDoor</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7757"></a>            <span class="p">.</span><span class="nb">OR</span><span class="p">.</span>  <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_TDD_Diffuser</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7758"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_E_Windows</span>
<a name="ln-7759"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_IntMass</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7760"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7761"></a><span class="k">        </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_E_UnstableFloor</span>
<a name="ln-7762"></a>      <span class="k">ELSE</span>
<a name="ln-7763"></a><span class="k">        </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">=</span> <span class="n">InConvClass_E_StableFloor</span>
<a name="ln-7764"></a>      <span class="n">ENDIF</span>
<a name="ln-7765"></a>    <span class="n">ENDIF</span>
<a name="ln-7766"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7767"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;DynamicIntConvSurfaceClassification: failed to resolve Hc model for D surface named &#39;</span><span class="p">&amp;</span>
<a name="ln-7768"></a>                         <span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-7769"></a>    <span class="n">ENDIF</span>
<a name="ln-7770"></a>  <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-7771"></a>    <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;DynamicIntConvSurfaceClassification: failed to deterime zone flow regime for surface named &#39;</span> <span class="p">&amp;</span>
<a name="ln-7772"></a>                         <span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-7773"></a>
<a name="ln-7774"></a>
<a name="ln-7775"></a>  <span class="k">END SELECT</span>
<a name="ln-7776"></a>
<a name="ln-7777"></a><span class="k">  RETURN</span>
<a name="ln-7778"></a>
<a name="ln-7779"></a><span class="k">END SUBROUTINE </span><span class="n">DynamicIntConvSurfaceClassification</span>
<a name="ln-7780"></a>
<a name="ln-7781"></a><span class="k">SUBROUTINE </span><span class="n">MapIntConvClassificationToHcModels</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-7782"></a>
<a name="ln-7783"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-7784"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-7785"></a>          <span class="c">!       DATE WRITTEN   Aug 2010</span>
<a name="ln-7786"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-7787"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-7788"></a>
<a name="ln-7789"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-7790"></a>          <span class="c">! Map Hc model equation data from central structure to surface structure</span>
<a name="ln-7791"></a>
<a name="ln-7792"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7793"></a>          <span class="c">! Long case statement depends on surface classification determined in DynamicIntConvSurfaceClassification</span>
<a name="ln-7794"></a>          <span class="c">! then simply map data stored in InsideFaceAdaptiveConvectionAlgo into the surface&#39;s structure</span>
<a name="ln-7795"></a>          <span class="c">! if model type is user-defined, also store the index to the user curve to be used.</span>
<a name="ln-7796"></a>
<a name="ln-7797"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-7798"></a>          <span class="c">! na</span>
<a name="ln-7799"></a>
<a name="ln-7800"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7801"></a>          <span class="c">! na</span>
<a name="ln-7802"></a>
<a name="ln-7803"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7804"></a>
<a name="ln-7805"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-7806"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfNum</span> <span class="c">! surface pointer index</span>
<a name="ln-7807"></a>
<a name="ln-7808"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-7809"></a>          <span class="c">! na</span>
<a name="ln-7810"></a>
<a name="ln-7811"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-7812"></a>          <span class="c">! na</span>
<a name="ln-7813"></a>
<a name="ln-7814"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-7815"></a>          <span class="c">! na</span>
<a name="ln-7816"></a>
<a name="ln-7817"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7818"></a>  <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvClassification</span><span class="p">)</span>
<a name="ln-7819"></a>
<a name="ln-7820"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">InConvClass_A1_VertWalls</span> <span class="p">)</span>
<a name="ln-7821"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolVertWallEqNum</span>
<a name="ln-7822"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7823"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span> <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolVertWallUserCurveNum</span>
<a name="ln-7824"></a>    <span class="n">ENDIF</span>
<a name="ln-7825"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">InConvClass_A1_StableHoriz</span>  <span class="p">)</span>
<a name="ln-7826"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolStableHorizEqNum</span>
<a name="ln-7827"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7828"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span> <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolStableHorizUserCurveNum</span>
<a name="ln-7829"></a>    <span class="n">ENDIF</span>
<a name="ln-7830"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">InConvClass_A1_UnstableHoriz</span> <span class="p">)</span>
<a name="ln-7831"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolUnstableHorizEqNum</span>
<a name="ln-7832"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7833"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span> <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolUnstableHorizUserCurveNum</span>
<a name="ln-7834"></a>    <span class="n">ENDIF</span>
<a name="ln-7835"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">InConvClass_A1_HeatedFloor</span>   <span class="p">)</span>
<a name="ln-7836"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolHeatedFloorEqNum</span>
<a name="ln-7837"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7838"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span> <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolHeatedFloorUserCurveNum</span>
<a name="ln-7839"></a>    <span class="n">ENDIF</span>
<a name="ln-7840"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">InConvClass_A1_ChilledCeil</span>   <span class="p">)</span>
<a name="ln-7841"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolChilledCeilingEqNum</span>
<a name="ln-7842"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7843"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span> <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolChilledCeilingUserCurveNum</span>
<a name="ln-7844"></a>    <span class="n">ENDIF</span>
<a name="ln-7845"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">InConvClass_A1_StableTilted</span>  <span class="p">)</span>
<a name="ln-7846"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolStableTiltedEqNum</span>
<a name="ln-7847"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7848"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span> <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolStableTiltedUserCurveNum</span>
<a name="ln-7849"></a>    <span class="n">ENDIF</span>
<a name="ln-7850"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">InConvClass_A1_UnstableTilted</span> <span class="p">)</span>
<a name="ln-7851"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolUnstableTiltedEqNum</span>
<a name="ln-7852"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7853"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span> <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolUnstableTiltedUserCurveNum</span>
<a name="ln-7854"></a>    <span class="n">ENDIF</span>
<a name="ln-7855"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">InConvClass_A1_Windows</span>        <span class="p">)</span>
<a name="ln-7856"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolWindowsEqNum</span>
<a name="ln-7857"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7858"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span> <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">FloorHeatCeilingCoolWindowsUserCurveNum</span>
<a name="ln-7859"></a>    <span class="n">ENDIF</span>
<a name="ln-7860"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">InConvClass_A2_VertWallsNonHeated</span><span class="p">)</span>
<a name="ln-7861"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">WallPanelHeatVertWallEqNum</span>
<a name="ln-7862"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7863"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span> <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">WallPanelHeatVertWallUserCurveNum</span>
<a name="ln-7864"></a>    <span class="n">ENDIF</span>
<a name="ln-7865"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">InConvClass_A2_HeatedVerticalWall</span> <span class="p">)</span>
<a name="ln-7866"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">WallPanelHeatHeatedWallEqNum</span>
<a name="ln-7867"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7868"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span> <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">WallPanelHeatHeatedWallUserCurveNum</span>
<a name="ln-7869"></a>    <span class="n">ENDIF</span>
<a name="ln-7870"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">InConvClass_A2_StableHoriz</span>      <span class="p">)</span>
<a name="ln-7871"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">WallPanelHeatStableHorizEqNum</span>
<a name="ln-7872"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7873"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span> <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">WallPanelHeatStableHorizUserCurveNum</span>
<a name="ln-7874"></a>    <span class="n">ENDIF</span>
<a name="ln-7875"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">InConvClass_A2_UnstableHoriz</span>  <span class="p">)</span>
<a name="ln-7876"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">WallPanelHeatUnstableHorizEqNum</span>
<a name="ln-7877"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7878"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span> <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">WallPanelHeatUnstableHorizUserCurveNum</span>
<a name="ln-7879"></a>    <span class="n">ENDIF</span>
<a name="ln-7880"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">InConvClass_A2_StableTilted</span>   <span class="p">)</span>
<a name="ln-7881"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">WallPanelHeatStableTiltedEqNum</span>
<a name="ln-7882"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7883"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span> <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">WallPanelHeatStableTiltedUserCurveNum</span>
<a name="ln-7884"></a>    <span class="n">ENDIF</span>
<a name="ln-7885"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">InConvClass_A2_UnstableTilted</span> <span class="p">)</span>
<a name="ln-7886"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">WallPanelHeatUnstableTiltedEqNum</span>
<a name="ln-7887"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7888"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span> <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">WallPanelHeatUnstableTiltedUserCurveNum</span>
<a name="ln-7889"></a>    <span class="n">ENDIF</span>
<a name="ln-7890"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">InConvClass_A2_Windows</span>        <span class="p">)</span>
<a name="ln-7891"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">WallPanelHeatWindowsEqNum</span>
<a name="ln-7892"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7893"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span> <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">WallPanelHeatWindowsUserCurveNum</span>
<a name="ln-7894"></a>    <span class="n">ENDIF</span>
<a name="ln-7895"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">InConvClass_A3_VertWalls</span>      <span class="p">)</span>
<a name="ln-7896"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">SimpleBouyVertWallEqNum</span>
<a name="ln-7897"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7898"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span> <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">SimpleBouyVertWallUserCurveNum</span>
<a name="ln-7899"></a>    <span class="n">ENDIF</span>
<a name="ln-7900"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">InConvClass_A3_StableHoriz</span>    <span class="p">)</span>
<a name="ln-7901"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">SimpleBouyStableHorizEqNum</span>
<a name="ln-7902"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7903"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span> <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">SimpleBouyStableHorizUserCurveNum</span>
<a name="ln-7904"></a>    <span class="n">ENDIF</span>
<a name="ln-7905"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">InConvClass_A3_UnstableHoriz</span>  <span class="p">)</span>
<a name="ln-7906"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">SimpleBouyUnstableHorizEqNum</span>
<a name="ln-7907"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7908"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span> <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">SimpleBouyUnstableHorizUserCurveNum</span>
<a name="ln-7909"></a>    <span class="n">ENDIF</span>
<a name="ln-7910"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">InConvClass_A3_StableTilted</span>   <span class="p">)</span>
<a name="ln-7911"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">SimpleBouyStableTiltedEqNum</span>
<a name="ln-7912"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7913"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span> <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">SimpleBouyStableTiltedUserCurveNum</span>
<a name="ln-7914"></a>    <span class="n">ENDIF</span>
<a name="ln-7915"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">InConvClass_A3_UnstableTilted</span> <span class="p">)</span>
<a name="ln-7916"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">SimpleBouyUnstableTiltedEqNum</span>
<a name="ln-7917"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7918"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span> <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">SimpleBouyUnstableTiltedUserCurveNum</span>
<a name="ln-7919"></a>    <span class="n">ENDIF</span>
<a name="ln-7920"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">InConvClass_A3_Windows</span>        <span class="p">)</span>
<a name="ln-7921"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">SimpleBouyWindowsEqNum</span>
<a name="ln-7922"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7923"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span> <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">SimpleBouyWindowsUserCurveNum</span>
<a name="ln-7924"></a>    <span class="n">ENDIF</span>
<a name="ln-7925"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">InConvClass_B_VertWalls</span>       <span class="p">)</span>
<a name="ln-7926"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ConvectiveHeatVertWallEqNum</span>
<a name="ln-7927"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7928"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span> <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ConvectiveHeatVertWallUserCurveNum</span>
<a name="ln-7929"></a>    <span class="n">ENDIF</span>
<a name="ln-7930"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">InConvClass_B_VertWallsNearHeat</span><span class="p">)</span>
<a name="ln-7931"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ConvectiveHeatVertWallNearHeaterEqNum</span>
<a name="ln-7932"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7933"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span> <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ConvectiveHeatVertWallNearHeaterUserCurveNum</span>
<a name="ln-7934"></a>    <span class="n">ENDIF</span>
<a name="ln-7935"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">InConvClass_B_StableHoriz</span>    <span class="p">)</span>
<a name="ln-7936"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ConvectiveHeatStableHorizEqNum</span>
<a name="ln-7937"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7938"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span> <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ConvectiveHeatStableHorizUserCurveNum</span>
<a name="ln-7939"></a>    <span class="n">ENDIF</span>
<a name="ln-7940"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">InConvClass_B_UnstableHoriz</span>  <span class="p">)</span>
<a name="ln-7941"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ConvectiveHeatUnstableHorizEqNum</span>
<a name="ln-7942"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7943"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span> <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ConvectiveHeatUnstableHorizUserCurveNum</span>
<a name="ln-7944"></a>    <span class="n">ENDIF</span>
<a name="ln-7945"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">InConvClass_B_StableTilted</span>   <span class="p">)</span>
<a name="ln-7946"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ConvectiveHeatStableTiltedEqNum</span>
<a name="ln-7947"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7948"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span> <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ConvectiveHeatStableTiltedUserCurveNum</span>
<a name="ln-7949"></a>    <span class="n">ENDIF</span>
<a name="ln-7950"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">InConvClass_B_UnstableTilted</span> <span class="p">)</span>
<a name="ln-7951"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ConvectiveHeatUnstableTiltedEqNum</span>
<a name="ln-7952"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7953"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span> <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ConvectiveHeatUnstableTiltedUserCurveNum</span>
<a name="ln-7954"></a>    <span class="n">ENDIF</span>
<a name="ln-7955"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">InConvClass_B_Windows</span>        <span class="p">)</span>
<a name="ln-7956"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ConvectiveHeatWindowsEqNum</span>
<a name="ln-7957"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7958"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span> <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ConvectiveHeatWindowsUserCurveNum</span>
<a name="ln-7959"></a>    <span class="n">ENDIF</span>
<a name="ln-7960"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">InConvClass_C_Walls</span>          <span class="p">)</span>
<a name="ln-7961"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvZonePerimLength</span> <span class="o">==</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7962"></a>        <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">CentralAirWallEqNum</span> <span class="o">==</span> <span class="n">HcInt_GoldsteinNovoselacCeilingDiffuserWalls</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7963"></a>      <span class="c">! no perimeter, Goldstein Novolselac model not good so revert to fisher pedersen model</span>
<a name="ln-7964"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">HcInt_FisherPedersenCeilDiffuserWalls</span>
<a name="ln-7965"></a>    <span class="k">ELSE</span>
<a name="ln-7966"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">CentralAirWallEqNum</span>
<a name="ln-7967"></a>    <span class="n">ENDIF</span>
<a name="ln-7968"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7969"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span> <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">CentralAirWallUserCurveNum</span>
<a name="ln-7970"></a>    <span class="n">ENDIF</span>
<a name="ln-7971"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">InConvClass_C_Ceiling</span>        <span class="p">)</span>
<a name="ln-7972"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">CentralAirCeilingEqNum</span>
<a name="ln-7973"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7974"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span> <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">CentralAirCeilingUserCurveNum</span>
<a name="ln-7975"></a>    <span class="n">ENDIF</span>
<a name="ln-7976"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">InConvClass_C_Floor</span>          <span class="p">)</span>
<a name="ln-7977"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvZonePerimLength</span> <span class="o">==</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7978"></a>        <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">CentralAirFloorEqNum</span> <span class="o">==</span> <span class="n">HcInt_GoldsteinNovoselacCeilingDiffuserFloor</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7979"></a>      <span class="c">! no perimeter, Goldstein Novolselac model not good so revert to fisher pedersen model</span>
<a name="ln-7980"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">HcInt_FisherPedersenCeilDiffuserFloor</span>
<a name="ln-7981"></a>    <span class="k">ELSE</span>
<a name="ln-7982"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">CentralAirFloorEqNum</span>
<a name="ln-7983"></a>    <span class="n">ENDIF</span>
<a name="ln-7984"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7985"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span> <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">CentralAirFloorUserCurveNum</span>
<a name="ln-7986"></a>    <span class="n">ENDIF</span>
<a name="ln-7987"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">InConvClass_C_Windows</span>        <span class="p">)</span>
<a name="ln-7988"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvZonePerimLength</span> <span class="o">==</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7989"></a>        <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">CentralAirWindowsEqNum</span> <span class="o">==</span> <span class="n">HcInt_GoldsteinNovoselacCeilingDiffuserWindow</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7990"></a>      <span class="c">! no perimeter, Goldstein Novolselac model not good so revert to ISO15099</span>
<a name="ln-7991"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">HcInt_ISO15099Windows</span>
<a name="ln-7992"></a>    <span class="k">ELSE</span>
<a name="ln-7993"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">CentralAirWindowsEqNum</span>
<a name="ln-7994"></a>    <span class="n">ENDIF</span>
<a name="ln-7995"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7996"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span> <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">CentralAirWindowsUserCurveNum</span>
<a name="ln-7997"></a>    <span class="n">ENDIF</span>
<a name="ln-7998"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">InConvClass_D_Walls</span>          <span class="p">)</span>
<a name="ln-7999"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ZoneFanCircVertWallEqNum</span>
<a name="ln-8000"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8001"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span> <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ZoneFanCircVertWallUserCurveNum</span>
<a name="ln-8002"></a>    <span class="n">ENDIF</span>
<a name="ln-8003"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">InConvClass_D_StableHoriz</span>    <span class="p">)</span>
<a name="ln-8004"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ZoneFanCircStableHorizEqNum</span>
<a name="ln-8005"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8006"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span> <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ZoneFanCircStableHorizUserCurveNum</span>
<a name="ln-8007"></a>    <span class="n">ENDIF</span>
<a name="ln-8008"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">InConvClass_D_UnstableHoriz</span>  <span class="p">)</span>
<a name="ln-8009"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ZoneFanCircUnstableHorizEqNum</span>
<a name="ln-8010"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8011"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span> <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ZoneFanCircUnstableHorizUserCurveNum</span>
<a name="ln-8012"></a>    <span class="n">ENDIF</span>
<a name="ln-8013"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">InConvClass_D_StableTilted</span>   <span class="p">)</span>
<a name="ln-8014"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ZoneFanCircStableTiltedEqNum</span>
<a name="ln-8015"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8016"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span> <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ZoneFanCircStableTiltedUserCurveNum</span>
<a name="ln-8017"></a>    <span class="n">ENDIF</span>
<a name="ln-8018"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">InConvClass_D_UnstableTilted</span> <span class="p">)</span>
<a name="ln-8019"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ZoneFanCircUnstableTiltedEqNum</span>
<a name="ln-8020"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8021"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span> <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ZoneFanCircUnstableTiltedUserCurveNum</span>
<a name="ln-8022"></a>    <span class="n">ENDIF</span>
<a name="ln-8023"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">InConvClass_D_Windows</span>        <span class="p">)</span>
<a name="ln-8024"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ZoneFanCircWindowsEqNum</span>
<a name="ln-8025"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8026"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span> <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">ZoneFanCircWindowsUserCurveNum</span>
<a name="ln-8027"></a>    <span class="n">ENDIF</span>
<a name="ln-8028"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">InConvClass_E_AssistFlowWalls</span><span class="p">)</span>
<a name="ln-8029"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">MixedBouyAssistingFlowWallEqNum</span>
<a name="ln-8030"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8031"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span> <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">MixedBouyAssistingFlowWallUserCurveNum</span>
<a name="ln-8032"></a>    <span class="n">ENDIF</span>
<a name="ln-8033"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">InConvClass_E_OpposFlowWalls</span> <span class="p">)</span>
<a name="ln-8034"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">MixedBouyOppossingFlowWallEqNum</span>
<a name="ln-8035"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8036"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span> <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">MixedBouyOppossingFlowWallUserCurveNum</span>
<a name="ln-8037"></a>    <span class="n">ENDIF</span>
<a name="ln-8038"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">InConvClass_E_StableFloor</span>    <span class="p">)</span>
<a name="ln-8039"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">MixedStableFloorEqNum</span>
<a name="ln-8040"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8041"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span> <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">MixedStableFloorUserCurveNum</span>
<a name="ln-8042"></a>    <span class="n">ENDIF</span>
<a name="ln-8043"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">InConvClass_E_UnstableFloor</span>  <span class="p">)</span>
<a name="ln-8044"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">MixedUnstableFloorEqNum</span>
<a name="ln-8045"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8046"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span> <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">MixedUnstableFloorUserCurveNum</span>
<a name="ln-8047"></a>    <span class="n">ENDIF</span>
<a name="ln-8048"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">InConvClass_E_StableCeiling</span>  <span class="p">)</span>
<a name="ln-8049"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">MixedStableCeilingEqNum</span>
<a name="ln-8050"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8051"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span> <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">MixedStableCeilingUserCurveNum</span>
<a name="ln-8052"></a>    <span class="n">ENDIF</span>
<a name="ln-8053"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">InConvClass_E_UnstableCieling</span><span class="p">)</span>
<a name="ln-8054"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">MixedUnstableCeilingEqNum</span>
<a name="ln-8055"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8056"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span> <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">MixedUnstableCeilingUserCurveNum</span>
<a name="ln-8057"></a>    <span class="n">ENDIF</span>
<a name="ln-8058"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">InConvClass_E_Windows</span>        <span class="p">)</span>
<a name="ln-8059"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span>          <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">MixedWindowsEqNum</span>
<a name="ln-8060"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcModelEq</span> <span class="o">==</span> <span class="n">HcInt_UserCurve</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8061"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvHcUserCurveIndex</span> <span class="o">=</span> <span class="n">InsideFaceAdaptiveConvectionAlgo</span><span class="p">%</span><span class="n">MixedWindowsUserCurveNum</span>
<a name="ln-8062"></a>    <span class="n">ENDIF</span>
<a name="ln-8063"></a>  <span class="k">END SELECT</span>
<a name="ln-8064"></a>
<a name="ln-8065"></a><span class="k">  RETURN</span>
<a name="ln-8066"></a>
<a name="ln-8067"></a><span class="k">END SUBROUTINE </span><span class="n">MapIntConvClassificationToHcModels</span>
<a name="ln-8068"></a>
<a name="ln-8069"></a><span class="k">SUBROUTINE </span><span class="n">CalcUserDefinedInsideHcModel</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span> <span class="n">UserCurveNum</span><span class="p">,</span> <span class="n">Hc</span><span class="p">)</span>
<a name="ln-8070"></a>
<a name="ln-8071"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-8072"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-8073"></a>          <span class="c">!       DATE WRITTEN   Aug 2010</span>
<a name="ln-8074"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8075"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8076"></a>
<a name="ln-8077"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-8078"></a>          <span class="c">! calculate user-defined convection correlations for inside face</span>
<a name="ln-8079"></a>
<a name="ln-8080"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8081"></a>          <span class="c">! call curve objects to evaluate user&#39;s model equation</span>
<a name="ln-8082"></a>          <span class="c">! prepare independent parameters for x values</span>
<a name="ln-8083"></a>
<a name="ln-8084"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8085"></a>          <span class="c">! na</span>
<a name="ln-8086"></a>
<a name="ln-8087"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8088"></a>  <span class="k">USE </span><span class="n">DataZoneEquipment</span>
<a name="ln-8089"></a>  <span class="k">USE </span><span class="n">DataHeatBalSurface</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TH</span>
<a name="ln-8090"></a>  <span class="k">USE </span><span class="n">DataHeatBalFanSys</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">MAT</span>
<a name="ln-8091"></a>  <span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">OutBaroPress</span>
<a name="ln-8092"></a>  <span class="k">USE </span><span class="n">Psychrometrics</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">,</span> <span class="n">PsyWFnTdpPb</span>
<a name="ln-8093"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurveValue</span>
<a name="ln-8094"></a>
<a name="ln-8095"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8096"></a>
<a name="ln-8097"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-8098"></a>  <span class="kt">INTEGER</span> <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">SurfNum</span>
<a name="ln-8099"></a>  <span class="kt">INTEGER</span> <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">UserCurveNum</span>
<a name="ln-8100"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span><span class="kd">::</span> <span class="n">Hc</span>
<a name="ln-8101"></a>
<a name="ln-8102"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-8103"></a>          <span class="c">! na</span>
<a name="ln-8104"></a>
<a name="ln-8105"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-8106"></a>          <span class="c">! na</span>
<a name="ln-8107"></a>
<a name="ln-8108"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-8109"></a>          <span class="c">! na</span>
<a name="ln-8110"></a>
<a name="ln-8111"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8112"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tmpHc</span>
<a name="ln-8113"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tmpAirTemp</span>
<a name="ln-8114"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SupplyAirTemp</span>
<a name="ln-8115"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">AirChangeRate</span>
<a name="ln-8116"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">ZoneNum</span>
<a name="ln-8117"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">ZoneNode</span>
<a name="ln-8118"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">EquipNum</span>
<a name="ln-8119"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SumMdotTemp</span>
<a name="ln-8120"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SumMdot</span>
<a name="ln-8121"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">AirDensity</span>
<a name="ln-8122"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">thisZoneInletNode</span>
<a name="ln-8123"></a>
<a name="ln-8124"></a>  <span class="n">ZoneNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-8125"></a>  <span class="n">SumMdotTemp</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-8126"></a>  <span class="n">SumMdot</span>     <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-8127"></a>  <span class="n">SupplyAirTemp</span> <span class="o">=</span> <span class="n">MAT</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span>
<a name="ln-8128"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">IsControlled</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8129"></a><span class="k">    </span><span class="n">ZoneNode</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SystemZoneNodeNumber</span>
<a name="ln-8130"></a>    <span class="n">AirDensity</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">PsyWFnTdpPb</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">))</span>
<a name="ln-8131"></a>    <span class="n">AirChangeRate</span> <span class="o">=</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span> <span class="n">SecInHour</span><span class="p">)</span><span class="o">/</span> <span class="p">(</span><span class="n">AirDensity</span> <span class="o">*</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Volume</span><span class="p">)</span>
<a name="ln-8132"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8133"></a><span class="k">      DO </span><span class="n">EquipNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">NumOfEquipTypes</span>
<a name="ln-8134"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">EquipData</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)%</span><span class="n">OutletNodeNums</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8135"></a><span class="k">          </span><span class="n">thisZoneInletNode</span> <span class="o">=</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">EquipData</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)%</span><span class="n">OutletNodeNums</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-8136"></a>          <span class="k">IF</span> <span class="p">((</span><span class="n">thisZoneInletNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">thisZoneInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8137"></a><span class="k">            </span><span class="n">SumMdotTemp</span> <span class="o">=</span> <span class="n">SumMdotTemp</span> <span class="o">+</span> <span class="n">Node</span><span class="p">(</span><span class="n">thisZoneInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span> <span class="n">Node</span><span class="p">(</span><span class="n">thisZoneInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-8138"></a>          <span class="n">ENDIF</span>
<a name="ln-8139"></a>        <span class="n">ENDIF</span>
<a name="ln-8140"></a>      <span class="n">ENDDO</span>
<a name="ln-8141"></a>    <span class="n">ENDIF</span>
<a name="ln-8142"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">SumMdot</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8143"></a><span class="k">      </span><span class="n">SupplyAirTemp</span> <span class="o">=</span> <span class="n">SumMdotTemp</span> <span class="o">/</span> <span class="n">SumMdot</span>      <span class="c">! mass flow weighted inlet temperature</span>
<a name="ln-8144"></a>    <span class="n">ENDIF</span>
<a name="ln-8145"></a>  <span class="n">ENDIF</span>
<a name="ln-8146"></a>
<a name="ln-8147"></a>  <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">HcInsideUserCurve</span><span class="p">(</span><span class="n">UserCurveNum</span><span class="p">)%</span><span class="n">ReferenceTempType</span><span class="p">)</span>
<a name="ln-8148"></a>
<a name="ln-8149"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">RefTempMeanAirTemp</span><span class="p">)</span>
<a name="ln-8150"></a>    <span class="n">tmpAirTemp</span> <span class="o">=</span> <span class="n">MAT</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span>
<a name="ln-8151"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TAirRef</span> <span class="o">=</span> <span class="n">ZoneMeanAirTemp</span>
<a name="ln-8152"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">RefTempAdjacentAirTemp</span><span class="p">)</span>
<a name="ln-8153"></a>    <span class="n">tmpAirTemp</span> <span class="o">=</span> <span class="n">TempEffBulkAir</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-8154"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TAirRef</span> <span class="o">=</span> <span class="n">AdjacentAirTemp</span>
<a name="ln-8155"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">RefTempSupplyAirTemp</span><span class="p">)</span>
<a name="ln-8156"></a>    <span class="n">tmpAirTemp</span> <span class="o">=</span> <span class="n">SupplyAirTemp</span>
<a name="ln-8157"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TAirRef</span> <span class="o">=</span> <span class="n">ZoneSupplyAirTemp</span>
<a name="ln-8158"></a>  <span class="k">END SELECT</span>
<a name="ln-8159"></a>
<a name="ln-8160"></a><span class="k">  </span><span class="n">tmpHc</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-8161"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">HcInsideUserCurve</span><span class="p">(</span><span class="n">UserCurveNum</span><span class="p">)%</span><span class="n">HcFnTempDiffCurveNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8162"></a><span class="k">    </span><span class="n">tmpHc</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">HcInsideUserCurve</span><span class="p">(</span><span class="n">UserCurveNum</span><span class="p">)%</span><span class="n">HcFnTempDiffCurveNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8163"></a>                              <span class="nb">ABS</span><span class="p">(</span><span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">tmpAirTemp</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-8164"></a>  <span class="n">ENDIF</span>
<a name="ln-8165"></a>
<a name="ln-8166"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">HcInsideUserCurve</span><span class="p">(</span><span class="n">UserCurveNum</span><span class="p">)%</span><span class="n">HcFnTempDiffDivHeightCurveNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8167"></a><span class="k">    </span><span class="n">tmpHc</span> <span class="o">=</span> <span class="n">tmpHc</span> <span class="o">+</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">HcInsideUserCurve</span><span class="p">(</span><span class="n">UserCurveNum</span><span class="p">)%</span><span class="n">HcFnTempDiffDivHeightCurveNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8168"></a>                              <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">tmpAirTemp</span><span class="p">)</span><span class="o">/</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvZoneWallHeight</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-8169"></a>  <span class="n">ENDIF</span>
<a name="ln-8170"></a>
<a name="ln-8171"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">HcInsideUserCurve</span><span class="p">(</span><span class="n">UserCurveNum</span><span class="p">)%</span><span class="n">HcFnACHCurveNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8172"></a><span class="k">    </span><span class="n">tmpHc</span> <span class="o">=</span> <span class="n">tmpHc</span> <span class="o">+</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">HcInsideUserCurve</span><span class="p">(</span><span class="n">UserCurveNum</span><span class="p">)%</span><span class="n">HcFnACHCurveNum</span><span class="p">,</span> <span class="n">AirChangeRate</span><span class="p">)</span>
<a name="ln-8173"></a>  <span class="n">ENDIF</span>
<a name="ln-8174"></a>
<a name="ln-8175"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">HcInsideUserCurve</span><span class="p">(</span><span class="n">UserCurveNum</span><span class="p">)%</span><span class="n">HcFnACHDivPerimLengthCurveNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8176"></a><span class="k">    </span><span class="n">tmpHc</span> <span class="o">=</span> <span class="n">tmpHc</span> <span class="o">+</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">HcInsideUserCurve</span><span class="p">(</span><span class="n">UserCurveNum</span><span class="p">)%</span><span class="n">HcFnACHDivPerimLengthCurveNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8177"></a>                  <span class="p">(</span><span class="n">AirChangeRate</span> <span class="o">/</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntConvZonePerimLength</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-8178"></a>  <span class="n">ENDIF</span>
<a name="ln-8179"></a>
<a name="ln-8180"></a>  <span class="n">Hc</span> <span class="o">=</span> <span class="n">tmpHc</span>
<a name="ln-8181"></a>
<a name="ln-8182"></a>  <span class="k">RETURN</span>
<a name="ln-8183"></a>
<a name="ln-8184"></a><span class="k">END SUBROUTINE </span><span class="n">CalcUserDefinedInsideHcModel</span>
<a name="ln-8185"></a>
<a name="ln-8186"></a>
<a name="ln-8187"></a><span class="k">SUBROUTINE </span><span class="n">CalcUserDefinedOutsideHcModel</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span> <span class="n">UserCurveNum</span><span class="p">,</span> <span class="n">H</span><span class="p">)</span>
<a name="ln-8188"></a>
<a name="ln-8189"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-8190"></a>          <span class="c">!       AUTHOR         &lt;Brent Griffith</span>
<a name="ln-8191"></a>          <span class="c">!       DATE WRITTEN   Aug 2010</span>
<a name="ln-8192"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8193"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8194"></a>
<a name="ln-8195"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-8196"></a>          <span class="c">! calculate user-defined convection correlations for outside face</span>
<a name="ln-8197"></a>
<a name="ln-8198"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8199"></a>          <span class="c">! call curve objects to evaluate user&#39;s model equation</span>
<a name="ln-8200"></a>          <span class="c">! prepare independent parameters for x values</span>
<a name="ln-8201"></a>
<a name="ln-8202"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8203"></a>          <span class="c">! na</span>
<a name="ln-8204"></a>
<a name="ln-8205"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8206"></a>  <span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">WindSpeed</span><span class="p">,</span> <span class="n">WindDir</span>
<a name="ln-8207"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurveValue</span>
<a name="ln-8208"></a>  <span class="k">USE </span><span class="n">DataHeatBalSurface</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TH</span>
<a name="ln-8209"></a>
<a name="ln-8210"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8211"></a>
<a name="ln-8212"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-8213"></a>  <span class="kt">INTEGER</span> <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">SurfNum</span>
<a name="ln-8214"></a>  <span class="kt">INTEGER</span> <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">UserCurveNum</span>
<a name="ln-8215"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">H</span>
<a name="ln-8216"></a>
<a name="ln-8217"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-8218"></a>          <span class="c">! na</span>
<a name="ln-8219"></a>
<a name="ln-8220"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-8221"></a>          <span class="c">! na</span>
<a name="ln-8222"></a>
<a name="ln-8223"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-8224"></a>          <span class="c">! na</span>
<a name="ln-8225"></a>
<a name="ln-8226"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8227"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tmpHc</span>
<a name="ln-8228"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">windVel</span>
<a name="ln-8229"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">theta</span>
<a name="ln-8230"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThetaRad</span>
<a name="ln-8231"></a>
<a name="ln-8232"></a>  <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">HcOutsideUserCurve</span><span class="p">(</span><span class="n">UserCurveNum</span><span class="p">)%</span><span class="n">WindSpeedType</span><span class="p">)</span>
<a name="ln-8233"></a>
<a name="ln-8234"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">RefWindWeatherFile</span><span class="p">)</span>
<a name="ln-8235"></a>    <span class="n">windVel</span> <span class="o">=</span> <span class="n">WindSpeed</span>
<a name="ln-8236"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">RefWindAtZ</span><span class="p">)</span>
<a name="ln-8237"></a>    <span class="n">windVel</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindSpeed</span>
<a name="ln-8238"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">RefWindParallComp</span><span class="p">)</span>
<a name="ln-8239"></a>    <span class="c">! WindSpeed , WindDir, surface Azimuth</span>
<a name="ln-8240"></a>     <span class="n">Theta</span> <span class="o">=</span> <span class="n">WindDir</span> <span class="o">-</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span> <span class="o">-</span> <span class="mi">9</span><span class="mf">0.d0</span> <span class="c">!TODO double check theta</span>
<a name="ln-8241"></a>     <span class="n">ThetaRad</span> <span class="o">=</span> <span class="n">Theta</span> <span class="o">*</span> <span class="n">DegToRadians</span>
<a name="ln-8242"></a>     <span class="n">windVel</span> <span class="o">=</span> <span class="nb">cos</span><span class="p">(</span><span class="n">ThetaRad</span><span class="p">)</span> <span class="o">*</span> <span class="n">WindSpeed</span>
<a name="ln-8243"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">RefWindParallCompAtZ</span><span class="p">)</span>
<a name="ln-8244"></a>    <span class="c">! Surface WindSpeed , WindDir, surface Azimuth</span>
<a name="ln-8245"></a>     <span class="n">Theta</span> <span class="o">=</span> <span class="n">WindDir</span> <span class="o">-</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span> <span class="o">-</span> <span class="mi">9</span><span class="mf">0.d0</span> <span class="c">!TODO double check theta</span>
<a name="ln-8246"></a>     <span class="n">ThetaRad</span> <span class="o">=</span> <span class="n">Theta</span> <span class="o">*</span> <span class="n">DegToRadians</span>
<a name="ln-8247"></a>     <span class="n">windVel</span> <span class="o">=</span> <span class="nb">cos</span><span class="p">(</span><span class="n">ThetaRad</span><span class="p">)</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindSpeed</span>
<a name="ln-8248"></a>  <span class="k">END SELECT</span>
<a name="ln-8249"></a>
<a name="ln-8250"></a>
<a name="ln-8251"></a><span class="k">  </span><span class="n">tmpHc</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-8252"></a>  <span class="k">IF</span> <span class="p">(</span>  <span class="n">HcOutsideUserCurve</span><span class="p">(</span><span class="n">UserCurveNum</span><span class="p">)%</span><span class="n">HfFnWindSpeedCurveNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8253"></a><span class="k">    </span><span class="n">tmpHc</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">HcOutsideUserCurve</span><span class="p">(</span><span class="n">UserCurveNum</span><span class="p">)%</span><span class="n">HfFnWindSpeedCurveNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8254"></a>                        <span class="n">windVel</span> <span class="p">)</span>
<a name="ln-8255"></a>  <span class="n">ENDIF</span>
<a name="ln-8256"></a>
<a name="ln-8257"></a>  <span class="k">IF</span> <span class="p">(</span>  <span class="n">HcOutsideUserCurve</span><span class="p">(</span><span class="n">UserCurveNum</span><span class="p">)%</span><span class="n">HnFnTempDiffCurveNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8258"></a><span class="k">    </span><span class="n">tmpHc</span> <span class="o">=</span> <span class="n">tmpHc</span> <span class="o">+</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">HcOutsideUserCurve</span><span class="p">(</span><span class="n">UserCurveNum</span><span class="p">)%</span><span class="n">HnFnTempDiffCurveNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8259"></a>                        <span class="nb">ABS</span><span class="p">(</span><span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutDryBulbTemp</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-8260"></a>  <span class="n">ENDIF</span>
<a name="ln-8261"></a>
<a name="ln-8262"></a>  <span class="k">IF</span> <span class="p">(</span>  <span class="n">HcOutsideUserCurve</span><span class="p">(</span><span class="n">UserCurveNum</span><span class="p">)%</span><span class="n">HnFnTempDiffDivHeightCurveNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8263"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvFaceHeight</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8264"></a><span class="k">      </span><span class="n">tmpHc</span> <span class="o">=</span> <span class="n">tmpHc</span> <span class="o">+</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">HcOutsideUserCurve</span><span class="p">(</span><span class="n">UserCurveNum</span><span class="p">)%</span><span class="n">HnFnTempDiffDivHeightCurveNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8265"></a>                        <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">TH</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutDryBulbTemp</span><span class="p">))&amp;</span>
<a name="ln-8266"></a>                        <span class="o">/</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutConvFaceHeight</span><span class="p">)</span>  <span class="p">)</span>
<a name="ln-8267"></a>    <span class="n">ENDIF</span>
<a name="ln-8268"></a>  <span class="n">ENDIF</span>
<a name="ln-8269"></a>
<a name="ln-8270"></a>  <span class="n">H</span> <span class="o">=</span> <span class="n">tmpHc</span>
<a name="ln-8271"></a>
<a name="ln-8272"></a>  <span class="k">RETURN</span>
<a name="ln-8273"></a>
<a name="ln-8274"></a><span class="k">END SUBROUTINE </span><span class="n">CalcUserDefinedOutsideHcModel</span>
<a name="ln-8275"></a>
<a name="ln-8276"></a>
<a name="ln-8277"></a>
<a name="ln-8278"></a><span class="c">!** Begin catalog of Hc equation functions. **** !*************************************************</span>
<a name="ln-8279"></a><span class="k">FUNCTION </span><span class="n">CalcASHRAEVerticalWall</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Hn</span><span class="p">)</span>
<a name="ln-8280"></a>
<a name="ln-8281"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-8282"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-8283"></a>          <span class="c">!       DATE WRITTEN   Aug 2010</span>
<a name="ln-8284"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8285"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8286"></a>
<a name="ln-8287"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-8288"></a>          <span class="c">! Calculate the model equation attributed to ASHRAE for vertical walls for natural convection</span>
<a name="ln-8289"></a>
<a name="ln-8290"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8291"></a>          <span class="c">!</span>
<a name="ln-8292"></a>
<a name="ln-8293"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8294"></a>          <span class="c">! 2.  ASHRAE Handbook of Fundamentals 2001, p. 3.12, Table 5.</span>
<a name="ln-8295"></a>
<a name="ln-8296"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8297"></a>          <span class="c">! na</span>
<a name="ln-8298"></a>
<a name="ln-8299"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8300"></a>
<a name="ln-8301"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-8302"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DeltaTemp</span>         <span class="c">! [C] temperature difference between surface and air</span>
<a name="ln-8303"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">Hn</span> <span class="c">! function result</span>
<a name="ln-8304"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-8305"></a>          <span class="c">! na</span>
<a name="ln-8306"></a>
<a name="ln-8307"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-8308"></a>          <span class="c">! na</span>
<a name="ln-8309"></a>
<a name="ln-8310"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-8311"></a>          <span class="c">! na</span>
<a name="ln-8312"></a>
<a name="ln-8313"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8314"></a>          <span class="c">! na</span>
<a name="ln-8315"></a>  <span class="n">Hn</span> <span class="o">=</span> <span class="mf">1.31d0</span> <span class="o">*</span><span class="p">(</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">))</span><span class="o">**</span><span class="n">OneThird</span><span class="p">)</span>
<a name="ln-8316"></a>
<a name="ln-8317"></a>  <span class="k">RETURN</span>
<a name="ln-8318"></a>
<a name="ln-8319"></a><span class="k">END FUNCTION </span><span class="n">CalcASHRAEVerticalWall</span>
<a name="ln-8320"></a>
<a name="ln-8321"></a><span class="k">FUNCTION </span><span class="n">CalcWaltonUnstableHorizontalOrTilt</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">,</span> <span class="n">CosineTilt</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Hn</span><span class="p">)</span>
<a name="ln-8322"></a>
<a name="ln-8323"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-8324"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-8325"></a>          <span class="c">!       DATE WRITTEN   Aug 2010</span>
<a name="ln-8326"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8327"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8328"></a>
<a name="ln-8329"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-8330"></a>          <span class="c">! Calculate the model equation attributed to Walton&#39;s TARP program for horizontal</span>
<a name="ln-8331"></a>          <span class="c">! and tilted surfaces with enhanced, thermally unstable natural convection</span>
<a name="ln-8332"></a>
<a name="ln-8333"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8334"></a>          <span class="c">!</span>
<a name="ln-8335"></a>
<a name="ln-8336"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8337"></a>          <span class="c">! 1.  Walton, G. N. 1983. Thermal Analysis Research Program (TARP) Reference Manual,</span>
<a name="ln-8338"></a>          <span class="c">!     NBSSIR 83-2655, National Bureau of Standards, &quot;Surface Inside Heat Balances&quot;, pp 79-80.</span>
<a name="ln-8339"></a>
<a name="ln-8340"></a>
<a name="ln-8341"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8342"></a>          <span class="c">! na</span>
<a name="ln-8343"></a>
<a name="ln-8344"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8345"></a>
<a name="ln-8346"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-8347"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DeltaTemp</span>     <span class="c">! [C] temperature difference between surface and air</span>
<a name="ln-8348"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CosineTilt</span>   <span class="c">! Cosine of tilt angle</span>
<a name="ln-8349"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">Hn</span> <span class="c">! function result</span>
<a name="ln-8350"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-8351"></a>          <span class="c">! na</span>
<a name="ln-8352"></a>
<a name="ln-8353"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-8354"></a>          <span class="c">! na</span>
<a name="ln-8355"></a>
<a name="ln-8356"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-8357"></a>          <span class="c">! na</span>
<a name="ln-8358"></a>
<a name="ln-8359"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8360"></a>          <span class="c">! na</span>
<a name="ln-8361"></a>  <span class="n">Hn</span> <span class="o">=</span>  <span class="mf">9.482d0</span><span class="o">*</span><span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">))</span><span class="o">**</span><span class="n">OneThird</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-8362"></a>                      <span class="o">/</span><span class="p">(</span><span class="mf">7.283d0</span> <span class="o">-</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">CosineTilt</span><span class="p">))</span>
<a name="ln-8363"></a>
<a name="ln-8364"></a>  <span class="k">RETURN</span>
<a name="ln-8365"></a>
<a name="ln-8366"></a><span class="k">END FUNCTION </span><span class="n">CalcWaltonUnstableHorizontalOrTilt</span>
<a name="ln-8367"></a>
<a name="ln-8368"></a><span class="k">FUNCTION </span><span class="n">CalcWaltonStableHorizontalOrTilt</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">,</span> <span class="n">CosineTilt</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Hn</span><span class="p">)</span>
<a name="ln-8369"></a>
<a name="ln-8370"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-8371"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-8372"></a>          <span class="c">!       DATE WRITTEN   Aug 2010</span>
<a name="ln-8373"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8374"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8375"></a>
<a name="ln-8376"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-8377"></a>          <span class="c">! Calculate the model equation attributed to Walton&#39;s TARP program for horizontal</span>
<a name="ln-8378"></a>          <span class="c">! and tilted surfaces with reduced, thermally stable natural convection</span>
<a name="ln-8379"></a>
<a name="ln-8380"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8381"></a>          <span class="c">!</span>
<a name="ln-8382"></a>
<a name="ln-8383"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8384"></a>          <span class="c">! 1.  Walton, G. N. 1983. Thermal Analysis Research Program (TARP) Reference Manual,</span>
<a name="ln-8385"></a>          <span class="c">!     NBSSIR 83-2655, National Bureau of Standards, &quot;Surface Inside Heat Balances&quot;, pp 79-80.</span>
<a name="ln-8386"></a>
<a name="ln-8387"></a>
<a name="ln-8388"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8389"></a>          <span class="c">! na</span>
<a name="ln-8390"></a>
<a name="ln-8391"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8392"></a>
<a name="ln-8393"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-8394"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DeltaTemp</span>     <span class="c">! [C] temperature difference between surface and air</span>
<a name="ln-8395"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CosineTilt</span>   <span class="c">! Cosine of tilt angle</span>
<a name="ln-8396"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">Hn</span> <span class="c">! function result</span>
<a name="ln-8397"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-8398"></a>          <span class="c">! na</span>
<a name="ln-8399"></a>
<a name="ln-8400"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-8401"></a>          <span class="c">! na</span>
<a name="ln-8402"></a>
<a name="ln-8403"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-8404"></a>          <span class="c">! na</span>
<a name="ln-8405"></a>
<a name="ln-8406"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8407"></a>          <span class="c">! na</span>
<a name="ln-8408"></a>  <span class="n">Hn</span> <span class="o">=</span> <span class="mf">1.810d0</span><span class="o">*</span><span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">))</span><span class="o">**</span><span class="n">OneThird</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-8409"></a>                      <span class="o">/</span><span class="p">(</span><span class="mf">1.382d0</span> <span class="o">+</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">CosineTilt</span><span class="p">))</span>
<a name="ln-8410"></a>
<a name="ln-8411"></a>  <span class="k">RETURN</span>
<a name="ln-8412"></a>
<a name="ln-8413"></a><span class="k">END FUNCTION </span><span class="n">CalcWaltonStableHorizontalOrTilt</span>
<a name="ln-8414"></a>
<a name="ln-8415"></a><span class="k">FUNCTION </span><span class="n">CalcFisherPedersenCeilDiffuserFloor</span><span class="p">(</span><span class="n">AirChangeRate</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Hc</span><span class="p">)</span>
<a name="ln-8416"></a>
<a name="ln-8417"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-8418"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-8419"></a>          <span class="c">!       DATE WRITTEN   Aug 2010</span>
<a name="ln-8420"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8421"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8422"></a>
<a name="ln-8423"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-8424"></a>          <span class="c">! Calculate the model equation by Fisher and Pedersen for floors with ceiling diffusers</span>
<a name="ln-8425"></a>
<a name="ln-8426"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8427"></a>          <span class="c">!</span>
<a name="ln-8428"></a>
<a name="ln-8429"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8430"></a>          <span class="c">! Fisher, D.E. and C.O. Pedersen, Convective Heat Transfer in Building Energy and</span>
<a name="ln-8431"></a>          <span class="c">!       Thermal Load Calculations, ASHRAE Transactions, vol. 103, Pt. 2, 1997, p.13</span>
<a name="ln-8432"></a>
<a name="ln-8433"></a>
<a name="ln-8434"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8435"></a>          <span class="c">! na</span>
<a name="ln-8436"></a>
<a name="ln-8437"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8438"></a>
<a name="ln-8439"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-8440"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirChangeRate</span>    <span class="c">! [1/hr] air system air change rate</span>
<a name="ln-8441"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">Hc</span> <span class="c">! function result</span>
<a name="ln-8442"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-8443"></a>          <span class="c">! na</span>
<a name="ln-8444"></a>
<a name="ln-8445"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-8446"></a>          <span class="c">! na</span>
<a name="ln-8447"></a>
<a name="ln-8448"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-8449"></a>          <span class="c">! na</span>
<a name="ln-8450"></a>
<a name="ln-8451"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8452"></a>          <span class="c">! na</span>
<a name="ln-8453"></a>  <span class="n">Hc</span> <span class="o">=</span> <span class="mf">3.873d0</span> <span class="o">+</span> <span class="mf">0.082d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">AirChangeRate</span><span class="o">**</span><span class="mf">0.98d0</span><span class="p">)</span>
<a name="ln-8454"></a>
<a name="ln-8455"></a>  <span class="k">RETURN</span>
<a name="ln-8456"></a>
<a name="ln-8457"></a><span class="k">END FUNCTION </span><span class="n">CalcFisherPedersenCeilDiffuserFloor</span>
<a name="ln-8458"></a>
<a name="ln-8459"></a><span class="k">FUNCTION </span><span class="n">CalcFisherPedersenCeilDiffuserCeiling</span><span class="p">(</span><span class="n">AirChangeRate</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Hc</span><span class="p">)</span>
<a name="ln-8460"></a>
<a name="ln-8461"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-8462"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-8463"></a>          <span class="c">!       DATE WRITTEN   Aug 2010</span>
<a name="ln-8464"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8465"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8466"></a>
<a name="ln-8467"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-8468"></a>          <span class="c">! Calculate the model equation by Fisher and Pedersen for ceilings with ceiling diffusers</span>
<a name="ln-8469"></a>
<a name="ln-8470"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8471"></a>          <span class="c">!</span>
<a name="ln-8472"></a>
<a name="ln-8473"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8474"></a>          <span class="c">! Fisher, D.E. and C.O. Pedersen, Convective Heat Transfer in Building Energy and</span>
<a name="ln-8475"></a>          <span class="c">!       Thermal Load Calculations, ASHRAE Transactions, vol. 103, Pt. 2, 1997, p.13</span>
<a name="ln-8476"></a>
<a name="ln-8477"></a>
<a name="ln-8478"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8479"></a>          <span class="c">! na</span>
<a name="ln-8480"></a>
<a name="ln-8481"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8482"></a>
<a name="ln-8483"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-8484"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirChangeRate</span>    <span class="c">! [1/hr] air system air change rate</span>
<a name="ln-8485"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">Hc</span> <span class="c">! function result</span>
<a name="ln-8486"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-8487"></a>          <span class="c">! na</span>
<a name="ln-8488"></a>
<a name="ln-8489"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-8490"></a>          <span class="c">! na</span>
<a name="ln-8491"></a>
<a name="ln-8492"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-8493"></a>          <span class="c">! na</span>
<a name="ln-8494"></a>
<a name="ln-8495"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8496"></a>          <span class="c">! na</span>
<a name="ln-8497"></a>  <span class="n">Hc</span> <span class="o">=</span> <span class="mf">2.234d0</span> <span class="o">+</span> <span class="mf">4.099d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">AirChangeRate</span><span class="o">**</span><span class="mf">0.503d0</span><span class="p">)</span>
<a name="ln-8498"></a>
<a name="ln-8499"></a>  <span class="k">RETURN</span>
<a name="ln-8500"></a>
<a name="ln-8501"></a><span class="k">END FUNCTION </span><span class="n">CalcFisherPedersenCeilDiffuserCeiling</span>
<a name="ln-8502"></a>
<a name="ln-8503"></a><span class="k">FUNCTION </span><span class="n">CalcFisherPedersenCeilDiffuserWalls</span><span class="p">(</span><span class="n">AirChangeRate</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Hc</span><span class="p">)</span>
<a name="ln-8504"></a>
<a name="ln-8505"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-8506"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-8507"></a>          <span class="c">!       DATE WRITTEN   Aug 2010</span>
<a name="ln-8508"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8509"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8510"></a>
<a name="ln-8511"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-8512"></a>          <span class="c">! Calculate the model equation by Fisher and Pedersen for walls with ceiling diffusers</span>
<a name="ln-8513"></a>
<a name="ln-8514"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8515"></a>          <span class="c">!</span>
<a name="ln-8516"></a>
<a name="ln-8517"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8518"></a>          <span class="c">! Fisher, D.E. and C.O. Pedersen, Convective Heat Transfer in Building Energy and</span>
<a name="ln-8519"></a>          <span class="c">!       Thermal Load Calculations, ASHRAE Transactions, vol. 103, Pt. 2, 1997, p.13</span>
<a name="ln-8520"></a>
<a name="ln-8521"></a>
<a name="ln-8522"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8523"></a>          <span class="c">! na</span>
<a name="ln-8524"></a>
<a name="ln-8525"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8526"></a>
<a name="ln-8527"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-8528"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirChangeRate</span>    <span class="c">! [1/hr] air system air change rate</span>
<a name="ln-8529"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">Hc</span> <span class="c">! function result</span>
<a name="ln-8530"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-8531"></a>          <span class="c">! na</span>
<a name="ln-8532"></a>
<a name="ln-8533"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-8534"></a>          <span class="c">! na</span>
<a name="ln-8535"></a>
<a name="ln-8536"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-8537"></a>          <span class="c">! na</span>
<a name="ln-8538"></a>
<a name="ln-8539"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8540"></a>          <span class="c">! na</span>
<a name="ln-8541"></a>  <span class="n">Hc</span> <span class="o">=</span> <span class="mf">1.208d0</span> <span class="o">+</span> <span class="mf">1.012d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">AirChangeRate</span><span class="o">**</span><span class="mf">0.604d0</span><span class="p">)</span>
<a name="ln-8542"></a>
<a name="ln-8543"></a>  <span class="k">RETURN</span>
<a name="ln-8544"></a>
<a name="ln-8545"></a><span class="k">END FUNCTION </span><span class="n">CalcFisherPedersenCeilDiffuserWalls</span>
<a name="ln-8546"></a>
<a name="ln-8547"></a><span class="k">FUNCTION </span><span class="n">CalcAlamdariHammondUnstableHorizontal</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">,</span> <span class="n">HydraulicDiameter</span><span class="p">,</span> <span class="n">SurfNum</span> <span class="p">)</span>  <span class="k">RESULT</span> <span class="p">(</span><span class="n">Hn</span><span class="p">)</span>
<a name="ln-8548"></a>
<a name="ln-8549"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-8550"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-8551"></a>          <span class="c">!       DATE WRITTEN   Jul 2010</span>
<a name="ln-8552"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8553"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8554"></a>
<a name="ln-8555"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-8556"></a>          <span class="c">! Calculate model equation for Alamdari and Hammond</span>
<a name="ln-8557"></a>          <span class="c">! This function only for the Unstable heat flow direction for horizontal surfaces</span>
<a name="ln-8558"></a>
<a name="ln-8559"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8560"></a>          <span class="c">! isolate function for equation.</span>
<a name="ln-8561"></a>
<a name="ln-8562"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8563"></a>          <span class="c">! Alamdari, F. and G.P. Hammond. 1983. Improved data correlations</span>
<a name="ln-8564"></a>          <span class="c">! for buoyancy-driven convection in rooms.  Building Services Engineering</span>
<a name="ln-8565"></a>          <span class="c">! Research &amp; Technology. Vol. 4, No. 3.</span>
<a name="ln-8566"></a>
<a name="ln-8567"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8568"></a>          <span class="c">! na</span>
<a name="ln-8569"></a>
<a name="ln-8570"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8571"></a>
<a name="ln-8572"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-8573"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DeltaTemp</span>         <span class="c">! [C] temperature difference between surface and air</span>
<a name="ln-8574"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HydraulicDiameter</span> <span class="c">! [m] characteristic size, = (4 * area) / perimeter</span>
<a name="ln-8575"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfNum</span>  <span class="c">! for messages</span>
<a name="ln-8576"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">Hn</span> <span class="c">! function result</span>
<a name="ln-8577"></a>
<a name="ln-8578"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-8579"></a>          <span class="c">! na</span>
<a name="ln-8580"></a>
<a name="ln-8581"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-8582"></a>          <span class="c">! na</span>
<a name="ln-8583"></a>
<a name="ln-8584"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-8585"></a>          <span class="c">! na</span>
<a name="ln-8586"></a>
<a name="ln-8587"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8588"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ErrorIndex</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-8589"></a>
<a name="ln-8590"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">HydraulicDiameter</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8591"></a><span class="k">    </span><span class="n">Hn</span>  <span class="o">=</span> <span class="p">(</span>  <span class="p">((</span><span class="mf">1.4d0</span> <span class="o">*</span> <span class="p">((</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">)</span><span class="o">/</span><span class="n">HydraulicDiameter</span><span class="p">)</span><span class="o">**</span><span class="n">OneFourth</span><span class="p">))</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-8592"></a>           <span class="o">+</span> <span class="p">((</span><span class="mf">1.63d0</span><span class="o">*</span><span class="p">(</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">))</span><span class="o">**</span><span class="n">OneThird</span><span class="p">)</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="p">))</span><span class="o">**</span><span class="n">OneSixth</span>
<a name="ln-8593"></a>  <span class="k">ELSE</span>
<a name="ln-8594"></a><span class="k">    </span><span class="n">Hn</span> <span class="o">=</span> <span class="mf">9.999d0</span>
<a name="ln-8595"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8596"></a><span class="k">      CALL </span><span class="n">ShowSevereMessage</span><span class="p">(</span><span class="s1">&#39;CalcAlamdariHammondUnstableHorizontal: Convection model not evaluated (would divide by zero)&#39;</span><span class="p">)</span>
<a name="ln-8597"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Effective hydraulic diameter is zero, convection model not applicable for surface =&#39;</span> <span class="p">&amp;</span>
<a name="ln-8598"></a>                              <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">name</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-8599"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Convection surface heat transfer coefficient set to 9.999 [W/m2-K] and the simulation continues&#39;</span><span class="p">)</span>
<a name="ln-8600"></a>
<a name="ln-8601"></a>    <span class="n">ENDIF</span>
<a name="ln-8602"></a>    <span class="k">CALL </span><span class="n">ShowRecurringSevereErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;CalcAlamdariHammondUnstableHorizontal: Convection model not evaluated because zero&#39;</span> <span class="p">&amp;</span>
<a name="ln-8603"></a>                               <span class="o">//</span><span class="s1">&#39; hydraulic diameter and set to 9.999 [W/m2-K]&#39;</span><span class="p">,</span>  <span class="n">ErrorIndex</span> <span class="p">)</span>
<a name="ln-8604"></a>  <span class="n">ENDIF</span>
<a name="ln-8605"></a>
<a name="ln-8606"></a>  <span class="k">RETURN</span>
<a name="ln-8607"></a>
<a name="ln-8608"></a><span class="k">END FUNCTION </span><span class="n">CalcAlamdariHammondUnstableHorizontal</span>
<a name="ln-8609"></a>
<a name="ln-8610"></a><span class="k">FUNCTION </span><span class="n">CalcAlamdariHammondStableHorizontal</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">,</span> <span class="n">HydraulicDiameter</span><span class="p">,</span> <span class="n">SurfNum</span> <span class="p">)</span>  <span class="k">RESULT</span> <span class="p">(</span><span class="n">Hn</span><span class="p">)</span>
<a name="ln-8611"></a>
<a name="ln-8612"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-8613"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-8614"></a>          <span class="c">!       DATE WRITTEN   Jul 2010</span>
<a name="ln-8615"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8616"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8617"></a>
<a name="ln-8618"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-8619"></a>          <span class="c">! Calculate model equation for Alamdari and Hammond</span>
<a name="ln-8620"></a>          <span class="c">! This function only for the Stable heat flow direction for horizontal surfaces</span>
<a name="ln-8621"></a>
<a name="ln-8622"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8623"></a>          <span class="c">! isolate function for equation.</span>
<a name="ln-8624"></a>
<a name="ln-8625"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8626"></a>          <span class="c">! Alamdari, F. and G.P. Hammond. 1983. Improved data correlations</span>
<a name="ln-8627"></a>          <span class="c">! for buoyancy-driven convection in rooms.  Building Services Engineering</span>
<a name="ln-8628"></a>          <span class="c">! Research &amp; Technology. Vol. 4, No. 3.</span>
<a name="ln-8629"></a>
<a name="ln-8630"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8631"></a>          <span class="c">! na</span>
<a name="ln-8632"></a>
<a name="ln-8633"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8634"></a>
<a name="ln-8635"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-8636"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DeltaTemp</span>         <span class="c">! [C] temperature difference between surface and air</span>
<a name="ln-8637"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HydraulicDiameter</span> <span class="c">! [m] characteristic size, = (4 * area) / perimeter</span>
<a name="ln-8638"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfNum</span>  <span class="c">! for messages</span>
<a name="ln-8639"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">Hn</span> <span class="c">! function result, natural convection Hc value</span>
<a name="ln-8640"></a>
<a name="ln-8641"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-8642"></a>          <span class="c">! na</span>
<a name="ln-8643"></a>
<a name="ln-8644"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-8645"></a>          <span class="c">! na</span>
<a name="ln-8646"></a>
<a name="ln-8647"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-8648"></a>          <span class="c">! na</span>
<a name="ln-8649"></a>
<a name="ln-8650"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8651"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ErrorIndex</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-8652"></a>
<a name="ln-8653"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">HydraulicDiameter</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8654"></a><span class="k">    </span><span class="n">Hn</span>  <span class="o">=</span> <span class="mf">0.6d0</span> <span class="o">*</span> <span class="p">((</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">HydraulicDiameter</span><span class="o">**</span><span class="mi">2</span> <span class="p">))</span> <span class="o">**</span> <span class="n">OneFifth</span><span class="p">)</span>
<a name="ln-8655"></a>  <span class="k">ELSE</span>
<a name="ln-8656"></a><span class="k">    </span><span class="n">Hn</span> <span class="o">=</span> <span class="mf">9.999d0</span>
<a name="ln-8657"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8658"></a><span class="k">      CALL </span><span class="n">ShowSevereMessage</span><span class="p">(</span><span class="s1">&#39;CalcAlamdariHammondStableHorizontal: Convection model not evaluated (would divide by zero)&#39;</span><span class="p">)</span>
<a name="ln-8659"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Effective hydraulic diameter is zero, convection model not applicable for surface =&#39;</span> <span class="p">&amp;</span>
<a name="ln-8660"></a>                              <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">name</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-8661"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Convection surface heat transfer coefficient set to 9.999 [W/m2-K] and the simulation continues&#39;</span><span class="p">)</span>
<a name="ln-8662"></a>    <span class="n">ENDIF</span>
<a name="ln-8663"></a>    <span class="k">CALL </span><span class="n">ShowRecurringSevereErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;CalcAlamdariHammondStableHorizontal: Convection model not evaluated because zero&#39;</span> <span class="p">&amp;</span>
<a name="ln-8664"></a>                               <span class="o">//</span><span class="s1">&#39; hydraulic diameter and set to 9.999 [W/m2-K]&#39;</span> <span class="p">,</span> <span class="n">ErrorIndex</span> <span class="p">)</span>
<a name="ln-8665"></a>  <span class="n">ENDIF</span>
<a name="ln-8666"></a>
<a name="ln-8667"></a>  <span class="k">RETURN</span>
<a name="ln-8668"></a>
<a name="ln-8669"></a><span class="k">END FUNCTION </span><span class="n">CalcAlamdariHammondStableHorizontal</span>
<a name="ln-8670"></a>
<a name="ln-8671"></a><span class="k">FUNCTION </span><span class="n">CalcAlamdariHammondVerticalWall</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">,</span> <span class="n">Height</span><span class="p">,</span> <span class="n">SurfNum</span> <span class="p">)</span>  <span class="k">RESULT</span> <span class="p">(</span><span class="n">Hn</span><span class="p">)</span>
<a name="ln-8672"></a>
<a name="ln-8673"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-8674"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-8675"></a>          <span class="c">!       DATE WRITTEN   Jul 2010</span>
<a name="ln-8676"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8677"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8678"></a>
<a name="ln-8679"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-8680"></a>          <span class="c">! Calculate model equation for Alamdari and Hammond</span>
<a name="ln-8681"></a>          <span class="c">! This function only for the vertical wall surfaces</span>
<a name="ln-8682"></a>
<a name="ln-8683"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8684"></a>          <span class="c">! isolate function for equation.</span>
<a name="ln-8685"></a>
<a name="ln-8686"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8687"></a>          <span class="c">! Alamdari, F. and G.P. Hammond. 1983. Improved data correlations</span>
<a name="ln-8688"></a>          <span class="c">! for buoyancy-driven convection in rooms.  Building Services Engineering</span>
<a name="ln-8689"></a>          <span class="c">! Research &amp; Technology. Vol. 4, No. 3.</span>
<a name="ln-8690"></a>
<a name="ln-8691"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8692"></a>          <span class="c">! na</span>
<a name="ln-8693"></a>
<a name="ln-8694"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8695"></a>
<a name="ln-8696"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-8697"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DeltaTemp</span>         <span class="c">! [C] temperature difference between surface and air</span>
<a name="ln-8698"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Height</span> <span class="c">! [m] characteristic size, = zone height</span>
<a name="ln-8699"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfNum</span>  <span class="c">! for messages</span>
<a name="ln-8700"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">Hn</span> <span class="c">! function result, natural convection Hc value</span>
<a name="ln-8701"></a>
<a name="ln-8702"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-8703"></a>          <span class="c">! na</span>
<a name="ln-8704"></a>
<a name="ln-8705"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-8706"></a>          <span class="c">! na</span>
<a name="ln-8707"></a>
<a name="ln-8708"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-8709"></a>          <span class="c">! na</span>
<a name="ln-8710"></a>
<a name="ln-8711"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8712"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ErrorIndex</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-8713"></a>
<a name="ln-8714"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Height</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8715"></a><span class="k">    </span><span class="n">Hn</span>  <span class="o">=</span> <span class="p">(</span>  <span class="p">((</span><span class="mf">1.5d0</span> <span class="o">*</span> <span class="p">((</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">)</span><span class="o">/</span><span class="n">Height</span><span class="p">)</span><span class="o">**</span><span class="n">OneFourth</span><span class="p">))</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-8716"></a>           <span class="o">+</span> <span class="p">((</span><span class="mf">1.23d0</span><span class="o">*</span><span class="p">(</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">))</span><span class="o">**</span><span class="n">OneThird</span><span class="p">)</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="p">))</span><span class="o">**</span><span class="n">OneSixth</span>
<a name="ln-8717"></a>  <span class="k">ELSE</span>
<a name="ln-8718"></a><span class="k">    </span><span class="n">Hn</span>  <span class="o">=</span> <span class="mf">9.999d0</span>
<a name="ln-8719"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8720"></a><span class="k">      CALL </span><span class="n">ShowSevereMessage</span><span class="p">(</span><span class="s1">&#39;CalcAlamdariHammondVerticalWall: Convection model not evaluated (would divide by zero)&#39;</span><span class="p">)</span>
<a name="ln-8721"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Effective hydraulic diameter is zero, convection model not applicable for surface =&#39;</span> <span class="p">&amp;</span>
<a name="ln-8722"></a>                              <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">name</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-8723"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Convection surface heat transfer coefficient set to 9.999 [W/m2-K] and the simulation continues&#39;</span><span class="p">)</span>
<a name="ln-8724"></a>    <span class="n">ENDIF</span>
<a name="ln-8725"></a>    <span class="k">CALL </span><span class="n">ShowRecurringSevereErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;CalcAlamdariHammondVerticalWall: Convection model not evaluated because zero&#39;</span> <span class="p">&amp;</span>
<a name="ln-8726"></a>                               <span class="o">//</span><span class="s1">&#39; hydraulic diameter and set to 9.999 [W/m2-K]&#39;</span> <span class="p">,</span> <span class="n">ErrorIndex</span><span class="p">)</span>
<a name="ln-8727"></a>  <span class="n">ENDIF</span>
<a name="ln-8728"></a>
<a name="ln-8729"></a>  <span class="k">RETURN</span>
<a name="ln-8730"></a>
<a name="ln-8731"></a><span class="k">END FUNCTION </span><span class="n">CalcAlamdariHammondVerticalWall</span>
<a name="ln-8732"></a>
<a name="ln-8733"></a><span class="k">FUNCTION </span><span class="n">CalcKhalifaEq3WallAwayFromHeat</span><span class="p">(</span><span class="n">DeltaTemp</span> <span class="p">)</span>  <span class="k">RESULT</span> <span class="p">(</span><span class="n">Hc</span><span class="p">)</span>
<a name="ln-8734"></a>
<a name="ln-8735"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-8736"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-8737"></a>          <span class="c">!       DATE WRITTEN   Jul 2010</span>
<a name="ln-8738"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8739"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8740"></a>
<a name="ln-8741"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-8742"></a>          <span class="c">! Calculate model equation for Khalifa&#39;s Eq 3 for Walls Away From Heat</span>
<a name="ln-8743"></a>
<a name="ln-8744"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8745"></a>          <span class="c">! isolate function for equation.</span>
<a name="ln-8746"></a>
<a name="ln-8747"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8748"></a>          <span class="c">! Khalifa AJN. 1989 Heat transfer processes in buildings. Ph.D. Thesis,</span>
<a name="ln-8749"></a>          <span class="c">!   University of Wales College of Cardiff, Cardiff, UK.</span>
<a name="ln-8750"></a>          <span class="c">!</span>
<a name="ln-8751"></a>          <span class="c">! Equations actually from Beausoleil-Morrison 2000 who referenced Khalifa</span>
<a name="ln-8752"></a>          <span class="c">! Beausoleil-Morrison, I. 2000. The adaptive coupling of heat and</span>
<a name="ln-8753"></a>          <span class="c">!  air flow modeling within dynamic whole-building simulations.</span>
<a name="ln-8754"></a>          <span class="c">!  PhD. Thesis. University of Strathclyde, Glasgow, UK.</span>
<a name="ln-8755"></a>
<a name="ln-8756"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8757"></a>          <span class="c">! na</span>
<a name="ln-8758"></a>
<a name="ln-8759"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8760"></a>
<a name="ln-8761"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-8762"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DeltaTemp</span>         <span class="c">! [C] temperature difference between surface and air</span>
<a name="ln-8763"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">Hc</span> <span class="c">! function result</span>
<a name="ln-8764"></a>
<a name="ln-8765"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-8766"></a>          <span class="c">! na</span>
<a name="ln-8767"></a>
<a name="ln-8768"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-8769"></a>          <span class="c">! na</span>
<a name="ln-8770"></a>
<a name="ln-8771"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-8772"></a>          <span class="c">! na</span>
<a name="ln-8773"></a>
<a name="ln-8774"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8775"></a>
<a name="ln-8776"></a>  <span class="n">Hc</span> <span class="o">=</span> <span class="mf">2.07d0</span><span class="o">*</span><span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">))</span><span class="o">**</span><span class="mf">0.23d0</span><span class="p">)</span>
<a name="ln-8777"></a>
<a name="ln-8778"></a>  <span class="k">RETURN</span>
<a name="ln-8779"></a>
<a name="ln-8780"></a><span class="k">END FUNCTION </span><span class="n">CalcKhalifaEq3WallAwayFromHeat</span>
<a name="ln-8781"></a>
<a name="ln-8782"></a><span class="k">FUNCTION </span><span class="n">CalcKhalifaEq4CeilingAwayFromHeat</span><span class="p">(</span><span class="n">DeltaTemp</span> <span class="p">)</span>  <span class="k">RESULT</span> <span class="p">(</span><span class="n">Hc</span><span class="p">)</span>
<a name="ln-8783"></a>
<a name="ln-8784"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-8785"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-8786"></a>          <span class="c">!       DATE WRITTEN   Jul 2010</span>
<a name="ln-8787"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8788"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8789"></a>
<a name="ln-8790"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-8791"></a>          <span class="c">! Calculate model equation for Khalifa&#39;s Eq 4 for Ceilings Away From Heat</span>
<a name="ln-8792"></a>
<a name="ln-8793"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8794"></a>          <span class="c">! isolate function for equation.</span>
<a name="ln-8795"></a>
<a name="ln-8796"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8797"></a>          <span class="c">! Khalifa AJN. 1989 Heat transfer processes in buildings. Ph.D. Thesis,</span>
<a name="ln-8798"></a>          <span class="c">!   University of Wales College of Cardiff, Cardiff, UK.</span>
<a name="ln-8799"></a>          <span class="c">!</span>
<a name="ln-8800"></a>          <span class="c">! Equations actually from Beausoleil-Morrison 2000 who referenced Khalifa</span>
<a name="ln-8801"></a>          <span class="c">! Beausoleil-Morrison, I. 2000. The adaptive coupling of heat and</span>
<a name="ln-8802"></a>          <span class="c">!  air flow modeling within dynamic whole-building simulations.</span>
<a name="ln-8803"></a>          <span class="c">!  PhD. Thesis. University of Strathclyde, Glasgow, UK.</span>
<a name="ln-8804"></a>
<a name="ln-8805"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8806"></a>          <span class="c">! na</span>
<a name="ln-8807"></a>
<a name="ln-8808"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8809"></a>
<a name="ln-8810"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-8811"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DeltaTemp</span>         <span class="c">! [C] temperature difference between surface and air</span>
<a name="ln-8812"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">Hc</span> <span class="c">! function result</span>
<a name="ln-8813"></a>
<a name="ln-8814"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-8815"></a>          <span class="c">! na</span>
<a name="ln-8816"></a>
<a name="ln-8817"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-8818"></a>          <span class="c">! na</span>
<a name="ln-8819"></a>
<a name="ln-8820"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-8821"></a>          <span class="c">! na</span>
<a name="ln-8822"></a>
<a name="ln-8823"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8824"></a>
<a name="ln-8825"></a>  <span class="n">Hc</span> <span class="o">=</span> <span class="mf">2.72d0</span><span class="o">*</span><span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">))</span><span class="o">**</span><span class="mf">0.13d0</span><span class="p">)</span>
<a name="ln-8826"></a>
<a name="ln-8827"></a>  <span class="k">RETURN</span>
<a name="ln-8828"></a>
<a name="ln-8829"></a><span class="k">END FUNCTION </span><span class="n">CalcKhalifaEq4CeilingAwayFromHeat</span>
<a name="ln-8830"></a>
<a name="ln-8831"></a><span class="k">FUNCTION </span><span class="n">CalcKhalifaEq5WallsNearHeat</span><span class="p">(</span><span class="n">DeltaTemp</span> <span class="p">)</span>  <span class="k">RESULT</span> <span class="p">(</span><span class="n">Hc</span><span class="p">)</span>
<a name="ln-8832"></a>
<a name="ln-8833"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-8834"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-8835"></a>          <span class="c">!       DATE WRITTEN   Jul 2010</span>
<a name="ln-8836"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8837"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8838"></a>
<a name="ln-8839"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-8840"></a>          <span class="c">! Calculate model equation for Khalifa&#39;s Eq 5 for Walls near the heater</span>
<a name="ln-8841"></a>
<a name="ln-8842"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8843"></a>          <span class="c">! isolate function for equation.</span>
<a name="ln-8844"></a>
<a name="ln-8845"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8846"></a>          <span class="c">! Khalifa AJN. 1989 Heat transfer processes in buildings. Ph.D. Thesis,</span>
<a name="ln-8847"></a>          <span class="c">!   University of Wales College of Cardiff, Cardiff, UK.</span>
<a name="ln-8848"></a>          <span class="c">!</span>
<a name="ln-8849"></a>          <span class="c">! Equations actually from Beausoleil-Morrison 2000 who referenced Khalifa</span>
<a name="ln-8850"></a>          <span class="c">! Beausoleil-Morrison, I. 2000. The adaptive coupling of heat and</span>
<a name="ln-8851"></a>          <span class="c">!  air flow modeling within dynamic whole-building simulations.</span>
<a name="ln-8852"></a>          <span class="c">!  PhD. Thesis. University of Strathclyde, Glasgow, UK.</span>
<a name="ln-8853"></a>
<a name="ln-8854"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8855"></a>          <span class="c">! na</span>
<a name="ln-8856"></a>
<a name="ln-8857"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8858"></a>
<a name="ln-8859"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-8860"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DeltaTemp</span>         <span class="c">! [C] temperature difference between surface and air</span>
<a name="ln-8861"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">Hc</span> <span class="c">! function result</span>
<a name="ln-8862"></a>
<a name="ln-8863"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-8864"></a>          <span class="c">! na</span>
<a name="ln-8865"></a>
<a name="ln-8866"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-8867"></a>          <span class="c">! na</span>
<a name="ln-8868"></a>
<a name="ln-8869"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-8870"></a>          <span class="c">! na</span>
<a name="ln-8871"></a>
<a name="ln-8872"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8873"></a>
<a name="ln-8874"></a>  <span class="n">Hc</span> <span class="o">=</span> <span class="mf">1.98d0</span><span class="o">*</span><span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">))</span><span class="o">**</span><span class="mf">0.32d0</span><span class="p">)</span>
<a name="ln-8875"></a>
<a name="ln-8876"></a>  <span class="k">RETURN</span>
<a name="ln-8877"></a>
<a name="ln-8878"></a><span class="k">END FUNCTION </span><span class="n">CalcKhalifaEq5WallsNearHeat</span>
<a name="ln-8879"></a>
<a name="ln-8880"></a><span class="k">FUNCTION </span><span class="n">CalcKhalifaEq6NonHeatedWalls</span><span class="p">(</span><span class="n">DeltaTemp</span> <span class="p">)</span>  <span class="k">RESULT</span> <span class="p">(</span><span class="n">Hc</span><span class="p">)</span>
<a name="ln-8881"></a>
<a name="ln-8882"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-8883"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-8884"></a>          <span class="c">!       DATE WRITTEN   Jul 2010</span>
<a name="ln-8885"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8886"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8887"></a>
<a name="ln-8888"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-8889"></a>          <span class="c">! Calculate model equation for Khalifa&#39;s Eq 6 for non-heated walls</span>
<a name="ln-8890"></a>
<a name="ln-8891"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8892"></a>          <span class="c">! isolate function for equation.</span>
<a name="ln-8893"></a>
<a name="ln-8894"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8895"></a>          <span class="c">! Khalifa AJN. 1989 Heat transfer processes in buildings. Ph.D. Thesis,</span>
<a name="ln-8896"></a>          <span class="c">!   University of Wales College of Cardiff, Cardiff, UK.</span>
<a name="ln-8897"></a>          <span class="c">!</span>
<a name="ln-8898"></a>          <span class="c">! Equations actually from Beausoleil-Morrison 2000 who referenced Khalifa</span>
<a name="ln-8899"></a>          <span class="c">! Beausoleil-Morrison, I. 2000. The adaptive coupling of heat and</span>
<a name="ln-8900"></a>          <span class="c">!  air flow modeling within dynamic whole-building simulations.</span>
<a name="ln-8901"></a>          <span class="c">!  PhD. Thesis. University of Strathclyde, Glasgow, UK.</span>
<a name="ln-8902"></a>
<a name="ln-8903"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8904"></a>          <span class="c">! na</span>
<a name="ln-8905"></a>
<a name="ln-8906"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8907"></a>
<a name="ln-8908"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-8909"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DeltaTemp</span>         <span class="c">! [C] temperature difference between surface and air</span>
<a name="ln-8910"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">Hc</span> <span class="c">! function result</span>
<a name="ln-8911"></a>
<a name="ln-8912"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-8913"></a>          <span class="c">! na</span>
<a name="ln-8914"></a>
<a name="ln-8915"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-8916"></a>          <span class="c">! na</span>
<a name="ln-8917"></a>
<a name="ln-8918"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-8919"></a>          <span class="c">! na</span>
<a name="ln-8920"></a>
<a name="ln-8921"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8922"></a>
<a name="ln-8923"></a>  <span class="n">Hc</span> <span class="o">=</span> <span class="mf">2.30d0</span><span class="o">*</span><span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">))</span><span class="o">**</span><span class="mf">0.24d0</span><span class="p">)</span>
<a name="ln-8924"></a>
<a name="ln-8925"></a>  <span class="k">RETURN</span>
<a name="ln-8926"></a>
<a name="ln-8927"></a><span class="k">END FUNCTION </span><span class="n">CalcKhalifaEq6NonHeatedWalls</span>
<a name="ln-8928"></a>
<a name="ln-8929"></a><span class="k">FUNCTION </span><span class="n">CalcKhalifaEq7Ceiling</span><span class="p">(</span><span class="n">DeltaTemp</span> <span class="p">)</span>  <span class="k">RESULT</span> <span class="p">(</span><span class="n">Hc</span><span class="p">)</span>
<a name="ln-8930"></a>
<a name="ln-8931"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-8932"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-8933"></a>          <span class="c">!       DATE WRITTEN   Jul 2010</span>
<a name="ln-8934"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8935"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8936"></a>
<a name="ln-8937"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-8938"></a>          <span class="c">! Calculate model equation for Khalifa&#39;s Eq 7 for ceilings</span>
<a name="ln-8939"></a>
<a name="ln-8940"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8941"></a>          <span class="c">! isolate function for equation.</span>
<a name="ln-8942"></a>
<a name="ln-8943"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8944"></a>          <span class="c">! Khalifa AJN. 1989 Heat transfer processes in buildings. Ph.D. Thesis,</span>
<a name="ln-8945"></a>          <span class="c">!   University of Wales College of Cardiff, Cardiff, UK.</span>
<a name="ln-8946"></a>          <span class="c">!</span>
<a name="ln-8947"></a>          <span class="c">! Equations actually from Beausoleil-Morrison 2000 who referenced Khalifa</span>
<a name="ln-8948"></a>          <span class="c">! Beausoleil-Morrison, I. 2000. The adaptive coupling of heat and</span>
<a name="ln-8949"></a>          <span class="c">!  air flow modeling within dynamic whole-building simulations.</span>
<a name="ln-8950"></a>          <span class="c">!  PhD. Thesis. University of Strathclyde, Glasgow, UK.</span>
<a name="ln-8951"></a>
<a name="ln-8952"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8953"></a>          <span class="c">! na</span>
<a name="ln-8954"></a>
<a name="ln-8955"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8956"></a>
<a name="ln-8957"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-8958"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DeltaTemp</span>         <span class="c">! [C] temperature difference between surface and air</span>
<a name="ln-8959"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">Hc</span> <span class="c">! function result</span>
<a name="ln-8960"></a>
<a name="ln-8961"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-8962"></a>          <span class="c">! na</span>
<a name="ln-8963"></a>
<a name="ln-8964"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-8965"></a>          <span class="c">! na</span>
<a name="ln-8966"></a>
<a name="ln-8967"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-8968"></a>          <span class="c">! na</span>
<a name="ln-8969"></a>
<a name="ln-8970"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8971"></a>
<a name="ln-8972"></a>  <span class="n">Hc</span> <span class="o">=</span> <span class="mf">3.10d0</span><span class="o">*</span><span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">))</span><span class="o">**</span><span class="mf">0.17d0</span><span class="p">)</span>
<a name="ln-8973"></a>
<a name="ln-8974"></a>  <span class="k">RETURN</span>
<a name="ln-8975"></a>
<a name="ln-8976"></a><span class="k">END FUNCTION </span><span class="n">CalcKhalifaEq7Ceiling</span>
<a name="ln-8977"></a>
<a name="ln-8978"></a><span class="k">FUNCTION </span><span class="n">CalcAwbiHattonHeatedFloor</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">,</span> <span class="n">HydraulicDiameter</span><span class="p">)</span>  <span class="k">RESULT</span> <span class="p">(</span><span class="n">Hc</span><span class="p">)</span>
<a name="ln-8979"></a>
<a name="ln-8980"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-8981"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-8982"></a>          <span class="c">!       DATE WRITTEN   Jul 2010</span>
<a name="ln-8983"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8984"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8985"></a>
<a name="ln-8986"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-8987"></a>          <span class="c">! Calculate model equation for Awbi and Hatton for heated floors</span>
<a name="ln-8988"></a>
<a name="ln-8989"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8990"></a>          <span class="c">! isolate function for equation.</span>
<a name="ln-8991"></a>          <span class="c">! apply numerical protection for low values of hydraulic diameter</span>
<a name="ln-8992"></a>
<a name="ln-8993"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8994"></a>          <span class="c">! Awbi, H.B. and A. Hatton. 1999. Natural convection from heated room surfaces.</span>
<a name="ln-8995"></a>          <span class="c">!   Energy and Buildings 30 (1999) 233-244.</span>
<a name="ln-8996"></a>          <span class="c">!   This function is for equation 15 in the reference</span>
<a name="ln-8997"></a>
<a name="ln-8998"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8999"></a>          <span class="c">! na</span>
<a name="ln-9000"></a>
<a name="ln-9001"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9002"></a>
<a name="ln-9003"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-9004"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DeltaTemp</span>         <span class="c">! [C] temperature difference between surface and air</span>
<a name="ln-9005"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HydraulicDiameter</span> <span class="c">! [m] characteristic size, = (4 * area) / perimeter</span>
<a name="ln-9006"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">Hc</span> <span class="c">! function result</span>
<a name="ln-9007"></a>
<a name="ln-9008"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-9009"></a>          <span class="c">! na</span>
<a name="ln-9010"></a>
<a name="ln-9011"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-9012"></a>          <span class="c">! na</span>
<a name="ln-9013"></a>
<a name="ln-9014"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-9015"></a>          <span class="c">! na</span>
<a name="ln-9016"></a>
<a name="ln-9017"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9018"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">HydraulicDiameter</span> <span class="o">&gt;</span> <span class="mf">1.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9019"></a><span class="k">    </span><span class="n">Hc</span> <span class="o">=</span> <span class="mf">2.175d0</span><span class="o">*</span><span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">))</span><span class="o">**</span><span class="mf">0.308d0</span><span class="p">)</span><span class="o">/</span> <span class="p">(</span><span class="n">HydraulicDiameter</span><span class="o">**</span><span class="mf">0.076d0</span><span class="p">)</span>
<a name="ln-9020"></a>  <span class="k">ELSE</span>
<a name="ln-9021"></a><span class="k">    </span><span class="n">Hc</span> <span class="o">=</span> <span class="mf">2.175d0</span><span class="o">*</span><span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">))</span><span class="o">**</span><span class="mf">0.308d0</span><span class="p">)</span><span class="o">/</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">**</span><span class="mf">0.076d0</span><span class="p">)</span>
<a name="ln-9022"></a>  <span class="n">ENDIF</span>
<a name="ln-9023"></a>
<a name="ln-9024"></a>  <span class="k">RETURN</span>
<a name="ln-9025"></a>
<a name="ln-9026"></a><span class="k">END FUNCTION </span><span class="n">CalcAwbiHattonHeatedFloor</span>
<a name="ln-9027"></a>
<a name="ln-9028"></a><span class="k">FUNCTION </span><span class="n">CalcAwbiHattonHeatedWall</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">,</span> <span class="n">HydraulicDiameter</span><span class="p">)</span>  <span class="k">RESULT</span> <span class="p">(</span><span class="n">Hc</span><span class="p">)</span>
<a name="ln-9029"></a>
<a name="ln-9030"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-9031"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-9032"></a>          <span class="c">!       DATE WRITTEN   Jul 2010</span>
<a name="ln-9033"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9034"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9035"></a>
<a name="ln-9036"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-9037"></a>          <span class="c">! Calculate model equation for Awbi and Hatton for heated walls</span>
<a name="ln-9038"></a>
<a name="ln-9039"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9040"></a>          <span class="c">! isolate function for equation.</span>
<a name="ln-9041"></a>
<a name="ln-9042"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-9043"></a>          <span class="c">! Awbi, H.B. and A. Hatton. 1999. Natural convection from heated room surfaces.</span>
<a name="ln-9044"></a>          <span class="c">!   Energy and Buildings 30 (1999) 233-244.</span>
<a name="ln-9045"></a>          <span class="c">!   This function is for equation 12 in the reference</span>
<a name="ln-9046"></a>
<a name="ln-9047"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9048"></a>          <span class="c">! na</span>
<a name="ln-9049"></a>
<a name="ln-9050"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9051"></a>
<a name="ln-9052"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-9053"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DeltaTemp</span>         <span class="c">! [C] temperature difference between surface and air</span>
<a name="ln-9054"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HydraulicDiameter</span> <span class="c">! [m] characteristic size, = (4 * area) / perimeter</span>
<a name="ln-9055"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">Hc</span> <span class="c">! function result</span>
<a name="ln-9056"></a>
<a name="ln-9057"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-9058"></a>          <span class="c">! na</span>
<a name="ln-9059"></a>
<a name="ln-9060"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-9061"></a>          <span class="c">! na</span>
<a name="ln-9062"></a>
<a name="ln-9063"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-9064"></a>          <span class="c">! na</span>
<a name="ln-9065"></a>
<a name="ln-9066"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9067"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">HydraulicDiameter</span> <span class="o">&gt;</span> <span class="mf">1.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9068"></a><span class="k">    </span><span class="n">Hc</span> <span class="o">=</span> <span class="mf">1.823d0</span><span class="o">*</span><span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">))</span><span class="o">**</span><span class="mf">0.293d0</span><span class="p">)</span><span class="o">/</span> <span class="p">(</span><span class="n">HydraulicDiameter</span><span class="o">**</span><span class="mf">0.121d0</span><span class="p">)</span>
<a name="ln-9069"></a>  <span class="k">ELSE</span>
<a name="ln-9070"></a><span class="k">    </span><span class="n">Hc</span> <span class="o">=</span> <span class="mf">1.823d0</span><span class="o">*</span><span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">))</span><span class="o">**</span><span class="mf">0.293d0</span><span class="p">)</span><span class="o">/</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">**</span><span class="mf">0.121d0</span><span class="p">)</span>
<a name="ln-9071"></a>  <span class="n">ENDIF</span>
<a name="ln-9072"></a>
<a name="ln-9073"></a>  <span class="k">RETURN</span>
<a name="ln-9074"></a>
<a name="ln-9075"></a><span class="k">END FUNCTION </span><span class="n">CalcAwbiHattonHeatedWall</span>
<a name="ln-9076"></a>
<a name="ln-9077"></a><span class="k">FUNCTION </span><span class="n">CalcBeausoleilMorrisonMixedAssistedWall</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">,</span> <span class="n">Height</span><span class="p">,</span> <span class="n">SurfTemp</span><span class="p">,</span> <span class="n">SupplyAirTemp</span><span class="p">,</span> <span class="n">AirChangeRate</span><span class="p">,</span> <span class="n">ZoneNum</span><span class="p">)</span>  <span class="k">RESULT</span> <span class="p">(</span><span class="n">Hc</span><span class="p">)</span>
<a name="ln-9078"></a>
<a name="ln-9079"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-9080"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-9081"></a>          <span class="c">!       DATE WRITTEN   Jul 2010</span>
<a name="ln-9082"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9083"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9084"></a>
<a name="ln-9085"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-9086"></a>          <span class="c">! Calculate model equation Beausoleil-Morrison&#39;s mixed flow regime</span>
<a name="ln-9087"></a>          <span class="c">! with mechanical and bouyancy forces assisting each other along a Wall</span>
<a name="ln-9088"></a>
<a name="ln-9089"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9090"></a>          <span class="c">! isolate function for equation.</span>
<a name="ln-9091"></a>
<a name="ln-9092"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-9093"></a>          <span class="c">! Beausoleil-Morrison, I. 2000. The adaptive coupling of heat and</span>
<a name="ln-9094"></a>          <span class="c">!  air flow modeling within dynamic whole-building simulations.</span>
<a name="ln-9095"></a>          <span class="c">!  PhD. Thesis. University of Strathclyde, Glasgow, UK.</span>
<a name="ln-9096"></a>
<a name="ln-9097"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9098"></a>          <span class="c">! na</span>
<a name="ln-9099"></a>
<a name="ln-9100"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9101"></a>
<a name="ln-9102"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-9103"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DeltaTemp</span>         <span class="c">! [C] temperature difference between surface and air</span>
<a name="ln-9104"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Height</span> <span class="c">! [m] characteristic size</span>
<a name="ln-9105"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfTemp</span> <span class="c">![C] surface temperature</span>
<a name="ln-9106"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SupplyAirTemp</span> <span class="c">![C] temperature of supply air into zone</span>
<a name="ln-9107"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirChangeRate</span> <span class="c">! [ACH] [1/hour] supply air ACH for zone</span>
<a name="ln-9108"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ZoneNum</span>  <span class="c">! index of zone for messaging</span>
<a name="ln-9109"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">Hc</span> <span class="c">! function result</span>
<a name="ln-9110"></a>
<a name="ln-9111"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-9112"></a>          <span class="c">! na</span>
<a name="ln-9113"></a>
<a name="ln-9114"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-9115"></a>          <span class="c">! na</span>
<a name="ln-9116"></a>
<a name="ln-9117"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-9118"></a>          <span class="c">! na</span>
<a name="ln-9119"></a>
<a name="ln-9120"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9121"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ErrorIndex</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-9122"></a>
<a name="ln-9123"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">DeltaTemp</span> <span class="o">/=</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">Height</span> <span class="o">/=</span> <span class="mf">0.d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9124"></a><span class="k">    </span><span class="n">Hc</span> <span class="o">=</span>   <span class="p">(</span>  <span class="p">((</span>  <span class="p">((</span><span class="mf">1.5d0</span> <span class="o">*</span> <span class="p">((</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">)</span><span class="o">/</span><span class="n">Height</span><span class="p">)</span><span class="o">**</span><span class="n">OneFourth</span><span class="p">))</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span>            <span class="p">&amp;</span>
<a name="ln-9125"></a>             <span class="o">+</span> <span class="p">((</span><span class="mf">1.23d0</span><span class="o">*</span><span class="p">(</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">))</span><span class="o">**</span><span class="n">OneThird</span><span class="p">)</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="p">)</span><span class="o">**</span><span class="n">OneSixth</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5d0</span>   <span class="p">&amp;</span>
<a name="ln-9126"></a>             <span class="o">+</span> <span class="p">((</span> <span class="p">((</span><span class="n">SurfTemp</span> <span class="o">-</span>  <span class="n">SupplyAirTemp</span><span class="p">)</span><span class="o">/</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">))</span> <span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">0.199d0</span> <span class="o">+</span> <span class="mf">0.190d0</span><span class="o">*</span><span class="p">(</span><span class="n">AirChangeRate</span><span class="o">**</span><span class="mf">0.8d0</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="p">))</span><span class="o">**</span><span class="n">OneThird</span>
<a name="ln-9127"></a>  <span class="k">ELSE</span>
<a name="ln-9128"></a><span class="k">    </span><span class="n">Hc</span> <span class="o">=</span> <span class="mf">9.999d0</span>
<a name="ln-9129"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Height</span> <span class="o">==</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9130"></a><span class="k">      CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;CalcBeausoleilMorrisonMixedAssistedWall: Convection model not evaluated (would divide by zero)&#39;</span><span class="p">)</span>
<a name="ln-9131"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Effective height is zero, convection model not applicable for zone named =&#39;</span> <span class="p">&amp;</span>
<a name="ln-9132"></a>                                <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-9133"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Convection surface heat transfer coefficient set to 9.999 [W/m2-K] and the simulation continues&#39;</span><span class="p">)</span>
<a name="ln-9134"></a>    <span class="n">ENDIF</span>
<a name="ln-9135"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">==</span> <span class="mf">0.d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmUpFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9136"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">ErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9137"></a><span class="k">        CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;CalcBeausoleilMorrisonMixedAssistedWall: Convection model not evaluated (would divide by zero)&#39;</span><span class="p">)</span>
<a name="ln-9138"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The temperature difference between surface and air is zero&#39;</span><span class="p">)</span>
<a name="ln-9139"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs for zone named = &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-9140"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Convection surface heat transfer coefficient set to 9.999 [W/m2-K] and the simulation continues&#39;</span><span class="p">)</span>
<a name="ln-9141"></a>      <span class="n">ENDIF</span>
<a name="ln-9142"></a>
<a name="ln-9143"></a>      <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;CalcBeausoleilMorrisonMixedAssistedWall: Convection model not evaluated because&#39;</span> <span class="p">&amp;</span>
<a name="ln-9144"></a>                  <span class="o">//</span><span class="s1">&#39; of zero temperature difference and set to 9.999 [W/m2-K]&#39;</span><span class="p">,</span>  <span class="n">ErrorIndex</span> <span class="p">)</span>
<a name="ln-9145"></a>    <span class="n">ENDIF</span>
<a name="ln-9146"></a>
<a name="ln-9147"></a>  <span class="n">ENDIF</span>
<a name="ln-9148"></a>  <span class="k">RETURN</span>
<a name="ln-9149"></a>
<a name="ln-9150"></a><span class="k">END FUNCTION </span><span class="n">CalcBeausoleilMorrisonMixedAssistedWall</span>
<a name="ln-9151"></a>
<a name="ln-9152"></a><span class="k">FUNCTION </span><span class="n">CalcBeausoleilMorrisonMixedOpposingWall</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">,</span> <span class="n">Height</span><span class="p">,</span> <span class="n">SurfTemp</span><span class="p">,</span> <span class="n">SupplyAirTemp</span><span class="p">,</span> <span class="n">AirChangeRate</span><span class="p">,</span> <span class="n">ZoneNum</span><span class="p">)</span>  <span class="k">RESULT</span> <span class="p">(</span><span class="n">Hc</span><span class="p">)</span>
<a name="ln-9153"></a>
<a name="ln-9154"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-9155"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-9156"></a>          <span class="c">!       DATE WRITTEN   Jul 2010</span>
<a name="ln-9157"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9158"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9159"></a>
<a name="ln-9160"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-9161"></a>          <span class="c">! Calculate model equation Beausoleil-Morrison&#39;s mixed flow regime</span>
<a name="ln-9162"></a>          <span class="c">! with mechanical and bouyancy forces opposing each other along a Wall</span>
<a name="ln-9163"></a>
<a name="ln-9164"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9165"></a>          <span class="c">! isolate function for equation.</span>
<a name="ln-9166"></a>
<a name="ln-9167"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-9168"></a>          <span class="c">! Beausoleil-Morrison, I. 2000. The adaptive coupling of heat and</span>
<a name="ln-9169"></a>          <span class="c">!  air flow modeling within dynamic whole-building simulations.</span>
<a name="ln-9170"></a>          <span class="c">!  PhD. Thesis. University of Strathclyde, Glasgow, UK.</span>
<a name="ln-9171"></a>
<a name="ln-9172"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9173"></a>          <span class="c">! na</span>
<a name="ln-9174"></a>
<a name="ln-9175"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9176"></a>
<a name="ln-9177"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-9178"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DeltaTemp</span>         <span class="c">! [C] temperature difference between surface and air</span>
<a name="ln-9179"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Height</span> <span class="c">! [m] characteristic size</span>
<a name="ln-9180"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfTemp</span> <span class="c">![C] surface temperature</span>
<a name="ln-9181"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SupplyAirTemp</span> <span class="c">![C] temperature of supply air into zone</span>
<a name="ln-9182"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirChangeRate</span> <span class="c">! [ACH] [1/hour] supply air ACH for zone</span>
<a name="ln-9183"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ZoneNum</span>  <span class="c">! index of zone for messaging</span>
<a name="ln-9184"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">Hc</span> <span class="c">! function result</span>
<a name="ln-9185"></a>
<a name="ln-9186"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-9187"></a>          <span class="c">! na</span>
<a name="ln-9188"></a>
<a name="ln-9189"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-9190"></a>          <span class="c">! na</span>
<a name="ln-9191"></a>
<a name="ln-9192"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-9193"></a>          <span class="c">! na</span>
<a name="ln-9194"></a>
<a name="ln-9195"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9196"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HcTmp1</span>
<a name="ln-9197"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HcTmp2</span>
<a name="ln-9198"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HcTmp3</span>
<a name="ln-9199"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ErrorIndex</span>  <span class="o">=</span> <span class="mi">0</span>
<a name="ln-9200"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ErrorIndex2</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-9201"></a>
<a name="ln-9202"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">DeltaTemp</span> <span class="o">/=</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span> <span class="c">! protect divide by zero</span>
<a name="ln-9203"></a>
<a name="ln-9204"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Height</span> <span class="o">/=</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9205"></a><span class="k">      </span><span class="n">HcTmp1</span> <span class="o">=</span>   <span class="p">(</span>  <span class="p">((</span>  <span class="p">((</span><span class="mf">1.5d0</span> <span class="o">*</span> <span class="p">((</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">)</span><span class="o">/</span><span class="n">Height</span><span class="p">)</span><span class="o">**</span><span class="n">OneFourth</span><span class="p">))</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span>            <span class="p">&amp;</span>
<a name="ln-9206"></a>            <span class="o">+</span> <span class="p">((</span><span class="mf">1.23d0</span><span class="o">*</span><span class="p">(</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">))</span><span class="o">**</span><span class="n">OneThird</span><span class="p">)</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="p">)</span><span class="o">**</span><span class="n">OneSixth</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5d0</span>   <span class="p">&amp;</span>
<a name="ln-9207"></a>            <span class="o">-</span> <span class="p">((</span> <span class="p">((</span><span class="n">SurfTemp</span> <span class="o">-</span>  <span class="n">SupplyAirTemp</span><span class="p">)</span><span class="o">/</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">))</span> <span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">0.199d0</span> <span class="o">+</span> <span class="mf">0.190d0</span><span class="o">*</span><span class="p">(</span><span class="n">AirChangeRate</span><span class="o">**</span><span class="mf">0.8d0</span><span class="p">)</span> <span class="p">)</span>  <span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="p">))</span><span class="o">**</span><span class="n">OneThird</span>
<a name="ln-9208"></a>
<a name="ln-9209"></a>      <span class="n">HcTmp2</span> <span class="o">=</span> <span class="mf">0.8d0</span> <span class="o">*</span> <span class="p">((</span>  <span class="p">((</span><span class="mf">1.5d0</span> <span class="o">*</span> <span class="p">((</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">)</span><span class="o">/</span><span class="n">Height</span><span class="p">)</span><span class="o">**</span><span class="n">OneFourth</span><span class="p">))</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span>            <span class="p">&amp;</span>
<a name="ln-9210"></a>                 <span class="o">+</span> <span class="p">((</span><span class="mf">1.23d0</span><span class="o">*</span><span class="p">(</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">))</span><span class="o">**</span><span class="n">OneThird</span><span class="p">)</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="p">))</span><span class="o">**</span><span class="n">OneSixth</span><span class="p">)</span>
<a name="ln-9211"></a>    <span class="k">ELSE</span>
<a name="ln-9212"></a><span class="k">      </span><span class="n">HcTmp1</span> <span class="o">=</span> <span class="mf">9.999d0</span>
<a name="ln-9213"></a>      <span class="n">HcTmp2</span> <span class="o">=</span> <span class="mf">9.999d0</span>
<a name="ln-9214"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorIndex2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9215"></a><span class="k">        CALL </span><span class="n">ShowSevereMessage</span><span class="p">(</span><span class="s1">&#39;CalcBeausoleilMorrisonMixedOpposingWall: Convection model not evaluated (would divide by zero)&#39;</span><span class="p">)</span>
<a name="ln-9216"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Effective height is zero, convection model not applicable for zone named =&#39;</span> <span class="p">&amp;</span>
<a name="ln-9217"></a>                                <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-9218"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Convection surface heat transfer coefficient set to 9.999 [W/m2-K] and the simulation continues&#39;</span><span class="p">)</span>
<a name="ln-9219"></a>
<a name="ln-9220"></a>      <span class="n">ENDIF</span>
<a name="ln-9221"></a>      <span class="k">CALL </span><span class="n">ShowRecurringSevereErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;CalcBeausoleilMorrisonMixedOpposingWall: Convection model not evaluated because &#39;</span> <span class="p">&amp;</span>
<a name="ln-9222"></a>                               <span class="o">//</span><span class="s1">&#39; of zero height and set to 9.999 [W/m2-K]&#39;</span><span class="p">,</span> <span class="n">ErrorIndex2</span> <span class="p">)</span>
<a name="ln-9223"></a>
<a name="ln-9224"></a>    <span class="n">ENDIF</span>
<a name="ln-9225"></a>    <span class="n">HcTmp3</span> <span class="o">=</span> <span class="mf">0.8d0</span> <span class="o">*</span>  <span class="p">((</span><span class="n">SurfTemp</span> <span class="o">-</span>  <span class="n">SupplyAirTemp</span><span class="p">)</span><span class="o">/</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">))</span> <span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">0.199d0</span> <span class="o">+</span> <span class="mf">0.190d0</span><span class="o">*</span><span class="p">(</span><span class="n">AirChangeRate</span><span class="o">**</span><span class="mf">0.8d0</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-9226"></a>
<a name="ln-9227"></a>    <span class="n">Hc</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">HcTmp1</span><span class="p">,</span><span class="n">HcTmp2</span><span class="p">),</span> <span class="n">HcTmp3</span><span class="p">)</span>
<a name="ln-9228"></a>
<a name="ln-9229"></a>  <span class="k">ELSE</span>
<a name="ln-9230"></a><span class="k">    </span><span class="n">Hc</span> <span class="o">=</span> <span class="mf">9.999d0</span>
<a name="ln-9231"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmUpFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9232"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">ErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-9233"></a><span class="k">        CALL </span><span class="n">ShowSevereMessage</span><span class="p">(</span><span class="s1">&#39;CalcBeausoleilMorrisonMixedOpposingWall: Convection model not evaluated (would divide by zero)&#39;</span><span class="p">)</span>
<a name="ln-9234"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The temperature difference between surface and air is zero&#39;</span><span class="p">)</span>
<a name="ln-9235"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs for zone named = &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-9236"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Convection surface heat transfer coefficient set to 9.999 [W/m2-K] and the simulation continues&#39;</span><span class="p">)</span>
<a name="ln-9237"></a>      <span class="n">ENDIF</span>
<a name="ln-9238"></a>      <span class="k">CALL </span><span class="n">ShowRecurringSevereErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;CalcBeausoleilMorrisonMixedOpposingWall: Convection model not evaluated because &#39;</span> <span class="p">&amp;</span>
<a name="ln-9239"></a>                  <span class="o">//</span><span class="s1">&#39;of zero temperature difference and set to 9.999 [W/m2-K]&#39;</span><span class="p">,</span>  <span class="n">ErrorIndex</span> <span class="p">)</span>
<a name="ln-9240"></a>    <span class="n">ENDIF</span>
<a name="ln-9241"></a>  <span class="n">ENDIF</span>
<a name="ln-9242"></a>
<a name="ln-9243"></a>  <span class="k">RETURN</span>
<a name="ln-9244"></a>
<a name="ln-9245"></a><span class="k">END FUNCTION </span><span class="n">CalcBeausoleilMorrisonMixedOpposingWall</span>
<a name="ln-9246"></a>
<a name="ln-9247"></a><span class="k">FUNCTION </span><span class="n">CalcBeausoleilMorrisonMixedStableFloor</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">,</span> <span class="n">HydraulicDiameter</span><span class="p">,</span> <span class="n">SurfTemp</span><span class="p">,</span> <span class="n">SupplyAirTemp</span><span class="p">,</span> <span class="n">AirChangeRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9248"></a>                                <span class="n">ZoneNum</span><span class="p">)</span>  <span class="k">RESULT</span> <span class="p">(</span><span class="n">Hc</span><span class="p">)</span>
<a name="ln-9249"></a>
<a name="ln-9250"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-9251"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-9252"></a>          <span class="c">!       DATE WRITTEN   Jul 2010</span>
<a name="ln-9253"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9254"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9255"></a>
<a name="ln-9256"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-9257"></a>          <span class="c">! Calculate model equation Beausoleil-Morrison&#39;s mixed flow regime</span>
<a name="ln-9258"></a>          <span class="c">! with mechanical and bouyancy forces acting on an thermally stable floor</span>
<a name="ln-9259"></a>
<a name="ln-9260"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9261"></a>          <span class="c">! isolate function for equation.</span>
<a name="ln-9262"></a>
<a name="ln-9263"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-9264"></a>          <span class="c">! Beausoleil-Morrison, I. 2000. The adaptive coupling of heat and</span>
<a name="ln-9265"></a>          <span class="c">!  air flow modeling within dynamic whole-building simulations.</span>
<a name="ln-9266"></a>          <span class="c">!  PhD. Thesis. University of Strathclyde, Glasgow, UK.</span>
<a name="ln-9267"></a>
<a name="ln-9268"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9269"></a>          <span class="c">! na</span>
<a name="ln-9270"></a>
<a name="ln-9271"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9272"></a>
<a name="ln-9273"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-9274"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DeltaTemp</span>         <span class="c">! [C] temperature difference between surface and air</span>
<a name="ln-9275"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HydraulicDiameter</span> <span class="c">! [m] characteristic size, = (4 * area) / perimeter</span>
<a name="ln-9276"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfTemp</span> <span class="c">![C] surface temperature</span>
<a name="ln-9277"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SupplyAirTemp</span> <span class="c">![C] temperature of supply air into zone</span>
<a name="ln-9278"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirChangeRate</span> <span class="c">! [ACH] [1/hour] supply air ACH for zone</span>
<a name="ln-9279"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ZoneNum</span>  <span class="c">! index of zone for messaging</span>
<a name="ln-9280"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">Hc</span> <span class="c">! function result</span>
<a name="ln-9281"></a>
<a name="ln-9282"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-9283"></a>          <span class="c">! na</span>
<a name="ln-9284"></a>
<a name="ln-9285"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-9286"></a>          <span class="c">! na</span>
<a name="ln-9287"></a>
<a name="ln-9288"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-9289"></a>          <span class="c">! na</span>
<a name="ln-9290"></a>
<a name="ln-9291"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9292"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ErrorIndex</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-9293"></a>
<a name="ln-9294"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">HydraulicDiameter</span> <span class="o">/=</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">/=</span> <span class="mf">0.d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9295"></a><span class="k">    </span><span class="n">Hc</span> <span class="o">=</span> <span class="p">(</span> <span class="p">(</span><span class="mf">0.6d0</span> <span class="o">*</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">)</span><span class="o">/</span><span class="n">HydraulicDiameter</span><span class="p">)</span><span class="o">**</span><span class="n">OneFifth</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span>  <span class="p">&amp;</span>
<a name="ln-9296"></a>        <span class="o">+</span> <span class="p">(((</span><span class="n">SurfTemp</span> <span class="o">-</span>  <span class="n">SupplyAirTemp</span> <span class="p">)</span><span class="o">/</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">))</span><span class="o">*</span> <span class="p">(</span><span class="mf">0.159d0</span> <span class="o">+</span> <span class="mf">0.116d0</span><span class="o">*</span> <span class="p">(</span><span class="n">AirChangeRate</span> <span class="o">**</span><span class="mf">0.8d0</span><span class="p">))</span> <span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="p">)</span><span class="o">**</span><span class="n">OneThird</span>
<a name="ln-9297"></a>  <span class="k">ELSE</span>
<a name="ln-9298"></a><span class="k">    </span><span class="n">Hc</span> <span class="o">=</span> <span class="mf">9.999d0</span>
<a name="ln-9299"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">HydraulicDiameter</span> <span class="o">==</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9300"></a><span class="k">      CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;CalcBeausoleilMorrisonMixedStableFloor: Convection model not evaluated (would divide by zero)&#39;</span><span class="p">)</span>
<a name="ln-9301"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Effective hydraulic diameter is zero, convection model not applicable for zone named =&#39;</span> <span class="p">&amp;</span>
<a name="ln-9302"></a>                                <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-9303"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Convection surface heat transfer coefficient set to 9.999 [W/m2-K] and the simulation continues&#39;</span><span class="p">)</span>
<a name="ln-9304"></a>    <span class="n">ENDIF</span>
<a name="ln-9305"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">==</span> <span class="mf">0.d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmUpFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9306"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">ErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9307"></a><span class="k">        CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;CalcBeausoleilMorrisonMixedStableFloor: Convection model not evaluated (would divide by zero)&#39;</span><span class="p">)</span>
<a name="ln-9308"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The temperature difference between surface and air is zero&#39;</span><span class="p">)</span>
<a name="ln-9309"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs for zone named = &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-9310"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Convection surface heat transfer coefficient set to 9.999 [W/m2-K] and the simulation continues&#39;</span><span class="p">)</span>
<a name="ln-9311"></a>      <span class="n">ENDIF</span>
<a name="ln-9312"></a>
<a name="ln-9313"></a>      <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;CalcBeausoleilMorrisonMixedStableFloor: Convection model not evaluated because&#39;</span> <span class="p">&amp;</span>
<a name="ln-9314"></a>                  <span class="o">//</span><span class="s1">&#39; of zero temperature difference and set to 9.999 [W/m2-K]&#39;</span><span class="p">,</span>  <span class="n">ErrorIndex</span> <span class="p">)</span>
<a name="ln-9315"></a>    <span class="n">ENDIF</span>
<a name="ln-9316"></a>
<a name="ln-9317"></a>  <span class="n">ENDIF</span>
<a name="ln-9318"></a>  <span class="k">RETURN</span>
<a name="ln-9319"></a>
<a name="ln-9320"></a><span class="k">END FUNCTION </span><span class="n">CalcBeausoleilMorrisonMixedStableFloor</span>
<a name="ln-9321"></a>
<a name="ln-9322"></a><span class="k">FUNCTION </span><span class="n">CalcBeausoleilMorrisonMixedUnstableFloor</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">,</span> <span class="n">HydraulicDiameter</span><span class="p">,</span> <span class="n">SurfTemp</span><span class="p">,</span> <span class="n">SupplyAirTemp</span><span class="p">,</span> <span class="n">AirChangeRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9323"></a>                                                  <span class="n">ZoneNum</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Hc</span><span class="p">)</span>
<a name="ln-9324"></a>
<a name="ln-9325"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-9326"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-9327"></a>          <span class="c">!       DATE WRITTEN   Jul 2010</span>
<a name="ln-9328"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9329"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9330"></a>
<a name="ln-9331"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-9332"></a>          <span class="c">! Calculate model equation Beausoleil-Morrison&#39;s mixed flow regime</span>
<a name="ln-9333"></a>          <span class="c">! with mechanical and bouyancy forces acting on an thermally unstable floor</span>
<a name="ln-9334"></a>
<a name="ln-9335"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9336"></a>          <span class="c">! isolate function for equation.</span>
<a name="ln-9337"></a>
<a name="ln-9338"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-9339"></a>          <span class="c">! Beausoleil-Morrison, I. 2000. The adaptive coupling of heat and</span>
<a name="ln-9340"></a>          <span class="c">!  air flow modeling within dynamic whole-building simulations.</span>
<a name="ln-9341"></a>          <span class="c">!  PhD. Thesis. University of Strathclyde, Glasgow, UK.</span>
<a name="ln-9342"></a>
<a name="ln-9343"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9344"></a>          <span class="c">! na</span>
<a name="ln-9345"></a>
<a name="ln-9346"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9347"></a>
<a name="ln-9348"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-9349"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DeltaTemp</span>         <span class="c">! [C] temperature difference between surface and air</span>
<a name="ln-9350"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HydraulicDiameter</span> <span class="c">! [m] characteristic size, = (4 * area) / perimeter</span>
<a name="ln-9351"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfTemp</span> <span class="c">![C] surface temperature</span>
<a name="ln-9352"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SupplyAirTemp</span> <span class="c">![C] temperature of supply air into zone</span>
<a name="ln-9353"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirChangeRate</span> <span class="c">! [ACH] [1/hour] supply air ACH for zone</span>
<a name="ln-9354"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ZoneNum</span>  <span class="c">! index of zone for messaging</span>
<a name="ln-9355"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">Hc</span> <span class="c">! function result, total convection coefficient</span>
<a name="ln-9356"></a>
<a name="ln-9357"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-9358"></a>          <span class="c">! na</span>
<a name="ln-9359"></a>
<a name="ln-9360"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-9361"></a>          <span class="c">! na</span>
<a name="ln-9362"></a>
<a name="ln-9363"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-9364"></a>          <span class="c">! na</span>
<a name="ln-9365"></a>
<a name="ln-9366"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9367"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ErrorIndex</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-9368"></a>
<a name="ln-9369"></a>
<a name="ln-9370"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">HydraulicDiameter</span> <span class="o">/=</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">/=</span> <span class="mf">0.d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9371"></a><span class="k">    </span><span class="n">Hc</span> <span class="o">=</span> <span class="p">(</span> <span class="p">((</span><span class="mf">1.4d0</span> <span class="o">*</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">)</span><span class="o">/</span><span class="n">HydraulicDiameter</span><span class="p">)</span><span class="o">**</span><span class="n">OneFourth</span><span class="p">)</span><span class="o">**</span><span class="mi">6</span> <span class="o">+</span> <span class="p">(</span> <span class="mf">1.63d0</span><span class="o">*</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">)</span><span class="o">**</span><span class="n">OneThird</span><span class="p">))</span><span class="o">**</span><span class="mi">6</span> <span class="p">)</span><span class="o">**</span><span class="mf">0.5d0</span> <span class="p">&amp;</span>
<a name="ln-9372"></a>        <span class="o">+</span> <span class="p">(((</span><span class="n">SurfTemp</span> <span class="o">-</span>  <span class="n">SupplyAirTemp</span> <span class="p">)</span><span class="o">/</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">))</span><span class="o">*</span> <span class="p">(</span><span class="mf">0.159d0</span> <span class="o">+</span> <span class="mf">0.116d0</span><span class="o">*</span> <span class="p">(</span><span class="n">AirChangeRate</span> <span class="o">**</span><span class="mf">0.8d0</span><span class="p">))</span> <span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="p">)</span><span class="o">**</span><span class="n">OneThird</span>
<a name="ln-9373"></a>  <span class="k">ELSE</span>
<a name="ln-9374"></a><span class="k">    </span><span class="n">Hc</span> <span class="o">=</span> <span class="mf">9.999d0</span>
<a name="ln-9375"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">HydraulicDiameter</span> <span class="o">==</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9376"></a><span class="k">      CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;CalcBeausoleilMorrisonMixedUnstableFloor: Convection model not evaluated (would divide by zero)&#39;</span><span class="p">)</span>
<a name="ln-9377"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Effective hydraulic diameter is zero, convection model not applicable for zone named =&#39;</span> <span class="p">&amp;</span>
<a name="ln-9378"></a>                                <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-9379"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Convection surface heat transfer coefficient set to 9.999 [W/m2-K] and the simulation continues&#39;</span><span class="p">)</span>
<a name="ln-9380"></a>    <span class="n">ENDIF</span>
<a name="ln-9381"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">==</span> <span class="mf">0.d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmUpFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9382"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">ErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9383"></a><span class="k">        CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;CalcBeausoleilMorrisonMixedUnstableFloor: Convection model not evaluated (would divide by zero)&#39;</span><span class="p">)</span>
<a name="ln-9384"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The temperature difference between surface and air is zero&#39;</span><span class="p">)</span>
<a name="ln-9385"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs for zone named = &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-9386"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Convection surface heat transfer coefficient set to 9.999 [W/m2-K] and the simulation continues&#39;</span><span class="p">)</span>
<a name="ln-9387"></a>      <span class="n">ENDIF</span>
<a name="ln-9388"></a>
<a name="ln-9389"></a>      <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;CalcBeausoleilMorrisonMixedUnstableFloor: Convection model not evaluated because&#39;</span> <span class="p">&amp;</span>
<a name="ln-9390"></a>                  <span class="o">//</span><span class="s1">&#39; of zero temperature difference and set to 9.999 [W/m2-K]&#39;</span><span class="p">,</span>  <span class="n">ErrorIndex</span> <span class="p">)</span>
<a name="ln-9391"></a>    <span class="n">ENDIF</span>
<a name="ln-9392"></a>
<a name="ln-9393"></a>  <span class="n">ENDIF</span>
<a name="ln-9394"></a>
<a name="ln-9395"></a>  <span class="k">RETURN</span>
<a name="ln-9396"></a>
<a name="ln-9397"></a><span class="k">END FUNCTION </span><span class="n">CalcBeausoleilMorrisonMixedUnstableFloor</span>
<a name="ln-9398"></a>
<a name="ln-9399"></a><span class="k">FUNCTION </span><span class="n">CalcBeausoleilMorrisonMixedStableCeiling</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">,</span> <span class="n">HydraulicDiameter</span><span class="p">,</span> <span class="n">SurfTemp</span><span class="p">,</span> <span class="n">SupplyAirTemp</span><span class="p">,</span> <span class="n">AirChangeRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9400"></a>                                                    <span class="n">ZoneNum</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Hc</span><span class="p">)</span>
<a name="ln-9401"></a>
<a name="ln-9402"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-9403"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-9404"></a>          <span class="c">!       DATE WRITTEN   Jul 2010</span>
<a name="ln-9405"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9406"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9407"></a>
<a name="ln-9408"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-9409"></a>          <span class="c">! Calculate model equation Beausoleil-Morrison&#39;s mixed flow regime</span>
<a name="ln-9410"></a>          <span class="c">! with mechanical and bouyancy forces acting on a thermally stable ceiling</span>
<a name="ln-9411"></a>
<a name="ln-9412"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9413"></a>          <span class="c">! isolate function for equation.</span>
<a name="ln-9414"></a>
<a name="ln-9415"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-9416"></a>          <span class="c">! Beausoleil-Morrison, I. 2000. The adaptive coupling of heat and</span>
<a name="ln-9417"></a>          <span class="c">!  air flow modeling within dynamic whole-building simulations.</span>
<a name="ln-9418"></a>          <span class="c">!  PhD. Thesis. University of Strathclyde, Glasgow, UK.</span>
<a name="ln-9419"></a>
<a name="ln-9420"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9421"></a>          <span class="c">! na</span>
<a name="ln-9422"></a>
<a name="ln-9423"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9424"></a>
<a name="ln-9425"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-9426"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DeltaTemp</span>         <span class="c">! [C] temperature difference between surface and air</span>
<a name="ln-9427"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HydraulicDiameter</span> <span class="c">! [m] characteristic size, = (4 * area) / perimeter</span>
<a name="ln-9428"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfTemp</span> <span class="c">![C] surface temperature</span>
<a name="ln-9429"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SupplyAirTemp</span> <span class="c">![C] temperature of supply air into zone</span>
<a name="ln-9430"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirChangeRate</span> <span class="c">! [ACH] [1/hour] supply air ACH for zone</span>
<a name="ln-9431"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ZoneNum</span>  <span class="c">! index of zone for messaging</span>
<a name="ln-9432"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">Hc</span> <span class="c">! function result, total convection coefficient</span>
<a name="ln-9433"></a>
<a name="ln-9434"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-9435"></a>          <span class="c">! na</span>
<a name="ln-9436"></a>
<a name="ln-9437"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-9438"></a>          <span class="c">! na</span>
<a name="ln-9439"></a>
<a name="ln-9440"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-9441"></a>          <span class="c">! na</span>
<a name="ln-9442"></a>
<a name="ln-9443"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9444"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ErrorIndex</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-9445"></a>
<a name="ln-9446"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">HydraulicDiameter</span> <span class="o">/=</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">/=</span> <span class="mf">0.d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9447"></a><span class="k">    </span><span class="n">Hc</span> <span class="o">=</span> <span class="p">(</span> <span class="p">(</span><span class="mf">0.6d0</span> <span class="o">*</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">)</span><span class="o">/</span><span class="n">HydraulicDiameter</span><span class="p">)</span><span class="o">**</span><span class="n">OneFifth</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="p">&amp;</span>
<a name="ln-9448"></a>           <span class="o">+</span> <span class="p">(</span> <span class="p">((</span><span class="n">SurfTemp</span> <span class="o">-</span>  <span class="n">SupplyAirTemp</span> <span class="p">)</span><span class="o">/</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">))</span><span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.166d0</span> <span class="o">+</span> <span class="mf">0.484d0</span><span class="o">*</span> <span class="p">(</span><span class="n">AirChangeRate</span> <span class="o">**</span><span class="mf">0.8d0</span><span class="p">))</span> <span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="p">)</span><span class="o">**</span><span class="n">OneThird</span>
<a name="ln-9449"></a>  <span class="k">ELSE</span>
<a name="ln-9450"></a><span class="k">    </span><span class="n">Hc</span> <span class="o">=</span> <span class="mf">9.999d0</span>
<a name="ln-9451"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">HydraulicDiameter</span> <span class="o">==</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9452"></a><span class="k">      CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;CalcBeausoleilMorrisonMixedStableCeiling: Convection model not evaluated (would divide by zero)&#39;</span><span class="p">)</span>
<a name="ln-9453"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Effective hydraulic diameter is zero, convection model not applicable for zone named =&#39;</span> <span class="p">&amp;</span>
<a name="ln-9454"></a>                                <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-9455"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Convection surface heat transfer coefficient set to 9.999 [W/m2-K] and the simulation continues&#39;</span><span class="p">)</span>
<a name="ln-9456"></a>    <span class="n">ENDIF</span>
<a name="ln-9457"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">==</span> <span class="mf">0.d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmUpFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9458"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">ErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9459"></a><span class="k">        CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;CalcBeausoleilMorrisonMixedStableCeiling: Convection model not evaluated (would divide by zero)&#39;</span><span class="p">)</span>
<a name="ln-9460"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The temperature difference between surface and air is zero&#39;</span><span class="p">)</span>
<a name="ln-9461"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs for zone named = &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-9462"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Convection surface heat transfer coefficient set to 9.999 [W/m2-K] and the simulation continues&#39;</span><span class="p">)</span>
<a name="ln-9463"></a>      <span class="n">ENDIF</span>
<a name="ln-9464"></a>
<a name="ln-9465"></a>      <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;CalcBeausoleilMorrisonMixedStableCeiling: Convection model not evaluated because&#39;</span> <span class="p">&amp;</span>
<a name="ln-9466"></a>                  <span class="o">//</span><span class="s1">&#39; of zero temperature difference and set to 9.999 [W/m2-K]&#39;</span><span class="p">,</span>  <span class="n">ErrorIndex</span> <span class="p">)</span>
<a name="ln-9467"></a>    <span class="n">ENDIF</span>
<a name="ln-9468"></a>
<a name="ln-9469"></a>  <span class="n">ENDIF</span>
<a name="ln-9470"></a>  <span class="k">RETURN</span>
<a name="ln-9471"></a>
<a name="ln-9472"></a><span class="k">END FUNCTION </span><span class="n">CalcBeausoleilMorrisonMixedStableCeiling</span>
<a name="ln-9473"></a>
<a name="ln-9474"></a><span class="k">FUNCTION </span><span class="n">CalcBeausoleilMorrisonMixedUnstableCeiling</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">,</span> <span class="n">HydraulicDiameter</span><span class="p">,</span> <span class="n">SurfTemp</span><span class="p">,</span> <span class="n">SupplyAirTemp</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-9475"></a>                          <span class="n">AirChangeRate</span><span class="p">,</span> <span class="n">ZoneNum</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Hc</span><span class="p">)</span>
<a name="ln-9476"></a>
<a name="ln-9477"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-9478"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-9479"></a>          <span class="c">!       DATE WRITTEN   Jul 2010</span>
<a name="ln-9480"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9481"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9482"></a>
<a name="ln-9483"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-9484"></a>          <span class="c">! Calculate model equation Beausoleil-Morrison&#39;s mixed flow regime</span>
<a name="ln-9485"></a>          <span class="c">! with mechanical and bouyancy forces acting on a thermally unstable ceiling</span>
<a name="ln-9486"></a>
<a name="ln-9487"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9488"></a>          <span class="c">! isolate function for equation.</span>
<a name="ln-9489"></a>
<a name="ln-9490"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-9491"></a>          <span class="c">! Beausoleil-Morrison, I. 2000. The adaptive coupling of heat and</span>
<a name="ln-9492"></a>          <span class="c">!  air flow modeling within dynamic whole-building simulations.</span>
<a name="ln-9493"></a>          <span class="c">!  PhD. Thesis. University of Strathclyde, Glasgow, UK.</span>
<a name="ln-9494"></a>
<a name="ln-9495"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9496"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">WarmUpFlag</span>
<a name="ln-9497"></a>
<a name="ln-9498"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9499"></a>
<a name="ln-9500"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-9501"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DeltaTemp</span>         <span class="c">! [C] temperature difference between surface and air</span>
<a name="ln-9502"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HydraulicDiameter</span> <span class="c">! [m] characteristic size, = (4 * area) / perimeter</span>
<a name="ln-9503"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfTemp</span> <span class="c">![C] surface temperature</span>
<a name="ln-9504"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SupplyAirTemp</span> <span class="c">![C] temperature of supply air into zone</span>
<a name="ln-9505"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirChangeRate</span> <span class="c">! [ACH] [1/hour] supply air ACH for zone</span>
<a name="ln-9506"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ZoneNum</span>  <span class="c">! index of zone for messaging</span>
<a name="ln-9507"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">Hc</span> <span class="c">! function result, total convection coefficient</span>
<a name="ln-9508"></a>
<a name="ln-9509"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-9510"></a>          <span class="c">! na</span>
<a name="ln-9511"></a>
<a name="ln-9512"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-9513"></a>          <span class="c">! na</span>
<a name="ln-9514"></a>
<a name="ln-9515"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-9516"></a>          <span class="c">! na</span>
<a name="ln-9517"></a>
<a name="ln-9518"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9519"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ErrorIndex</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-9520"></a>
<a name="ln-9521"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">HydraulicDiameter</span> <span class="o">/=</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">/=</span> <span class="mf">0.d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9522"></a><span class="k">    </span><span class="n">Hc</span> <span class="o">=</span>  <span class="p">(</span> <span class="p">((</span><span class="mf">1.4d0</span> <span class="o">*</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">)</span><span class="o">/</span><span class="n">HydraulicDiameter</span><span class="p">)</span><span class="o">**</span><span class="n">OneFourth</span><span class="p">)</span><span class="o">**</span><span class="mi">6</span> <span class="o">+</span> <span class="p">(</span> <span class="mf">1.63d0</span><span class="o">*</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">)</span><span class="o">**</span><span class="n">OneThird</span><span class="p">))</span><span class="o">**</span><span class="mi">6</span> <span class="p">)</span><span class="o">**</span><span class="mf">0.5d0</span> <span class="p">&amp;</span>
<a name="ln-9523"></a>          <span class="o">+</span> <span class="p">(((</span><span class="n">SurfTemp</span> <span class="o">-</span>  <span class="n">SupplyAirTemp</span> <span class="p">)</span><span class="o">/</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">))</span><span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.166d0</span> <span class="o">+</span> <span class="mf">0.484d0</span><span class="o">*</span> <span class="p">(</span><span class="n">AirChangeRate</span> <span class="o">**</span><span class="mf">0.8d0</span><span class="p">))</span> <span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="p">)</span><span class="o">**</span><span class="n">OneThird</span>
<a name="ln-9524"></a>  <span class="k">ELSE</span>
<a name="ln-9525"></a><span class="k">    </span><span class="n">Hc</span> <span class="o">=</span> <span class="mf">9.999d0</span>
<a name="ln-9526"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">HydraulicDiameter</span> <span class="o">==</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9527"></a><span class="k">      CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;CalcBeausoleilMorrisonMixedUnstableCeiling: Convection model not evaluated (would divide by zero)&#39;</span><span class="p">)</span>
<a name="ln-9528"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Effective hydraulic diameter is zero, convection model not applicable for zone named =&#39;</span> <span class="p">&amp;</span>
<a name="ln-9529"></a>                                <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-9530"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Convection surface heat transfer coefficient set to 9.999 [W/m2-K] and the simulation continues&#39;</span><span class="p">)</span>
<a name="ln-9531"></a>    <span class="n">ENDIF</span>
<a name="ln-9532"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">==</span> <span class="mf">0.d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmUpFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9533"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">ErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9534"></a><span class="k">        CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;CalcBeausoleilMorrisonMixedUnstableCeiling: Convection model not evaluated (would divide by zero)&#39;</span><span class="p">)</span>
<a name="ln-9535"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The temperature difference between surface and air is zero&#39;</span><span class="p">)</span>
<a name="ln-9536"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs for zone named = &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-9537"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Convection surface heat transfer coefficient set to 9.999 [W/m2-K] and the simulation continues&#39;</span><span class="p">)</span>
<a name="ln-9538"></a>      <span class="n">ENDIF</span>
<a name="ln-9539"></a>
<a name="ln-9540"></a>      <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;CalcBeausoleilMorrisonMixedUnstableCeiling: Convection model not evaluated because&#39;</span> <span class="p">&amp;</span>
<a name="ln-9541"></a>                  <span class="o">//</span><span class="s1">&#39; of zero temperature difference and set to 9.999 [W/m2-K]&#39;</span><span class="p">,</span>  <span class="n">ErrorIndex</span> <span class="p">)</span>
<a name="ln-9542"></a>    <span class="n">ENDIF</span>
<a name="ln-9543"></a>  <span class="n">ENDIF</span>
<a name="ln-9544"></a>  <span class="k">RETURN</span>
<a name="ln-9545"></a>
<a name="ln-9546"></a><span class="k">END FUNCTION </span><span class="n">CalcBeausoleilMorrisonMixedUnstableCeiling</span>
<a name="ln-9547"></a>
<a name="ln-9548"></a><span class="k">FUNCTION </span><span class="n">CalcFohannoPolidoriVerticalWall</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">,</span> <span class="n">Height</span><span class="p">,</span> <span class="n">SurfTemp</span><span class="p">,</span> <span class="n">QdotConv</span><span class="p">,</span> <span class="n">SurfNum</span><span class="p">)</span>  <span class="k">RESULT</span> <span class="p">(</span><span class="n">Hn</span><span class="p">)</span>
<a name="ln-9549"></a>
<a name="ln-9550"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-9551"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-9552"></a>          <span class="c">!       DATE WRITTEN   Jul 2010</span>
<a name="ln-9553"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9554"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9555"></a>
<a name="ln-9556"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-9557"></a>          <span class="c">! Calculate model equation for natural convection</span>
<a name="ln-9558"></a>
<a name="ln-9559"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9560"></a>          <span class="c">! isolate function for equation.</span>
<a name="ln-9561"></a>
<a name="ln-9562"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-9563"></a>          <span class="c">! Fohanno, S., and G. Polidori. 2006. Modelling of natural convective heat transfer</span>
<a name="ln-9564"></a>          <span class="c">! at an internal surface. Energy and Buildings 38 (2006) 548 - 553</span>
<a name="ln-9565"></a>
<a name="ln-9566"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9567"></a>          <span class="c">! na</span>
<a name="ln-9568"></a>
<a name="ln-9569"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9570"></a>
<a name="ln-9571"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-9572"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DeltaTemp</span>         <span class="c">! [C] temperature difference between surface and air</span>
<a name="ln-9573"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Height</span> <span class="c">! [m] characteristic size, height of zone</span>
<a name="ln-9574"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfTemp</span> <span class="c">![C] surface temperature</span>
<a name="ln-9575"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QdotConv</span> <span class="c">![W/m2] heat flux rate for rayleigh #</span>
<a name="ln-9576"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfNum</span>  <span class="c">! for messages</span>
<a name="ln-9577"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">Hn</span> <span class="c">! function result, natural convection coefficient</span>
<a name="ln-9578"></a>
<a name="ln-9579"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-9580"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">g</span>  <span class="o">=</span> <span class="mf">9.81d0</span>       <span class="c">! gravity constant (m/s**2)</span>
<a name="ln-9581"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">v</span>  <span class="o">=</span> <span class="mi">1</span><span class="mf">5.89d-6</span>   <span class="c">! kinematic viscosity (m**2/s) for air at 300 K</span>
<a name="ln-9582"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">k</span>  <span class="o">=</span> <span class="mf">0.0263d0</span>     <span class="c">! thermal conductivity (W/m K) for air at 300 K</span>
<a name="ln-9583"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Pr</span> <span class="o">=</span> <span class="mf">0.71d0</span>      <span class="c">! Prandtl number for air at ?</span>
<a name="ln-9584"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-9585"></a>          <span class="c">! na</span>
<a name="ln-9586"></a>
<a name="ln-9587"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-9588"></a>          <span class="c">! na</span>
<a name="ln-9589"></a>
<a name="ln-9590"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9591"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RaH</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-9592"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BetaFilm</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-9593"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ErrorIndex</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-9594"></a>
<a name="ln-9595"></a>  <span class="n">BetaFilm</span> <span class="o">=</span> <span class="mf">1.d0</span> <span class="o">/</span> <span class="p">(</span><span class="n">KelvinConv</span> <span class="o">+</span> <span class="n">SurfTemp</span> <span class="o">+</span> <span class="mf">0.5d0</span> <span class="o">*</span> <span class="n">DeltaTemp</span><span class="p">)</span> <span class="c">! TODO check sign on DeltaTemp</span>
<a name="ln-9596"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Height</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9597"></a><span class="k">    </span><span class="n">RaH</span> <span class="o">=</span> <span class="p">(</span><span class="n">g</span> <span class="o">*</span> <span class="n">BetaFilm</span> <span class="o">*</span> <span class="n">QdotConv</span> <span class="o">*</span> <span class="p">(</span><span class="n">Height</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="n">Pr</span> <span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="n">v</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-9598"></a>
<a name="ln-9599"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">RaH</span> <span class="o">&lt;=</span> <span class="mf">6.3d09</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-9600"></a><span class="k">      </span><span class="n">Hn</span> <span class="o">=</span> <span class="mf">1.332d0</span><span class="o">*</span><span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">)</span><span class="o">/</span><span class="n">Height</span><span class="p">)</span><span class="o">**</span><span class="n">OneFourth</span><span class="p">)</span>
<a name="ln-9601"></a>    <span class="k">ELSE</span>
<a name="ln-9602"></a><span class="k">      </span><span class="n">Hn</span> <span class="o">=</span> <span class="mf">1.235d0</span><span class="o">*</span><span class="nb">EXP</span><span class="p">(</span><span class="mf">0.0467d0</span><span class="o">*</span><span class="n">Height</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">))</span><span class="o">**</span><span class="mf">0.316d0</span>
<a name="ln-9603"></a>    <span class="n">ENDIF</span>
<a name="ln-9604"></a>  <span class="k">ELSE</span>
<a name="ln-9605"></a>   <span class="c">! bad value for Height, but we have little info to identify calling culprit</span>
<a name="ln-9606"></a>    <span class="n">Hn</span> <span class="o">=</span> <span class="mf">9.999d0</span>
<a name="ln-9607"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9608"></a><span class="k">      CALL </span><span class="n">ShowSevereMessage</span><span class="p">(</span><span class="s1">&#39;CalcFohannoPolidoriVerticalWall: Convection model not evaluated (would divide by zero)&#39;</span><span class="p">)</span>
<a name="ln-9609"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Effective surface height is zero, convection model not applicable for surface =&#39;</span> <span class="p">&amp;</span>
<a name="ln-9610"></a>                              <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">name</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-9611"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Convection surface heat transfer coefficient set to 9.999 [W/m2-K] and the simulation continues&#39;</span><span class="p">)</span>
<a name="ln-9612"></a>
<a name="ln-9613"></a>    <span class="n">ENDIF</span>
<a name="ln-9614"></a>    <span class="k">CALL </span><span class="n">ShowRecurringSevereErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;CalcFohannoPolidoriVerticalWall: Convection model not evaluated because zero&#39;</span> <span class="p">&amp;</span>
<a name="ln-9615"></a>                               <span class="o">//</span><span class="s1">&#39; height and set to 9.999 [W/m2-K]&#39;</span> <span class="p">,</span> <span class="n">ErrorIndex</span><span class="p">)</span>
<a name="ln-9616"></a>  <span class="n">ENDIF</span>
<a name="ln-9617"></a>
<a name="ln-9618"></a>  <span class="k">RETURN</span>
<a name="ln-9619"></a>
<a name="ln-9620"></a><span class="k">END FUNCTION </span><span class="n">CalcFohannoPolidoriVerticalWall</span>
<a name="ln-9621"></a>
<a name="ln-9622"></a><span class="k">FUNCTION </span><span class="n">CalcKaradagChilledCeiling</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">)</span>  <span class="k">RESULT</span> <span class="p">(</span><span class="n">Hn</span><span class="p">)</span>
<a name="ln-9623"></a>
<a name="ln-9624"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-9625"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-9626"></a>          <span class="c">!       DATE WRITTEN   Jul 2010</span>
<a name="ln-9627"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9628"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9629"></a>
<a name="ln-9630"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-9631"></a>          <span class="c">! Calculate model equation for natural convection developed by Karadag for chilled ceilings</span>
<a name="ln-9632"></a>
<a name="ln-9633"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9634"></a>          <span class="c">! isolate function for equation.</span>
<a name="ln-9635"></a>
<a name="ln-9636"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-9637"></a>          <span class="c">! Karadag, R. 2009. New approach relevant to total heat transfer coefficient</span>
<a name="ln-9638"></a>          <span class="c">!   including the effect of radiation and convection at the ceiling in a cooled</span>
<a name="ln-9639"></a>          <span class="c">!   ceiling room.  Applied Thermal Engineering 29 (2009) 1561-1565</span>
<a name="ln-9640"></a>          <span class="c">!    This function is for equation 8 in the reference</span>
<a name="ln-9641"></a>
<a name="ln-9642"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9643"></a>          <span class="c">! na</span>
<a name="ln-9644"></a>
<a name="ln-9645"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9646"></a>
<a name="ln-9647"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-9648"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DeltaTemp</span>  <span class="c">! [C] temperature difference between surface and air</span>
<a name="ln-9649"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">Hn</span> <span class="c">! function result, natural convection coefficient</span>
<a name="ln-9650"></a>
<a name="ln-9651"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-9652"></a>
<a name="ln-9653"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-9654"></a>          <span class="c">! na</span>
<a name="ln-9655"></a>
<a name="ln-9656"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-9657"></a>          <span class="c">! na</span>
<a name="ln-9658"></a>
<a name="ln-9659"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9660"></a>
<a name="ln-9661"></a>  <span class="n">Hn</span> <span class="o">=</span> <span class="mf">3.1d0</span><span class="o">*</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">))</span><span class="o">**</span><span class="mf">0.22d0</span>
<a name="ln-9662"></a>
<a name="ln-9663"></a>  <span class="k">RETURN</span>
<a name="ln-9664"></a>
<a name="ln-9665"></a><span class="k">END FUNCTION </span><span class="n">CalcKaradagChilledCeiling</span>
<a name="ln-9666"></a>
<a name="ln-9667"></a>
<a name="ln-9668"></a><span class="k">FUNCTION </span><span class="n">CalcGoldsteinNovoselacCeilingDiffuserWindow</span><span class="p">(</span><span class="n">AirSystemFlowRate</span><span class="p">,</span> <span class="n">ZoneExtPerimLength</span><span class="p">,</span> <span class="n">WindWallRatio</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9669"></a>                             <span class="n">WindowLocationType</span> <span class="p">,</span> <span class="n">ZoneNum</span><span class="p">)</span>  <span class="k">RESULT</span> <span class="p">(</span><span class="n">Hc</span><span class="p">)</span>
<a name="ln-9670"></a>
<a name="ln-9671"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-9672"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-9673"></a>          <span class="c">!       DATE WRITTEN   Aug 2010</span>
<a name="ln-9674"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9675"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9676"></a>
<a name="ln-9677"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-9678"></a>          <span class="c">! Calculate model equation for windows in zones with slot diffusers on them</span>
<a name="ln-9679"></a>          <span class="c">!  developed by Novoselac for RP-1416</span>
<a name="ln-9680"></a>
<a name="ln-9681"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9682"></a>          <span class="c">! isolate function for equation.</span>
<a name="ln-9683"></a>
<a name="ln-9684"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-9685"></a>          <span class="c">! Goldstien, K. and A. Novoselac. 2010. Convective Heat Transfer in Rooms</span>
<a name="ln-9686"></a>          <span class="c">!  With Ceiling Slot Diffusers (RP-1416). HVAC&amp;R Research Journal TBD</span>
<a name="ln-9687"></a>
<a name="ln-9688"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9689"></a>          <span class="c">! na</span>
<a name="ln-9690"></a>
<a name="ln-9691"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9692"></a>
<a name="ln-9693"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-9694"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirSystemFlowRate</span>  <span class="c">! [m3/s] air system flow rate</span>
<a name="ln-9695"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ZoneExtPerimLength</span> <span class="c">! [m] length of zone perimeter with exterior walls</span>
<a name="ln-9696"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WindWallRatio</span> <span class="c">![ ] fraction of window area to wall area for zone</span>
<a name="ln-9697"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">WindowLocationType</span> <span class="c">!index for location types</span>
<a name="ln-9698"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">ZoneNum</span> <span class="c">! for messages</span>
<a name="ln-9699"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">Hc</span> <span class="c">! function result, total convection coefficient</span>
<a name="ln-9700"></a>
<a name="ln-9701"></a>
<a name="ln-9702"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-9703"></a>
<a name="ln-9704"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-9705"></a>          <span class="c">! na</span>
<a name="ln-9706"></a>
<a name="ln-9707"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-9708"></a>          <span class="c">! na</span>
<a name="ln-9709"></a>
<a name="ln-9710"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9711"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ErrorIndex</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-9712"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ErrorIndex2</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-9713"></a>
<a name="ln-9714"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneExtPerimLength</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9715"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">WindWallRatio</span> <span class="o">&lt;=</span> <span class="mf">0.5d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9716"></a>
<a name="ln-9717"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">WindowLocationType</span> <span class="o">==</span> <span class="n">InConvWinLoc_UpperPartOfExteriorWall</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9718"></a><span class="k">        </span><span class="n">Hc</span> <span class="o">=</span> <span class="mf">0.117d0</span><span class="o">*</span><span class="p">((</span><span class="n">AirSystemFlowRate</span> <span class="o">/</span> <span class="n">ZoneExtPerimLength</span><span class="p">)</span><span class="o">**</span><span class="mf">0.8d0</span><span class="p">)</span>
<a name="ln-9719"></a>      <span class="n">ELSEIF</span><span class="p">(</span><span class="n">WindowLocationType</span> <span class="o">==</span> <span class="n">InConvWinLoc_LowerPartOfExteriorWall</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9720"></a><span class="k">        </span><span class="n">Hc</span> <span class="o">=</span> <span class="mf">0.093d0</span><span class="o">*</span><span class="p">((</span><span class="n">AirSystemFlowRate</span> <span class="o">/</span> <span class="n">ZoneExtPerimLength</span><span class="p">)</span><span class="o">**</span><span class="mf">0.8d0</span><span class="p">)</span>
<a name="ln-9721"></a>      <span class="n">ELSEIF</span><span class="p">(</span><span class="n">WindowLocationType</span> <span class="o">==</span> <span class="n">InConvWinLoc_LargePartOfExteriorWall</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9722"></a><span class="k">        </span><span class="n">Hc</span> <span class="o">=</span> <span class="mf">0.117d0</span><span class="o">*</span><span class="p">((</span><span class="n">AirSystemFlowRate</span> <span class="o">/</span> <span class="n">ZoneExtPerimLength</span><span class="p">)</span><span class="o">**</span><span class="mf">0.8d0</span><span class="p">)</span> <span class="c">! assumption for case not covered by model</span>
<a name="ln-9723"></a>      <span class="n">ELSEIF</span><span class="p">(</span><span class="n">WindowLocationType</span> <span class="o">==</span> <span class="n">InConvWinLoc_NotSet</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9724"></a><span class="k">        </span><span class="n">Hc</span> <span class="o">=</span> <span class="mf">0.117d0</span><span class="o">*</span><span class="p">((</span><span class="n">AirSystemFlowRate</span> <span class="o">/</span> <span class="n">ZoneExtPerimLength</span><span class="p">)</span><span class="o">**</span><span class="mf">0.8d0</span><span class="p">)</span> <span class="c">! assumption for case not covered by model</span>
<a name="ln-9725"></a>      <span class="k">ELSE</span>
<a name="ln-9726"></a>        <span class="c">!shouldn&#39;tcome</span>
<a name="ln-9727"></a>        <span class="n">Hc</span> <span class="o">=</span> <span class="mf">9.999d0</span>
<a name="ln-9728"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9729"></a><span class="k">          CALL </span><span class="n">ShowSevereMessage</span><span class="p">(</span><span class="s1">&#39;CalcGoldsteinNovoselacCeilingDiffuserWindow: Convection model not evaluated &#39;</span> <span class="p">&amp;</span>
<a name="ln-9730"></a>                                  <span class="o">//</span><span class="s1">&#39;( bad relative window location)&#39;</span><span class="p">)</span>
<a name="ln-9731"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Value for window location = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WindowLocationType</span><span class="p">)))</span>
<a name="ln-9732"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs for zone named = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-9733"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Convection surface heat transfer coefficient set to 9.999 [W/m2-K] and the simulation continues&#39;</span><span class="p">)</span>
<a name="ln-9734"></a>        <span class="n">ENDIF</span>
<a name="ln-9735"></a>        <span class="k">CALL </span><span class="n">ShowRecurringSevereErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;CalcGoldsteinNovoselacCeilingDiffuserWindow: Convection model not evaluated because &#39;</span> <span class="p">&amp;</span>
<a name="ln-9736"></a>                               <span class="o">//</span><span class="s1">&#39;bad window location and set to 9.999 [W/m2-K]&#39;</span><span class="p">,</span> <span class="n">ErrorIndex</span> <span class="p">)</span>
<a name="ln-9737"></a>      <span class="n">ENDIF</span>
<a name="ln-9738"></a>    <span class="k">ELSE</span>
<a name="ln-9739"></a><span class="k">      </span><span class="n">Hc</span> <span class="o">=</span> <span class="mf">0.103d0</span><span class="o">*</span><span class="p">((</span><span class="n">AirSystemFlowRate</span> <span class="o">/</span> <span class="n">ZoneExtPerimLength</span><span class="p">)</span><span class="o">**</span><span class="mf">0.8d0</span><span class="p">)</span>
<a name="ln-9740"></a>    <span class="n">ENDIF</span>
<a name="ln-9741"></a>  <span class="k">ELSE</span>
<a name="ln-9742"></a><span class="k">    </span><span class="n">Hc</span> <span class="o">=</span> <span class="mf">9.999d0</span>
<a name="ln-9743"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorIndex2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9744"></a><span class="k">      CALL </span><span class="n">ShowSevereMessage</span><span class="p">(</span><span class="s1">&#39;CalcGoldsteinNovoselacCeilingDiffuserWindow: Convection model not evaluated &#39;</span> <span class="p">&amp;</span>
<a name="ln-9745"></a>                               <span class="o">//</span><span class="s1">&#39;(zero zone exterior perimeter length)&#39;</span> <span class="p">)</span>
<a name="ln-9746"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Value for zone exterior perimeter length = &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">ZoneExtPerimLength</span><span class="p">,</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-9747"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs for zone named = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-9748"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Convection surface heat transfer coefficient set to 9.999 [W/m2-K] and the simulation continues&#39;</span><span class="p">)</span>
<a name="ln-9749"></a>    <span class="n">ENDIF</span>
<a name="ln-9750"></a>    <span class="k">CALL </span><span class="n">ShowRecurringSevereErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;CalcGoldsteinNovoselacCeilingDiffuserWindow: Convection model not evaluated because &#39;</span> <span class="p">&amp;</span>
<a name="ln-9751"></a>                                <span class="o">//</span><span class="s1">&#39; bad perimeter length and set to 9.999 [W/m2-K]&#39;</span> <span class="p">,</span> <span class="n">ErrorIndex2</span> <span class="p">)</span>
<a name="ln-9752"></a>  <span class="n">ENDIF</span>
<a name="ln-9753"></a>  <span class="k">RETURN</span>
<a name="ln-9754"></a>
<a name="ln-9755"></a><span class="k">END FUNCTION </span><span class="n">CalcGoldsteinNovoselacCeilingDiffuserWindow</span>
<a name="ln-9756"></a>
<a name="ln-9757"></a><span class="k">FUNCTION </span><span class="n">CalcGoldsteinNovoselacCeilingDiffuserWall</span><span class="p">(</span><span class="n">AirSystemFlowRate</span><span class="p">,</span> <span class="n">ZoneExtPerimLength</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9758"></a>                            <span class="n">WindowLocationType</span><span class="p">,</span> <span class="n">ZoneNum</span> <span class="p">)</span>  <span class="k">RESULT</span> <span class="p">(</span><span class="n">Hc</span><span class="p">)</span>
<a name="ln-9759"></a>
<a name="ln-9760"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-9761"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-9762"></a>          <span class="c">!       DATE WRITTEN   Aug 2010</span>
<a name="ln-9763"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9764"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9765"></a>
<a name="ln-9766"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-9767"></a>          <span class="c">! Calculate model equation for exterior walls in zones with slot diffusers on them</span>
<a name="ln-9768"></a>          <span class="c">!  developed by Novoselac for RP-1416</span>
<a name="ln-9769"></a>
<a name="ln-9770"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9771"></a>          <span class="c">! isolate function for equation.</span>
<a name="ln-9772"></a>
<a name="ln-9773"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-9774"></a>          <span class="c">! Goldstien, K. and A. Novoselac. 2010. Convective Heat Transfer in Rooms</span>
<a name="ln-9775"></a>          <span class="c">!  With Ceiling Slot Diffusers (RP-1416). HVAC&amp;R Research Journal TBD</span>
<a name="ln-9776"></a>
<a name="ln-9777"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9778"></a>          <span class="c">! na</span>
<a name="ln-9779"></a>
<a name="ln-9780"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9781"></a>
<a name="ln-9782"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-9783"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirSystemFlowRate</span>  <span class="c">! [m3/s] air system flow rate</span>
<a name="ln-9784"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ZoneExtPerimLength</span> <span class="c">! [m] length of zone perimeter with exterior walls</span>
<a name="ln-9785"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">WindowLocationType</span> <span class="c">!index for location types</span>
<a name="ln-9786"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">ZoneNum</span> <span class="c">! for messages</span>
<a name="ln-9787"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">Hc</span> <span class="c">! function result, total convection coefficient</span>
<a name="ln-9788"></a>
<a name="ln-9789"></a>
<a name="ln-9790"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-9791"></a>
<a name="ln-9792"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-9793"></a>          <span class="c">! na</span>
<a name="ln-9794"></a>
<a name="ln-9795"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-9796"></a>          <span class="c">! na</span>
<a name="ln-9797"></a>
<a name="ln-9798"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9799"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ErrorIndex</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-9800"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ErrorIndex2</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-9801"></a>
<a name="ln-9802"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneExtPerimLength</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9803"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">WindowLocationType</span> <span class="o">==</span> <span class="n">InConvWinLoc_WindowAboveThis</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9804"></a><span class="k">      </span><span class="n">Hc</span> <span class="o">=</span> <span class="mf">0.063d0</span><span class="o">*</span><span class="p">((</span><span class="n">AirSystemFlowRate</span> <span class="o">/</span> <span class="n">ZoneExtPerimLength</span><span class="p">)</span><span class="o">**</span><span class="mf">0.8d0</span><span class="p">)</span>
<a name="ln-9805"></a>    <span class="n">ELSEIF</span><span class="p">(</span><span class="n">WindowLocationType</span> <span class="o">==</span> <span class="n">InConvWinLoc_WindowBelowThis</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9806"></a><span class="k">      </span><span class="n">Hc</span> <span class="o">=</span> <span class="mf">0.093d0</span><span class="o">*</span><span class="p">((</span><span class="n">AirSystemFlowRate</span> <span class="o">/</span> <span class="n">ZoneExtPerimLength</span><span class="p">)</span><span class="o">**</span><span class="mf">0.8d0</span><span class="p">)</span>
<a name="ln-9807"></a>    <span class="n">ELSEIF</span><span class="p">(</span><span class="n">WindowLocationType</span> <span class="o">==</span> <span class="n">InConvWinLoc_NotSet</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9808"></a><span class="k">      </span><span class="n">Hc</span> <span class="o">=</span> <span class="mf">0.063d0</span><span class="o">*</span><span class="p">((</span><span class="n">AirSystemFlowRate</span> <span class="o">/</span> <span class="n">ZoneExtPerimLength</span><span class="p">)</span><span class="o">**</span><span class="mf">0.8d0</span><span class="p">)</span>  <span class="c">! assumption for case not covered by model</span>
<a name="ln-9809"></a>    <span class="k">ELSE</span>
<a name="ln-9810"></a><span class="k">      </span><span class="n">Hc</span> <span class="o">=</span> <span class="mf">9.999d0</span>
<a name="ln-9811"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9812"></a><span class="k">        CALL </span><span class="n">ShowSevereMessage</span><span class="p">(</span><span class="s1">&#39;CalcGoldsteinNovoselacCeilingDiffuserWall: Convection model not evaluated &#39;</span> <span class="p">&amp;</span>
<a name="ln-9813"></a>                                <span class="o">//</span><span class="s1">&#39;( bad relative window location)&#39;</span><span class="p">)</span>
<a name="ln-9814"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Value for window location = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WindowLocationType</span><span class="p">)))</span>
<a name="ln-9815"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs for zone named = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-9816"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Convection surface heat transfer coefficient set to 9.999 [W/m2-K] and the simulation continues&#39;</span><span class="p">)</span>
<a name="ln-9817"></a>      <span class="n">ENDIF</span>
<a name="ln-9818"></a>      <span class="k">CALL </span><span class="n">ShowRecurringSevereErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;CalcGoldsteinNovoselacCeilingDiffuserWall: Convection model not evaluated because &#39;</span> <span class="p">&amp;</span>
<a name="ln-9819"></a>                              <span class="o">//</span><span class="s1">&#39;bad window location and set to 9.999 [W/m2-K]&#39;</span><span class="p">,</span> <span class="n">ErrorIndex</span> <span class="p">)</span>
<a name="ln-9820"></a>
<a name="ln-9821"></a>    <span class="n">ENDIF</span>
<a name="ln-9822"></a>  <span class="k">ELSE</span>
<a name="ln-9823"></a><span class="k">    </span><span class="n">Hc</span> <span class="o">=</span> <span class="mf">9.999d0</span>
<a name="ln-9824"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorIndex2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9825"></a><span class="k">      CALL </span><span class="n">ShowSevereMessage</span><span class="p">(</span><span class="s1">&#39;CalcGoldsteinNovoselacCeilingDiffuserWall: Convection model not evaluated &#39;</span> <span class="p">&amp;</span>
<a name="ln-9826"></a>                               <span class="o">//</span><span class="s1">&#39;(zero zone exterior perimeter length)&#39;</span> <span class="p">)</span>
<a name="ln-9827"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Value for zone exterior perimeter length = &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">ZoneExtPerimLength</span><span class="p">,</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-9828"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs for zone named = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-9829"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Convection surface heat transfer coefficient set to 9.999 [W/m2-K] and the simulation continues&#39;</span><span class="p">)</span>
<a name="ln-9830"></a>    <span class="n">ENDIF</span>
<a name="ln-9831"></a>    <span class="k">CALL </span><span class="n">ShowRecurringSevereErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;CalcGoldsteinNovoselacCeilingDiffuserWall: Convection model not evaluated because &#39;</span> <span class="p">&amp;</span>
<a name="ln-9832"></a>                                <span class="o">//</span><span class="s1">&#39; bad perimeter length and set to 9.999 [W/m2-K]&#39;</span> <span class="p">,</span> <span class="n">ErrorIndex2</span> <span class="p">)</span>
<a name="ln-9833"></a>
<a name="ln-9834"></a>  <span class="n">ENDIF</span>
<a name="ln-9835"></a>  <span class="k">RETURN</span>
<a name="ln-9836"></a>
<a name="ln-9837"></a><span class="k">END FUNCTION </span><span class="n">CalcGoldsteinNovoselacCeilingDiffuserWall</span>
<a name="ln-9838"></a>
<a name="ln-9839"></a><span class="k">FUNCTION </span><span class="n">CalcGoldsteinNovoselacCeilingDiffuserFloor</span><span class="p">(</span><span class="n">AirSystemFlowRate</span><span class="p">,</span> <span class="n">ZoneExtPerimLength</span><span class="p">,</span> <span class="n">ZoneNum</span> <span class="p">)</span>  <span class="k">RESULT</span> <span class="p">(</span><span class="n">Hc</span><span class="p">)</span>
<a name="ln-9840"></a>
<a name="ln-9841"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-9842"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-9843"></a>          <span class="c">!       DATE WRITTEN   Aug 2010</span>
<a name="ln-9844"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9845"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9846"></a>
<a name="ln-9847"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-9848"></a>          <span class="c">! Calculate model equation for floors in zones with slot diffusers on them</span>
<a name="ln-9849"></a>          <span class="c">!  developed by Novoselac for RP-1416</span>
<a name="ln-9850"></a>
<a name="ln-9851"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9852"></a>          <span class="c">! isolate function for equation.</span>
<a name="ln-9853"></a>
<a name="ln-9854"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-9855"></a>          <span class="c">! Goldstien, K. and A. Novoselac. 2010. Convective Heat Transfer in Rooms</span>
<a name="ln-9856"></a>          <span class="c">!  With Ceiling Slot Diffusers (RP-1416). HVAC&amp;R Research Journal TBD</span>
<a name="ln-9857"></a>
<a name="ln-9858"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9859"></a>          <span class="c">! na</span>
<a name="ln-9860"></a>
<a name="ln-9861"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9862"></a>
<a name="ln-9863"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-9864"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirSystemFlowRate</span>  <span class="c">! [m3/s] air system flow rate</span>
<a name="ln-9865"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ZoneExtPerimLength</span> <span class="c">! [m] length of zone perimeter with exterior walls</span>
<a name="ln-9866"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">ZoneNum</span> <span class="c">! for messages</span>
<a name="ln-9867"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">Hc</span> <span class="c">! function result, total convection coefficient</span>
<a name="ln-9868"></a>
<a name="ln-9869"></a>
<a name="ln-9870"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-9871"></a>
<a name="ln-9872"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-9873"></a>          <span class="c">! na</span>
<a name="ln-9874"></a>
<a name="ln-9875"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-9876"></a>          <span class="c">! na</span>
<a name="ln-9877"></a>
<a name="ln-9878"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9879"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ErrorIndex</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-9880"></a>
<a name="ln-9881"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneExtPerimLength</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9882"></a><span class="k">    </span><span class="n">Hc</span> <span class="o">=</span> <span class="mf">0.048d0</span><span class="o">*</span><span class="p">((</span><span class="n">AirSystemFlowRate</span> <span class="o">/</span> <span class="n">ZoneExtPerimLength</span><span class="p">)</span><span class="o">**</span><span class="mf">0.8d0</span><span class="p">)</span>
<a name="ln-9883"></a>  <span class="k">ELSE</span>
<a name="ln-9884"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">ErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9885"></a><span class="k">      CALL </span><span class="n">ShowSevereMessage</span><span class="p">(</span><span class="s1">&#39;CalcGoldsteinNovoselacCeilingDiffuserFloor: Convection model not evaluated &#39;</span> <span class="p">&amp;</span>
<a name="ln-9886"></a>                               <span class="o">//</span><span class="s1">&#39;(zero zone exterior perimeter length)&#39;</span> <span class="p">)</span>
<a name="ln-9887"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Value for zone exterior perimeter length = &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">ZoneExtPerimLength</span><span class="p">,</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-9888"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs for zone named = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-9889"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Convection surface heat transfer coefficient set to 9.999 [W/m2-K] and the simulation continues&#39;</span><span class="p">)</span>
<a name="ln-9890"></a>    <span class="n">ENDIF</span>
<a name="ln-9891"></a>    <span class="k">CALL </span><span class="n">ShowRecurringSevereErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;CalcGoldsteinNovoselacCeilingDiffuserFloor: Convection model not evaluated because &#39;</span> <span class="p">&amp;</span>
<a name="ln-9892"></a>                                <span class="o">//</span><span class="s1">&#39; bad perimeter length and set to 9.999 [W/m2-K]&#39;</span> <span class="p">,</span> <span class="n">ErrorIndex</span> <span class="p">)</span>
<a name="ln-9893"></a>
<a name="ln-9894"></a>    <span class="n">Hc</span> <span class="o">=</span> <span class="mf">9.999d0</span> <span class="c">! safe but noticeable</span>
<a name="ln-9895"></a>  <span class="n">ENDIF</span>
<a name="ln-9896"></a>  <span class="k">RETURN</span>
<a name="ln-9897"></a>
<a name="ln-9898"></a><span class="k">END FUNCTION </span><span class="n">CalcGoldsteinNovoselacCeilingDiffuserFloor</span>
<a name="ln-9899"></a>
<a name="ln-9900"></a><span class="k">FUNCTION </span><span class="n">CalcSparrowWindward</span><span class="p">(</span><span class="n">RoughnessIndex</span><span class="p">,</span> <span class="n">FacePerimeter</span><span class="p">,</span> <span class="n">FaceArea</span><span class="p">,</span> <span class="n">WindAtZ</span><span class="p">,</span> <span class="n">SurfNum</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Hf</span><span class="p">)</span>
<a name="ln-9901"></a>
<a name="ln-9902"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-9903"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-9904"></a>          <span class="c">!       DATE WRITTEN   Aug 2010</span>
<a name="ln-9905"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9906"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9907"></a>
<a name="ln-9908"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-9909"></a>          <span class="c">! Calculate Sparrow Hf for windward surfaces</span>
<a name="ln-9910"></a>
<a name="ln-9911"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9912"></a>          <span class="c">! encapsulate equation as a function</span>
<a name="ln-9913"></a>
<a name="ln-9914"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-9915"></a>
<a name="ln-9916"></a>          <span class="c">!   1. TARP Reference Manual, &quot;Surface Outside Heat Balances&quot;, pp 71ff</span>
<a name="ln-9917"></a>          <span class="c">!   2. Sparrow, E. M., J. W. Ramsey, and E. A. Mass.  1979.  Effect of finite</span>
<a name="ln-9918"></a>          <span class="c">!   width on heat transfer and fluid flow about an inclined rectangular plate.</span>
<a name="ln-9919"></a>          <span class="c">!   Journal of Heat Transfer 101:  204.</span>
<a name="ln-9920"></a>          <span class="c">!   3. McClellan, T.M.  1996.  Investigation of a heat balance cooling load</span>
<a name="ln-9921"></a>          <span class="c">!   procedure with a detailed study of outside heat transfer parameters.</span>
<a name="ln-9922"></a>          <span class="c">!   M.S. Thesis, Department of Mechanical and Industrial Engineering,</span>
<a name="ln-9923"></a>          <span class="c">!   University of Illinois at Urbana-Champaign.</span>
<a name="ln-9924"></a>
<a name="ln-9925"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9926"></a>          <span class="c">! na</span>
<a name="ln-9927"></a>
<a name="ln-9928"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9929"></a>
<a name="ln-9930"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-9931"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RoughnessIndex</span>
<a name="ln-9932"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FacePerimeter</span>
<a name="ln-9933"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FaceArea</span>
<a name="ln-9934"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WindAtZ</span>
<a name="ln-9935"></a>  <span class="kt">INTEGER</span>  <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfNum</span>
<a name="ln-9936"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">Hf</span>
<a name="ln-9937"></a>
<a name="ln-9938"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-9939"></a>          <span class="c">! na</span>
<a name="ln-9940"></a>
<a name="ln-9941"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-9942"></a>          <span class="c">! na</span>
<a name="ln-9943"></a>
<a name="ln-9944"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-9945"></a>          <span class="c">! na</span>
<a name="ln-9946"></a>
<a name="ln-9947"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9948"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ErrorIndex</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-9949"></a>
<a name="ln-9950"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">FaceArea</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9951"></a><span class="k">    </span><span class="n">Hf</span> <span class="o">=</span> <span class="mf">2.53d0</span> <span class="o">*</span> <span class="n">RoughnessMultiplier</span><span class="p">(</span><span class="n">RoughnessIndex</span><span class="p">)</span><span class="o">*</span><span class="p">((</span> <span class="n">FacePerimeter</span> <span class="o">*</span> <span class="n">WindAtZ</span><span class="o">/</span><span class="n">FaceArea</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5d0</span><span class="p">)</span>
<a name="ln-9952"></a>
<a name="ln-9953"></a>  <span class="k">ELSE</span>
<a name="ln-9954"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">ErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9955"></a><span class="k">      CALL </span><span class="n">ShowSevereMessage</span><span class="p">(</span><span class="s1">&#39;CalcSparrowWindward: Convection model not evaluated (bad face area)&#39;</span><span class="p">)</span>
<a name="ln-9956"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Value for effective face area = &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">FaceArea</span><span class="p">,</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-9957"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs for surface named = &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-9958"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Convection surface heat transfer coefficient set to 9.999 [W/m2-K] and the simulation continues&#39;</span><span class="p">)</span>
<a name="ln-9959"></a>    <span class="n">ENDIF</span>
<a name="ln-9960"></a>    <span class="k">CALL </span><span class="n">ShowRecurringSevereErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;CalcSparrowWindward: Convection model not evaluated because &#39;</span> <span class="p">&amp;</span>
<a name="ln-9961"></a>                                      <span class="o">//</span><span class="s1">&#39;bad face area and set to 9.999 [W/m2-k]&#39;</span> <span class="p">,</span> <span class="n">ErrorIndex</span> <span class="p">)</span>
<a name="ln-9962"></a>    <span class="n">Hf</span> <span class="o">=</span> <span class="mf">9.999d0</span> <span class="c">! safe but noticeable</span>
<a name="ln-9963"></a>  <span class="n">ENDIF</span>
<a name="ln-9964"></a>  <span class="k">RETURN</span>
<a name="ln-9965"></a>
<a name="ln-9966"></a><span class="k">END FUNCTION </span><span class="n">CalcSparrowWindward</span>
<a name="ln-9967"></a>
<a name="ln-9968"></a><span class="k">FUNCTION </span><span class="n">CalcSparrowLeeward</span><span class="p">(</span><span class="n">RoughnessIndex</span><span class="p">,</span> <span class="n">FacePerimeter</span><span class="p">,</span> <span class="n">FaceArea</span><span class="p">,</span> <span class="n">WindAtZ</span><span class="p">,</span> <span class="n">SurfNum</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Hf</span><span class="p">)</span>
<a name="ln-9969"></a>
<a name="ln-9970"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-9971"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-9972"></a>          <span class="c">!       DATE WRITTEN   Aug 2010</span>
<a name="ln-9973"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9974"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9975"></a>
<a name="ln-9976"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-9977"></a>          <span class="c">! Calculate Sparrow Hf for leeward surfaces</span>
<a name="ln-9978"></a>
<a name="ln-9979"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9980"></a>          <span class="c">! encapsulate equation as a function</span>
<a name="ln-9981"></a>
<a name="ln-9982"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-9983"></a>
<a name="ln-9984"></a>          <span class="c">!   1. TARP Reference Manual, &quot;Surface Outside Heat Balances&quot;, pp 71ff</span>
<a name="ln-9985"></a>          <span class="c">!   2. Sparrow, E. M., J. W. Ramsey, and E. A. Mass.  1979.  Effect of finite</span>
<a name="ln-9986"></a>          <span class="c">!   width on heat transfer and fluid flow about an inclined rectangular plate.</span>
<a name="ln-9987"></a>          <span class="c">!   Journal of Heat Transfer 101:  204.</span>
<a name="ln-9988"></a>          <span class="c">!   3. McClellan, T.M.  1996.  Investigation of a heat balance cooling load</span>
<a name="ln-9989"></a>          <span class="c">!   procedure with a detailed study of outside heat transfer parameters.</span>
<a name="ln-9990"></a>          <span class="c">!   M.S. Thesis, Department of Mechanical and Industrial Engineering,</span>
<a name="ln-9991"></a>          <span class="c">!   University of Illinois at Urbana-Champaign.</span>
<a name="ln-9992"></a>
<a name="ln-9993"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9994"></a>          <span class="c">! na</span>
<a name="ln-9995"></a>
<a name="ln-9996"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9997"></a>
<a name="ln-9998"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-9999"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RoughnessIndex</span>
<a name="ln-10000"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FacePerimeter</span>
<a name="ln-10001"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FaceArea</span>
<a name="ln-10002"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WindAtZ</span>
<a name="ln-10003"></a>  <span class="kt">INTEGER</span>  <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfNum</span>
<a name="ln-10004"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">Hf</span>
<a name="ln-10005"></a>
<a name="ln-10006"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-10007"></a>          <span class="c">! na</span>
<a name="ln-10008"></a>
<a name="ln-10009"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-10010"></a>          <span class="c">! na</span>
<a name="ln-10011"></a>
<a name="ln-10012"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-10013"></a>          <span class="c">! na</span>
<a name="ln-10014"></a>
<a name="ln-10015"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10016"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ErrorIndex</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-10017"></a>
<a name="ln-10018"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">FaceArea</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10019"></a><span class="k">    </span><span class="n">Hf</span> <span class="o">=</span> <span class="mf">2.53d0</span> <span class="o">*</span> <span class="mf">0.5d0</span> <span class="o">*</span> <span class="n">RoughnessMultiplier</span><span class="p">(</span><span class="n">RoughnessIndex</span><span class="p">)</span><span class="o">*</span><span class="p">((</span> <span class="n">FacePerimeter</span> <span class="o">*</span> <span class="n">WindAtZ</span><span class="o">/</span><span class="n">FaceArea</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5d0</span><span class="p">)</span>
<a name="ln-10020"></a>  <span class="k">ELSE</span>
<a name="ln-10021"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">ErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10022"></a><span class="k">      CALL </span><span class="n">ShowSevereMessage</span><span class="p">(</span><span class="s1">&#39;CalcSparrowLeeward: Convection model not evaluated (bad face area)&#39;</span><span class="p">)</span>
<a name="ln-10023"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Value for effective face area = &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">FaceArea</span><span class="p">,</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-10024"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs for surface named = &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-10025"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Convection surface heat transfer coefficient set to 9.999 [W/m2-K] and the simulation continues&#39;</span><span class="p">)</span>
<a name="ln-10026"></a>    <span class="n">ENDIF</span>
<a name="ln-10027"></a>    <span class="k">CALL </span><span class="n">ShowRecurringSevereErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;CalcSparrowLeeward: Convection model not evaluated because &#39;</span> <span class="p">&amp;</span>
<a name="ln-10028"></a>                                      <span class="o">//</span><span class="s1">&#39;bad face area and set to 9.999 [W/m2-k]&#39;</span> <span class="p">,</span> <span class="n">ErrorIndex</span> <span class="p">)</span>
<a name="ln-10029"></a>
<a name="ln-10030"></a>    <span class="n">Hf</span> <span class="o">=</span> <span class="mf">9.999d0</span> <span class="c">! safe but noticeable</span>
<a name="ln-10031"></a>  <span class="n">ENDIF</span>
<a name="ln-10032"></a>  <span class="k">RETURN</span>
<a name="ln-10033"></a>
<a name="ln-10034"></a><span class="k">END FUNCTION </span><span class="n">CalcSparrowLeeward</span>
<a name="ln-10035"></a>
<a name="ln-10036"></a><span class="k">FUNCTION </span><span class="n">CalcMoWITTWindward</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">,</span> <span class="n">WindAtZ</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Hc</span><span class="p">)</span>
<a name="ln-10037"></a>
<a name="ln-10038"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-10039"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-10040"></a>          <span class="c">!       DATE WRITTEN   Aug 2010</span>
<a name="ln-10041"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-10042"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10043"></a>
<a name="ln-10044"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-10045"></a>          <span class="c">! calculate MoWITT Hc equation for windward surfaces</span>
<a name="ln-10046"></a>
<a name="ln-10047"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-10048"></a>          <span class="c">! encapsulate model equation in a function</span>
<a name="ln-10049"></a>
<a name="ln-10050"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-10051"></a>          <span class="c">!   Yazdanian, M. and J.H. Klems.  1994.  Measurement of the exterior convective</span>
<a name="ln-10052"></a>          <span class="c">!   film coefficient for windows in low-rise buildings.</span>
<a name="ln-10053"></a>          <span class="c">!   ASHRAE Transactions 100(1):  1087.</span>
<a name="ln-10054"></a>
<a name="ln-10055"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-10056"></a>          <span class="c">! na</span>
<a name="ln-10057"></a>
<a name="ln-10058"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-10059"></a>
<a name="ln-10060"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-10061"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DeltaTemp</span>
<a name="ln-10062"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WindAtZ</span>
<a name="ln-10063"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">Hc</span> <span class="c">! total convection coefficient</span>
<a name="ln-10064"></a>
<a name="ln-10065"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-10066"></a>          <span class="c">! na</span>
<a name="ln-10067"></a>
<a name="ln-10068"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-10069"></a>          <span class="c">! na</span>
<a name="ln-10070"></a>
<a name="ln-10071"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-10072"></a>          <span class="c">! na</span>
<a name="ln-10073"></a>
<a name="ln-10074"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10075"></a>          <span class="c">! na</span>
<a name="ln-10076"></a>
<a name="ln-10077"></a>  <span class="n">Hc</span> <span class="o">=</span> <span class="p">((</span>  <span class="mf">0.84d0</span><span class="o">*</span><span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">))</span><span class="o">**</span><span class="n">OneThird</span><span class="p">)</span>  <span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mf">3.26d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">WindAtZ</span><span class="o">**</span><span class="mf">0.89d0</span><span class="p">)</span> <span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">**</span><span class="mf">0.5d0</span>
<a name="ln-10078"></a>
<a name="ln-10079"></a>  <span class="k">RETURN</span>
<a name="ln-10080"></a>
<a name="ln-10081"></a><span class="k">END FUNCTION </span><span class="n">CalcMoWITTWindward</span>
<a name="ln-10082"></a>
<a name="ln-10083"></a><span class="k">FUNCTION </span><span class="n">CalcMoWITTLeeward</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">,</span> <span class="n">WindAtZ</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Hc</span><span class="p">)</span>
<a name="ln-10084"></a>
<a name="ln-10085"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-10086"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-10087"></a>          <span class="c">!       DATE WRITTEN   Aug 2010</span>
<a name="ln-10088"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-10089"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10090"></a>
<a name="ln-10091"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-10092"></a>          <span class="c">! calculate MoWITT Hc equation for leeward surfaces</span>
<a name="ln-10093"></a>
<a name="ln-10094"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-10095"></a>          <span class="c">! encapsulate model equation in a function</span>
<a name="ln-10096"></a>
<a name="ln-10097"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-10098"></a>          <span class="c">!   Yazdanian, M. and J.H. Klems.  1994.  Measurement of the exterior convective</span>
<a name="ln-10099"></a>          <span class="c">!   film coefficient for windows in low-rise buildings.</span>
<a name="ln-10100"></a>          <span class="c">!   ASHRAE Transactions 100(1):  1087.</span>
<a name="ln-10101"></a>
<a name="ln-10102"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-10103"></a>          <span class="c">! na</span>
<a name="ln-10104"></a>
<a name="ln-10105"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-10106"></a>
<a name="ln-10107"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-10108"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DeltaTemp</span>
<a name="ln-10109"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WindAtZ</span>
<a name="ln-10110"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">Hc</span> <span class="c">! total convection coefficient</span>
<a name="ln-10111"></a>
<a name="ln-10112"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-10113"></a>          <span class="c">! na</span>
<a name="ln-10114"></a>
<a name="ln-10115"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-10116"></a>          <span class="c">! na</span>
<a name="ln-10117"></a>
<a name="ln-10118"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-10119"></a>          <span class="c">! na</span>
<a name="ln-10120"></a>
<a name="ln-10121"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10122"></a>          <span class="c">! na</span>
<a name="ln-10123"></a>
<a name="ln-10124"></a>  <span class="n">Hc</span> <span class="o">=</span> <span class="p">((</span>  <span class="mf">0.84d0</span><span class="o">*</span><span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">))</span><span class="o">**</span><span class="n">OneThird</span><span class="p">)</span>  <span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mf">3.55d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">WindAtZ</span><span class="o">**</span><span class="mf">0.617d0</span><span class="p">)</span> <span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">**</span><span class="mf">0.5d0</span>
<a name="ln-10125"></a>
<a name="ln-10126"></a>  <span class="k">RETURN</span>
<a name="ln-10127"></a>
<a name="ln-10128"></a><span class="k">END FUNCTION </span><span class="n">CalcMoWITTLeeward</span>
<a name="ln-10129"></a>
<a name="ln-10130"></a><span class="k">FUNCTION </span><span class="n">CalcDOE2Windward</span><span class="p">(</span><span class="n">SurfaceTemp</span><span class="p">,</span> <span class="n">AirTemp</span><span class="p">,</span> <span class="n">CosineTilt</span><span class="p">,</span> <span class="n">WindAtZ</span><span class="p">,</span> <span class="n">RoughnessIndex</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Hf</span><span class="p">)</span>
<a name="ln-10131"></a>
<a name="ln-10132"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-10133"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-10134"></a>          <span class="c">!       DATE WRITTEN   Aug 2010</span>
<a name="ln-10135"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-10136"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10137"></a>
<a name="ln-10138"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-10139"></a>          <span class="c">! calculate DOE-2 Hc equation for windward surfaces</span>
<a name="ln-10140"></a>
<a name="ln-10141"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-10142"></a>          <span class="c">! encapsulate model equation in a function</span>
<a name="ln-10143"></a>
<a name="ln-10144"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-10145"></a>          <span class="c">!   Lawrence Berkeley Laboratory.  1994.  DOE2.1E-053 source code.</span>
<a name="ln-10146"></a>          <span class="c">!   Yazdanian, M. and J.H. Klems.  1994.  Measurement of the exterior convective</span>
<a name="ln-10147"></a>          <span class="c">!   film coefficient for windows in low-rise buildings.</span>
<a name="ln-10148"></a>          <span class="c">!   ASHRAE Transactions 100(1):  1087.</span>
<a name="ln-10149"></a>
<a name="ln-10150"></a>
<a name="ln-10151"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-10152"></a>          <span class="c">! na</span>
<a name="ln-10153"></a>
<a name="ln-10154"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-10155"></a>
<a name="ln-10156"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-10157"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfaceTemp</span>
<a name="ln-10158"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirTemp</span>
<a name="ln-10159"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CosineTilt</span>
<a name="ln-10160"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WindAtZ</span>
<a name="ln-10161"></a>  <span class="kt">INTEGER</span>  <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RoughnessIndex</span>
<a name="ln-10162"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">Hf</span> <span class="c">! forced convection coefficient</span>
<a name="ln-10163"></a>
<a name="ln-10164"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-10165"></a>          <span class="c">! na</span>
<a name="ln-10166"></a>
<a name="ln-10167"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-10168"></a>          <span class="c">! na</span>
<a name="ln-10169"></a>
<a name="ln-10170"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-10171"></a>          <span class="c">! na</span>
<a name="ln-10172"></a>
<a name="ln-10173"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10174"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HcSmooth</span>
<a name="ln-10175"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Hn</span>
<a name="ln-10176"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DeltaTemp</span>
<a name="ln-10177"></a>
<a name="ln-10178"></a>  <span class="n">DeltaTemp</span> <span class="o">=</span> <span class="n">SurfaceTemp</span> <span class="o">-</span> <span class="n">AirTemp</span>
<a name="ln-10179"></a>
<a name="ln-10180"></a>  <span class="n">Hn</span> <span class="o">=</span> <span class="n">CalcHnASHRAETARPExterior</span><span class="p">(</span><span class="n">SurfaceTemp</span><span class="p">,</span> <span class="n">AirTemp</span><span class="p">,</span> <span class="n">CosineTilt</span><span class="p">)</span>
<a name="ln-10181"></a>
<a name="ln-10182"></a>  <span class="n">HcSmooth</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="n">Hn</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mf">3.26d0</span> <span class="o">*</span> <span class="n">WindAtZ</span> <span class="o">**</span> <span class="mf">0.89d0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-10183"></a>
<a name="ln-10184"></a>  <span class="n">Hf</span> <span class="o">=</span> <span class="n">RoughnessMultiplier</span><span class="p">(</span><span class="n">RoughnessIndex</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">HcSmooth</span> <span class="o">-</span> <span class="n">Hn</span><span class="p">)</span>
<a name="ln-10185"></a>
<a name="ln-10186"></a>  <span class="k">RETURN</span>
<a name="ln-10187"></a>
<a name="ln-10188"></a><span class="k">END FUNCTION </span><span class="n">CalcDOE2Windward</span>
<a name="ln-10189"></a>
<a name="ln-10190"></a><span class="k">FUNCTION </span><span class="n">CalcDOE2Leeward</span><span class="p">(</span><span class="n">SurfaceTemp</span><span class="p">,</span> <span class="n">AirTemp</span><span class="p">,</span> <span class="n">CosineTilt</span><span class="p">,</span> <span class="n">WindAtZ</span><span class="p">,</span> <span class="n">RoughnessIndex</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Hf</span><span class="p">)</span>
<a name="ln-10191"></a>
<a name="ln-10192"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-10193"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-10194"></a>          <span class="c">!       DATE WRITTEN   Aug 2010</span>
<a name="ln-10195"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-10196"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10197"></a>
<a name="ln-10198"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-10199"></a>          <span class="c">! calculate DOE-2 Hc equation for leeward surfaces</span>
<a name="ln-10200"></a>
<a name="ln-10201"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-10202"></a>          <span class="c">! encapsulate model equation in a function</span>
<a name="ln-10203"></a>
<a name="ln-10204"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-10205"></a>          <span class="c">!   Lawrence Berkeley Laboratory.  1994.  DOE2.1E-053 source code.</span>
<a name="ln-10206"></a>          <span class="c">!   Yazdanian, M. and J.H. Klems.  1994.  Measurement of the exterior convective</span>
<a name="ln-10207"></a>          <span class="c">!   film coefficient for windows in low-rise buildings.</span>
<a name="ln-10208"></a>          <span class="c">!   ASHRAE Transactions 100(1):  1087.</span>
<a name="ln-10209"></a>
<a name="ln-10210"></a>
<a name="ln-10211"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-10212"></a>          <span class="c">! na</span>
<a name="ln-10213"></a>
<a name="ln-10214"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-10215"></a>
<a name="ln-10216"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-10217"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfaceTemp</span>
<a name="ln-10218"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirTemp</span>
<a name="ln-10219"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CosineTilt</span>
<a name="ln-10220"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WindAtZ</span>
<a name="ln-10221"></a>  <span class="kt">INTEGER</span>  <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RoughnessIndex</span>
<a name="ln-10222"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">Hf</span> <span class="c">! forced convection coefficient</span>
<a name="ln-10223"></a>
<a name="ln-10224"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-10225"></a>          <span class="c">! na</span>
<a name="ln-10226"></a>
<a name="ln-10227"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-10228"></a>          <span class="c">! na</span>
<a name="ln-10229"></a>
<a name="ln-10230"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-10231"></a>          <span class="c">! na</span>
<a name="ln-10232"></a>
<a name="ln-10233"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10234"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HcSmooth</span>
<a name="ln-10235"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Hn</span>
<a name="ln-10236"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DeltaTemp</span>
<a name="ln-10237"></a>
<a name="ln-10238"></a>  <span class="n">DeltaTemp</span> <span class="o">=</span> <span class="n">SurfaceTemp</span> <span class="o">-</span> <span class="n">AirTemp</span>
<a name="ln-10239"></a>
<a name="ln-10240"></a>  <span class="n">Hn</span> <span class="o">=</span> <span class="n">CalcHnASHRAETARPExterior</span><span class="p">(</span><span class="n">SurfaceTemp</span><span class="p">,</span> <span class="n">AirTemp</span><span class="p">,</span> <span class="n">CosineTilt</span><span class="p">)</span>
<a name="ln-10241"></a>
<a name="ln-10242"></a>  <span class="n">HcSmooth</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="n">Hn</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mf">3.55d0</span> <span class="o">*</span> <span class="n">WindAtZ</span> <span class="o">**</span> <span class="mf">0.617d0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-10243"></a>
<a name="ln-10244"></a>  <span class="n">Hf</span> <span class="o">=</span> <span class="n">RoughnessMultiplier</span><span class="p">(</span><span class="n">RoughnessIndex</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">HcSmooth</span> <span class="o">-</span> <span class="n">Hn</span><span class="p">)</span>
<a name="ln-10245"></a>
<a name="ln-10246"></a>  <span class="k">RETURN</span>
<a name="ln-10247"></a>
<a name="ln-10248"></a><span class="k">END FUNCTION </span><span class="n">CalcDOE2Leeward</span>
<a name="ln-10249"></a>
<a name="ln-10250"></a><span class="k">FUNCTION </span><span class="n">CalcNusseltJurges</span><span class="p">(</span><span class="n">WindAtZ</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Hc</span><span class="p">)</span>
<a name="ln-10251"></a>
<a name="ln-10252"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-10253"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-10254"></a>          <span class="c">!       DATE WRITTEN   Aug 2010</span>
<a name="ln-10255"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-10256"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10257"></a>
<a name="ln-10258"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-10259"></a>          <span class="c">! calculate model equation for forced convection using Nusselt Jurges correlation</span>
<a name="ln-10260"></a>          <span class="c">! model is attributed to Nusselt and Jurges but the equation is recast in current units</span>
<a name="ln-10261"></a>          <span class="c">! by Palyvos</span>
<a name="ln-10262"></a>
<a name="ln-10263"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-10264"></a>          <span class="c">! encapsulate the model equation in a function</span>
<a name="ln-10265"></a>
<a name="ln-10266"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-10267"></a>          <span class="c">!</span>
<a name="ln-10268"></a>          <span class="c">! 1. Nusselt, W., W. Jurges. 1922. Die Kuhlung einer ebenen Wand durch einen Luftstrom</span>
<a name="ln-10269"></a>          <span class="c">!     (The cooling of a plane wall by an air flow). Gesundheits Ingenieur 52, Heft, 45, Jargang.</span>
<a name="ln-10270"></a>          <span class="c">! 2. Palyvos, J.A., 2008. A survey of wind convection coefficient correlations for building</span>
<a name="ln-10271"></a>          <span class="c">!     envelope energy systems modeling. Applied Thermal Engineering 28 (2008) 801-808. Elsevier.</span>
<a name="ln-10272"></a>
<a name="ln-10273"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-10274"></a>          <span class="c">! na</span>
<a name="ln-10275"></a>
<a name="ln-10276"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-10277"></a>
<a name="ln-10278"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-10279"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WindAtZ</span>
<a name="ln-10280"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">Hc</span>
<a name="ln-10281"></a>
<a name="ln-10282"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-10283"></a>          <span class="c">! na</span>
<a name="ln-10284"></a>
<a name="ln-10285"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-10286"></a>          <span class="c">! na</span>
<a name="ln-10287"></a>
<a name="ln-10288"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-10289"></a>          <span class="c">! na</span>
<a name="ln-10290"></a>
<a name="ln-10291"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10292"></a>  <span class="n">Hc</span> <span class="o">=</span> <span class="mf">5.8d0</span> <span class="o">+</span> <span class="mf">3.94d0</span> <span class="o">*</span> <span class="n">WindAtZ</span>
<a name="ln-10293"></a>
<a name="ln-10294"></a>  <span class="k">RETURN</span>
<a name="ln-10295"></a>
<a name="ln-10296"></a><span class="k">END FUNCTION </span><span class="n">CalcNusseltJurges</span>
<a name="ln-10297"></a>
<a name="ln-10298"></a><span class="k">FUNCTION </span><span class="n">CalcMcAdams</span><span class="p">(</span><span class="n">WindAtZ</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Hc</span><span class="p">)</span>
<a name="ln-10299"></a>
<a name="ln-10300"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-10301"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-10302"></a>          <span class="c">!       DATE WRITTEN   Aug 2010</span>
<a name="ln-10303"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-10304"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10305"></a>
<a name="ln-10306"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-10307"></a>          <span class="c">! calculate model equation for forced convection using McAdams correlation</span>
<a name="ln-10308"></a>          <span class="c">! model is attributed to McAdams but the equation is as recast in current units</span>
<a name="ln-10309"></a>          <span class="c">! by Palyvos</span>
<a name="ln-10310"></a>
<a name="ln-10311"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-10312"></a>          <span class="c">! encapsulate the model equation in a function</span>
<a name="ln-10313"></a>
<a name="ln-10314"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-10315"></a>          <span class="c">!</span>
<a name="ln-10316"></a>          <span class="c">! 1. McAdams, W.H., 1954. Heat Transmission, third ed., McGraw-Hill, New York.</span>
<a name="ln-10317"></a>          <span class="c">! 2. Palyvos, J.A., 2008. A survey of wind convection coefficient correlations for building</span>
<a name="ln-10318"></a>          <span class="c">!     envelope energy systems modeling. Applied Thermal Engineering 28 (2008) 801-808. Elsevier.</span>
<a name="ln-10319"></a>
<a name="ln-10320"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-10321"></a>          <span class="c">! na</span>
<a name="ln-10322"></a>
<a name="ln-10323"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-10324"></a>
<a name="ln-10325"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-10326"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WindAtZ</span>
<a name="ln-10327"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">Hc</span>
<a name="ln-10328"></a>
<a name="ln-10329"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-10330"></a>          <span class="c">! na</span>
<a name="ln-10331"></a>
<a name="ln-10332"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-10333"></a>          <span class="c">! na</span>
<a name="ln-10334"></a>
<a name="ln-10335"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-10336"></a>          <span class="c">! na</span>
<a name="ln-10337"></a>
<a name="ln-10338"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10339"></a>  <span class="n">Hc</span> <span class="o">=</span> <span class="mf">5.8d0</span> <span class="o">+</span> <span class="mf">3.8d0</span> <span class="o">*</span> <span class="n">WindAtZ</span>
<a name="ln-10340"></a>
<a name="ln-10341"></a>  <span class="k">RETURN</span>
<a name="ln-10342"></a>
<a name="ln-10343"></a><span class="k">END FUNCTION </span><span class="n">CalcMcAdams</span>
<a name="ln-10344"></a>
<a name="ln-10345"></a><span class="k">FUNCTION </span><span class="n">CalcMitchell</span><span class="p">(</span><span class="n">WindAtZ</span><span class="p">,</span> <span class="n">LengthScale</span> <span class="p">,</span> <span class="n">SurfNum</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Hf</span><span class="p">)</span>
<a name="ln-10346"></a>
<a name="ln-10347"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-10348"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-10349"></a>          <span class="c">!       DATE WRITTEN   Aug 2010</span>
<a name="ln-10350"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-10351"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10352"></a>
<a name="ln-10353"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-10354"></a>          <span class="c">! calculate model equation for forced convection using Mitchell correlation</span>
<a name="ln-10355"></a>          <span class="c">! model is attributed to Mitchell but the equation is as recast in current units</span>
<a name="ln-10356"></a>          <span class="c">! by Palyvos</span>
<a name="ln-10357"></a>
<a name="ln-10358"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-10359"></a>          <span class="c">! encapsulate the model equation in a function</span>
<a name="ln-10360"></a>
<a name="ln-10361"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-10362"></a>          <span class="c">! 1. Mitchell, J.W., 1976. Heat transfer from spheres and other animal forms. Biophy. J. 16 (1976) 561</span>
<a name="ln-10363"></a>          <span class="c">! 2. Palyvos, J.A., 2008. A survey of wind convection coefficient correlations for building</span>
<a name="ln-10364"></a>          <span class="c">!     envelope energy systems modeling. Applied Thermal Engineering 28 (2008) 801-808. Elsevier.</span>
<a name="ln-10365"></a>
<a name="ln-10366"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-10367"></a>          <span class="c">! na</span>
<a name="ln-10368"></a>
<a name="ln-10369"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-10370"></a>
<a name="ln-10371"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-10372"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WindAtZ</span>
<a name="ln-10373"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LengthScale</span>
<a name="ln-10374"></a>  <span class="kt">INTEGER</span>  <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfNum</span>
<a name="ln-10375"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">Hf</span>
<a name="ln-10376"></a>
<a name="ln-10377"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-10378"></a>          <span class="c">! na</span>
<a name="ln-10379"></a>
<a name="ln-10380"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-10381"></a>          <span class="c">! na</span>
<a name="ln-10382"></a>
<a name="ln-10383"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-10384"></a>          <span class="c">! na</span>
<a name="ln-10385"></a>
<a name="ln-10386"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10387"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ErrorIndex</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-10388"></a>
<a name="ln-10389"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">LengthScale</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10390"></a><span class="k">    </span><span class="n">Hf</span> <span class="o">=</span> <span class="mf">8.6d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">WindAtZ</span><span class="o">**</span><span class="mf">0.6d0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">LengthScale</span><span class="o">**</span><span class="mf">0.4d0</span><span class="p">)</span>
<a name="ln-10391"></a>  <span class="k">ELSE</span>
<a name="ln-10392"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">ErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10393"></a><span class="k">      CALL </span><span class="n">ShowSevereMessage</span><span class="p">(</span><span class="s1">&#39;CalcMitchell: Convection model not evaluated (bad length scale)&#39;</span><span class="p">)</span>
<a name="ln-10394"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Value for effective length scale = &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">LengthScale</span><span class="p">,</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-10395"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs for surface named = &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-10396"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Convection surface heat transfer coefficient set to 9.999 [W/m2-K] and the simulation continues&#39;</span><span class="p">)</span>
<a name="ln-10397"></a>    <span class="n">ENDIF</span>
<a name="ln-10398"></a>    <span class="k">CALL </span><span class="n">ShowRecurringSevereErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;CalcMitchell: Convection model not evaluated because &#39;</span> <span class="p">&amp;</span>
<a name="ln-10399"></a>                                      <span class="o">//</span><span class="s1">&#39;bad length scale and set to 9.999 [W/m2-k]&#39;</span> <span class="p">,</span> <span class="n">ErrorIndex</span> <span class="p">)</span>
<a name="ln-10400"></a>    <span class="n">Hf</span> <span class="o">=</span> <span class="mf">9.999d0</span> <span class="c">! safe but noticeable</span>
<a name="ln-10401"></a>  <span class="n">ENDIF</span>
<a name="ln-10402"></a>  <span class="k">RETURN</span>
<a name="ln-10403"></a>
<a name="ln-10404"></a><span class="k">END FUNCTION </span><span class="n">CalcMitchell</span>
<a name="ln-10405"></a>
<a name="ln-10406"></a><span class="k">FUNCTION </span><span class="n">CalcBlockenWindward</span><span class="p">(</span><span class="n">WindAt10m</span><span class="p">,</span> <span class="n">WindDir</span><span class="p">,</span> <span class="n">SurfAzimuth</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Hf</span><span class="p">)</span>
<a name="ln-10407"></a>
<a name="ln-10408"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-10409"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-10410"></a>          <span class="c">!       DATE WRITTEN   Aug 2010</span>
<a name="ln-10411"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-10412"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10413"></a>
<a name="ln-10414"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-10415"></a>          <span class="c">! calculate model equation for forced convection using Blocken correlation</span>
<a name="ln-10416"></a>
<a name="ln-10417"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-10418"></a>          <span class="c">! encapsulate model in function</span>
<a name="ln-10419"></a>
<a name="ln-10420"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-10421"></a>          <span class="c">! Blocken, B., T. Defraeye, D. Derome, J. Carmeliet. 2009.</span>
<a name="ln-10422"></a>          <span class="c">!  High-Resolution CFD Simulations for Forced Convection</span>
<a name="ln-10423"></a>          <span class="c">!   Heat Transfer Coefficients at the Facade of a Low-Rise Building.</span>
<a name="ln-10424"></a>          <span class="c">!   Building and Environment 44 (2009) 2396 - 2412.</span>
<a name="ln-10425"></a>
<a name="ln-10426"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-10427"></a>          <span class="c">! na</span>
<a name="ln-10428"></a>
<a name="ln-10429"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-10430"></a>
<a name="ln-10431"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-10432"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WindAt10m</span>
<a name="ln-10433"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WindDir</span> <span class="c">! Wind direction measured clockwise from geographhic North</span>
<a name="ln-10434"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfAzimuth</span> <span class="c">! or Facing, Direction the surface outward normal faces (degrees)</span>
<a name="ln-10435"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">Hf</span>
<a name="ln-10436"></a>
<a name="ln-10437"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-10438"></a>          <span class="c">! na</span>
<a name="ln-10439"></a>
<a name="ln-10440"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-10441"></a>          <span class="c">! na</span>
<a name="ln-10442"></a>
<a name="ln-10443"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-10444"></a>          <span class="c">! na</span>
<a name="ln-10445"></a>
<a name="ln-10446"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10447"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Theta</span> <span class="c">! angle between wind and surface azimuth</span>
<a name="ln-10448"></a>
<a name="ln-10449"></a>  <span class="n">Theta</span> <span class="o">=</span> <span class="n">WindDir</span> <span class="o">-</span> <span class="n">SurfAzimuth</span> <span class="o">-</span> <span class="mi">9</span><span class="mf">0.d0</span> <span class="c">!TODO double check theta</span>
<a name="ln-10450"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Theta</span> <span class="o">&gt;</span> <span class="mi">18</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="n">Theta</span> <span class="o">=</span> <span class="n">Theta</span> <span class="o">-</span> <span class="mi">36</span><span class="mf">0.00</span>
<a name="ln-10451"></a>
<a name="ln-10452"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Theta</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="mf">1.25d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10453"></a><span class="k">    </span><span class="n">Hf</span> <span class="o">=</span> <span class="mf">4.6d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">WindAt10m</span><span class="o">**</span><span class="mf">0.89d0</span><span class="p">)</span>
<a name="ln-10454"></a>  <span class="n">ELSEIF</span> <span class="p">((</span><span class="mi">1</span><span class="mf">1.25d0</span> <span class="o">&lt;</span> <span class="n">Theta</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Theta</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="mf">3.75d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10455"></a><span class="k">    </span><span class="n">Hf</span> <span class="o">=</span> <span class="mf">5.d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">WindAt10m</span><span class="o">**</span><span class="mf">0.8d0</span><span class="p">)</span>
<a name="ln-10456"></a>  <span class="n">ELSEIF</span> <span class="p">((</span><span class="mi">3</span><span class="mf">3.75d0</span> <span class="o">&lt;</span> <span class="n">Theta</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Theta</span> <span class="o">&lt;=</span> <span class="mi">5</span><span class="mf">6.25d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10457"></a><span class="k">    </span><span class="n">Hf</span> <span class="o">=</span> <span class="mf">4.6d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">WindAt10m</span><span class="o">**</span><span class="mf">0.84d0</span><span class="p">)</span>
<a name="ln-10458"></a>  <span class="n">ELSEIF</span> <span class="p">((</span><span class="mi">5</span><span class="mf">6.25d0</span> <span class="o">&lt;</span> <span class="n">Theta</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Theta</span> <span class="o">&lt;=</span> <span class="mi">10</span><span class="mf">0.d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10459"></a><span class="k">    </span><span class="n">Hf</span> <span class="o">=</span> <span class="mf">4.5d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">WindAt10m</span><span class="o">**</span><span class="mf">0.81d0</span><span class="p">)</span>
<a name="ln-10460"></a>  <span class="k">ELSE</span>
<a name="ln-10461"></a>    <span class="c">! should not be used for leeward... check why come here?</span>
<a name="ln-10462"></a>    <span class="n">Hf</span> <span class="o">=</span> <span class="mf">3.54d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">WindAt10m</span><span class="o">**</span><span class="mf">0.76d0</span><span class="p">)</span>  <span class="c">!emmel model for robustness?</span>
<a name="ln-10463"></a>  <span class="n">ENDIF</span>
<a name="ln-10464"></a>  <span class="k">RETURN</span>
<a name="ln-10465"></a>
<a name="ln-10466"></a><span class="k">END FUNCTION </span><span class="n">CalcBlockenWindward</span>
<a name="ln-10467"></a>
<a name="ln-10468"></a><span class="k">FUNCTION </span><span class="n">CalcEmmelVertical</span><span class="p">(</span><span class="n">WindAt10m</span><span class="p">,</span> <span class="n">WindDir</span><span class="p">,</span> <span class="n">SurfAzimuth</span><span class="p">,</span> <span class="n">SurfNum</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Hf</span><span class="p">)</span>
<a name="ln-10469"></a>
<a name="ln-10470"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-10471"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-10472"></a>          <span class="c">!       DATE WRITTEN   Aug 2010</span>
<a name="ln-10473"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-10474"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10475"></a>
<a name="ln-10476"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-10477"></a>          <span class="c">! calculate model equation for forced convection using Emmel correlation</span>
<a name="ln-10478"></a>          <span class="c">! for vertical walls</span>
<a name="ln-10479"></a>
<a name="ln-10480"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-10481"></a>          <span class="c">! encapsulate model in function</span>
<a name="ln-10482"></a>
<a name="ln-10483"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-10484"></a>          <span class="c">! Emmel, M.G., M.O. Abadie, N. Mendes. 2007. New external convective</span>
<a name="ln-10485"></a>          <span class="c">!   heat transfer coefficient correlations for isolated low-rise buildings.</span>
<a name="ln-10486"></a>          <span class="c">!    Energy and Buildings 39 (2007) 335- 342</span>
<a name="ln-10487"></a>
<a name="ln-10488"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-10489"></a>          <span class="c">! na</span>
<a name="ln-10490"></a>
<a name="ln-10491"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-10492"></a>
<a name="ln-10493"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-10494"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WindAt10m</span>
<a name="ln-10495"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WindDir</span> <span class="c">! Wind direction measured clockwise from geographhic North</span>
<a name="ln-10496"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfAzimuth</span> <span class="c">! or Facing, Direction the surface outward normal faces (degrees)</span>
<a name="ln-10497"></a>  <span class="kt">INTEGER</span>   <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfNum</span>
<a name="ln-10498"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">Hf</span>
<a name="ln-10499"></a>
<a name="ln-10500"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-10501"></a>          <span class="c">! na</span>
<a name="ln-10502"></a>
<a name="ln-10503"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-10504"></a>          <span class="c">! na</span>
<a name="ln-10505"></a>
<a name="ln-10506"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-10507"></a>          <span class="c">! na</span>
<a name="ln-10508"></a>
<a name="ln-10509"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10510"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Theta</span> <span class="c">! angle between wind and surface azimuth</span>
<a name="ln-10511"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ErrorIndex</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-10512"></a>
<a name="ln-10513"></a>  <span class="n">Theta</span> <span class="o">=</span> <span class="n">WindDir</span> <span class="o">-</span> <span class="n">SurfAzimuth</span> <span class="o">-</span> <span class="mi">9</span><span class="mf">0.d0</span> <span class="c">!TODO double check theta</span>
<a name="ln-10514"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Theta</span> <span class="o">&gt;</span> <span class="mi">180</span> <span class="p">)</span> <span class="n">Theta</span> <span class="o">=</span> <span class="n">Theta</span> <span class="o">-</span> <span class="mi">36</span><span class="mf">0.0d0</span>
<a name="ln-10515"></a>
<a name="ln-10516"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Theta</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="mf">2.5d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10517"></a><span class="k">    </span><span class="n">Hf</span> <span class="o">=</span> <span class="mf">5.15d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">WindAt10m</span><span class="o">**</span><span class="mf">0.81d0</span><span class="p">)</span>
<a name="ln-10518"></a>  <span class="n">ELSEIF</span> <span class="p">((</span><span class="mi">2</span><span class="mf">2.5d0</span> <span class="o">&lt;</span> <span class="n">Theta</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Theta</span> <span class="o">&lt;=</span> <span class="mi">6</span><span class="mf">7.5d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10519"></a><span class="k">    </span><span class="n">Hf</span> <span class="o">=</span> <span class="mf">3.34d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">WindAt10m</span><span class="o">**</span><span class="mf">0.84d0</span><span class="p">)</span>
<a name="ln-10520"></a>  <span class="n">ELSEIF</span> <span class="p">((</span><span class="mi">6</span><span class="mf">7.5d0</span> <span class="o">&lt;</span> <span class="n">Theta</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Theta</span> <span class="o">&lt;=</span> <span class="mi">11</span><span class="mf">2.5d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10521"></a><span class="k">    </span><span class="n">Hf</span> <span class="o">=</span> <span class="mf">4.78d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">WindAt10m</span><span class="o">**</span><span class="mf">0.71d0</span><span class="p">)</span>
<a name="ln-10522"></a>  <span class="n">ELSEIF</span> <span class="p">((</span><span class="mi">11</span><span class="mf">2.5d0</span> <span class="o">&lt;</span> <span class="n">Theta</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Theta</span> <span class="o">&lt;=</span> <span class="mi">15</span><span class="mf">7.5d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10523"></a><span class="k">    </span><span class="n">Hf</span> <span class="o">=</span> <span class="mf">4.05d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">WindAt10m</span><span class="o">**</span><span class="mf">0.77d0</span><span class="p">)</span>
<a name="ln-10524"></a>  <span class="n">ELSEIF</span> <span class="p">((</span><span class="mi">15</span><span class="mf">7.5d0</span> <span class="o">&lt;</span> <span class="n">Theta</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Theta</span> <span class="o">&lt;=</span> <span class="mi">18</span><span class="mf">0.d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10525"></a><span class="k">    </span><span class="n">Hf</span> <span class="o">=</span> <span class="mf">3.54d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">WindAt10m</span><span class="o">**</span><span class="mf">0.76d0</span><span class="p">)</span>
<a name="ln-10526"></a>
<a name="ln-10527"></a>  <span class="k">ELSE</span>
<a name="ln-10528"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">ErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10529"></a><span class="k">      CALL </span><span class="n">ShowSevereMessage</span><span class="p">(</span><span class="s1">&#39;CalcEmmelVertical: Convection model wind angle calculation suspect&#39;</span> <span class="p">&amp;</span>
<a name="ln-10530"></a>                               <span class="o">//</span><span class="s1">&#39;(developer issue)&#39;</span> <span class="p">)</span>
<a name="ln-10531"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Value for theta angle = &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Theta</span><span class="p">,</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-10532"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs for surface named = &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-10533"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Convection model uses high theta correlation and the simulation continues&#39;</span><span class="p">)</span>
<a name="ln-10534"></a>    <span class="n">ENDIF</span>
<a name="ln-10535"></a>    <span class="k">CALL </span><span class="n">ShowRecurringSevereErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;CalcEmmelVertical: Convection model wind angle calculation suspect&#39;</span> <span class="p">&amp;</span>
<a name="ln-10536"></a>                             <span class="o">//</span><span class="s1">&#39; and high theta correlation&#39;</span><span class="p">,</span> <span class="n">ErrorIndex</span><span class="p">)</span>
<a name="ln-10537"></a>    <span class="n">Hf</span> <span class="o">=</span> <span class="mf">3.54d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">WindAt10m</span><span class="o">**</span><span class="mf">0.76d0</span><span class="p">)</span>
<a name="ln-10538"></a>  <span class="n">ENDIF</span>
<a name="ln-10539"></a>  <span class="k">RETURN</span>
<a name="ln-10540"></a>
<a name="ln-10541"></a><span class="k">END FUNCTION </span><span class="n">CalcEmmelVertical</span>
<a name="ln-10542"></a>
<a name="ln-10543"></a><span class="k">FUNCTION </span><span class="n">CalcEmmelRoof</span><span class="p">(</span><span class="n">WindAt10m</span><span class="p">,</span> <span class="n">WindDir</span><span class="p">,</span> <span class="n">LongAxisOutwardAzimuth</span><span class="p">,</span> <span class="n">SurfNum</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Hf</span><span class="p">)</span>
<a name="ln-10544"></a>
<a name="ln-10545"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-10546"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-10547"></a>          <span class="c">!       DATE WRITTEN   Aug 2010</span>
<a name="ln-10548"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-10549"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10550"></a>
<a name="ln-10551"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-10552"></a>          <span class="c">! calculate model equation for forced convection using Emmel correlation</span>
<a name="ln-10553"></a>          <span class="c">! for horizontal roofs</span>
<a name="ln-10554"></a>
<a name="ln-10555"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-10556"></a>          <span class="c">! encapsulate model in function</span>
<a name="ln-10557"></a>
<a name="ln-10558"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-10559"></a>          <span class="c">! Emmel, M.G., M.O. Abadie, N. Mendes. 2007. New external convective</span>
<a name="ln-10560"></a>          <span class="c">!   heat transfer coefficient correlations for isolated low-rise buildings.</span>
<a name="ln-10561"></a>          <span class="c">!    Energy and Buildings 39 (2007) 335- 342</span>
<a name="ln-10562"></a>
<a name="ln-10563"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-10564"></a>          <span class="c">! na</span>
<a name="ln-10565"></a>
<a name="ln-10566"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-10567"></a>
<a name="ln-10568"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-10569"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WindAt10m</span>
<a name="ln-10570"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WindDir</span> <span class="c">! Wind direction measured clockwise from geographhic North</span>
<a name="ln-10571"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LongAxisOutwardAzimuth</span> <span class="c">! or Facing, Direction the surface outward normal faces (degrees)</span>
<a name="ln-10572"></a>  <span class="kt">INTEGER</span>   <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfNum</span>
<a name="ln-10573"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">Hf</span>
<a name="ln-10574"></a>
<a name="ln-10575"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-10576"></a>          <span class="c">! na</span>
<a name="ln-10577"></a>
<a name="ln-10578"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-10579"></a>          <span class="c">! na</span>
<a name="ln-10580"></a>
<a name="ln-10581"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-10582"></a>          <span class="c">! na</span>
<a name="ln-10583"></a>
<a name="ln-10584"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10585"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Theta</span> <span class="c">! angle between wind and surface azimuth</span>
<a name="ln-10586"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ErrorIndex</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-10587"></a>
<a name="ln-10588"></a>  <span class="n">Theta</span> <span class="o">=</span> <span class="n">WindDir</span> <span class="o">-</span> <span class="n">LongAxisOutwardAzimuth</span> <span class="o">-</span> <span class="mi">9</span><span class="mf">0.d0</span> <span class="c">!TODO double check theta</span>
<a name="ln-10589"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Theta</span> <span class="o">&gt;</span> <span class="mi">18</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="n">Theta</span> <span class="o">=</span> <span class="n">Theta</span> <span class="o">-</span> <span class="mi">36</span><span class="mf">0.0d0</span>
<a name="ln-10590"></a>
<a name="ln-10591"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Theta</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="mf">2.5d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10592"></a><span class="k">    </span><span class="n">Hf</span> <span class="o">=</span> <span class="mf">5.15d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">WindAt10m</span><span class="o">**</span><span class="mf">0.81d0</span><span class="p">)</span>
<a name="ln-10593"></a>  <span class="n">ELSEIF</span> <span class="p">((</span><span class="mi">2</span><span class="mf">2.5d0</span> <span class="o">&lt;</span> <span class="n">Theta</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Theta</span> <span class="o">&lt;=</span> <span class="mi">6</span><span class="mf">7.5d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10594"></a><span class="k">    </span><span class="n">Hf</span> <span class="o">=</span> <span class="mf">3.34d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">WindAt10m</span><span class="o">**</span><span class="mf">0.84d0</span><span class="p">)</span>
<a name="ln-10595"></a>  <span class="n">ELSEIF</span> <span class="p">((</span><span class="mi">6</span><span class="mf">7.5d0</span> <span class="o">&lt;</span> <span class="n">Theta</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Theta</span> <span class="o">&lt;=</span> <span class="mi">11</span><span class="mf">2.5d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10596"></a><span class="k">    </span><span class="n">Hf</span> <span class="o">=</span> <span class="mf">4.78d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">WindAt10m</span><span class="o">**</span><span class="mf">0.71d0</span><span class="p">)</span>
<a name="ln-10597"></a>  <span class="n">ELSEIF</span> <span class="p">((</span><span class="mi">11</span><span class="mf">2.5d0</span> <span class="o">&lt;</span> <span class="n">Theta</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Theta</span> <span class="o">&lt;=</span> <span class="mi">15</span><span class="mf">7.5d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10598"></a><span class="k">    </span><span class="n">Hf</span> <span class="o">=</span> <span class="mf">4.05d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">WindAt10m</span><span class="o">**</span><span class="mf">0.77d0</span><span class="p">)</span>
<a name="ln-10599"></a>  <span class="n">ELSEIF</span> <span class="p">((</span><span class="mi">15</span><span class="mf">7.5d0</span> <span class="o">&lt;</span> <span class="n">Theta</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Theta</span> <span class="o">&lt;=</span> <span class="mi">18</span><span class="mf">0.d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10600"></a><span class="k">    </span><span class="n">Hf</span> <span class="o">=</span> <span class="mf">3.54d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">WindAt10m</span><span class="o">**</span><span class="mf">0.76d0</span><span class="p">)</span>
<a name="ln-10601"></a>
<a name="ln-10602"></a>  <span class="k">ELSE</span>
<a name="ln-10603"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">ErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10604"></a><span class="k">      CALL </span><span class="n">ShowSevereMessage</span><span class="p">(</span><span class="s1">&#39;CalcEmmelRoof: Convection model wind angle calculation suspect&#39;</span> <span class="p">&amp;</span>
<a name="ln-10605"></a>                               <span class="o">//</span><span class="s1">&#39;(developer issue)&#39;</span> <span class="p">)</span>
<a name="ln-10606"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Value for theta angle = &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Theta</span><span class="p">,</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-10607"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs for surface named = &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-10608"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Convection model uses high theta correlation and the simulation continues&#39;</span><span class="p">)</span>
<a name="ln-10609"></a>    <span class="n">ENDIF</span>
<a name="ln-10610"></a>    <span class="k">CALL </span><span class="n">ShowRecurringSevereErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;CalcEmmelRoof: Convection model wind angle calculation suspect&#39;</span> <span class="p">&amp;</span>
<a name="ln-10611"></a>                             <span class="o">//</span><span class="s1">&#39; and high theta correlation&#39;</span><span class="p">,</span> <span class="n">ErrorIndex</span><span class="p">)</span>
<a name="ln-10612"></a>
<a name="ln-10613"></a>    <span class="n">Hf</span> <span class="o">=</span> <span class="mf">3.54d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">WindAt10m</span><span class="o">**</span><span class="mf">0.76d0</span><span class="p">)</span>
<a name="ln-10614"></a>  <span class="n">ENDIF</span>
<a name="ln-10615"></a>  <span class="k">RETURN</span>
<a name="ln-10616"></a>
<a name="ln-10617"></a><span class="k">END FUNCTION </span><span class="n">CalcEmmelRoof</span>
<a name="ln-10618"></a>
<a name="ln-10619"></a><span class="k">FUNCTION </span><span class="n">CalcClearRoof</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span> <span class="n">SurfTemp</span><span class="p">,</span> <span class="n">AirTemp</span><span class="p">,</span> <span class="n">WindAtZ</span><span class="p">,</span> <span class="n">WindDirect</span><span class="p">,</span> <span class="n">RoofArea</span><span class="p">,</span> <span class="n">RoofPerimeter</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Hc</span><span class="p">)</span>
<a name="ln-10620"></a>
<a name="ln-10621"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-10622"></a>          <span class="c">!       AUTHOR         &lt;author&gt;</span>
<a name="ln-10623"></a>          <span class="c">!       DATE WRITTEN   &lt;date_written&gt;</span>
<a name="ln-10624"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-10625"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10626"></a>
<a name="ln-10627"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-10628"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-10629"></a>
<a name="ln-10630"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-10631"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-10632"></a>
<a name="ln-10633"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-10634"></a>          <span class="c">! na</span>
<a name="ln-10635"></a>
<a name="ln-10636"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-10637"></a>  <span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">OutBaroPress</span><span class="p">,</span> <span class="n">OutHumRat</span>
<a name="ln-10638"></a>  <span class="k">USE </span><span class="n">psychrometrics</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">PsyRhoAirFnPbTdbW</span>
<a name="ln-10639"></a>
<a name="ln-10640"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-10641"></a>
<a name="ln-10642"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-10643"></a>  <span class="kt">INTEGER</span><span class="p">,</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfNum</span>
<a name="ln-10644"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfTemp</span>
<a name="ln-10645"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirTemp</span>
<a name="ln-10646"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WindAtZ</span>
<a name="ln-10647"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WindDirect</span> <span class="c">! Wind direction measured clockwise from geographhic North</span>
<a name="ln-10648"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span> <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RoofArea</span>
<a name="ln-10649"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RoofPerimeter</span>
<a name="ln-10650"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">Hc</span>
<a name="ln-10651"></a>
<a name="ln-10652"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-10653"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">g</span>  <span class="o">=</span> <span class="mf">9.81d0</span>       <span class="c">! gravity constant (m/s**2)</span>
<a name="ln-10654"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">v</span>  <span class="o">=</span> <span class="mi">1</span><span class="mf">5.89d-6</span>   <span class="c">! kinematic viscosity (m**2/s) for air at 300 K</span>
<a name="ln-10655"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">k</span>  <span class="o">=</span> <span class="mf">0.0263d0</span>     <span class="c">! thermal conductivity (W/m K) for air at 300 K</span>
<a name="ln-10656"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Pr</span> <span class="o">=</span> <span class="mf">0.71d0</span>      <span class="c">! Prandtl number for air at ?</span>
<a name="ln-10657"></a>
<a name="ln-10658"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-10659"></a>          <span class="c">! na</span>
<a name="ln-10660"></a>
<a name="ln-10661"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-10662"></a>          <span class="c">! na</span>
<a name="ln-10663"></a>
<a name="ln-10664"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10665"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DeltaTemp</span>
<a name="ln-10666"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Ln</span>
<a name="ln-10667"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RaLn</span> <span class="c">! Rayleigh number</span>
<a name="ln-10668"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GrLn</span> <span class="c">! Grashof number</span>
<a name="ln-10669"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirDensity</span>
<a name="ln-10670"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Rex</span> <span class="c">! Reynolds number</span>
<a name="ln-10671"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">x</span>  <span class="c">! distance to roof edge toward wind direction</span>
<a name="ln-10672"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">eta</span>
<a name="ln-10673"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RfARR</span>
<a name="ln-10674"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Rf</span>
<a name="ln-10675"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BetaFilm</span>
<a name="ln-10676"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ErrorIndex</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-10677"></a>
<a name="ln-10678"></a>  <span class="n">RfARR</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mf">2.10d0</span><span class="p">,</span> <span class="mf">1.67d0</span><span class="p">,</span> <span class="mf">1.52d0</span><span class="p">,</span> <span class="mf">1.13d0</span><span class="p">,</span><span class="mf">1.11d0</span><span class="p">,</span> <span class="mf">1.0d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-10679"></a>
<a name="ln-10680"></a>  <span class="n">Rf</span> <span class="o">=</span> <span class="n">RfARR</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="n">Roughness</span><span class="p">)</span>
<a name="ln-10681"></a>  <span class="c">!find x, don&#39;t know x. avoid time consuming geometry algorithm</span>
<a name="ln-10682"></a>  <span class="n">x</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="n">RoofArea</span><span class="p">)</span><span class="o">/</span><span class="mf">2.d0</span> <span class="c">! quick simplification, geometry routines to develop</span>
<a name="ln-10683"></a>
<a name="ln-10684"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">RoofPerimeter</span> <span class="o">&gt;</span><span class="mf">0.d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10685"></a><span class="k">    </span><span class="n">Ln</span> <span class="o">=</span> <span class="n">RoofArea</span> <span class="o">/</span> <span class="n">RoofPerimeter</span>
<a name="ln-10686"></a>  <span class="k">ELSE</span>
<a name="ln-10687"></a><span class="k">    </span><span class="n">Ln</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="n">RoofArea</span><span class="p">)</span>
<a name="ln-10688"></a>  <span class="n">ENDIF</span>
<a name="ln-10689"></a>  <span class="n">DeltaTemp</span> <span class="o">=</span> <span class="n">SurfTemp</span> <span class="o">-</span> <span class="n">AirTemp</span>
<a name="ln-10690"></a>  <span class="n">BetaFilm</span> <span class="o">=</span> <span class="mf">1.d0</span> <span class="o">/</span> <span class="p">(</span><span class="n">KelvinConv</span> <span class="o">+</span> <span class="n">SurfTemp</span> <span class="o">+</span> <span class="mf">0.5d0</span> <span class="o">*</span> <span class="n">DeltaTemp</span><span class="p">)</span>
<a name="ln-10691"></a>  <span class="n">AirDensity</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="n">AirTemp</span><span class="p">,</span><span class="n">OutHumRat</span><span class="p">)</span>
<a name="ln-10692"></a>
<a name="ln-10693"></a>  <span class="n">GrLn</span> <span class="o">=</span> <span class="n">g</span> <span class="o">*</span> <span class="p">(</span><span class="n">AirDensity</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">Ln</span><span class="o">**</span><span class="mi">3</span> <span class="p">)</span> <span class="o">*</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaTemp</span><span class="p">)</span> <span class="o">*</span> <span class="n">BetaFilm</span> <span class="o">/</span> <span class="n">v</span><span class="o">**</span><span class="mi">2</span>
<a name="ln-10694"></a>  <span class="n">RaLn</span> <span class="o">=</span> <span class="n">GrLn</span> <span class="o">*</span> <span class="n">Pr</span>
<a name="ln-10695"></a>
<a name="ln-10696"></a>  <span class="n">Rex</span> <span class="o">=</span> <span class="n">WindAtZ</span> <span class="o">*</span> <span class="n">AirDensity</span> <span class="o">*</span> <span class="n">x</span> <span class="o">/</span> <span class="n">v</span>
<a name="ln-10697"></a>
<a name="ln-10698"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Rex</span> <span class="o">&gt;</span> <span class="mf">0.1d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">!avoid zero and crazy small denominators</span>
<a name="ln-10699"></a>    <span class="n">eta</span> <span class="o">=</span> <span class="p">(</span><span class="nb">log</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">+</span><span class="n">GrLn</span><span class="o">/</span><span class="n">Rex</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0d0</span> <span class="o">+</span> <span class="nb">Log</span><span class="p">(</span><span class="mf">1.0d0</span> <span class="o">+</span> <span class="n">GrLn</span><span class="o">/</span><span class="p">(</span><span class="n">Rex</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-10700"></a>  <span class="k">ELSE</span>
<a name="ln-10701"></a><span class="k">    </span><span class="n">eta</span> <span class="o">=</span> <span class="mf">1.d0</span> <span class="c">! forced convection gone because no wind</span>
<a name="ln-10702"></a>  <span class="n">ENDIF</span>
<a name="ln-10703"></a>
<a name="ln-10704"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10705"></a><span class="k">    </span><span class="n">Hc</span> <span class="o">=</span> <span class="n">eta</span> <span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">/</span><span class="n">Ln</span><span class="p">)</span><span class="o">*</span><span class="mf">0.15d0</span><span class="o">*</span><span class="p">(</span><span class="n">RaLn</span><span class="o">**</span><span class="n">OneThird</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">k</span><span class="o">/</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">Rf</span><span class="o">*</span><span class="mf">0.0296d0</span><span class="o">*</span><span class="p">(</span><span class="n">Rex</span><span class="o">**</span><span class="n">FourFifths</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Pr</span><span class="o">**</span><span class="n">OneThird</span><span class="p">)</span>
<a name="ln-10706"></a>  <span class="k">ELSE</span>
<a name="ln-10707"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">ErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10708"></a><span class="k">      CALL </span><span class="n">ShowSevereMessage</span><span class="p">(</span><span class="s1">&#39;CalcClearRoof: Convection model not evaluated (bad value for distance to roof edge)&#39;</span><span class="p">)</span>
<a name="ln-10709"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Value for distance to roof edge =&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-10710"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs for surface named = &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-10711"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Convection surface heat transfer coefficient set to 9.999 [W/m2-K] and the simulation continues&#39;</span><span class="p">)</span>
<a name="ln-10712"></a>    <span class="n">ENDIF</span>
<a name="ln-10713"></a>    <span class="k">CALL </span><span class="n">ShowRecurringSevereErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;CalcClearRoof: Convection model not evaluated because &#39;</span> <span class="p">&amp;</span>
<a name="ln-10714"></a>                                       <span class="o">//</span><span class="s1">&#39;bad value for distance to roof edge and set to 9.999 [W/m2-k]&#39;</span> <span class="p">,</span> <span class="n">ErrorIndex</span><span class="p">)</span>
<a name="ln-10715"></a>    <span class="n">Hc</span> <span class="o">=</span> <span class="mf">9.9999d0</span> <span class="c">! safe but noticeable</span>
<a name="ln-10716"></a>  <span class="n">ENDIf</span>
<a name="ln-10717"></a>  <span class="k">RETURN</span>
<a name="ln-10718"></a>
<a name="ln-10719"></a><span class="k">END FUNCTION </span><span class="n">CalcClearRoof</span>
<a name="ln-10720"></a>
<a name="ln-10721"></a><span class="c">!     NOTICE</span>
<a name="ln-10722"></a><span class="c">!</span>
<a name="ln-10723"></a><span class="c">!     Copyright © 1996-2013 The Board of Trustees of the University of Illinois</span>
<a name="ln-10724"></a><span class="c">!     and The Regents of the University of California through Ernest Orlando Lawrence</span>
<a name="ln-10725"></a><span class="c">!     Berkeley National Laboratory.  All rights reserved.</span>
<a name="ln-10726"></a><span class="c">!</span>
<a name="ln-10727"></a><span class="c">!     Portions of the EnergyPlus software package have been developed and copyrighted</span>
<a name="ln-10728"></a><span class="c">!     by other individuals, companies and institutions.  These portions have been</span>
<a name="ln-10729"></a><span class="c">!     incorporated into the EnergyPlus software package under license.   For a complete</span>
<a name="ln-10730"></a><span class="c">!     list of contributors, see &quot;Notice&quot; located in EnergyPlus.f90.</span>
<a name="ln-10731"></a><span class="c">!</span>
<a name="ln-10732"></a><span class="c">!     NOTICE: The U.S. Government is granted for itself and others acting on its</span>
<a name="ln-10733"></a><span class="c">!     behalf a paid-up, nonexclusive, irrevocable, worldwide license in this data to</span>
<a name="ln-10734"></a><span class="c">!     reproduce, prepare derivative works, and perform publicly and display publicly.</span>
<a name="ln-10735"></a><span class="c">!     Beginning five (5) years after permission to assert copyright is granted,</span>
<a name="ln-10736"></a><span class="c">!     subject to two possible five year renewals, the U.S. Government is granted for</span>
<a name="ln-10737"></a><span class="c">!     itself and others acting on its behalf a paid-up, non-exclusive, irrevocable</span>
<a name="ln-10738"></a><span class="c">!     worldwide license in this data to reproduce, prepare derivative works,</span>
<a name="ln-10739"></a><span class="c">!     distribute copies to the public, perform publicly and display publicly, and to</span>
<a name="ln-10740"></a><span class="c">!     permit others to do so.</span>
<a name="ln-10741"></a><span class="c">!</span>
<a name="ln-10742"></a><span class="c">!     TRADEMARKS: EnergyPlus is a trademark of the US Department of Energy.</span>
<a name="ln-10743"></a><span class="c">!</span>
<a name="ln-10744"></a>
<a name="ln-10745"></a><span class="k">END MODULE </span><span class="n">ConvectionCoefficients</span>
</pre></div>

    </section>
    </div>
  </div>

  <section class="visible-xs visible-sm hidden-md">
    <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-1">All Source Files</a></h3></div>
  <div id="allfiles-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


  </section>

    <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2017 </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by
            <a href="https://github.com/cmacmackin/ford">FORD</a>

          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> EnergyPlusFortran</p></div>
      </div>
      <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': {
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>
