<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

	 <meta name="description" content="">

    <meta name="author" content="dmey (forked from NREL)" >
    <link rel="icon" href="../favicon.png">

    <title>HeatBalFiniteDifferenceManager.f90 &ndash; EnergyPlusFortran</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>


    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>


  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">EnergyPlusFortran <small>8.1.0.009</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">

            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
		 aria-expanded="false">Contents <span class="caret"></span></a>
	      <ul class="dropdown-menu">

            <li><a href="../lists/files.html">Source Files</a></li>


            <li><a href="../lists/modules.html">Modules</a></li>


            <li><a href="../lists/procedures.html">Procedures</a></li>


            <li><a href="../lists/types.html">Derived Types</a></li>


            <li><a href="../program/energyplus.html">Program</a></li>

            </ul>
            </li>

<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/energyplus.html">Program</a></li>

          </ul>


        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">


  <div class="row">
    <h1>HeatBalFiniteDifferenceManager.f90
    <small>Source File</small>

    </h1>

<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">


     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
	  data-placement="bottom" data-html="true"
	  title=" 0.4% of total for source files.">1358 statements</a>
     </li>


    <li><i class="fa fa-code"></i><a href="../src/HeatBalFiniteDifferenceManager.f90"> Source File</a></li>

  </ul>
  <ol class="breadcrumb in-well text-right">

     <li class="active">HeatBalFiniteDifferenceManager.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">

<div id="sidebar">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/heatbalfinitediffmanager.html">HeatBalFiniteDiffManager</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html#src">HeatBalFiniteDifferenceManager.f90</a>
  </div>
</div>


  <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-0">All Source Files</a></h3></div>
  <div id="allfiles-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


</div>

    </div>
    <div class="col-md-9" id='text'>


    <h3>This File Depends On</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefileheatbalfinitedifferencemanagerf90EfferentGraph" width="641pt" height="384pt"
 viewBox="0.00 0.00 641.00 383.88" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph" class="graph" transform="scale(.409 .409) rotate(0) translate(4 934.522)">
<title>sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-934.522 1563.1262,-934.522 1563.1262,4 -4,4"/>
<!-- sourcefile~heatbalfinitedifferencemanager.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~heatbalfinitedifferencemanager.f90</title>
<polygon fill="none" stroke="#000000" points="1559.1671,-610.0791 1378.0035,-610.0791 1378.0035,-588.0682 1559.1671,-588.0682 1559.1671,-610.0791"/>
<text text-anchor="middle" x="1468.5853" y="-595.9236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">HeatBalFiniteDifferenceManager.f90</text>
</g>
<!-- sourcefile~datamoisturebalance.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~datamoisturebalance.f90</title>
<g id="a_sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node2"><a xlink:href="../sourcefile/datamoisturebalance.f90.html" xlink:title="DataMoistureBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="820.3223,-894.0791 690.5234,-894.0791 690.5234,-872.0682 820.3223,-872.0682 820.3223,-894.0791"/>
<text text-anchor="middle" x="755.4229" y="-879.9236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataMoistureBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datamoisturebalance.f90&#45;&gt;sourcefile~heatbalfinitedifferencemanager.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge85" class="edge">
<title>sourcefile~datamoisturebalance.f90&#45;&gt;sourcefile~heatbalfinitedifferencemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M820.5794,-882.3386C886.2224,-879.9387 989.6846,-871.5812 1074.6888,-844.0736"/>
</g>
<!-- sourcefile~general.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~general.f90</title>
<g id="a_sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node3"><a xlink:href="../sourcefile/general.f90.html" xlink:title="General.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="788.7916,-497.0791 722.0541,-497.0791 722.0541,-475.0682 788.7916,-475.0682 788.7916,-497.0791"/>
<text text-anchor="middle" x="755.4229" y="-482.9236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">General.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~heatbalfinitedifferencemanager.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge86" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~heatbalfinitedifferencemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M786.0842,-475.0055C797.0064,-470.8704 809.332,-465.982 820.3726,-461.0736 865.2763,-441.1103 870.0004,-414.9392 918.9895,-411.0736"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M918.9895,-411.0736C987.9748,-405.6303 1024.5252,-363.4059 1074.6888,-411.0736"/>
</g>
<!-- sourcefile~psychroutines.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~psychroutines.f90</title>
<g id="a_sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node6"><a xlink:href="../sourcefile/psychroutines.f90.html" xlink:title="PsychRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1124.2377,-509.0791 1025.14,-509.0791 1025.14,-487.0682 1124.2377,-487.0682 1124.2377,-509.0791"/>
<text text-anchor="middle" x="1074.6888" y="-494.9236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PsychRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M918.9895,-411.0736C975.1804,-406.6398 1030.1836,-452.4991 1057.2778,-479.3705"/>
<polygon fill="#65ff00" stroke="#65ff00" points="1054.9631,-482.0093 1064.4598,-486.7064 1059.965,-477.1122 1054.9631,-482.0093"/>
</g>
<!-- sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~dataheatbalance.f90</title>
<g id="a_sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node14"><a xlink:href="../sourcefile/dataheatbalance.f90.html" xlink:title="DataHeatBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1130.5056,-662.0791 1018.872,-662.0791 1018.872,-640.0682 1130.5056,-640.0682 1130.5056,-662.0791"/>
<text text-anchor="middle" x="1074.6888" y="-647.9236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge58" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M776.8665,-497.156C832.1881,-525.7467 979.8796,-602.0752 1044.1275,-635.2792"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="1042.8478,-638.5576 1053.3385,-640.0395 1046.0617,-632.339 1042.8478,-638.5576"/>
</g>
<!-- sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~dataenvironment.f90</title>
<g id="a_sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node16"><a xlink:href="../sourcefile/dataenvironment.f90.html" xlink:title="DataEnvironment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="974.1275,-345.0791 863.8515,-345.0791 863.8515,-323.0682 974.1275,-323.0682 974.1275,-345.0791"/>
<text text-anchor="middle" x="918.9895" y="-330.9236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEnvironment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge81" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M788.8698,-478.1096C799.7981,-474.2968 811.4155,-468.8181 820.3726,-461.0736 845.06,-439.7284 836.6903,-423.1062 856.3726,-397.0736 868.8494,-380.5712 885.4456,-364.0634 898.4172,-352.0879"/>
<polygon fill="#ff0066" stroke="#ff0066" points="900.8952,-354.5657 905.9562,-345.2578 896.1953,-349.3781 900.8952,-354.5657"/>
</g>
<!-- sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node22" class="node">
<title>sourcefile~schedulemanager.f90</title>
<g id="a_sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node22"><a xlink:href="../sourcefile/schedulemanager.f90.html" xlink:title="ScheduleManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1131.8538,-345.0791 1017.5239,-345.0791 1017.5239,-323.0682 1131.8538,-323.0682 1131.8538,-345.0791"/>
<text text-anchor="middle" x="1074.6888" y="-330.9236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ScheduleManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M763.2143,-474.7981C775.817,-456.3804 801.1965,-418.5362 820.3726,-385.0736 837.9638,-354.3767 826.2243,-332.5894 856.3726,-314.0736 913.4798,-279.0007 995.3114,-301.6367 1040.8391,-319.1883"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1039.6655,-322.4883 1050.2505,-322.9449 1042.2606,-315.9871 1039.6655,-322.4883"/>
</g>
<!-- sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~datasurfaces.f90</title>
<g id="a_sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node4"><a xlink:href="../sourcefile/datasurfaces.f90.html" xlink:title="DataSurfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="632.3482,-701.0791 539.0902,-701.0791 539.0902,-679.0682 632.3482,-679.0682 632.3482,-701.0791"/>
<text text-anchor="middle" x="585.7192" y="-686.9236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSurfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~heatbalfinitedifferencemanager.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge87" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~heatbalfinitedifferencemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1074.6888,-690.0736C1148.3463,-658.6068 1175.2647,-698.5912 1254.9078,-690.0736"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M594.5703,-678.9333C612.4653,-656.4636 654.3226,-604.1786 690.4731,-561.0736 706.723,-541.6977 725.6958,-519.879 738.924,-504.7917"/>
<polygon fill="#ff6600" stroke="#ff6600" points="741.6575,-506.9833 745.6283,-497.1607 736.3987,-502.3632 741.6575,-506.9833"/>
</g>
<!-- sourcefile~heatbalancemovableinsulation.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~heatbalancemovableinsulation.f90</title>
<g id="a_sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node12"><a xlink:href="../sourcefile/heatbalancemovableinsulation.f90.html" xlink:title="HeatBalanceMovableInsulation.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1342.1812,-435.0791 1167.6344,-435.0791 1167.6344,-413.0682 1342.1812,-413.0682 1342.1812,-435.0791"/>
<text text-anchor="middle" x="1254.9078" y="-420.9236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceMovableInsulation.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~heatbalancemovableinsulation.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~heatbalancemovableinsulation.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1074.6888,-690.0736C1100.0876,-681.7163 1111.5781,-688.6002 1131.7712,-671.0736 1204.2848,-608.1356 1238.7251,-492.384 1250.266,-445.0658"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1253.6779,-445.8462 1252.5533,-435.3112 1246.8627,-444.2481 1253.6779,-445.8462"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M632.3971,-699.5014C721.2019,-715.4124 919.4618,-741.1502 1074.6888,-690.0736"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge59" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M618.7262,-679.0136C652.5778,-668.4993 706.9844,-653.8828 755.4229,-651.0736"/>
</g>
<!-- sourcefile~dataheatbalsurface.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~dataheatbalsurface.f90</title>
<g id="a_sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node5"><a xlink:href="../sourcefile/dataheatbalsurface.f90.html" xlink:title="DataHeatBalSurface.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="981.7236,-855.0791 856.2554,-855.0791 856.2554,-833.0682 981.7236,-833.0682 981.7236,-855.0791"/>
<text text-anchor="middle" x="918.9895" y="-840.9236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalSurface.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~heatbalfinitedifferencemanager.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge88" class="edge">
<title>sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~heatbalfinitedifferencemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M981.742,-852.7838C1010.6895,-854.6165 1045.1131,-853.6444 1074.6888,-844.0736"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~heatbalfinitedifferencemanager.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge89" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~heatbalfinitedifferencemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1081.7752,-509.2801C1108.6303,-551.1017 1205.1315,-695.3971 1254.9078,-690.0736"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~dataprecisionglobals.f90</title>
<g id="a_sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node7"><a xlink:href="../sourcefile/dataprecisionglobals.f90.html" xlink:title="DataPrecisionGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="130.719,-660.0791 -.2403,-660.0791 -.2403,-638.0682 130.719,-638.0682 130.719,-660.0791"/>
<text text-anchor="middle" x="65.2394" y="-645.9236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPrecisionGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~heatbalfinitedifferencemanager.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge90" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~heatbalfinitedifferencemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-922.0736C802.5964,-899.5293 871.4351,-961.0158 1074.6888,-882.0736"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1074.6888,-882.0736C1100.4619,-872.4215 1110.168,-875.1239 1131.7712,-858.0736 1204.4401,-800.72 1162.8574,-699.9182 1254.9078,-690.0736"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datamoisturebalance.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datamoisturebalance.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-922.0736C627.7769,-917.3031 674.5938,-906.0845 708.3829,-896.8983"/>
<polygon fill="#ff0000" stroke="#ff0000" points="709.7245,-900.1588 718.4312,-894.122 707.8602,-893.4116 709.7245,-900.1588"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M223.8406,-455.0736C261.6037,-423.7158 270.5645,-498.7677 317.2024,-514.0736 430.8764,-551.3799 466.4923,-542.9969 585.7192,-533.0736"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ffcc00" stroke-dasharray="5,2" d="M223.8406,-747.0736C267.6766,-757.8538 272.9817,-777.9995 317.2024,-787.0736 388.5003,-801.704 419.052,-825.3382 480.9653,-787.0736 511.3991,-768.2645 490.2563,-738.8776 516.9653,-715.0736 521.1136,-711.3765 525.8521,-708.2129 530.8579,-705.5084"/>
<polygon fill="#ffcc00" stroke="#ffcc00" points="532.559,-708.5752 540.0872,-701.1202 529.5531,-702.2534 532.559,-708.5752"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalsurface.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalsurface.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M585.7192,-922.0736C638.8127,-916.0514 639.3934,-878.7596 690.4731,-863.0736 740.8898,-847.5913 800.3236,-843.0449 845.9397,-842.2619"/>
<polygon fill="#cbff00" stroke="#cbff00" points="846.0835,-845.7606 856.0426,-842.1458 846.003,-838.7611 846.0835,-845.7606"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M399.0839,-922.0736C479.683,-902.4694 503.2147,-930.6499 585.7192,-922.0736"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M399.0839,-922.0736C435.9323,-913.111 448.7406,-918.0662 480.9653,-898.0736 577.5833,-838.1307 590.1086,-803.8041 654.4731,-710.0736 674.9512,-680.2526 663.5136,-661.1946 690.4731,-637.0736 693.8432,-634.0584 935.8091,-547.5873 1033.9797,-512.5789"/>
<polygon fill="#65ff00" stroke="#65ff00" points="1035.3262,-515.8147 1043.57,-509.1595 1032.9753,-509.2212 1035.3262,-515.8147"/>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M67.0286,-660.3232C73.3543,-696.233 98.0832,-809.0361 166.4788,-865.0736 248.8121,-932.5305 294.1359,-939.826 399.0839,-922.0736"/>
</g>
<!-- sourcefile~dataglobals.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~dataglobals.f90</title>
<g id="a_sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node8"><a xlink:href="../sourcefile/dataglobals.f90.html" xlink:title="DataGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="267.6355,-582.0791 180.0456,-582.0791 180.0456,-560.0682 267.6355,-560.0682 267.6355,-582.0791"/>
<text text-anchor="middle" x="223.8406" y="-567.9236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M87.6267,-638.0636C114.9427,-624.6295 161.3011,-601.8305 192.2418,-586.6139"/>
<polygon fill="#00ff66" stroke="#00ff66" points="193.882,-589.7077 201.3109,-582.1537 190.7928,-583.4262 193.882,-589.7077"/>
</g>
<!-- sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~dataipshortcuts.f90</title>
<g id="a_sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node9"><a xlink:href="../sourcefile/dataipshortcuts.f90.html" xlink:title="DataIPShortCuts.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="453.3838,-427.0791 344.7839,-427.0791 344.7839,-405.0682 453.3838,-405.0682 453.3838,-427.0791"/>
<text text-anchor="middle" x="399.0839" y="-412.9236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataIPShortCuts.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M223.8406,-455.0736C254.6118,-429.4728 298.6122,-419.743 334.8246,-416.4032"/>
<polygon fill="#00ffcb" stroke="#00ffcb" points="335.1173,-419.8911 344.8143,-415.6228 334.5721,-412.9124 335.1173,-419.8911"/>
</g>
<!-- sourcefile~dataairflownetwork.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~dataairflownetwork.f90</title>
<g id="a_sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node10"><a xlink:href="../sourcefile/dataairflownetwork.f90.html" xlink:title="DataAirflowNetwork.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="459.7908,-778.0791 338.377,-778.0791 338.377,-756.0682 459.7908,-756.0682 459.7908,-778.0791"/>
<text text-anchor="middle" x="399.0839" y="-763.9236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataAirflowNetwork.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairflownetwork.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairflownetwork.f90</title>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M223.8406,-747.0736C257.5145,-755.3547 295.6885,-760.223 327.7918,-763.0774"/>
<polygon fill="#00cbff" stroke="#00cbff" points="327.73,-766.5845 337.9882,-763.9352 328.3169,-759.6091 327.73,-766.5845"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~dataheatbalfansys.f90</title>
<g id="a_sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node11"><a xlink:href="../sourcefile/dataheatbalfansys.f90.html" xlink:title="DataHeatBalFanSys.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1317.0526,-893.0791 1192.763,-893.0791 1192.763,-871.0682 1317.0526,-871.0682 1317.0526,-893.0791"/>
<text text-anchor="middle" x="1254.9078" y="-878.9236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalFanSys.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalfansys.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalfansys.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M1074.6888,-882.0736C1108.3886,-868.9849 1148.3817,-867.7115 1182.1218,-870.2541"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1182.1098,-873.7664 1192.3781,-871.1568 1182.7236,-866.7934 1182.1098,-873.7664"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~heatbalancemovableinsulation.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~heatbalancemovableinsulation.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M399.0839,-23.0736C555.1972,-49.864 601.3867,7.8311 755.4229,-29.0736"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M66.3323,-637.7532C73.3079,-566.9087 113.0171,-184.2354 166.4788,-81.0736 183.1604,-48.8841 194.0396,-43.7217 223.8406,-23.0736"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M223.8406,-23.0736C287.861,21.2839 322.3201,-9.9003 399.0839,-23.0736"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M755.4229,-29.0736C931.1768,-71.1816 998.7272,-60.7551 1131.7712,-183.0736 1200.7775,-246.5169 1237.0136,-357.4437 1249.6462,-403.3128"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1246.2788,-404.2694 1252.234,-413.0322 1253.0432,-402.4683 1246.2788,-404.2694"/>
</g>
<!-- sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~datainterfaces.f90</title>
<g id="a_sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node13"><a xlink:href="../sourcefile/datainterfaces.f90.html" xlink:title="DataInterfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="447.8836,-151.0791 350.2841,-151.0791 350.2841,-129.0682 447.8836,-129.0682 447.8836,-151.0791"/>
<text text-anchor="middle" x="399.0839" y="-136.9236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataInterfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge52" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90</title>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M223.8406,-455.0736C327.93,-368.474 220.7361,-260.0913 317.2024,-165.0736 323.7346,-158.6395 331.8732,-153.8546 340.4646,-150.2977"/>
<polygon fill="#6500ff" stroke="#6500ff" points="341.6853,-153.5782 349.9105,-146.9 339.316,-146.9913 341.6853,-153.5782"/>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M72.2464,-637.7376C92.4652,-605.7306 153.9454,-513.2245 223.8406,-455.0736"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge60" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M223.8406,-747.0736C304.7071,-766.6362 502.5631,-653.7442 585.7192,-651.0736"/>
</g>
<!-- sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~inputprocessor.f90</title>
<g id="a_sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node15"><a xlink:href="../sourcefile/inputprocessor.f90.html" xlink:title="InputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="635.2783,-344.0791 536.1602,-344.0791 536.1602,-322.0682 635.2783,-322.0682 635.2783,-344.0791"/>
<text text-anchor="middle" x="585.7192" y="-329.9236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">InputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge74" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00cb" stroke-dasharray="5,2" d="M223.8406,-455.0736C305.1373,-387.3508 228.9244,-294.405 317.2024,-236.0736 377.9267,-195.9489 419.052,-197.8091 480.9653,-236.0736 511.3991,-254.8828 490.2563,-284.2697 516.9653,-308.0736 521.1136,-311.7707 525.8521,-314.9343 530.8579,-317.6388"/>
<polygon fill="#ff00cb" stroke="#ff00cb" points="529.5531,-320.8939 540.0872,-322.0271 532.559,-314.5721 529.5531,-320.8939"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge84" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M399.0839,-23.0736C435.7464,-30.2521 448.7115,-23.2226 480.9653,-42.0736 540.5135,-76.8771 631.651,-235.0568 690.4731,-271.0736 740.4412,-301.6691 805.5097,-317.7192 853.4277,-325.9396"/>
<polygon fill="#ff0066" stroke="#ff0066" points="852.9453,-329.4072 863.3809,-327.5773 854.0819,-322.5001 852.9453,-329.4072"/>
</g>
<!-- sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~datahvacglobals.f90</title>
<g id="a_sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node17"><a xlink:href="../sourcefile/datahvacglobals.f90.html" xlink:title="DataHVACGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="456.7769,-505.0791 341.3908,-505.0791 341.3908,-483.0682 456.7769,-483.0682 456.7769,-505.0791"/>
<text text-anchor="middle" x="399.0839" y="-490.9236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHVACGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-455.0736C233.8157,-446.7746 304.9669,-465.7753 353.4835,-480.0706"/>
<polygon fill="#ff0000" stroke="#ff0000" points="352.5784,-483.4529 363.1612,-482.9477 354.5732,-476.7431 352.5784,-483.4529"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~dataruntimelanguage.f90</title>
<g id="a_sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node18"><a xlink:href="../sourcefile/dataruntimelanguage.f90.html" xlink:title="DataRuntimeLanguage.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="654.2279,-481.0791 517.2105,-481.0791 517.2105,-459.0682 654.2279,-459.0682 654.2279,-481.0791"/>
<text text-anchor="middle" x="585.7192" y="-466.9236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRuntimeLanguage.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M223.8406,-455.0736C245.0458,-437.4315 407.2037,-451.0222 507.121,-461.318"/>
<polygon fill="#00ff00" stroke="#00ff00" points="506.8784,-464.8115 517.1871,-462.3657 507.6032,-457.8492 506.8784,-464.8115"/>
</g>
<!-- sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~datavectortypes.f90</title>
<g id="a_sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node20"><a xlink:href="../sourcefile/datavectortypes.f90.html" xlink:title="DataVectorTypes.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="278.8255,-856.0791 168.8556,-856.0791 168.8556,-834.0682 278.8255,-834.0682 278.8255,-856.0791"/>
<text text-anchor="middle" x="223.8406" y="-841.9236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataVectorTypes.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M74.2209,-660.173C100.1603,-692.2291 175.4232,-785.2393 208.2376,-825.7914"/>
<polygon fill="#ff0000" stroke="#ff0000" points="205.5513,-828.0357 214.5625,-833.6078 210.9929,-823.6324 205.5513,-828.0357"/>
</g>
<!-- sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node21" class="node">
<title>sourcefile~databsdfwindow.f90</title>
<g id="a_sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node21"><a xlink:href="../sourcefile/databsdfwindow.f90.html" xlink:title="DataBSDFWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="457.5516,-856.0791 340.6161,-856.0791 340.6161,-834.0682 457.5516,-834.0682 457.5516,-856.0791"/>
<text text-anchor="middle" x="399.0839" y="-841.9236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBSDFWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-747.0736C274.9893,-759.6521 270.4813,-795.7519 317.2024,-820.0736 325.2384,-824.257 334.0896,-827.8655 342.9123,-830.9357"/>
<polygon fill="#00ffff" stroke="#00ffff" points="341.8419,-834.2681 352.4347,-834.0578 344.0228,-827.6164 341.8419,-834.2681"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.4229,-29.0736C851.9313,-52.1956 827.093,-143.6098 918.9895,-181.0736"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M918.9895,-181.0736C985.6743,-208.2593 1039.1471,-279.3833 1062.2811,-314.2399"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1059.3644,-316.1749 1067.744,-322.6583 1065.2364,-312.3645 1059.3644,-316.1749"/>
</g>
<!-- sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node23" class="node">
<title>sourcefile~datasystemvariables.f90</title>
<g id="a_sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node23"><a xlink:href="../sourcefile/datasystemvariables.f90.html" xlink:title="DataSystemVariables.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.7837,-73.0791 334.3841,-73.0791 334.3841,-51.0682 463.7837,-51.0682 463.7837,-73.0791"/>
<text text-anchor="middle" x="399.0839" y="-58.9236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSystemVariables.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-23.0736C234.4466,-15.725 304.6546,-34.2011 352.9207,-48.1674"/>
<polygon fill="#ff0000" stroke="#ff0000" points="351.9771,-51.538 362.5573,-50.9799 353.9383,-44.8183 351.9771,-51.538"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node24" class="node">
<title>sourcefile~datacomplexfenestration.f90</title>
<g id="a_sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node24"><a xlink:href="../sourcefile/datacomplexfenestration.f90.html" xlink:title="DataComplexFenestration.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="475.0737,-621.0791 323.0941,-621.0791 323.0941,-599.0682 475.0737,-599.0682 475.0737,-621.0791"/>
<text text-anchor="middle" x="399.0839" y="-606.9236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataComplexFenestration.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge54" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-747.0736C288.1054,-762.8776 261.5602,-666.9023 317.2024,-631.0736 320.7421,-628.7944 324.5167,-626.7622 328.4292,-624.9504"/>
<polygon fill="#ff0000" stroke="#ff0000" points="329.8465,-628.152 337.7626,-621.1103 327.183,-621.6785 329.8465,-628.152"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M77.1401,-660.2035C101.9944,-682.5264 162.2361,-731.9238 223.8406,-747.0736"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node25" class="node">
<title>sourcefile~dataequivalentlayerwindow.f90</title>
<g id="a_sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node25"><a xlink:href="../sourcefile/dataequivalentlayerwindow.f90.html" xlink:title="DataEquivalentLayerWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="480.847,-662.0791 317.3208,-662.0791 317.3208,-640.0682 480.847,-640.0682 480.847,-662.0791"/>
<text text-anchor="middle" x="399.0839" y="-647.9236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEquivalentLayerWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge56" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-747.0736C255.8632,-754.9486 336.9764,-698.1784 376.6031,-668.4385"/>
<polygon fill="#00ffff" stroke="#00ffff" points="378.9868,-671.0236 384.8429,-662.1943 374.7589,-665.4446 378.9868,-671.0236"/>
</g>
<!-- sourcefile~datasizing.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node28" class="node">
<title>sourcefile~datasizing.f90</title>
<g id="a_sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node28"><a xlink:href="../sourcefile/datasizing.f90.html" xlink:title="DataSizing.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="439.3754,-267.0791 358.7923,-267.0791 358.7923,-245.0682 439.3754,-245.0682 439.3754,-267.0791"/>
<text text-anchor="middle" x="399.0839" y="-252.9236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSizing.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge71" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M223.8406,-455.0736C292.5138,-397.9394 247.1481,-332.5058 317.2024,-277.0736 326.2816,-269.8895 337.5409,-265.1389 348.7746,-262.0042"/>
<polygon fill="#0000ff" stroke="#0000ff" points="349.6802,-265.3863 358.5845,-259.6449 348.0433,-258.5804 349.6802,-265.3863"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~heatbalfinitedifferencemanager.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge91" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~heatbalfinitedifferencemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.4229,-575.0736C918.8452,-531.5939 970.0808,-581.5404 1131.7712,-631.0736 1189.7948,-648.8489 1194.5668,-696.5269 1254.9078,-690.0736"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M399.0839,-571.0736C481.3825,-560.555 502.7513,-575.2437 585.7192,-575.0736"/>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M585.7192,-575.0736C646.2336,-574.9496 706.4301,-530.0685 736.2086,-504.0965"/>
<polygon fill="#ff6600" stroke="#ff6600" points="738.6576,-506.6018 743.7761,-497.3254 733.9899,-501.3852 738.6576,-506.6018"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ffcc00" stroke-dasharray="5,2" d="M230.2987,-582.3375C243.443,-604.0347 275.6157,-651.2317 317.2024,-671.0736 384.5069,-703.1861 472.2319,-702.6481 528.7716,-697.6864"/>
<polygon fill="#ffcc00" stroke="#ffcc00" points="529.3314,-701.1489 538.9539,-696.7153 528.6667,-694.1806 529.3314,-701.1489"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M918.9895,-498.0736C948.3328,-483.4491 984.8215,-482.6823 1015.0981,-485.9249"/>
<polygon fill="#65ff00" stroke="#65ff00" points="1014.754,-489.409 1025.1083,-487.1641 1015.6141,-482.462 1014.754,-489.409"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M233.3103,-559.9442C249.5241,-541.1967 284.0673,-502.5776 317.2024,-474.0736 334.8083,-458.9285 356.2824,-443.8285 372.8215,-432.8337"/>
<polygon fill="#00ffcb" stroke="#00ffcb" points="375.0062,-435.5864 381.4464,-427.1736 371.1656,-429.7341 375.0062,-435.5864"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairflownetwork.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairflownetwork.f90</title>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M230.0982,-582.2471C243.8512,-606.2275 278.578,-663.721 317.2024,-704.0736 334.1006,-721.728 356.2056,-738.4358 373.1884,-750.2038"/>
<polygon fill="#00cbff" stroke="#00cbff" points="371.3099,-753.1589 381.5476,-755.8862 375.2452,-747.3698 371.3099,-753.1589"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge61" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M585.7192,-575.0736C668.361,-574.9042 672.8694,-654.8963 755.4229,-651.0736"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M755.4229,-651.0736C842.9304,-647.0216 944.0742,-647.9727 1008.6649,-649.2938"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="1008.6373,-652.794 1018.7097,-649.5083 1008.7868,-645.7956 1008.6373,-652.794"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge75" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00cb" stroke-dasharray="5,2" d="M230.4083,-559.863C241.2829,-541.199 263.5776,-502.5004 281.2024,-469.0736 298.0747,-437.0741 288.8548,-418.5471 317.2024,-396.0736 375.7523,-349.6562 408.2351,-375.1904 480.9653,-358.0736 496.7908,-354.3492 513.951,-350.2706 529.7136,-346.5081"/>
<polygon fill="#ff00cb" stroke="#ff00cb" points="530.929,-349.8163 539.8419,-344.0882 529.3023,-343.0079 530.929,-349.8163"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge82" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M585.7192,-575.0736C661.1429,-574.919 682.5347,-594.4661 755.4229,-575.0736"/>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M755.4229,-575.0736C843.3135,-551.6897 808.783,-474.5772 856.3726,-397.0736 867.0642,-379.6613 883.4626,-363.3966 896.7962,-351.756"/>
<polygon fill="#ff0066" stroke="#ff0066" points="899.248,-354.2665 904.6238,-345.1368 894.728,-348.9214 899.248,-354.2665"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M248.9487,-560.0414C279.2694,-546.7188 330.4289,-524.2399 364.4763,-509.2798"/>
<polygon fill="#ff0000" stroke="#ff0000" points="366.2751,-512.3125 374.0223,-505.0854 363.4592,-505.9038 366.2751,-512.3125"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M267.6063,-574.1395C303.1754,-575.8962 354.5703,-576.7629 399.0839,-571.0736"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M399.0839,-571.0736C433.4579,-566.6803 518.0944,-514.2047 560.5619,-486.6848"/>
<polygon fill="#00ff00" stroke="#00ff00" points="562.484,-489.6099 568.9507,-481.2174 558.6619,-483.7454 562.484,-489.6099"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M226.4487,-582.5429C234.6938,-616.7964 262.9176,-720.114 317.2024,-787.0736 331.0871,-804.2003 351.2562,-818.5688 368.1022,-828.7203"/>
<polygon fill="#00ffff" stroke="#00ffff" points="366.6522,-831.9254 377.0582,-833.9168 370.1654,-825.8708 366.6522,-831.9254"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.4229,-575.0736C833.0703,-554.4149 847.0773,-533.9142 918.9895,-498.0736"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M918.9895,-498.0736C927.822,-493.6716 1018.8518,-394.9899 1057.4932,-352.8624"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1060.3068,-354.9726 1064.4831,-345.2356 1055.1463,-350.243 1060.3068,-354.9726"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge53" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M267.6098,-580.8144C289.3428,-585.651 315.9254,-591.5669 339.4864,-596.8104"/>
<polygon fill="#ff0000" stroke="#ff0000" points="338.8545,-600.2553 349.3761,-599.0113 340.3752,-593.4224 338.8545,-600.2553"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge55" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M238.2375,-582.2034C255.9233,-595.3801 287.2735,-617.1609 317.2024,-630.0736 323.2682,-632.6907 329.7326,-635.0367 336.2678,-637.1261"/>
<polygon fill="#00ffff" stroke="#00ffff" points="335.271,-640.4811 345.8552,-640.0053 337.2845,-633.7769 335.271,-640.4811"/>
</g>
<!-- sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node26" class="node">
<title>sourcefile~sortandstringutilities.f90</title>
<g id="a_sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node26"><a xlink:href="../sourcefile/sortandstringutilities.f90.html" xlink:title="SortAndStringUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.3044,-349.0791 334.8633,-349.0791 334.8633,-327.0682 463.3044,-327.0682 463.3044,-349.0791"/>
<text text-anchor="middle" x="399.0839" y="-334.9236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SortAndStringUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge68" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M231.0945,-559.8081C242.7481,-541.3789 265.8818,-503.3949 281.2024,-469.0736 301.4831,-423.6407 281.4787,-397.7042 317.2024,-363.0736 320.9092,-359.4802 325.1176,-356.4017 329.6231,-353.7644"/>
<polygon fill="#ff0000" stroke="#ff0000" points="331.2606,-356.8585 338.6,-349.2175 328.0976,-350.6138 331.2606,-356.8585"/>
</g>
<!-- sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node27" class="node">
<title>sourcefile~dataoutputs.f90</title>
<g id="a_sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node27"><a xlink:href="../sourcefile/dataoutputs.f90.html" xlink:title="DataOutputs.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="443.5485,-308.0791 354.6193,-308.0791 354.6193,-286.0682 443.5485,-286.0682 443.5485,-308.0791"/>
<text text-anchor="middle" x="399.0839" y="-293.9236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataOutputs.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge69" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M231.468,-559.9645C243.6457,-541.7547 267.5,-504.0724 281.2024,-469.0736 306.3545,-404.8298 268.8345,-367.2716 317.2024,-318.0736 324.6873,-310.4602 334.5307,-305.4781 344.7876,-302.2465"/>
<polygon fill="#00ff00" stroke="#00ff00" points="345.8971,-305.5741 354.6848,-299.6558 344.1244,-298.8022 345.8971,-305.5741"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge70" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M231.6655,-560.0391C244.1205,-541.934 268.3561,-504.3956 281.2024,-469.0736 310.8766,-387.4819 257.8609,-340.4484 317.2024,-277.0736 325.5091,-268.2023 337.01,-262.873 348.7692,-259.7224"/>
<polygon fill="#0000ff" stroke="#0000ff" points="349.6244,-263.1182 358.6433,-257.5585 348.1258,-256.2804 349.6244,-263.1182"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~heatbalfinitedifferencemanager.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge92" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~heatbalfinitedifferencemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1074.6888,-411.0736C1103.0471,-438.021 1109.1713,-446.1426 1131.7712,-478.0736 1194.7205,-567.0135 1146.5628,-701.6608 1254.9078,-690.0736"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1254.9078,-690.0736C1327.8419,-682.2735 1405.0205,-639.6072 1443.582,-615.566"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1445.5192,-618.482 1452.0897,-610.1706 1441.7702,-612.5705 1445.5192,-618.482"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-372.0736C690.13,-374.9455 731.3679,-439.7366 820.3726,-385.0736 850.5208,-366.5578 826.2243,-332.5894 856.3726,-314.0736 903.8014,-284.9448 930.7615,-291.4292 981.6064,-314.0736 1003.4551,-323.8042 1001.1384,-336.7286 1017.6064,-354.0736 1042.2923,-380.0741 1048.6989,-386.3768 1074.6888,-411.0736"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M585.7192,-372.0736C646.7881,-373.7534 637.9442,-429.8818 690.4731,-461.0736 697.3396,-465.1509 704.9898,-468.7893 712.5614,-471.9436"/>
<polygon fill="#ff6600" stroke="#ff6600" points="711.458,-475.2706 722.0451,-475.6768 714.022,-468.7571 711.458,-475.2706"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge76" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00cb" stroke-dasharray="5,2" d="M448.1937,-404.9643C459.3659,-401.3932 470.8994,-396.8255 480.9653,-391.0736 499.8107,-380.305 498.4087,-369.3324 516.9653,-358.0736 523.3109,-354.2236 530.342,-350.8286 537.4151,-347.8815"/>
<polygon fill="#ff00cb" stroke="#ff00cb" points="538.9771,-351.0293 547.0258,-344.1396 536.4373,-344.5063 538.9771,-351.0293"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M435.7456,-405.0626C481.3866,-391.7721 556.8509,-371.2796 585.7192,-372.0736"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-372.0736C624.3996,-373.1376 720.276,-349.2601 755.4229,-333.0736"/>
</g>
<!-- sourcefile~dataairflownetwork.f90&#45;&gt;sourcefile~heatbalfinitedifferencemanager.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge93" class="edge">
<title>sourcefile~dataairflownetwork.f90&#45;&gt;sourcefile~heatbalfinitedifferencemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1074.6888,-844.0736C1175.234,-812.595 1150.1476,-701.2774 1254.9078,-690.0736"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M460.1725,-770.7483C566.5698,-777.6611 792.5967,-794.6191 981.6064,-824.0736 1023.4159,-830.5891 1034.3075,-856.7162 1074.6888,-844.0736"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~heatbalfinitedifferencemanager.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge94" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~heatbalfinitedifferencemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1263.2842,-870.9797C1295.6635,-828.0957 1412.8783,-672.8534 1454.1142,-618.2396"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1457.0343,-620.1805 1460.2668,-610.0909 1451.4478,-615.9625 1457.0343,-620.1805"/>
</g>
<!-- sourcefile~heatbalancemovableinsulation.f90&#45;&gt;sourcefile~heatbalfinitedifferencemanager.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge95" class="edge">
<title>sourcefile~heatbalancemovableinsulation.f90&#45;&gt;sourcefile~heatbalfinitedifferencemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1268.5994,-435.2869C1304.7818,-464.9199 1403.1596,-545.4905 1447.0012,-581.3964"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1445.0536,-584.3254 1455.0078,-587.9538 1449.4889,-578.9098 1445.0536,-584.3254"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~heatbalfinitedifferencemanager.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge96" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~heatbalfinitedifferencemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1254.9078,-143.0736C1396.1322,-267.7469 1451.0004,-505.5973 1464.8334,-577.7809"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1461.4451,-578.7056 1466.7081,-587.9008 1468.328,-577.4305 1461.4451,-578.7056"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M448.1226,-132.2328C611.6934,-107.2605 1135.0274,-37.2428 1254.9078,-143.0736"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M585.7192,-256.0736C614.9553,-269.9581 631.6509,-257.1243 654.4731,-280.0736 689.2601,-315.0542 668.9753,-340.6707 690.4731,-385.0736 704.9688,-415.0138 726.6269,-446.8687 740.8874,-466.62"/>
<polygon fill="#ff6600" stroke="#ff6600" points="738.1373,-468.7888 746.8666,-474.7929 743.7868,-464.6556 738.1373,-468.7888"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M755.4229,-257.0736C858.9358,-251.3877 905.896,-243.2556 981.6064,-314.0736 1019.4825,-349.5021 993.2611,-379.2797 1017.6064,-425.0736 1028.2124,-445.0235 1044.3605,-465.054 1056.7782,-479.0728"/>
<polygon fill="#65ff00" stroke="#65ff00" points="1054.2793,-481.5274 1063.5884,-486.5861 1059.4658,-476.8263 1054.2793,-481.5274"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~heatbalancemovableinsulation.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge50" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~heatbalancemovableinsulation.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M447.2247,-151.1063C458.6665,-154.7108 470.5635,-159.3126 480.9653,-165.0736 534.9148,-194.9533 530.0111,-229.6174 585.7192,-256.0736"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M585.7192,-256.0736C639.1275,-281.4377 634.997,-194.5231 690.4731,-174.0736 811.9151,-129.308 861.2818,-119.386 981.6064,-167.0736 1106.4399,-216.5482 1207.4631,-353.0194 1242.0626,-404.2747"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1239.289,-406.4245 1247.7409,-412.8133 1245.1178,-402.5483 1239.289,-406.4245"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge64" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M755.4229,-371.0736C853.6016,-395.5676 904.0854,-332.0389 981.6064,-397.0736 1024.5909,-433.1345 998.5098,-465.316 1017.6064,-518.0736 1032.329,-558.747 1053.0634,-604.8604 1065.0669,-630.7051"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="1061.9442,-632.29 1069.351,-639.8657 1068.285,-629.3246 1061.9442,-632.29"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge80" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00cb" stroke-dasharray="5,2" d="M448.146,-147.014C460.0866,-150.722 471.9883,-156.3965 480.9653,-165.0736 516.4367,-199.3601 489.9431,-228.7992 516.9653,-270.0736 528.6779,-287.9637 546.6059,-304.1633 561.2182,-315.6547"/>
<polygon fill="#ff00cb" stroke="#ff00cb" points="559.2887,-318.5845 569.3665,-321.8538 563.5271,-313.0134 559.2887,-318.5845"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge83" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M585.7192,-256.0736C614.9553,-269.9581 629.8609,-259.0554 654.4731,-280.0736 680.1793,-302.026 664.9668,-324.8894 690.4731,-347.0736 713.6934,-367.2695 725.5638,-363.6243 755.4229,-371.0736"/>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M755.4229,-371.0736C777.9966,-376.7054 836.1359,-360.8843 876.6348,-348.2015"/>
<polygon fill="#ff0066" stroke="#ff0066" points="877.7925,-351.5062 886.263,-345.1421 875.6726,-344.8349 877.7925,-351.5062"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M447.9006,-145.6412C460.2768,-149.3278 472.4585,-155.3347 480.9653,-165.0736 546.4334,-240.0239 476.0505,-295.3566 516.9653,-386.0736 528.5511,-411.7617 550.0597,-436.0998 565.9463,-451.9007"/>
<polygon fill="#00ff00" stroke="#00ff00" points="563.6039,-454.5044 573.2255,-458.9402 568.4702,-449.4725 563.6039,-454.5044"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.4229,-257.0736C786.1508,-255.3857 793.477,-248.0297 820.3726,-233.0736 838.0876,-223.2227 838.7172,-215.0312 856.3726,-205.0736 882.3323,-190.4324 891.1502,-170.432 918.9895,-181.0736"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-256.0736C619.7854,-272.2519 717.767,-259.1421 755.4229,-257.0736"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~heatbalfinitedifferencemanager.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge97" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~heatbalfinitedifferencemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1100.6682,-662.1053C1135.4414,-675.6188 1199.204,-696.031 1254.9078,-690.0736"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~heatbalancemovableinsulation.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge51" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~heatbalancemovableinsulation.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1083.6259,-639.8167C1112.5174,-603.4255 1203.6183,-488.6768 1239.841,-443.0515"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1242.6526,-445.139 1246.1293,-435.1309 1237.1703,-440.7865 1242.6526,-445.139"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~heatbalfinitedifferencemanager.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge98" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~heatbalfinitedifferencemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M597.7299,-322.0012C620.8288,-300.8349 670.8886,-255.6179 690.4731,-243.0736 758.7668,-199.3303 777.69,-186.7346 856.3726,-167.0736 1028.5271,-124.0563 1115.8426,-32.8532 1254.9078,-143.0736"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M630.7982,-344.1957C639.2741,-347.6859 647.6161,-352.2169 654.4731,-358.0736 679.5842,-379.5214 670.4033,-396.8483 690.4731,-423.0736 703.2812,-439.8099 720.502,-456.3064 733.9933,-468.2182"/>
<polygon fill="#ff6600" stroke="#ff6600" points="731.9856,-471.1092 741.8387,-475.0037 736.5647,-465.8148 731.9856,-471.1092"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge66" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M622.2743,-344.1127C632.9383,-347.9269 644.4204,-352.6322 654.4731,-358.0736 672.0618,-367.5941 672.7856,-375.7381 690.4731,-385.0736 811.3399,-448.8676 876.6411,-396.5481 981.6064,-484.0736 1029.4292,-523.9508 1057.1473,-595.0603 1068.5459,-630.2156"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="1065.2463,-631.3918 1071.5636,-639.8972 1071.9292,-629.3087 1065.2463,-631.3918"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.4229,-333.0736C791.6708,-316.3801 796.0948,-302.7465 820.3726,-271.0736 840.6997,-244.5547 831.2244,-227.0739 856.3726,-205.0736 878.8042,-185.4498 891.1502,-170.432 918.9895,-181.0736"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M635.5964,-343.7016C670.7164,-348.7102 717.9576,-350.3278 755.4229,-333.0736"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~heatbalfinitedifferencemanager.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge99" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~heatbalfinitedifferencemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M955.4369,-345.0814C989.5831,-356.8885 1040.368,-378.4604 1074.6888,-411.0736"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M958.7833,-345.1565C966.9454,-348.6895 975.0391,-353.2476 981.6064,-359.0736 1006.6017,-381.2475 999.2535,-397.1521 1017.6064,-425.0736 1030.1644,-444.1789 1046.3702,-464.568 1058.3042,-478.9283"/>
<polygon fill="#65ff00" stroke="#65ff00" points="1055.6643,-481.2273 1064.7772,-486.6315 1061.0234,-476.7239 1055.6643,-481.2273"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge65" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M962.6564,-345.0807C969.7972,-348.5552 976.5134,-353.1097 981.6064,-359.0736 1028.6591,-414.172 995.2249,-449.1618 1017.6064,-518.0736 1030.9683,-559.2141 1052.1721,-605.1663 1064.6289,-630.8554"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="1061.545,-632.5162 1069.0884,-639.9558 1067.8309,-629.4359 1061.545,-632.5162"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M974.3217,-334.0736C985.029,-334.0736 996.3582,-334.0736 1007.3987,-334.0736"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1007.4307,-337.5737 1017.4307,-334.0736 1007.4306,-330.5737 1007.4307,-337.5737"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M438.627,-505.1105C484.5778,-517.4434 557.6796,-535.4074 585.7192,-533.0736"/>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M585.7192,-533.0736C632.5812,-529.1733 684.3951,-512.9923 718.2924,-500.6962"/>
<polygon fill="#ff6600" stroke="#ff6600" points="719.6209,-503.9366 727.785,-497.184 717.1918,-497.3716 719.6209,-503.9366"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M654.255,-476.5353C673.6046,-478.3596 694.1305,-480.2949 711.6005,-481.942"/>
<polygon fill="#ff6600" stroke="#ff6600" points="711.7608,-485.4725 722.0452,-482.9267 712.4179,-478.5034 711.7608,-485.4725"/>
</g>
<!-- sourcefile~datastringglobals.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~datastringglobals.f90</title>
<g id="a_sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_node19"><a xlink:href="../sourcefile/datastringglobals.f90.html" xlink:title="DataStringGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="281.0645,-112.0791 166.6166,-112.0791 166.6166,-90.0682 281.0645,-90.0682 281.0645,-112.0791"/>
<text text-anchor="middle" x="223.8406" y="-97.9236" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataStringGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M237.878,-112.0868C255.4563,-125.3545 286.9497,-147.4327 317.2024,-160.0736 351.6729,-174.4769 366.6933,-160.4586 399.0839,-179.0736"/>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M399.0839,-179.0736C431.9636,-197.9697 451.5118,-179.1858 480.9653,-203.0736 507.22,-224.367 490.9029,-248.5454 516.9653,-270.0736 566.3338,-310.8533 605.7095,-271.5726 654.4731,-313.0736 681.7188,-336.2615 672.7718,-353.9824 690.4731,-385.0736 707.0208,-414.1386 728.3358,-446.4401 741.9442,-466.507"/>
<polygon fill="#ff6600" stroke="#ff6600" points="739.0824,-468.5227 747.6097,-474.8105 744.8647,-464.5774 739.0824,-468.5227"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge78" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00cb" stroke-dasharray="5,2" d="M399.0839,-179.0736C431.9636,-197.9697 453.551,-176.8707 480.9653,-203.0736 516.6283,-237.1608 482.4048,-272.8693 516.9653,-308.0736 520.3993,-311.5716 524.3605,-314.583 528.6119,-317.1752"/>
<polygon fill="#ff00cb" stroke="#ff00cb" points="527.1889,-320.3811 537.6701,-321.9285 530.4416,-314.1826 527.1889,-320.3811"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M281.1252,-104.2433C333.2957,-107.3826 412.4201,-112.7759 480.9653,-120.0736 505.3968,-122.6747 895.9035,-172.6654 918.9895,-181.0736"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M273.5895,-90.0021C294.1182,-85.4335 318.0812,-80.1006 339.534,-75.3263"/>
<polygon fill="#ff0000" stroke="#ff0000" points="340.5132,-78.6941 349.5141,-73.1053 338.9925,-71.8613 340.5132,-78.6941"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ffcc00" stroke-dasharray="5,2" d="M399.0839,-884.0736C436.1265,-879.2246 454.4494,-891.3904 480.9653,-865.0736 529.6268,-816.7776 471.3065,-766.2177 516.9653,-715.0736 520.6659,-710.9284 525.1097,-707.4699 529.9346,-704.5844"/>
<polygon fill="#ffcc00" stroke="#ffcc00" points="531.6348,-707.6463 538.9528,-699.9848 528.4543,-701.4105 531.6348,-707.6463"/>
<path fill="none" stroke="#ffcc00" stroke-dasharray="5,2" d="M248.2635,-856.0869C281.9039,-869.97 344.5368,-891.214 399.0839,-884.0736"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge62" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M399.0839,-884.0736C436.1265,-879.2246 444.7095,-874.0838 480.9653,-865.0736 558.389,-845.8326 578.738,-844.1498 654.4731,-819.0736 730.4211,-793.927 951.4637,-702.472 1038.6885,-666.1208"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="1040.2787,-669.2499 1048.1611,-662.1704 1037.5843,-662.7892 1040.2787,-669.2499"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M278.8078,-845.0736C295.1003,-845.0736 313.1505,-845.0736 330.2066,-845.0736"/>
<polygon fill="#00ffff" stroke="#00ffff" points="330.6733,-848.5737 340.6733,-845.0736 330.6733,-841.5737 330.6733,-848.5737"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ffcc00" stroke-dasharray="5,2" d="M457.4681,-834.7965C466.1202,-831.2469 474.3394,-826.4782 480.9653,-820.0736 516.4367,-785.7872 482.4048,-750.278 516.9653,-715.0736 520.8025,-711.165 525.2979,-707.8638 530.121,-705.0763"/>
<polygon fill="#ffcc00" stroke="#ffcc00" points="531.7066,-708.1967 539.0849,-700.5933 528.5755,-701.936 531.7066,-708.1967"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge57" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M429.4943,-834.0459C445.1189,-828.0734 464.3217,-820.2537 480.9653,-812.0736 481.9569,-811.5863 754.3199,-651.1376 755.4229,-651.0736"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~heatbalancemovableinsulation.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~heatbalancemovableinsulation.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1096.7872,-345.1094C1128.5387,-360.9659 1187.2251,-390.2734 1223.4815,-408.3795"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1222.1185,-411.611 1232.6287,-412.9476 1225.246,-405.3485 1222.1185,-411.611"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge79" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00cb" stroke-dasharray="5,2" d="M423.1691,-73.1301C441.7434,-82.8903 466.6113,-98.8665 480.9653,-120.0736 519.3948,-176.8506 482.1705,-210.9994 516.9653,-270.0736 527.7488,-288.3817 545.5459,-304.4759 560.3312,-315.8144"/>
<polygon fill="#ff00cb" stroke="#ff00cb" points="558.4872,-318.8033 568.6128,-321.9216 562.6418,-313.1695 558.4872,-318.8033"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M464.0099,-70.9479C564.1274,-85.9494 761.1415,-120.7362 918.9895,-181.0736"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge63" class="edge">
<title>sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M585.7192,-651.0736C661.1042,-648.6526 680.1255,-655.4404 755.4229,-651.0736"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M443.7963,-621.1078C494.4053,-633.4046 571.6687,-651.5249 585.7192,-651.0736"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge67" class="edge">
<title>sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M480.866,-652.2091C513.4924,-652.3656 551.3908,-652.1761 585.7192,-651.0736"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge72" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00cb" stroke-dasharray="5,2" d="M463.3132,-336.3529C483.6061,-335.8093 505.9381,-335.211 525.9091,-334.676"/>
<polygon fill="#ff00cb" stroke="#ff00cb" points="526.2114,-338.1692 536.1141,-334.4026 526.0239,-331.1717 526.2114,-338.1692"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge73" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00cb" stroke-dasharray="5,2" d="M443.7877,-305.6965C468.4588,-310.4553 499.4194,-316.4273 526.1233,-321.5782"/>
<polygon fill="#ff00cb" stroke="#ff00cb" points="525.6455,-325.0505 536.1275,-323.5079 526.9714,-318.1772 525.6455,-325.0505"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~EfferentGraph_edge77" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00cb" stroke-dasharray="5,2" d="M439.5837,-262.5936C453.2273,-265.7828 468.215,-270.4197 480.9653,-277.0736 499.6843,-286.8423 498.7457,-297.4026 516.9653,-308.0736 523.4452,-311.8688 530.5994,-315.2445 537.7707,-318.192"/>
<polygon fill="#ff00cb" stroke="#ff00cb" points="536.9091,-321.611 547.4987,-321.9451 539.4288,-315.0802 536.9091,-321.611"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefileheatbalfinitedifferencemanagerf90EfferentGraph = svgPanZoom('#sourcefileheatbalfinitedifferencemanagerf90EfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <h3>Files Dependent On This One</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~heatbalfinitedifferencemanager.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefileheatbalfinitedifferencemanagerf90AfferentGraph" width="641pt" height="47pt"
 viewBox="0.00 0.00 641.00 46.71" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~AfferentGraph" class="graph" transform="scale(.6532 .6532) rotate(0) translate(4 67.5)">
<title>sourcefile~~heatbalfinitedifferencemanager.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-67.5 977.2803,-67.5 977.2803,4 -4,4"/>
<!-- sourcefile~heatbalfinitedifferencemanager.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~heatbalfinitedifferencemanager.f90</title>
<polygon fill="none" stroke="#000000" points="181.1227,-22.2554 -.0409,-22.2554 -.0409,-.2446 181.1227,-.2446 181.1227,-22.2554"/>
<text text-anchor="middle" x="90.5409" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">HeatBalFiniteDifferenceManager.f90</text>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~heatbalancesurfacemanager.f90</title>
<g id="a_sourcefile~~heatbalfinitedifferencemanager.f90~~AfferentGraph_node2"><a xlink:href="../sourcefile/heatbalancesurfacemanager.f90.html" xlink:title="HeatBalanceSurfaceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="383.6177,-22.2554 217.2363,-22.2554 217.2363,-.2446 383.6177,-.2446 383.6177,-22.2554"/>
<text text-anchor="middle" x="300.427" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceSurfaceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalfinitedifferencemanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~heatbalfinitedifferencemanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M181.3793,-11.25C189.8071,-11.25 198.3585,-11.25 206.8107,-11.25"/>
<polygon fill="#ff0000" stroke="#ff0000" points="207.0564,-14.7501 217.0564,-11.25 207.0563,-7.7501 207.0564,-14.7501"/>
</g>
<!-- sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~heatbalancemanager.f90</title>
<g id="a_sourcefile~~heatbalfinitedifferencemanager.f90~~AfferentGraph_node3"><a xlink:href="../sourcefile/heatbalancemanager.f90.html" xlink:title="HeatBalanceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="550.0297,-42.2554 420.0191,-42.2554 420.0191,-20.2446 550.0297,-20.2446 550.0297,-42.2554"/>
<text text-anchor="middle" x="485.0244" y="-28.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M383.8147,-20.2845C392.5362,-21.2295 401.365,-22.186 409.9854,-23.12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="409.6716,-26.6064 419.9905,-24.204 410.4257,-19.6471 409.6716,-26.6064"/>
</g>
<!-- sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~simulationmanager.f90</title>
<g id="a_sourcefile~~heatbalfinitedifferencemanager.f90~~AfferentGraph_node4"><a xlink:href="../sourcefile/simulationmanager.f90.html" xlink:title="SimulationManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="840.8629,-42.2554 721.0524,-42.2554 721.0524,-20.2446 840.8629,-20.2446 840.8629,-42.2554"/>
<text text-anchor="middle" x="780.9576" y="-28.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SimulationManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M383.6309,-6.3275C461.7456,-2.8699 581.7496,-.5502 685.2554,-11.25 698.9789,-12.6687 713.6355,-15.2026 727.2492,-18.0007"/>
<polygon fill="#ff0000" stroke="#ff0000" points="726.9127,-21.5078 737.4237,-20.1777 728.3774,-14.6628 726.9127,-21.5078"/>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M530.8634,-42.2702C548.1242,-45.8995 567.9977,-49.462 586.2766,-51.25 630.0582,-55.5326 641.498,-55.7734 685.2554,-51.25 698.9789,-49.8313 713.6355,-47.2974 727.2492,-44.4993"/>
<polygon fill="#ff0000" stroke="#ff0000" points="728.3774,-47.8372 737.4237,-42.3223 726.9127,-40.9922 728.3774,-47.8372"/>
</g>
<!-- sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~sizingmanager.f90</title>
<g id="a_sourcefile~~heatbalfinitedifferencemanager.f90~~AfferentGraph_node5"><a xlink:href="../sourcefile/sizingmanager.f90.html" xlink:title="SizingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="685.2448,-42.2554 586.2872,-42.2554 586.2872,-20.2446 685.2448,-20.2446 685.2448,-42.2554"/>
<text text-anchor="middle" x="635.766" y="-28.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SizingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M550.2651,-31.25C558.7505,-31.25 567.4103,-31.25 575.8038,-31.25"/>
<polygon fill="#ff0000" stroke="#ff0000" points="575.8804,-34.7501 585.8803,-31.25 575.8803,-27.7501 575.8804,-34.7501"/>
</g>
<!-- sourcefile~energyplus.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~energyplus.f90</title>
<g id="a_sourcefile~~heatbalfinitedifferencemanager.f90~~AfferentGraph_node6"><a xlink:href="../sourcefile/energyplus.f90.html" xlink:title="EnergyPlus.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="966.6786,-63.2554 883.2616,-63.2554 883.2616,-41.2446 966.6786,-41.2446 966.6786,-63.2554"/>
<text text-anchor="middle" x="924.9701" y="-49.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EnergyPlus.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M840.7808,-39.9735C851.4454,-41.5286 862.4772,-43.1372 872.9035,-44.6576"/>
<polygon fill="#00ffff" stroke="#00ffff" points="872.6916,-48.1637 883.092,-46.1433 873.7017,-41.2369 872.6916,-48.1637"/>
</g>
<!-- sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~utilityroutines.f90</title>
<g id="a_sourcefile~~heatbalfinitedifferencemanager.f90~~AfferentGraph_node7"><a xlink:href="../sourcefile/utilityroutines.f90.html" xlink:title="UtilityRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="973.0912,-22.2554 876.849,-22.2554 876.849,-.2446 973.0912,-.2446 973.0912,-22.2554"/>
<text text-anchor="middle" x="924.9701" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">UtilityRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M840.7808,-22.942C849.2417,-21.7669 857.9338,-20.5598 866.3712,-19.388"/>
<polygon fill="#00ffff" stroke="#00ffff" points="867.0807,-22.8232 876.5042,-17.9808 866.1177,-15.8897 867.0807,-22.8232"/>
</g>
<!-- sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~heatbalfinitedifferencemanager.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M685.3266,-31.25C693.593,-31.25 702.3039,-31.25 710.9653,-31.25"/>
<polygon fill="#ff0000" stroke="#ff0000" points="711.0808,-34.7501 721.0808,-31.25 711.0807,-27.7501 711.0808,-34.7501"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefileheatbalfinitedifferencemanagerf90AfferentGraph = svgPanZoom('#sourcefileheatbalfinitedifferencemanagerf90AfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <br>

    <section class="visible-xs visible-sm hidden-md">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/heatbalfinitediffmanager.html">HeatBalFiniteDiffManager</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html#src">HeatBalFiniteDifferenceManager.f90</a>
  </div>
</div>


    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">MODULE </span><span class="n">HeatBalFiniteDiffManager</span>
<a name="ln-2"></a>
<a name="ln-3"></a>          <span class="c">! Module containing the heat balance simulation routines</span>
<a name="ln-4"></a>
<a name="ln-5"></a>          <span class="c">! MODULE INFORMATION:</span>
<a name="ln-6"></a>          <span class="c">!       AUTHOR         Richard J. Liesen</span>
<a name="ln-7"></a>          <span class="c">!       DATE WRITTEN   October 2003</span>
<a name="ln-8"></a>          <span class="c">!       RE-ENGINEERED  Curtis Pedersen, 2006, Changed to Implicit FD calc for conduction.</span>
<a name="ln-9"></a>          <span class="c">!                      and included enthalpy formulations for phase change materials</span>
<a name="ln-10"></a>          <span class="c">! PURPOSE OF THIS MODULE:</span>
<a name="ln-11"></a>          <span class="c">! To encapsulate the data and algorithms required to</span>
<a name="ln-12"></a>          <span class="c">! manage the fiite difference heat balance simulation on the building.</span>
<a name="ln-13"></a>
<a name="ln-14"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-15"></a>          <span class="c">!</span>
<a name="ln-16"></a>
<a name="ln-17"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-18"></a>          <span class="c">! The MFD moisture balance method</span>
<a name="ln-19"></a>          <span class="c">!  C. O. Pedersen, Enthalpy Formulation of conduction heat transfer problems</span>
<a name="ln-20"></a>          <span class="c">!    involving latent heat, Simulation, Vol 18, No. 2, February 1972</span>
<a name="ln-21"></a>
<a name="ln-22"></a>          <span class="c">! OTHER NOTES:</span>
<a name="ln-23"></a>          <span class="c">!</span>
<a name="ln-24"></a>          <span class="c">!</span>
<a name="ln-25"></a>
<a name="ln-26"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-27"></a>          <span class="c">! Use statements for data only modules</span>
<a name="ln-28"></a><span class="k">USE </span><span class="n">DataPrecisionGlobals</span>
<a name="ln-29"></a><span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span> <span class="n">Only</span><span class="p">:</span><span class="n">MaxNameLength</span><span class="p">,</span><span class="n">KelvinConv</span><span class="p">,</span><span class="n">outputfiledebug</span><span class="p">,</span> <span class="n">NumOfTimeStepInHour</span><span class="p">,</span><span class="n">DisplayExtraWarnings</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-30"></a>                      <span class="n">TimeStepZone</span><span class="p">,</span><span class="n">Hourofday</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">,</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">BeginEnvrnFlag</span><span class="p">,</span><span class="n">DayofSim</span><span class="p">,</span><span class="n">WarmupFlag</span><span class="p">,</span><span class="n">SecInHour</span>
<a name="ln-31"></a><span class="k">USE </span><span class="n">DataInterfaces</span>
<a name="ln-32"></a><span class="k">USE </span><span class="n">DataMoistureBalance</span>
<a name="ln-33"></a><span class="k">USE </span><span class="n">DataHeatBalance</span><span class="p">,</span> <span class="n">Only</span><span class="p">:</span> <span class="n">Material</span><span class="p">,</span> <span class="n">TotMaterials</span><span class="p">,</span><span class="n">MaxLayersInConstruct</span><span class="p">,</span> <span class="n">QRadThermInAbs</span><span class="p">,</span><span class="n">Construct</span><span class="p">,</span>      <span class="p">&amp;</span>
<a name="ln-34"></a>                           <span class="n">TotConstructs</span><span class="p">,</span><span class="n">UseCondFD</span><span class="p">,</span><span class="n">RegularMaterial</span><span class="p">,</span><span class="n">Air</span><span class="p">,</span><span class="n">Zone</span>
<a name="ln-35"></a><span class="k">USE </span><span class="n">DataHeatBalSurface</span><span class="p">,</span> <span class="n">Only</span><span class="p">:</span> <span class="n">NetLWRadToSurf</span><span class="p">,</span> <span class="n">QRadSWOutAbs</span><span class="p">,</span> <span class="n">QRadSWInAbs</span><span class="p">,</span><span class="n">QRadSWOutMvIns</span><span class="p">,</span> <span class="n">TempSource</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-36"></a>                         <span class="n">OpaqSurfInsFaceConductionFlux</span><span class="p">,</span><span class="n">OpaqSurfOutsideFaceConductionFlux</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-37"></a>                         <span class="n">OpaqSurfOutsideFaceConduction</span><span class="p">,</span><span class="n">QsrcHist</span><span class="p">,</span><span class="n">OpaqSurfInsFaceConduction</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-38"></a>                         <span class="n">QdotRadOutRepPerArea</span><span class="p">,</span><span class="n">MinSurfaceTempLimit</span><span class="p">,</span><span class="n">MaxSurfaceTempLimit</span><span class="p">,</span><span class="n">QdotRadNetSurfInRep</span><span class="p">,</span><span class="n">QRadNetSurfInReport</span>
<a name="ln-39"></a><span class="k">Use </span><span class="n">DataSurfaces</span><span class="p">,</span> <span class="n">Only</span><span class="p">:</span> <span class="n">Surface</span><span class="p">,</span> <span class="n">TotSurfaces</span><span class="p">,</span><span class="n">Ground</span><span class="p">,</span><span class="n">SurfaceClass_Window</span><span class="p">,</span> <span class="n">HeatTransferModel_CondFD</span>
<a name="ln-40"></a><span class="k">Use </span><span class="n">DataHeatBalFanSys</span><span class="p">,</span> <span class="n">Only</span><span class="p">:</span> <span class="n">Mat</span><span class="p">,</span> <span class="n">ZoneAirHumRat</span><span class="p">,</span> <span class="n">QHTRadSysSurf</span><span class="p">,</span> <span class="n">QHWBaseboardSurf</span><span class="p">,</span> <span class="n">QSteamBaseboardSurf</span><span class="p">,</span> <span class="n">QElecBaseboardSurf</span>
<a name="ln-41"></a><span class="k">Use </span><span class="n">DataEnvironment</span><span class="p">,</span> <span class="n">Only</span><span class="p">:</span> <span class="n">SkyTemp</span><span class="p">,</span> <span class="n">IsRain</span>
<a name="ln-42"></a><span class="k">USE </span><span class="n">Psychrometrics</span> <span class="p">,</span> <span class="n">Only</span><span class="p">:</span><span class="n">PsyRhFnTdbRhovLBnd0C</span><span class="p">,</span><span class="n">PsyWFnTdbRhPb</span><span class="p">,</span><span class="n">PsyHgAirFnWTdb</span>
<a name="ln-43"></a>  <span class="c">! Fan system Source/Sink heat value, and source/sink location temp from CondFD</span>
<a name="ln-44"></a><span class="k">USE </span><span class="n">DataHeatBAlFanSys</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">QRadSysSource</span><span class="p">,</span><span class="n">TCondFDSourceNode</span><span class="p">,</span><span class="n">QPVSysSource</span>
<a name="ln-45"></a><span class="k">USE </span><span class="n">HeatBalanceMovableInsulation</span><span class="p">,</span>  <span class="n">ONLY</span> <span class="p">:</span> <span class="n">EvalOutsideMovableInsulation</span>
<a name="ln-46"></a>
<a name="ln-47"></a><span class="k">IMPLICIT NONE</span>   <span class="c">! Enforce explicit typing of all variables</span>
<a name="ln-48"></a>
<a name="ln-49"></a><span class="k">PRIVATE</span>   <span class="c">!Make everything private except what is specifically Public</span>
<a name="ln-50"></a>
<a name="ln-51"></a>          <span class="c">! MODULE PARAMETER DEFINITIONS:</span>
<a name="ln-52"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Lambda</span><span class="o">=</span><span class="mi">250000</span><span class="mf">0.0d0</span>
<a name="ln-53"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">smalldiff</span><span class="o">=</span><span class="mf">1.d-8</span>  <span class="c">! Used in places where &quot;equality&quot; tests should not be used.</span>
<a name="ln-54"></a>
<a name="ln-55"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CrankNicholsonSecondOrder</span> <span class="o">=</span> <span class="mi">1</span> <span class="c">! original CondFD scheme.  semi implicit, second order in time</span>
<a name="ln-56"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">FullyImplicitFirstOrder</span>  <span class="o">=</span> <span class="mi">2</span> <span class="c">! fully implicit scheme, first order in time.</span>
<a name="ln-57"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cCondFDSchemeType</span><span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-58"></a>   <span class="p">(</span><span class="o">/</span><span class="s1">&#39;CrankNicholsonSecondOrder&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-59"></a>     <span class="s1">&#39;FullyImplicitFirstOrder  &#39;</span><span class="o">/</span><span class="p">)</span>
<a name="ln-60"></a>
<a name="ln-61"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">TempInitValue</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">3.0d0</span>    <span class="c">! Initialization value for Temperature</span>
<a name="ln-62"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RhovInitValue</span> <span class="o">=</span> <span class="mf">0.0115d0</span>  <span class="c">! Initialization value for Rhov</span>
<a name="ln-63"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">EnthInitValue</span> <span class="o">=</span> <span class="mi">10</span><span class="mf">0.0d0</span>   <span class="c">! Initialization value for Enthalpy</span>
<a name="ln-64"></a>
<a name="ln-65"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-66"></a><span class="k">TYPE</span><span class="p">,</span> <span class="k">PUBLIC</span> <span class="kd">::</span>  <span class="n">ConstructionDataFD</span>
<a name="ln-67"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">Name</span> <span class="c">! Name of construction</span>
<a name="ln-68"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">DelX</span>                 <span class="c">!</span>
<a name="ln-69"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">TempStability</span>
<a name="ln-70"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MoistStability</span>
<a name="ln-71"></a>
<a name="ln-72"></a>  <span class="kt">Integer</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">NodeNumPoint</span>  <span class="c">!</span>
<a name="ln-73"></a><span class="c">!  INTEGER, ALLOCATABLE, DIMENSION(:) :: InterfaceNodeNums   ! Layer interfaces occur at these nodes</span>
<a name="ln-74"></a>
<a name="ln-75"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">Thickness</span>
<a name="ln-76"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">NodeXlocation</span> <span class="c">! sized to TotNode, contains X distance in m from outside face</span>
<a name="ln-77"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotNodes</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-78"></a>
<a name="ln-79"></a>  <span class="kt">Integer</span> <span class="kd">::</span> <span class="n">DeltaTime</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-80"></a>
<a name="ln-81"></a><span class="k">END TYPE </span><span class="n">ConstructionDataFD</span>
<a name="ln-82"></a>
<a name="ln-83"></a>
<a name="ln-84"></a><span class="k">TYPE</span><span class="p">,</span> <span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">SurfaceDataFD</span>
<a name="ln-85"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">T</span>             <span class="c">!</span>
<a name="ln-86"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">TOld</span>          <span class="c">!</span>
<a name="ln-87"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">TT</span>
<a name="ln-88"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">Rhov</span>          <span class="c">!</span>
<a name="ln-89"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">RhovOld</span>       <span class="c">!</span>
<a name="ln-90"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">RhoT</span>
<a name="ln-91"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">TD</span>            <span class="c">!</span>
<a name="ln-92"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">TDT</span>            <span class="c">!</span>
<a name="ln-93"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">TDTLast</span>
<a name="ln-94"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">TDOld</span>         <span class="c">!</span>
<a name="ln-95"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">TDreport</span>
<a name="ln-96"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">RH</span>
<a name="ln-97"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">RHreport</span>
<a name="ln-98"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">EnthOld</span>        <span class="c">! Current node enthalpy</span>
<a name="ln-99"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">EnthNew</span>        <span class="c">! Node enthalpy at new time</span>
<a name="ln-100"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">EnthLast</span>
<a name="ln-101"></a>  <span class="kt">INTEGER</span>                                 <span class="kd">::</span> <span class="n">GSloopCounter</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! count of inner loop iterations</span>
<a name="ln-102"></a>  <span class="kt">INTEGER</span>                                 <span class="kd">::</span> <span class="n">GSloopErrorCount</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! recurring error counter</span>
<a name="ln-103"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                               <span class="kd">::</span> <span class="n">MaxNodeDelTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! largest change in node temps after calc</span>
<a name="ln-104"></a>
<a name="ln-105"></a><span class="k">END TYPE </span><span class="n">SurfaceDataFD</span>
<a name="ln-106"></a>
<a name="ln-107"></a><span class="k">TYPE </span><span class="n">MaterialDataFD</span>
<a name="ln-108"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tk1</span>          <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Temperature coefficient for thermal conductivity</span>
<a name="ln-109"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">numTempEnth</span>  <span class="o">=</span> <span class="mi">0</span>   <span class="c">! number of Temperature/Enthalpy pairs</span>
<a name="ln-110"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">numTempCond</span>  <span class="o">=</span> <span class="mi">0</span>   <span class="c">! number of Temperature/Conductivity pairs</span>
<a name="ln-111"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,:)</span>  <span class="kd">::</span> <span class="n">TempEnth</span>  <span class="c">!  Temperature enthalpy Function Pairs,</span>
<a name="ln-112"></a>                                                       <span class="c">!  TempEnth(1,1)= first Temp, TempEnth(1,2) = First Enthalpy,</span>
<a name="ln-113"></a>                                                       <span class="c">!  TempEnth(2,1) = secomd Temp, etc.</span>
<a name="ln-114"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,:)</span>  <span class="kd">::</span> <span class="n">TempCond</span>  <span class="c">!  Temperature thermal conductivity Function Pairs,</span>
<a name="ln-115"></a>                                                       <span class="c">!  TempCond(1,1)= first Temp, Tempcond(1,2) = First conductivity,</span>
<a name="ln-116"></a>                                                       <span class="c">!  TempEnth(2,1) = secomd Temp, etc.</span>
<a name="ln-117"></a><span class="k">END TYPE</span>
<a name="ln-118"></a>          <span class="c">! MODULE VARIABLE DECLARATIONS:</span>
<a name="ln-119"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">ConstructionDataFD</span><span class="p">),</span> <span class="k">PUBLIC</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">ConstructFD</span>
<a name="ln-120"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">SurfaceDataFD</span><span class="p">),</span> <span class="k">PUBLIC</span><span class="p">,</span>   <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">SurfaceFD</span>
<a name="ln-121"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">MaterialDataFD</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MaterialFD</span>
<a name="ln-122"></a>
<a name="ln-123"></a><span class="c">!REAL(r64) :: TFDout   =0.0d0</span>
<a name="ln-124"></a><span class="c">!REAL(r64) :: TFDin    =0.0d0</span>
<a name="ln-125"></a><span class="c">!REAL(r64) :: rhovFDout=0.0d0</span>
<a name="ln-126"></a><span class="c">!REAL(r64) :: rhovFDin =0.0d0</span>
<a name="ln-127"></a><span class="c">!REAL(r64) :: TDryout  =0.0d0</span>
<a name="ln-128"></a><span class="c">!REAL(r64) :: Tdryin   =0.0d0</span>
<a name="ln-129"></a><span class="c">!REAL(r64) :: RHOut    =0.0d0</span>
<a name="ln-130"></a><span class="c">!REAL(r64) :: RHIn     =0.0d0</span>
<a name="ln-131"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">SigmaR</span>      <span class="c">!  Total Resistance of construction layers</span>
<a name="ln-132"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">SigmaC</span>      <span class="c">!  Total Capacitance of construction layers</span>
<a name="ln-133"></a>
<a name="ln-134"></a><span class="c">!REAL(r64), ALLOCATABLE, DIMENSION(:)   :: WSurfIn         !Humidity Ratio of the inside surface for reporting</span>
<a name="ln-135"></a><span class="c">!REAL(r64), ALLOCATABLE, DIMENSION(:)   :: QMassInFlux     !MassFlux on Surface for reporting</span>
<a name="ln-136"></a><span class="c">!REAL(r64), ALLOCATABLE, DIMENSION(:)   :: QMassOutFlux    !MassFlux on Surface for reporting</span>
<a name="ln-137"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>   <span class="kd">::</span> <span class="n">QHeatInFlux</span>     <span class="c">!HeatFlux on Surface for reporting</span>
<a name="ln-138"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>   <span class="kd">::</span> <span class="n">QHeatOutFlux</span>    <span class="c">!HeatFlux on Surface for reporting</span>
<a name="ln-139"></a><span class="c">!REAL(r64), ALLOCATABLE, DIMENSION(:)   :: QFluxZoneToInSurf !sum of Heat flows at the surface to air interface,</span>
<a name="ln-140"></a><span class="c">!                                 ! zone-side boundary conditions W/m2 before CR 8280 was not reported, but was calculated.</span>
<a name="ln-141"></a><span class="c">!REAL(r64), ALLOCATABLE, DIMENSION(:)   :: QFluxOutsideToOutSurf !sum of Heat flows at the surface to air interface, Out-side boundary conditions W/m2</span>
<a name="ln-142"></a><span class="c">!                                                           ! before CR 8280 was</span>
<a name="ln-143"></a><span class="c">!REAL(r64), ALLOCATABLE, DIMENSION(:)   :: QFluxInArrivSurfCond !conduction between surface node and first node into the surface (sensible)</span>
<a name="ln-144"></a><span class="c">!                                                           ! before CR 8280 was -- Qdryin    !HeatFlux on Surface for reporting for Sensible only</span>
<a name="ln-145"></a><span class="c">!REAL(r64), ALLOCATABLE, DIMENSION(:)   :: QFluxOutArrivSurfCond  !HeatFlux on Surface for reporting for Sensible only</span>
<a name="ln-146"></a><span class="c">!                                                                 ! before CR 8280 -- Qdryout         !HeatFlux on Surface for reporting for Sensible only</span>
<a name="ln-147"></a>
<a name="ln-148"></a>
<a name="ln-149"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CondFDSchemeType</span> <span class="o">=</span> <span class="n">FullyImplicitFirstOrder</span>  <span class="c">! solution scheme for CondFD - default</span>
<a name="ln-150"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SpaceDescritConstant</span> <span class="o">=</span> <span class="mf">3.d0</span> <span class="c">! spatial descritization constant,</span>
<a name="ln-151"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MinTempLimit</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span><span class="mf">0.d0</span> <span class="c">! lower limit check, degree C</span>
<a name="ln-152"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MaxTempLimit</span> <span class="o">=</span>  <span class="mi">10</span><span class="mf">0.d0</span> <span class="c">! upper limit check, degree C</span>
<a name="ln-153"></a><span class="c">!feb2012 INTEGER   :: MaxGSiter = 200  ! maximum number of Gauss Seidel iterations</span>
<a name="ln-154"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">MaxGSiter</span> <span class="o">=</span> <span class="mi">30</span>  <span class="c">! maximum number of Gauss Seidel iterations</span>
<a name="ln-155"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fracTimeStepZone_Hour</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-156"></a><span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">GetHBFiniteDiffInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-157"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WarmupSurfTemp</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-158"></a>          <span class="c">! Subroutine Specifications for the Heat Balance Module</span>
<a name="ln-159"></a>          <span class="c">! Driver Routines</span>
<a name="ln-160"></a><span class="k">PUBLIC  </span><span class="n">ManageHeatBalFiniteDiff</span>
<a name="ln-161"></a>
<a name="ln-162"></a>          <span class="c">! Initialization routines for module</span>
<a name="ln-163"></a><span class="k">PUBLIC  </span><span class="n">InitHeatBalFiniteDiff</span>
<a name="ln-164"></a><span class="k">PRIVATE </span><span class="n">GetCondFDInput</span>
<a name="ln-165"></a>
<a name="ln-166"></a>          <span class="c">! Algorithms for the module</span>
<a name="ln-167"></a><span class="k">PRIVATE </span><span class="n">CalcHeatBalFiniteDiff</span>
<a name="ln-168"></a><span class="k">PRIVATE </span><span class="n">ExteriorBCEqns</span>
<a name="ln-169"></a><span class="k">PRIVATE </span><span class="n">InteriorBCEqns</span>
<a name="ln-170"></a><span class="k">PRIVATE </span><span class="n">terpld</span>
<a name="ln-171"></a><span class="k">PRIVATE </span><span class="n">InteriorNodeEqns</span>
<a name="ln-172"></a><span class="k">PRIVATE </span><span class="n">IntInterfaceNodeEqns</span>
<a name="ln-173"></a>
<a name="ln-174"></a>
<a name="ln-175"></a>          <span class="c">! Reporting routines for module</span>
<a name="ln-176"></a><span class="k">PRIVATE </span><span class="n">ReportFiniteDiffInits</span>
<a name="ln-177"></a>
<a name="ln-178"></a>          <span class="c">! Update Data Routine</span>
<a name="ln-179"></a><span class="k">PUBLIC  </span><span class="n">UpdateMoistureBalanceFD</span>
<a name="ln-180"></a>
<a name="ln-181"></a>
<a name="ln-182"></a><span class="k">CONTAINS</span>
<a name="ln-183"></a>
<a name="ln-184"></a><span class="c">! MODULE SUBROUTINES:</span>
<a name="ln-185"></a><span class="c">!*************************************************************************</span>
<a name="ln-186"></a><span class="k">SUBROUTINE </span><span class="n">ManageHeatBalFiniteDiff</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">TempSurfInTmp</span><span class="p">,</span><span class="n">TempSurfOutTmp</span><span class="p">)</span>
<a name="ln-187"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-188"></a>          <span class="c">!       AUTHOR         Richard Liesen</span>
<a name="ln-189"></a>          <span class="c">!       DATE WRITTEN   May 2000</span>
<a name="ln-190"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-191"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-192"></a>
<a name="ln-193"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-194"></a>          <span class="c">! This subroutine manages the moisture balance method.  It is called</span>
<a name="ln-195"></a>          <span class="c">! from the HeatBalanceManager at the time step level.</span>
<a name="ln-196"></a>          <span class="c">! This driver manages the calls to all of</span>
<a name="ln-197"></a>          <span class="c">! the other drivers and simulation algorithms.</span>
<a name="ln-198"></a>
<a name="ln-199"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-200"></a>          <span class="c">! na</span>
<a name="ln-201"></a>
<a name="ln-202"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-203"></a>          <span class="c">! na</span>
<a name="ln-204"></a>
<a name="ln-205"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-206"></a>
<a name="ln-207"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-208"></a>
<a name="ln-209"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-210"></a>          <span class="c">! na</span>
<a name="ln-211"></a>
<a name="ln-212"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-213"></a>  <span class="kt">Integer</span><span class="p">,</span> <span class="k">Intent</span><span class="p">(</span><span class="n">In</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfNum</span>
<a name="ln-214"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">Intent</span><span class="p">(</span><span class="n">InOut</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TempSurfInTmp</span>       <span class="c">!INSIDE SURFACE TEMPERATURE OF EACH HEAT TRANSFER SURF.</span>
<a name="ln-215"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">Intent</span><span class="p">(</span><span class="n">InOut</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TempSurfOutTmp</span>      <span class="c">!Outside Surface Temperature of each Heat Transfer Surface</span>
<a name="ln-216"></a>
<a name="ln-217"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-218"></a>          <span class="c">! na</span>
<a name="ln-219"></a>
<a name="ln-220"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-221"></a>
<a name="ln-222"></a>
<a name="ln-223"></a>          <span class="c">! FLOW:</span>
<a name="ln-224"></a>
<a name="ln-225"></a>  <span class="c">! Get the moisture balance input at the beginning of the simulation only</span>
<a name="ln-226"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetHBFiniteDiffInputFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-227"></a>      <span class="c">! Obtains conduction FD related parameters from input file</span>
<a name="ln-228"></a>    <span class="k">CALL </span><span class="n">GetCondFDInput</span>
<a name="ln-229"></a>    <span class="n">GetHBFiniteDiffInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-230"></a>  <span class="n">ENDIF</span>
<a name="ln-231"></a>
<a name="ln-232"></a>  <span class="c">! Condition is taken care of by calling routine:</span>
<a name="ln-233"></a>  <span class="c">! IF (Surface(SurfNum)%HeatTransSurf .and. Surface(SurfNum)%Class /= SurfaceClass_Window)</span>
<a name="ln-234"></a>
<a name="ln-235"></a>  <span class="c">! Solve the zone heat &amp; moisture balance using a finite difference solution</span>
<a name="ln-236"></a>  <span class="k">CALL </span><span class="n">CalcHeatBalFiniteDiff</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">TempSurfInTmp</span><span class="p">,</span><span class="n">TempSurfOutTmp</span><span class="p">)</span>
<a name="ln-237"></a>
<a name="ln-238"></a>  <span class="k">RETURN</span>
<a name="ln-239"></a>
<a name="ln-240"></a><span class="k">END SUBROUTINE </span><span class="n">ManageHeatBalFiniteDiff</span>
<a name="ln-241"></a>
<a name="ln-242"></a>
<a name="ln-243"></a><span class="c">! Get Input Section of the Module</span>
<a name="ln-244"></a><span class="c">!******************************************************************************</span>
<a name="ln-245"></a><span class="k">SUBROUTINE </span><span class="n">GetCondFDInput</span>
<a name="ln-246"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-247"></a>          <span class="c">!       AUTHOR         Curtis Pedersen</span>
<a name="ln-248"></a>          <span class="c">!       DATE WRITTEN   July 2006</span>
<a name="ln-249"></a>          <span class="c">!       MODIFIED       Brent Griffith Mar 2011, user settings</span>
<a name="ln-250"></a>          <span class="c">!</span>
<a name="ln-251"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-252"></a>
<a name="ln-253"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-254"></a>          <span class="c">! This subroutine is the main driver for initializations for the variable property CondFD part of the</span>
<a name="ln-255"></a>          <span class="c">! MFD algorithm</span>
<a name="ln-256"></a>
<a name="ln-257"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-258"></a>          <span class="c">! na</span>
<a name="ln-259"></a>
<a name="ln-260"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-261"></a>          <span class="c">! na</span>
<a name="ln-262"></a>
<a name="ln-263"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-264"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-265"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span><span class="n">GetObjectItem</span><span class="p">,</span><span class="n">FindItemInList</span>
<a name="ln-266"></a>  <span class="k">USE </span><span class="n">DataHeatBalance</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">MaxAllowedDelTempCondFD</span><span class="p">,</span> <span class="n">CondFDRelaxFactor</span><span class="p">,</span> <span class="n">CondFDRelaxFactorInput</span>
<a name="ln-267"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-268"></a>
<a name="ln-269"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-270"></a>
<a name="ln-271"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-272"></a>            <span class="c">! na</span>
<a name="ln-273"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-274"></a>          <span class="c">! na</span>
<a name="ln-275"></a>
<a name="ln-276"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-277"></a>          <span class="c">! na</span>
<a name="ln-278"></a>
<a name="ln-279"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-280"></a>          <span class="c">! na</span>
<a name="ln-281"></a>
<a name="ln-282"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-283"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IOStat</span>           <span class="c">! IO Status when calling get input subroutine</span>
<a name="ln-284"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-285"></a>          <span class="kd">::</span> <span class="n">MaterialNames</span> <span class="c">! Number of Material Alpha names defined</span>
<a name="ln-286"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ConstructionName</span> <span class="c">! Name of Construction with CondFDsimplified</span>
<a name="ln-287"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MaterNum</span>         <span class="c">! Counter to keep track of the material number</span>
<a name="ln-288"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MaterialNumAlpha</span> <span class="c">! Number of material alpha names being passed</span>
<a name="ln-289"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MaterialNumProp</span>  <span class="c">! Number of material properties being passed</span>
<a name="ln-290"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MaterialProps</span> <span class="c">!Temporary array to transfer material properties</span>
<a name="ln-291"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">! If errors detected in input</span>
<a name="ln-292"></a><span class="c">!  INTEGER :: CondFDMat                ! Number of variable property CondFD materials in input</span>
<a name="ln-293"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ConstructNumber</span>     <span class="c">! Cconstruction with CondHBsimple to be overridden with CondHBdetailed</span>
<a name="ln-294"></a>
<a name="ln-295"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumConstructionAlpha</span>
<a name="ln-296"></a>  <span class="kt">Integer</span> <span class="kd">::</span> <span class="n">Loop</span>
<a name="ln-297"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumAlphas</span>
<a name="ln-298"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumNumbers</span>
<a name="ln-299"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">propNum</span>
<a name="ln-300"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">pcount</span>
<a name="ln-301"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">pcMat</span>
<a name="ln-302"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">vcMat</span>
<a name="ln-303"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">inegptr</span>
<a name="ln-304"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">nonInc</span>
<a name="ln-305"></a>
<a name="ln-306"></a>  <span class="c">! user settings for numerical parameters</span>
<a name="ln-307"></a>  <span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;HeatBalanceSettings:ConductionFiniteDifference&#39;</span>
<a name="ln-308"></a>
<a name="ln-309"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-310"></a><span class="k">    CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-311"></a>                       <span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-312"></a>                   <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-313"></a>                   <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-314"></a>
<a name="ln-315"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-316"></a>
<a name="ln-317"></a><span class="k">      SELECT CASE</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-318"></a>
<a name="ln-319"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;CRANKNICHOLSONSECONDORDER&#39;</span><span class="p">)</span>
<a name="ln-320"></a>        <span class="n">CondFDSchemeType</span> <span class="o">=</span> <span class="n">CrankNicholsonSecondOrder</span>
<a name="ln-321"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;FULLYIMPLICITFIRSTORDER&#39;</span><span class="p">)</span>
<a name="ln-322"></a>        <span class="n">CondFDSchemeType</span> <span class="o">=</span> <span class="n">FullyImplicitFirstOrder</span>
<a name="ln-323"></a>      <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-324"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-325"></a>         <span class="s1">&#39; entered=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, must match CrankNicholsonSecondOrder or FullyImplicitFirstOrder.&#39;</span><span class="p">)</span>
<a name="ln-326"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-327"></a>      <span class="k">END SELECT</span>
<a name="ln-328"></a>
<a name="ln-329"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-330"></a>
<a name="ln-331"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-332"></a><span class="k">      </span><span class="n">SpaceDescritConstant</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-333"></a>    <span class="n">ENDIF</span>
<a name="ln-334"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-335"></a><span class="k">      </span><span class="n">CondFDRelaxFactorInput</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-336"></a>      <span class="n">CondFDRelaxFactor</span>      <span class="o">=</span> <span class="n">CondFDRelaxFactorInput</span>
<a name="ln-337"></a>    <span class="n">ENDIF</span>
<a name="ln-338"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-339"></a><span class="k">      </span><span class="n">MaxAllowedDelTempCondFD</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-340"></a>    <span class="n">ENDIF</span>
<a name="ln-341"></a>
<a name="ln-342"></a>  <span class="n">ENDIF</span> <span class="c">! settings object</span>
<a name="ln-343"></a>
<a name="ln-344"></a>  <span class="n">pcMat</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;MaterialProperty:PhaseChange&#39;</span><span class="p">)</span>
<a name="ln-345"></a>  <span class="n">vcMat</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;MaterialProperty:VariableThermalConductivity&#39;</span><span class="p">)</span>
<a name="ln-346"></a>
<a name="ln-347"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">TotMaterials</span><span class="p">))</span>
<a name="ln-348"></a>
<a name="ln-349"></a>  <span class="c">! Load the additional CondFD Material properties</span>
<a name="ln-350"></a>  <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;MaterialProperty:PhaseChange&#39;</span>    <span class="c">! Phase Change Information First</span>
<a name="ln-351"></a>
<a name="ln-352"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">pcMat</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">Then</span>                      <span class="c">!  Get Phase Change info</span>
<a name="ln-353"></a><span class="c">!    CondFDVariableProperties = .TRUE.</span>
<a name="ln-354"></a>    <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">pcMat</span>
<a name="ln-355"></a>
<a name="ln-356"></a>    <span class="c">!Call Input Get routine to retrieve material data</span>
<a name="ln-357"></a>      <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">Loop</span><span class="p">,</span><span class="n">MaterialNames</span><span class="p">,</span><span class="n">MaterialNumAlpha</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-358"></a>                       <span class="n">MaterialProps</span><span class="p">,</span><span class="n">MaterialNumProp</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-359"></a>                   <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-360"></a>                   <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-361"></a>
<a name="ln-362"></a>
<a name="ln-363"></a>    <span class="c">!Load the material derived type from the input data.</span>
<a name="ln-364"></a>      <span class="n">MaterNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">MaterialNames</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Material</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotMaterials</span><span class="p">)</span>
<a name="ln-365"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MaterNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-366"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-367"></a>           <span class="s1">&#39; entered=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MaterialNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, must match to a valid Material name.&#39;</span><span class="p">)</span>
<a name="ln-368"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-369"></a>        <span class="k">Cycle</span>
<a name="ln-370"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-371"></a>
<a name="ln-372"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">Group</span> <span class="o">/=</span> <span class="n">RegularMaterial</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-373"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-374"></a>           <span class="s1">&#39;: Reference Material is not appropriate type for CondFD properties, material=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-375"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, must have regular properties (L,Cp,K,D)&#39;</span><span class="p">)</span>
<a name="ln-376"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-377"></a>      <span class="n">ENDIF</span>
<a name="ln-378"></a>
<a name="ln-379"></a>
<a name="ln-380"></a>    <span class="c">! Once the material derived type number is found then load the additional CondFD variable material properties</span>
<a name="ln-381"></a>    <span class="c">!   Some or all may be zero (default).  They will be checked when calculating node temperatures</span>
<a name="ln-382"></a>      <span class="n">MaterialFD</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">tk1</span>          <span class="o">=</span> <span class="n">MaterialProps</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-383"></a>      <span class="n">MaterialFD</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">numTempEnth</span>  <span class="o">=</span> <span class="p">(</span><span class="n">MaterialNumProp</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<a name="ln-384"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">numTempEnth</span><span class="o">*</span><span class="mi">2</span> <span class="o">/=</span> <span class="p">(</span><span class="n">MaterialNumProp</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-385"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetCondFDInput: &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">MaterialNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-386"></a>           <span class="s1">&#39;&quot;, mismatched pairs&#39;</span><span class="p">)</span>
<a name="ln-387"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...expected &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">numTempEnth</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-388"></a>           <span class="s1">&#39; pairs, but only entered &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MaterialNumProp</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; numbers.&#39;</span><span class="p">)</span>
<a name="ln-389"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-390"></a>      <span class="n">ENDIF</span>
<a name="ln-391"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">TempEnth</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">numTempEnth</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-392"></a>      <span class="n">MaterialFD</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">TempEnth</span>     <span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-393"></a>      <span class="n">propNum</span><span class="o">=</span><span class="mi">2</span>
<a name="ln-394"></a>      <span class="c">! Temperature first</span>
<a name="ln-395"></a>      <span class="k">DO </span><span class="n">pcount</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">numTempEnth</span>
<a name="ln-396"></a>        <span class="n">MaterialFD</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">TempEnth</span><span class="p">(</span><span class="n">pcount</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>   <span class="o">=</span> <span class="n">MaterialProps</span><span class="p">(</span><span class="n">propNum</span><span class="p">)</span>
<a name="ln-397"></a>        <span class="n">propNum</span><span class="o">=</span><span class="n">propNum</span><span class="o">+</span><span class="mi">2</span>
<a name="ln-398"></a>      <span class="n">ENDDO</span>
<a name="ln-399"></a>      <span class="n">propNum</span><span class="o">=</span><span class="mi">3</span>
<a name="ln-400"></a>      <span class="c">! Then Enthalpy</span>
<a name="ln-401"></a>      <span class="k">DO </span><span class="n">pcount</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">numTempEnth</span>
<a name="ln-402"></a>        <span class="n">MaterialFD</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">TempEnth</span><span class="p">(</span><span class="n">pcount</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>   <span class="o">=</span> <span class="n">MaterialProps</span><span class="p">(</span><span class="n">propNum</span><span class="p">)</span>
<a name="ln-403"></a>        <span class="n">propNum</span><span class="o">=</span><span class="n">propNum</span><span class="o">+</span><span class="mi">2</span>
<a name="ln-404"></a>      <span class="n">ENDDO</span>
<a name="ln-405"></a>      <span class="n">nonInc</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-406"></a>      <span class="n">inegptr</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-407"></a>      <span class="k">DO </span><span class="n">pcount</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">numTempEnth</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-408"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">TempEnth</span><span class="p">(</span><span class="n">pcount</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">MaterialFD</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">TempEnth</span><span class="p">(</span><span class="n">pcount</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="k">CYCLE</span>
<a name="ln-409"></a><span class="k">        </span><span class="n">nonInc</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-410"></a>        <span class="n">inegptr</span><span class="o">=</span><span class="n">pcount</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-411"></a>        <span class="k">EXIT</span>
<a name="ln-412"></a><span class="k">      </span><span class="n">ENDDO</span>
<a name="ln-413"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">nonInc</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-414"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetCondFDInput: &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">MaterialNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-415"></a>           <span class="s1">&#39;&quot;, non increasing Temperatures. Temperatures must be strictly increasing.&#39;</span><span class="p">)</span>
<a name="ln-416"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs first at item=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">inegptr</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;], value=[&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-417"></a>           <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">TempEnth</span><span class="p">(</span><span class="n">inegptr</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-418"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-419"></a>      <span class="n">ENDIF</span>
<a name="ln-420"></a>      <span class="n">nonInc</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-421"></a>      <span class="n">inegptr</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-422"></a>      <span class="k">DO </span><span class="n">pcount</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">numTempEnth</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-423"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">TempEnth</span><span class="p">(</span><span class="n">pcount</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">MaterialFD</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">TempEnth</span><span class="p">(</span><span class="n">pcount</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="k">CYCLE</span>
<a name="ln-424"></a><span class="k">        </span><span class="n">nonInc</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-425"></a>        <span class="n">inegptr</span><span class="o">=</span><span class="n">pcount</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-426"></a>        <span class="k">EXIT</span>
<a name="ln-427"></a><span class="k">      </span><span class="n">ENDDO</span>
<a name="ln-428"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">nonInc</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-429"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetCondFDInput: &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">MaterialNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-430"></a>           <span class="s1">&#39;&quot;, non increasing Enthalpy.&#39;</span><span class="p">)</span>
<a name="ln-431"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs first at item=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">inegptr</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;], value=[&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-432"></a>           <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">TempEnth</span><span class="p">(</span><span class="n">inegptr</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-433"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...These values may be Cp (Specific Heat) rather than Enthalpy.  Please correct.&#39;</span><span class="p">)</span>
<a name="ln-434"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-435"></a>      <span class="n">ENDIF</span>
<a name="ln-436"></a>    <span class="n">ENDDO</span>
<a name="ln-437"></a>  <span class="k">END IF</span>
<a name="ln-438"></a><span class="c">!   Get CondFD Variable Thermal Conductivity Input</span>
<a name="ln-439"></a>
<a name="ln-440"></a>  <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;MaterialProperty:VariableThermalConductivity&#39;</span>    <span class="c">! Variable Thermal Conductivity Info next</span>
<a name="ln-441"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">vcMat</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">Then</span>   <span class="c">!  variable k info</span>
<a name="ln-442"></a><span class="c">!    CondFDVariableProperties = .TRUE.</span>
<a name="ln-443"></a>    <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">vcMat</span>
<a name="ln-444"></a>
<a name="ln-445"></a>      <span class="c">!Call Input Get routine to retrieve material data</span>
<a name="ln-446"></a>      <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">Loop</span><span class="p">,</span><span class="n">MaterialNames</span><span class="p">,</span><span class="n">MaterialNumAlpha</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-447"></a>                       <span class="n">MaterialProps</span><span class="p">,</span><span class="n">MaterialNumProp</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-448"></a>                   <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-449"></a>                   <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-450"></a>
<a name="ln-451"></a>
<a name="ln-452"></a>      <span class="c">!Load the material derived type from the input data.</span>
<a name="ln-453"></a>      <span class="n">MaterNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">MaterialNames</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Material</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotMaterials</span><span class="p">)</span>
<a name="ln-454"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MaterNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-455"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-456"></a>         <span class="s1">&#39; entered=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MaterialNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, must match to a valid Material name.&#39;</span><span class="p">)</span>
<a name="ln-457"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-458"></a>        <span class="k">Cycle</span>
<a name="ln-459"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-460"></a>
<a name="ln-461"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">Group</span> <span class="o">/=</span> <span class="n">RegularMaterial</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-462"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-463"></a>           <span class="s1">&#39;: Reference Material is not appropriate type for CondFD properties, material=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-464"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, must have regular properties (L,Cp,K,D)&#39;</span><span class="p">)</span>
<a name="ln-465"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-466"></a>      <span class="n">ENDIF</span>
<a name="ln-467"></a>
<a name="ln-468"></a>
<a name="ln-469"></a>    <span class="c">! Once the material derived type number is found then load the additional CondFD variable material properties</span>
<a name="ln-470"></a>    <span class="c">!   Some or all may be zero (default).  They will be checked when calculating node temperatures</span>
<a name="ln-471"></a>      <span class="n">MaterialFD</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">numTempCond</span>  <span class="o">=</span> <span class="n">MaterialNumProp</span><span class="o">/</span><span class="mi">2</span>
<a name="ln-472"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">numTempCond</span><span class="o">*</span><span class="mi">2</span> <span class="o">/=</span> <span class="n">MaterialNumProp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-473"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetCondFDInput: &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">MaterialNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-474"></a>           <span class="s1">&#39;&quot;, mismatched pairs&#39;</span><span class="p">)</span>
<a name="ln-475"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...expected &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">numTempCond</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-476"></a>           <span class="s1">&#39; pairs, but only entered &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MaterialNumProp</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; numbers.&#39;</span><span class="p">)</span>
<a name="ln-477"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-478"></a>      <span class="n">ENDIF</span>
<a name="ln-479"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">TempCond</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">numTempCond</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-480"></a>      <span class="n">MaterialFD</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">TempCond</span>    <span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-481"></a>      <span class="n">propNum</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-482"></a>      <span class="c">! Temperature first</span>
<a name="ln-483"></a>      <span class="k">DO </span><span class="n">pcount</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">numTempCond</span>
<a name="ln-484"></a>        <span class="n">MaterialFD</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">TempCond</span><span class="p">(</span><span class="n">pcount</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>   <span class="o">=</span> <span class="n">MaterialProps</span><span class="p">(</span><span class="n">propNum</span><span class="p">)</span>
<a name="ln-485"></a>        <span class="n">propNum</span><span class="o">=</span><span class="n">propNum</span><span class="o">+</span><span class="mi">2</span>
<a name="ln-486"></a>      <span class="n">ENDDO</span>
<a name="ln-487"></a>      <span class="n">propNum</span><span class="o">=</span><span class="mi">2</span>
<a name="ln-488"></a>      <span class="c">! Then Conductivity</span>
<a name="ln-489"></a>      <span class="k">DO </span><span class="n">pcount</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">numTempCond</span>
<a name="ln-490"></a>        <span class="n">MaterialFD</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">TempCond</span><span class="p">(</span><span class="n">pcount</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>   <span class="o">=</span> <span class="n">MaterialProps</span><span class="p">(</span><span class="n">propNum</span><span class="p">)</span>
<a name="ln-491"></a>        <span class="n">propNum</span><span class="o">=</span><span class="n">propNum</span><span class="o">+</span><span class="mi">2</span>
<a name="ln-492"></a>      <span class="n">ENDDO</span>
<a name="ln-493"></a>      <span class="n">nonInc</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-494"></a>      <span class="n">inegptr</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-495"></a>      <span class="k">DO </span><span class="n">pcount</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">numTempCond</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-496"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">TempCond</span><span class="p">(</span><span class="n">pcount</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">MaterialFD</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">TempCond</span><span class="p">(</span><span class="n">pcount</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="k">CYCLE</span>
<a name="ln-497"></a><span class="k">        </span><span class="n">nonInc</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-498"></a>        <span class="n">inegptr</span><span class="o">=</span><span class="n">pcount</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-499"></a>        <span class="k">EXIT</span>
<a name="ln-500"></a><span class="k">      </span><span class="n">ENDDO</span>
<a name="ln-501"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">nonInc</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-502"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetCondFDInput: &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">MaterialNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-503"></a>           <span class="s1">&#39;&quot;, non increasing Temperatures. Temperatures must be strictly increasing.&#39;</span><span class="p">)</span>
<a name="ln-504"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs first at item=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">inegptr</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;], value=[&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-505"></a>           <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">TempCond</span><span class="p">(</span><span class="n">inegptr</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-506"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-507"></a>      <span class="n">ENDIF</span>
<a name="ln-508"></a>    <span class="n">ENDDO</span>
<a name="ln-509"></a>  <span class="k">END IF</span>
<a name="ln-510"></a>
<a name="ln-511"></a><span class="k">  DO </span><span class="n">MaterNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotMaterials</span>
<a name="ln-512"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">numTempEnth</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-513"></a><span class="k">      </span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">numTempEnth</span><span class="o">=</span><span class="mi">3</span>
<a name="ln-514"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">TempEnth</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">numTempEnth</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-515"></a>      <span class="n">MaterialFD</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">TempEnth</span><span class="o">=-</span><span class="mi">10</span><span class="mf">0.0d0</span>
<a name="ln-516"></a>    <span class="n">ENDIF</span>
<a name="ln-517"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">numTempCond</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-518"></a><span class="k">      </span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">numTempCond</span><span class="o">=</span><span class="mi">3</span>
<a name="ln-519"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">TempCOnd</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">numTempCond</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-520"></a>      <span class="n">MaterialFD</span><span class="p">(</span><span class="n">MaterNum</span><span class="p">)%</span><span class="n">TempCond</span><span class="o">=-</span><span class="mi">10</span><span class="mf">0.0d0</span>
<a name="ln-521"></a>    <span class="n">ENDIF</span>
<a name="ln-522"></a>  <span class="n">ENDDO</span>
<a name="ln-523"></a>
<a name="ln-524"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-525"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;GetCondFDInput: Errors found getting ConductionFiniteDifference properties. Program terminates.&#39;</span><span class="p">)</span>
<a name="ln-526"></a>  <span class="n">ENDIF</span>
<a name="ln-527"></a>
<a name="ln-528"></a>  <span class="k">CALL </span><span class="n">InitialInitHeatBalFiniteDiff</span>
<a name="ln-529"></a>
<a name="ln-530"></a>  <span class="k">RETURN</span>
<a name="ln-531"></a>
<a name="ln-532"></a><span class="k">END SUBROUTINE </span><span class="n">GetCondFDInput</span>
<a name="ln-533"></a>
<a name="ln-534"></a><span class="k">SUBROUTINE </span><span class="n">InitHeatBalFiniteDiff</span>
<a name="ln-535"></a>
<a name="ln-536"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-537"></a>          <span class="c">!       AUTHOR         Richard J. Liesen</span>
<a name="ln-538"></a>          <span class="c">!       DATE WRITTEN   Oct 2003</span>
<a name="ln-539"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-540"></a>          <span class="c">!       RE-ENGINEERED  C O Pedersen 2006</span>
<a name="ln-541"></a>          <span class="c">!                      B. Griffith May 2011 move begin-environment and every-timestep inits, cleanup formatting</span>
<a name="ln-542"></a>
<a name="ln-543"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-544"></a>          <span class="c">! This subroutine sets the initial values for the FD moisture calculation</span>
<a name="ln-545"></a>
<a name="ln-546"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-547"></a>
<a name="ln-548"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-549"></a>          <span class="c">!</span>
<a name="ln-550"></a>
<a name="ln-551"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-552"></a>  <span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span><span class="n">SetupOutputVariable</span>
<a name="ln-553"></a>  <span class="k">USE </span><span class="n">DataSurfaces</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">HeatTransferModel_CondFD</span>
<a name="ln-554"></a>
<a name="ln-555"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-556"></a>
<a name="ln-557"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-558"></a>          <span class="c">! na</span>
<a name="ln-559"></a>
<a name="ln-560"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-561"></a>          <span class="c">! na</span>
<a name="ln-562"></a>
<a name="ln-563"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-564"></a>          <span class="c">! na</span>
<a name="ln-565"></a>
<a name="ln-566"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-567"></a>  <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">SAVE</span>        <span class="kd">::</span> <span class="n">MyEnvrnFlag</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-568"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SurfNum</span>
<a name="ln-569"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ConstrNum</span>    <span class="c">! Loop counter</span>
<a name="ln-570"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">errorsFound</span>
<a name="ln-571"></a>
<a name="ln-572"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetHBFiniteDiffInputFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-573"></a>      <span class="c">! Obtains conduction FD related parameters from input file</span>
<a name="ln-574"></a>    <span class="k">CALL </span><span class="n">GetCondFDInput</span>
<a name="ln-575"></a>    <span class="n">GetHBFiniteDiffInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-576"></a>  <span class="n">ENDIF</span>
<a name="ln-577"></a>
<a name="ln-578"></a>  <span class="n">errorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-579"></a>
<a name="ln-580"></a>  <span class="c">! now do begin environment inits.</span>
<a name="ln-581"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">BeginEnvrnFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MyEnvrnFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-582"></a><span class="k">    DO </span><span class="n">SurfNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-583"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransferAlgorithm</span> <span class="o">/=</span> <span class="n">HeatTransferModel_CondFD</span><span class="p">)</span>   <span class="k">CYCLE</span>
<a name="ln-584"></a><span class="k">      IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>  <span class="c">! Shading surface, not really a heat transfer surface</span>
<a name="ln-585"></a>      <span class="n">ConstrNum</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-586"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TypeIsWindow</span><span class="p">)</span> <span class="k">CYCLE</span>  <span class="c">!  Windows simulated in Window module</span>
<a name="ln-587"></a>      <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">T</span>              <span class="o">=</span> <span class="n">TempInitValue</span>
<a name="ln-588"></a>      <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TOld</span>           <span class="o">=</span> <span class="n">TempInitValue</span>
<a name="ln-589"></a>      <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TT</span>             <span class="o">=</span> <span class="n">TempInitValue</span>
<a name="ln-590"></a>      <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Rhov</span>           <span class="o">=</span> <span class="n">RhovInitValue</span>
<a name="ln-591"></a>      <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">RhovOld</span>        <span class="o">=</span> <span class="n">RhovInitValue</span>
<a name="ln-592"></a>      <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">RhoT</span>           <span class="o">=</span> <span class="n">RhovInitValue</span>
<a name="ln-593"></a>      <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TD</span>             <span class="o">=</span> <span class="n">TempInitValue</span>
<a name="ln-594"></a>      <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TDT</span>            <span class="o">=</span> <span class="n">TempInitValue</span>
<a name="ln-595"></a>      <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TDTLast</span>        <span class="o">=</span> <span class="n">TempInitValue</span>
<a name="ln-596"></a>      <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TDOld</span>          <span class="o">=</span> <span class="n">TempInitValue</span>
<a name="ln-597"></a>      <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TDreport</span>       <span class="o">=</span> <span class="n">TempInitValue</span>
<a name="ln-598"></a>      <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">RH</span>             <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-599"></a>      <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">RHreport</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-600"></a>      <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">EnthOld</span>        <span class="o">=</span> <span class="n">EnthInitValue</span>
<a name="ln-601"></a>      <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">EnthNew</span>        <span class="o">=</span> <span class="n">EnthInitValue</span>
<a name="ln-602"></a>      <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">EnthLast</span>       <span class="o">=</span> <span class="n">EnthInitValue</span>
<a name="ln-603"></a>
<a name="ln-604"></a>      <span class="n">TempOutsideAirFD</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>         <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-605"></a>      <span class="n">RhoVaporAirOut</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>           <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-606"></a>      <span class="n">RhoVaporSurfIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>           <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-607"></a>      <span class="n">RhoVaporAirIn</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>            <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-608"></a>      <span class="n">HConvExtFD</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>               <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-609"></a>      <span class="n">HMassConvExtFD</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>           <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-610"></a>      <span class="n">HConvInFD</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>                <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-611"></a>      <span class="n">HMassConvInFD</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>            <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-612"></a>      <span class="n">HSkyFD</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>                   <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-613"></a>      <span class="n">HGrndFD</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>                  <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-614"></a>      <span class="n">HAirFD</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>                   <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-615"></a>    <span class="n">ENDDO</span>
<a name="ln-616"></a>    <span class="n">WarmupSurfTemp</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-617"></a>    <span class="n">MyEnvrnFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-618"></a>  <span class="k">END IF</span>
<a name="ln-619"></a><span class="k">  IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">BeginEnvrnFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-620"></a><span class="k">    </span><span class="n">MyEnvrnFlag</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-621"></a>  <span class="n">ENDIF</span>
<a name="ln-622"></a>
<a name="ln-623"></a>  <span class="c">! now do every timestep inits</span>
<a name="ln-624"></a>
<a name="ln-625"></a>  <span class="k">DO </span><span class="n">SurfNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-626"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransferAlgorithm</span> <span class="o">/=</span> <span class="n">HeatTransferModel_CondFD</span><span class="p">)</span>  <span class="k">CYCLE</span>
<a name="ln-627"></a><span class="k">    IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>  <span class="c">! Shading surface, not really a heat transfer surface</span>
<a name="ln-628"></a>    <span class="n">ConstrNum</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-629"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TypeIsWindow</span><span class="p">)</span> <span class="k">CYCLE</span>  <span class="c">!  Windows simulated in Window module</span>
<a name="ln-630"></a>    <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">T</span>        <span class="o">=</span> <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TOld</span>
<a name="ln-631"></a>    <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Rhov</span>     <span class="o">=</span> <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">RhovOld</span>
<a name="ln-632"></a>    <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TD</span>       <span class="o">=</span> <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TDOld</span>
<a name="ln-633"></a>    <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TDT</span>      <span class="o">=</span> <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TDreport</span> <span class="c">!PT changes from TDold to TDreport</span>
<a name="ln-634"></a>    <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TDTLast</span>  <span class="o">=</span> <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TDOld</span>
<a name="ln-635"></a>    <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">EnthOld</span>  <span class="o">=</span> <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">EnthOld</span>
<a name="ln-636"></a>    <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">EnthNew</span>  <span class="o">=</span> <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">EnthOld</span>
<a name="ln-637"></a>    <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">EnthLast</span> <span class="o">=</span> <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">EnthOld</span>
<a name="ln-638"></a>  <span class="n">ENDDO</span>
<a name="ln-639"></a>
<a name="ln-640"></a>  <span class="k">RETURN</span>
<a name="ln-641"></a>
<a name="ln-642"></a><span class="k">END SUBROUTINE </span><span class="n">InitHeatBalFiniteDiff</span>
<a name="ln-643"></a>
<a name="ln-644"></a>
<a name="ln-645"></a><span class="k">SUBROUTINE </span><span class="n">InitialInitHeatBalFiniteDiff</span>
<a name="ln-646"></a>
<a name="ln-647"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-648"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-649"></a>          <span class="c">!       DATE WRITTEN   March 2012</span>
<a name="ln-650"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-651"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-652"></a>
<a name="ln-653"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-654"></a>          <span class="c">! This routine performs the original allocate, inits and setup output variables for the</span>
<a name="ln-655"></a>          <span class="c">! module.</span>
<a name="ln-656"></a>
<a name="ln-657"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-658"></a>          <span class="c">! na</span>
<a name="ln-659"></a>
<a name="ln-660"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-661"></a>          <span class="c">! na</span>
<a name="ln-662"></a>
<a name="ln-663"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-664"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>      <span class="n">ONLY</span> <span class="p">:</span> <span class="n">TrimSigDigits</span><span class="p">,</span> <span class="n">RoundSigDigits</span>
<a name="ln-665"></a>  <span class="k">USE </span><span class="n">DataSurfaces</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">HeatTransferModel_CondFD</span>
<a name="ln-666"></a>  <span class="k">USE </span><span class="n">DataHeatBalance</span><span class="p">,</span> <span class="n">Only</span><span class="p">:</span> <span class="n">HighDiffusivityThreshold</span><span class="p">,</span> <span class="n">ThinMaterialLayerThreshold</span>
<a name="ln-667"></a>
<a name="ln-668"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-669"></a>
<a name="ln-670"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-671"></a>          <span class="c">! na</span>
<a name="ln-672"></a>
<a name="ln-673"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-674"></a>          <span class="c">! na</span>
<a name="ln-675"></a>
<a name="ln-676"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-677"></a>          <span class="c">! na</span>
<a name="ln-678"></a>
<a name="ln-679"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-680"></a>          <span class="c">! na</span>
<a name="ln-681"></a>
<a name="ln-682"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-683"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Lay</span>
<a name="ln-684"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SurfNum</span>
<a name="ln-685"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LayChar</span>
<a name="ln-686"></a>
<a name="ln-687"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">dxn</span>        <span class="c">! Intermediate calculation of nodal spacing. This is the full dx. There is</span>
<a name="ln-688"></a>                                                  <span class="c">! a half dxn thick node at each surface. dxn is the &quot;capacitor&quot; spacing.</span>
<a name="ln-689"></a>  <span class="kt">INTEGER</span>                           <span class="kd">::</span> <span class="n">ipts1</span>      <span class="c">! Intermediate calculation for number of full thickness nodes per layer. There</span>
<a name="ln-690"></a>                                                  <span class="c">! are always two half nodes at the layer faces.</span>
<a name="ln-691"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Layer</span>      <span class="c">! Loop counter</span>
<a name="ln-692"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">OutwardMatLayerNum</span> <span class="c">! layer index, layer outward of the current layer</span>
<a name="ln-693"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">layerNode</span>
<a name="ln-694"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Delt</span>
<a name="ln-695"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ConstrNum</span>    <span class="c">! Loop counter</span>
<a name="ln-696"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotNodes</span>     <span class="c">! Loop counter</span>
<a name="ln-697"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CurrentLayer</span> <span class="c">! Loop counter</span>
<a name="ln-698"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Surf</span>         <span class="c">! Loop counter</span>
<a name="ln-699"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="nb">index</span>        <span class="c">! Loop Counters</span>
<a name="ln-700"></a>
<a name="ln-701"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Alpha</span>
<a name="ln-702"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Malpha</span>
<a name="ln-703"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">stabilitytemp</span>
<a name="ln-704"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">stabilitymoist</span>
<a name="ln-705"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">a</span>
<a name="ln-706"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">b</span>
<a name="ln-707"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">c</span>
<a name="ln-708"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">d</span>
<a name="ln-709"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">kt</span>
<a name="ln-710"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RhoS</span>
<a name="ln-711"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Por</span>
<a name="ln-712"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Cp</span>
<a name="ln-713"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Dv</span>
<a name="ln-714"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">errorsFound</span>
<a name="ln-715"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DeltaTimestep</span>      <span class="c">! zone timestep in seconds, for local check of properties</span>
<a name="ln-716"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThicknessThreshold</span> <span class="c">! min thickness consistent with other thermal properties, for local check</span>
<a name="ln-717"></a>
<a name="ln-718"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ConstructFD</span><span class="p">(</span><span class="n">TotConstructs</span><span class="p">))</span>
<a name="ln-719"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SigmaR</span><span class="p">(</span><span class="n">TotConstructs</span><span class="p">))</span>
<a name="ln-720"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SigmaC</span><span class="p">(</span><span class="n">TotConstructs</span><span class="p">))</span>
<a name="ln-721"></a>
<a name="ln-722"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfaceFD</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-723"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">QHeatInFlux</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-724"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">QHeatOutFlux</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-725"></a><span class="c">!  ALLOCATE(QFluxInArrivSurfCond(TotSurfaces))</span>
<a name="ln-726"></a><span class="c">!  ALLOCATE(QFluxOutArrivSurfCond(TotSurfaces))</span>
<a name="ln-727"></a><span class="c">!  ALLOCATE(OpaqSurfInsFaceConductionFlux(TotSurfaces))</span>
<a name="ln-728"></a><span class="c">!  ALLOCATE(OpaqSurfOutsideFaceConductionFlux(TotSurfaces))</span>
<a name="ln-729"></a><span class="c">!  ALLOCATE(QFluxZoneToInSurf(TotSurfaces))</span>
<a name="ln-730"></a><span class="c">!  ALLOCATE(QFluxOutsideToOutSurf(TotSurfaces))</span>
<a name="ln-731"></a>
<a name="ln-732"></a> <span class="c">! And then initialize</span>
<a name="ln-733"></a>  <span class="n">QHeatInFlux</span>  <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-734"></a>  <span class="n">QHeatOutFlux</span>  <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-735"></a>  <span class="c">!QFluxZoneToInSurf  = 0.d0</span>
<a name="ln-736"></a>  <span class="c">!QFluxOutsideToOutSurf  = 0.d0</span>
<a name="ln-737"></a>  <span class="c">!QFluxInArrivSurfCond  = 0.d0</span>
<a name="ln-738"></a>  <span class="c">!QFluxOutArrivSurfCond  = 0.d0</span>
<a name="ln-739"></a>  <span class="n">OpaqSurfInsFaceConductionFlux</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-740"></a>  <span class="n">OpaqSurfOutsideFaceConductionFlux</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-741"></a>
<a name="ln-742"></a>  <span class="c">! Setup Output Variables</span>
<a name="ln-743"></a>
<a name="ln-744"></a>  <span class="c">!  set a Delt that fits the zone time step and keeps it below 200s.</span>
<a name="ln-745"></a>
<a name="ln-746"></a>  <span class="n">fracTimeStepZone_Hour</span><span class="o">=</span><span class="mf">1.0d0</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">NumOfTimeStepInHour</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-747"></a>
<a name="ln-748"></a>  <span class="k">DO </span><span class="nb">index</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">20</span>
<a name="ln-749"></a>    <span class="n">Delt</span> <span class="o">=</span> <span class="p">(</span><span class="n">fracTimeStepZone_Hour</span><span class="o">*</span><span class="n">SecInHour</span><span class="p">)</span><span class="o">/</span><span class="nb">index</span>   <span class="c">! TimeStepZone = Zone time step in fractional hours</span>
<a name="ln-750"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="n">Delt</span> <span class="o">&lt;=</span> <span class="mi">200</span> <span class="p">)</span>  <span class="k">EXIT</span>
<a name="ln-751"></a><span class="k">  END DO</span>
<a name="ln-752"></a>
<a name="ln-753"></a><span class="k">  DO </span><span class="n">ConstrNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotConstructs</span>
<a name="ln-754"></a>    <span class="c">!Need to skip window constructions and eventually window materials</span>
<a name="ln-755"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TypeIsWindow</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-756"></a>
<a name="ln-757"></a><span class="k">    ALLOCATE</span><span class="p">(</span><span class="n">ConstructFD</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TotLayers</span><span class="p">))</span>
<a name="ln-758"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ConstructFD</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">Thickness</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TotLayers</span><span class="p">))</span>
<a name="ln-759"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ConstructFD</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">NodeNumPoint</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TotLayers</span><span class="p">))</span>
<a name="ln-760"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ConstructFD</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">DelX</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TotLayers</span><span class="p">))</span>
<a name="ln-761"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ConstructFD</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TempStability</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TotLayers</span><span class="p">))</span>
<a name="ln-762"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ConstructFD</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">MoistStability</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TotLayers</span><span class="p">))</span>
<a name="ln-763"></a>      <span class="c">! Node Number of the Interface node following each layer</span>
<a name="ln-764"></a><span class="c">!    ALLOCATE(ConstructFD(ConstrNum)%InterfaceNodeNums(Construct(ConstrNum)%TotLayers))</span>
<a name="ln-765"></a>
<a name="ln-766"></a>
<a name="ln-767"></a>    <span class="n">TotNodes</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-768"></a>    <span class="n">SigmaR</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)</span> <span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-769"></a>    <span class="n">SigmaC</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)</span> <span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-770"></a>
<a name="ln-771"></a>    <span class="k">DO </span><span class="n">Layer</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TotLayers</span>    <span class="c">! Begin layer loop ...</span>
<a name="ln-772"></a>
<a name="ln-773"></a>          <span class="c">! Loop through all of the layers in the current construct. The purpose</span>
<a name="ln-774"></a>          <span class="c">! of this loop is to define the thermal properties  and to.</span>
<a name="ln-775"></a>          <span class="c">! determine the total number of full size nodes in each layer.</span>
<a name="ln-776"></a>          <span class="c">! The number of temperature points is one more than this</span>
<a name="ln-777"></a>          <span class="c">! because of the two half nodes at the layer faces.</span>
<a name="ln-778"></a>          <span class="c">! The calculation of dxn used here is based on a standard stability</span>
<a name="ln-779"></a>          <span class="c">! criteria for explicit finite difference solutions.  This criteria</span>
<a name="ln-780"></a>          <span class="c">! was chosen not because it is viewed to be correct, but rather for</span>
<a name="ln-781"></a>          <span class="c">! lack of any better criteria at this time.  The use of a Fourier</span>
<a name="ln-782"></a>          <span class="c">! number based criteria such as this is probably physically correct.</span>
<a name="ln-783"></a>          <span class="c">!  Change to implicit formulation still uses explicit stability, but</span>
<a name="ln-784"></a>          <span class="c">! now there are special equations for R-only layers.</span>
<a name="ln-785"></a>
<a name="ln-786"></a>      <span class="n">CurrentLayer</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span>
<a name="ln-787"></a>
<a name="ln-788"></a>
<a name="ln-789"></a>      <span class="n">ConstructFD</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-790"></a>      <span class="n">ConstructFD</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">Thickness</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">Thickness</span>
<a name="ln-791"></a>
<a name="ln-792"></a>     <span class="c">! Do some quick error checks for this section.</span>
<a name="ln-793"></a>
<a name="ln-794"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">ROnly</span>  <span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Rlayer</span>
<a name="ln-795"></a>
<a name="ln-796"></a>        <span class="c">!  These values are only needed temporarily and to calculate flux,</span>
<a name="ln-797"></a>        <span class="c">!   Layer will be handled</span>
<a name="ln-798"></a>        <span class="c">!  as a pure R in the temperature calc.</span>
<a name="ln-799"></a>        <span class="c">! assign other properties based on resistance</span>
<a name="ln-800"></a>
<a name="ln-801"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">SpecHeat</span>  <span class="o">=</span> <span class="mf">0.0001d0</span>
<a name="ln-802"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">Density</span> <span class="o">=</span> <span class="mf">1.d0</span>
<a name="ln-803"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">currentLayer</span><span class="p">)%</span><span class="n">Thickness</span> <span class="o">=</span> <span class="mf">0.1d0</span>  <span class="c">!  arbitrary thickness for R layer</span>
<a name="ln-804"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">Conductivity</span><span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-805"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">currentLayer</span><span class="p">)%</span><span class="n">Thickness</span><span class="o">/</span><span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">Resistance</span>
<a name="ln-806"></a>        <span class="n">kt</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">Conductivity</span>
<a name="ln-807"></a>        <span class="n">ConstructFD</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">Thickness</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">Thickness</span>
<a name="ln-808"></a>
<a name="ln-809"></a>        <span class="n">SigmaR</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">SigmaR</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)</span> <span class="o">+</span> <span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">Resistance</span>  <span class="c">! add resistance of R layer</span>
<a name="ln-810"></a>        <span class="n">SigmaC</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">SigmaC</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)</span>  <span class="o">+</span> <span class="mf">0.0d0</span>                               <span class="c">!  no capacitance for R layer</span>
<a name="ln-811"></a>
<a name="ln-812"></a>        <span class="n">Alpha</span> <span class="o">=</span> <span class="n">kt</span><span class="o">/</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">Density</span><span class="o">*</span><span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">SpecHeat</span><span class="p">)</span>
<a name="ln-813"></a>
<a name="ln-814"></a>        <span class="n">mAlpha</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-815"></a>
<a name="ln-816"></a>      <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">Group</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="k">THEN</span>   <span class="c">!  Group 1 = Air</span>
<a name="ln-817"></a>
<a name="ln-818"></a>                <span class="c">!  Again, these values are only needed temporarily and to calculate flux,</span>
<a name="ln-819"></a>                <span class="c">!   Air layer will be handled</span>
<a name="ln-820"></a>                <span class="c">!  as a pure R in the temperature calc.</span>
<a name="ln-821"></a>                <span class="c">!</span>
<a name="ln-822"></a>                <span class="c">! assign</span>
<a name="ln-823"></a>                <span class="c">! other properties based on resistance</span>
<a name="ln-824"></a>
<a name="ln-825"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">SpecHeat</span>  <span class="o">=</span> <span class="mf">0.0001d0</span>
<a name="ln-826"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">Density</span> <span class="o">=</span> <span class="mf">1.d0</span>
<a name="ln-827"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">currentLayer</span><span class="p">)%</span><span class="n">Thickness</span> <span class="o">=</span> <span class="mf">0.1d0</span>  <span class="c">!  arbitrary thickness for R layer</span>
<a name="ln-828"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">currentLayer</span><span class="p">)%</span><span class="n">Conductivity</span><span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-829"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">currentLayer</span><span class="p">)%</span><span class="n">Thickness</span><span class="o">/</span><span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">Resistance</span>
<a name="ln-830"></a>        <span class="n">kt</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">Conductivity</span>
<a name="ln-831"></a>        <span class="n">ConstructFD</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">Thickness</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">Thickness</span>
<a name="ln-832"></a>
<a name="ln-833"></a>        <span class="n">SigmaR</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">SigmaR</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)</span> <span class="o">+</span> <span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">Resistance</span>  <span class="c">! add resistance of R layer</span>
<a name="ln-834"></a>        <span class="n">SigmaC</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">SigmaC</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)</span>  <span class="o">+</span> <span class="mf">0.0d0</span>                               <span class="c">!  no capacitance for R layer</span>
<a name="ln-835"></a>
<a name="ln-836"></a>        <span class="n">Alpha</span> <span class="o">=</span> <span class="n">kt</span><span class="o">/</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">Density</span><span class="o">*</span><span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">SpecHeat</span><span class="p">)</span>
<a name="ln-837"></a>        <span class="n">mAlpha</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-838"></a>      <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TypeIsIRT</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! make similar to air? (that didn&#39;t seem to work well)</span>
<a name="ln-839"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;InitHeatBalFiniteDiff: Construction =&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-840"></a>             <span class="s1">&#39;&quot; uses Material:InfraredTransparent. Cannot be used currently with finite difference calculations.&#39;</span><span class="p">)</span>
<a name="ln-841"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">IsUsed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-842"></a><span class="k">          CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...since this construction is used in a surface, the simulation is not allowed.&#39;</span><span class="p">)</span>
<a name="ln-843"></a>          <span class="n">errorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-844"></a>        <span class="k">ELSE</span>
<a name="ln-845"></a><span class="k">          CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...if this construction were used in a surface, the simulation would be terminated.&#39;</span><span class="p">)</span>
<a name="ln-846"></a>        <span class="n">ENDIF</span>
<a name="ln-847"></a>        <span class="k">CYCLE</span>
<a name="ln-848"></a><span class="c">!            ! set properties to get past other initializations.</span>
<a name="ln-849"></a><span class="c">!          Material(CurrentLayer)%SpecHeat  = 0.0001d0</span>
<a name="ln-850"></a><span class="c">!          Material(CurrentLayer)%Density = 0.0001d0</span>
<a name="ln-851"></a><span class="c">!          Material(currentLayer)%Thickness = 0.1d0  !  arbitrary thickness for R layer</span>
<a name="ln-852"></a><span class="c">!          Material(currentLayer)%Conductivity= &amp;</span>
<a name="ln-853"></a><span class="c">!    -      Material(currentLayer)%Thickness/Material(CurrentLayer)%Resistance</span>
<a name="ln-854"></a><span class="c">!          kt = Material(CurrentLayer)%Conductivity</span>
<a name="ln-855"></a><span class="c">!          ConstructFD(ConstrNum)%Thickness(Layer) = Material(CurrentLayer)%Thickness</span>
<a name="ln-856"></a><span class="c">!</span>
<a name="ln-857"></a><span class="c">!          SigmaR(ConstrNum) = SigmaR(ConstrNum) + Material(CurrentLayer)%Resistance  ! add resistance of R layer</span>
<a name="ln-858"></a><span class="c">!          SigmaC(ConstrNum) = SigmaC(ConstrNum)  + 0.0                               !  no capacitance for R layer</span>
<a name="ln-859"></a><span class="c">!</span>
<a name="ln-860"></a><span class="c">!          Alpha = kt/(Material(CurrentLayer)%Density*Material(CurrentLayer)%SpecHeat)</span>
<a name="ln-861"></a><span class="c">!          mAlpha = 0.d0</span>
<a name="ln-862"></a>      <span class="k">ELSE</span>
<a name="ln-863"></a>       <span class="c">!    Regular material Properties</span>
<a name="ln-864"></a>        <span class="n">a</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">MoistACoeff</span>
<a name="ln-865"></a>        <span class="n">b</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">MoistBCoeff</span>
<a name="ln-866"></a>        <span class="n">c</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">MoistCCoeff</span>
<a name="ln-867"></a>        <span class="n">d</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">MoistDCoeff</span>
<a name="ln-868"></a>        <span class="n">kt</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">Conductivity</span>
<a name="ln-869"></a>        <span class="n">RhoS</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">Density</span>
<a name="ln-870"></a>        <span class="n">Por</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">Porosity</span>
<a name="ln-871"></a>        <span class="n">Cp</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">SpecHeat</span>
<a name="ln-872"></a>         <span class="c">! Need Resistance for reg layer</span>
<a name="ln-873"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">Resistance</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">currentLayer</span><span class="p">)%</span><span class="n">Thickness</span><span class="o">/</span><span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">Conductivity</span>
<a name="ln-874"></a>        <span class="n">Dv</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">VaporDiffus</span>
<a name="ln-875"></a>        <span class="n">SigmaR</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">SigmaR</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)</span> <span class="o">+</span> <span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">Resistance</span>  <span class="c">! add resistance</span>
<a name="ln-876"></a>        <span class="n">SigmaC</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">SigmaC</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)</span>  <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-877"></a>        <span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">Density</span><span class="o">*</span><span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">SpecHeat</span><span class="o">*</span><span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">Thickness</span>
<a name="ln-878"></a>        <span class="n">Alpha</span> <span class="o">=</span> <span class="n">kt</span><span class="o">/</span><span class="p">(</span><span class="n">RhoS</span><span class="o">*</span><span class="n">Cp</span><span class="p">)</span>
<a name="ln-879"></a>        <span class="c">!   Alpha = kt*(Por+At*RhoS)/(RhoS*(Bv*Por*Lambda+Cp*(Por+At*RhoS)))</span>
<a name="ln-880"></a>        <span class="n">MAlpha</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-881"></a>
<a name="ln-882"></a>        <span class="c">!check for Material layers that are too thin and highly conductivity (not appropriate for surface models)</span>
<a name="ln-883"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Alpha</span> <span class="o">&gt;</span> <span class="n">HighDiffusivityThreshold</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">WarnedForHighDiffusivity</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-884"></a><span class="k">          </span><span class="n">DeltaTimestep</span>      <span class="o">=</span> <span class="n">TimeStepZone</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-885"></a>          <span class="n">ThicknessThreshold</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="n">Alpha</span> <span class="o">*</span> <span class="n">DeltaTimestep</span> <span class="o">*</span> <span class="mf">3.d0</span><span class="p">)</span>
<a name="ln-886"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">Thickness</span> <span class="o">&lt;</span> <span class="n">ThicknessThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-887"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;InitialInitHeatBalFiniteDiff: Found Material that is too thin and/or too highly conductive,&#39;</span> <span class="p">&amp;</span>
<a name="ln-888"></a>                                    <span class="o">//</span><span class="s1">&#39; material name = &#39;</span>  <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-889"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;High conductivity Material layers are not well supported by Conduction Finite Difference, &#39;</span> <span class="p">&amp;</span>
<a name="ln-890"></a>                                    <span class="o">//</span><span class="s1">&#39; material conductivity = &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">Conductivity</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-891"></a>                                    <span class="o">//</span><span class="s1">&#39; [W/m-K]&#39;</span><span class="p">)</span>
<a name="ln-892"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Material thermal diffusivity = &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Alpha</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="o">//</span><span class="s1">&#39; [m2/s]&#39;</span><span class="p">)</span>
<a name="ln-893"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Material with this thermal diffusivity should have thickness &gt; &#39;</span> <span class="p">&amp;</span>
<a name="ln-894"></a>                                      <span class="o">//</span>  <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">ThicknessThreshold</span> <span class="p">,</span> <span class="mi">5</span><span class="p">))</span> <span class="o">//</span> <span class="s1">&#39; [m]&#39;</span><span class="p">)</span>
<a name="ln-895"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">Thickness</span> <span class="o">&lt;</span> <span class="n">ThinMaterialLayerThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-896"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Material may be too thin to be modeled well, thickness = &#39;</span> <span class="p">&amp;</span>
<a name="ln-897"></a>                                      <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">currentLayer</span><span class="p">)%</span><span class="n">Thickness</span><span class="p">,</span> <span class="mi">5</span> <span class="p">))</span><span class="o">//</span><span class="s1">&#39; [m]&#39;</span><span class="p">)</span>
<a name="ln-898"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Material with this thermal diffusivity should have thickness &gt; &#39;</span> <span class="p">&amp;</span>
<a name="ln-899"></a>                                      <span class="o">//</span>  <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">ThinMaterialLayerThreshold</span> <span class="p">,</span> <span class="mi">5</span><span class="p">))</span> <span class="o">//</span> <span class="s1">&#39; [m]&#39;</span><span class="p">)</span>
<a name="ln-900"></a>            <span class="n">ENDIF</span>
<a name="ln-901"></a>            <span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">WarnedForHighDiffusivity</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-902"></a>          <span class="n">ENDIF</span>
<a name="ln-903"></a>        <span class="n">ENDIF</span>
<a name="ln-904"></a>
<a name="ln-905"></a>      <span class="k">END IF</span>  <span class="c">!  R, Air  or regular material properties and parameters</span>
<a name="ln-906"></a>
<a name="ln-907"></a>     <span class="c">! Proceed with setting node sizes in layers</span>
<a name="ln-908"></a>
<a name="ln-909"></a>      <span class="n">DXN</span><span class="o">=</span><span class="nb">SQRT</span><span class="p">(</span><span class="n">Alpha</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">SpaceDescritConstant</span><span class="p">)</span>  <span class="c">! The Fourier number is set using user constant</span>
<a name="ln-910"></a>
<a name="ln-911"></a>       <span class="c">! number of nodes=thickness/spacing.  This is number of full size node spaces across layer.</span>
<a name="ln-912"></a>      <span class="n">Ipts1</span><span class="o">=</span><span class="nb">INT</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">Thickness</span><span class="o">/</span><span class="n">DXN</span><span class="p">)</span>
<a name="ln-913"></a>       <span class="c">!  set high conductivity layers to a single full size node thickness. (two half nodes)</span>
<a name="ln-914"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">Ipts1</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="n">Ipts1</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-915"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">ROnly</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">Group</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-916"></a>
<a name="ln-917"></a><span class="k">        </span><span class="n">Ipts1</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c">!  single full node in R layers- surfaces of adjacent material or inside/outside layer</span>
<a name="ln-918"></a>      <span class="k">END If</span>
<a name="ln-919"></a>
<a name="ln-920"></a><span class="k">      </span><span class="n">Dxn</span><span class="o">=</span><span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">Thickness</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">Ipts1</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>  <span class="c">! full node thickness</span>
<a name="ln-921"></a>
<a name="ln-922"></a>      <span class="n">StabilityTemp</span> <span class="o">=</span> <span class="n">Alpha</span><span class="o">*</span><span class="n">Delt</span><span class="o">/</span><span class="n">dxn</span><span class="o">**</span><span class="mi">2</span>
<a name="ln-923"></a>      <span class="n">StabilityMoist</span> <span class="o">=</span> <span class="n">malpha</span><span class="o">*</span><span class="n">Delt</span><span class="o">/</span><span class="n">dxn</span><span class="o">**</span><span class="mi">2</span>
<a name="ln-924"></a>      <span class="n">ConstructFD</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TempStability</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span> <span class="o">=</span> <span class="n">StabilityTemp</span>
<a name="ln-925"></a>      <span class="n">ConstructFD</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">MoistStability</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span> <span class="o">=</span> <span class="n">StabilityMoist</span>
<a name="ln-926"></a>      <span class="n">ConstructFD</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">Delx</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span> <span class="o">=</span> <span class="n">DXN</span>
<a name="ln-927"></a>
<a name="ln-928"></a>      <span class="n">TotNodes</span> <span class="o">=</span> <span class="n">TotNodes</span> <span class="o">+</span> <span class="n">Ipts1</span>   <span class="c">!  number of full size nodes</span>
<a name="ln-929"></a>      <span class="n">ConstructFD</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">NodeNumPoint</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span> <span class="o">=</span> <span class="n">Ipts1</span>   <span class="c">!  number of full size nodes</span>
<a name="ln-930"></a>    <span class="k">END DO</span>   <span class="c">!  end of layer loop.</span>
<a name="ln-931"></a>
<a name="ln-932"></a>
<a name="ln-933"></a>    <span class="n">ConstructFD</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TotNodes</span> <span class="o">=</span> <span class="n">TotNodes</span>
<a name="ln-934"></a>    <span class="n">ConstructFD</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">DeltaTime</span> <span class="o">=</span> <span class="n">Delt</span>
<a name="ln-935"></a>
<a name="ln-936"></a>
<a name="ln-937"></a>
<a name="ln-938"></a>  <span class="k">END DO</span>            <span class="c">! End of Construction Loop.  TotNodes in each construction now set</span>
<a name="ln-939"></a>
<a name="ln-940"></a>  <span class="c">! now determine x location, or distance that nodes are from the outside face in meters</span>
<a name="ln-941"></a>  <span class="k">DO </span><span class="n">ConstrNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotConstructs</span>
<a name="ln-942"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">ConstructFD</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TotNodes</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-943"></a><span class="k">       ALLOCATE</span><span class="p">(</span><span class="n">ConstructFD</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">NodeXlocation</span><span class="p">(</span><span class="n">ConstructFD</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TotNodes</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">))</span>
<a name="ln-944"></a>       <span class="n">ConstructFD</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">NodeXlocation</span> <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! init them all</span>
<a name="ln-945"></a>       <span class="n">Ipts1</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! init counter</span>
<a name="ln-946"></a>       <span class="k">DO </span><span class="n">Layer</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TotLayers</span>
<a name="ln-947"></a>         <span class="n">OutwardMatLayerNum</span> <span class="o">=</span> <span class="n">Layer</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-948"></a>         <span class="k">DO </span><span class="n">layerNode</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ConstructFD</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">NodeNumPoint</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span>
<a name="ln-949"></a>           <span class="n">Ipts1</span> <span class="o">=</span> <span class="n">Ipts1</span> <span class="o">+</span><span class="mi">1</span>
<a name="ln-950"></a>           <span class="k">IF</span> <span class="p">(</span><span class="n">Ipts1</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-951"></a><span class="k">             </span><span class="n">ConstructFD</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">NodeXlocation</span><span class="p">(</span><span class="n">Ipts1</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! first node is on outside face</span>
<a name="ln-952"></a>
<a name="ln-953"></a>           <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">LayerNode</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-954"></a><span class="k">             IF</span> <span class="p">(</span> <span class="n">OutwardMatLayerNum</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">OutwardMatLayerNum</span> <span class="o">&lt;=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TotLayers</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-955"></a>             <span class="c">! later nodes are Delx away from previous, but use Delx from previous layer</span>
<a name="ln-956"></a>               <span class="n">ConstructFD</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">NodeXlocation</span><span class="p">(</span><span class="n">Ipts1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ConstructFD</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">NodeXlocation</span><span class="p">(</span><span class="n">Ipts1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-957"></a>                                                           <span class="o">+</span> <span class="n">ConstructFD</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">Delx</span><span class="p">(</span><span class="n">OutwardMatLayerNum</span><span class="p">)</span>
<a name="ln-958"></a>             <span class="n">ENDIF</span>
<a name="ln-959"></a>           <span class="k">ELSE</span>
<a name="ln-960"></a>             <span class="c">! later nodes are Delx away from previous</span>
<a name="ln-961"></a>             <span class="n">ConstructFD</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">NodeXlocation</span><span class="p">(</span><span class="n">Ipts1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ConstructFD</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">NodeXlocation</span><span class="p">(</span><span class="n">Ipts1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-962"></a>                                                           <span class="o">+</span> <span class="n">ConstructFD</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">Delx</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span>
<a name="ln-963"></a>           <span class="n">ENDIF</span>
<a name="ln-964"></a>
<a name="ln-965"></a>         <span class="n">ENDDO</span>
<a name="ln-966"></a>       <span class="n">ENDDO</span>
<a name="ln-967"></a>       <span class="n">Layer</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TotLayers</span>
<a name="ln-968"></a>       <span class="n">Ipts1</span> <span class="o">=</span> <span class="n">Ipts1</span> <span class="o">+</span><span class="mi">1</span>
<a name="ln-969"></a>       <span class="n">ConstructFD</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">NodeXlocation</span><span class="p">(</span><span class="n">Ipts1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ConstructFD</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">NodeXlocation</span><span class="p">(</span><span class="n">Ipts1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-970"></a>                                                           <span class="o">+</span> <span class="n">ConstructFD</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">Delx</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span>
<a name="ln-971"></a>     <span class="n">ENDIF</span>
<a name="ln-972"></a>  <span class="n">ENDDO</span>
<a name="ln-973"></a>
<a name="ln-974"></a>  <span class="k">DO </span><span class="n">Surf</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-975"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-976"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-977"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">HeatTransferAlgorithm</span> <span class="o">/=</span> <span class="n">HeatTransferModel_CondFD</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-978"></a><span class="c">!    IF(Surface(Surf)%Construction &lt;= 0) CYCLE  ! Shading surface, not really a heat transfer surface</span>
<a name="ln-979"></a>    <span class="n">ConstrNum</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-980"></a><span class="c">!    IF(Construct(ConstrNum)%TypeIsWindow) CYCLE  !  Windows simulated in Window module</span>
<a name="ln-981"></a>    <span class="n">TotNodes</span> <span class="o">=</span> <span class="n">ConstructFD</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TotNodes</span>
<a name="ln-982"></a>
<a name="ln-983"></a>     <span class="c">!Allocate the Surface Arrays</span>
<a name="ln-984"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">T</span><span class="p">(</span><span class="n">TotNodes</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<a name="ln-985"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TOld</span><span class="p">(</span><span class="n">TotNodes</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<a name="ln-986"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TT</span><span class="p">(</span><span class="n">TotNodes</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<a name="ln-987"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">Rhov</span><span class="p">(</span><span class="n">TotNodes</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<a name="ln-988"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">RhovOld</span><span class="p">(</span><span class="n">TotNodes</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<a name="ln-989"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">RhoT</span><span class="p">(</span><span class="n">TotNodes</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<a name="ln-990"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TD</span><span class="p">(</span><span class="n">TotNodes</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<a name="ln-991"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TDT</span><span class="p">(</span><span class="n">TotNodes</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<a name="ln-992"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TDTLast</span><span class="p">(</span><span class="n">TotNodes</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<a name="ln-993"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TDOld</span><span class="p">(</span><span class="n">TotNodes</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<a name="ln-994"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TDreport</span><span class="p">(</span><span class="n">TotNodes</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<a name="ln-995"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">RH</span><span class="p">(</span><span class="n">TotNodes</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<a name="ln-996"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">RHreport</span><span class="p">(</span><span class="n">TotNodes</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<a name="ln-997"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">EnthOld</span><span class="p">(</span><span class="n">TotNodes</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<a name="ln-998"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">EnthNew</span><span class="p">(</span><span class="n">TotNodes</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<a name="ln-999"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">EnthLast</span><span class="p">(</span><span class="n">TotNodes</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<a name="ln-1000"></a>
<a name="ln-1001"></a>
<a name="ln-1002"></a>    <span class="c">!Initialize the allocated arrays.</span>
<a name="ln-1003"></a>    <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">T</span>              <span class="o">=</span> <span class="n">TempInitValue</span>
<a name="ln-1004"></a>    <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TOld</span>           <span class="o">=</span> <span class="n">TempInitValue</span>
<a name="ln-1005"></a>    <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TT</span>             <span class="o">=</span> <span class="n">TempInitValue</span>
<a name="ln-1006"></a>    <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">Rhov</span>           <span class="o">=</span> <span class="n">RhovInitValue</span>
<a name="ln-1007"></a>    <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">RhovOld</span>        <span class="o">=</span> <span class="n">RhovInitValue</span>
<a name="ln-1008"></a>    <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">RhoT</span>           <span class="o">=</span> <span class="n">RhovInitValue</span>
<a name="ln-1009"></a>    <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TD</span>             <span class="o">=</span> <span class="n">TempInitValue</span>
<a name="ln-1010"></a>    <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TDT</span>            <span class="o">=</span> <span class="n">TempInitValue</span>
<a name="ln-1011"></a>    <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TDTLast</span>        <span class="o">=</span> <span class="n">TempInitValue</span>
<a name="ln-1012"></a>    <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TDOld</span>          <span class="o">=</span> <span class="n">TempInitValue</span>
<a name="ln-1013"></a>    <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TDreport</span>       <span class="o">=</span> <span class="n">TempInitValue</span>
<a name="ln-1014"></a>    <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">RH</span>             <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1015"></a>    <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">RHreport</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1016"></a>    <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">EnthOld</span>        <span class="o">=</span> <span class="n">EnthInitValue</span>
<a name="ln-1017"></a>    <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">EnthNew</span>        <span class="o">=</span> <span class="n">EnthInitValue</span>
<a name="ln-1018"></a>    <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">EnthLast</span>       <span class="o">=</span> <span class="n">EnthInitValue</span>
<a name="ln-1019"></a>  <span class="k">END DO</span>
<a name="ln-1020"></a>
<a name="ln-1021"></a>
<a name="ln-1022"></a><span class="k">  DO </span><span class="n">SurfNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-1023"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1024"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1025"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransferAlgorithm</span> <span class="o">/=</span> <span class="n">HeatTransferModel_CondFD</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1026"></a> <span class="c">!   If(SolutionAlgo == UseCondFD .or. SolutionAlgo == UseCondFDSimple)Then</span>
<a name="ln-1027"></a><span class="c">!</span>
<a name="ln-1028"></a><span class="c">!    CALL SetupOutputVariable(&#39;CondFD Outside Surface Heat Flux [W/m2]&#39;,   QFluxOutArrivSurfCond(SurfNum), &amp;</span>
<a name="ln-1029"></a><span class="c">!                             &#39;Zone&#39;,&#39;State&#39;,TRIM(Surface(SurfNum)%Name))</span>
<a name="ln-1030"></a><span class="c">!    CALL SetupOutputVariable(&#39;CondFD Inside Surface Heat Flux [W/m2]&#39;,    QFluxInArrivSurfCond(SurfNum), &amp;</span>
<a name="ln-1031"></a><span class="c">!                             &#39;Zone&#39;,&#39;State&#39;,TRIM(Surface(SurfNum)%Name))</span>
<a name="ln-1032"></a><span class="c">!    CALL SetupOutputVariable(&#39;CondFD Outside Heat Flux to Surface [W/m2]&#39;,QFluxOutsideToOutSurf(SurfNum), &amp;</span>
<a name="ln-1033"></a><span class="c">!                             &#39;Zone&#39;,&#39;State&#39;,TRIM(Surface(SurfNum)%Name))</span>
<a name="ln-1034"></a><span class="c">!    CALL SetupOutputVariable(&#39;CondFD Inside Heat Flux to Surface [W/m2]&#39;, QFluxZoneToInSurf(SurfNum), &amp;</span>
<a name="ln-1035"></a><span class="c">!                             &#39;Zone&#39;,&#39;State&#39;,TRIM(Surface(SurfNum)%Name))</span>
<a name="ln-1036"></a>
<a name="ln-1037"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;CondFD Inner Solver Loop Iteration Count [ ]&#39;</span><span class="p">,</span> <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">GSloopCounter</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1038"></a>                             <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1039"></a>
<a name="ln-1040"></a>
<a name="ln-1041"></a>
<a name="ln-1042"></a>    <span class="n">TotNodes</span> <span class="o">=</span> <span class="n">ConstructFD</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TotNodes</span>  <span class="c">! Full size nodes, start with outside face.</span>
<a name="ln-1043"></a>    <span class="k">DO </span><span class="n">Lay</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">TotNodes</span> <span class="o">+</span><span class="mi">1</span>  <span class="c">! include inside face node</span>
<a name="ln-1044"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;CondFD Surface Temperature Node &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Lay</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; [C]&#39;</span><span class="p">,&amp;</span>
<a name="ln-1045"></a>           <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TDreport</span><span class="p">(</span><span class="n">Lay</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-1046"></a>          <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;State&#39;</span><span class="p">,</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1047"></a>    <span class="k">END DO</span>
<a name="ln-1048"></a>
<a name="ln-1049"></a><span class="k">  </span><span class="n">ENDDO</span>  <span class="c">! End of the Surface Loop for Report Variable Setup</span>
<a name="ln-1050"></a>
<a name="ln-1051"></a>  <span class="k">CALL </span><span class="n">ReportFiniteDiffInits</span>  <span class="c">! Report the results from the Finite Diff Inits</span>
<a name="ln-1052"></a>
<a name="ln-1053"></a>  <span class="k">RETURN</span>
<a name="ln-1054"></a>
<a name="ln-1055"></a><span class="k">END SUBROUTINE </span><span class="n">InitialInitHeatBalFiniteDiff</span>
<a name="ln-1056"></a>
<a name="ln-1057"></a><span class="k">SUBROUTINE </span><span class="n">CalcHeatBalFiniteDiff</span><span class="p">(</span><span class="n">Surf</span><span class="p">,</span><span class="n">TempSurfInTmp</span><span class="p">,</span><span class="n">TempSurfOutTmp</span><span class="p">)</span>
<a name="ln-1058"></a>
<a name="ln-1059"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1060"></a>          <span class="c">!       AUTHOR         Richard J. Liesen</span>
<a name="ln-1061"></a>          <span class="c">!       DATE WRITTEN   Oct 2003</span>
<a name="ln-1062"></a>          <span class="c">!       MODIFIED       Aug 2006 by C O Pedersen to include implicit solution and variable properties with</span>
<a name="ln-1063"></a>          <span class="c">!                                material enthalpy added for Phase Change Materials.</span>
<a name="ln-1064"></a>          <span class="c">!                      Sept 2010 B. Griffith, remove allocate/deallocate, use structure variables</span>
<a name="ln-1065"></a>          <span class="c">!                      March 2011 P. Tabares, add relaxation factor and add surfIteration to</span>
<a name="ln-1066"></a>          <span class="c">!                                 update TD and TDT, correct interzone partition</span>
<a name="ln-1067"></a>          <span class="c">!                      May 2011  B. Griffith add logging and errors when inner GS loop does not converge</span>
<a name="ln-1068"></a>          <span class="c">!                      November 2011 P. Tabares fixed problems with adiabatic walls/massless walls and PCM stability problems</span>
<a name="ln-1069"></a>
<a name="ln-1070"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1071"></a>
<a name="ln-1072"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1073"></a>          <span class="c">! this routine controls the calculation of the fluxes and temperatures using</span>
<a name="ln-1074"></a>          <span class="c">!      finite difference procedures for</span>
<a name="ln-1075"></a>          <span class="c">!      all building surface constructs.</span>
<a name="ln-1076"></a>
<a name="ln-1077"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1078"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-1079"></a>
<a name="ln-1080"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1081"></a>          <span class="c">! na</span>
<a name="ln-1082"></a>
<a name="ln-1083"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1084"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>         <span class="n">ONLY</span> <span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-1085"></a>  <span class="k">USE </span><span class="n">DataHeatBalance</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">CondFDRelaxFactor</span>
<a name="ln-1086"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>     <span class="n">ONLY</span> <span class="p">:</span> <span class="n">KickOffSimulation</span>
<a name="ln-1087"></a>  <span class="k">USE </span><span class="n">DataSurfaces</span><span class="p">,</span>    <span class="n">ONLY</span> <span class="p">:</span> <span class="n">HeatTransferModel_CondFD</span>
<a name="ln-1088"></a>
<a name="ln-1089"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1090"></a>
<a name="ln-1091"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1092"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">In</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Surf</span>
<a name="ln-1093"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">InOut</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TempSurfInTmp</span>       <span class="c">!INSIDE SURFACE TEMPERATURE OF EACH HEAT TRANSFER SURF.</span>
<a name="ln-1094"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">InOut</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TempSurfOutTmp</span>      <span class="c">!Outside Surface Temperature of each Heat Transfer Surface</span>
<a name="ln-1095"></a>
<a name="ln-1096"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1097"></a>          <span class="c">! na</span>
<a name="ln-1098"></a>
<a name="ln-1099"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-1100"></a>          <span class="c">! na</span>
<a name="ln-1101"></a>
<a name="ln-1102"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-1103"></a>          <span class="c">! na</span>
<a name="ln-1104"></a>
<a name="ln-1105"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1106"></a>
<a name="ln-1107"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">HMovInsul</span>           <span class="c">!  Equiv H for TIM layer,  Comes with call to</span>
<a name="ln-1108"></a>                                                 <span class="c">! EvalOutsideMovableInsulation</span>
<a name="ln-1109"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">RoughIndexMovInsul</span>   <span class="c">! roughness  Movable insulation</span>
<a name="ln-1110"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">AbsExt</span>              <span class="c">! exterior absorptivity  movable insulation</span>
<a name="ln-1111"></a>
<a name="ln-1112"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">I</span>       <span class="c">!  Node number in construction</span>
<a name="ln-1113"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">J</span>
<a name="ln-1114"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">Lay</span>
<a name="ln-1115"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">ctr</span>
<a name="ln-1116"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">ConstrNum</span>
<a name="ln-1117"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">TotLayers</span>
<a name="ln-1118"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">TotNodes</span>
<a name="ln-1119"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">delt</span>
<a name="ln-1120"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">GSiter</span> <span class="c">!  iteration counter for implicit repeat calculation</span>
<a name="ln-1121"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MaxDelTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1122"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NodeNum</span>
<a name="ln-1123"></a>
<a name="ln-1124"></a>  <span class="n">ConstrNum</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-1125"></a>
<a name="ln-1126"></a>  <span class="n">TotNodes</span> <span class="o">=</span> <span class="n">ConstructFD</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TotNodes</span>
<a name="ln-1127"></a>  <span class="n">TotLayers</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TotLayers</span>
<a name="ln-1128"></a>
<a name="ln-1129"></a>  <span class="n">TempSurfInTmp</span> <span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1130"></a>  <span class="n">TempSurfOutTmp</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1131"></a>
<a name="ln-1132"></a>
<a name="ln-1133"></a>  <span class="n">Delt</span> <span class="o">=</span> <span class="n">ConstructFD</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">DeltaTime</span>    <span class="c">!   (seconds)</span>
<a name="ln-1134"></a>
<a name="ln-1135"></a>  <span class="k">CALL </span><span class="n">EvalOutsideMovableInsulation</span><span class="p">(</span><span class="n">Surf</span><span class="p">,</span><span class="n">HMovInsul</span><span class="p">,</span><span class="n">RoughIndexMovInsul</span><span class="p">,</span><span class="n">AbsExt</span><span class="p">)</span>
<a name="ln-1136"></a> <span class="c">! Start stepping through the slab with time.</span>
<a name="ln-1137"></a>  <span class="k">DO </span><span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="nb">NINT</span><span class="p">((</span><span class="n">TimeStepZone</span><span class="o">*</span><span class="n">SecInHour</span><span class="p">)</span><span class="o">/</span><span class="n">Delt</span><span class="p">)</span>  <span class="c">!PT testing higher time steps</span>
<a name="ln-1138"></a>
<a name="ln-1139"></a>    <span class="k">DO </span><span class="n">GSiter</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MaxGSiter</span>  <span class="c">!  Iterate implicit equations</span>
<a name="ln-1140"></a>      <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TDTLast</span> <span class="o">=</span> <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TDT</span>    <span class="c">!  Save last iteration&#39;s TDT (New temperature) values</span>
<a name="ln-1141"></a>      <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">EnthLast</span> <span class="o">=</span> <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">EnthNew</span>  <span class="c">! Last iterations new enthalpy value</span>
<a name="ln-1142"></a>
<a name="ln-1143"></a><span class="c">!  Original loop version</span>
<a name="ln-1144"></a>      <span class="n">I</span><span class="o">=</span> <span class="mi">1</span>   <span class="c">!  Node counter</span>
<a name="ln-1145"></a>      <span class="k">DO </span><span class="n">Lay</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotLayers</span>    <span class="c">! Begin layer loop ...</span>
<a name="ln-1146"></a>
<a name="ln-1147"></a>        <span class="c">!For the exterior surface node with a convective boundary condition</span>
<a name="ln-1148"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">I</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Lay</span> <span class="o">==</span><span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1149"></a><span class="k">          CALL </span><span class="n">ExteriorBCEqns</span><span class="p">(</span><span class="n">Delt</span><span class="p">,</span><span class="n">I</span><span class="p">,</span><span class="n">Lay</span><span class="p">,</span><span class="n">Surf</span><span class="p">,</span><span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">T</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1150"></a>                                        <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TT</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1151"></a>                                        <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">Rhov</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1152"></a>                                        <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">RhoT</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1153"></a>                                        <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">RH</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1154"></a>                                        <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TD</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1155"></a>                                        <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TDT</span><span class="p">,&amp;</span>
<a name="ln-1156"></a>                                        <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">EnthOld</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1157"></a>                                        <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">EnthNew</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1158"></a>                                        <span class="n">TotNodes</span><span class="p">,</span><span class="n">HMovInsul</span><span class="p">)</span>
<a name="ln-1159"></a>        <span class="k">END IF</span>
<a name="ln-1160"></a>
<a name="ln-1161"></a>        <span class="c">!For the Layer Interior nodes.  Arrive here after exterior surface node or interface node</span>
<a name="ln-1162"></a>
<a name="ln-1163"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">TotNodes</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1164"></a>
<a name="ln-1165"></a><span class="k">          DO </span><span class="n">Ctr</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">ConstructFD</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">NodeNumPoint</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span>
<a name="ln-1166"></a>            <span class="n">I</span><span class="o">=</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1167"></a>            <span class="k">CALL </span><span class="n">InteriorNodeEqns</span><span class="p">(</span><span class="n">Delt</span><span class="p">,</span><span class="n">I</span><span class="p">,</span><span class="n">Lay</span><span class="p">,</span><span class="n">Surf</span><span class="p">,</span><span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">T</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1168"></a>                                  <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TT</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1169"></a>                                  <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">Rhov</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1170"></a>                                  <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">RhoT</span><span class="p">,&amp;</span>
<a name="ln-1171"></a>                                  <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">RH</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1172"></a>                                  <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TD</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1173"></a>                                  <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TDT</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1174"></a>                                  <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">EnthOld</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1175"></a>                                  <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">EnthNew</span><span class="p">)</span>
<a name="ln-1176"></a>          <span class="k">END DO</span>
<a name="ln-1177"></a><span class="k">        END IF</span>
<a name="ln-1178"></a>
<a name="ln-1179"></a><span class="k">        IF</span><span class="p">(</span><span class="n">Lay</span> <span class="o">&lt;</span> <span class="n">TotLayers</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">TotNodes</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1180"></a>          <span class="c">!Interface equations for 2 capactive materials</span>
<a name="ln-1181"></a>          <span class="n">I</span><span class="o">=</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1182"></a>          <span class="k">CALL </span><span class="n">IntInterfaceNodeEqns</span><span class="p">(</span><span class="n">Delt</span><span class="p">,</span><span class="n">I</span><span class="p">,</span><span class="n">Lay</span><span class="p">,</span><span class="n">Surf</span><span class="p">,</span><span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">T</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1183"></a>                                   <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TT</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1184"></a>                                   <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">Rhov</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1185"></a>                                   <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">RhoT</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1186"></a>                                   <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">RH</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1187"></a>                                   <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TD</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1188"></a>                                   <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TDT</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1189"></a>                                   <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">EnthOld</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1190"></a>                                   <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">EnthNew</span><span class="p">,</span><span class="n">GSiter</span><span class="p">)</span>
<a name="ln-1191"></a>
<a name="ln-1192"></a>        <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Lay</span> <span class="o">==</span> <span class="n">TotLayers</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1193"></a>          <span class="c">!For the Interior surface node with a convective boundary condition</span>
<a name="ln-1194"></a>          <span class="n">I</span><span class="o">=</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1195"></a>          <span class="k">CALL </span><span class="n">InteriorBCEqns</span><span class="p">(</span><span class="n">Delt</span><span class="p">,</span><span class="n">I</span><span class="p">,</span><span class="n">Lay</span><span class="p">,</span><span class="n">Surf</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1196"></a>                                   <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">T</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1197"></a>                                   <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TT</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1198"></a>                                   <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">Rhov</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1199"></a>                                   <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">RhoT</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1200"></a>                                   <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">RH</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1201"></a>                                   <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TD</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1202"></a>                                   <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TDT</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1203"></a>                                   <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">EnthOld</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1204"></a>                                   <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">EnthNew</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1205"></a>                                   <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TDReport</span><span class="p">)</span>
<a name="ln-1206"></a>        <span class="k">END IF</span>
<a name="ln-1207"></a>
<a name="ln-1208"></a><span class="k">      END DO</span>    <span class="c">!The end of the layer loop</span>
<a name="ln-1209"></a>
<a name="ln-1210"></a>
<a name="ln-1211"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Gsiter</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">5</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1212"></a>      <span class="c">!apply Relaxation factor for stability, use current (TDT) and previous (TDTLast) iteration temperature values</span>
<a name="ln-1213"></a>      <span class="c">!to obtain the actual temperature that is going to be used for next iteration. THis would mostly happen with PCM</span>
<a name="ln-1214"></a>        <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TDT</span> <span class="o">=</span> <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TDTLast</span><span class="o">+</span> <span class="p">(</span><span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TDT</span><span class="o">-</span><span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TDTLast</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5d0</span>
<a name="ln-1215"></a>      <span class="n">ENDIF</span>
<a name="ln-1216"></a>
<a name="ln-1217"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Gsiter</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">10</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1218"></a>      <span class="c">!apply Relaxation factor for stability, use current (TDT) and previous (TDTLast) iteration temperature values</span>
<a name="ln-1219"></a>      <span class="c">!to obtain the actual temperature that is going to be used for next iteration. THis would mostly happen with PCM</span>
<a name="ln-1220"></a>        <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TDT</span> <span class="o">=</span> <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TDTLast</span><span class="o">+</span> <span class="p">(</span><span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TDT</span><span class="o">-</span><span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TDTLast</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.25d0</span>
<a name="ln-1221"></a>      <span class="n">ENDIF</span>
<a name="ln-1222"></a>
<a name="ln-1223"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Gsiter</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">15</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1224"></a>      <span class="c">!apply Relaxation factor for stability, use current (TDT) and previous (TDTLast) iteration temperature values</span>
<a name="ln-1225"></a>      <span class="c">!to obtain the actual temperature that is going to be used for next iteration. THis would mostly happen with PCM</span>
<a name="ln-1226"></a>        <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TDT</span> <span class="o">=</span> <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TDTLast</span><span class="o">+</span> <span class="p">(</span><span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TDT</span><span class="o">-</span><span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TDTLast</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.10d0</span>
<a name="ln-1227"></a>      <span class="n">ENDIF</span>
<a name="ln-1228"></a>
<a name="ln-1229"></a>      <span class="c">! the following could blow up when all the node temps sum to less than 1.0.  seems poorly formulated for temperature in C.</span>
<a name="ln-1230"></a>        <span class="c">!PT delete one zero and decrese number of minimum iterations, from 3 (which actually requires 4 iterations) to 2.</span>
<a name="ln-1231"></a>
<a name="ln-1232"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Gsiter</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">2</span>  <span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="nb">ABS</span><span class="p">(</span><span class="nb">SUM</span><span class="p">(</span><span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TDT</span><span class="o">-</span><span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TDTLast</span><span class="p">)</span><span class="o">/</span><span class="nb">SUM</span><span class="p">(</span><span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TDT</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mf">0.00001d0</span> <span class="p">)</span>  <span class="k">EXIT</span>
<a name="ln-1233"></a>      <span class="c">!SurfaceFD(Surf)%GSloopCounter = Gsiter  !PT moved out of GSloop so it can actually count all iterations</span>
<a name="ln-1234"></a>
<a name="ln-1235"></a><span class="c">!feb2012 the following could blow up when all the node temps sum to less than 1.0.  seems poorly formulated for temperature in C.</span>
<a name="ln-1236"></a><span class="c">!feb2012      IF (Gsiter .gt. 3  .and.ABS(SUM(SurfaceFD(Surf)%TDT-SurfaceFD(Surf)%TDTLast)/SUM(SurfaceFD(Surf)%TDT)) &lt; 0.000001d0 )  EXIT</span>
<a name="ln-1237"></a><span class="c">!feb2012      SurfaceFD(Surf)%GSloopCounter = Gsiter</span>
<a name="ln-1238"></a><span class="c">!      IF ((GSiter == MaxGSiter) .AND. (SolutionAlgo /= UseCondFDSimple)) THEN ! didn&#39;t ever converge</span>
<a name="ln-1239"></a><span class="c">!        IF (.NOT. WarmupFlag .AND. (.NOT. KickOffSimulation)) THEN</span>
<a name="ln-1240"></a><span class="c">!          ErrCount=ErrCount+1</span>
<a name="ln-1241"></a><span class="c">!          ErrorSignal = ABS(SUM(SurfaceFD(Surf)%TDT-SurfaceFD(Surf)%TDTLast)/SUM(SurfaceFD(Surf)%TDT))</span>
<a name="ln-1242"></a><span class="c">!          IF (ErrCount &lt; 10) THEN</span>
<a name="ln-1243"></a><span class="c">!            CALL ShowWarningError(&#39;ConductionFiniteDifference inner iteration loop did not converge for surface named =&#39;// &amp;</span>
<a name="ln-1244"></a><span class="c">!                          TRIM(Surface(Surf)%Name) // &amp;</span>
<a name="ln-1245"></a><span class="c">!                          &#39;, with error signal =&#39;//TRIM(RoundSigDigits(ErrorSignal, 8)) // &amp;</span>
<a name="ln-1246"></a><span class="c">!                          &#39; vs criteria of 0.000001&#39;)</span>
<a name="ln-1247"></a><span class="c">!            CALL ShowContinueErrorTimeStamp(&#39; &#39;)</span>
<a name="ln-1248"></a><span class="c">!          ELSE</span>
<a name="ln-1249"></a><span class="c">!            CALL ShowRecurringWarningErrorAtEnd(&#39;ConductionFiniteDifference convergence problem continues for surface named =&#39;// &amp;</span>
<a name="ln-1250"></a><span class="c">!                                                TRIM(Surface(Surf)%Name) , &amp;</span>
<a name="ln-1251"></a><span class="c">!                                               SurfaceFD(Surf)%GSloopErrorCount,ReportMaxOf=ErrorSignal,ReportMinOf=ErrorSignal,  &amp;</span>
<a name="ln-1252"></a><span class="c">!                                               ReportMaxUnits=&#39;[ ]&#39;,ReportMinUnits=&#39;[ ]&#39;)</span>
<a name="ln-1253"></a><span class="c">!          ENDIF</span>
<a name="ln-1254"></a><span class="c">!</span>
<a name="ln-1255"></a><span class="c">!        ENDIF</span>
<a name="ln-1256"></a><span class="c">!</span>
<a name="ln-1257"></a><span class="c">!      ENDIF</span>
<a name="ln-1258"></a>
<a name="ln-1259"></a>    <span class="k">END DO</span> <span class="c">! End of Gauss Seidell iteration loop</span>
<a name="ln-1260"></a>
<a name="ln-1261"></a>    <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">GSloopCounter</span> <span class="o">=</span> <span class="n">Gsiter</span>   <span class="c">!outputs GSloop iterations, useful for pinpointing stability issues with condFD</span>
<a name="ln-1262"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CondFDRelaxFactor</span><span class="o">/=</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1263"></a>     <span class="c">!apply Relaxation factor for stability, use current (TDT) and previous (TDreport) temperature values</span>
<a name="ln-1264"></a>     <span class="c">!   to obtain the actual temperature that is going to be exported/use</span>
<a name="ln-1265"></a>      <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TDT</span> <span class="o">=</span> <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TDreport</span><span class="o">+</span> <span class="p">(</span><span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TDT</span><span class="o">-</span><span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TDreport</span><span class="p">)</span> <span class="o">*</span> <span class="n">CondFDRelaxFactor</span>
<a name="ln-1266"></a>      <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">EnthOld</span> <span class="o">=</span> <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">EnthNew</span>
<a name="ln-1267"></a>    <span class="n">ENDIF</span>
<a name="ln-1268"></a>
<a name="ln-1269"></a>  <span class="k">END DO</span>     <span class="c">!The end of the Time Loop   !PT solving time steps</span>
<a name="ln-1270"></a>
<a name="ln-1271"></a>  <span class="n">TempSurfOutTmp</span> <span class="o">=</span> <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TDT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1272"></a>  <span class="n">TempSurfInTmp</span>  <span class="o">=</span> <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TDT</span><span class="p">(</span><span class="n">TotNodes</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1273"></a>  <span class="n">RhoVaporSurfIn</span><span class="p">(</span><span class="n">surf</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1274"></a>
<a name="ln-1275"></a>  <span class="c">! determine largest change in node temps</span>
<a name="ln-1276"></a>  <span class="n">MaxDelTemp</span>      <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1277"></a>  <span class="k">DO </span><span class="n">NodeNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotNodes</span><span class="o">+</span><span class="mi">1</span>   <span class="c">!need to consider all nodes</span>
<a name="ln-1278"></a>    <span class="n">MaxDelTemp</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TDT</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)</span> <span class="o">-</span> <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TDreport</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)),</span> <span class="n">MaxDelTemp</span><span class="p">)</span>
<a name="ln-1279"></a>  <span class="n">ENDDO</span>
<a name="ln-1280"></a>  <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">MaxNodeDelTemp</span> <span class="o">=</span> <span class="n">MaxDelTemp</span>
<a name="ln-1281"></a><span class="c">!  SurfaceFD(Surf)%TDOld          = SurfaceFD(Surf)%TDT</span>
<a name="ln-1282"></a>  <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TDreport</span>       <span class="o">=</span> <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TDT</span>
<a name="ln-1283"></a>  <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">EnthOld</span>        <span class="o">=</span> <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">EnthNew</span>
<a name="ln-1284"></a>
<a name="ln-1285"></a> <span class="k">RETURN</span>
<a name="ln-1286"></a>
<a name="ln-1287"></a>
<a name="ln-1288"></a><span class="k">End SUBROUTINE </span><span class="n">CalcHeatBalFiniteDiff</span>
<a name="ln-1289"></a>
<a name="ln-1290"></a>
<a name="ln-1291"></a><span class="c">! Beginning of Reporting subroutines</span>
<a name="ln-1292"></a><span class="c">! *****************************************************************************</span>
<a name="ln-1293"></a>
<a name="ln-1294"></a><span class="k">SUBROUTINE </span><span class="n">UpdateMoistureBalanceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)</span>
<a name="ln-1295"></a>
<a name="ln-1296"></a>    <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1297"></a>    <span class="c">!   Authors:        Richard Liesen</span>
<a name="ln-1298"></a>    <span class="c">!   Date writtenn:  November, 2003</span>
<a name="ln-1299"></a>    <span class="c">!   Modified:       na</span>
<a name="ln-1300"></a>    <span class="c">!   Re-engineered:  na</span>
<a name="ln-1301"></a>
<a name="ln-1302"></a>    <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1303"></a>    <span class="c">! Update the data structures after the inside surface heat balance has converged.</span>
<a name="ln-1304"></a>
<a name="ln-1305"></a>    <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1306"></a>    <span class="c">!</span>
<a name="ln-1307"></a>
<a name="ln-1308"></a>    <span class="c">! USE STATEMENTS:</span>
<a name="ln-1309"></a>
<a name="ln-1310"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-1311"></a><span class="k">    </span><span class="kt">Integer</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Surf</span> <span class="c">! Surface number</span>
<a name="ln-1312"></a>
<a name="ln-1313"></a>    <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ConstrNum</span>
<a name="ln-1314"></a>
<a name="ln-1315"></a>    <span class="n">ConstrNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-1316"></a>    <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TOld</span> <span class="o">=</span> <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">T</span>
<a name="ln-1317"></a>    <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">RhovOld</span> <span class="o">=</span> <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">Rhov</span>
<a name="ln-1318"></a>    <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TDOld</span> <span class="o">=</span> <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TDreport</span>
<a name="ln-1319"></a>
<a name="ln-1320"></a><span class="k">RETURN</span>
<a name="ln-1321"></a>
<a name="ln-1322"></a><span class="k">END SUBROUTINE </span><span class="n">UpdateMoistureBalanceFD</span>
<a name="ln-1323"></a>
<a name="ln-1324"></a><span class="k">SUBROUTINE </span><span class="n">ReportFiniteDiffInits</span>
<a name="ln-1325"></a>
<a name="ln-1326"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1327"></a>          <span class="c">!       AUTHOR         Richard Liesen</span>
<a name="ln-1328"></a>          <span class="c">!       DATE WRITTEN   November 2003</span>
<a name="ln-1329"></a>          <span class="c">!       MODIFIED       B. Griffith, May 2011 add reporting of node x locations</span>
<a name="ln-1330"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1331"></a>
<a name="ln-1332"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1333"></a>          <span class="c">! This routine gives a detailed report to the user about</span>
<a name="ln-1334"></a>          <span class="c">! the initializations for the Fintie Difference calculations</span>
<a name="ln-1335"></a>          <span class="c">! of each construction.</span>
<a name="ln-1336"></a>
<a name="ln-1337"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1338"></a>          <span class="c">! na</span>
<a name="ln-1339"></a>
<a name="ln-1340"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1341"></a>          <span class="c">! na</span>
<a name="ln-1342"></a>
<a name="ln-1343"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1344"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ScanForReports</span><span class="p">,</span> <span class="n">RoundSigDigits</span>
<a name="ln-1345"></a>  <span class="k">USE </span><span class="n">DataHeatBalance</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">MaxAllowedDelTempCondFD</span><span class="p">,</span> <span class="n">CondFDRelaxFactorInput</span><span class="p">,</span> <span class="n">HeatTransferAlgosUsed</span>
<a name="ln-1346"></a>
<a name="ln-1347"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1348"></a>
<a name="ln-1349"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1350"></a>          <span class="c">! na</span>
<a name="ln-1351"></a>
<a name="ln-1352"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1353"></a>          <span class="c">! na</span>
<a name="ln-1354"></a>
<a name="ln-1355"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-1356"></a>          <span class="c">! na</span>
<a name="ln-1357"></a>
<a name="ln-1358"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-1359"></a>          <span class="c">! na</span>
<a name="ln-1360"></a>
<a name="ln-1361"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1362"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">DoReport</span>
<a name="ln-1363"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InodesChar</span>
<a name="ln-1364"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ThisNum</span>
<a name="ln-1365"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Layer</span>
<a name="ln-1366"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">OutwardMatLayerNum</span>
<a name="ln-1367"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">layerNode</span>
<a name="ln-1368"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Inodes</span>
<a name="ln-1369"></a>
<a name="ln-1370"></a>  <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;! &lt;ConductionFiniteDifference HeatBalanceSettings&gt;,Scheme Type,Space Discretization Constant,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1371"></a>     <span class="s1">&#39;Relaxation Factor,Inside Face Surface Temperature Convergence Criteria&#39;</span>
<a name="ln-1372"></a>  <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39; ConductionFiniteDifference HeatBalanceSettings,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1373"></a>     <span class="nb">trim</span><span class="p">(</span><span class="n">cCondFDSchemeType</span><span class="p">(</span><span class="n">CondFDSchemeType</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1374"></a>     <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SpaceDescritConstant</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">CondFDRelaxFactorInput</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1375"></a>     <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MaxAllowedDelTempCondFD</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-1376"></a>  <span class="k">CALL </span><span class="n">ScanForReports</span><span class="p">(</span><span class="s1">&#39;Constructions&#39;</span><span class="p">,</span><span class="n">DoReport</span><span class="p">,</span><span class="s1">&#39;Constructions&#39;</span><span class="p">)</span>
<a name="ln-1377"></a>
<a name="ln-1378"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DoReport</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1379"></a>
<a name="ln-1380"></a><span class="c">!                                      Write Descriptions</span>
<a name="ln-1381"></a>    <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;! &lt;Construction CondFD&gt;,Construction Name,Index,#Layers,#Nodes,Time Step {hours}&#39;</span>
<a name="ln-1382"></a>    <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;! &lt;Material CondFD Summary&gt;,Material Name,Thickness {m},#Layer Elements,Layer Delta X,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1383"></a>                             <span class="s1">&#39;Layer Alpha*Delt/Delx**2,Layer Moisture Stability&#39;</span>
<a name="ln-1384"></a>  <span class="c">!HT Algo issue</span>
<a name="ln-1385"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ANY</span><span class="p">(</span><span class="n">HeatTransferAlgosUsed</span> <span class="o">==</span> <span class="n">UseCondFD</span><span class="p">))</span>  <span class="p">&amp;</span>
<a name="ln-1386"></a>       <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;! &lt;ConductionFiniteDifference Node&gt;,Node Identifier, &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1387"></a>        <span class="s1">&#39; Node Distance From Outside Face {m}, Construction Name, Outward Material Name (or Face), Inward Material Name (or Face)&#39;</span>
<a name="ln-1388"></a>    <span class="k">DO </span><span class="n">ThisNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotConstructs</span>
<a name="ln-1389"></a>
<a name="ln-1390"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">TypeIsWindow</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1391"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">TypeIsIRT</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1392"></a>
<a name="ln-1393"></a><span class="k">      Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">700</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-1394"></a>          <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">TotLayers</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-1395"></a>          <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="nb">Int</span><span class="p">(</span><span class="n">ConstructFD</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">TotNodes</span><span class="o">+</span><span class="mi">1</span><span class="p">))),</span>  <span class="p">&amp;</span>
<a name="ln-1396"></a>          <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">ConstructFD</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">DeltaTime</span><span class="o">/</span><span class="n">SecInHour</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1397"></a><span class="c">!</span>
<a name="ln-1398"></a> <span class="mi">700</span>  <span class="k">FORMAT</span><span class="p">(</span><span class="s1">&#39; Construction CondFD,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="mi">2</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">),</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
<a name="ln-1399"></a> <span class="mi">701</span>  <span class="k">FORMAT</span><span class="p">(</span><span class="s1">&#39; Material CondFD Summary,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
<a name="ln-1400"></a> <span class="mi">702</span>  <span class="k">FORMAT</span><span class="p">(</span><span class="s1">&#39; ConductionFiniteDifference Node,&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
<a name="ln-1401"></a>
<a name="ln-1402"></a>
<a name="ln-1403"></a>      <span class="k">DO </span><span class="n">Layer</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">TotLayers</span>
<a name="ln-1404"></a>            <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">701</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">ConstructFD</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">(</span><span class="n">Layer</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-1405"></a>                                       <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">ConstructFD</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">Thickness</span><span class="p">(</span><span class="n">Layer</span><span class="p">),</span><span class="mi">4</span><span class="p">)),</span>      <span class="p">&amp;</span>
<a name="ln-1406"></a>                                       <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">ConstructFD</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">NodeNumPoint</span><span class="p">(</span><span class="n">Layer</span><span class="p">))),</span>  <span class="p">&amp;</span>
<a name="ln-1407"></a>                                       <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">ConstructFD</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">Delx</span><span class="p">(</span><span class="n">Layer</span><span class="p">),</span><span class="mi">8</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-1408"></a>                                       <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">ConstructFD</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">TempStability</span><span class="p">(</span><span class="n">Layer</span><span class="p">),</span><span class="mi">8</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-1409"></a>                                       <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">ConstructFD</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">MoistStability</span><span class="p">(</span><span class="n">Layer</span><span class="p">),</span><span class="mi">8</span><span class="p">))</span>
<a name="ln-1410"></a>      <span class="n">ENDDO</span>
<a name="ln-1411"></a>
<a name="ln-1412"></a>      <span class="c">!now list each CondFD Node with its X distance from outside face in m along with other identifiers</span>
<a name="ln-1413"></a>      <span class="n">Inodes</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1414"></a>
<a name="ln-1415"></a>      <span class="k">DO </span><span class="n">Layer</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">TotLayers</span>
<a name="ln-1416"></a>        <span class="n">OutwardMatLayerNum</span> <span class="o">=</span> <span class="n">Layer</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-1417"></a>        <span class="k">DO </span><span class="n">layerNode</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ConstructFD</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">NodeNumPoint</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span>
<a name="ln-1418"></a>          <span class="n">Inodes</span> <span class="o">=</span> <span class="n">Inodes</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1419"></a>          <span class="k">WRITE</span><span class="p">(</span><span class="n">InodesChar</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="n">Inodes</span>
<a name="ln-1420"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Inodes</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1421"></a><span class="k">            WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">702</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="s1">&#39;Node #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">InodesChar</span><span class="p">))),</span> <span class="p">&amp;</span>
<a name="ln-1422"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">ConstructFD</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">NodeXlocation</span><span class="p">(</span><span class="n">Inodes</span><span class="p">),</span> <span class="mi">8</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-1423"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">,</span>          <span class="p">&amp;</span>
<a name="ln-1424"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="s1">&#39;Surface Outside Face&#39;</span><span class="p">),</span>          <span class="p">&amp;</span>
<a name="ln-1425"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">ConstructFD</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">(</span><span class="n">Layer</span><span class="p">))</span>
<a name="ln-1426"></a>
<a name="ln-1427"></a>          <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">layerNode</span><span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1428"></a>
<a name="ln-1429"></a><span class="k">            IF</span> <span class="p">(</span> <span class="n">OutwardMatLayerNum</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">OutwardMatLayerNum</span> <span class="o">&lt;=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">TotLayers</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1430"></a><span class="k">               WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">702</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="s1">&#39;Node #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">InodesChar</span><span class="p">))),</span> <span class="p">&amp;</span>
<a name="ln-1431"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">ConstructFD</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">NodeXlocation</span><span class="p">(</span><span class="n">Inodes</span><span class="p">),</span> <span class="mi">8</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-1432"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">,</span>          <span class="p">&amp;</span>
<a name="ln-1433"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">ConstructFD</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">(</span><span class="n">OutwardMatLayerNum</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-1434"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">ConstructFD</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">(</span><span class="n">Layer</span><span class="p">))</span>
<a name="ln-1435"></a>
<a name="ln-1436"></a>            <span class="n">ENDIF</span>
<a name="ln-1437"></a>          <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">layerNode</span> <span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1438"></a><span class="k">            </span><span class="n">OutwardMatLayerNum</span> <span class="o">=</span> <span class="n">Layer</span>
<a name="ln-1439"></a>            <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">702</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="s1">&#39;Node #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">InodesChar</span><span class="p">))),</span> <span class="p">&amp;</span>
<a name="ln-1440"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">ConstructFD</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">NodeXlocation</span><span class="p">(</span><span class="n">Inodes</span><span class="p">),</span> <span class="mi">8</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-1441"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">,</span>          <span class="p">&amp;</span>
<a name="ln-1442"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">ConstructFD</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">(</span><span class="n">OutwardMatLayerNum</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-1443"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">ConstructFD</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">(</span><span class="n">Layer</span><span class="p">))</span>
<a name="ln-1444"></a>          <span class="n">ENDIF</span>
<a name="ln-1445"></a>
<a name="ln-1446"></a>          <span class="n">ENDDO</span>
<a name="ln-1447"></a>        <span class="n">ENDDO</span>
<a name="ln-1448"></a>
<a name="ln-1449"></a>        <span class="n">Layer</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">TotLayers</span>
<a name="ln-1450"></a>        <span class="n">Inodes</span> <span class="o">=</span> <span class="n">Inodes</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1451"></a>        <span class="k">WRITE</span><span class="p">(</span><span class="n">InodesChar</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="n">Inodes</span>
<a name="ln-1452"></a>        <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">702</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="s1">&#39;Node #&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">InodesChar</span><span class="p">))),</span> <span class="p">&amp;</span>
<a name="ln-1453"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">ConstructFD</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">NodeXlocation</span><span class="p">(</span><span class="n">Inodes</span><span class="p">),</span> <span class="mi">8</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-1454"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">,</span>          <span class="p">&amp;</span>
<a name="ln-1455"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">ConstructFD</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">(</span><span class="n">Layer</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-1456"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="s1">&#39;Surface Inside Face&#39;</span><span class="p">)</span>
<a name="ln-1457"></a>
<a name="ln-1458"></a>    <span class="n">ENDDO</span>
<a name="ln-1459"></a>
<a name="ln-1460"></a>  <span class="n">ENDIF</span>
<a name="ln-1461"></a>
<a name="ln-1462"></a>  <span class="k">RETURN</span>
<a name="ln-1463"></a>
<a name="ln-1464"></a><span class="k">END SUBROUTINE </span><span class="n">ReportFiniteDiffInits</span>
<a name="ln-1465"></a>
<a name="ln-1466"></a><span class="c">! Utility Interpolation Function for the Module</span>
<a name="ln-1467"></a><span class="c">!******************************************************************************</span>
<a name="ln-1468"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">Function </span><span class="n">terpld</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">nind</span><span class="p">,</span><span class="n">ndep</span><span class="p">)</span>
<a name="ln-1469"></a>    <span class="c">!</span>
<a name="ln-1470"></a>    <span class="c">!author:c. o. pedersen</span>
<a name="ln-1471"></a>    <span class="c">!</span>
<a name="ln-1472"></a>    <span class="c">!purpose:</span>
<a name="ln-1473"></a>    <span class="c">!   this function performs a linear interpolation</span>
<a name="ln-1474"></a>    <span class="c">!     on a two dimensional array containing both</span>
<a name="ln-1475"></a>    <span class="c">!     dependent and independent variables.</span>
<a name="ln-1476"></a>
<a name="ln-1477"></a>
<a name="ln-1478"></a>
<a name="ln-1479"></a>    <span class="c">!inputs:</span>
<a name="ln-1480"></a>    <span class="c">!  a = two dimensional array</span>
<a name="ln-1481"></a>    <span class="c">!  nind=column containing independent variable</span>
<a name="ln-1482"></a>    <span class="c">!  ndep=column containing the dependent variable</span>
<a name="ln-1483"></a>    <span class="c">!   x1 = specific independent variable value for which</span>
<a name="ln-1484"></a>    <span class="c">!      interpolated output is wanted</span>
<a name="ln-1485"></a>    <span class="c">!outputs:</span>
<a name="ln-1486"></a>    <span class="c">!    the value of dependent variable corresponding</span>
<a name="ln-1487"></a>    <span class="c">!       to x1</span>
<a name="ln-1488"></a>    <span class="c">!    routine returns first or last dependent variable</span>
<a name="ln-1489"></a>    <span class="c">!      for out of range x1.</span>
<a name="ln-1490"></a>    <span class="c">!</span>
<a name="ln-1491"></a>     <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">intent</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">N</span>
<a name="ln-1492"></a>     <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="k">intent</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">a</span>
<a name="ln-1493"></a>     <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">intent</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">nind</span>
<a name="ln-1494"></a>     <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">intent</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">ndep</span>
<a name="ln-1495"></a>     <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">x1</span>
<a name="ln-1496"></a>     <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">npts</span><span class="p">,</span><span class="n">first</span><span class="p">,</span><span class="n">last</span><span class="p">,</span><span class="n">i1</span><span class="p">,</span><span class="n">i2</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">irange</span>
<a name="ln-1497"></a>     <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MaxLocArray</span>
<a name="ln-1498"></a>     <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span>  <span class="n">fract</span>
<a name="ln-1499"></a>
<a name="ln-1500"></a>     <span class="n">npts</span> <span class="o">=</span> <span class="n">size</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1501"></a>     <span class="n">first</span><span class="o">=</span><span class="nb">lbound</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1502"></a>     <span class="n">MaxLocArray</span><span class="o">=</span><span class="nb">MaxLoc</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1503"></a>     <span class="n">last</span> <span class="o">=</span> <span class="n">MaxLocArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1504"></a>     <span class="k">IF</span> <span class="p">(</span> <span class="n">npts</span> <span class="o">==</span><span class="mi">1</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">x1</span> <span class="o">&lt;=</span> <span class="n">a</span><span class="p">(</span><span class="n">first</span><span class="p">,</span><span class="n">nind</span><span class="p">)</span> <span class="p">)</span><span class="k">then</span>
<a name="ln-1505"></a><span class="k">       </span><span class="n">terpld</span><span class="o">=</span><span class="n">a</span><span class="p">(</span><span class="n">first</span><span class="p">,</span><span class="n">ndep</span><span class="p">)</span>
<a name="ln-1506"></a>     <span class="n">ELSEIF</span> <span class="p">(</span> <span class="n">x1</span><span class="o">&gt;=</span> <span class="n">a</span><span class="p">(</span><span class="n">last</span><span class="p">,</span><span class="n">nind</span><span class="p">))</span><span class="k">then</span>
<a name="ln-1507"></a><span class="k">       </span><span class="n">terpld</span><span class="o">=</span><span class="n">a</span><span class="p">(</span><span class="n">last</span><span class="p">,</span><span class="n">ndep</span><span class="p">)</span>
<a name="ln-1508"></a>     <span class="k">ELSE</span>
<a name="ln-1509"></a><span class="k">       </span><span class="n">i1</span><span class="o">=</span><span class="n">first</span>
<a name="ln-1510"></a>       <span class="n">i2</span><span class="o">=</span><span class="n">last</span>
<a name="ln-1511"></a>       <span class="k">DO while</span> <span class="p">((</span><span class="n">i2</span><span class="o">-</span><span class="n">i1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-1512"></a>         <span class="n">irange</span><span class="o">=</span><span class="n">i2</span><span class="o">-</span><span class="n">i1</span>
<a name="ln-1513"></a>         <span class="n">i</span><span class="o">=</span><span class="n">i1</span><span class="o">+</span><span class="n">irange</span><span class="o">/</span><span class="mi">2</span>
<a name="ln-1514"></a>         <span class="k">IF</span> <span class="p">(</span> <span class="n">x1</span> <span class="o">&lt;</span> <span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">nind</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1515"></a><span class="k">           </span><span class="n">i2</span><span class="o">=</span><span class="n">i</span>
<a name="ln-1516"></a>         <span class="k">ELSE</span>
<a name="ln-1517"></a><span class="k">           </span><span class="n">i1</span><span class="o">=</span><span class="n">i</span>
<a name="ln-1518"></a>         <span class="k">END IF</span>
<a name="ln-1519"></a><span class="k">      End DO</span>
<a name="ln-1520"></a><span class="k">      </span><span class="n">i</span><span class="o">=</span><span class="n">i2</span>
<a name="ln-1521"></a>      <span class="n">fract</span><span class="o">=</span><span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">nind</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">nind</span><span class="p">)</span><span class="o">-</span><span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">nind</span><span class="p">))</span>
<a name="ln-1522"></a>      <span class="n">terpld</span><span class="o">=</span><span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ndep</span><span class="p">)</span><span class="o">+</span><span class="n">fract</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">ndep</span><span class="p">)</span><span class="o">-</span><span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ndep</span><span class="p">))</span>
<a name="ln-1523"></a>    <span class="k">END IF</span>
<a name="ln-1524"></a><span class="k">END Function</span>
<a name="ln-1525"></a>
<a name="ln-1526"></a><span class="c">! Equation Types of the Module</span>
<a name="ln-1527"></a><span class="c">!******************************************************************************</span>
<a name="ln-1528"></a><span class="k">SUBROUTINE </span><span class="n">ExteriorBCEqns</span><span class="p">(</span><span class="n">Delt</span><span class="p">,</span><span class="n">I</span><span class="p">,</span><span class="n">Lay</span><span class="p">,</span><span class="n">Surf</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">TT</span><span class="p">,</span><span class="n">Rhov</span><span class="p">,</span><span class="n">RhoT</span><span class="p">,</span><span class="n">RH</span><span class="p">,</span><span class="n">TD</span><span class="p">,</span><span class="n">TDT</span><span class="p">,</span><span class="n">EnthOld</span><span class="p">,</span><span class="n">EnthNew</span><span class="p">,</span><span class="n">TotNodes</span><span class="p">,</span><span class="n">HMovInsul</span><span class="p">)</span>
<a name="ln-1529"></a>
<a name="ln-1530"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1531"></a>          <span class="c">!       AUTHOR         Richard Liesen</span>
<a name="ln-1532"></a>          <span class="c">!       DATE WRITTEN   November, 2003</span>
<a name="ln-1533"></a>          <span class="c">!       MODIFIED       B. Griffith 2010, fix adiabatic and other side surfaces</span>
<a name="ln-1534"></a>          <span class="c">!                      May 2011, B. Griffith, P. Tabares</span>
<a name="ln-1535"></a>          <span class="c">!                      November 2011 P. Tabares fixed problems with adiabatic walls/massless walls</span>
<a name="ln-1536"></a>          <span class="c">!                      November 2011 P. Tabares fixed problems PCM stability problems</span>
<a name="ln-1537"></a>          <span class="c">!       RE-ENGINEERED  Curtis Pedersen 2006</span>
<a name="ln-1538"></a>
<a name="ln-1539"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1540"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-1541"></a>
<a name="ln-1542"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1543"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-1544"></a>
<a name="ln-1545"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1546"></a>          <span class="c">! na</span>
<a name="ln-1547"></a>
<a name="ln-1548"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1549"></a>  <span class="k">USE </span><span class="n">DataSurfaces</span><span class="p">,</span>          <span class="n">ONLY</span> <span class="p">:</span> <span class="n">OtherSideCondModeledExt</span><span class="p">,</span> <span class="n">OSCM</span><span class="p">,</span> <span class="n">HeatTransferModel_CondFD</span>
<a name="ln-1550"></a>  <span class="k">USE </span><span class="n">DataHeatBalSurface</span>  <span class="p">,</span>  <span class="n">ONLY</span> <span class="p">:</span> <span class="n">QdotRadOutRepPerArea</span><span class="p">,</span> <span class="n">QdotRadOutRep</span><span class="p">,</span> <span class="n">QRadOutReport</span>
<a name="ln-1551"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1552"></a>
<a name="ln-1553"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1554"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Delt</span>  <span class="c">! Time Increment</span>
<a name="ln-1555"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">I</span>     <span class="c">! Node Index</span>
<a name="ln-1556"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Lay</span>   <span class="c">! Layer Number for Construction</span>
<a name="ln-1557"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Surf</span>  <span class="c">! Surface number</span>
<a name="ln-1558"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">In</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">T</span>     <span class="c">!Old node Temperature in MFD finite difference solution</span>
<a name="ln-1559"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">InOut</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TT</span>    <span class="c">!New node Temperature in MFD finite difference solution.</span>
<a name="ln-1560"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">In</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Rhov</span>  <span class="c">!MFD Nodal Vapor Density[kg/m3] and is the old or last time step result.</span>
<a name="ln-1561"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">InOut</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RhoT</span>  <span class="c">!MFD vapor density for the new time step.</span>
<a name="ln-1562"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">In</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TD</span>    <span class="c">!The old dry Temperature at each node for the CondFD algorithm..</span>
<a name="ln-1563"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">InOut</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TDT</span>   <span class="c">!The current or new Temperature at each node location for the CondFD solution..</span>
<a name="ln-1564"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">InOut</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RH</span>    <span class="c">!Nodal relative humidity</span>
<a name="ln-1565"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">InOut</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EnthOld</span>    <span class="c">! Old Nodal enthalpy</span>
<a name="ln-1566"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">InOut</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EnthNew</span>    <span class="c">! New Nodal enthalpy</span>
<a name="ln-1567"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">TotNodes</span> <span class="c">!  Total nodes in layer</span>
<a name="ln-1568"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HMovInsul</span>  <span class="c">!  Conductance of movable(transparent) insulation.</span>
<a name="ln-1569"></a>
<a name="ln-1570"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1571"></a>          <span class="c">! na</span>
<a name="ln-1572"></a>
<a name="ln-1573"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-1574"></a>          <span class="c">! na</span>
<a name="ln-1575"></a>
<a name="ln-1576"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-1577"></a>          <span class="c">! na</span>
<a name="ln-1578"></a>
<a name="ln-1579"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1580"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QRadSWOutFD</span>   <span class="c">!Short wave radiation absorbed on outside of opaque surface</span>
<a name="ln-1581"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Delx</span>
<a name="ln-1582"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ConstrNum</span>
<a name="ln-1583"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">MatLay</span>
<a name="ln-1584"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IndVarCol</span>
<a name="ln-1585"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">DepVarCol</span>
<a name="ln-1586"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hconvo</span>
<a name="ln-1587"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">kt</span>  <span class="c">! temperature dependent thermal conductivity,  kt=ko +kt1(T-20)</span>
<a name="ln-1588"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">kto</span>  <span class="c">! Base 20C thermal conductivity</span>
<a name="ln-1589"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">kt1</span> <span class="c">! Thermal conductivity gradient coefficient where: kt=ko +kt1(T-20)</span>
<a name="ln-1590"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Cpo</span> <span class="c">! Specific heat from idf</span>
<a name="ln-1591"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Cp</span>  <span class="c">! specific heat modified if PCM, otherwise equal to Cpo</span>
<a name="ln-1592"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RhoS</span>
<a name="ln-1593"></a>
<a name="ln-1594"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Toa</span>
<a name="ln-1595"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Rhovo</span>
<a name="ln-1596"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hmasso</span>
<a name="ln-1597"></a>
<a name="ln-1598"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hgnd</span>
<a name="ln-1599"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hrad</span>
<a name="ln-1600"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hsky</span>
<a name="ln-1601"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Tgnd</span>
<a name="ln-1602"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Tsky</span>
<a name="ln-1603"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Tia</span>
<a name="ln-1604"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SigmaRLoc</span>
<a name="ln-1605"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SigmaCLoc</span>
<a name="ln-1606"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Rlayer</span>
<a name="ln-1607"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QNetSurfFromOutside</span>  <span class="c">!  Combined outside surface net heat transfer terms</span>
<a name="ln-1608"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TInsulOut</span>  <span class="c">! Temperature of outisde face of Outside Insulation</span>
<a name="ln-1609"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QRadSWOutMvInsulFD</span>  <span class="c">! SW radiation at outside of Movable Insulation</span>
<a name="ln-1610"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">LayIn</span>  <span class="c">! layer number for call to interior eqs</span>
<a name="ln-1611"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NodeIn</span> <span class="c">! node number &quot;I&quot; for call to interior eqs</span>
<a name="ln-1612"></a>
<a name="ln-1613"></a>  <span class="n">ConstrNum</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-1614"></a>
<a name="ln-1615"></a>  <span class="c">!Boundary Conditions from Simulation for Exterior</span>
<a name="ln-1616"></a>  <span class="n">hconvo</span> <span class="o">=</span> <span class="n">HConvExtFD</span><span class="p">(</span><span class="n">surf</span><span class="p">)</span>
<a name="ln-1617"></a>  <span class="n">hmasso</span> <span class="o">=</span> <span class="n">HMassConvExtFD</span><span class="p">(</span><span class="n">surf</span><span class="p">)</span>
<a name="ln-1618"></a>
<a name="ln-1619"></a>  <span class="n">hrad</span> <span class="o">=</span> <span class="n">HAirFD</span><span class="p">(</span><span class="n">surf</span><span class="p">)</span>
<a name="ln-1620"></a>  <span class="n">hsky</span> <span class="o">=</span> <span class="n">HSkyFD</span><span class="p">(</span><span class="n">surf</span><span class="p">)</span>
<a name="ln-1621"></a>  <span class="n">hgnd</span> <span class="o">=</span> <span class="n">HGrndFD</span><span class="p">(</span><span class="n">surf</span><span class="p">)</span>
<a name="ln-1622"></a>
<a name="ln-1623"></a>  <span class="n">Toa</span> <span class="o">=</span> <span class="n">TempOutsideAirFD</span><span class="p">(</span><span class="n">surf</span><span class="p">)</span>
<a name="ln-1624"></a>  <span class="n">rhovo</span> <span class="o">=</span> <span class="n">RhoVaporAirOut</span><span class="p">(</span><span class="n">surf</span><span class="p">)</span>
<a name="ln-1625"></a>  <span class="n">Tgnd</span> <span class="o">=</span> <span class="n">TempOutsideAirFD</span><span class="p">(</span><span class="n">surf</span><span class="p">)</span>
<a name="ln-1626"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">OtherSideCondModeledExt</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1627"></a>   <span class="c">!CR8046 switch modeled rad temp for sky temp.</span>
<a name="ln-1628"></a>    <span class="n">TSky</span> <span class="o">=</span> <span class="n">OSCM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">OSCMPtr</span><span class="p">)%</span><span class="n">TRad</span>
<a name="ln-1629"></a>    <span class="n">QRadSWOutFD</span> <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! eliminate incident shortwave on underlying surface</span>
<a name="ln-1630"></a>
<a name="ln-1631"></a>  <span class="k">ELSE</span>
<a name="ln-1632"></a>  <span class="c">!Set the external conditions to local variables</span>
<a name="ln-1633"></a>    <span class="n">QRadSWOutFD</span> <span class="o">=</span> <span class="n">QRadSWOutAbs</span><span class="p">(</span><span class="n">surf</span><span class="p">)</span>
<a name="ln-1634"></a>    <span class="n">QRadSWOutMvInsulFD</span> <span class="o">=</span> <span class="n">QRadSWOutMvIns</span><span class="p">(</span><span class="n">Surf</span><span class="p">)</span>
<a name="ln-1635"></a>    <span class="n">TSky</span> <span class="o">=</span> <span class="n">SkyTemp</span>
<a name="ln-1636"></a>  <span class="n">ENDIF</span>
<a name="ln-1637"></a>  <span class="n">Tia</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)</span>
<a name="ln-1638"></a>  <span class="n">SigmaRLoc</span><span class="o">=</span><span class="n">SigmaR</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)</span>
<a name="ln-1639"></a>  <span class="n">SigmaCLoc</span><span class="o">=</span><span class="n">SigmaC</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)</span>
<a name="ln-1640"></a>
<a name="ln-1641"></a>  <span class="n">MatLay</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span>
<a name="ln-1642"></a>
<a name="ln-1643"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">Ground</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">IsRain</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1644"></a><span class="k">    </span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">Toa</span>
<a name="ln-1645"></a>    <span class="n">TT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">Toa</span>
<a name="ln-1646"></a>    <span class="n">RhoT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">=</span> <span class="n">rhovo</span>
<a name="ln-1647"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1648"></a>   <span class="c">! this is actually the inside face of another surface, or maybe this same surface if adiabatic</span>
<a name="ln-1649"></a>   <span class="c">! switch around arguments for the other surf and call routines as for interior side BC from opposite face</span>
<a name="ln-1650"></a>
<a name="ln-1651"></a>    <span class="n">LayIn</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TotLayers</span>
<a name="ln-1652"></a>    <span class="n">nodeIn</span> <span class="o">=</span> <span class="n">ConstructFD</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TotNodes</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1653"></a>
<a name="ln-1654"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">surf</span><span class="p">)</span> <span class="k">THEN</span>   <span class="c">!adiabatic surface, PT addded since it is not the same as interzone wall</span>
<a name="ln-1655"></a>                                                   <span class="c">! as Outside Boundary Condition Object can be left blank.</span>
<a name="ln-1656"></a>
<a name="ln-1657"></a>
<a name="ln-1658"></a>      <span class="k">CALL </span><span class="n">InteriorBCEqns</span><span class="p">(</span><span class="n">Delt</span><span class="p">,</span><span class="n">nodeIn</span><span class="p">,</span><span class="n">LayIn</span><span class="p">,</span><span class="n">Surf</span><span class="p">,</span><span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">T</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1659"></a>                                          <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TT</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1660"></a>                                          <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">Rhov</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1661"></a>                                          <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">RhoT</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1662"></a>                                          <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">RH</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1663"></a>                                          <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TD</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1664"></a>                                          <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TDT</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1665"></a>                                          <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">EnthOld</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1666"></a>                                          <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">EnthNew</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1667"></a>                                          <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TDReport</span><span class="p">)</span>
<a name="ln-1668"></a>      <span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>  <span class="o">=</span> <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TDT</span><span class="p">(</span><span class="n">TotNodes</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-1669"></a>      <span class="n">TT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>   <span class="o">=</span> <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">TT</span><span class="p">(</span><span class="n">TotNodes</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-1670"></a>      <span class="n">RhoT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">RhoT</span><span class="p">(</span><span class="n">TotNodes</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-1671"></a>
<a name="ln-1672"></a>    <span class="k">ELSE</span>
<a name="ln-1673"></a>
<a name="ln-1674"></a><span class="k">      CALL </span><span class="n">InteriorBCEqns</span><span class="p">(</span><span class="n">Delt</span><span class="p">,</span><span class="n">nodeIn</span><span class="p">,</span><span class="n">LayIn</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="p">,</span><span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="p">)%</span><span class="n">T</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1675"></a><span class="c">!potential-lkl-from old      CALL InteriorBCEqns(Delt,nodeIn,LayIn,Surf,SurfaceFD(Surface(Surf)%ExtBoundCond)%T, &amp;</span>
<a name="ln-1676"></a>                                            <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="p">)%</span><span class="n">TT</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1677"></a>                                            <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="p">)%</span><span class="n">Rhov</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1678"></a>                                            <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="p">)%</span><span class="n">RhoT</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1679"></a>                                            <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="p">)%</span><span class="n">RH</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1680"></a>                                            <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="p">)%</span><span class="n">TD</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1681"></a>                                            <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="p">)%</span><span class="n">TDT</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1682"></a>                                            <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="p">)%</span><span class="n">EnthOld</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1683"></a>                                            <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="p">)%</span><span class="n">EnthNew</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1684"></a>                                            <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="p">)%</span><span class="n">TDReport</span><span class="p">)</span>
<a name="ln-1685"></a>
<a name="ln-1686"></a>      <span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>  <span class="o">=</span> <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="p">)%</span><span class="n">TDT</span><span class="p">(</span><span class="n">TotNodes</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-1687"></a>      <span class="n">TT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>   <span class="o">=</span> <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="p">)%</span><span class="n">TT</span><span class="p">(</span><span class="n">TotNodes</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-1688"></a>      <span class="n">RhoT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">SurfaceFD</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="p">)%</span><span class="n">RhoT</span><span class="p">(</span><span class="n">TotNodes</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-1689"></a>
<a name="ln-1690"></a>    <span class="n">ENDIF</span>
<a name="ln-1691"></a><span class="c">!    CALL InteriorBCEqns(Delt,nodeIn,Layin,Surface(Surf)%ExtBoundCond,SurfaceFD(Surf)%T, &amp;</span>
<a name="ln-1692"></a><span class="c">!                                         SurfaceFD(Surf)%TT, &amp;</span>
<a name="ln-1693"></a><span class="c">!                                         SurfaceFD(Surf)%Rhov, &amp;</span>
<a name="ln-1694"></a><span class="c">!                                         SurfaceFD(Surf)%RhoT, &amp;</span>
<a name="ln-1695"></a><span class="c">!                                         SurfaceFD(Surf)%RH, &amp;</span>
<a name="ln-1696"></a><span class="c">!                                         SurfaceFD(Surf)%TD, &amp;</span>
<a name="ln-1697"></a><span class="c">!                                         SurfaceFD(Surf)%TDT, &amp;</span>
<a name="ln-1698"></a><span class="c">!                                         SurfaceFD(Surf)%EnthOld, &amp;</span>
<a name="ln-1699"></a><span class="c">!                                         SurfaceFD(Surf)%EnthNew)</span>
<a name="ln-1700"></a>
<a name="ln-1701"></a>    <span class="c">! now fill results from interior BC model eqns into local result for current call</span>
<a name="ln-1702"></a><span class="c">!    TDT(I)  = SurfaceFD(Surface(Surf)%ExtBoundCond)%TDT(TotNodes + 1)</span>
<a name="ln-1703"></a><span class="c">!    TT(I)   = SurfaceFD(Surface(Surf)%ExtBoundCond)%TT(TotNodes + 1)</span>
<a name="ln-1704"></a><span class="c">!    RhoT(I) = SurfaceFD(Surface(Surf)%ExtBoundCond)%RhoT(TotNodes + 1)</span>
<a name="ln-1705"></a><span class="c">!    TDT(I)  = SurfaceFD(Surf)%TDT( i)</span>
<a name="ln-1706"></a><span class="c">!    TT(I)   = SurfaceFD(Surf)%TT( i)</span>
<a name="ln-1707"></a><span class="c">!    RhoT(I) = SurfaceFD(Surf)%RhoT( i)</span>
<a name="ln-1708"></a>
<a name="ln-1709"></a>    <span class="n">QNetSurfFromOutside</span> <span class="o">=</span> <span class="n">OpaqSurfInsFaceConductionFlux</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="p">)</span> <span class="c">!filled in InteriorBCEqns</span>
<a name="ln-1710"></a><span class="c">!    QFluxOutsideToOutSurf(Surf)       = QnetSurfFromOutside</span>
<a name="ln-1711"></a>    <span class="n">OpaqSurfOutsideFaceConductionFlux</span><span class="p">(</span><span class="n">Surf</span><span class="p">)</span><span class="o">=</span> <span class="o">-</span><span class="n">QnetSurfFromOutside</span>
<a name="ln-1712"></a>    <span class="n">OpaqSurfOutsideFaceConduction</span><span class="p">(</span><span class="n">Surf</span><span class="p">)</span>     <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">Area</span> <span class="o">*</span> <span class="n">OpaqSurfOutsideFaceConductionFlux</span><span class="p">(</span><span class="n">Surf</span><span class="p">)</span>
<a name="ln-1713"></a>    <span class="n">QHeatOutFlux</span><span class="p">(</span><span class="n">Surf</span><span class="p">)</span>  <span class="o">=</span> <span class="n">QnetSurfFromOutside</span>
<a name="ln-1714"></a>
<a name="ln-1715"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>   <span class="c">! regular outside conditions</span>
<a name="ln-1716"></a>
<a name="ln-1717"></a><span class="c">!++++++++++++++++++++++++++++++++++++++++++++++++++++++</span>
<a name="ln-1718"></a>
<a name="ln-1719"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">HeatTransferAlgorithm</span> <span class="o">==</span> <span class="n">HeatTransferModel_CondFD</span>  <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1720"></a>
<a name="ln-1721"></a>    <span class="c">! regular outside conditions</span>
<a name="ln-1722"></a>
<a name="ln-1723"></a>     <span class="c">!  Set Thermal Conductivity.  Can be constant, simple linear temp dep or multiple linear segment temp function dep.</span>
<a name="ln-1724"></a>
<a name="ln-1725"></a>
<a name="ln-1726"></a>      <span class="n">kto</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">Conductivity</span>   <span class="c">!  20C base conductivity</span>
<a name="ln-1727"></a>      <span class="n">kt1</span> <span class="o">=</span> <span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">tk1</span>  <span class="c">!  linear coefficient (normally zero)</span>
<a name="ln-1728"></a>      <span class="n">kt</span><span class="o">=</span> <span class="n">kto</span> <span class="o">+</span> <span class="n">kt1</span><span class="o">*</span><span class="p">((</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">+</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="mf">2.d0</span> <span class="o">-</span> <span class="mi">2</span><span class="mf">0.d0</span><span class="p">)</span>
<a name="ln-1729"></a>
<a name="ln-1730"></a>      <span class="k">IF</span><span class="p">(</span> <span class="nb">SUM</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">TempCond</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Multiple Linear Segment Function</span>
<a name="ln-1731"></a>
<a name="ln-1732"></a>        <span class="n">DepVarCol</span><span class="o">=</span> <span class="mi">2</span>  <span class="c">! thermal conductivity</span>
<a name="ln-1733"></a>        <span class="n">IndVarCol</span><span class="o">=</span><span class="mi">1</span>  <span class="c">!temperature</span>
<a name="ln-1734"></a>            <span class="c">!  Use average temp of surface and first node for k</span>
<a name="ln-1735"></a>        <span class="n">kt</span> <span class="o">=</span><span class="n">terpld</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">numTempCond</span><span class="p">,</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">TempCond</span><span class="p">,(</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">+</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="mf">2.d0</span><span class="p">,</span><span class="n">IndVarCol</span><span class="p">,</span><span class="n">DepVarCol</span><span class="p">)</span>
<a name="ln-1736"></a>
<a name="ln-1737"></a>      <span class="n">ENDIF</span>
<a name="ln-1738"></a>
<a name="ln-1739"></a>
<a name="ln-1740"></a>      <span class="n">RhoS</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">Density</span>
<a name="ln-1741"></a>      <span class="n">Cpo</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">SpecHeat</span>
<a name="ln-1742"></a>      <span class="n">Cp</span><span class="o">=</span><span class="n">Cpo</span>  <span class="c">!  Will be changed if PCM</span>
<a name="ln-1743"></a>      <span class="n">Delx</span> <span class="o">=</span> <span class="n">ConstructFD</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">Delx</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span>
<a name="ln-1744"></a>
<a name="ln-1745"></a>          <span class="c">!Calculate the Dry Heat Conduction Equation</span>
<a name="ln-1746"></a>
<a name="ln-1747"></a>      <span class="n">MatLay</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span>
<a name="ln-1748"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">ROnly</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">Material</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">Group</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="k">THEN</span>  <span class="c">! R Layer or Air Layer  **********</span>
<a name="ln-1749"></a>               <span class="c">!  Use algebraic equation for TDT based on R</span>
<a name="ln-1750"></a>
<a name="ln-1751"></a>        <span class="n">Rlayer</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">Resistance</span>
<a name="ln-1752"></a>
<a name="ln-1753"></a>        <span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">QRadSWOutFD</span><span class="o">*</span><span class="n">Rlayer</span> <span class="o">+</span> <span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">hgnd</span><span class="o">*</span><span class="n">Rlayer</span><span class="o">*</span><span class="n">Tgnd</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-1754"></a>                   <span class="n">hconvo</span><span class="o">*</span><span class="n">Rlayer</span><span class="o">*</span><span class="n">Toa</span> <span class="o">+</span> <span class="n">hrad</span><span class="o">*</span><span class="n">Rlayer</span><span class="o">*</span><span class="n">Toa</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-1755"></a>                   <span class="n">hsky</span><span class="o">*</span><span class="n">Rlayer</span><span class="o">*</span><span class="n">Tsky</span><span class="p">)</span><span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-1756"></a>                   <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">hconvo</span><span class="o">*</span><span class="n">Rlayer</span> <span class="o">+</span> <span class="n">hgnd</span><span class="o">*</span><span class="n">Rlayer</span> <span class="o">+</span> <span class="n">hrad</span><span class="o">*</span><span class="n">Rlayer</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-1757"></a>                    <span class="n">hsky</span><span class="o">*</span><span class="n">Rlayer</span><span class="p">)</span>
<a name="ln-1758"></a>        <span class="k">IF</span> <span class="p">((</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">MaxSurfaceTempLimit</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1759"></a>            <span class="p">(</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">MinSurfaceTempLimit</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1760"></a><span class="k">          </span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">MinSurfaceTempLimit</span><span class="p">,</span><span class="nb">MIN</span><span class="p">(</span><span class="n">MaxSurfaceTempLimit</span><span class="p">,</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>  <span class="c">!  +++++ Limit Check</span>
<a name="ln-1761"></a><span class="c">!          CALL CheckFDSurfaceTempLimits(I,TDT(I))</span>
<a name="ln-1762"></a>        <span class="n">ENDIF</span>
<a name="ln-1763"></a>
<a name="ln-1764"></a>      <span class="k">ELSE</span>  <span class="c">! Regular or phase change material layer</span>
<a name="ln-1765"></a>
<a name="ln-1766"></a>             <span class="c">!  check for phase change material</span>
<a name="ln-1767"></a>        <span class="k">IF</span><span class="p">(</span> <span class="nb">SUM</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">TempEnth</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>    <span class="c">!  phase change material,  Use TempEnth Data to generate Cp</span>
<a name="ln-1768"></a><span class="c">!               CheckhT = Material(MatLay)%TempEnth       ! debug</span>
<a name="ln-1769"></a>
<a name="ln-1770"></a>          <span class="c">!       Enthalpy function used to get average specific heat.  Updated by GS so enthalpy function is followed.</span>
<a name="ln-1771"></a>
<a name="ln-1772"></a>          <span class="n">DepVarCol</span><span class="o">=</span> <span class="mi">2</span>  <span class="c">! enthalpy</span>
<a name="ln-1773"></a>          <span class="n">IndVarCol</span><span class="o">=</span><span class="mi">1</span>  <span class="c">!temperature</span>
<a name="ln-1774"></a>          <span class="n">EnthOld</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span><span class="n">terpld</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">numTempEnth</span><span class="p">,</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">TempEnth</span><span class="p">,</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">IndVarCol</span><span class="p">,</span><span class="n">DepVarCol</span><span class="p">)</span>
<a name="ln-1775"></a>          <span class="n">EnthNew</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span><span class="n">terpld</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">numTempEnth</span><span class="p">,</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">TempEnth</span><span class="p">,</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">IndVarCol</span><span class="p">,</span><span class="n">DepVarCol</span><span class="p">)</span>
<a name="ln-1776"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">EnthNew</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">==</span><span class="n">EnthOld</span><span class="p">(</span><span class="n">I</span><span class="p">))</span>  <span class="k">THEN</span>
<a name="ln-1777"></a><span class="k">            </span><span class="n">Cp</span><span class="o">=</span><span class="n">Cpo</span>
<a name="ln-1778"></a>          <span class="k">ELSE</span>
<a name="ln-1779"></a><span class="k">            </span><span class="n">Cp</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">Cpo</span><span class="p">,(</span><span class="n">EnthNew</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">-</span><span class="n">EnthOld</span><span class="p">(</span><span class="n">I</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">-</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>
<a name="ln-1780"></a>          <span class="k">END IF</span>
<a name="ln-1781"></a><span class="k">         ELSE</span>
<a name="ln-1782"></a><span class="k">           </span><span class="n">Cp</span> <span class="o">=</span> <span class="n">Cpo</span>
<a name="ln-1783"></a>         <span class="k">END IF</span> <span class="c">! Phase Change Material option</span>
<a name="ln-1784"></a>
<a name="ln-1785"></a><span class="c">!     Choose Regular or Transparent Insulation Case</span>
<a name="ln-1786"></a>
<a name="ln-1787"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">HMovInsul</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="k">THEN</span>  <span class="c">!  regular  case</span>
<a name="ln-1788"></a>
<a name="ln-1789"></a>          <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">CondFDSchemeType</span><span class="p">)</span>
<a name="ln-1790"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">CrankNicholsonSecondOrder</span><span class="p">)</span>
<a name="ln-1791"></a>             <span class="c">!  Second Order equation</span>
<a name="ln-1792"></a>            <span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">=</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">*</span><span class="n">QRadSWOutFD</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.5d0</span><span class="o">*</span><span class="n">Cp</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">RhoS</span><span class="o">*</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">))</span><span class="o">/</span><span class="n">DelT</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.5d0</span><span class="o">*</span><span class="n">kt</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0d0</span><span class="o">*</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span> <span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span><span class="o">/</span><span class="n">Delx</span>  <span class="p">&amp;</span>
<a name="ln-1793"></a>                     <span class="o">+</span> <span class="p">(</span><span class="mf">0.5d0</span><span class="o">*</span><span class="n">kt</span><span class="o">*</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="n">Delx</span> <span class="o">+</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="n">hgnd</span><span class="o">*</span><span class="n">Tgnd</span> <span class="o">+</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="n">hgnd</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0d0</span><span class="o">*</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span> <span class="n">Tgnd</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="n">hconvo</span><span class="o">*</span><span class="n">Toa</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-1794"></a>                        <span class="mf">0.5d0</span><span class="o">*</span><span class="n">hrad</span><span class="o">*</span><span class="n">Toa</span>  <span class="p">&amp;</span>
<a name="ln-1795"></a>                     <span class="o">+</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="n">hconvo</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">1.d0</span><span class="o">*</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span> <span class="n">Toa</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="n">hrad</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">1.d0</span><span class="o">*</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span> <span class="n">Toa</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="n">hsky</span><span class="o">*</span><span class="n">Tsky</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-1796"></a>                        <span class="mf">0.5d0</span><span class="o">*</span><span class="n">hsky</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">1.d0</span><span class="o">*</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span> <span class="n">Tsky</span><span class="p">))</span><span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-1797"></a>                       <span class="p">(</span><span class="mf">0.5d0</span><span class="o">*</span><span class="n">hconvo</span> <span class="o">+</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="n">hgnd</span> <span class="o">+</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="n">hrad</span> <span class="o">+</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="n">hsky</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.5d0</span><span class="o">*</span><span class="n">kt</span><span class="p">)</span><span class="o">/</span><span class="n">Delx</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.5d0</span><span class="o">*</span><span class="n">Cp</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">RhoS</span><span class="p">)</span><span class="o">/</span><span class="n">DelT</span><span class="p">)</span>
<a name="ln-1798"></a><span class="c">!feb2012            TDT(I)= (1.0d0*QRadSWOutFD + (0.5d0*Cp*Delx*RhoS*TD(I))/DelT + (0.5d0*kt*(-1.0d0*TD(I) + TD(I+1)))/Delx  &amp;</span>
<a name="ln-1799"></a><span class="c">!feb2012                     + (0.5d0*kt*TDT(I+1))/Delx + 0.5d0*hgnd*Tgnd + 0.5d0*hgnd*(-1.0d0*TD(I) + Tgnd) + 0.5d0*hconvo*Toa +   &amp;</span>
<a name="ln-1800"></a><span class="c">!feb2012                        0.5d0*hrad*Toa  &amp;</span>
<a name="ln-1801"></a><span class="c">!feb2012                     + 0.5d0*hconvo*(-1.d0*TD(I) + Toa) + 0.5d0*hrad*(-1.d0*TD(I) + Toa) + 0.5d0*hsky*Tsky +   &amp;</span>
<a name="ln-1802"></a><span class="c">!feb2012                        0.5d0*hsky*(-1.d0*TD(I) + Tsky))/  &amp;</span>
<a name="ln-1803"></a><span class="c">!feb2012                       (0.5d0*hconvo + 0.5d0*hgnd + 0.5d0*hrad + 0.5d0*hsky + (0.5d0*kt)/Delx + (0.5d0*Cp*Delx*RhoS)/DelT)</span>
<a name="ln-1804"></a>
<a name="ln-1805"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">FullyImplicitFirstOrder</span><span class="p">)</span>
<a name="ln-1806"></a>           <span class="c">!   First Order</span>
<a name="ln-1807"></a>            <span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="mf">2.0d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">QRadSWOutFD</span> <span class="o">+</span> <span class="n">Cp</span><span class="o">*</span><span class="n">Delx</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">RhoS</span><span class="o">*</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1808"></a>                    <span class="o">+</span> <span class="mf">2.0d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">kt</span><span class="o">*</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mf">2.0d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">hgnd</span><span class="o">*</span><span class="n">Tgnd</span>  <span class="p">&amp;</span>
<a name="ln-1809"></a>                    <span class="o">+</span> <span class="mf">2.0d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">hconvo</span><span class="o">*</span><span class="n">Toa</span> <span class="o">+</span> <span class="mf">2.0d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">hrad</span><span class="o">*</span><span class="n">Toa</span> <span class="o">+</span> <span class="mf">2.0d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">hsky</span><span class="o">*</span><span class="n">Tsky</span><span class="p">)</span><span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-1810"></a>                     <span class="p">(</span><span class="mf">2.0d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">hconvo</span> <span class="o">+</span> <span class="mf">2.0d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">hgnd</span> <span class="o">+</span> <span class="mf">2.0d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">hrad</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-1811"></a>                       <span class="mf">2.0d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">hsky</span> <span class="o">+</span> <span class="mf">2.0d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">kt</span> <span class="o">+</span> <span class="n">Cp</span><span class="o">*</span><span class="n">Delx</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">RhoS</span><span class="p">)</span>
<a name="ln-1812"></a>
<a name="ln-1813"></a>          <span class="k">END SELECT</span>
<a name="ln-1814"></a>
<a name="ln-1815"></a>
<a name="ln-1816"></a><span class="k">        ELSE IF</span> <span class="p">(</span> <span class="n">HMovInsul</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">Then</span>      <span class="c">!  Transparent insulation on outside</span>
<a name="ln-1817"></a>      <span class="c">!  Transparent insulaton additions</span>
<a name="ln-1818"></a>
<a name="ln-1819"></a>        <span class="c">!Movable Insulation Layer Outside surface temp</span>
<a name="ln-1820"></a>
<a name="ln-1821"></a>          <span class="n">TInsulOut</span> <span class="o">=</span> <span class="p">(</span><span class="n">QRadSWOutMvInsulFD</span> <span class="o">+</span> <span class="n">hgnd</span><span class="o">*</span><span class="n">Tgnd</span> <span class="o">+</span> <span class="n">HmovInsul</span><span class="o">*</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-1822"></a>                   <span class="n">hconvo</span><span class="o">*</span><span class="n">Toa</span> <span class="o">+</span> <span class="n">hrad</span><span class="o">*</span><span class="n">Toa</span> <span class="o">+</span> <span class="n">hsky</span><span class="o">*</span><span class="n">Tsky</span><span class="p">)</span><span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-1823"></a>                 <span class="p">(</span><span class="n">hconvo</span> <span class="o">+</span> <span class="n">hgnd</span> <span class="o">+</span> <span class="n">HmovInsul</span> <span class="o">+</span> <span class="n">hrad</span> <span class="o">+</span> <span class="n">hsky</span><span class="p">)</span>
<a name="ln-1824"></a>
<a name="ln-1825"></a>          <span class="c">!List(List(Rule(TDT,(2*Delt*Delx*QradSWOutAbs +</span>
<a name="ln-1826"></a>          <span class="c">!-       Cp*Delx**2*Rhos*TD + 2*Delt*kt*TDTP1 +</span>
<a name="ln-1827"></a>          <span class="c">!-       2*Delt*Delx*HmovInsul*Tiso)/</span>
<a name="ln-1828"></a>          <span class="c">!-     (2*Delt*Delx*HmovInsul + 2*Delt*kt + Cp*Delx**2*Rhos))))</span>
<a name="ln-1829"></a>
<a name="ln-1830"></a>
<a name="ln-1831"></a>         <span class="c">! Wall first node temperature behind Movable insulation</span>
<a name="ln-1832"></a>          <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">CondFDSchemeType</span><span class="p">)</span>
<a name="ln-1833"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">CrankNicholsonSecondOrder</span><span class="p">)</span>
<a name="ln-1834"></a>            <span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">QradSWOutFD</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-1835"></a>                     <span class="n">Cp</span><span class="o">*</span><span class="n">Delx</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">Rhos</span><span class="o">*</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">kt</span><span class="o">*</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-1836"></a>                      <span class="mi">2</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">HmovInsul</span><span class="o">*</span><span class="n">TInsulOut</span><span class="p">)</span><span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-1837"></a>                       <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">HmovInsul</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">kt</span> <span class="o">+</span> <span class="n">Cp</span><span class="o">*</span><span class="n">Delx</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">Rhos</span><span class="p">)</span>
<a name="ln-1838"></a>
<a name="ln-1839"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">FullyImplicitFirstOrder</span><span class="p">)</span>
<a name="ln-1840"></a>            <span class="c">! Currently same as Crank Nicholson, need fully implicit formulation</span>
<a name="ln-1841"></a>            <span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">QradSWOutFD</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-1842"></a>                     <span class="n">Cp</span><span class="o">*</span><span class="n">Delx</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">Rhos</span><span class="o">*</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">kt</span><span class="o">*</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-1843"></a>                      <span class="mi">2</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">HmovInsul</span><span class="o">*</span><span class="n">TInsulOut</span><span class="p">)</span><span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-1844"></a>                       <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">HmovInsul</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">kt</span> <span class="o">+</span> <span class="n">Cp</span><span class="o">*</span><span class="n">Delx</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">Rhos</span><span class="p">)</span>
<a name="ln-1845"></a>
<a name="ln-1846"></a>          <span class="k">END SELECT</span>
<a name="ln-1847"></a>
<a name="ln-1848"></a><span class="k">        End IF</span>   <span class="c">!  Regular layer or Movable insulation cases</span>
<a name="ln-1849"></a>
<a name="ln-1850"></a>        <span class="k">IF</span> <span class="p">((</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">MaxSurfaceTempLimit</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1851"></a>            <span class="p">(</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">MinSurfaceTempLimit</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1852"></a><span class="k">          </span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="nb">Max</span><span class="p">(</span><span class="n">MinSurfaceTempLimit</span><span class="p">,</span><span class="nb">Min</span><span class="p">(</span><span class="n">MaxSurfaceTempLimit</span><span class="p">,</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>  <span class="c">!  +++++ Limit Check</span>
<a name="ln-1853"></a><span class="c">!          CALL CheckFDSurfaceTempLimits(I,TDT(I))</span>
<a name="ln-1854"></a>        <span class="n">ENDIF</span>
<a name="ln-1855"></a>
<a name="ln-1856"></a>
<a name="ln-1857"></a>      <span class="k">END IF</span>  <span class="c">! R layer or Regular layer</span>
<a name="ln-1858"></a>
<a name="ln-1859"></a>
<a name="ln-1860"></a>    <span class="k">END IF</span>   <span class="c">!End IF--ELSE SECTION (regular detailed FD part or SigmaR SigmaC part</span>
<a name="ln-1861"></a>
<a name="ln-1862"></a>    <span class="c">!  Determine net heat flux to ooutside face.</span>
<a name="ln-1863"></a>    <span class="c">!One formulation that works for Fully Implicit and CrankNicholson and massless wall</span>
<a name="ln-1864"></a>
<a name="ln-1865"></a>    <span class="n">QNetSurfFromOutside</span> <span class="o">=</span> <span class="n">QRadSWOutFD</span> <span class="o">+</span> <span class="p">(</span><span class="n">hgnd</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span> <span class="n">Tgnd</span><span class="p">)</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-1866"></a>             <span class="n">hconvo</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span> <span class="n">Toa</span><span class="p">)</span> <span class="o">+</span> <span class="n">hrad</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span> <span class="n">Toa</span><span class="p">)</span> <span class="o">+</span> <span class="n">hsky</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span> <span class="n">Tsky</span><span class="p">))</span>
<a name="ln-1867"></a>
<a name="ln-1868"></a>    <span class="c">!Same sign convention as CTFs</span>
<a name="ln-1869"></a>    <span class="n">OpaqSurfOutsideFaceConductionFlux</span><span class="p">(</span><span class="n">Surf</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">QnetSurfFromOutside</span>
<a name="ln-1870"></a>    <span class="n">OpaqSurfOutsideFaceConduction</span><span class="p">(</span><span class="n">Surf</span><span class="p">)</span>     <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">Area</span> <span class="o">*</span> <span class="n">OpaqSurfOutsideFaceConductionFlux</span><span class="p">(</span><span class="n">Surf</span><span class="p">)</span>
<a name="ln-1871"></a>
<a name="ln-1872"></a>    <span class="c">!Report all outside BC heat fluxes</span>
<a name="ln-1873"></a>    <span class="n">QdotRadOutRepPerArea</span><span class="p">(</span><span class="n">Surf</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">hgnd</span><span class="o">*</span><span class="p">(</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">-</span> <span class="n">Tgnd</span><span class="p">)</span> <span class="o">+</span>  <span class="n">hrad</span><span class="o">*</span><span class="p">(</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">-</span> <span class="n">Toa</span><span class="p">)</span> <span class="o">+</span> <span class="n">hsky</span><span class="o">*</span><span class="p">(</span> <span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">-</span> <span class="n">Tsky</span><span class="p">))</span>
<a name="ln-1874"></a>    <span class="n">QdotRadOutRep</span><span class="p">(</span><span class="n">Surf</span><span class="p">)</span>        <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">Area</span> <span class="o">*</span> <span class="n">QdotRadOutRepPerArea</span><span class="p">(</span><span class="n">Surf</span><span class="p">)</span>
<a name="ln-1875"></a>    <span class="n">QRadOutReport</span><span class="p">(</span><span class="n">Surf</span><span class="p">)</span>     <span class="o">=</span> <span class="n">QdotRadOutRep</span><span class="p">(</span><span class="n">Surf</span><span class="p">)</span> <span class="o">*</span> <span class="n">SecInHour</span> <span class="o">*</span> <span class="n">TimeStepZone</span>
<a name="ln-1876"></a>
<a name="ln-1877"></a>  <span class="k">END IF</span>  <span class="c">!End IF --ELSE SECTION (regular BC part of the ground and Rain check)</span>
<a name="ln-1878"></a>
<a name="ln-1879"></a>
<a name="ln-1880"></a><span class="k">RETURN</span>
<a name="ln-1881"></a>
<a name="ln-1882"></a><span class="k">END SUBROUTINE </span><span class="n">ExteriorBCEqns</span>
<a name="ln-1883"></a>
<a name="ln-1884"></a><span class="k">SUBROUTINE </span><span class="n">InteriorNodeEqns</span><span class="p">(</span><span class="n">Delt</span><span class="p">,</span><span class="n">I</span><span class="p">,</span><span class="n">Lay</span><span class="p">,</span><span class="n">Surf</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">TT</span><span class="p">,</span><span class="n">Rhov</span><span class="p">,</span><span class="n">RhoT</span><span class="p">,</span><span class="n">RH</span><span class="p">,</span><span class="n">TD</span><span class="p">,</span><span class="n">TDT</span><span class="p">,</span><span class="n">EnthOld</span><span class="p">,</span><span class="n">EnthNew</span><span class="p">)</span>
<a name="ln-1885"></a>
<a name="ln-1886"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1887"></a>          <span class="c">!       AUTHOR         Richard Liesen</span>
<a name="ln-1888"></a>          <span class="c">!       DATE WRITTEN   November, 2003</span>
<a name="ln-1889"></a>          <span class="c">!       MODIFIED       May 2011, B. Griffith and P. Tabares</span>
<a name="ln-1890"></a>          <span class="c">!       RE-ENGINEERED  C. O. Pedersen, 2006</span>
<a name="ln-1891"></a>
<a name="ln-1892"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1893"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-1894"></a>
<a name="ln-1895"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1896"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-1897"></a>
<a name="ln-1898"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1899"></a>          <span class="c">! na</span>
<a name="ln-1900"></a>
<a name="ln-1901"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1902"></a>          <span class="c">! na</span>
<a name="ln-1903"></a>
<a name="ln-1904"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1905"></a>
<a name="ln-1906"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1907"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Delt</span>  <span class="c">! Time Increment</span>
<a name="ln-1908"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">I</span>     <span class="c">! Node Index</span>
<a name="ln-1909"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Lay</span>   <span class="c">! Layer Number for Construction</span>
<a name="ln-1910"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Surf</span>  <span class="c">! Surface number</span>
<a name="ln-1911"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">In</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">T</span>     <span class="c">!INSIDE SURFACE TEMPERATURE OF EACH HEAT TRANSFER SURF.</span>
<a name="ln-1912"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">InOut</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TT</span>    <span class="c">!INSIDE SURFACE TEMPERATURE OF EACH HEAT TRANSFER SURF.</span>
<a name="ln-1913"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">In</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Rhov</span>     <span class="c">!INSIDE SURFACE TEMPERATURE OF EACH HEAT TRANSFER SURF.</span>
<a name="ln-1914"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">InOut</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RhoT</span>  <span class="c">!INSIDE SURFACE TEMPERATURE OF EACH HEAT TRANSFER SURF.</span>
<a name="ln-1915"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">In</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TD</span>     <span class="c">!INSIDE SURFACE TEMPERATURE OF EACH HEAT TRANSFER SURF.</span>
<a name="ln-1916"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">InOut</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TDT</span>    <span class="c">!INSIDE SURFACE TEMPERATURE OF EACH HEAT TRANSFER SURF.</span>
<a name="ln-1917"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">InOut</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RH</span>    <span class="c">!INSIDE SURFACE TEMPERATURE OF EACH HEAT TRANSFER SURF.</span>
<a name="ln-1918"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">InOut</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EnthOld</span>    <span class="c">! Old Nodal enthalpy</span>
<a name="ln-1919"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">InOut</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EnthNew</span>    <span class="c">! New Nodal enthalpy</span>
<a name="ln-1920"></a>
<a name="ln-1921"></a>
<a name="ln-1922"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1923"></a><span class="c">!  REAL(r64), PARAMETER :: NinetyNine=99.0d0</span>
<a name="ln-1924"></a>
<a name="ln-1925"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-1926"></a>          <span class="c">! na</span>
<a name="ln-1927"></a>
<a name="ln-1928"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-1929"></a>          <span class="c">! na</span>
<a name="ln-1930"></a>
<a name="ln-1931"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1932"></a>          <span class="c">! na</span>
<a name="ln-1933"></a>
<a name="ln-1934"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Delx</span>
<a name="ln-1935"></a>
<a name="ln-1936"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ConstrNum</span>
<a name="ln-1937"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MatLay</span>
<a name="ln-1938"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DepVarCol</span>
<a name="ln-1939"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IndVarCol</span>
<a name="ln-1940"></a>
<a name="ln-1941"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">kt</span>  <span class="c">!  Thermal conductivity in temperature equation</span>
<a name="ln-1942"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ktA1</span>  <span class="c">!  Variable Outer Thermal conductivity in temperature equation</span>
<a name="ln-1943"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ktA2</span>  <span class="c">!  Thermal Inner conductivity in temperature equation</span>
<a name="ln-1944"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">kto</span> <span class="c">!  base 20 C thermal conductivity</span>
<a name="ln-1945"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">kt1</span> <span class="c">!  temperature coefficient for simple temp dep k.</span>
<a name="ln-1946"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Cp</span>   <span class="c">!  Cp used</span>
<a name="ln-1947"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Cpo</span>  <span class="c">!  Const Cp from input</span>
<a name="ln-1948"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RhoS</span>
<a name="ln-1949"></a>
<a name="ln-1950"></a>  <span class="n">ConstrNum</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-1951"></a>
<a name="ln-1952"></a>  <span class="n">MatLay</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span>
<a name="ln-1953"></a>
<a name="ln-1954"></a>   <span class="c">!  Set Thermal Conductivity.  Can be constant, simple linear temp dep or multiple linear segment temp function dep.</span>
<a name="ln-1955"></a>  <span class="n">kto</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">Conductivity</span>   <span class="c">!  20C base conductivity</span>
<a name="ln-1956"></a>  <span class="n">kt1</span> <span class="o">=</span> <span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">tk1</span>  <span class="c">!  linear coefficient (normally zero)</span>
<a name="ln-1957"></a>  <span class="n">kt</span>  <span class="o">=</span> <span class="n">kto</span> <span class="o">+</span> <span class="n">kt1</span><span class="o">*</span><span class="p">((</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">+</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="mf">2.d0</span> <span class="o">-</span> <span class="mi">2</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-1958"></a>  <span class="n">ktA1</span> <span class="o">=</span> <span class="n">kto</span> <span class="o">+</span> <span class="n">kt1</span><span class="o">*</span><span class="p">((</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">+</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="mf">2.d0</span> <span class="o">-</span> <span class="mi">2</span><span class="mf">0.0d0</span><span class="p">)</span>   <span class="c">! Will be overridden if variable k</span>
<a name="ln-1959"></a>  <span class="n">ktA2</span> <span class="o">=</span> <span class="n">kto</span> <span class="o">+</span> <span class="n">kt1</span><span class="o">*</span><span class="p">((</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">+</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="mf">2.d0</span> <span class="o">-</span> <span class="mi">2</span><span class="mf">0.0d0</span><span class="p">)</span>   <span class="c">! Will be overridden if variable k</span>
<a name="ln-1960"></a>
<a name="ln-1961"></a>  <span class="k">IF</span><span class="p">(</span> <span class="nb">SUM</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">TempCond</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Multiple Linear Segment Function</span>
<a name="ln-1962"></a>
<a name="ln-1963"></a>    <span class="n">DepVarCol</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c">! thermal conductivity</span>
<a name="ln-1964"></a>    <span class="n">IndVarCol</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c">!temperature</span>
<a name="ln-1965"></a>    <span class="n">ktA1</span> <span class="o">=</span> <span class="n">terpld</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">numTempCond</span><span class="p">,</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">TempCond</span><span class="p">,(</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">+</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="mf">2.0d0</span> <span class="p">,</span><span class="n">IndVarCol</span><span class="p">,</span><span class="n">DepVarCol</span><span class="p">)</span>
<a name="ln-1966"></a>    <span class="n">ktA2</span> <span class="o">=</span> <span class="n">terpld</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">numTempCond</span><span class="p">,</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">TempCond</span><span class="p">,(</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">+</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="mf">2.0d0</span> <span class="p">,</span><span class="n">IndVarCol</span><span class="p">,</span><span class="n">DepVarCol</span><span class="p">)</span>
<a name="ln-1967"></a>  <span class="n">ENDIF</span>
<a name="ln-1968"></a>
<a name="ln-1969"></a>  <span class="n">RhoS</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">Density</span>
<a name="ln-1970"></a>  <span class="n">Cpo</span>  <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">SpecHeat</span>
<a name="ln-1971"></a>  <span class="n">Cp</span>   <span class="o">=</span> <span class="n">Cpo</span>  <span class="c">! Will be changed if PCM</span>
<a name="ln-1972"></a>  <span class="n">Delx</span> <span class="o">=</span> <span class="n">ConstructFD</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">Delx</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span>
<a name="ln-1973"></a>
<a name="ln-1974"></a>  <span class="k">IF</span><span class="p">(</span> <span class="nb">SUM</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">TempEnth</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>    <span class="c">!  phase change material,  Use TempEnth Data</span>
<a name="ln-1975"></a>
<a name="ln-1976"></a>    <span class="n">DepVarCol</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c">! enthalpy</span>
<a name="ln-1977"></a>    <span class="n">IndVarCol</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c">!temperature</span>
<a name="ln-1978"></a>    <span class="n">EnthOld</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span><span class="n">terpld</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">numTempEnth</span><span class="p">,</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">TempEnth</span><span class="p">,</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">IndVarCol</span><span class="p">,</span><span class="n">DepVarCol</span><span class="p">)</span>
<a name="ln-1979"></a>    <span class="n">EnthNew</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span><span class="n">terpld</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">numTempEnth</span><span class="p">,</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">TempEnth</span><span class="p">,</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">IndVarCol</span><span class="p">,</span><span class="n">DepVarCol</span><span class="p">)</span>
<a name="ln-1980"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">EnthNew</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">==</span><span class="n">EnthOld</span><span class="p">(</span><span class="n">I</span><span class="p">))</span>  <span class="k">THEN</span>
<a name="ln-1981"></a><span class="k">      </span><span class="n">Cp</span> <span class="o">=</span> <span class="n">Cpo</span>
<a name="ln-1982"></a>    <span class="k">ELSE</span>
<a name="ln-1983"></a><span class="k">      </span><span class="n">Cp</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">Cpo</span><span class="p">,(</span><span class="n">EnthNew</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">-</span><span class="n">EnthOld</span><span class="p">(</span><span class="n">I</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">-</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>
<a name="ln-1984"></a>    <span class="k">END IF</span>
<a name="ln-1985"></a>
<a name="ln-1986"></a><span class="k">  ELSE</span>  <span class="c">! No phase change</span>
<a name="ln-1987"></a>
<a name="ln-1988"></a>    <span class="n">Cp</span> <span class="o">=</span> <span class="n">Cpo</span>
<a name="ln-1989"></a>
<a name="ln-1990"></a>  <span class="k">END IF</span> <span class="c">! Phase Change case</span>
<a name="ln-1991"></a>
<a name="ln-1992"></a>  <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">CondFDSchemeType</span><span class="p">)</span>
<a name="ln-1993"></a>
<a name="ln-1994"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">CrankNicholsonSecondOrder</span><span class="p">)</span>
<a name="ln-1995"></a>    <span class="c">! Adams-Moulton second order</span>
<a name="ln-1996"></a>    <span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">=</span> <span class="p">((</span><span class="n">Cp</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">RhoS</span><span class="o">*</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">))</span><span class="o">/</span><span class="n">Delt</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-1997"></a>              <span class="mf">0.5d0</span><span class="o">*</span><span class="p">((</span><span class="n">ktA2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0d0</span><span class="o">*</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span> <span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span><span class="o">/</span><span class="n">Delx</span> <span class="o">+</span> <span class="p">(</span><span class="n">ktA1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">1.d0</span><span class="o">*</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span> <span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span><span class="o">/</span><span class="n">Delx</span><span class="p">)</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-1998"></a>              <span class="p">(</span><span class="mf">0.5d0</span><span class="o">*</span><span class="n">ktA2</span><span class="o">*</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="n">Delx</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.5d0</span><span class="o">*</span><span class="n">ktA1</span><span class="o">*</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="n">Delx</span><span class="p">)</span><span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-1999"></a>              <span class="p">((</span><span class="mf">0.5d0</span><span class="o">*</span><span class="p">(</span><span class="n">ktA1</span><span class="o">+</span><span class="n">ktA2</span><span class="p">))</span><span class="o">/</span><span class="n">Delx</span> <span class="o">+</span> <span class="p">(</span><span class="n">Cp</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">RhoS</span><span class="p">)</span><span class="o">/</span><span class="n">Delt</span><span class="p">)</span>
<a name="ln-2000"></a>
<a name="ln-2001"></a>
<a name="ln-2002"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">FullyImplicitFirstOrder</span><span class="p">)</span>
<a name="ln-2003"></a>    <span class="c">! Adams-Moulton First order</span>
<a name="ln-2004"></a>        <span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">=</span> <span class="p">((</span><span class="n">Cp</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">RhoS</span><span class="o">*</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">))</span><span class="o">/</span><span class="n">Delt</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-2005"></a>                 <span class="p">(</span><span class="mf">1.d0</span><span class="o">*</span><span class="n">ktA2</span><span class="o">*</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="n">Delx</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">*</span><span class="n">ktA1</span><span class="o">*</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="n">Delx</span><span class="p">)</span><span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-2006"></a>                 <span class="p">((</span><span class="mf">2.d0</span><span class="o">*</span><span class="p">(</span><span class="n">ktA1</span><span class="o">+</span><span class="n">ktA2</span><span class="p">)</span><span class="o">/</span><span class="mf">2.d0</span><span class="p">)</span><span class="o">/</span><span class="n">Delx</span> <span class="o">+</span> <span class="p">(</span><span class="n">Cp</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">RhoS</span><span class="p">)</span><span class="o">/</span><span class="n">Delt</span><span class="p">)</span>
<a name="ln-2007"></a>
<a name="ln-2008"></a>
<a name="ln-2009"></a>  <span class="k">END SELECT</span>
<a name="ln-2010"></a>
<a name="ln-2011"></a><span class="k"> IF</span> <span class="p">((</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">MaxSurfaceTempLimit</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2012"></a>     <span class="p">(</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">MinSurfaceTempLimit</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2013"></a><span class="k">   </span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="nb">Max</span><span class="p">(</span><span class="n">MinSurfaceTempLimit</span><span class="p">,</span><span class="nb">Min</span><span class="p">(</span><span class="n">MaxSurfaceTempLimit</span><span class="p">,</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>  <span class="c">!  +++++ Limit Check</span>
<a name="ln-2014"></a><span class="c">!   CALL CheckFDSurfaceTempLimits(I,TDT(I))</span>
<a name="ln-2015"></a>  <span class="n">ENDIF</span>
<a name="ln-2016"></a>
<a name="ln-2017"></a><span class="k">RETURN</span>
<a name="ln-2018"></a>
<a name="ln-2019"></a><span class="k">END SUBROUTINE </span><span class="n">InteriorNodeEqns</span>
<a name="ln-2020"></a>
<a name="ln-2021"></a>
<a name="ln-2022"></a><span class="k">SUBROUTINE </span><span class="n">IntInterfaceNodeEqns</span><span class="p">(</span><span class="n">Delt</span><span class="p">,</span><span class="n">I</span><span class="p">,</span><span class="n">Lay</span><span class="p">,</span><span class="n">Surf</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">TT</span><span class="p">,</span><span class="n">Rhov</span><span class="p">,</span><span class="n">RhoT</span><span class="p">,</span><span class="n">RH</span><span class="p">,</span><span class="n">TD</span><span class="p">,</span><span class="n">TDT</span><span class="p">,</span><span class="n">EnthOld</span><span class="p">,</span><span class="n">EnthNew</span><span class="p">,</span><span class="n">GSiter</span><span class="p">)</span>
<a name="ln-2023"></a>
<a name="ln-2024"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2025"></a>          <span class="c">!       AUTHOR         Richard Liesen</span>
<a name="ln-2026"></a>          <span class="c">!       DATE WRITTEN   November, 2003</span>
<a name="ln-2027"></a>          <span class="c">!       MODIFIED       May 2011, B. Griffith, P. Tabares,  add first order fully implicit, bug fixes, cleanup</span>
<a name="ln-2028"></a>          <span class="c">!       RE-ENGINEERED  Curtis Pedersen, Changed to Implit mode and included enthalpy.  FY2006</span>
<a name="ln-2029"></a>
<a name="ln-2030"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2031"></a>          <span class="c">! calculate finite difference heat transfer for nodes that interface two different material layers inside construction</span>
<a name="ln-2032"></a>
<a name="ln-2033"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2034"></a>          <span class="c">! na</span>
<a name="ln-2035"></a>
<a name="ln-2036"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2037"></a>          <span class="c">! na</span>
<a name="ln-2038"></a>
<a name="ln-2039"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2040"></a>          <span class="c">! na</span>
<a name="ln-2041"></a>
<a name="ln-2042"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2043"></a>
<a name="ln-2044"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2045"></a>
<a name="ln-2046"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Delt</span>  <span class="c">! Time Increment</span>
<a name="ln-2047"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">I</span>     <span class="c">! Node Index</span>
<a name="ln-2048"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Lay</span>   <span class="c">! Layer Number for Construction</span>
<a name="ln-2049"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Surf</span>  <span class="c">! Surface number</span>
<a name="ln-2050"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">GSiter</span>  <span class="c">! Iteration number of Gauss Seidell iteration</span>
<a name="ln-2051"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">In</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">T</span>     <span class="c">!INSIDE SURFACE TEMPERATURE OF EACH HEAT TRANSFER SURF.</span>
<a name="ln-2052"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">InOut</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TT</span>    <span class="c">!INSIDE SURFACE TEMPERATURE OF EACH HEAT TRANSFER SURF.</span>
<a name="ln-2053"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">In</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Rhov</span>     <span class="c">!INSIDE SURFACE TEMPERATURE OF EACH HEAT TRANSFER SURF.</span>
<a name="ln-2054"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">InOut</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RhoT</span>  <span class="c">!INSIDE SURFACE TEMPERATURE OF EACH HEAT TRANSFER SURF.</span>
<a name="ln-2055"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">In</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TD</span>     <span class="c">!OLD NODE TEMPERATURES OF EACH HEAT TRANSFER SURF IN CONDFD.</span>
<a name="ln-2056"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">InOut</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TDT</span>    <span class="c">!NEW NODE TEMPERATURES OF EACH HEAT TRANSFER SURF IN CONDFD.</span>
<a name="ln-2057"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">InOut</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RH</span>    <span class="c">!RELATIVE HUMIDITY.</span>
<a name="ln-2058"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">In</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">EnthOld</span>    <span class="c">! Old Nodal enthalpy</span>
<a name="ln-2059"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">InOut</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EnthNew</span>    <span class="c">! New Nodal enthalpy</span>
<a name="ln-2060"></a>
<a name="ln-2061"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2062"></a><span class="c">!  REAL(r64), PARAMETER :: NinetyNine=99.0d0</span>
<a name="ln-2063"></a>
<a name="ln-2064"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-2065"></a>          <span class="c">! na</span>
<a name="ln-2066"></a>
<a name="ln-2067"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-2068"></a>          <span class="c">! na</span>
<a name="ln-2069"></a>
<a name="ln-2070"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2071"></a>
<a name="ln-2072"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ConstrNum</span>
<a name="ln-2073"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MatLay</span>
<a name="ln-2074"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MatLay2</span>
<a name="ln-2075"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IndVarCol</span>
<a name="ln-2076"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DepVarCol</span>
<a name="ln-2077"></a>
<a name="ln-2078"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">kt1</span>
<a name="ln-2079"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">kt2</span>
<a name="ln-2080"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">kt1o</span>
<a name="ln-2081"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">kt2o</span>
<a name="ln-2082"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">kt11</span>
<a name="ln-2083"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">kt21</span>
<a name="ln-2084"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Cp1</span>
<a name="ln-2085"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Cp2</span>
<a name="ln-2086"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Cpo1</span>
<a name="ln-2087"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Cpo2</span>
<a name="ln-2088"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RhoS1</span>
<a name="ln-2089"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RhoS2</span>
<a name="ln-2090"></a>
<a name="ln-2091"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Delx1</span>
<a name="ln-2092"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Delx2</span>
<a name="ln-2093"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Enth1New</span>
<a name="ln-2094"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Enth2New</span>
<a name="ln-2095"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Enth1Old</span>
<a name="ln-2096"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Enth2Old</span>
<a name="ln-2097"></a>
<a name="ln-2098"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Rlayer</span>   <span class="c">!  resistance value of R Layer</span>
<a name="ln-2099"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Rlayer2</span>  <span class="c">!  resistance value of next layer to inside</span>
<a name="ln-2100"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QSSFlux</span>  <span class="c">!  Source/Sink flux value at a layer interface</span>
<a name="ln-2101"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">RlayerPresent</span>  <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2102"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">RLayer2Present</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2103"></a>
<a name="ln-2104"></a>  <span class="n">ConstrNum</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-2105"></a>
<a name="ln-2106"></a>  <span class="n">MatLay</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span>
<a name="ln-2107"></a>  <span class="n">MatLay2</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="n">Lay</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2108"></a>  <span class="c">!  Set Thermal Conductivity.  Can be constant, simple linear temp dep or multiple linear segment temp function dep.</span>
<a name="ln-2109"></a>
<a name="ln-2110"></a>  <span class="n">kt1o</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">Conductivity</span>
<a name="ln-2111"></a>  <span class="n">kt11</span><span class="o">=</span>  <span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">tk1</span>
<a name="ln-2112"></a>  <span class="n">kt1</span><span class="o">=</span> <span class="n">kt1o</span> <span class="o">+</span> <span class="n">kt11</span><span class="o">*</span><span class="p">((</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">+</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="mf">2.d0</span> <span class="o">-</span><span class="mi">2</span><span class="mf">0.d0</span><span class="p">)</span>
<a name="ln-2113"></a>
<a name="ln-2114"></a>  <span class="k">IF</span><span class="p">(</span> <span class="nb">SUM</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">TempCond</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Multiple Linear Segment Function</span>
<a name="ln-2115"></a>
<a name="ln-2116"></a>    <span class="n">IndVarCol</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c">! temperature</span>
<a name="ln-2117"></a>    <span class="n">DepVarCol</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c">! thermal conductivity</span>
<a name="ln-2118"></a>    <span class="n">kt1</span>       <span class="o">=</span> <span class="n">terpld</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">numTempCond</span><span class="p">,</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">TempCond</span><span class="p">,(</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">+</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="mf">2.d0</span><span class="p">,</span><span class="n">IndVarCol</span><span class="p">,</span><span class="n">DepVarCol</span><span class="p">)</span>
<a name="ln-2119"></a>
<a name="ln-2120"></a>  <span class="n">ENDIF</span>
<a name="ln-2121"></a>
<a name="ln-2122"></a>  <span class="n">RhoS1</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">Density</span>
<a name="ln-2123"></a>  <span class="n">Cpo1</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">SpecHeat</span>   <span class="c">! constant Cp from input file</span>
<a name="ln-2124"></a>  <span class="n">Delx1</span> <span class="o">=</span> <span class="n">ConstructFD</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">Delx</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span>
<a name="ln-2125"></a>  <span class="n">Rlayer</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">Resistance</span>
<a name="ln-2126"></a>
<a name="ln-2127"></a>  <span class="n">kt2o</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">MatLay2</span><span class="p">)%</span><span class="n">Conductivity</span>
<a name="ln-2128"></a>  <span class="n">kt21</span><span class="o">=</span>  <span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay2</span><span class="p">)%</span><span class="n">tk1</span>
<a name="ln-2129"></a>  <span class="n">kt2</span><span class="o">=</span> <span class="n">kt2o</span> <span class="o">+</span> <span class="n">kt21</span><span class="o">*</span><span class="p">((</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">+</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="mf">2.d0</span> <span class="o">-</span><span class="mi">2</span><span class="mf">0.d0</span><span class="p">)</span>
<a name="ln-2130"></a>
<a name="ln-2131"></a>  <span class="k">IF</span><span class="p">(</span> <span class="nb">SUM</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay2</span><span class="p">)%</span><span class="n">TempCond</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Multiple Linear Segment Function</span>
<a name="ln-2132"></a>
<a name="ln-2133"></a>    <span class="n">IndVarCol</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c">! temperature</span>
<a name="ln-2134"></a>    <span class="n">DepVarCol</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c">! thermal conductivity</span>
<a name="ln-2135"></a>    <span class="n">kt2</span> <span class="o">=</span><span class="n">terpld</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay2</span><span class="p">)%</span><span class="n">numTempCond</span><span class="p">,</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay2</span><span class="p">)%</span><span class="n">TempCond</span><span class="p">,(</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">+</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="mf">2.d0</span><span class="p">,</span><span class="n">IndVarCol</span><span class="p">,</span><span class="n">DepVarCol</span><span class="p">)</span>
<a name="ln-2136"></a>
<a name="ln-2137"></a>  <span class="n">ENDIF</span>
<a name="ln-2138"></a>
<a name="ln-2139"></a>  <span class="n">RhoS2</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">MatLay2</span><span class="p">)%</span><span class="n">Density</span>
<a name="ln-2140"></a>  <span class="n">Cpo2</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">MatLay2</span><span class="p">)%</span><span class="n">SpecHeat</span>
<a name="ln-2141"></a>  <span class="n">Delx2</span> <span class="o">=</span> <span class="n">ConstructFD</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">Delx</span><span class="p">(</span><span class="n">Lay</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2142"></a>  <span class="n">Rlayer2</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">MatLay2</span><span class="p">)%</span><span class="n">Resistance</span>
<a name="ln-2143"></a>  <span class="n">Cp1</span><span class="o">=</span><span class="n">Cpo1</span>   <span class="c">!  Will be reset if PCM</span>
<a name="ln-2144"></a>  <span class="n">Cp2</span><span class="o">=</span><span class="n">Cpo2</span>   <span class="c">!  will be reset if PCM</span>
<a name="ln-2145"></a>
<a name="ln-2146"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">HeatTransferAlgorithm</span> <span class="o">==</span>  <span class="n">HeatTransferModel_CondFD</span> <span class="p">)</span><span class="k">THEN</span>  <span class="c">!HT Algo issue</span>
<a name="ln-2147"></a>              <span class="c">!Calculate the Dry Heat Conduction Equation</span>
<a name="ln-2148"></a>    <span class="n">RLayerPresent</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2149"></a>    <span class="n">RLayer2Present</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2150"></a>
<a name="ln-2151"></a><span class="c">!     Source/Sink Flux Capability ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span>
<a name="ln-2152"></a>
<a name="ln-2153"></a>    <span class="n">QSSFlux</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2154"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">Area</span> <span class="o">&gt;</span><span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-2155"></a>        <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">SourceSinkPresent</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Lay</span> <span class="o">==</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">SourceAfterLayer</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2156"></a>
<a name="ln-2157"></a><span class="k">      </span><span class="n">QSSFlux</span> <span class="o">=</span> <span class="n">QRadSysSource</span><span class="p">(</span><span class="n">Surf</span><span class="p">)</span><span class="o">/</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">Area</span>   <span class="p">&amp;</span>
<a name="ln-2158"></a>                 <span class="o">+</span> <span class="n">QPVSysSource</span><span class="p">(</span><span class="n">Surf</span><span class="p">)</span><span class="o">/</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">Area</span>     <span class="c">! Includes QPV Source</span>
<a name="ln-2159"></a>
<a name="ln-2160"></a>    <span class="k">END IF</span>
<a name="ln-2161"></a>
<a name="ln-2162"></a><span class="c">!++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span>
<a name="ln-2163"></a>
<a name="ln-2164"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">ROnly</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">Material</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">Group</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>  <span class="n">RLayerPresent</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2165"></a>
<a name="ln-2166"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MatLay2</span><span class="p">)%</span><span class="n">ROnly</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">Material</span><span class="p">(</span><span class="n">MatLay2</span><span class="p">)%</span><span class="n">Group</span> <span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="n">Rlayer2Present</span> <span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2167"></a>
<a name="ln-2168"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="n">RLayerPresent</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">RLayer2Present</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2169"></a><span class="k">      </span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">Rlayer2</span><span class="o">*</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">Rlayer</span><span class="o">*</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">Rlayer</span> <span class="o">+</span> <span class="n">Rlayer2</span><span class="p">)</span>   <span class="c">! two adjacent R layers</span>
<a name="ln-2170"></a>
<a name="ln-2171"></a>    <span class="k">ELSE IF</span> <span class="p">(</span> <span class="n">RLayerPresent</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">RLayer2Present</span>  <span class="p">)</span> <span class="k">THEN</span>  <span class="c">! R-layer first</span>
<a name="ln-2172"></a>
<a name="ln-2173"></a>     <span class="c">!  Check for PCM second layer</span>
<a name="ln-2174"></a>     <span class="n">IndVarCol</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c">! temperature</span>
<a name="ln-2175"></a>     <span class="n">DepVarCol</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c">! thermal conductivity</span>
<a name="ln-2176"></a>
<a name="ln-2177"></a>      <span class="k">IF</span><span class="p">(</span> <span class="nb">Sum</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">TempEnth</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span>  <span class="p">&amp;</span>
<a name="ln-2178"></a>             <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="nb">Sum</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay2</span><span class="p">)%</span><span class="n">TempEnth</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>    <span class="c">!  phase change material Layer2,  Use TempEnth Data</span>
<a name="ln-2179"></a>
<a name="ln-2180"></a>        <span class="n">Enth2Old</span> <span class="o">=</span> <span class="n">terpld</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay2</span><span class="p">)%</span><span class="n">numTempEnth</span><span class="p">,</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay2</span><span class="p">)%</span><span class="n">TempEnth</span><span class="p">,</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">IndVarCol</span><span class="p">,</span><span class="n">DepVarCol</span><span class="p">)</span>
<a name="ln-2181"></a>        <span class="n">Enth2New</span> <span class="o">=</span> <span class="n">terpld</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay2</span><span class="p">)%</span><span class="n">numTempEnth</span><span class="p">,</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay2</span><span class="p">)%</span><span class="n">TempEnth</span><span class="p">,</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">IndVarCol</span><span class="p">,</span><span class="n">DepVarCol</span><span class="p">)</span>
<a name="ln-2182"></a>        <span class="n">EnthNew</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">Enth2New</span>  <span class="c">!  This node really doesn&#39;t have an enthalpy, this gives it a value</span>
<a name="ln-2183"></a>
<a name="ln-2184"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Enth2New</span><span class="o">-</span><span class="n">Enth2Old</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">smalldiff</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">-</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">))</span> <span class="o">&lt;=</span> <span class="n">smalldiff</span><span class="p">)</span>  <span class="k">THEN</span>
<a name="ln-2185"></a><span class="k">          </span><span class="n">Cp2</span> <span class="o">=</span> <span class="n">Cpo2</span>
<a name="ln-2186"></a>        <span class="k">ELSE</span>
<a name="ln-2187"></a><span class="k">          </span><span class="n">Cp2</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">Cpo2</span><span class="p">,(</span><span class="n">Enth2New</span> <span class="o">-</span><span class="n">Enth2Old</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">-</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>
<a name="ln-2188"></a>        <span class="k">END IF</span>
<a name="ln-2189"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-2190"></a>
<a name="ln-2191"></a>         <span class="c">! R layer first, then PCM or regular layer.</span>
<a name="ln-2192"></a>      <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">CondFDSchemeType</span><span class="p">)</span>
<a name="ln-2193"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CrankNicholsonSecondOrder</span><span class="p">)</span>
<a name="ln-2194"></a>
<a name="ln-2195"></a>          <span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span><span class="p">(</span> <span class="mf">2.d0</span><span class="o">*</span><span class="n">delt</span><span class="o">*</span><span class="n">Delx2</span><span class="o">*</span><span class="n">QSSFlux</span><span class="o">*</span><span class="n">Rlayer</span> <span class="o">-</span> <span class="n">delt</span><span class="o">*</span><span class="n">Delx2</span><span class="o">*</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">-</span> <span class="n">delt</span><span class="o">*</span><span class="n">kt2</span><span class="o">*</span><span class="n">Rlayer</span><span class="o">*</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-2196"></a>                <span class="n">Cp2</span><span class="o">*</span><span class="n">Delx2</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">RhoS2</span><span class="o">*</span><span class="n">Rlayer</span><span class="o">*</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span> <span class="n">delt</span><span class="o">*</span><span class="n">Delx2</span><span class="o">*</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">delt</span><span class="o">*</span><span class="n">kt2</span><span class="o">*</span><span class="n">Rlayer</span><span class="o">*</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">delt</span><span class="o">*</span><span class="n">Delx2</span><span class="o">*</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-2197"></a>                <span class="n">delt</span><span class="o">*</span><span class="n">kt2</span><span class="o">*</span><span class="n">Rlayer</span><span class="o">*</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">delt</span><span class="o">*</span><span class="n">Delx2</span> <span class="o">+</span> <span class="n">delt</span><span class="o">*</span><span class="n">kt2</span><span class="o">*</span><span class="n">Rlayer</span> <span class="o">+</span> <span class="n">Cp2</span><span class="o">*</span><span class="n">Delx2</span><span class="o">**</span><span class="mf">2.d0</span><span class="o">*</span><span class="n">RhoS2</span><span class="o">*</span><span class="n">Rlayer</span><span class="p">)</span>
<a name="ln-2198"></a>
<a name="ln-2199"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">FullyImplicitFirstOrder</span><span class="p">)</span>
<a name="ln-2200"></a>
<a name="ln-2201"></a>          <span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span><span class="p">(</span> <span class="mf">2.d0</span><span class="o">*</span><span class="n">delt</span><span class="o">*</span><span class="n">Delx2</span><span class="o">*</span><span class="n">QSSFlux</span><span class="o">*</span><span class="n">Rlayer</span> <span class="o">+</span> <span class="n">Cp2</span><span class="o">*</span><span class="n">Delx2</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">RhoS2</span><span class="o">*</span><span class="n">Rlayer</span><span class="o">*</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span> <span class="mf">2.d0</span><span class="o">*</span><span class="n">delt</span><span class="o">*</span><span class="n">Delx2</span><span class="o">*</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-2202"></a>                 <span class="mf">2.d0</span><span class="o">*</span><span class="n">delt</span><span class="o">*</span><span class="n">kt2</span><span class="o">*</span><span class="n">Rlayer</span><span class="o">*</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mf">2.d0</span><span class="o">*</span><span class="n">delt</span><span class="o">*</span><span class="n">Delx2</span> <span class="o">+</span> <span class="mf">2.d0</span><span class="o">*</span><span class="n">delt</span><span class="o">*</span><span class="n">kt2</span><span class="o">*</span><span class="n">Rlayer</span> <span class="o">+</span> <span class="n">Cp2</span><span class="o">*</span><span class="n">Delx2</span><span class="o">**</span><span class="mf">2.d0</span><span class="o">*</span><span class="n">RhoS2</span><span class="o">*</span><span class="n">Rlayer</span><span class="p">)</span>
<a name="ln-2203"></a>
<a name="ln-2204"></a>      <span class="k">END SELECT</span>
<a name="ln-2205"></a>
<a name="ln-2206"></a><span class="k">      IF</span> <span class="p">((</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">MaxSurfaceTempLimit</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2207"></a>          <span class="p">(</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">MinSurfaceTempLimit</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2208"></a><span class="k">        </span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="nb">Max</span><span class="p">(</span><span class="n">MinSurfaceTempLimit</span><span class="p">,</span><span class="nb">Min</span><span class="p">(</span><span class="n">MaxSurfaceTempLimit</span><span class="p">,</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>  <span class="c">!  +++++ Limit Check</span>
<a name="ln-2209"></a><span class="c">!        CALL CheckFDSurfaceTempLimits(I,TDT(I))</span>
<a name="ln-2210"></a>      <span class="n">ENDIF</span>
<a name="ln-2211"></a>
<a name="ln-2212"></a>    <span class="k">ELSE IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">RLayerPresent</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>  <span class="n">RLayer2Present</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! R-layer second</span>
<a name="ln-2213"></a>
<a name="ln-2214"></a>      <span class="c">!  check for PCM layer before R layer</span>
<a name="ln-2215"></a>     <span class="n">IndVarCol</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c">! temperature</span>
<a name="ln-2216"></a>     <span class="n">DepVarCol</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c">! thermal conductivity</span>
<a name="ln-2217"></a>
<a name="ln-2218"></a>      <span class="k">IF</span><span class="p">(</span> <span class="nb">SUM</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">TempEnth</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span>  <span class="p">&amp;</span>
<a name="ln-2219"></a>          <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="nb">SUM</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay2</span><span class="p">)%</span><span class="n">TempEnth</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>    <span class="c">!  phase change material Layer1,  Use TempEnth Data</span>
<a name="ln-2220"></a>
<a name="ln-2221"></a>        <span class="n">Enth1Old</span> <span class="o">=</span> <span class="n">terpld</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">numTempEnth</span><span class="p">,</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">TempEnth</span><span class="p">,</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">IndVarCol</span><span class="p">,</span><span class="n">DepVarCol</span><span class="p">)</span>
<a name="ln-2222"></a>        <span class="n">Enth1New</span> <span class="o">=</span> <span class="n">terpld</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">numTempEnth</span><span class="p">,</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">TempEnth</span><span class="p">,</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">IndVarCol</span><span class="p">,</span><span class="n">DepVarCol</span><span class="p">)</span>
<a name="ln-2223"></a>        <span class="n">EnthNew</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">Enth1New</span>    <span class="c">!  This node really doesn&#39;t have an enthalpy, this gives it a value</span>
<a name="ln-2224"></a>
<a name="ln-2225"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Enth1New</span><span class="o">-</span><span class="n">Enth1Old</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">smalldiff</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">-</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">))</span> <span class="o">&lt;=</span> <span class="n">smalldiff</span><span class="p">)</span>  <span class="k">THEN</span>
<a name="ln-2226"></a><span class="k">          </span><span class="n">Cp1</span><span class="o">=</span><span class="n">Cpo1</span>
<a name="ln-2227"></a>        <span class="k">ELSE</span>
<a name="ln-2228"></a><span class="k">          </span><span class="n">Cp1</span><span class="o">=</span><span class="nb">Max</span><span class="p">(</span><span class="n">Cpo1</span><span class="p">,(</span><span class="n">Enth1New</span> <span class="o">-</span><span class="n">Enth1Old</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">-</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>
<a name="ln-2229"></a>        <span class="k">END IF</span>
<a name="ln-2230"></a>
<a name="ln-2231"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-2232"></a>
<a name="ln-2233"></a>      <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">CondFDSchemeType</span><span class="p">)</span>
<a name="ln-2234"></a>
<a name="ln-2235"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CrankNicholsonSecondOrder</span><span class="p">)</span>
<a name="ln-2236"></a>          <span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="mf">2.d0</span><span class="o">*</span><span class="n">delt</span><span class="o">*</span><span class="n">Delx1</span><span class="o">*</span><span class="n">QSSFlux</span><span class="o">*</span><span class="n">Rlayer2</span> <span class="o">-</span> <span class="n">delt</span><span class="o">*</span><span class="n">Delx1</span><span class="o">*</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">-</span>  <span class="p">&amp;</span>
<a name="ln-2237"></a>                <span class="n">delt</span><span class="o">*</span><span class="n">kt1</span><span class="o">*</span><span class="n">Rlayer2</span><span class="o">*</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span> <span class="n">Cp1</span><span class="o">*</span><span class="n">Delx1</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">RhoS1</span><span class="o">*</span><span class="n">Rlayer2</span><span class="o">*</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span> <span class="n">delt</span><span class="o">*</span><span class="n">kt1</span><span class="o">*</span><span class="n">Rlayer2</span><span class="o">*</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-2238"></a>                <span class="n">delt</span><span class="o">*</span><span class="n">Delx1</span><span class="o">*</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">delt</span><span class="o">*</span><span class="n">kt1</span><span class="o">*</span><span class="n">Rlayer2</span><span class="o">*</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">delt</span><span class="o">*</span><span class="n">Delx1</span><span class="o">*</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-2239"></a>               <span class="p">(</span><span class="n">delt</span><span class="o">*</span><span class="n">Delx1</span> <span class="o">+</span> <span class="n">delt</span><span class="o">*</span><span class="n">kt1</span><span class="o">*</span><span class="n">Rlayer2</span> <span class="o">+</span> <span class="n">Cp1</span><span class="o">*</span><span class="n">Delx1</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">RhoS1</span><span class="o">*</span><span class="n">Rlayer2</span><span class="p">)</span>
<a name="ln-2240"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">FullyImplicitFirstOrder</span><span class="p">)</span>
<a name="ln-2241"></a>          <span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="mf">2.d0</span><span class="o">*</span><span class="n">delt</span><span class="o">*</span><span class="n">Delx1</span><span class="o">*</span><span class="n">QSSFlux</span><span class="o">*</span><span class="n">Rlayer2</span>  <span class="o">+</span> <span class="n">Cp1</span><span class="o">*</span><span class="n">Delx1</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">RhoS1</span><span class="o">*</span><span class="n">Rlayer2</span><span class="o">*</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span> <span class="mf">2.d0</span><span class="o">*</span><span class="n">delt</span><span class="o">*</span><span class="n">kt1</span><span class="o">*</span><span class="n">Rlayer2</span><span class="o">*</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2242"></a>            <span class="mf">2.d0</span><span class="o">*</span><span class="n">delt</span><span class="o">*</span><span class="n">Delx1</span><span class="o">*</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span> <span class="p">(</span><span class="mf">2.d0</span><span class="o">*</span><span class="n">delt</span><span class="o">*</span><span class="n">Delx1</span> <span class="o">+</span> <span class="mf">2.d0</span><span class="o">*</span><span class="n">delt</span><span class="o">*</span><span class="n">kt1</span><span class="o">*</span><span class="n">Rlayer2</span> <span class="o">+</span> <span class="n">Cp1</span><span class="o">*</span><span class="n">Delx1</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">RhoS1</span><span class="o">*</span><span class="n">Rlayer2</span><span class="p">)</span>
<a name="ln-2243"></a>
<a name="ln-2244"></a>      <span class="k">END SELECT</span>
<a name="ln-2245"></a>
<a name="ln-2246"></a><span class="k">      IF</span> <span class="p">((</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">MaxSurfaceTempLimit</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2247"></a>          <span class="p">(</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">MinSurfaceTempLimit</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2248"></a><span class="k">        </span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="nb">Max</span><span class="p">(</span><span class="n">MinSurfaceTempLimit</span><span class="p">,</span><span class="nb">Min</span><span class="p">(</span><span class="n">MaxSurfaceTempLimit</span><span class="p">,</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>  <span class="c">!  +++++ Limit Check</span>
<a name="ln-2249"></a><span class="c">!        CALL CheckFDSurfaceTempLimits(I,TDT(I))</span>
<a name="ln-2250"></a>      <span class="n">ENDIF</span>
<a name="ln-2251"></a>
<a name="ln-2252"></a>    <span class="k">ELSE</span>  <span class="c">!   Regular or Phase Change on both sides of interface</span>
<a name="ln-2253"></a>          <span class="c">!   Consider the various PCM material location cases</span>
<a name="ln-2254"></a>      <span class="n">Cp1</span> <span class="o">=</span> <span class="n">Cpo1</span>    <span class="c">!  Will be changed if PCM</span>
<a name="ln-2255"></a>      <span class="n">Cp2</span> <span class="o">=</span> <span class="n">Cpo2</span>    <span class="c">!  Will be changed if PCM</span>
<a name="ln-2256"></a>      <span class="n">IndVarCol</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c">! temperature</span>
<a name="ln-2257"></a>      <span class="n">DepVarCol</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c">! thermal conductivity</span>
<a name="ln-2258"></a>
<a name="ln-2259"></a>      <span class="k">IF</span><span class="p">(</span> <span class="nb">Sum</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">TempEnth</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span>  <span class="p">&amp;</span>
<a name="ln-2260"></a>          <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="nb">Sum</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay2</span><span class="p">)%</span><span class="n">TempEnth</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>    <span class="c">!  phase change material both layers,  Use TempEnth Data</span>
<a name="ln-2261"></a>
<a name="ln-2262"></a>        <span class="n">Enth1Old</span> <span class="o">=</span> <span class="n">terpld</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">numTempEnth</span><span class="p">,</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">TempEnth</span><span class="p">,</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">IndVarCol</span><span class="p">,</span><span class="n">DepVarCol</span><span class="p">)</span>
<a name="ln-2263"></a>        <span class="n">Enth2Old</span> <span class="o">=</span> <span class="n">terpld</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay2</span><span class="p">)%</span><span class="n">numTempEnth</span><span class="p">,</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay2</span><span class="p">)%</span><span class="n">TempEnth</span><span class="p">,</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">IndVarCol</span><span class="p">,</span><span class="n">DepVarCol</span><span class="p">)</span>
<a name="ln-2264"></a>        <span class="n">Enth1New</span> <span class="o">=</span> <span class="n">terpld</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">numTempEnth</span><span class="p">,</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">TempEnth</span><span class="p">,</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">IndVarCol</span><span class="p">,</span><span class="n">DepVarCol</span><span class="p">)</span>
<a name="ln-2265"></a>        <span class="n">Enth2New</span> <span class="o">=</span> <span class="n">terpld</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay2</span><span class="p">)%</span><span class="n">numTempEnth</span><span class="p">,</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay2</span><span class="p">)%</span><span class="n">TempEnth</span><span class="p">,</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">IndVarCol</span><span class="p">,</span><span class="n">DepVarCol</span><span class="p">)</span>
<a name="ln-2266"></a>
<a name="ln-2267"></a>        <span class="n">EnthNew</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">Enth1New</span>    <span class="c">!  This node really doesn&#39;t have an enthalpy, this gives it a value</span>
<a name="ln-2268"></a>
<a name="ln-2269"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Enth1New</span><span class="o">-</span><span class="n">Enth1Old</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">smalldiff</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">-</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">))</span> <span class="o">&lt;=</span> <span class="n">smalldiff</span><span class="p">)</span>  <span class="k">THEN</span>
<a name="ln-2270"></a><span class="k">          </span><span class="n">Cp1</span> <span class="o">=</span> <span class="n">Cpo1</span>
<a name="ln-2271"></a>        <span class="k">ELSE</span>
<a name="ln-2272"></a><span class="k">          </span><span class="n">Cp1</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">Cpo1</span><span class="p">,(</span><span class="n">Enth1New</span> <span class="o">-</span><span class="n">Enth1Old</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">-</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>
<a name="ln-2273"></a>        <span class="k">END IF</span>
<a name="ln-2274"></a>
<a name="ln-2275"></a><span class="k">        IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Enth2New</span><span class="o">-</span><span class="n">Enth2Old</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">smalldiff</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">-</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">))</span> <span class="o">&lt;=</span> <span class="n">smalldiff</span><span class="p">)</span>  <span class="k">THEN</span>
<a name="ln-2276"></a><span class="k">          </span><span class="n">Cp2</span> <span class="o">=</span> <span class="n">Cpo2</span>
<a name="ln-2277"></a>        <span class="k">ELSE</span>
<a name="ln-2278"></a><span class="k">          </span><span class="n">Cp2</span> <span class="o">=</span> <span class="nb">Max</span><span class="p">(</span><span class="n">Cpo2</span><span class="p">,(</span><span class="n">Enth2New</span> <span class="o">-</span><span class="n">Enth2Old</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">-</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>
<a name="ln-2279"></a>        <span class="k">END IF</span>
<a name="ln-2280"></a>
<a name="ln-2281"></a><span class="k">      ELSE IF</span><span class="p">(</span> <span class="nb">SUM</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">TempEnth</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span>  <span class="p">&amp;</span>
<a name="ln-2282"></a>                <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="nb">SUM</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay2</span><span class="p">)%</span><span class="n">TempEnth</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>    <span class="c">!  phase change material Layer1,  Use TempEnth Data</span>
<a name="ln-2283"></a>
<a name="ln-2284"></a>        <span class="n">Enth1Old</span> <span class="o">=</span> <span class="n">terpld</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">numTempEnth</span><span class="p">,</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">TempEnth</span><span class="p">,</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">IndVarCol</span><span class="p">,</span><span class="n">DepVarCol</span><span class="p">)</span>
<a name="ln-2285"></a>        <span class="n">Enth1New</span> <span class="o">=</span> <span class="n">terpld</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">numTempEnth</span><span class="p">,</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">TempEnth</span><span class="p">,</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">IndVarCol</span><span class="p">,</span><span class="n">DepVarCol</span><span class="p">)</span>
<a name="ln-2286"></a>        <span class="n">EnthNew</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">Enth1New</span>    <span class="c">!  This node really doesn&#39;t have an enthalpy, this gives it a value</span>
<a name="ln-2287"></a>
<a name="ln-2288"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Enth1New</span><span class="o">-</span><span class="n">Enth1Old</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">smalldiff</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">-</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">))</span> <span class="o">&lt;=</span> <span class="n">smalldiff</span><span class="p">)</span>  <span class="k">THEN</span>
<a name="ln-2289"></a><span class="k">          </span><span class="n">Cp1</span> <span class="o">=</span> <span class="n">Cpo1</span>
<a name="ln-2290"></a>        <span class="k">ELSE</span>
<a name="ln-2291"></a><span class="k">          </span><span class="n">Cp1</span> <span class="o">=</span> <span class="nb">Max</span><span class="p">(</span><span class="n">Cpo1</span><span class="p">,(</span><span class="n">Enth1New</span> <span class="o">-</span><span class="n">Enth1Old</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">-</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>
<a name="ln-2292"></a>        <span class="k">END IF</span>
<a name="ln-2293"></a>
<a name="ln-2294"></a><span class="k">        </span><span class="n">Cp2</span> <span class="o">=</span> <span class="n">Cpo2</span>
<a name="ln-2295"></a>
<a name="ln-2296"></a>      <span class="k">ELSE IF</span><span class="p">(</span> <span class="nb">SUM</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">TempEnth</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span>  <span class="p">&amp;</span>
<a name="ln-2297"></a>              <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="nb">SUM</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay2</span><span class="p">)%</span><span class="n">TempEnth</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>    <span class="c">!  phase change material Layer2,  Use TempEnth Data</span>
<a name="ln-2298"></a>
<a name="ln-2299"></a>        <span class="n">Enth2Old</span> <span class="o">=</span> <span class="n">terpld</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay2</span><span class="p">)%</span><span class="n">numTempEnth</span><span class="p">,</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay2</span><span class="p">)%</span><span class="n">TempEnth</span><span class="p">,</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">IndVarCol</span><span class="p">,</span><span class="n">DepVarCol</span><span class="p">)</span>
<a name="ln-2300"></a>        <span class="n">Enth2New</span> <span class="o">=</span> <span class="n">terpld</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay2</span><span class="p">)%</span><span class="n">numTempEnth</span><span class="p">,</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay2</span><span class="p">)%</span><span class="n">TempEnth</span><span class="p">,</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">IndVarCol</span><span class="p">,</span><span class="n">DepVarCol</span><span class="p">)</span>
<a name="ln-2301"></a>        <span class="n">EnthNew</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">Enth2New</span>  <span class="c">!  This node really doesn&#39;t have an enthalpy, this gives it a value</span>
<a name="ln-2302"></a>
<a name="ln-2303"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Enth2New</span><span class="o">-</span><span class="n">Enth2Old</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">smalldiff</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">-</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">))</span> <span class="o">&lt;=</span> <span class="n">smalldiff</span><span class="p">)</span>  <span class="k">THEN</span>
<a name="ln-2304"></a><span class="k">          </span><span class="n">Cp2</span> <span class="o">=</span> <span class="n">Cpo2</span>
<a name="ln-2305"></a>        <span class="k">ELSE</span>
<a name="ln-2306"></a><span class="k">          </span><span class="n">Cp2</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">Cpo2</span><span class="p">,(</span><span class="n">Enth2New</span> <span class="o">-</span><span class="n">Enth2Old</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">-</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>
<a name="ln-2307"></a>        <span class="k">END IF</span>
<a name="ln-2308"></a>
<a name="ln-2309"></a><span class="k">        </span><span class="n">Cp1</span> <span class="o">=</span> <span class="n">Cpo1</span>
<a name="ln-2310"></a>
<a name="ln-2311"></a>      <span class="k">END If</span>  <span class="c">! Phase change material check</span>
<a name="ln-2312"></a>
<a name="ln-2313"></a>      <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">CondFDSchemeType</span><span class="p">)</span>
<a name="ln-2314"></a>
<a name="ln-2315"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CrankNicholsonSecondOrder</span><span class="p">)</span>
<a name="ln-2316"></a>        <span class="c">!     Regular Internal Interface Node with Source/sink using Adams Moulton second order</span>
<a name="ln-2317"></a>          <span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2.d0</span><span class="o">*</span><span class="n">delt</span><span class="o">*</span><span class="n">Delx1</span><span class="o">*</span><span class="n">Delx2</span><span class="o">*</span><span class="n">QSSFlux</span> <span class="o">-</span> <span class="n">delt</span><span class="o">*</span><span class="n">Delx2</span><span class="o">*</span><span class="n">kt1</span><span class="o">*</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">-</span> <span class="n">delt</span><span class="o">*</span><span class="n">Delx1</span><span class="o">*</span><span class="n">kt2</span><span class="o">*</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-2318"></a>                 <span class="n">Cp1</span><span class="o">*</span><span class="n">Delx1</span><span class="o">**</span><span class="mf">2.d0</span><span class="o">*</span><span class="n">Delx2</span><span class="o">*</span><span class="n">RhoS1</span><span class="o">*</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span> <span class="n">Cp2</span><span class="o">*</span><span class="n">Delx1</span><span class="o">*</span><span class="n">Delx2</span><span class="o">**</span><span class="mf">2.d0</span><span class="o">*</span><span class="n">RhoS2</span><span class="o">*</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span> <span class="n">delt</span><span class="o">*</span><span class="n">Delx2</span><span class="o">*</span><span class="n">kt1</span><span class="o">*</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-2319"></a>                 <span class="n">delt</span><span class="o">*</span><span class="n">Delx1</span><span class="o">*</span><span class="n">kt2</span><span class="o">*</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">delt</span><span class="o">*</span><span class="n">Delx2</span><span class="o">*</span><span class="n">kt1</span><span class="o">*</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">delt</span><span class="o">*</span><span class="n">Delx1</span><span class="o">*</span><span class="n">kt2</span><span class="o">*</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span>   <span class="p">&amp;</span>
<a name="ln-2320"></a>                 <span class="p">(</span><span class="n">delt</span><span class="o">*</span><span class="n">Delx2</span><span class="o">*</span><span class="n">kt1</span> <span class="o">+</span> <span class="n">delt</span><span class="o">*</span><span class="n">Delx1</span><span class="o">*</span><span class="n">kt2</span> <span class="o">+</span> <span class="n">Cp1</span><span class="o">*</span><span class="n">Delx1</span><span class="o">**</span><span class="mf">2.d0</span><span class="o">*</span><span class="n">Delx2</span><span class="o">*</span><span class="n">RhoS1</span> <span class="o">+</span> <span class="n">Cp2</span><span class="o">*</span><span class="n">Delx1</span><span class="o">*</span><span class="n">Delx2</span><span class="o">**</span><span class="mf">2.d0</span><span class="o">*</span><span class="n">RhoS2</span><span class="p">)</span>
<a name="ln-2321"></a>
<a name="ln-2322"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">FullyImplicitFirstOrder</span><span class="p">)</span>
<a name="ln-2323"></a>        <span class="c">! first order adams moulton</span>
<a name="ln-2324"></a>          <span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2.d0</span><span class="o">*</span><span class="n">delt</span><span class="o">*</span><span class="n">Delx1</span><span class="o">*</span><span class="n">Delx2</span><span class="o">*</span><span class="n">QSSFlux</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2325"></a>                 <span class="n">Cp1</span><span class="o">*</span><span class="n">Delx1</span><span class="o">**</span><span class="mf">2.d0</span><span class="o">*</span><span class="n">Delx2</span><span class="o">*</span><span class="n">RhoS1</span><span class="o">*</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span> <span class="n">Cp2</span><span class="o">*</span><span class="n">Delx1</span><span class="o">*</span><span class="n">Delx2</span><span class="o">**</span><span class="mf">2.d0</span><span class="o">*</span><span class="n">RhoS2</span><span class="o">*</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-2326"></a>                 <span class="mf">2.d0</span><span class="o">*</span><span class="n">delt</span><span class="o">*</span><span class="n">Delx2</span><span class="o">*</span><span class="n">kt1</span><span class="o">*</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mf">2.d0</span><span class="o">*</span><span class="n">delt</span><span class="o">*</span><span class="n">Delx1</span><span class="o">*</span><span class="n">kt2</span><span class="o">*</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span>   <span class="p">&amp;</span>
<a name="ln-2327"></a>                 <span class="p">(</span><span class="mf">2.d0</span><span class="o">*</span><span class="n">delt</span><span class="o">*</span><span class="n">Delx2</span><span class="o">*</span><span class="n">kt1</span> <span class="o">+</span> <span class="mf">2.d0</span><span class="o">*</span><span class="n">delt</span><span class="o">*</span><span class="n">Delx1</span><span class="o">*</span><span class="n">kt2</span> <span class="o">+</span> <span class="n">Cp1</span><span class="o">*</span><span class="n">Delx1</span><span class="o">**</span><span class="mf">2.d0</span><span class="o">*</span><span class="n">Delx2</span><span class="o">*</span><span class="n">RhoS1</span> <span class="o">+</span> <span class="n">Cp2</span><span class="o">*</span><span class="n">Delx1</span><span class="o">*</span><span class="n">Delx2</span><span class="o">**</span><span class="mf">2.d0</span><span class="o">*</span><span class="n">RhoS2</span><span class="p">)</span>
<a name="ln-2328"></a>
<a name="ln-2329"></a>      <span class="k">END SELECT</span>
<a name="ln-2330"></a>
<a name="ln-2331"></a><span class="k">      IF</span> <span class="p">((</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">MaxSurfaceTempLimit</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2332"></a>          <span class="p">(</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">MinSurfaceTempLimit</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2333"></a><span class="k">        </span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="nb">Max</span><span class="p">(</span><span class="n">MinSurfaceTempLimit</span><span class="p">,</span><span class="nb">Min</span><span class="p">(</span><span class="n">MaxSurfaceTempLimit</span><span class="p">,</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>  <span class="c">!  +++++ Limit Check</span>
<a name="ln-2334"></a><span class="c">!        CALL CheckFDSurfaceTempLimits(I,TDT(I))</span>
<a name="ln-2335"></a>      <span class="n">ENDIF</span>
<a name="ln-2336"></a>
<a name="ln-2337"></a>
<a name="ln-2338"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">SourceSinkPresent</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Lay</span> <span class="o">==</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">SourceAfterLayer</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-2339"></a><span class="k">        </span><span class="n">TcondFDSourceNode</span><span class="p">(</span><span class="n">Surf</span><span class="p">)</span><span class="o">=</span> <span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="c">! transfer node temp to Radiant System</span>
<a name="ln-2340"></a>        <span class="n">TempSource</span><span class="p">(</span><span class="n">Surf</span><span class="p">)</span> <span class="o">=</span> <span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>  <span class="c">!  Transfer node temp to DataHeatBalSurface  module.</span>
<a name="ln-2341"></a>
<a name="ln-2342"></a>      <span class="n">ENDIF</span>
<a name="ln-2343"></a><span class="c">!+++++++++++++++++++++++++++++++</span>
<a name="ln-2344"></a>    <span class="k">END IF</span>   <span class="c">!  end of R-layer and Regular check</span>
<a name="ln-2345"></a>
<a name="ln-2346"></a>  <span class="k">END IF</span>  <span class="c">!End of the CondFD if block</span>
<a name="ln-2347"></a>
<a name="ln-2348"></a>
<a name="ln-2349"></a><span class="k">RETURN</span>
<a name="ln-2350"></a>
<a name="ln-2351"></a><span class="k">END SUBROUTINE </span><span class="n">IntInterfaceNodeEqns</span>
<a name="ln-2352"></a>
<a name="ln-2353"></a>
<a name="ln-2354"></a><span class="k">SUBROUTINE </span><span class="n">InteriorBCEqns</span><span class="p">(</span><span class="n">Delt</span><span class="p">,</span><span class="n">I</span><span class="p">,</span><span class="n">Lay</span><span class="p">,</span><span class="n">Surf</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">TT</span><span class="p">,</span><span class="n">Rhov</span><span class="p">,</span><span class="n">RhoT</span><span class="p">,</span><span class="n">RH</span><span class="p">,</span><span class="n">TD</span><span class="p">,</span><span class="n">TDT</span><span class="p">,</span><span class="n">EnthOld</span><span class="p">,</span><span class="n">EnthNew</span><span class="p">,</span><span class="n">TDReport</span><span class="p">)</span>
<a name="ln-2355"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2356"></a>          <span class="c">!       AUTHOR         Richard Liesen</span>
<a name="ln-2357"></a>          <span class="c">!       DATE WRITTEN   November, 2003</span>
<a name="ln-2358"></a>          <span class="c">!       MODIFIED       B. Griffith, P. Tabares, May 2011, add first order fully implicit, bug fixes, cleanup</span>
<a name="ln-2359"></a>          <span class="c">!                      November 2011 P. Tabares fixed problems with adiabatic walls/massless walls</span>
<a name="ln-2360"></a>          <span class="c">!                      November 2011 P. Tabares fixed problems PCM stability problems</span>
<a name="ln-2361"></a>          <span class="c">!       RE-ENGINEERED  C. O. Pedersen 2006</span>
<a name="ln-2362"></a>
<a name="ln-2363"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2364"></a>          <span class="c">! Calculate the heat transfer at the node on the surfaces inside face (facing zone)</span>
<a name="ln-2365"></a>
<a name="ln-2366"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2367"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-2368"></a>
<a name="ln-2369"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2370"></a>          <span class="c">! na</span>
<a name="ln-2371"></a>
<a name="ln-2372"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2373"></a>  <span class="k">USE </span><span class="n">DataHeatBalFanSys</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">Mat</span><span class="p">,</span> <span class="n">ZoneAirHumRat</span><span class="p">,</span> <span class="n">QHTRadSysSurf</span><span class="p">,</span> <span class="n">QHWBaseboardSurf</span><span class="p">,</span> <span class="n">QSteamBaseboardSurf</span><span class="p">,</span> <span class="n">QElecBaseboardSurf</span>
<a name="ln-2374"></a>  <span class="k">USE </span><span class="n">DataSurfaces</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">HeatTransferModel_CondFD</span>
<a name="ln-2375"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2376"></a>
<a name="ln-2377"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2378"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Delt</span>  <span class="c">! Time Increment</span>
<a name="ln-2379"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">I</span>     <span class="c">! Node Index</span>
<a name="ln-2380"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Lay</span>   <span class="c">! Layer Number for Construction</span>
<a name="ln-2381"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Surf</span>  <span class="c">! Surface number</span>
<a name="ln-2382"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">In</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">T</span>     <span class="c">!INSIDE SURFACE TEMPERATURE OF EACH HEAT TRANSFER SURF (Old).</span>
<a name="ln-2383"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">InOut</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TT</span>    <span class="c">!INSIDE SURFACE TEMPERATURE OF EACH HEAT TRANSFER SURF (New).</span>
<a name="ln-2384"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">In</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Rhov</span>     <span class="c">!INSIDE SURFACE TEMPERATURE OF EACH HEAT TRANSFER SURF.</span>
<a name="ln-2385"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">InOut</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RhoT</span>  <span class="c">!INSIDE SURFACE TEMPERATURE OF EACH HEAT TRANSFER SURF.</span>
<a name="ln-2386"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">In</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TD</span>     <span class="c">!INSIDE SURFACE TEMPERATURE OF EACH HEAT TRANSFER SURF.</span>
<a name="ln-2387"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">InOut</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TDT</span>    <span class="c">!INSIDE SURFACE TEMPERATURE OF EACH HEAT TRANSFER SURF.</span>
<a name="ln-2388"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">InOut</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RH</span>    <span class="c">!INSIDE SURFACE TEMPERATURE OF EACH HEAT TRANSFER SURF.</span>
<a name="ln-2389"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">InOut</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EnthOld</span>    <span class="c">! Old Nodal enthalpy</span>
<a name="ln-2390"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">InOut</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EnthNew</span>    <span class="c">! New Nodal enthalpy</span>
<a name="ln-2391"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">InOut</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TDreport</span>    <span class="c">! Temperature value from previous HeatSurfaceHeatManager titeration&#39;s value</span>
<a name="ln-2392"></a>
<a name="ln-2393"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2394"></a>          <span class="c">! na</span>
<a name="ln-2395"></a>
<a name="ln-2396"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-2397"></a>          <span class="c">! na</span>
<a name="ln-2398"></a>
<a name="ln-2399"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-2400"></a>          <span class="c">! na</span>
<a name="ln-2401"></a>
<a name="ln-2402"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2403"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NetLWRadToSurfFD</span> <span class="c">!Net interior long wavelength radiation to surface from other surfaces</span>
<a name="ln-2404"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QRadSWInFD</span>    <span class="c">!Short wave radiation absorbed on inside of opaque surface</span>
<a name="ln-2405"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QHtRadSysSurfFD</span>  <span class="c">! Current radiant heat flux at a surface due to the presence of high temperature radiant heaters</span>
<a name="ln-2406"></a>  <span class="kt">Real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QHWBaseboardSurfFD</span>  <span class="c">! Current radiant heat flux at a surface due to the presence of hot water baseboard heaters</span>
<a name="ln-2407"></a>  <span class="kt">Real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QSteamBaseboardSurfFD</span>  <span class="c">! Current radiant heat flux at a surface due to the presence of steam baseboard heaters</span>
<a name="ln-2408"></a>  <span class="kt">Real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QElecBaseboardSurfFD</span>  <span class="c">! Current radiant heat flux at a surface due to the presence of electric baseboard heaters</span>
<a name="ln-2409"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QRadThermInFD</span> <span class="c">!Thermal radiation absorbed on inside surfaces</span>
<a name="ln-2410"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Delx</span>
<a name="ln-2411"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">IterDampConst</span> <span class="o">=</span> <span class="mf">5.0d0</span>  <span class="c">! Damping constant for inside surface temperature iterations. Only used for massless (R-value only) Walls</span>
<a name="ln-2412"></a>
<a name="ln-2413"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">ConstrNum</span>
<a name="ln-2414"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">MatLay</span>
<a name="ln-2415"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">IndVarCol</span>
<a name="ln-2416"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">DepVarCol</span>
<a name="ln-2417"></a>
<a name="ln-2418"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">kto</span>
<a name="ln-2419"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">kt1</span>
<a name="ln-2420"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">kt</span>
<a name="ln-2421"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Cp</span>
<a name="ln-2422"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Cpo</span>
<a name="ln-2423"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">RhoS</span>
<a name="ln-2424"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Tia</span>
<a name="ln-2425"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Rhovi</span>
<a name="ln-2426"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">hmassi</span>
<a name="ln-2427"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">hconvi</span>
<a name="ln-2428"></a>
<a name="ln-2429"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Rlayer</span>
<a name="ln-2430"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">SigmaRLoc</span>
<a name="ln-2431"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">SigmaCLoc</span>
<a name="ln-2432"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">QNetSurfInside</span>
<a name="ln-2433"></a>
<a name="ln-2434"></a>
<a name="ln-2435"></a>  <span class="n">ConstrNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-2436"></a>  <span class="n">SigmaRLoc</span> <span class="o">=</span> <span class="n">SigmaR</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)</span>
<a name="ln-2437"></a>  <span class="n">SigmaCLoc</span> <span class="o">=</span> <span class="n">SigmaC</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)</span>
<a name="ln-2438"></a>
<a name="ln-2439"></a>  <span class="c">!Set the internal conditions to local variables</span>
<a name="ln-2440"></a>  <span class="n">NetLWRadToSurfFD</span>      <span class="o">=</span> <span class="n">NetLWRadToSurf</span><span class="p">(</span><span class="n">surf</span><span class="p">)</span>
<a name="ln-2441"></a>  <span class="n">QRadSWInFD</span>            <span class="o">=</span> <span class="n">QRadSWInAbs</span><span class="p">(</span><span class="n">surf</span><span class="p">)</span>
<a name="ln-2442"></a>  <span class="n">QHtRadSysSurfFD</span>       <span class="o">=</span> <span class="n">QHtRadSysSurf</span><span class="p">(</span><span class="n">surf</span><span class="p">)</span>
<a name="ln-2443"></a>  <span class="n">QHWBaseboardSurfFD</span>    <span class="o">=</span> <span class="n">QHWBaseboardSurf</span><span class="p">(</span><span class="n">surf</span><span class="p">)</span>
<a name="ln-2444"></a>  <span class="n">QSteamBaseboardSurfFD</span> <span class="o">=</span> <span class="n">QSteamBaseboardSurf</span><span class="p">(</span><span class="n">surf</span><span class="p">)</span>
<a name="ln-2445"></a>  <span class="n">QElecBaseboardSurfFD</span>  <span class="o">=</span> <span class="n">QElecBaseboardSurf</span><span class="p">(</span><span class="n">surf</span><span class="p">)</span>
<a name="ln-2446"></a>  <span class="n">QRadThermInFD</span>         <span class="o">=</span> <span class="n">QRadThermInAbs</span><span class="p">(</span><span class="n">Surf</span><span class="p">)</span>
<a name="ln-2447"></a>
<a name="ln-2448"></a>  <span class="c">!Boundary Conditions from Simulation for Interior</span>
<a name="ln-2449"></a>  <span class="n">hconvi</span> <span class="o">=</span> <span class="n">HConvInFD</span><span class="p">(</span><span class="n">surf</span><span class="p">)</span>
<a name="ln-2450"></a>  <span class="n">hmassi</span> <span class="o">=</span> <span class="n">HMassConvInFD</span><span class="p">(</span><span class="n">surf</span><span class="p">)</span>
<a name="ln-2451"></a>
<a name="ln-2452"></a>  <span class="n">Tia</span>    <span class="o">=</span> <span class="n">Mat</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)</span>
<a name="ln-2453"></a>  <span class="n">rhovi</span>  <span class="o">=</span> <span class="n">RhoVaporAirIn</span><span class="p">(</span><span class="n">surf</span><span class="p">)</span>
<a name="ln-2454"></a>
<a name="ln-2455"></a><span class="c">!++++++++++++++++++++++++++++++++++++++++++++++++++++++</span>
<a name="ln-2456"></a>   <span class="c">!    Do all the nodes in the surface   Else will switch to SigmaR,SigmaC</span>
<a name="ln-2457"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">HeatTransferAlgorithm</span> <span class="o">==</span> <span class="n">HeatTransferModel_CondFD</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2458"></a>
<a name="ln-2459"></a><span class="k">    </span><span class="n">MatLay</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span>
<a name="ln-2460"></a>     <span class="c">!  Set Thermal Conductivity.  Can be constant, simple linear temp dep or multiple linear segment temp function dep.</span>
<a name="ln-2461"></a>    <span class="n">kto</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">Conductivity</span>   <span class="c">!  20C base conductivity</span>
<a name="ln-2462"></a>    <span class="n">kt1</span> <span class="o">=</span> <span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">tk1</span>  <span class="c">!  linear coefficient (normally zero)</span>
<a name="ln-2463"></a>    <span class="n">kt</span>  <span class="o">=</span> <span class="n">kto</span> <span class="o">+</span> <span class="n">kt1</span><span class="o">*</span><span class="p">((</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">+</span><span class="n">TDT</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="mf">2.d0</span> <span class="o">-</span> <span class="mi">2</span><span class="mf">0.d0</span><span class="p">)</span>
<a name="ln-2464"></a>
<a name="ln-2465"></a>
<a name="ln-2466"></a>    <span class="k">IF</span><span class="p">(</span> <span class="nb">SUM</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">TempCond</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Multiple Linear Segment Function</span>
<a name="ln-2467"></a>
<a name="ln-2468"></a>      <span class="n">DepVarCol</span><span class="o">=</span> <span class="mi">2</span>  <span class="c">! thermal conductivity</span>
<a name="ln-2469"></a>      <span class="n">IndVarCol</span><span class="o">=</span><span class="mi">1</span>  <span class="c">!temperature</span>
<a name="ln-2470"></a>          <span class="c">!  Use average  of surface and first node temp for determining k</span>
<a name="ln-2471"></a>      <span class="n">kt</span>  <span class="o">=</span> <span class="n">terpld</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">numTempCond</span><span class="p">,</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">TempCond</span><span class="p">,(</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">+</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="mf">2.0d0</span> <span class="p">,</span><span class="n">IndVarCol</span><span class="p">,</span><span class="n">DepVarCol</span><span class="p">)</span>
<a name="ln-2472"></a>
<a name="ln-2473"></a>    <span class="n">ENDIF</span>
<a name="ln-2474"></a>
<a name="ln-2475"></a>
<a name="ln-2476"></a>    <span class="n">RhoS</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">Density</span>
<a name="ln-2477"></a>    <span class="n">Cpo</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">SpecHeat</span>
<a name="ln-2478"></a>    <span class="n">Cp</span>  <span class="o">=</span> <span class="n">Cpo</span>  <span class="c">!  Will be changed if PCM</span>
<a name="ln-2479"></a>    <span class="n">Delx</span> <span class="o">=</span> <span class="n">ConstructFD</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">Delx</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span>
<a name="ln-2480"></a>
<a name="ln-2481"></a>    <span class="c">!Calculate the Dry Heat Conduction Equation</span>
<a name="ln-2482"></a>
<a name="ln-2483"></a>    <span class="n">Rlayer</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">Resistance</span>
<a name="ln-2484"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">ROnly</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">Material</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">Group</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="k">THEN</span>  <span class="c">! R Layer or Air Layer</span>
<a name="ln-2485"></a>            <span class="c">!  Use algebraic equation for TDT based on R</span>
<a name="ln-2486"></a>
<a name="ln-2487"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">i</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!this is for an adiabatic partition</span>
<a name="ln-2488"></a>
<a name="ln-2489"></a>        <span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">NetLWRadToSurfFD</span><span class="o">*</span><span class="n">Rlayer</span><span class="o">+</span><span class="n">QHtRadSysSurfFD</span><span class="o">*</span><span class="n">Rlayer</span> <span class="o">+</span> <span class="n">QHWBaseboardSurfFD</span><span class="o">*</span><span class="n">Rlayer</span> <span class="o">+</span> <span class="n">QSteamBaseboardSurfFD</span><span class="o">*</span><span class="n">Rlayer</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2490"></a>                    <span class="n">QElecBaseboardSurfFD</span><span class="o">*</span><span class="n">Rlayer</span> <span class="o">+</span>  <span class="n">QRadSWInFD</span><span class="o">*</span><span class="n">Rlayer</span> <span class="o">+</span> <span class="n">QRadThermInFD</span><span class="o">*</span><span class="n">Rlayer</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-2491"></a>                       <span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">hconvi</span><span class="o">*</span><span class="n">Rlayer</span><span class="o">*</span><span class="n">Tia</span><span class="o">+</span><span class="n">TDreport</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">*</span><span class="n">IterDampConst</span><span class="o">*</span><span class="n">Rlayer</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0d0</span> <span class="o">+</span> <span class="n">hconvi</span><span class="o">*</span><span class="n">Rlayer</span><span class="o">+</span><span class="n">IterDampConst</span><span class="o">*</span><span class="n">Rlayer</span><span class="p">)</span>
<a name="ln-2492"></a>
<a name="ln-2493"></a>
<a name="ln-2494"></a>      <span class="k">ELSE</span> <span class="c">! regular wall</span>
<a name="ln-2495"></a>        <span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">NetLWRadToSurfFD</span><span class="o">*</span><span class="n">Rlayer</span><span class="o">+</span><span class="n">QHtRadSysSurfFD</span><span class="o">*</span><span class="n">Rlayer</span> <span class="o">+</span> <span class="n">QHWBaseboardSurfFD</span><span class="o">*</span><span class="n">Rlayer</span> <span class="o">+</span> <span class="n">QSteamBaseboardSurfFD</span><span class="o">*</span><span class="n">Rlayer</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2496"></a>                    <span class="n">QElecBaseboardSurfFD</span><span class="o">*</span><span class="n">Rlayer</span> <span class="o">+</span> <span class="n">QRadSWInFD</span><span class="o">*</span><span class="n">Rlayer</span> <span class="o">+</span> <span class="n">QRadThermInFD</span><span class="o">*</span><span class="n">Rlayer</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-2497"></a>                       <span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">hconvi</span><span class="o">*</span><span class="n">Rlayer</span><span class="o">*</span><span class="n">Tia</span><span class="o">+</span><span class="n">TDreport</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">*</span><span class="n">IterDampConst</span><span class="o">*</span><span class="n">Rlayer</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0d0</span> <span class="o">+</span> <span class="n">hconvi</span><span class="o">*</span><span class="n">Rlayer</span><span class="o">+</span><span class="n">IterDampConst</span><span class="o">*</span><span class="n">Rlayer</span><span class="p">)</span>
<a name="ln-2498"></a>      <span class="n">ENDIF</span>
<a name="ln-2499"></a>
<a name="ln-2500"></a>      <span class="k">IF</span> <span class="p">((</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">MaxSurfaceTempLimit</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2501"></a>          <span class="p">(</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">MinSurfaceTempLimit</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2502"></a><span class="k">        </span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="nb">Max</span><span class="p">(</span><span class="n">MinSurfaceTempLimit</span><span class="p">,</span><span class="nb">Min</span><span class="p">(</span><span class="n">MaxSurfaceTempLimit</span><span class="p">,</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>  <span class="c">!  +++++ Limit Check</span>
<a name="ln-2503"></a><span class="c">!        CALL CheckFDSurfaceTempLimits(I,TDT(I))</span>
<a name="ln-2504"></a>      <span class="n">ENDIF</span>
<a name="ln-2505"></a>
<a name="ln-2506"></a>    <span class="k">ELSE</span>  <span class="c">!  Regular or PCM</span>
<a name="ln-2507"></a>
<a name="ln-2508"></a>
<a name="ln-2509"></a>      <span class="k">IF</span><span class="p">(</span> <span class="nb">Sum</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">TempEnth</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>    <span class="c">!  phase change material,  Use TempEnth Data</span>
<a name="ln-2510"></a>
<a name="ln-2511"></a>        <span class="n">DepVarCol</span><span class="o">=</span> <span class="mi">2</span>  <span class="c">! enthalpy</span>
<a name="ln-2512"></a>        <span class="n">IndVarCol</span><span class="o">=</span><span class="mi">1</span>  <span class="c">!temperature</span>
<a name="ln-2513"></a>
<a name="ln-2514"></a>        <span class="n">EnthOld</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span><span class="n">terpld</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">numTempEnth</span><span class="p">,</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">TempEnth</span><span class="p">,</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">IndVarCol</span><span class="p">,</span><span class="n">DepVarCol</span><span class="p">)</span>
<a name="ln-2515"></a>
<a name="ln-2516"></a>        <span class="n">EnthNew</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span><span class="n">terpld</span><span class="p">(</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">numTempEnth</span><span class="p">,</span><span class="n">MaterialFD</span><span class="p">(</span><span class="n">MatLay</span><span class="p">)%</span><span class="n">TempEnth</span><span class="p">,</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">IndVarCol</span><span class="p">,</span><span class="n">DepVarCol</span><span class="p">)</span>
<a name="ln-2517"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">EnthNew</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">-</span><span class="n">EnthOld</span><span class="p">(</span><span class="n">I</span><span class="p">))</span> <span class="o">&lt;=</span> <span class="n">smalldiff</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">-</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">))</span> <span class="o">&lt;=</span> <span class="n">smalldiff</span><span class="p">)</span>  <span class="k">THEN</span>
<a name="ln-2518"></a><span class="k">          </span><span class="n">Cp</span> <span class="o">=</span> <span class="n">Cpo</span>
<a name="ln-2519"></a>        <span class="k">ELSE</span>
<a name="ln-2520"></a><span class="k">          </span><span class="n">Cp</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">Cpo</span><span class="p">,(</span><span class="n">EnthNew</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">-</span><span class="n">EnthOld</span><span class="p">(</span><span class="n">I</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">-</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>
<a name="ln-2521"></a>        <span class="k">END IF</span>
<a name="ln-2522"></a>
<a name="ln-2523"></a><span class="k">      ELSE</span>  <span class="c">! Not phase change material</span>
<a name="ln-2524"></a>        <span class="n">Cp</span><span class="o">=</span> <span class="n">Cpo</span>
<a name="ln-2525"></a>
<a name="ln-2526"></a>      <span class="k">END IF</span>  <span class="c">! Phase change material check</span>
<a name="ln-2527"></a>
<a name="ln-2528"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">i</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">!this is for an adiabatic or interzone partition</span>
<a name="ln-2529"></a>        <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">CondFDSchemeType</span><span class="p">)</span>
<a name="ln-2530"></a>
<a name="ln-2531"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CrankNicholsonSecondOrder</span><span class="p">)</span>
<a name="ln-2532"></a>          <span class="c">! Adams-Moulton second order</span>
<a name="ln-2533"></a>          <span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="mf">2.d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">NetLWRadToSurfFD</span> <span class="o">+</span> <span class="mf">2.d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">QHtRadSysSurfFD</span> <span class="o">+</span> <span class="mf">2.d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">QHWBaseboardSurfFD</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2534"></a>                 <span class="mf">2.d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">QSteamBaseboardSurfFD</span> <span class="o">+</span> <span class="mf">2.d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">QElecBaseboardSurfFD</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2535"></a>                 <span class="mf">2.d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">QRadSWInFD</span> <span class="o">+</span> <span class="mf">2.d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">QRadThermInFD</span> <span class="o">-</span>  <span class="p">&amp;</span>
<a name="ln-2536"></a>                  <span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">hconvi</span><span class="o">*</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">-</span> <span class="n">Delt</span><span class="o">*</span><span class="n">kt</span><span class="o">*</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span> <span class="n">Cp</span><span class="o">*</span><span class="n">Delx</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">RhoS</span><span class="o">*</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-2537"></a>                  <span class="n">Delt</span><span class="o">*</span><span class="n">kt</span><span class="o">*</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">Delt</span><span class="o">*</span><span class="n">kt</span><span class="o">*</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mf">2.d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">hconvi</span><span class="o">*</span><span class="n">Tia</span><span class="p">)</span><span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-2538"></a>                  <span class="p">(</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">hconvi</span> <span class="o">+</span> <span class="n">Delt</span><span class="o">*</span><span class="n">kt</span> <span class="o">+</span> <span class="n">Cp</span><span class="o">*</span><span class="n">Delx</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">RhoS</span><span class="p">)</span>
<a name="ln-2539"></a>
<a name="ln-2540"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">FullyImplicitFirstOrder</span><span class="p">)</span>
<a name="ln-2541"></a>        <span class="c">! Adams-Moulton First order</span>
<a name="ln-2542"></a>          <span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="mf">2.d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">NetLWRadToSurfFD</span> <span class="o">+</span> <span class="mf">2.d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">QHtRadSysSurfFD</span> <span class="o">+</span> <span class="mf">2.d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">QHWBaseboardSurfFD</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2543"></a>                 <span class="mf">2.d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">QSteamBaseboardSurfFD</span> <span class="o">+</span> <span class="mf">2.d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">QElecBaseboardSurfFD</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2544"></a>                 <span class="mf">2.d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">QRadSWInFD</span> <span class="o">+</span> <span class="mf">2.d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">QRadThermInFD</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-2545"></a>                  <span class="n">Cp</span><span class="o">*</span><span class="n">Delx</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">RhoS</span><span class="o">*</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span> <span class="mf">2.d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">kt</span><span class="o">*</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mf">2.d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">hconvi</span><span class="o">*</span><span class="n">Tia</span><span class="p">)</span><span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-2546"></a>                  <span class="p">(</span><span class="mf">2.d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">hconvi</span> <span class="o">+</span> <span class="mf">2.d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">kt</span> <span class="o">+</span> <span class="n">Cp</span><span class="o">*</span><span class="n">Delx</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">RhoS</span><span class="p">)</span>
<a name="ln-2547"></a>        <span class="k">END SELECT</span>
<a name="ln-2548"></a>
<a name="ln-2549"></a><span class="k">      ELSE</span> <span class="c">! for regular or interzone walls</span>
<a name="ln-2550"></a>        <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">CondFDSchemeType</span><span class="p">)</span>
<a name="ln-2551"></a>
<a name="ln-2552"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CrankNicholsonSecondOrder</span><span class="p">)</span>
<a name="ln-2553"></a>          <span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="mf">2.d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">NetLWRadToSurfFD</span> <span class="o">+</span> <span class="mf">2.d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">QHtRadSysSurfFD</span> <span class="o">+</span> <span class="mf">2.d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">QHWBaseboardSurfFD</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2554"></a>               <span class="mf">2.d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">QSteamBaseboardSurfFD</span> <span class="o">+</span> <span class="mf">2.d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">QElecBaseboardSurfFD</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2555"></a>               <span class="mf">2.d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">QRadSWInFD</span> <span class="o">+</span> <span class="mf">2.d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">QRadThermInFD</span> <span class="o">-</span>  <span class="p">&amp;</span>
<a name="ln-2556"></a>                <span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">hconvi</span><span class="o">*</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">-</span> <span class="n">Delt</span><span class="o">*</span><span class="n">kt</span><span class="o">*</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span> <span class="n">Cp</span><span class="o">*</span><span class="n">Delx</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">RhoS</span><span class="o">*</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-2557"></a>                <span class="n">Delt</span><span class="o">*</span><span class="n">kt</span><span class="o">*</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">Delt</span><span class="o">*</span><span class="n">kt</span><span class="o">*</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mf">2.d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">hconvi</span><span class="o">*</span><span class="n">Tia</span><span class="p">)</span><span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-2558"></a>                <span class="p">(</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">hconvi</span> <span class="o">+</span> <span class="n">Delt</span><span class="o">*</span><span class="n">kt</span> <span class="o">+</span> <span class="n">Cp</span><span class="o">*</span><span class="n">Delx</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">RhoS</span><span class="p">)</span>
<a name="ln-2559"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">FullyImplicitFirstOrder</span><span class="p">)</span>
<a name="ln-2560"></a>          <span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="mf">2.d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">NetLWRadToSurfFD</span> <span class="o">+</span> <span class="mf">2.d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">QHtRadSysSurfFD</span> <span class="o">+</span> <span class="mf">2.d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">QHWBaseboardSurfFD</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2561"></a>               <span class="mf">2.d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">QSteamBaseboardSurfFD</span> <span class="o">+</span> <span class="mf">2.d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">QElecBaseboardSurfFD</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2562"></a>               <span class="mf">2.d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">QRadSWInFD</span> <span class="o">+</span> <span class="mf">2.d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">QRadThermInFD</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-2563"></a>                <span class="n">Cp</span><span class="o">*</span><span class="n">Delx</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">RhoS</span><span class="o">*</span><span class="n">TD</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span> <span class="mf">2.d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">kt</span><span class="o">*</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mf">2.d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">hconvi</span><span class="o">*</span><span class="n">Tia</span><span class="p">)</span><span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-2564"></a>                <span class="p">(</span><span class="mf">2.d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">Delx</span><span class="o">*</span><span class="n">hconvi</span> <span class="o">+</span> <span class="mf">2.d0</span><span class="o">*</span><span class="n">Delt</span><span class="o">*</span><span class="n">kt</span> <span class="o">+</span> <span class="n">Cp</span><span class="o">*</span><span class="n">Delx</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">RhoS</span><span class="p">)</span>
<a name="ln-2565"></a>        <span class="k">END SELECT</span>
<a name="ln-2566"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-2567"></a>
<a name="ln-2568"></a>      <span class="k">IF</span> <span class="p">((</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">MaxSurfaceTempLimit</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2569"></a>          <span class="p">(</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">MinSurfaceTempLimit</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2570"></a><span class="k">        </span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="nb">Max</span><span class="p">(</span><span class="n">MinSurfaceTempLimit</span><span class="p">,</span><span class="nb">Min</span><span class="p">(</span><span class="n">MaxSurfaceTempLimit</span><span class="p">,</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span>  <span class="c">!  +++++ Limit Check</span>
<a name="ln-2571"></a><span class="c">!        CALL CheckFDSurfaceTempLimits(I,TDT(I))</span>
<a name="ln-2572"></a>      <span class="n">ENDIF</span>
<a name="ln-2573"></a><span class="c">!      TDT(I) = Max(MinSurfaceTempLimit,Min(MaxSurfaceTempLimit,TDT(I)))  !  +++++ Limit Check</span>
<a name="ln-2574"></a>
<a name="ln-2575"></a><span class="c">!  Pass inside conduction Flux [W/m2] to DataHeatBalanceSurface array</span>
<a name="ln-2576"></a><span class="c">!          OpaqSurfInsFaceConductionFlux(Surf)= (TDT(I-1)-TDT(I))*kt/Delx</span>
<a name="ln-2577"></a>    <span class="k">END IF</span>  <span class="c">! Regular or R layer</span>
<a name="ln-2578"></a>
<a name="ln-2579"></a>  <span class="k">END IF</span>   <span class="c">!  End of Regular node or SigmaR SigmaC option</span>
<a name="ln-2580"></a>
<a name="ln-2581"></a>
<a name="ln-2582"></a>  <span class="n">QNetSurfInside</span><span class="o">=</span> <span class="o">-</span> <span class="p">(</span><span class="n">NetLWRadToSurfFD</span> <span class="o">+</span> <span class="n">QHtRadSysSurfFD</span> <span class="o">+</span> <span class="n">QRadSWInFD</span> <span class="o">+</span> <span class="n">QRadThermInFD</span> <span class="o">+</span> <span class="n">QHWBaseboardSurfFD</span>  <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2583"></a>             <span class="n">QSteamBaseboardSurfFD</span><span class="o">+</span><span class="n">QElecBaseboardSurfFD</span><span class="o">+</span><span class="n">hconvi</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">TDT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span> <span class="n">Tia</span><span class="p">))</span>
<a name="ln-2584"></a><span class="c">! note -- no change ref: CR8575</span>
<a name="ln-2585"></a><span class="c">!feb2012  QNetSurfInside=NetLWRadToSurfFD + QHtRadSysSurfFD + QRadSWInFD + QRadThermInFD + QHWBaseboardSurfFD  + &amp;</span>
<a name="ln-2586"></a><span class="c">!feb2012             QSteamBaseboardSurfFD+QElecBaseboardSurfFD+hconvi*(-TDT(I) + Tia)</span>
<a name="ln-2587"></a>
<a name="ln-2588"></a>    <span class="c">!  Pass inside conduction Flux [W/m2] to DataHeatBalanceSurface array</span>
<a name="ln-2589"></a>  <span class="n">OpaqSurfInsFaceConductionFlux</span><span class="p">(</span><span class="n">Surf</span><span class="p">)</span><span class="o">=</span> <span class="n">QNetSurfInside</span>
<a name="ln-2590"></a><span class="c">!  QFluxZoneToInSurf(Surf) = QNetSurfInside</span>
<a name="ln-2591"></a>  <span class="n">OpaqSurfInsFaceConduction</span><span class="p">(</span><span class="n">Surf</span><span class="p">)</span><span class="o">=</span><span class="n">QNetSurfInside</span><span class="o">*</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">Area</span>   <span class="c">!for reporting as in CTF, PT</span>
<a name="ln-2592"></a>
<a name="ln-2593"></a><span class="k">RETURN</span>
<a name="ln-2594"></a>
<a name="ln-2595"></a><span class="k">END SUBROUTINE </span><span class="n">InteriorBCEqns</span>
<a name="ln-2596"></a>
<a name="ln-2597"></a><span class="k">SUBROUTINE </span><span class="n">CheckFDSurfaceTempLimits</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">CheckTemperature</span><span class="p">)</span>
<a name="ln-2598"></a>
<a name="ln-2599"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2600"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-2601"></a>          <span class="c">!       DATE WRITTEN   August 2012</span>
<a name="ln-2602"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-2603"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2604"></a>
<a name="ln-2605"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2606"></a>          <span class="c">! Provides a single entry point for checking surface temperature limits as well as</span>
<a name="ln-2607"></a>          <span class="c">! setting up for recurring errors if too low or too high.</span>
<a name="ln-2608"></a>
<a name="ln-2609"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2610"></a>          <span class="c">! Use methodology similar to HBSurfaceManager</span>
<a name="ln-2611"></a>
<a name="ln-2612"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2613"></a>          <span class="c">! na</span>
<a name="ln-2614"></a>
<a name="ln-2615"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2616"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-2617"></a>  <span class="k">USE </span><span class="n">DataAirFlowNetwork</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateAirFlowNetwork</span><span class="p">,</span><span class="n">AirflowNetworkControlSimple</span>
<a name="ln-2618"></a>
<a name="ln-2619"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2620"></a>
<a name="ln-2621"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2622"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">SurfNum</span>  <span class="c">! surface number</span>
<a name="ln-2623"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CheckTemperature</span>  <span class="c">! calculated temperature, not reset</span>
<a name="ln-2624"></a>
<a name="ln-2625"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2626"></a>          <span class="c">! na</span>
<a name="ln-2627"></a>
<a name="ln-2628"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-2629"></a>          <span class="c">! na</span>
<a name="ln-2630"></a>
<a name="ln-2631"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-2632"></a>          <span class="c">! na</span>
<a name="ln-2633"></a>
<a name="ln-2634"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2635"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ZoneNum</span>
<a name="ln-2636"></a>
<a name="ln-2637"></a>  <span class="n">ZoneNum</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-2638"></a>
<a name="ln-2639"></a><span class="c">!      IF ((TH(SurfNum,1,2) &gt; MaxSurfaceTempLimit) .OR. &amp;</span>
<a name="ln-2640"></a><span class="c">!          (TH(SurfNum,1,2) &lt; MinSurfaceTempLimit) ) THEN</span>
<a name="ln-2641"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WarmupFlag</span><span class="p">)</span> <span class="n">WarmupSurfTemp</span><span class="o">=</span><span class="n">WarmupSurfTemp</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2642"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">WarmupFlag</span>  <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">WarmupFlag</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">WarmupSurfTemp</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2643"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">CheckTemperature</span> <span class="o">&lt;</span> <span class="n">MinSurfaceTempLimit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2644"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">LowTempErrCount</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2645"></a><span class="k">        CALL </span><span class="n">ShowSevereMessage</span><span class="p">(</span><span class="s1">&#39;Temperature (low) out of bounds [&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">CheckTemperature</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2646"></a>                           <span class="s1">&#39;] for zone=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, for surface=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-2647"></a>        <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-2648"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TempOutOfBoundsReported</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2649"></a><span class="k">          CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Zone=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, Diagnostic Details:&#39;</span><span class="p">)</span>
<a name="ln-2650"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">FloorArea</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2651"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Internal Heat Gain [&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2652"></a>                 <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">InternalHeatGains</span><span class="o">/</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">FloorArea</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;] W/m2&#39;</span><span class="p">)</span>
<a name="ln-2653"></a>          <span class="k">ELSE</span>
<a name="ln-2654"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Internal Heat Gain (no floor) [&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2655"></a>                 <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">InternalHeatGains</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;] W&#39;</span><span class="p">)</span>
<a name="ln-2656"></a>          <span class="n">ENDIF</span>
<a name="ln-2657"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">SimulateAirflowNetwork</span> <span class="o">&lt;=</span> <span class="n">AirflowNetworkControlSimple</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2658"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Infiltration/Ventilation [&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2659"></a>                   <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NominalInfilVent</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;] m3/s&#39;</span><span class="p">)</span>
<a name="ln-2660"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Mixing/Cross Mixing [&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2661"></a>                   <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NominalMixing</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;] m3/s&#39;</span><span class="p">)</span>
<a name="ln-2662"></a>          <span class="k">ELSE</span>
<a name="ln-2663"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Airflow Network Simulation: Nominal Infiltration/Ventilation/Mixing not available.&#39;</span><span class="p">)</span>
<a name="ln-2664"></a>          <span class="n">ENDIF</span>
<a name="ln-2665"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">isControlled</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2666"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Zone is part of HVAC controlled system.&#39;</span><span class="p">)</span>
<a name="ln-2667"></a>          <span class="k">ELSE</span>
<a name="ln-2668"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Zone is not part of HVAC controlled system.&#39;</span><span class="p">)</span>
<a name="ln-2669"></a>          <span class="n">ENDIF</span>
<a name="ln-2670"></a>          <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TempOutOfBoundsReported</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2671"></a>        <span class="n">ENDIF</span>
<a name="ln-2672"></a>        <span class="k">CALL </span><span class="n">ShowRecurringSevereErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;Temperature (low) out of bounds for zone=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2673"></a>                       <span class="s1">&#39; for surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-2674"></a>                       <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">LowTempErrCount</span><span class="p">,</span><span class="n">ReportMaxOf</span><span class="o">=</span><span class="n">CheckTemperature</span><span class="p">,</span><span class="n">ReportMaxUnits</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2675"></a>                       <span class="n">ReportMinOf</span><span class="o">=</span><span class="n">CheckTemperature</span><span class="p">,</span><span class="n">ReportMinUnits</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">)</span>
<a name="ln-2676"></a>      <span class="k">ELSE</span>
<a name="ln-2677"></a><span class="k">        CALL </span><span class="n">ShowRecurringSevereErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;Temperature (low) out of bounds for zone=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2678"></a>                       <span class="s1">&#39; for surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-2679"></a>                       <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">LowTempErrCount</span><span class="p">,</span><span class="n">ReportMaxOf</span><span class="o">=</span><span class="n">CheckTemperature</span><span class="p">,</span><span class="n">ReportMaxUnits</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2680"></a>                       <span class="n">ReportMinOf</span><span class="o">=</span><span class="n">CheckTemperature</span><span class="p">,</span><span class="n">ReportMinUnits</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">)</span>
<a name="ln-2681"></a>      <span class="n">ENDIF</span>
<a name="ln-2682"></a>    <span class="k">ELSE</span>
<a name="ln-2683"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HighTempErrCount</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2684"></a><span class="k">        CALL </span><span class="n">ShowSevereMessage</span><span class="p">(</span><span class="s1">&#39;Temperature (high) out of bounds (&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">CheckTemperature</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2685"></a>                           <span class="s1">&#39;] for zone=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, for surface=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-2686"></a>        <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-2687"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TempOutOfBoundsReported</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2688"></a><span class="k">          CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Zone=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, Diagnostic Details:&#39;</span><span class="p">)</span>
<a name="ln-2689"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">FloorArea</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2690"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Internal Heat Gain [&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2691"></a>                 <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">InternalHeatGains</span><span class="o">/</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">FloorArea</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;] W/m2&#39;</span><span class="p">)</span>
<a name="ln-2692"></a>          <span class="k">ELSE</span>
<a name="ln-2693"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Internal Heat Gain (no floor) [&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2694"></a>                 <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">InternalHeatGains</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;] W&#39;</span><span class="p">)</span>
<a name="ln-2695"></a>          <span class="n">ENDIF</span>
<a name="ln-2696"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">SimulateAirflowNetwork</span> <span class="o">&lt;=</span> <span class="n">AirflowNetworkControlSimple</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2697"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Infiltration/Ventilation [&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2698"></a>                   <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NominalInfilVent</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;] m3/s&#39;</span><span class="p">)</span>
<a name="ln-2699"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Mixing/Cross Mixing [&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2700"></a>                   <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NominalMixing</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;] m3/s&#39;</span><span class="p">)</span>
<a name="ln-2701"></a>          <span class="k">ELSE</span>
<a name="ln-2702"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Airflow Network Simulation: Nominal Infiltration/Ventilation/Mixing not available.&#39;</span><span class="p">)</span>
<a name="ln-2703"></a>          <span class="n">ENDIF</span>
<a name="ln-2704"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">isControlled</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2705"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Zone is part of HVAC controlled system.&#39;</span><span class="p">)</span>
<a name="ln-2706"></a>          <span class="k">ELSE</span>
<a name="ln-2707"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Zone is not part of HVAC controlled system.&#39;</span><span class="p">)</span>
<a name="ln-2708"></a>          <span class="n">ENDIF</span>
<a name="ln-2709"></a>          <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TempOutOfBoundsReported</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2710"></a>        <span class="n">ENDIF</span>
<a name="ln-2711"></a>        <span class="k">CALL </span><span class="n">ShowRecurringSevereErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;Temperature (high) out of bounds for zone=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2712"></a>                       <span class="s1">&#39; for surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-2713"></a>                       <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HighTempErrCount</span><span class="p">,</span><span class="n">ReportMaxOf</span><span class="o">=</span><span class="n">CheckTemperature</span><span class="p">,</span><span class="n">ReportMaxUnits</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2714"></a>                       <span class="n">ReportMinOf</span><span class="o">=</span><span class="n">CheckTemperature</span><span class="p">,</span><span class="n">ReportMinUnits</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">)</span>
<a name="ln-2715"></a>      <span class="k">ELSE</span>
<a name="ln-2716"></a><span class="k">        CALL </span><span class="n">ShowRecurringSevereErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;Temperature (high) out of bounds for zone=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2717"></a>                      <span class="s1">&#39; for surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-2718"></a>                       <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HighTempErrCount</span><span class="p">,</span><span class="n">ReportMaxOf</span><span class="o">=</span><span class="n">CheckTemperature</span><span class="p">,</span><span class="n">ReportMaxUnits</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2719"></a>                       <span class="n">ReportMinOf</span><span class="o">=</span><span class="n">CheckTemperature</span><span class="p">,</span><span class="n">ReportMinUnits</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">)</span>
<a name="ln-2720"></a>      <span class="n">ENDIF</span>
<a name="ln-2721"></a>    <span class="n">ENDIF</span>
<a name="ln-2722"></a>  <span class="n">ENDIF</span>
<a name="ln-2723"></a>
<a name="ln-2724"></a>
<a name="ln-2725"></a>  <span class="k">RETURN</span>
<a name="ln-2726"></a>
<a name="ln-2727"></a><span class="k">END SUBROUTINE </span><span class="n">CheckFDSurfaceTempLimits</span>
<a name="ln-2728"></a>
<a name="ln-2729"></a><span class="c">! *****************************************************************************</span>
<a name="ln-2730"></a>
<a name="ln-2731"></a><span class="c">!     NOTICE</span>
<a name="ln-2732"></a><span class="c">!</span>
<a name="ln-2733"></a><span class="c">!     Copyright © 1996-2013 The Board of Trustees of the University of Illinois</span>
<a name="ln-2734"></a><span class="c">!     and The Regents of the University of California through Ernest Orlando Lawrence</span>
<a name="ln-2735"></a><span class="c">!     Berkeley National Laboratory.  All rights reserved.</span>
<a name="ln-2736"></a><span class="c">!</span>
<a name="ln-2737"></a><span class="c">!     Portions of the EnergyPlus software package have been developed and copyrighted</span>
<a name="ln-2738"></a><span class="c">!     by other individuals, companies and institutions.  These portions have been</span>
<a name="ln-2739"></a><span class="c">!     incorporated into the EnergyPlus software package under license.   For a complete</span>
<a name="ln-2740"></a><span class="c">!     list of contributors, see &quot;Notice&quot; located in EnergyPlus.f90.</span>
<a name="ln-2741"></a><span class="c">!</span>
<a name="ln-2742"></a><span class="c">!     NOTICE: The U.S. Government is granted for itself and others acting on its</span>
<a name="ln-2743"></a><span class="c">!     behalf a paid-up, nonexclusive, irrevocable, worldwide license in this data to</span>
<a name="ln-2744"></a><span class="c">!     reproduce, prepare derivative works, and perform publicly and display publicly.</span>
<a name="ln-2745"></a><span class="c">!     Beginning five (5) years after permission to assert copyright is granted,</span>
<a name="ln-2746"></a><span class="c">!     subject to two possible five year renewals, the U.S. Government is granted for</span>
<a name="ln-2747"></a><span class="c">!     itself and others acting on its behalf a paid-up, non-exclusive, irrevocable</span>
<a name="ln-2748"></a><span class="c">!     worldwide license in this data to reproduce, prepare derivative works,</span>
<a name="ln-2749"></a><span class="c">!     distribute copies to the public, perform publicly and display publicly, and to</span>
<a name="ln-2750"></a><span class="c">!     permit others to do so.</span>
<a name="ln-2751"></a><span class="c">!</span>
<a name="ln-2752"></a><span class="c">!     TRADEMARKS: EnergyPlus is a trademark of the US Department of Energy.</span>
<a name="ln-2753"></a><span class="c">!</span>
<a name="ln-2754"></a>
<a name="ln-2755"></a><span class="k">End Module </span><span class="n">HeatBalFiniteDiffManager</span>
</pre></div>

    </section>
    </div>
  </div>

  <section class="visible-xs visible-sm hidden-md">
    <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-1">All Source Files</a></h3></div>
  <div id="allfiles-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


  </section>

    <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2017 </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by
            <a href="https://github.com/cmacmackin/ford">FORD</a>

          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> EnergyPlusFortran</p></div>
      </div>
      <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': {
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>
